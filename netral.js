/*
 JSON v3.2.6 | http://bestiejs.github.io/json3 | Copyright 2012-2013, Kit Cambridge | http://kit.mit-license.org  https://mths.be/utf8js v2.0.0 by @mathias */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(D,pa,ha){D!=Array.prototype&&D!=Object.prototype&&(D[pa]=ha.value)};$jscomp.getGlobal=function(D){return"undefined"!=typeof window&&window===D?D:"undefined"!=typeof global&&null!=global?global:D};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var D=0;return function(pa){return $jscomp.SYMBOL_PREFIX+(pa||"")+D++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var D=$jscomp.global.Symbol.iterator;D||(D=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[D]&&$jscomp.defineProperty(Array.prototype,D,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(D){var pa=0;return $jscomp.iteratorPrototype(function(){return pa<D.length?{done:!1,value:D[pa++]}:{done:!0}})};$jscomp.iteratorPrototype=function(D){$jscomp.initSymbolIterator();D={next:D};D[$jscomp.global.Symbol.iterator]=function(){return this};return D};
$jscomp.iteratorFromArray=function(D,pa){$jscomp.initSymbolIterator();D instanceof String&&(D+="");var ha=0,Aa={next:function(){if(ha<D.length){var wa=ha++;return{value:pa(wa,D[wa]),done:!1}}Aa.next=function(){return{done:!0,value:void 0}};return Aa.next()}};Aa[Symbol.iterator]=function(){return Aa};return Aa};
$jscomp.polyfill=function(D,pa,ha,Aa){if(pa){ha=$jscomp.global;D=D.split(".");for(Aa=0;Aa<D.length-1;Aa++){var wa=D[Aa];wa in ha||(ha[wa]={});ha=ha[wa]}D=D[D.length-1];Aa=ha[D];pa=pa(Aa);pa!=Aa&&null!=pa&&$jscomp.defineProperty(ha,D,{configurable:!0,writable:!0,value:pa})}};$jscomp.polyfill("Array.prototype.keys",function(D){return D?D:function(){return $jscomp.iteratorFromArray(this,function(D){return D})}},"es6","es3");
$jscomp.polyfill("Object.getOwnPropertySymbols",function(D){return D?D:function(){return[]}},"es6","es5");$jscomp.findInternal=function(D,pa,ha){D instanceof String&&(D=String(D));for(var Aa=D.length,wa=0;wa<Aa;wa++){var U=D[wa];if(pa.call(ha,U,wa,D))return{i:wa,v:U}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(D){return D?D:function(D,ha){return $jscomp.findInternal(this,D,ha).v}},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(D){return D?D:function(){return $jscomp.iteratorFromArray(this,function(D,ha){return ha})}},"es8","es3");$jscomp.polyfill("Math.sign",function(D){return D?D:function(D){D=Number(D);return 0===D||isNaN(D)?D:0<D?1:-1}},"es6","es3");$jscomp.polyfill("Number.isFinite",function(D){return D?D:function(D){return"number"!==typeof D?!1:!isNaN(D)&&Infinity!==D&&-Infinity!==D}},"es6","es3");
$jscomp.polyfill("Number.isInteger",function(D){return D?D:function(D){return Number.isFinite(D)?D===Math.floor(D):!1}},"es6","es3");$jscomp.owns=function(D,pa){return Object.prototype.hasOwnProperty.call(D,pa)};$jscomp.polyfill("Object.assign",function(D){return D?D:function(D,ha){for(var pa=1;pa<arguments.length;pa++){var wa=arguments[pa];if(wa)for(var U in wa)$jscomp.owns(wa,U)&&(D[U]=wa[U])}return D}},"es6","es3");
(function(){var D,pa,ha,Aa;function wa(f,b){var a=x,c;for(c=2;60>=c;c+=2){f--;b--;for(var d=0;d<=c;){if(2<R[f+d+a*b]&&1==y[R[f+d+a*b]].res)return R[f+d+a*b];if(2<R[f+d+a*(b+c)]&&1==y[R[f+d+a*(b+c)]].res)return R[f+d+a*(b+c)];d++}for(d=0;d<c-1;){d++;if(2<R[f+a*(b+d)]&&1==y[R[f+a*(b+d)]].res)return R[f+a*(b+d)];if(2<R[f+c+a*(b+d)]&&1==y[R[f+c+a*(b+d)]].res)return R[f+c+a*(b+d)]}}return!1}function U(f){f.setupINTV(Qd,f.id,0)}function uj(f){za=[];Rd=[];var b=K[0].diplomacy;eb=[];qb=[];for(var a=f.length,
c=0;c<a;c++){var d=[];qb[c]={};eb[c]=d;for(var h=0;h<w.length;h++)d[h]=[];b[c]=1;d=f[c].color;za.push(d[0]/255,d[1]/255,d[2]/255);Rd.push(d[0],d[1],d[2])}za=new Float32Array(za);Rd=new Uint8Array(Rd)}function vj(){for(var f=0,b=Ia.length;f<b;Ia[f++].className="");}function wj(f){g.getError()==g.CONTEXT_LOST_WEBGL&&(g=document.getElementById("tzar").getContext("webgl2",{antialias:!1,alpha:!1}),M("restored"));var b=x;pa=[];ha=[0,1,2,1,2,3];Aa=[];ha.changed=!0;var a=x*la;if(!ed){var c=g.createShader(g.VERTEX_SHADER);
g.shaderSource(c,"#version 300 es\nprecision mediump float;\n\nin vec3 a_position;\nin vec4 a_texCoord;\nin vec4 a_kingdom;\nin vec4 a_physic;\nuniform float zoom;\nuniform mediump int miniMap;\nuniform float now;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform sampler2D u_image1;\nuniform sampler2D delay;\nuniform float zMax;\nout highp vec2 vTextureCoord;\nout vec4 v_kcolor;\nout float height;\n\nvec4 superArray(in highp uint position) {\n     return(texelFetch(u_image1, ivec2(\t\t(position%uint(512))\t\t,\tposition/uint(512)\t), 0));\n}\n\n\n\nvoid main() {\n\n\n\n    highp float  x;\n    float t;\n\thighp uint pos;\n\n\nif(a_texCoord.y>-.5&&miniMap==0){\nt=(now-a_texCoord.y);\nif(a_texCoord.w>=0.0){\npos=uint(floor(t * a_texCoord.w));         \n}else{\n\n\nint index=int(-a_texCoord.w);\nint len=int(a_texCoord.z);\nint i;\n\nfloat spt= mod(t,texelFetch(delay, ivec2(len-1+index, 0), 0).r);\n\n for(i=0;i<len;i++){\n\n\nif(texelFetch(delay, ivec2(i+index, 0), 0).r>spt) {\n\nbreak;\n }\n\n\n }\n\n pos=uint(i);\n\n\t\t\t\t  \n //pos=uint(4);\n}\n\n\n\tpos=uint(a_texCoord.x)+uint(4)*(pos%uint(a_texCoord.z));\n\n\n}else{\n\npos=uint(a_texCoord.x);\n\n}\n\n\n\n    vec4 coord = superArray(pos);\n\n\tpos=pos-pos%uint(4);\n\n\theight = (superArray(pos+uint(3)).w-superArray(pos).w)/512.0;\n\n    vec2 mxy=vec2(coord.p,coord.q);\n\n\n\t\tfloat z=a_position.z;\n\n\tif(z<0.0){\n\tz*=-1.0;\n\tmxy*=0.0;\n\n\t}\n\n\n\n    t = (now - a_physic.w) * 0.001;\n    mxy.x+=a_physic.x * t;\n\n\tfloat physicY=a_physic.y * t + a_physic.z * .5 * t * t;\n\n    mxy.y+=physicY;\n\n\nif(miniMap==1){\n\tz=0.0;\n}else{\n\tz=(1.0 - (physicY+z)/ zMax)*.9;\n}\n\n   gl_Position = vec4((((a_position.xy+mxy) + u_translation) / u_resolution * 2.0 - 1.0) * vec2(zoom, -zoom), (z), 1.0);\n\n   vTextureCoord=vec2(coord.s,coord.t);\n\n\n    v_kcolor=a_kingdom;\n\n\n}\n");
g.compileShader(c);var d=g.createShader(g.FRAGMENT_SHADER);g.shaderSource(d,"#version 300 es\nprecision mediump float;\n\n\n\nuniform sampler2D lightmap;\nuniform vec2 u_resolution;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\nuniform mediump int miniMap;\nin vec4 v_kcolor;\nin highp vec2 vTextureCoord;\nin float height;\nout vec4 COLOR;\n\nvoid main() {\n\n\nif(miniMap==0){\n\n\n\n\nvec2 txtFinal=vTextureCoord;\n\nif(txtFinal.x>=1.0){\ntxtFinal.y+=height*floor(txtFinal.x);\n}\n\n\nvec4 color=texture(img_common, vec3(txtFinal, int(txtFinal.y)));\n \n\nif(color.a<0.5) discard;\n\n\n\n\nif(v_kcolor.a<1.0){\ncolor*=v_kcolor;\n}else if(v_kcolor.a!=1.0){\n\nif(color.r==color.g&&color.r==color.b){\ncolor.rgb*=v_kcolor.rgb;\n}\ncolor.a*=v_kcolor.a-1.0;\n}\nvec4 light=vec4(1.0);\n\n\nlight = texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+vec4(1.0,1.0,1.0,0.0)*u_ambient;\n\nCOLOR=color*light;\n\n}else{\nCOLOR=v_kcolor;\n}\n\n}");
g.compileShader(d);Z=g.createProgram();g.attachShader(Z,c);g.attachShader(Z,d);g.linkProgram(Z);g.useProgram(Z);c=g.getShaderInfoLog(c);console.log("Shader compiler log: "+c);c=g.getShaderInfoLog(d);console.log("Shader compiler log: "+c);c=g.createShader(g.VERTEX_SHADER);g.shaderSource(c,"#version 300 es\nprecision mediump float;\n\nin vec3 a_position;\n\n\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform mediump int miniMap;\nuniform float zoom;\n\n\nvoid main() {\n\nfloat depth;\nif(miniMap==1){\ndepth=.03;\n}else{\ndepth=1.0;\n}\n\n   gl_Position = vec4(a_position.x, a_position.y, depth, 1.0);\n   \n\n}");
g.compileShader(c);d=g.createShader(g.FRAGMENT_SHADER);g.shaderSource(d,"#version 300 es\nprecision mediump float;\n\nuniform float u_fps;\nuniform mediump int miniMap;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\nuniform vec2 borderCoords;\nuniform vec2 waterBorder;\nuniform vec2 u_translation;\nuniform vec2 u_resolution;\nuniform mediump isampler2D img_data;\nuniform sampler2D lightmap;\nout vec4 COLOR;\nuniform float zoom;\nuniform float mx;\nuniform float mapSize;\nuniform float terrainInfo[32];\nvec4 sptexture3D(in vec2 coords,in float height1) {\n \n\n \nif(coords.x>=1.0){\ncoords.y+=height1*floor(coords.x);\n}\n\n\n\n    return(\ttexture(img_common, vec3(coords,int(coords.y)))\t);\n}\n\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main() {\nvec4 color;\n\nvec2 xy =  vec2(gl_FragCoord.x,u_resolution.y-gl_FragCoord.y)/zoom;\n\nif(miniMap==1){\nxy+=vec2(-4.0,-31.0)/zoom;\n}else{\nxy+=-u_translation+vec2(mx,0.0)/zoom+0.5*(u_resolution-u_resolution/zoom);\n}\n\nvec2 xy32=xy/32.0;\n\nvec2 floorxy32=floor(xy32);\n\nvec2 xyr=xy32-floorxy32;\n\n\nvec2 xyb;\n\n\nfloat dx=0.0;\nfloat dy=0.0;\n\nif(xyr.x>0.5){dx=1.0;}\nif(xyr.y>0.5){dy=1.0;}\n\nvec2 oxy32=xy32;\n\n\nif(dx==1.0){\nxyb=vec2(borderCoords.x+floor(rand(floorxy32)*24.0)*64.0/512.0,borderCoords.y)+(xyr)*(32.0/512.0)+vec2(-16.0,8.0)/512.0;\nif(sptexture3D(xyb,64.0/512.0).r>0.5){\nxy32.x+=dx;\n}\n}\n\nif(dy==1.0){\nxyb=vec2(borderCoords.x+floor(rand(1.5*floorxy32-3.0)*24.0)*64.0/512.0,borderCoords.y)+(xyr)*(32.0/512.0)+vec2(8,-16.0)/512.0;\nif(sptexture3D(xyb,64.0/512.0).r>0.5){\nxy32.y+=dy;\n}\n}\n\n\nint type = texture(img_data,xy32/(mapSize)).r;\nint ntype = texture(img_data,oxy32/(mapSize)).r;\n\nif(type<0&&type!=ntype){\n\nif(ntype<0){\ntype=ntype;\n}else if(ntype==3){\ntype=ntype;\n}else{\ntype=1;\n}\n}\n\n\n\nfloat h;\nfloat w;\nvec2 xytxt;\nif(type<0){\n\ntype=-type-1;\nxytxt=waterBorder+vec2(float(type*8*32),0.0)/512.0;\nw=32.0;\nh=32.0;\ntype*=-1;\n}else{\nxytxt=vec2(terrainInfo[type*4],terrainInfo[type*4+1]);\nw=terrainInfo[type*4+2];\nh=terrainInfo[type*4+3];\n\nif(type==3) xytxt+=vec2(u_fps,0.0);\n}\n\n\nvec2 xyt=vec2(xytxt)+vec2(mod(xy.x,w),mod(xy.y,h))/512.0;\n\n\nif(type==3){ h=576.0; }\ncolor=sptexture3D(xyt,h/512.0);\n\nmediump vec4 light=vec4(1.0);\nif(miniMap==0) light = texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+1.0;\n\n\n\nCOLOR=color*light*u_ambient;\n\n\n\n}");
g.compileShader(d);ma=g.createProgram();g.attachShader(ma,c);g.attachShader(ma,d);g.linkProgram(ma);c=g.getShaderInfoLog(c);console.log("Shader1 compiler log T: "+c);c=g.getShaderInfoLog(d);console.log("Shader compiler log T: "+c)}d=g.getAttribLocation(Z,"a_position");c=g.getAttribLocation(Z,"a_texCoord");var h=g.getAttribLocation(Z,"a_kingdom"),l=g.getAttribLocation(Z,"a_physic"),t=k,p=fd.dir,m=[];m.length=4*p.length;for(var n=0,q=p.length;n<q;n++){var r=ta[t[p[n]]],V=r[7]+r.deltaY;var Da=r[8];var Ra=
r[9];m[4*n]=r[6]/512;m[4*n+1]=V/512;m[4*n+2]=Da;m[4*n+3]=Ra}M(m);r=1/512;p=[];V={};q={1:2560,101001:2048,101E3:2048,1001:2048,1E3:2048,100:1536,10010100:1280,10100:1280,1001E4:1280,1E4:1280,10010010:256,10010110:256,10110:256,10111:256,10010111:256,110:512,111:512,11:512,10:512,111E5:2816,11E5:2816,11E6:2816,1E6:2816,1101E4:768,11110100:768,11010100:768,1111E4:768,1E7:3360,1E5:3072,1101E3:1792,1101001:1792,11101E3:1792,11101001:1792,101111:0,1011:0,1111:0,101011:0};for(n=0;n<a;n++)Da=f[n],3==Da&&
(Da=0,3!=f[n-1-b]&&(Da+=1E7),3!=f[n-b]&&(Da+=1E6),3!=f[n-b+1]&&(Da+=1E5),3!=f[n-1]&&(Da+=1E4),3!=f[n+1]&&(Da+=1E3),3!=f[n-1+b]&&(Da+=100),3!=f[n+b]&&(Da+=10),3!=f[n+1+b]&&(Da+=1),Da&&void 0!==q[Da]&&(p.add(n),V[p.length-1]=-q[Da]/256-1));n=0;for(q=p.length;n<q;f[p[n]]=V[n++]);g.useProgram(ma);gd=g.getUniformLocation(ma,"u_translation");rf=g.getUniformLocation(ma,"u_resolution");sf=g.getUniformLocation(ma,"u_fps");var E=g.getUniformLocation(ma,"u_ambient");Mc=g.getUniformLocation(ma,"zoom");b=g.getUniformLocation(ma,
"mx");a=g.getUniformLocation(ma,"mapSize");n=g.getUniformLocation(ma,"borderCoords");q=g.getUniformLocation(ma,"waterBorder");Sd=g.getUniformLocation(ma,"miniMap");p=g.getUniformLocation(ma,"terrainInfo");g.uniform2fv(n,[ta[t.terrain_border][6]*r,r*(ta[t.terrain_border].deltaY+ta[t.terrain_border][7])]);g.uniform2fv(q,[ta[t.waterborder][6]*r,r*(ta[t.waterborder].deltaY+ta[t.waterborder][7])]);g.uniform1i(Sd,0);g.uniform2fv(gd,[0,0]);g.uniform1f(sf,-1);g.uniform1f(Mc,1);g.uniform1f(b,-z.mx);g.uniform1f(a,
x);g.uniform1fv(p,m);b=g.getAttribLocation(ma,"a_position");tf=g.createVertexArray();g.bindVertexArray(tf);a=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,a);g.bufferData(g.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,-1,1,1,-1,1]),g.STATIC_DRAW);g.enableVertexAttribArray(b);g.vertexAttribPointer(b,2,g.FLOAT,!1,0,0);g.bindVertexArray(null);g.useProgram(Z);g.bindBuffer(g.ARRAY_BUFFER,null);b=x*la*3;uf=g.createVertexArray();g.bindVertexArray(uf);Ya=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,Ya);
g.enableVertexAttribArray(h);g.vertexAttribPointer(h,4,g.FLOAT,!1,0,0);g.bufferData(g.ARRAY_BUFFER,16*b,g.DYNAMIC_DRAW);Nc=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,Nc);g.enableVertexAttribArray(c);g.vertexAttribPointer(c,4,g.FLOAT,!1,0,0);g.bufferData(g.ARRAY_BUFFER,16*b,g.DYNAMIC_DRAW);Sb=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,Sb);g.enableVertexAttribArray(d);g.vertexAttribPointer(d,3,g.FLOAT,!1,0,0);g.bufferData(g.ARRAY_BUFFER,12*b,g.DYNAMIC_DRAW);hd=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,
hd);g.enableVertexAttribArray(l);g.vertexAttribPointer(l,4,g.FLOAT,!1,0,0);g.bufferData(g.ARRAY_BUFFER,16*b,g.DYNAMIC_DRAW);g.bindVertexArray(null);Td=g.getUniformLocation(Z,"u_resolution");var v=g.getUniformLocation(Z,"u_ambient");id=g.getUniformLocation(Z,"u_translation");Oc=g.getUniformLocation(Z,"zoom");bh=g.getUniformLocation(Z,"now");Ud=g.getUniformLocation(Z,"miniMap");d=g.getUniformLocation(Z,"zMax");g.uniform1f(d,u.zMax);g.uniform1i(Ud,0);g.useProgram(Z);k.delay=[100,250,400,550,650,750,
850,1E3,1150,5150,7650,10150,13650,17150,21150,25150,100,200,300,400,500,600,700,800,900,1E3,1100,1200,7200,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,6500,7700,8900,10100,13600,17100,22100,8E3,8080,8160,8240,8320,8400,8480,100,200,300,400,500,600,700,800,900,1E3,1100,2400,3600,4800,6E3,7200,8400,11900,15400,20400,8E3,8077,8154,8231,8308,8385,8462,8539,8616,8693,8770,8847,8923,5E3,5072,5143,5215,5286,5358,5429,5501,5572,5644,5715,5787,5858,5929,100,200,300,400,500,600,700,800,900,1E3,
1100,1200,1300,1400,3700,4900,7100,9600,12600,17100,8E3,8083,8166,8250,8333,8416,8500,8583,8666,8750,8833,8916,9E3,8E3,8083,8166,8250,8333,8416,8500,8583,8666,8750,8833,8916,9E3,9080,5E3,5100,5200,5300,5400,5500,5600,5700,5850,6E3,70,140,210,280,350,420,490,560,630,700,770,840,910,980,4980,8980,12980,16980,20980,26980,6E3,6100,6200,6300,6400,6500,6600,100,200,300,400,500,600,700,800,900,1E3,1100,4100,6300,8500,11E3,13500,17E3,20500,5E3,5100,5200,5300,5400,5500,5600,5700,5800,5900,6E3,125,230,335,
431,546,606,666,731,857,952,1045,1139,1238,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,3300,5800,8800,12E3,15500,5500,5600,5700,5800,5900,6E3,6100,6200,6300,6400,6500,6600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,6800,9800,12800,16300,19800,23800,28300,5E3,5100,5200,5300,5400,5500,5600,210,420,654,864,1074,1284,1494,108,244,380,516,652,788,924,1060,1196,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4100,6100,8100,11100,14100,17100,6E3,6100,6200,6300,6400,6500,6600,
100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,5200,9E3,11E3,13800,17600,23400,7E3,7100,7200,7300,7400,8200,8300,8400,8500,8600,9600,9700,9800,9900,1E4,80,160,210,360,610,1010,1510,100,200,300,400,500,3500,7500,13500,40,80,120,160,200,240,280,320,360,400,440,480,520,2520,3520,4520,5520,6520,8520,11520,107,214,321,428,535,642,749,856,963,1070,1177,1284,1391,1498,7323,13148,18973,24798,30623,36448,7E3,7170,7340,7510,7680,7980,8150,8320,8490,8660,100,200,300,400,500,600,700,800,900,1E3,
1100,1200,1300,1400,4400,6400,8900,11400,14900,18400,7E3,7200,7400,7600,7800,8E3,8200,125,250,375,500,2E3,2125,2250,100,200,300,400,500,4E3,10500,100,200,300,400,500,600,700,800,900,8900,15900,21400,27400,33900,38900,44900,51900,800,1E3,1200,1400,1600,1800,2E3,2200,2400,2600,NaN,80,160,240,320,400,480,560,640,720,800,880,960,1040,5040,9040,12790,16540,19290,22040,25790,7671,7771,7871,7971,8071,8171,8271,100,200,300,400,500,600,700,800,900,1E3,1100,1200,6200,9700,13200,17200,21200,25200,29200,35200,
100,200,300,400,500,600,9600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,5300,11300,17300,27300,37300,49300,64300,8E3,8228,8457,8685,8914,9142,9371,80,160,240,320,400,480,560,640,720,800,880,960,4960,8460,11460,14460,18460,22460,28460,8E3,8228,8456,8684,8912,9140,9367,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,5400,8900,12900,16900,22900,28900,5E3,5143,5286,5429,5572,5715,5857,121,232,361,508,629,758,879,1018,1165,1425,1445,1465,1536,1692,100,200,300,400,500,600,700,800,
900,1E3,1100,1200,1300,5300,8300,11300,14800,18800,23300,29300,6E3,6171,6343,6514,6685,6857,7028,125,250,375,500,625,750,875,1E3,1125,1250,1375,1500,6500,10500,13500,16500,19500,23E3,27E3,31500,8E3,8185,8370,8555,8740,8925,9108,14E3,14143,14286,14429,14572,14715,14857,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4300,7800,11300,15300,19300,23800,29800,1E4,10107,10214,10321,10428,10535,10643,10750,10857,10964,11071,11178,11285,11393,190,369,547,726,904,1073,1241,1325,1398,1429,1586,1754,
1922,2100,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,4900,8400,12900,17400,22400,27400,8E3,8250,8500,8750,9E3,9250,9500,9750,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4800,7800,10800,14300,17800,21800,26300,5E3,5086,5171,5257,5342,5428,5513,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4800,8300,11800,15800,19800,24300,29300,5E3,5157,5314,5471,5628,5785,5943,125,250,375,500,625,3125,3250,3375,100,200,300,400,500,600,4600,8600,14600,15600,14E3,14143,14286,14429,
14572,14715,14857,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,7400,10900,14400,18400,22400,28400,180,360,540,720,900,1080,10080,100,200,350,500,600,700,800,950,1100,1250,1400,1550,1700,6200,8700,11700,15200,18700,22700,27700,6E3,6120,6240,6360,6480,6600,6720,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,7400,10900,14900,18900,23400,29400,8E3,8150,8300,8450,8600,8750,8900,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,4400,7400,10900,14900,19900,5E3,5100,
5200,5300,5400,5500,5600,116,232,348,464,522,580,638,696,812,928,1044,1160,1276,1392,100,200,300,400,500,600,700,800,900,1E3,1100,1200,5200,8700,11700,14700,18700,22700,28700,8E3,8228,8456,8684,8912,9140,9367,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,6900,10900,14400,18400,22400,27400,7E3,7100,7200,7300,7400,7500,7600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,5300,8600,10800,13E3,15500,19500,24E3,8E3,8100,8200,8300,8400,8500,8600,100,200,300,400,500,600,700,800,900,
1E3,1100,1200,1300,5300,8800,12300,16300,20300,24300,29300,6E3,6100,6200,6300,6400,6500,6600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,1500,1600,1630,1730,1830,1930,2030,2130,2230,2330,5330,8330,11330,7E3,7150,7300,7450,7600,7750,7900,100,200,300,400,500,600,700,800,900,1E3,1100,1200,5200,8700,12200,15700,20200,24700,29700,34700,8E3,8080,8163,8246,8330,8413,8496,8580,8663,8746,8830,8913,8996,9080,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4800,7800,10800,14300,17800,
21800,26300,5E3,5086,5171,5257,5342,5428,5513,5599,5684,5770,5855,5941,6026,6112,125,250,375,500,625,750,875,1E3,1125,1250,1375,1500,1625,5625,8625,11625,14625,18125,22125,26625,8E3,8185,8370,8555,8740,8925,9108,190,369,547,726,904,1073,1241,1325,1398,1429,1586,1754,1922,2100,100,200,300,400,500,600,700,800,900,1E3,1100,6100,10600,14600,18100,21600,26100,30600,35600,40600,8E3,8150,8300,8450,8600,8750,8900,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,1500,1600,1700,6700,10700,11300,
6E3,6200,6400,6600,6800,7E3,7200,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,10400,100,200,300,400,500,600,8600];d=k.delay;var na=d.length;ta[k.expl_small_hole][1]=-na;for(c=n=0;14>n;n++)c+=66,d[n+na]=c;d.put(c+3E4);d=new Float32Array(d);ch=function(f){g.useProgram(ma);g.uniform4fv(E,f);g.useProgram(Z);g.uniform4fv(v,f)};xf=function(f){if(f.clientX>z.menumx||Pc||!f.clientX){f=.07*Math.sign(f.deltaY)*ba;var b=(ba+f)*tzar.height*.03125;(ba+f)*tzar.width*.03125-(ba+f)*z.mx/32>x||b>la||
(ba+=f,.08>ba&&(ba=.08),sb(),jd(-gb,-rb),g.useProgram(ma),g.uniform1f(Mc,1/ba),g.useProgram(Z),g.uniform1f(Oc,1/ba))}};window.addEventListener("wheel",xf,!1);dh=function(){na=[gb,rb];g.useProgram(ma);g.uniform2fv(gd,na);g.useProgram(Z);g.uniform2fv(id,na)};ch(eh());M(eh());g.uniform1f(Oc,1);g.uniform2fv(id,[0,0]);var O=g.createFramebuffer(),bc;kd=function(){var f=window.innerWidth,b=window.innerHeight;tzar.width=f;tzar.height=b;g.useProgram(ma);g.uniform2f(rf,f,b);g.useProgram(Z);O.width=f;O.height=
b;g.activeTexture(g.TEXTURE2);bc||(bc=g.createTexture());g.bindTexture(g.TEXTURE_2D,bc);g.texImage2D(g.TEXTURE_2D,0,g.RGBA,f,b,0,g.RGBA,g.UNSIGNED_BYTE,null);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE);g.bindFramebuffer(g.FRAMEBUFFER,O);g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,
bc,0);g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT);g.bindFramebuffer(g.FRAMEBUFFER,null);ba=1;g.uniform1f(Oc,1/ba);g.uniform1i(g.getUniformLocation(Z,"lightmap"),2);g.useProgram(ma);g.uniform1i(g.getUniformLocation(ma,"lightmap"),2);g.uniform1f(Mc,1/ba);g.useProgram(Z);g.uniform2f(Td,f,b);g.viewport(z.mx,0,f,b);kd.changed=1;jd(-gb,-rb)};kd.changed=0;window.addEventListener("resize",kd,!1);kd();g.blendEquation(g.FUNC_ADD);g.blendFunc(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA);g.disable(g.DITHER);g.disable(g.BLEND);
performance.now();c=g.createTexture();h=J.info;M(w);g.bindTexture(g.TEXTURE_2D,c);g.texImage2D(g.TEXTURE_2D,0,g.RGBA32F,512,512,0,g.RGBA,g.FLOAT,h);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.REPEAT);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.REPEAT);g.bindTexture(g.TEXTURE_2D,null);g.activeTexture(g.TEXTURE0);g.bindTexture(g.TEXTURE_2D,c);g.uniform1i(g.getUniformLocation(Z,
"u_image1"),0);g.activeTexture(g.TEXTURE1);c=g.createTexture();g.bindTexture(g.TEXTURE_2D_ARRAY,c);g.texParameteri(g.TEXTURE_2D_ARRAY,g.TEXTURE_MAG_FILTER,g.NEAREST);g.texParameteri(g.TEXTURE_2D_ARRAY,g.TEXTURE_MIN_FILTER,g.NEAREST);h=J.common;l=h.length;r=J.xtra;n=0;for(q=r.length;n<q;l+=r[n++].length);M(J);g.texImage3D(g.TEXTURE_2D_ARRAY,0,g.RGBA,J.size,J.size,l/(4*J.size*J.size),0,g.RGBA,g.UNSIGNED_BYTE,null);l=h.length;g.texSubImage3D(g.TEXTURE_2D_ARRAY,0,0,0,0,J.size,J.size,h.length/(4*J.size*
J.size),g.RGBA,g.UNSIGNED_BYTE,h);n=0;for(q=r.length;n<q;n++)h=r[n],g.texSubImage3D(g.TEXTURE_2D_ARRAY,0,0,0,l/1048576,J.size,J.size,h.length/(4*J.size*J.size),g.RGBA,g.UNSIGNED_BYTE,h),l+=h.length;M(l);g.activeTexture(g.TEXTURE1);g.bindTexture(g.TEXTURE_2D_ARRAY,c);g.uniform1i(g.getUniformLocation(Z,"img_common"),1);g.useProgram(ma);g.activeTexture(g.TEXTURE0);g.bindTexture(g.TEXTURE_2D_ARRAY,c);g.uniform1i(g.getUniformLocation(ma,"img_common"),0);g.useProgram(ma);g.activeTexture(g.TEXTURE1);c=g.createTexture();
g.bindTexture(g.TEXTURE_2D,c);g.texImage2D(g.TEXTURE_2D,0,g.R8I,x,la,0,g.RED_INTEGER,g.BYTE,f);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.REPEAT);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.REPEAT);g.bindTexture(g.TEXTURE_2D,null);g.bindTexture(g.TEXTURE_2D,c);g.uniform1i(g.getUniformLocation(ma,"img_data"),1);g.useProgram(Z);g.activeTexture(g.TEXTURE2);ed||(M(d),g.activeTexture(g.TEXTURE3),
c=g.createTexture(),g.bindTexture(g.TEXTURE_2D,c),g.texImage2D(g.TEXTURE_2D,0,g.R16F,d.length,1,0,g.RED,g.FLOAT,d),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.REPEAT),g.bindTexture(g.TEXTURE_2D,null),g.bindTexture(g.TEXTURE_2D,c),g.uniform1i(g.getUniformLocation(Z,"delay"),3),g.activeTexture(g.TEXTURE2),yf=g.createTexture(),
g.bindTexture(g.TEXTURE_2D,yf),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,1,1,0,g.RGBA,g.UNSIGNED_BYTE,new Uint8Array([255,255,255,255])),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.REPEAT),g.clearColor(0,0,0,1));g.bindFramebuffer(g.FRAMEBUFFER,O);O.width=1;O.height=1;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,
bc,0);g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT);g.bindFramebuffer(g.FRAMEBUFFER,null);new Float32Array(8);zf=g.createBuffer();Af=g.createBuffer();fh=g.createBuffer();n=0;for(q=Bf.length;n<q;n++)Sa(Bf[n]);g.enable(g.DEPTH_TEST);g.depthFunc(g.LEQUAL);Za.fp1000=1E3;Za.delta=0;Za.now=0;Za.frameCount=0;g.bindTexture(g.TEXTURE_2D,bc);ed=J.setup=!0}function Qc(f,b,a){f=b||Qc;M(f);if(z.gl){u.editor?(z.marx=0,z.mary=60,z.menumy=60,$a=Tb=171,z.mx=0,z.menumx=171):(z.mx=151,$a=Tb=128,z.menumx=151,z.menumy=
0,z.marx=4,z.mary=31);lc.style.width=Tb+"px";lc.style.height=$a+"px";lc.style.left=z.marx+"px";lc.style.top=z.mary+"px";B("loading").style.display="block";origin=!1;M(J.load,J.images);if(J.load<J.images||!J.images)return J.started||(B("qdgraphics")&&(B("qdgraphics").style.display="none"),Cf()),B("loadingtext").innerHTML=A.waitImages,Gb=f,!1;if(Df.last!==B("terrainSelect").value)return Ef=!0,B("loadingtext").innerHTML="Downloading terrain",xj(),Gb=f,!1;yj();B("notifybottom").style.display="none";void 0==
u.arje&&Ff();u.demo?B("saveGame").style.display="none":B("saveGame").style.display="block";M(G);if(!a){a=0;for(f=G.length;a<f;a++){b=G[a];for(var c=[0],d=0;d<f;d++)c[d+1]=G[d].team==b.team?0:1;c.put(1);u.online&&b.id===z.onlineID&&(z.kingdom=a+1);new cc(b.name,b.color,c,b.race,b.IA,[u.goldRes,u.woodRes,u.foodRes,u.stoneRes],b.team)}new cc("",[255,255,255],[0],!0)}z.kingdom||(z.kingdom=1);zj();return!0}Ub("You can't run WEBGL 2<br>More info <a href='http://webglreport.com/?v=2'>here</a>","Error")}
function Gf(){Hf("playingMenu")}function Aj(f){M("setup:",f);f.toSend=[];f.orderList=[];f.sendDirectly("channelMessage","nehhof",{});f.channels.channelMessage.onopen=function(){M("DATACHANNEL OPEN");for(var b=0,a=G.length;b<a;b++)if(G[b].id==f.id)f.username=G[b].name,Vb[b]&&(Vb[b].style.background="#00ff00",Vb[b].style.boxShadow="0px 0px 30px 0px #00ff00");else if(G[b].id==z.onlineID){var c=G[b],d=c.color;M("sending");d="#"+(16777216+(d[0]<<16)+(d[1]<<8)+d[2]).toString(16).slice(1);ca(If,d,0,[f],
2);ca(Jf,c.team,0,[f],2);ca(Kf,c.race,0,[f],2);ca(gh,z.name,0,[f],2)}};f.channels.channelMessage.onerror=function(f){M(f)}}function hh(){document.getElementById("buttons").innerHTML="";document.getElementById("onlineID").value="";document.getElementById("gameName").innerHTML=""}function Lf(){z.p2p?(z.p2p.emit("getRooms"),B("returnmenu").style.display="block"):(Fa||Hb(),Hb.func=Lf)}function ih(){var f=location,b=f.hash.substr(1);""==b&&(document.getElementById("returnmenu").style.display="none");if("MatchX"==
b.substr(0,6))6<b.length&&Bj(b.substr(6-b.length));else if("Room"==f.hash.substr(-4))f=f.hash.substr(1),z.admin||jh(f.substr(0,f.length-4));else if(kh[b])kh[b]();else f.hash=""}function lh(f){var b=new Date;f=new Uint32Array(f);for(var a,c=x,d=0;d<R.length;d++)R[d]!=f[d]&&(a=f[d],R[d]=a,a=y[a],a.x32=d%c,a.y32=~~(d/c));console.log(new Date-b)}function mh(f){f=new Uint32Array(f);console.log(f)}function Hf(f){f=document.getElementById(f);f.style.display="none"==f.style.display?"block":"none"}function nh(f){f.style.display=
"none"==f.style.display?"block":"none"}function oh(f){L=function(){};Ib=!1;var b=da;b.d=f.d;ObjectsetupIMG(b,f.img);b.active=!0;hb=w[52];ld=f;document.addEventListener("mousemove",Mf);document.addEventListener("mousedown",Vd)}function Cj(f,b){return f.innerHTML-b.innerHTML}(function(f){"object"===typeof exports&&"undefined"!==typeof module?module.exports=f():"function"===typeof define&&define.amd?define([],f):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?
self:this).SimpleWebRTC=f()})(function(){return function d(b,a,c){function e(h,t){if(!a[h]){if(!b[h]){var p="function"==typeof require&&require;if(!t&&p)return p(h,!0);if(l)return l(h,!0);t=Error("Cannot find module '"+h+"'");throw t.code="MODULE_NOT_FOUND",t;}t=a[h]={exports:{}};b[h][0].call(t.exports,function(a){var d=b[h][1][a];return e(d?d:a)},t,t.exports,d,b,a,c)}return a[h].exports}for(var l="function"==typeof require&&require,t=0;t<c.length;t++)e(c[t]);return e}({1:[function(b,a,c){function d(){}
a.exports=function(b,a,c){function e(b,d){if(0>=e.count)throw Error("after called too many times");--e.count;b?(h=!0,a(b),a=c):0!==e.count||h||a(null,d)}var h=!1;c=c||d;e.count=b;return 0===b?a():e}},{}],2:[function(b,a,c){a.exports=function(b,a,c){var d=b.byteLength;a=a||0;c=c||d;if(b.slice)return b.slice(a,c);0>a&&(a+=d);0>c&&(c+=d);c>d&&(c=d);if(a>=d||a>=c||0===d)return new ArrayBuffer(0);b=new Uint8Array(b);d=new Uint8Array(c-a);for(var e=0;a<c;a++,e++)d[e]=b[a];return d.buffer}},{}],3:[function(b,
a,c){a.exports=function(b,a,c){var d,e=a;a={autoplay:!0,mirror:!1,muted:!1,audio:!1,disableContextMenu:!1};if(c)for(d in c)a[d]=c[d];e?"audio"===e.tagName.toLowerCase()&&(a.audio=!0):e=document.createElement(a.audio?"audio":"video");a.disableContextMenu&&(e.oncontextmenu=function(b){b.preventDefault()});a.autoplay&&(e.autoplay="autoplay");a.muted&&(e.muted=!0);!a.audio&&a.mirror&&["","moz","webkit","o","ms"].forEach(function(b){e.style[b?b+"Transform":"transform"]="scaleX(-1)"});e.srcObject=b;return e}},
{}],4:[function(b,a,c){function d(b){b=b||{};this.ms=b.min||100;this.max=b.max||1E4;this.factor=b.factor||2;this.jitter=0<b.jitter&&1>=b.jitter?b.jitter:0;this.attempts=0}a.exports=d;d.prototype.duration=function(){var b=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var a=Math.random(),d=Math.floor(a*this.jitter*b);b=0==(Math.floor(10*a)&1)?b-d:b+d}return Math.min(b,this.max)|0};d.prototype.reset=function(){this.attempts=0};d.prototype.setMin=function(b){this.ms=b};d.prototype.setMax=
function(b){this.max=b};d.prototype.setJitter=function(b){this.jitter=b}},{}],5:[function(b,a,c){(function(b){c.encode=function(a){a=new Uint8Array(a);var d,c=a.length,e="";for(d=0;d<c;d+=3)e+=b[a[d]>>2],e+=b[(a[d]&3)<<4|a[d+1]>>4],e+=b[(a[d+1]&15)<<2|a[d+2]>>6],e+=b[a[d+2]&63];2===c%3?e=e.substring(0,e.length-1)+"=":1===c%3&&(e=e.substring(0,e.length-2)+"==");return e};c.decode=function(a){var d=.75*a.length,c=a.length,e=0;"="===a[a.length-1]&&(d--,"="===a[a.length-2]&&d--);var h=new ArrayBuffer(d),
n=new Uint8Array(h);for(d=0;d<c;d+=4){var q=b.indexOf(a[d]);var r=b.indexOf(a[d+1]);var V=b.indexOf(a[d+2]);var Da=b.indexOf(a[d+3]);n[e++]=q<<2|r>>4;n[e++]=(r&15)<<4|V>>2;n[e++]=(V&3)<<6|Da&63}return h}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],6:[function(b,a,c){(function(b){function d(b){for(var a=0;a<b.length;a++){var d=b[a];if(d.buffer instanceof ArrayBuffer){var c=d.buffer;if(d.byteLength!==c.byteLength){var e=new Uint8Array(d.byteLength);e.set(new Uint8Array(c,
d.byteOffset,d.byteLength));c=e.buffer}b[a]=c}}}function c(b,a){a=a||{};var c=new p;d(b);for(var e=0;e<b.length;e++)c.append(b[e]);return a.type?c.getBlob(a.type):c.getBlob()}function e(b,a){d(b);return new Blob(b,a||{})}var p=b.BlobBuilder||b.WebKitBlobBuilder||b.MSBlobBuilder||b.MozBlobBuilder;try{var m=2===(new Blob(["hi"])).size}catch(r){m=!1}var n;if(n=m)try{n=2===(new Blob([new Uint8Array([1,2])])).size}catch(r){n=!1}var q=p&&p.prototype.append&&p.prototype.getBlob;b=m?n?b.Blob:e:q?c:void 0;
a.exports=b}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],7:[function(b,a,c){var d=[].slice;a.exports=function(b,a){"string"==typeof a&&(a=b[a]);if("function"!=typeof a)throw Error("bind() requires a function");var c=d.call(arguments,2);return function(){return a.apply(b,c.concat(d.call(arguments)))}}},{}],8:[function(b,a,c){function d(b){if(b){for(var a in d.prototype)b[a]=d.prototype[a];return b}}a.exports=d;d.prototype.on=
d.prototype.addEventListener=function(b,a){this._callbacks=this._callbacks||{};(this._callbacks[b]=this._callbacks[b]||[]).push(a);return this};d.prototype.once=function(b,a){function d(){c.off(b,d);a.apply(this,arguments)}var c=this;this._callbacks=this._callbacks||{};d.fn=a;this.on(b,d);return this};d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(b,a){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks=
{},this;var d=this._callbacks[b];if(!d)return this;if(1==arguments.length)return delete this._callbacks[b],this;for(var c,e=0;e<d.length;e++)if(c=d[e],c===a||c.fn===a){d.splice(e,1);break}return this};d.prototype.emit=function(b){this._callbacks=this._callbacks||{};var a=[].slice.call(arguments,1),d=this._callbacks[b];if(d){d=d.slice(0);for(var c=0,e=d.length;c<e;++c)d[c].apply(this,a)}return this};d.prototype.listeners=function(b){this._callbacks=this._callbacks||{};return this._callbacks[b]||[]};
d.prototype.hasListeners=function(b){return!!this.listeners(b).length}},{}],9:[function(b,a,c){a.exports=function(b,a){var d=function(){};d.prototype=a.prototype;b.prototype=new d;b.prototype.constructor=b}},{}],10:[function(b,a,c){function d(b){return d.enabled(b)?function(a){a instanceof Error&&(a=a.stack||a.message);var c=new Date,e=c-(d[b]||c);d[b]=c;a=b+" "+a+" +"+d.humanize(e);window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}a.exports=d;
d.names=[];d.skips=[];d.enable=function(b){try{localStorage.debug=b}catch(m){}for(var a=(b||"").split(/[\s,]+/),c=a.length,e=0;e<c;e++)b=a[e].replace("*",".*?"),"-"===b[0]?d.skips.push(new RegExp("^"+b.substr(1)+"$")):d.names.push(new RegExp("^"+b+"$"))};d.disable=function(){d.enable("")};d.humanize=function(b){return 36E5<=b?(b/36E5).toFixed(1)+"h":6E4<=b?(b/6E4).toFixed(1)+"m":1E3<=b?(b/1E3|0)+"s":b+"ms"};d.enabled=function(b){for(var a=0,c=d.skips.length;a<c;a++)if(d.skips[a].test(b))return!1;
a=0;for(c=d.names.length;a<c;a++)if(d.names[a].test(b))return!0;return!1};try{window.localStorage&&d.enable(localStorage.debug)}catch(h){}},{}],11:[function(b,a,c){a.exports=b("./lib/")},{"./lib/":12}],12:[function(b,a,c){a.exports=b("./socket");a.exports.parser=b("engine.io-parser")},{"./socket":13,"engine.io-parser":24}],13:[function(b,a,c){(function(d){function c(b,a){if(!(this instanceof c))return new c(b,a);a=a||{};b&&"object"==typeof b&&(a=b,b=null);b&&(b=q(b),a.host=b.host,a.secure="https"==
b.protocol||"wss"==b.protocol,a.port=b.port,b.query&&(a.query=b.query));this.secure=null!=a.secure?a.secure:d.location&&"https:"==location.protocol;a.host&&(b=a.host.split(":"),a.hostname=b.shift(),b.length?a.port=b.pop():a.port||(a.port=this.secure?"443":"80"));this.agent=a.agent||!1;this.hostname=a.hostname||(d.location?location.hostname:"localhost");this.port=a.port||(d.location&&location.port?location.port:this.secure?443:80);this.query=a.query||{};"string"==typeof this.query&&(this.query=V.decode(this.query));
this.upgrade=!1!==a.upgrade;this.path=(a.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!a.forceJSONP;this.jsonp=!1!==a.jsonp;this.forceBase64=!!a.forceBase64;this.enablesXDR=!!a.enablesXDR;this.timestampParam=a.timestampParam||"t";this.timestampRequests=a.timestampRequests;this.transports=a.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.callbackBuffer=[];this.policyPort=a.policyPort||843;this.rememberUpgrade=a.rememberUpgrade||!1;this.binaryType=null;
this.onlyBinaryUpgrades=a.onlyBinaryUpgrades;this.pfx=a.pfx||null;this.key=a.key||null;this.passphrase=a.passphrase||null;this.cert=a.cert||null;this.ca=a.ca||null;this.ciphers=a.ciphers||null;this.rejectUnauthorized=a.rejectUnauthorized||null;this.open()}var e=b("./transports"),t=b("component-emitter"),p=b("debug")("engine.io-client:socket"),m=b("indexof"),n=b("engine.io-parser"),q=b("parseuri"),r=b("parsejson"),V=b("parseqs");a.exports=c;c.priorWebsocketSuccess=!1;t(c.prototype);c.protocol=n.protocol;
c.Socket=c;c.Transport=b("./transport");c.transports=b("./transports");c.parser=b("engine.io-parser");c.prototype.createTransport=function(b){p('creating transport "%s"',b);var a=this.query,c={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);c.EIO=n.protocol;c.transport=b;this.id&&(c.sid=this.id);return new e[b]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:c,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,
timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})};c.prototype.open=function(){if(this.rememberUpgrade&&c.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))var b="websocket";else{if(0==this.transports.length){var a=this;setTimeout(function(){a.emit("error","No transports available")},
0);return}b=this.transports[0]}this.readyState="opening";try{b=this.createTransport(b)}catch(E){this.transports.shift();this.open();return}b.open();this.setTransport(b)};c.prototype.setTransport=function(b){p("setting transport %s",b.name);var a=this;this.transport&&(p("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=b;b.on("drain",function(){a.onDrain()}).on("packet",function(b){a.onPacket(b)}).on("error",function(b){a.onError(b)}).on("close",
function(){a.onClose("transport close")})};c.prototype.probe=function(b){function a(){if(r.onlyBinaryUpgrades){var a=!this.supportsBinary&&r.transport.supportsBinary;q=q||a}q||(p('probe transport "%s" opened',b),n.send([{type:"ping",data:"probe"}]),n.once("packet",function(a){q||("pong"==a.type&&"probe"==a.data?(p('probe transport "%s" pong',b),r.upgrading=!0,r.emit("upgrading",n),n&&(c.priorWebsocketSuccess="websocket"==n.name,p('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){q||
"closed"==r.readyState||(p("changing transport and sending upgrade packet"),m(),r.setTransport(n),n.send([{type:"upgrade"}]),r.emit("upgrade",n),n=null,r.upgrading=!1,r.flush())}))):(p('probe transport "%s" failed',b),a=Error("probe error"),a.transport=n.name,r.emit("upgradeError",a)))}))}function d(){q||(q=!0,m(),n.close(),n=null)}function e(a){var c=Error("probe error: "+a);c.transport=n.name;d();p('probe transport "%s" failed because of error: %s',b,a);r.emit("upgradeError",c)}function h(){e("transport closed")}
function l(){e("socket closed")}function t(b){n&&b.name!=n.name&&(p('"%s" works - aborting "%s"',b.name,n.name),d())}function m(){n.removeListener("open",a);n.removeListener("error",e);n.removeListener("close",h);r.removeListener("close",l);r.removeListener("upgrading",t)}p('probing transport "%s"',b);var n=this.createTransport(b,{probe:1}),q=!1,r=this;c.priorWebsocketSuccess=!1;n.once("open",a);n.once("error",e);n.once("close",h);this.once("close",l);this.once("upgrading",t);n.open()};c.prototype.onOpen=
function(){p("socket open");this.readyState="open";c.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){p("starting upgrade probes");for(var b=0,a=this.upgrades.length;b<a;b++)this.probe(this.upgrades[b])}};c.prototype.onPacket=function(b){if("opening"==this.readyState||"open"==this.readyState)switch(p('socket receive: type "%s", data "%s"',b.type,b.data),this.emit("packet",b),this.emit("heartbeat"),
b.type){case "open":this.onHandshake(r(b.data));break;case "pong":this.setPing();break;case "error":var a=Error("server error");a.code=b.data;this.emit("error",a);break;case "message":this.emit("data",b.data),this.emit("message",b.data)}else p('packet received with socket readyState "%s"',this.readyState)};c.prototype.onHandshake=function(b){this.emit("handshake",b);this.id=b.sid;this.transport.query.sid=b.sid;this.upgrades=this.filterUpgrades(b.upgrades);this.pingInterval=b.pingInterval;this.pingTimeout=
b.pingTimeout;this.onOpen();"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};c.prototype.onHeartbeat=function(b){clearTimeout(this.pingTimeoutTimer);var a=this;a.pingTimeoutTimer=setTimeout(function(){if("closed"!=a.readyState)a.onClose("ping timeout")},b||a.pingInterval+a.pingTimeout)};c.prototype.setPing=function(){var b=this;clearTimeout(b.pingIntervalTimer);b.pingIntervalTimer=setTimeout(function(){p("writing ping packet - expecting pong within %sms",
b.pingTimeout);b.ping();b.onHeartbeat(b.pingTimeout)},b.pingInterval)};c.prototype.ping=function(){this.sendPacket("ping")};c.prototype.onDrain=function(){for(var b=0;b<this.prevBufferLen;b++)if(this.callbackBuffer[b])this.callbackBuffer[b]();this.writeBuffer.splice(0,this.prevBufferLen);this.callbackBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0==this.writeBuffer.length?this.emit("drain"):this.flush()};c.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&
this.writeBuffer.length&&(p("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};c.prototype.write=c.prototype.send=function(b,a){this.sendPacket("message",b,a);return this};c.prototype.sendPacket=function(b,a,c){"closing"!=this.readyState&&"closed"!=this.readyState&&(b={type:b,data:a},this.emit("packetCreate",b),this.writeBuffer.push(b),this.callbackBuffer.push(c),this.flush())};c.prototype.close=
function(){if("opening"==this.readyState||"open"==this.readyState){var b=function(){d.once("upgrade",a);d.once("upgradeError",a)},a=function(){d.removeListener("upgrade",a);d.removeListener("upgradeError",a);c()},c=function(){d.onClose("forced close");p("socket closing - telling transport to close");d.transport.close()};this.readyState="closing";var d=this;if(this.writeBuffer.length)this.once("drain",function(){this.upgrading?b():c()});else this.upgrading?b():c()}return this};c.prototype.onError=
function(b){p("socket error %j",b);c.priorWebsocketSuccess=!1;this.emit("error",b);this.onClose("transport error",b)};c.prototype.onClose=function(b,a){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){p('socket close with reason: "%s"',b);var c=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);setTimeout(function(){c.writeBuffer=[];c.callbackBuffer=[];c.prevBufferLen=0},0);this.transport.removeAllListeners("close");this.transport.close();
this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",b,a)}};c.prototype.filterUpgrades=function(b){for(var a=[],c=0,d=b.length;c<d;c++)~m(this.transports,b[c])&&a.push(b[c]);return a}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":8,debug:21,"engine.io-parser":24,indexof:32,parsejson:40,parseqs:41,parseuri:23}],14:[function(b,a,c){function d(b){this.path=
b.path;this.hostname=b.hostname;this.port=b.port;this.secure=b.secure;this.query=b.query;this.timestampParam=b.timestampParam;this.timestampRequests=b.timestampRequests;this.readyState="";this.agent=b.agent||!1;this.socket=b.socket;this.enablesXDR=b.enablesXDR;this.pfx=b.pfx;this.key=b.key;this.passphrase=b.passphrase;this.cert=b.cert;this.ca=b.ca;this.ciphers=b.ciphers;this.rejectUnauthorized=b.rejectUnauthorized}var e=b("engine.io-parser");b=b("component-emitter");a.exports=d;b(d.prototype);d.timestamps=
0;d.prototype.onError=function(b,a){b=Error(b);b.type="TransportError";b.description=a;this.emit("error",b);return this};d.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this};d.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this};d.prototype.send=function(b){if("open"==this.readyState)this.write(b);else throw Error("Transport not open");};d.prototype.onOpen=
function(){this.readyState="open";this.writable=!0;this.emit("open")};d.prototype.onData=function(b){b=e.decodePacket(b,this.socket.binaryType);this.onPacket(b)};d.prototype.onPacket=function(b){this.emit("packet",b)};d.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":8,"engine.io-parser":24}],15:[function(b,a,c){(function(a){var d=b("xmlhttprequest"),e=b("./polling-xhr"),t=b("./polling-jsonp"),p=b("./websocket");c.polling=function(b){var c=!1,h=!1,l=
!1!==b.jsonp;a.location&&(h="https:"==location.protocol,(c=location.port)||(c=h?443:80),c=b.hostname!=location.hostname||c!=b.port,h=b.secure!=h);b.xdomain=c;b.xscheme=h;if("open"in new d(b)&&!b.forceJSONP)return new e(b);if(!l)throw Error("JSONP disabled");return new t(b)};c.websocket=p}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(b,a,
c){(function(c){function d(){}function e(b){t.call(this,b);this.query=this.query||{};q||(c.___eio||(c.___eio=[]),q=c.___eio);this.index=q.length;var a=this;q.push(function(b){a.onData(b)});this.query.j=this.index;c.document&&c.addEventListener&&c.addEventListener("beforeunload",function(){a.script&&(a.script.onerror=d)},!1)}var t=b("./polling"),p=b("component-inherit");a.exports=e;var m=/\n/g,n=/\\n/g,q;p(e,t);e.prototype.supportsBinary=!1;e.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),
this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.iframe=this.form=null);t.prototype.doClose.call(this)};e.prototype.doPoll=function(){var b=this,a=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);a.async=!0;a.src=this.uri();a.onerror=function(a){b.onError("jsonp poll error",a)};var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(a,c);this.script=a;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&
setTimeout(function(){var b=document.createElement("iframe");document.body.appendChild(b);document.body.removeChild(b)},100)};e.prototype.doWrite=function(b,a){function c(){d();a()}function d(){if(e.iframe)try{e.form.removeChild(e.iframe)}catch(wf){e.onError("jsonp polling iframe removal error",wf)}try{p=document.createElement('<iframe src="javascript:0" name="'+e.iframeId+'">')}catch(wf){p=document.createElement("iframe"),p.name=e.iframeId,p.src="javascript:0"}p.id=e.iframeId;e.form.appendChild(p);
e.iframe=p}var e=this;if(!this.form){var h=document.createElement("form"),l=document.createElement("textarea"),t=this.iframeId="eio_iframe_"+this.index,p;h.className="socketio";h.style.position="absolute";h.style.top="-1000px";h.style.left="-1000px";h.target=t;h.method="POST";h.setAttribute("accept-charset","utf-8");l.name="d";h.appendChild(l);document.body.appendChild(h);this.form=h;this.area=l}this.form.action=this.uri();d();b=b.replace(n,"\\\n");this.area.value=b.replace(m,"\\n");try{this.form.submit()}catch(wf){}this.iframe.attachEvent?
this.iframe.onreadystatechange=function(){"complete"==e.iframe.readyState&&c()}:this.iframe.onload=c}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-inherit":9}],17:[function(b,a,c){(function(c){function d(){}function e(b){n.call(this,b);if(c.location){var a="https:"==location.protocol,d=location.port;d||(d=a?443:80);this.xd=b.hostname!=c.location.hostname||d!=b.port;this.xs=b.secure!=a}}function t(b){this.method=
b.method||"GET";this.uri=b.uri;this.xd=!!b.xd;this.xs=!!b.xs;this.async=!1!==b.async;this.data=void 0!=b.data?b.data:null;this.agent=b.agent;this.isBinary=b.isBinary;this.supportsBinary=b.supportsBinary;this.enablesXDR=b.enablesXDR;this.pfx=b.pfx;this.key=b.key;this.passphrase=b.passphrase;this.cert=b.cert;this.ca=b.ca;this.ciphers=b.ciphers;this.rejectUnauthorized=b.rejectUnauthorized;this.create()}function p(){for(var b in t.requests)t.requests.hasOwnProperty(b)&&t.requests[b].abort()}var m=b("xmlhttprequest"),
n=b("./polling"),q=b("component-emitter"),r=b("component-inherit"),V=b("debug")("engine.io-client:polling-xhr");a.exports=e;a.exports.Request=t;r(e,n);e.prototype.supportsBinary=!0;e.prototype.request=function(b){b=b||{};b.uri=this.uri();b.xd=this.xd;b.xs=this.xs;b.agent=this.agent||!1;b.supportsBinary=this.supportsBinary;b.enablesXDR=this.enablesXDR;b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;
return new t(b)};e.prototype.doWrite=function(b,a){b=this.request({method:"POST",data:b,isBinary:"string"!==typeof b&&void 0!==b});var c=this;b.on("success",a);b.on("error",function(b){c.onError("xhr post error",b)});this.sendXhr=b};e.prototype.doPoll=function(){V("xhr poll");var b=this.request(),a=this;b.on("data",function(b){a.onData(b)});b.on("error",function(b){a.onError("xhr poll error",b)});this.pollXhr=b};q(t.prototype);t.prototype.create=function(){var b={agent:this.agent,xdomain:this.xd,
xscheme:this.xs,enablesXDR:this.enablesXDR};b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;var a=this.xhr=new m(b),d=this;try{V("xhr open %s: %s",this.method,this.uri);a.open(this.method,this.uri,this.async);this.supportsBinary&&(a.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?a.setRequestHeader("Content-type","application/octet-stream"):a.setRequestHeader("Content-type",
"text/plain;charset=UTF-8")}catch(vf){}"withCredentials"in a&&(a.withCredentials=!0);this.hasXDR()?(a.onload=function(){d.onLoad()},a.onerror=function(){d.onError(a.responseText)}):a.onreadystatechange=function(){if(4==a.readyState)if(200==a.status||1223==a.status)d.onLoad();else setTimeout(function(){d.onError(a.status)},0)};V("xhr data %s",this.data);a.send(this.data)}catch(vf){setTimeout(function(){d.onError(vf)},0);return}c.document&&(this.index=t.requestsCount++,t.requests[this.index]=this)};
t.prototype.onSuccess=function(){this.emit("success");this.cleanup()};t.prototype.onData=function(b){this.emit("data",b);this.onSuccess()};t.prototype.onError=function(b){this.emit("error",b);this.cleanup(!0)};t.prototype.cleanup=function(b){if("undefined"!=typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=this.xhr.onerror=d:this.xhr.onreadystatechange=d;if(b)try{this.xhr.abort()}catch(Ra){}c.document&&delete t.requests[this.index];this.xhr=null}};t.prototype.onLoad=function(){try{try{var b=
this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(E){}var a="application/octet-stream"===b?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(E){this.onError(E)}if(null!=a)this.onData(a)};t.prototype.hasXDR=function(){return"undefined"!==typeof c.XDomainRequest&&!this.xs&&this.enablesXDR};t.prototype.abort=function(){this.cleanup()};c.document&&(t.requestsCount=0,t.requests={},c.attachEvent?c.attachEvent("onunload",p):c.addEventListener&&c.addEventListener("beforeunload",
p,!1))}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-emitter":8,"component-inherit":9,debug:21,xmlhttprequest:20}],18:[function(b,a,c){function d(b){var a=b&&b.forceBase64;if(!m||a)this.supportsBinary=!1;e.call(this,b)}var e=b("../transport"),l=b("parseqs"),t=b("engine.io-parser");c=b("component-inherit");var p=b("debug")("engine.io-client:polling");a.exports=d;var m=null!=(new (b("xmlhttprequest"))({xdomain:!1})).responseType;
c(d,e);d.prototype.name="polling";d.prototype.doOpen=function(){this.poll()};d.prototype.pause=function(b){function a(){p("paused");c.readyState="paused";b()}var c=this;this.readyState="pausing";if(this.polling||!this.writable){var d=0;this.polling&&(p("we are currently polling - waiting to pause"),d++,this.once("pollComplete",function(){p("pre-pause polling complete");--d||a()}));this.writable||(p("we are currently writing - waiting to pause"),d++,this.once("drain",function(){p("pre-pause writing complete");
--d||a()}))}else a()};d.prototype.poll=function(){p("polling");this.polling=!0;this.doPoll();this.emit("poll")};d.prototype.onData=function(b){var a=this;p("polling got data %s",b);t.decodePayload(b,this.socket.binaryType,function(b,c,d){if("opening"==a.readyState)a.onOpen();if("close"==b.type)return a.onClose(),!1;a.onPacket(b)});"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():p('ignoring poll - transport state "%s"',this.readyState))};d.prototype.doClose=
function(){function b(){p("writing close packet");a.write([{type:"close"}])}var a=this;"open"==this.readyState?(p("transport open - closing"),b()):(p("transport not open - deferring close"),this.once("open",b))};d.prototype.write=function(b){var a=this;this.writable=!1;var c=function(){a.writable=!0;a.emit("drain")};a=this;t.encodePayload(b,this.supportsBinary,function(b){a.doWrite(b,c)})};d.prototype.uri=function(){var b=this.query||{},a=this.secure?"https":"http",c="";!1!==this.timestampRequests&&
(b[this.timestampParam]=+new Date+"-"+e.timestamps++);this.supportsBinary||b.sid||(b.b64=1);b=l.encode(b);this.port&&("https"==a&&443!=this.port||"http"==a&&80!=this.port)&&(c=":"+this.port);b.length&&(b="?"+b);return a+"://"+this.hostname+c+this.path+b}},{"../transport":14,"component-inherit":9,debug:21,"engine.io-parser":24,parseqs:41,xmlhttprequest:20}],19:[function(b,a,c){function d(b){b&&b.forceBase64&&(this.supportsBinary=!1);e.call(this,b)}var e=b("../transport"),l=b("engine.io-parser"),t=
b("parseqs");c=b("component-inherit");var p=b("debug")("engine.io-client:websocket"),m=b("ws");a.exports=d;c(d,e);d.prototype.name="websocket";d.prototype.supportsBinary=!0;d.prototype.doOpen=function(){if(this.check()){var b=this.uri(),a={agent:this.agent};a.pfx=this.pfx;a.key=this.key;a.passphrase=this.passphrase;a.cert=this.cert;a.ca=this.ca;a.ciphers=this.ciphers;a.rejectUnauthorized=this.rejectUnauthorized;this.ws=new m(b,void 0,a);void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.binaryType=
"arraybuffer";this.addEventListeners()}};d.prototype.addEventListeners=function(){var b=this;this.ws.onopen=function(){b.onOpen()};this.ws.onclose=function(){b.onClose()};this.ws.onmessage=function(a){b.onData(a.data)};this.ws.onerror=function(a){b.onError("websocket error",a)}};"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(d.prototype.onData=function(b){var a=this;setTimeout(function(){e.prototype.onData.call(a,b)},0)});d.prototype.write=function(b){var a=this;this.writable=
!1;for(var c=0,d=b.length;c<d;c++)l.encodePacket(b[c],this.supportsBinary,function(b){try{a.ws.send(b)}catch(Ra){p("websocket closed before onclose event")}});setTimeout(function(){a.writable=!0;a.emit("drain")},0)};d.prototype.onClose=function(){e.prototype.onClose.call(this)};d.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()};d.prototype.uri=function(){var b=this.query||{},a=this.secure?"wss":"ws",c="";this.port&&("wss"==a&&443!=this.port||"ws"==a&&80!=this.port)&&(c=
":"+this.port);this.timestampRequests&&(b[this.timestampParam]=+new Date);this.supportsBinary||(b.b64=1);b=t.encode(b);b.length&&(b="?"+b);return a+"://"+this.hostname+c+this.path+b};d.prototype.check=function(){return!!m&&!("__initialize"in m&&this.name===d.prototype.name)}},{"../transport":14,"component-inherit":9,debug:21,"engine.io-parser":24,parseqs:41,ws:66}],20:[function(b,a,c){var d=b("has-cors");a.exports=function(b){var a=b.xdomain,c=b.xscheme;b=b.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&
(!a||d))return new XMLHttpRequest}catch(p){}try{if("undefined"!=typeof XDomainRequest&&!c&&b)return new XDomainRequest}catch(p){}if(!a)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(p){}}},{"has-cors":31}],21:[function(b,a,c){function d(){try{var b=localStorage.debug}catch(l){}return b}c=a.exports=b("./debug");c.log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)};c.formatArgs=function(){var b=arguments,
a=this.useColors;b[0]=(a?"%c":"")+this.namespace+(a?" %c":" ")+b[0]+(a?"%c ":" ")+"+"+c.humanize(this.diff);if(!a)return b;a="color: "+this.color;b=[b[0],a,"color: inherit"].concat(Array.prototype.slice.call(b,1));var d=0,e=0;b[0].replace(/%[a-z%]/g,function(b){"%%"!==b&&(d++,"%c"===b&&(e=d))});b.splice(e,0,a);return b};c.save=function(b){try{null==b?localStorage.removeItem("debug"):localStorage.debug=b}catch(l){}};c.load=d;c.useColors=function(){return"WebkitAppearance"in document.documentElement.style||
window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)};c.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");c.formatters.j=function(b){return JSON.stringify(b)};c.enable(d())},{"./debug":22}],22:[function(b,a,c){c=a.exports=function(b){function a(){}function h(){var b=+new Date;h.diff=b-(e||b);h.prev=e;e=h.curr=b;null==h.useColors&&(h.useColors=c.useColors());null==
h.color&&h.useColors&&(h.color=c.colors[d++%c.colors.length]);var a=Array.prototype.slice.call(arguments);a[0]=c.coerce(a[0]);"string"!==typeof a[0]&&(a=["%o"].concat(a));var l=0;a[0]=a[0].replace(/%([a-z%])/g,function(b,d){if("%%"===b)return b;l++;d=c.formatters[d];"function"===typeof d&&(b=d.call(h,a[l]),a.splice(l,1),l--);return b});"function"===typeof c.formatArgs&&(a=c.formatArgs.apply(h,a));(h.log||c.log||console.log.bind(console)).apply(h,a)}a.enabled=!1;h.enabled=!0;var l=c.enabled(b)?h:a;
l.namespace=b;return l};c.coerce=function(b){return b instanceof Error?b.stack||b.message:b};c.disable=function(){c.enable("")};c.enable=function(b){c.save(b);for(var a=(b||"").split(/[\s,]+/),d=a.length,e=0;e<d;e++)a[e]&&(b=a[e].replace(/\*/g,".*?"),"-"===b[0]?c.skips.push(new RegExp("^"+b.substr(1)+"$")):c.names.push(new RegExp("^"+b+"$")))};c.enabled=function(b){var a;var d=0;for(a=c.skips.length;d<a;d++)if(c.skips[d].test(b))return!1;d=0;for(a=c.names.length;d<a;d++)if(c.names[d].test(b))return!0;
return!1};c.humanize=b("ms");c.names=[];c.skips=[];c.formatters={};var d=0,e},{ms:38}],23:[function(b,a,c){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");a.exports=function(b){var a=b,c=b.indexOf("["),
h=b.indexOf("]");-1!=c&&-1!=h&&(b=b.substring(0,c)+b.substring(c,h).replace(/:/g,";")+b.substring(h,b.length));b=d.exec(b||"");for(var l={},q=14;q--;)l[e[q]]=b[q]||"";-1!=c&&-1!=h&&(l.source=a,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0);return l}},{}],24:[function(b,a,c){(function(a){function d(b,a,d){if(!a)return c.encodeBase64Packet(b,d);var e=new FileReader;e.onload=function(){b.data=e.result;
c.encodePacket(b,a,!0,d)};return e.readAsArrayBuffer(b.data)}function e(b,a,c){var d=Array(b.length);c=q(b.length,c);for(var e=function(b,c,e){a(c,function(a,c){d[b]=c;e(a,d)})},h=0;h<b.length;h++)e(h,b[h],c)}var t=b("./keys"),p=b("has-binary"),m=b("arraybuffer.slice"),n=b("base64-arraybuffer"),q=b("after"),r=b("utf8"),V=navigator.userAgent.match(/Android/i),g=/PhantomJS/i.test(navigator.userAgent),k=V||g;c.protocol=3;var E=c.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},u=t(E),
na={type:"error",data:"parser error"},O=b("blob");c.encodePacket=function(b,e,h,l){"function"==typeof e&&(l=e,e=!1);"function"==typeof h&&(l=h,h=null);var t=void 0===b.data?void 0:b.data.buffer||b.data;if(a.ArrayBuffer&&t instanceof ArrayBuffer){if(e){h=b.data;e=new Uint8Array(h);h=new Uint8Array(1+h.byteLength);h[0]=E[b.type];for(b=0;b<e.length;b++)h[b+1]=e[b];b=l(h.buffer)}else b=c.encodeBase64Packet(b,l);return b}if(O&&t instanceof a.Blob)return e?k?b=d(b,e,l):(e=new Uint8Array(1),e[0]=E[b.type],
b=new O([e.buffer,b.data]),b=l(b)):b=c.encodeBase64Packet(b,l),b;if(t&&t.base64)return l("b"+c.packets[b.type]+b.data.data);e=E[b.type];void 0!==b.data&&(e+=h?r.encode(String(b.data)):String(b.data));return l(""+e)};c.encodeBase64Packet=function(b,d){var e="b"+c.packets[b.type];if(O&&b.data instanceof O){var h=new FileReader;h.onload=function(){var b=h.result.split(",")[1];d(e+b)};return h.readAsDataURL(b.data)}try{var l=String.fromCharCode.apply(null,new Uint8Array(b.data))}catch(Wk){b=new Uint8Array(b.data);
l=Array(b.length);for(var t=0;t<b.length;t++)l[t]=b[t];l=String.fromCharCode.apply(null,l)}e+=a.btoa(l);return d(e)};c.decodePacket=function(b,a,d){if("string"==typeof b||void 0===b){if("b"==b.charAt(0))return c.decodeBase64Packet(b.substr(1),a);if(d)try{b=r.decode(b)}catch(Vk){return na}d=b.charAt(0);return Number(d)==d&&u[d]?1<b.length?{type:u[d],data:b.substring(1)}:{type:u[d]}:na}d=(new Uint8Array(b))[0];b=m(b,1);O&&"blob"===a&&(b=new O([b]));return{type:u[d],data:b}};c.decodeBase64Packet=function(b,
c){var d=u[b.charAt(0)];if(!a.ArrayBuffer)return{type:d,data:{base64:!0,data:b.substr(1)}};b=n.decode(b.substr(1));"blob"===c&&O&&(b=new O([b]));return{type:d,data:b}};c.encodePayload=function(b,a,d){"function"==typeof a&&(d=a,a=null);var h=p(b);if(a&&h)return O&&!k?c.encodePayloadAsBlob(b,d):c.encodePayloadAsArrayBuffer(b,d);if(!b.length)return d("0:");e(b,function(b,d){c.encodePacket(b,h?a:!1,!0,function(b){d(null,b.length+":"+b)})},function(b,a){return d(a.join(""))})};c.decodePayload=function(b,
a,d){if("string"!=typeof b)return c.decodePayloadAsBinary(b,a,d);"function"===typeof a&&(d=a,a=null);if(""==b)return d(na,0,1);var e="";for(var h,l,t=0,p=b.length;t<p;t++)if(l=b.charAt(t),":"!=l)e+=l;else{if(""==e||e!=(h=Number(e)))return d(na,0,1);l=b.substr(t+1,h);if(e!=l.length)return d(na,0,1);if(l.length){e=c.decodePacket(l,a,!0);if(na.type==e.type&&na.data==e.data)return d(na,0,1);if(!1===d(e,t+h,p))return}t+=h;e=""}if(""!=e)return d(na,0,1)};c.encodePayloadAsArrayBuffer=function(b,a){if(!b.length)return a(new ArrayBuffer(0));
e(b,function(b,a){c.encodePacket(b,!0,!0,function(b){return a(null,b)})},function(b,c){b=c.reduce(function(b,a){a="string"===typeof a?a.length:a.byteLength;return b+a.toString().length+a+2},0);var d=new Uint8Array(b),e=0;c.forEach(function(b){var a="string"===typeof b,c=b;if(a){c=new Uint8Array(b.length);for(var h=0;h<b.length;h++)c[h]=b.charCodeAt(h);c=c.buffer}a?d[e++]=0:d[e++]=1;b=c.byteLength.toString();for(h=0;h<b.length;h++)d[e++]=parseInt(b[h]);d[e++]=255;c=new Uint8Array(c);for(h=0;h<c.length;h++)d[e++]=
c[h]});return a(d.buffer)})};c.encodePayloadAsBlob=function(b,a){e(b,function(b,a){c.encodePacket(b,!0,!0,function(b){var c=new Uint8Array(1);c[0]=1;if("string"===typeof b){for(var d=new Uint8Array(b.length),e=0;e<b.length;e++)d[e]=b.charCodeAt(e);b=d.buffer;c[0]=0}d=(b instanceof ArrayBuffer?b.byteLength:b.size).toString();var h=new Uint8Array(d.length+1);for(e=0;e<d.length;e++)h[e]=parseInt(d[e]);h[d.length]=255;O&&(b=new O([c.buffer,h.buffer,b]),a(null,b))})},function(b,c){return a(new O(c))})};
c.decodePayloadAsBinary=function(b,a,d){"function"===typeof a&&(d=a,a=null);for(var e=[],h=!1;0<b.byteLength;){for(var l=new Uint8Array(b),t=0===l[0],p="",n=1;255!=l[n];n++){if(310<p.length){h=!0;break}p+=l[n]}if(h)return d(na,0,1);b=m(b,2+p.length);p=parseInt(p);l=m(b,0,p);if(t)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(Xk){for(t=new Uint8Array(l),l="",n=0;n<t.length;n++)l+=String.fromCharCode(t[n])}e.push(l);b=m(b,p)}var q=e.length;e.forEach(function(b,e){d(c.decodePacket(b,a,
!0),e,q)})}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./keys":25,after:1,"arraybuffer.slice":2,"base64-arraybuffer":5,blob:6,"has-binary":30,utf8:60}],25:[function(b,a,c){a.exports=Object.keys||function(b){var a=[],c=Object.prototype.hasOwnProperty,d;for(d in b)c.call(b,d)&&a.push(d);return a}},{}],26:[function(b,a,c){function d(b){l.call(this);b=b||{};this.config={chunksize:16384,pacing:0};for(var a in b)this.config[a]=
b[a];this.channel=this.file=null}function e(){l.call(this);this.receiveBuffer=[];this.received=0;this.metadata={};this.channel=null}var l=b("wildemitter");b=b("util");b.inherits(d,l);d.prototype.send=function(b,a){var c=this;this.file=b;this.channel=a;var d="number"!==typeof a.bufferedAmountLowThreshold,e=0,h=function(){var l=new window.FileReader;l.onload=function(){return function(l){c.channel.send(l.target.result);c.emit("progress",e,b.size,l.target.result);b.size>e+l.target.result.byteLength?
d?window.setTimeout(h,c.config.pacing):a.bufferedAmount<=a.bufferedAmountLowThreshold&&window.setTimeout(h,0):(c.emit("progress",b.size,b.size,null),c.emit("sentFile"));e+=c.config.chunksize}}(b);var t=b.slice(e,e+c.config.chunksize);l.readAsArrayBuffer(t)};d||(a.bufferedAmountLowThreshold=8*this.config.chunksize,a.addEventListener("bufferedamountlow",h));window.setTimeout(h,0)};b.inherits(e,l);e.prototype.receive=function(b,a){var c=this;b&&(this.metadata=b);this.channel=a;a.binaryType="arraybuffer";
this.channel.onmessage=function(b){c.received+=b.data.byteLength;c.receiveBuffer.push(b.data);c.emit("progress",c.received,c.metadata.size,b.data);c.received===c.metadata.size?(c.emit("receivedFile",new window.Blob(c.receiveBuffer),c.metadata),c.receiveBuffer=[]):c.received>c.metadata.size&&(console.error("received more than expected, discarding..."),c.receiveBuffer=[])}};a.exports={};a.exports.support="undefined"!==typeof window&&window&&window.File&&window.FileReader&&window.Blob;a.exports.Sender=
d;a.exports.Receiver=e},{util:63,wildemitter:65}],27:[function(b,a,c){var d={};a.exports=function(b,a){var c=2===arguments.length,e=c?a:b;if("undefined"===typeof window||"http:"===window.location.protocol){var h=Error("NavigatorUserMediaError");h.name="HTTPS_REQUIRED";return e(h)}if(window.navigator.userAgent.match("Chrome")){var l=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),q=33,r=!window.chrome.webstore;window.navigator.userAgent.match("Linux")&&(q=35);sessionStorage.getScreenMediaJSExtensionId?
chrome.runtime.sendMessage(sessionStorage.getScreenMediaJSExtensionId,{type:"getScreen",id:1},null,function(a){a&&""!==a.sourceId?(b=c&&b||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3}}},b.video.mandatory.chromeMediaSourceId=a.sourceId,window.navigator.mediaDevices.getUserMedia(b).then(function(b){e(null,b)}).catch(function(b){e(b)})):(a=Error("NavigatorUserMediaError"),a.name="NotAllowedError",e(a))}):window.cefGetScreenMedia?
window.cefGetScreenMedia(function(a){a?(b=c&&b||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},b.video.mandatory.chromeMediaSourceId=a,window.navigator.mediaDevices.getUserMedia(b).then(function(b){e(null,b)}).catch(function(b){e(b)})):(a=Error("cefGetScreenMediaError"),a.name="CEF_GETSCREENMEDIA_CANCELED",e(a))}):r||26<=l&&l<=q?(b=c&&b||{video:{mandatory:{googLeakyBucket:!0,
maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3,chromeMediaSource:"screen"}}},window.navigator.mediaDevices.getUserMedia(b).then(function(b){e(null,b)}).catch(function(b){e(b)})):(l=window.setTimeout(function(){h=Error("NavigatorUserMediaError");h.name="EXTENSION_UNAVAILABLE";return e(h)},1E3),d[l]=[e,c?b:null],window.postMessage({type:"getScreen",id:l},"*"))}else window.navigator.userAgent.match("Firefox")&&(33<=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],
10)?(b=c&&b||{video:{mozMediaSource:"window",mediaSource:"window"}},window.navigator.mediaDevices.getUserMedia(b).then(function(b){e(null,b);var a=b.currentTime,c=window.setInterval(function(){b||window.clearInterval(c);if(b.currentTime==a&&(window.clearInterval(c),b.onended))b.onended();a=b.currentTime},500)}).catch(function(b){e(b)})):(h=Error("NavigatorUserMediaError"),h.name="EXTENSION_UNAVAILABLE"))};"undefined"!==typeof window&&window.addEventListener("message",function(b){if(b.origin==window.location.origin)if("gotScreen"==
b.data.type&&d[b.data.id]){var a=d[b.data.id],c=a[1],e=a[0];delete d[b.data.id];""===b.data.sourceId?(b=Error("NavigatorUserMediaError"),b.name="NotAllowedError",e(b)):(c=c||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},c.video.mandatory.chromeMediaSourceId=b.data.sourceId,window.navigator.mediaDevices.getUserMedia(c).then(function(b){e(null,b)}).catch(function(b){e(b)}))}else"getScreenPending"==
b.data.type&&window.clearTimeout(b.data.id)})},{}],28:[function(b,a,c){a.exports=function(){return this}()},{}],29:[function(b,a,c){var d=b("wildemitter"),e;"undefined"!==typeof window&&(e=window.AudioContext||window.webkitAudioContext);var l=null;a.exports=function(b,a){var c=new d;if(!e)return c;a=a||{};var h=a.smoothing||.1,t=a.interval||50,p=a.threshold,V=a.play;a=a.history||10;var g=!0;l||(l=new e);var k=l.createAnalyser();k.fftSize=512;k.smoothingTimeConstant=h;var E=new Float32Array(k.frequencyBinCount);
b.jquery&&(b=b[0]);if(b instanceof HTMLAudioElement||b instanceof HTMLVideoElement){var u=l.createMediaElementSource(b);"undefined"===typeof V&&(V=!0)}else u=l.createMediaStreamSource(b);p=p||-50;u.connect(k);V&&k.connect(l.destination);c.speaking=!1;c.setThreshold=function(b){p=b};c.setInterval=function(b){t=b};c.stop=function(){g=!1;c.emit("volume_change",-100,p);c.speaking&&(c.speaking=!1,c.emit("stopped_speaking"));k.disconnect();u.disconnect()};c.speakingHistory=[];for(b=0;b<a;b++)c.speakingHistory.push(0);
var na=function(){setTimeout(function(){if(g){var b=-Infinity;k.getFloatFrequencyData(E);for(var a=4,d=E.length;a<d;a++)E[a]>b&&0>E[a]&&(b=E[a]);c.emit("volume_change",b,p);a=0;if(b>p&&!c.speaking){for(d=c.speakingHistory.length-3;d<c.speakingHistory.length;d++)a+=c.speakingHistory[d];2<=a&&(c.speaking=!0,c.emit("speaking"))}else if(b<p&&c.speaking){for(d=0;d<c.speakingHistory.length;d++)a+=c.speakingHistory[d];0==a&&(c.speaking=!1,c.emit("stopped_speaking"))}c.speakingHistory.shift();c.speakingHistory.push(0+
(b>p));na()}},t)};na();return c}},{wildemitter:65}],30:[function(b,a,c){(function(c){var d=b("isarray");a.exports=function(b){function a(b){if(!b)return!1;if(c.Buffer&&c.Buffer.isBuffer(b)||c.ArrayBuffer&&b instanceof ArrayBuffer||c.Blob&&b instanceof Blob||c.File&&b instanceof File)return!0;if(d(b))for(var e=0;e<b.length;e++){if(a(b[e]))return!0}else if(b&&"object"==typeof b)for(e in b.toJSON&&(b=b.toJSON()),b)if(Object.prototype.hasOwnProperty.call(b,e)&&a(b[e]))return!0;return!1}return a(b)}}).call(this,
"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{isarray:33}],31:[function(b,a,c){b=b("global");try{a.exports="XMLHttpRequest"in b&&"withCredentials"in new b.XMLHttpRequest}catch(d){a.exports=!1}},{global:28}],32:[function(b,a,c){var d=[].indexOf;a.exports=function(b,a){if(d)return b.indexOf(a);for(var c=0;c<b.length;++c)if(b[c]===a)return c;return-1}},{}],33:[function(b,a,c){a.exports=Array.isArray||function(b){return"[object Array]"==Object.prototype.toString.call(b)}},
{}],34:[function(b,a,c){(function(b){function a(b){if(a[b]!==p)return a[b];if("bug-string-char-index"==b)var c=!1;else if("json"==b)c=a("json-stringify")&&a("json-parse");else{var e;if("json-stringify"==b){c=n.stringify;var h="function"==typeof c&&q;if(h){(e=function(){return 1}).toJSON=e;try{h="0"===c(0)&&"0"===c(new Number)&&'""'==c(new String)&&c(d)===p&&c(p)===p&&c()===p&&"1"===c(e)&&"[1]"==c([e])&&"[null]"==c([p])&&"null"==c(null)&&"[null,null,null]"==c([p,d,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==
c({a:[e,!0,!1,null,"\x00\b\n\f\r\t"]})&&"1"===c(null,e)&&"[\n 1,\n 2\n]"==c([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==c(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==c(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==c(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==c(new Date(-1))}catch(Wb){h=!1}}c=h}if("json-parse"==b){c=n.parse;if("function"==typeof c)try{if(0===c("0")&&!c(!1)){e=c('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var l=5==e.a.length&&1===e.a[0];if(l){try{l=
!c('"\t"')}catch(Wb){}if(l)try{l=1!==c("01")}catch(Wb){}if(l)try{l=1!==c("1.")}catch(Wb){}}}}catch(Wb){l=!1}c=l}}return a[b]=!!c}var d={}.toString,e,p,m="object"==typeof JSON&&JSON,n="object"==typeof c&&c&&!c.nodeType&&c;n&&m?(n.stringify=m.stringify,n.parse=m.parse):n=b.JSON=m||{};var q=new Date(-0xc782b5b800cec);try{q=-109252==q.getUTCFullYear()&&0===q.getUTCMonth()&&1===q.getUTCDate()&&10==q.getUTCHours()&&37==q.getUTCMinutes()&&6==q.getUTCSeconds()&&708==q.getUTCMilliseconds()}catch(Yk){}if(!a("json")){var r=
a("bug-string-char-index");if(!q)var V=Math.floor,g=[0,31,59,90,120,151,181,212,243,273,304,334],k=function(b,a){return g[a]+365*(b-1970)+V((b-1969+(a=+(1<a)))/4)-V((b-1901+a)/100)+V((b-1601+a)/400)};(e={}.hasOwnProperty)||(e=function(b){var a={};if((a.__proto__=null,a.__proto__={toString:1},a).toString!=d)e=function(b){var a=this.__proto__;b=b in(this.__proto__=null,this);this.__proto__=a;return b};else{var c=a.constructor;e=function(b){var a=(this.constructor||c).prototype;return b in this&&!(b in
a&&this[b]===a[b])}}a=null;return e.call(this,b)});var E={"boolean":1,number:1,string:1,undefined:1};var u=function(b,a){var c=0,h,l;(h=function(){this.valueOf=0}).prototype.valueOf=0;var t=new h;for(l in t)e.call(t,l)&&c++;h=t=null;c?u=2==c?function(b,a){var c={},h="[object Function]"==d.call(b),l;for(l in b)h&&"prototype"==l||e.call(c,l)||!(c[l]=1)||!e.call(b,l)||a(l)}:function(b,a){var c="[object Function]"==d.call(b),h,l;for(h in b)c&&"prototype"==h||!e.call(b,h)||(l="constructor"===h)||a(h);
(l||e.call(b,h="constructor"))&&a(h)}:(t="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),u=function(b,a){var c="[object Function]"==d.call(b),h,l;if(l=!c&&"function"!=typeof b.constructor)l=typeof b.hasOwnProperty,l="object"==l?!!b.hasOwnProperty:!E[l];l=l?b.hasOwnProperty:e;for(h in b)c&&"prototype"==h||!l.call(b,h)||a(h);for(c=t.length;h=t[--c];l.call(b,h)&&a(h));});return u(b,a)};if(!a("json-stringify")){var na={92:"\\\\",34:'\\"',8:"\\b",
12:"\\f",10:"\\n",13:"\\r",9:"\\t"},O=function(b,a){return("000000"+(a||0)).slice(-b)},v=function(b){var a='"',c=0,d=b.length,e=10<d&&r,h;for(e&&(h=b.split(""));c<d;c++){var l=b.charCodeAt(c);switch(l){case 8:case 9:case 10:case 12:case 13:case 34:case 92:a+=na[l];break;default:a=32>l?a+("\\u00"+O(2,l.toString(16))):a+(e?h[c]:r?b.charAt(c):b[c])}}return a+'"'},y=function(b,a,c,h,l,t,m){var n;try{var q=a[b]}catch($k){}if("object"==typeof q&&q){var r=d.call(q);if("[object Date]"!=r||e.call(q,"toJSON"))"function"==
typeof q.toJSON&&("[object Number]"!=r&&"[object String]"!=r&&"[object Array]"!=r||e.call(q,"toJSON"))&&(q=q.toJSON(b));else if(q>-1/0&&q<1/0){if(k){var g=V(q/864E5);for(r=V(g/365.2425)+1970-1;k(r+1,0)<=g;r++);for(n=V((g-k(r,0))/30.42);k(r,n+1)<=g;n++);g=1+g-k(r,n);var Da=(q%864E5+864E5)%864E5;var Ra=V(Da/36E5)%24;var E=V(Da/6E4)%60;var na=V(Da/1E3)%60;Da%=1E3}else r=q.getUTCFullYear(),n=q.getUTCMonth(),g=q.getUTCDate(),Ra=q.getUTCHours(),E=q.getUTCMinutes(),na=q.getUTCSeconds(),Da=q.getUTCMilliseconds();
q=(0>=r||1E4<=r?(0>r?"-":"+")+O(6,0>r?-r:r):O(4,r))+"-"+O(2,n+1)+"-"+O(2,g)+"T"+O(2,Ra)+":"+O(2,E)+":"+O(2,na)+"."+O(3,Da)+"Z"}else q=null}c&&(q=c.call(a,b,q));if(null===q)return"null";r=d.call(q);if("[object Boolean]"==r)return""+q;if("[object Number]"==r)return q>-1/0&&q<1/0?""+q:"null";if("[object String]"==r)return v(""+q);if("object"==typeof q){for(b=m.length;b--;)if(m[b]===q)throw TypeError();m.push(q);var x=[];a=t;t+=l;if("[object Array]"==r){n=0;for(b=q.length;n<b;n++)r=y(n,q,c,h,l,t,m),x.push(r===
p?"null":r);b=x.length?l?"[\n"+t+x.join(",\n"+t)+"\n"+a+"]":"["+x.join(",")+"]":"[]"}else u(h||q,function(b){var a=y(b,q,c,h,l,t,m);a!==p&&x.push(v(b)+":"+(l?" ":"")+a)}),b=x.length?l?"{\n"+t+x.join(",\n"+t)+"\n"+a+"}":"{"+x.join(",")+"}":"{}";m.pop();return b}};n.stringify=function(b,a,c){var e;if("function"==typeof a||"object"==typeof a&&a)if("[object Function]"==(e=d.call(a)))var h=a;else if("[object Array]"==e){var l={};for(var t=0,p=a.length,m;t<p;m=a[t++],(e=d.call(m),"[object String]"==e||
"[object Number]"==e)&&(l[m]=1));}if(c)if("[object Number]"==(e=d.call(c))){if(0<(c-=c%1)){var n="";for(10<c&&(c=10);n.length<c;n+=" ");}}else"[object String]"==e&&(n=10>=c.length?c:c.slice(0,10));return y("",(m={},m[""]=b,m),h,l,n,"",[])}}if(!a("json-parse")){var w=String.fromCharCode,B={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},x,z,A=function(){x=z=null;throw SyntaxError();},F=function(){for(var b=z,a=b.length,c,d,e,h,l;x<a;)switch(l=b.charCodeAt(x),l){case 9:case 10:case 13:case 32:x++;
break;case 123:case 125:case 91:case 93:case 58:case 44:return c=r?b.charAt(x):b[x],x++,c;case 34:c="@";for(x++;x<a;)if(l=b.charCodeAt(x),32>l)A();else if(92==l)switch(l=b.charCodeAt(++x),l){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:c+=B[l];x++;break;case 117:d=++x;for(e=x+4;x<e;x++)l=b.charCodeAt(x),48<=l&&57>=l||97<=l&&102>=l||65<=l&&70>=l||A();c+=w("0x"+b.slice(d,x));break;default:A()}else{if(34==l)break;l=b.charCodeAt(x);for(d=x;32<=l&&92!=l&&34!=l;)l=b.charCodeAt(++x);
c+=b.slice(d,x)}if(34==b.charCodeAt(x))return x++,c;A();default:d=x;45==l&&(h=!0,l=b.charCodeAt(++x));if(48<=l&&57>=l){for(48==l&&(l=b.charCodeAt(x+1),48<=l&&57>=l)&&A();x<a&&(l=b.charCodeAt(x),48<=l&&57>=l);x++);if(46==b.charCodeAt(x)){for(e=++x;e<a&&(l=b.charCodeAt(e),48<=l&&57>=l);e++);e==x&&A();x=e}l=b.charCodeAt(x);if(101==l||69==l){l=b.charCodeAt(++x);43!=l&&45!=l||x++;for(e=x;e<a&&(l=b.charCodeAt(e),48<=l&&57>=l);e++);e==x&&A();x=e}return+b.slice(d,x)}h&&A();if("true"==b.slice(x,x+4))return x+=
4,!0;if("false"==b.slice(x,x+5))return x+=5,!1;if("null"==b.slice(x,x+4))return x+=4,null;A()}return"$"},D=function(b){var a,c;"$"==b&&A();if("string"==typeof b){if("@"==(r?b.charAt(0):b[0]))return b.slice(1);if("["==b){for(a=[];;c||(c=!0)){b=F();if("]"==b)break;c&&(","==b?(b=F(),"]"==b&&A()):A());","==b&&A();a.push(D(b))}return a}if("{"==b){for(a={};;c||(c=!0)){b=F();if("}"==b)break;c&&(","==b?(b=F(),"}"==b&&A()):A());","!=b&&"string"==typeof b&&"@"==(r?b.charAt(0):b[0])&&":"==F()||A();a[b.slice(1)]=
D(F())}return a}A()}return b},C=function(b,a,c){c=K(b,a,c);c===p?delete b[a]:b[a]=c},K=function(b,a,c){var e=b[a],h;if("object"==typeof e&&e)if("[object Array]"==d.call(e))for(h=e.length;h--;)C(e,h,c);else u(e,function(b){C(e,b,c)});return c.call(b,a,e)};n.parse=function(b,a){var c;x=0;z=""+b;b=D(F());"$"!=F()&&A();x=z=null;return a&&"[object Function]"==d.call(a)?K((c={},c[""]=b,c),"",a):b}}}})(this)},{}],35:[function(b,a,c){function d(b){var a=!0;b.getTracks().forEach(function(b){a="ended"===b.readyState&&
a});return a}function e(){if("undefined"===typeof window||!window.navigator.mozGetUserMedia)return!1;var b=window.navigator.userAgent.match(/Firefox\/(\d+)\./);return 50>(b&&1<=b.length&&parseInt(b[1],10))}function l(b){m.call(this);var a=this.config={detectSpeakingEvents:!1,audioFallback:!1,media:{audio:!0,video:!0},harkOptions:null,logger:n},c;for(c in b)b.hasOwnProperty(c)&&(this.config[c]=b[c]);this.logger=a.logger;this._log=this.logger.log.bind(this.logger,"LocalMedia:");this._logerror=this.logger.error.bind(this.logger,
"LocalMedia:");this.localStreams=[];this.localScreens=[];navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||this._logerror("Your browser does not support local media capture.");this._audioMonitors=[];this.on("localStreamStopped",this._stopAudioMonitor.bind(this));this.on("localScreenStopped",this._stopAudioMonitor.bind(this))}c=b("util");var t=b("hark"),p=b("getscreenmedia"),m=b("wildemitter"),n=b("mockconsole");c.inherits(l,m);l.prototype.start=function(b,a){var c=this,e=b||this.config.media;
this.emit("localStreamRequested",e);navigator.mediaDevices.getUserMedia(e).then(function(b){e.audio&&c.config.detectSpeakingEvents&&c._setupAudioMonitor(b,c.config.harkOptions);c.localStreams.push(b);b.getTracks().forEach(function(a){a.addEventListener("ended",function(){d(b)&&c._removeStream(b)})});c.emit("localStream",b);if(a)return a(null,b)}).catch(function(b){if(c.config.audioFallback&&"NotFoundError"===b.name&&!1!==e.video)e.video=!1,c.start(e,a);else if(c.emit("localStreamRequestFailed",e),
a)return a(b,null)})};l.prototype.stop=function(b){this.stopStream(b);this.stopScreenShare(b)};l.prototype.stopStream=function(b){var a=this;b?-1<this.localStreams.indexOf(b)&&(b.getTracks().forEach(function(b){b.stop()}),e()&&this._removeStream(b)):this.localStreams.forEach(function(b){b.getTracks().forEach(function(b){b.stop()});e()&&a._removeStream(b)})};l.prototype.startScreenShare=function(b,a){var c=this;this.emit("localScreenRequested");"function"!==typeof b||a||(a=b,b=null);p(b,function(b,
d){b?c.emit("localScreenRequestFailed"):(c.localScreens.push(d),d.getTracks().forEach(function(b){b.addEventListener("ended",function(){var b=!0;d.getTracks().forEach(function(a){b="ended"===a.readyState&&b});b&&c._removeStream(d)})}),c.emit("localScreen",d));if(a)return a(b,d)})};l.prototype.stopScreenShare=function(b){var a=this;b?-1<this.localScreens.indexOf(b)&&(b.getTracks().forEach(function(b){b.stop()}),e()&&this._removeStream(b)):this.localScreens.forEach(function(b){b.getTracks().forEach(function(b){b.stop()});
e()&&a._removeStream(b)})};l.prototype.mute=function(){this._audioEnabled(!1);this.emit("audioOff")};l.prototype.unmute=function(){this._audioEnabled(!0);this.emit("audioOn")};l.prototype.pauseVideo=function(){this._videoEnabled(!1);this.emit("videoOff")};l.prototype.resumeVideo=function(){this._videoEnabled(!0);this.emit("videoOn")};l.prototype.pause=function(){this.mute();this.pauseVideo()};l.prototype.resume=function(){this.unmute();this.resumeVideo()};l.prototype._audioEnabled=function(b){this.localStreams.forEach(function(a){a.getAudioTracks().forEach(function(a){a.enabled=
!!b})})};l.prototype._videoEnabled=function(b){this.localStreams.forEach(function(a){a.getVideoTracks().forEach(function(a){a.enabled=!!b})})};l.prototype.isAudioEnabled=function(){var b=!0;this.localStreams.forEach(function(a){a.getAudioTracks().forEach(function(a){b=b&&a.enabled})});return b};l.prototype.isVideoEnabled=function(){var b=!0;this.localStreams.forEach(function(a){a.getVideoTracks().forEach(function(a){b=b&&a.enabled})});return b};l.prototype._removeStream=function(b){var a=this.localStreams.indexOf(b);
-1<a?(this.localStreams.splice(a,1),this.emit("localStreamStopped",b)):(a=this.localScreens.indexOf(b),-1<a&&(this.localScreens.splice(a,1),this.emit("localScreenStopped",b)))};l.prototype._setupAudioMonitor=function(b,a){this._log("Setup audio");a=t(b,a);var c=this,d;a.on("speaking",function(){c.emit("speaking")});a.on("stopped_speaking",function(){d&&clearTimeout(d);d=setTimeout(function(){c.emit("stoppedSpeaking")},1E3)});a.on("volume_change",function(b,a){c.emit("volumeChange",b,a)});this._audioMonitors.push({audio:a,
stream:b})};l.prototype._stopAudioMonitor=function(b){var a=-1;this._audioMonitors.forEach(function(c,d){c.stream===b&&(a=d)});-1<a&&(this._audioMonitors[a].audio.stop(),this._audioMonitors.splice(a,1))};a.exports=l},{getscreenmedia:27,hark:29,mockconsole:37,util:63,wildemitter:65}],36:[function(b,a,c){(function(b){function d(b,a){b.set(a[0],a[1]);return b}function e(b,a){b.add(a);return b}function t(b,a){for(var c=-1,d=b?b.length:0;++c<d&&!1!==a(b[c],c,b););return b}function p(b,a,c,d){var e=-1,
h=b?b.length:0;for(d&&h&&(c=b[++e]);++e<h;)c=a(c,b[e],e,b);return c}function m(b){var a=!1;if(null!=b&&"function"!=typeof b.toString)try{a=!!(b+"")}catch(al){}return a}function n(b){var a=-1,c=Array(b.size);b.forEach(function(b,d){c[++a]=[d,b]});return c}function q(b,a){return function(c){return b(a(c))}}function r(b){var a=-1,c=Array(b.size);b.forEach(function(b){c[++a]=b});return c}function g(b){var a=-1,c=b?b.length:0;for(this.clear();++a<c;){var d=b[a];this.set(d[0],d[1])}}function k(b){var a=
-1,c=b?b.length:0;for(this.clear();++a<c;){var d=b[a];this.set(d[0],d[1])}}function Ra(b){var a=-1,c=b?b.length:0;for(this.clear();++a<c;){var d=b[a];this.set(d[0],d[1])}}function E(b){this.__data__=new k(b)}function u(b,a,c){var d=b[a];ba.call(b,a)&&(d===c||d!==d&&c!==c)&&(void 0!==c||a in b)||(b[a]=c)}function na(b,a){for(var c=b.length;c--;){var d=b[c][0];if(d===a||d!==d&&a!==a)return c}return-1}function O(b,a){return b&&z(a,I(a),b)}function x(b,a,c,d,e,h,l){var p;d&&(p=h?d(b,e,h,l):d(b));if(void 0!==
p)return p;if(!Wb(b))return b;if(e=Aa(b)){if(p=C(b),!a)return B(b,p)}else{var n=wa(b),q="[object Function]"==n||"[object GeneratorFunction]"==n;if(va(b))return y(b,a);if("[object Object]"==n||"[object Arguments]"==n||q&&!h){if(m(b))return h?b:{};p=K(q?{}:b);if(!a)return A(b,O(p,b))}else{if(!J[n])return h?b:{};p=H(b,n,x,a)}}l||(l=new E);if(h=l.get(b))return h;l.set(b,p);if(!e)var r=c?v(b,I,Ba):I(b);t(r||b,function(e,h){r&&(h=e,e=b[h]);u(p,h,x(e,a,c,d,h,b,l))});return p}function v(b,a,c){a=a(b);if(!Aa(b)){b=
c(b);c=-1;for(var d=b.length,e=a.length;++c<d;)a[e+c]=b[c]}return a}function y(b,a){if(a)return b.slice();a=new b.constructor(b.length);b.copy(a);return a}function w(b){var a=new b.constructor(b.byteLength);(new X(a)).set(new X(b));return a}function B(b,a){var c=-1,d=b.length;for(a||(a=Array(d));++c<d;)a[c]=b[c];return a}function z(b,a,c,d){c||(c={});for(var e=-1,h=a.length;++e<h;){var l=a[e],t=d?d(c[l],b[l],l,c,b):void 0;u(c,l,void 0===t?b[l]:t)}return c}function A(b,a){return z(b,Ba(b),a)}function F(b,
a){b=b.__data__;var c=typeof a;return("string"==c||"number"==c||"symbol"==c||"boolean"==c?"__proto__"!==a:null===a)?b["string"==typeof a?"string":"hash"]:b.map}function D(b,a){b=null==b?void 0:b[a];a=!Wb(b)||aa&&aa in b?!1:(N(b)||m(b)?fa:U).test(mc(b));return a?b:void 0}function C(b){var a=b.length,c=b.constructor(a);a&&"string"==typeof b[0]&&ba.call(b,"index")&&(c.index=b.index,c.input=b.input);return c}function K(b){"function"!=typeof b.constructor||ph(b)?b={}:(b=ja(b),b=Wb(b)?ka(b):{});return b}
function H(b,a,c,h){var l=b.constructor;switch(a){case "[object ArrayBuffer]":return w(b);case "[object Boolean]":case "[object Date]":return new l(+b);case "[object DataView]":return a=h?w(b.buffer):b.buffer,new b.constructor(a,b.byteOffset,b.byteLength);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return a=
h?w(b.buffer):b.buffer,new b.constructor(a,b.byteOffset,b.length);case "[object Map]":return a=h?c(n(b),!0):n(b),p(a,d,new b.constructor);case "[object Number]":case "[object String]":return new l(b);case "[object RegExp]":return a=new b.constructor(b.source,L.exec(b)),a.lastIndex=b.lastIndex,a;case "[object Set]":return a=h?c(r(b),!0):r(b),p(a,e,new b.constructor);case "[object Symbol]":return za?Object(za.call(b)):{}}}function ph(b){var a=b&&b.constructor;return b===("function"==typeof a&&a.prototype||
S)}function mc(b){if(null!=b){try{return W.call(b)}catch(Ja){}return b+""}return""}function M(b){var a;if(a=null!=b)a=b.length,a="number"==typeof a&&-1<a&&0==a%1&&9007199254740991>=a;return a&&!N(b)}function N(b){b=Wb(b)?da.call(b):"";return"[object Function]"==b||"[object GeneratorFunction]"==b}function Wb(b){var a=typeof b;return!!b&&("object"==a||"function"==a)}function I(b){if(M(b)){var a;(a=Aa(b))||(a=!!b&&"object"==typeof b&&M(b)&&ba.call(b,"callee")&&(!qa.call(b,"callee")||"[object Arguments]"==
da.call(b)));if(a){a=b.length;for(var c=String,d=-1,e=Array(a);++d<a;)e[d]=c(d);a=e}else a=[];c=a.length;d=!!c;for(var h in b){if(!(e=!ba.call(b,h))&&(e=d)&&!(e="length"==h)){e=h;var l=c;l=null==l?9007199254740991:l;e=!!l&&("number"==typeof e||G.test(e))&&-1<e&&0==e%1&&e<l}e||a.push(h)}b=a}else if(ph(b)){h=[];for(a in Object(b))ba.call(b,a)&&"constructor"!=a&&h.push(a);b=h}else b=pa(b);return b}function T(){return[]}function R(){return!1}var L=/\w*$/,U=/^\[object .+?Constructor\]$/,G=/^(?:0|[1-9]\d*)$/,
J={};J["[object Arguments]"]=J["[object Array]"]=J["[object ArrayBuffer]"]=J["[object DataView]"]=J["[object Boolean]"]=J["[object Date]"]=J["[object Float32Array]"]=J["[object Float64Array]"]=J["[object Int8Array]"]=J["[object Int16Array]"]=J["[object Int32Array]"]=J["[object Map]"]=J["[object Number]"]=J["[object Object]"]=J["[object RegExp]"]=J["[object Set]"]=J["[object String]"]=J["[object Symbol]"]=J["[object Uint8Array]"]=J["[object Uint8ClampedArray]"]=J["[object Uint16Array]"]=J["[object Uint32Array]"]=
!0;J["[object Error]"]=J["[object Function]"]=J["[object WeakMap]"]=!1;var Y="object"==typeof self&&self&&self.Object===Object&&self;b="object"==typeof b&&b&&b.Object===Object&&b||Y||Function("return this")();var P=(Y="object"==typeof c&&c&&!c.nodeType&&c)&&"object"==typeof a&&a&&!a.nodeType&&a;Y=P&&P.exports===Y;P=Array.prototype;var Q=Function.prototype,S=Object.prototype,ca=b["__core-js_shared__"],aa=function(){var b=/[^.]+$/.exec(ca&&ca.keys&&ca.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:
""}(),W=Q.toString,ba=S.hasOwnProperty,da=S.toString,fa=RegExp("^"+W.call(ba).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");Q=Y?b.Buffer:void 0;Y=b.Symbol;var X=b.Uint8Array,ja=q(Object.getPrototypeOf,Object),ka=Object.create,qa=S.propertyIsEnumerable,ea=P.splice;P=Object.getOwnPropertySymbols;Q=Q?Q.isBuffer:void 0;var pa=q(Object.keys,Object),ha=D(b,"DataView"),Z=D(b,"Map"),ia=D(b,"Promise"),ma=D(b,"Set");b=D(b,"WeakMap");var la=
D(Object,"create"),xa=mc(ha),oa=mc(Z),sa=mc(ia),ta=mc(ma),ya=mc(b),za=(Y=Y?Y.prototype:void 0)?Y.valueOf:void 0;g.prototype.clear=function(){this.__data__=la?la(null):{}};g.prototype["delete"]=function(b){return this.has(b)&&delete this.__data__[b]};g.prototype.get=function(b){var a=this.__data__;return la?(b=a[b],"__lodash_hash_undefined__"===b?void 0:b):ba.call(a,b)?a[b]:void 0};g.prototype.has=function(b){var a=this.__data__;return la?void 0!==a[b]:ba.call(a,b)};g.prototype.set=function(b,a){this.__data__[b]=
la&&void 0===a?"__lodash_hash_undefined__":a;return this};k.prototype.clear=function(){this.__data__=[]};k.prototype["delete"]=function(b){var a=this.__data__;b=na(a,b);if(0>b)return!1;b==a.length-1?a.pop():ea.call(a,b,1);return!0};k.prototype.get=function(b){var a=this.__data__;b=na(a,b);return 0>b?void 0:a[b][1]};k.prototype.has=function(b){return-1<na(this.__data__,b)};k.prototype.set=function(b,a){var c=this.__data__,d=na(c,b);0>d?c.push([b,a]):c[d][1]=a;return this};Ra.prototype.clear=function(){this.__data__=
{hash:new g,map:new (Z||k),string:new g}};Ra.prototype["delete"]=function(b){return F(this,b)["delete"](b)};Ra.prototype.get=function(b){return F(this,b).get(b)};Ra.prototype.has=function(b){return F(this,b).has(b)};Ra.prototype.set=function(b,a){F(this,b).set(b,a);return this};E.prototype.clear=function(){this.__data__=new k};E.prototype["delete"]=function(b){return this.__data__["delete"](b)};E.prototype.get=function(b){return this.__data__.get(b)};E.prototype.has=function(b){return this.__data__.has(b)};
E.prototype.set=function(b,a){var c=this.__data__;if(c instanceof k){c=c.__data__;if(!Z||199>c.length)return c.push([b,a]),this;c=this.__data__=new Ra(c)}c.set(b,a);return this};var Ba=P?q(P,Object):T,wa=function(b){return da.call(b)};if(ha&&"[object DataView]"!=wa(new ha(new ArrayBuffer(1)))||Z&&"[object Map]"!=wa(new Z)||ia&&"[object Promise]"!=wa(ia.resolve())||ma&&"[object Set]"!=wa(new ma)||b&&"[object WeakMap]"!=wa(new b))wa=function(b){var a=da.call(b);if(b=(b="[object Object]"==a?b.constructor:
void 0)?mc(b):void 0)switch(b){case xa:return"[object DataView]";case oa:return"[object Map]";case sa:return"[object Promise]";case ta:return"[object Set]";case ya:return"[object WeakMap]"}return a};var Aa=Array.isArray,va=Q||R;a.exports=function(b){return x(b,!0,!0)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],37:[function(b,a,c){b="assert count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd time timeEnd trace warn".split(" ");
c=b.length;for(var d=function(){},e={};c--;)e[b[c]]=d;a.exports=e},{}],38:[function(b,a,c){function d(b){if(b=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(b)){var a=parseFloat(b[1]);switch((b[2]||"ms").toLowerCase()){case "years":case "year":case "y":return a*l;case "days":case "day":case "d":return 864E5*a;case "hours":case "hour":case "h":return 36E5*a;case "minutes":case "minute":case "m":return 6E4*a;case "seconds":case "second":case "s":return 1E3*a;case "ms":return a}}}
function e(b,a,c){if(!(b<a))return b<1.5*a?Math.floor(b/a)+" "+c:Math.ceil(b/a)+" "+c+"s"}var l=315576E5;a.exports=function(b,a){a=a||{};return"string"==typeof b?d(b):a.long?e(b,864E5,"day")||e(b,36E5,"hour")||e(b,6E4,"minute")||e(b,1E3,"second")||b+" ms":864E5<=b?Math.round(b/864E5)+"d":36E5<=b?Math.round(b/36E5)+"h":6E4<=b?Math.round(b/6E4)+"m":1E3<=b?Math.round(b/1E3)+"s":b+"ms"}},{}],39:[function(b,a,c){var d=Object.prototype.hasOwnProperty;c.keys=Object.keys||function(b){var a=[],c;for(c in b)d.call(b,
c)&&a.push(c);return a};c.values=function(b){var a=[],c;for(c in b)d.call(b,c)&&a.push(b[c]);return a};c.merge=function(b,a){for(var c in a)d.call(a,c)&&(b[c]=a[c]);return b};c.length=function(b){return c.keys(b).length};c.isEmpty=function(b){return 0==c.length(b)}},{}],40:[function(b,a,c){(function(b){var c=/^[\],:{}\s]*$/,d=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,e=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,p=/(?:^|:|,)(?:\s*\[)+/g,m=/^\s+/,n=/\s+$/;a.exports=function(a){if("string"!=
typeof a||!a)return null;a=a.replace(m,"").replace(n,"");if(b.JSON&&JSON.parse)return JSON.parse(a);if(c.test(a.replace(d,"@").replace(e,"]").replace(p,"")))return(new Function("return "+a))()}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],41:[function(b,a,c){c.encode=function(b){var a="",c;for(c in b)b.hasOwnProperty(c)&&(a.length&&(a+="&"),a+=encodeURIComponent(c)+"="+encodeURIComponent(b[c]));return a};c.decode=function(b){var a=
{};b=b.split("&");for(var c=0,d=b.length;c<d;c++){var e=b[c].split("=");a[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return a}},{}],42:[function(b,a,c){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");
a.exports=function(b){b=d.exec(b||"");for(var a={},c=14;c--;)a[e[c]]=b[c]||"";return a}},{}],43:[function(b,a,c){function d(){throw Error("setTimeout has not been defined");}function e(){throw Error("clearTimeout has not been defined");}function l(b){if(r===setTimeout)return setTimeout(b,0);if((r===d||!r)&&setTimeout)return r=setTimeout,setTimeout(b,0);try{return r(b,0)}catch(O){try{return r.call(null,b,0)}catch(bc){return r.call(this,b,0)}}}function t(b){if(g===clearTimeout)return clearTimeout(b);
if((g===e||!g)&&clearTimeout)return g=clearTimeout,clearTimeout(b);try{return g(b)}catch(O){try{return g.call(null,b)}catch(bc){return g.call(this,b)}}}function p(){Ra&&E&&(Ra=!1,E.length?k=E.concat(k):u=-1,k.length&&m())}function m(){if(!Ra){var b=l(p);Ra=!0;for(var a=k.length;a;){E=k;for(k=[];++u<a;)E&&E[u].run();u=-1;a=k.length}E=null;Ra=!1;t(b)}}function n(b,a){this.fun=b;this.array=a}function q(){}b=a.exports={};try{var r="function"===typeof setTimeout?setTimeout:d}catch(na){r=d}try{var g="function"===
typeof clearTimeout?clearTimeout:e}catch(na){g=e}var k=[],Ra=!1,E,u=-1;b.nextTick=function(b){var a=Array(arguments.length-1);if(1<arguments.length)for(var c=1;c<arguments.length;c++)a[c-1]=arguments[c];k.push(new n(b,a));1!==k.length||Ra||l(m)};n.prototype.run=function(){this.fun.apply(null,this.array)};b.title="browser";b.browser=!0;b.env={};b.argv=[];b.version="";b.versions={};b.on=q;b.addListener=q;b.once=q;b.off=q;b.removeListener=q;b.removeAllListeners=q;b.emit=q;b.prependListener=q;b.prependOnceListener=
q;b.listeners=function(b){return[]};b.binding=function(b){throw Error("process.binding is not supported");};b.cwd=function(){return"/"};b.chdir=function(b){throw Error("process.chdir is not supported");};b.umask=function(){return 0}},{}],44:[function(b,a,c){function d(b,a){var c=this,d;l.call(this);b=b||{};b.iceServers=b.iceServers||[];this.enableChromeNativeSimulcast=!1;a&&a.optional&&window.chrome&&null===navigator.appVersion.match(/Chromium\//)&&a.optional.forEach(function(b){b.enableChromeNativeSimulcast&&
(c.enableChromeNativeSimulcast=!0)});this.enableMultiStreamHacks=!1;a&&a.optional&&window.chrome&&a.optional.forEach(function(b){b.enableMultiStreamHacks&&(c.enableMultiStreamHacks=!0)});this.restrictBandwidth=0;a&&a.optional&&a.optional.forEach(function(b){b.andyetRestrictBandwidth&&(c.restrictBandwidth=b.andyetRestrictBandwidth)});this.batchIceCandidates=0;a&&a.optional&&a.optional.forEach(function(b){b.andyetBatchIce&&(c.batchIceCandidates=b.andyetBatchIce)});this.batchedIceCandidates=[];a&&a.optional&&
window.chrome&&a.optional.forEach(function(b){b.andyetFasterICE&&(c.eliminateDuplicateCandidates=b.andyetFasterICE)});a&&a.optional&&a.optional.forEach(function(b){b.andyetDontSignalCandidates&&(c.dontSignalCandidates=b.andyetDontSignalCandidates)});this.assumeSetLocalSuccess=!1;a&&a.optional&&a.optional.forEach(function(b){b.andyetAssumeSetLocalSuccess&&(c.assumeSetLocalSuccess=b.andyetAssumeSetLocalSuccess)});window.navigator.mozGetUserMedia&&a&&a.optional&&(this.wtFirefox=0,a.optional.forEach(function(b){b.andyetFirefoxMakesMeSad&&
(c.wtFirefox=b.andyetFirefoxMakesMeSad,0<c.wtFirefox&&(c.firefoxcandidatebuffer=[]))}));this.pc=new RTCPeerConnection(b,a);this.getLocalStreams="function"===typeof this.pc.getLocalStreams?this.pc.getLocalStreams.bind(this.pc):function(){return[]};this.getSenders="function"===typeof this.pc.getSenders?this.pc.getSenders.bind(this.pc):function(){return[]};this.getRemoteStreams="function"===typeof this.pc.getRemoteStreams?this.pc.getRemoteStreams.bind(this.pc):function(){return[]};this.getReceivers=
"function"===typeof this.pc.getReceivers?this.pc.getReceivers.bind(this.pc):function(){return[]};this.addStream=this.pc.addStream.bind(this.pc);this.removeStream=function(b){"function"===typeof c.pc.removeStream?c.pc.removeStream.apply(c.pc,arguments):"function"===typeof c.pc.removeTrack&&b.getTracks().forEach(function(b){c.pc.removeTrack(b)})};"function"===typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc));this.pc.onremovestream=this.emit.bind(this,"removeStream");this.pc.onremovetrack=
this.emit.bind(this,"removeTrack");this.pc.onaddstream=this.emit.bind(this,"addStream");this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded");this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange");this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange");this.pc.onicecandidate=this._onIce.bind(this);this.pc.ondatachannel=this._onDataChannel.bind(this);this.localDescription={contents:[]};this.remoteDescription={contents:[]};this.config={debug:!1,
sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1};this.iceCredentials={local:{},remote:{}};for(d in b)this.config[d]=b[d];if(this.config.debug)this.on("*",function(){(b.logger||console).log("PeerConnection event:",arguments)});this.hadRemoteIPv6Candidate=this.hadLocalIPv6Candidate=this.hadRemoteRelayCandidate=this.hadLocalRelayCandidate=this.hadRemoteStunCandidate=this.hadLocalStunCandidate=!1;this._remoteDataChannels=[];this._localDataChannels=[];this._candidateBuffer=[]}c=b("util");var e=
b("sdp-jingle-json"),l=b("wildemitter"),t=b("lodash.clonedeep");c.inherits(d,l);Object.defineProperty(d.prototype,"signalingState",{get:function(){return this.pc.signalingState}});Object.defineProperty(d.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}});d.prototype._role=function(){return this.isInitiator?"initiator":"responder"};d.prototype.addStream=function(b){this.localStream=b;this.pc.addStream(b)};d.prototype._checkLocalCandidate=function(b){b=e.toCandidateJSON(b);
"srflx"==b.type?this.hadLocalStunCandidate=!0:"relay"==b.type&&(this.hadLocalRelayCandidate=!0);-1!=b.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)};d.prototype._checkRemoteCandidate=function(b){b=e.toCandidateJSON(b);"srflx"==b.type?this.hadRemoteStunCandidate=!0:"relay"==b.type&&(this.hadRemoteRelayCandidate=!0);-1!=b.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)};d.prototype.processIce=function(b,a){a=a||function(){};var c=this;if("closed"===this.pc.signalingState)return a();if(b.contents||
b.jingle&&b.jingle.contents){var d=this.remoteDescription.contents.map(function(b){return b.name});(b.contents||b.jingle.contents).forEach(function(b){var h=b.transport||{},l=h.candidates||[],t=d.indexOf(b.name),p=b.name,m=c.remoteDescription.contents.find(function(a){return a.name===b.name}),n=function(){l.forEach(function(b){b=e.toCandidateSDP(b);c.pc.addIceCandidate(new RTCIceCandidate({candidate:b,sdpMLineIndex:t,sdpMid:p}),function(){},function(b){c.emit("error",b)});c._checkRemoteCandidate(b)});
a()};c.iceCredentials.remote[b.name]&&h.ufrag&&c.iceCredentials.remote[b.name].ufrag!==h.ufrag?m?(m.transport.ufrag=h.ufrag,m.transport.pwd=h.pwd,h={type:"offer",jingle:c.remoteDescription},h.sdp=e.toSessionSDP(h.jingle,{sid:c.config.sdpSessionID,role:c._role(),direction:"incoming"}),c.pc.setRemoteDescription(new RTCSessionDescription(h),function(){n()},function(b){c.emit("error",b)})):c.emit("error","ice restart failed to find matching content"):n()})}else{b.candidate&&0!==b.candidate.candidate.indexOf("a=")&&
(b.candidate.candidate="a="+b.candidate.candidate);if(this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(b.candidate),a();c.pc.addIceCandidate(new RTCIceCandidate(b.candidate),function(){},function(b){c.emit("error",b)});c._checkRemoteCandidate(b.candidate.candidate);a()}};d.prototype.offer=function(b,a){var c=this,d=2===arguments.length,h=d&&b?b:{offerToReceiveAudio:1,offerToReceiveVideo:1};
a=(a=d?a:b)||function(){};if("closed"===this.pc.signalingState)return a("Already closed");this.pc.createOffer(function(b){var d={type:"offer",sdp:b.sdp};c.assumeSetLocalSuccess&&(c.emit("offer",d),a(null,d));c._candidateBuffer=[];c.pc.setLocalDescription(b,function(){if(c.config.useJingle){var h=e.toSessionJSON(b.sdp,{role:c._role(),direction:"outgoing"});h.sid=c.config.sid;c.localDescription=h;h.contents.forEach(function(b){var a=b.transport||{};a.ufrag&&(c.iceCredentials.local[b.name]={ufrag:a.ufrag,
pwd:a.pwd})});d.jingle=h}d.sdp.split("\r\n").forEach(function(b){0===b.indexOf("a=candidate:")&&c._checkLocalCandidate(b)});c.assumeSetLocalSuccess||(c.emit("offer",d),a(null,d))},function(b){c.emit("error",b);a(b)})},function(b){c.emit("error",b);a(b)},h)};d.prototype.handleOffer=function(b,a){a=a||function(){};var c=this;b.type="offer";if(b.jingle){this.enableChromeNativeSimulcast&&b.jingle.contents.forEach(function(b){"video"===b.name&&(b.application.googConferenceFlag=!0)});this.enableMultiStreamHacks&&
b.jingle.contents.forEach(function(b){if("video"===b.name){var a=b.application.sources||[];if(0===a.length||"3735928559"!==a[0].ssrc)a.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),b.application.sources=a}});if(0<c.restrictBandwidth&&2<=b.jingle.contents.length&&"video"===b.jingle.contents[1].name){var d=b.jingle.contents[1];d.application&&d.application.bandwidth&&d.application.bandwidth.bandwidth||(b.jingle.contents[1].application.bandwidth=
{type:"AS",bandwidth:c.restrictBandwidth.toString()},b.sdp=e.toSessionSDP(b.jingle,{sid:c.config.sdpSessionID,role:c._role(),direction:"outgoing"}))}b.jingle.contents.forEach(function(b){var a=b.transport||{};a.ufrag&&(c.iceCredentials.remote[b.name]={ufrag:a.ufrag,pwd:a.pwd})});b.sdp=e.toSessionSDP(b.jingle,{sid:c.config.sdpSessionID,role:c._role(),direction:"incoming"});c.remoteDescription=b.jingle}b.sdp.split("\r\n").forEach(function(b){0===b.indexOf("a=candidate:")&&c._checkRemoteCandidate(b)});
c.pc.setRemoteDescription(new RTCSessionDescription(b),function(){a()},a)};d.prototype.answerAudioOnly=function(b){this._answer({mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},b)};d.prototype.answerBroadcastOnly=function(b){this._answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},b)};d.prototype.answer=function(b,a){var c=2===arguments.length;this._answer(c&&b?b:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},c?a:b)};d.prototype.handleAnswer=function(b,a){a=
a||function(){};var c=this;b.jingle&&(b.sdp=e.toSessionSDP(b.jingle,{sid:c.config.sdpSessionID,role:c._role(),direction:"incoming"}),c.remoteDescription=b.jingle,b.jingle.contents.forEach(function(b){var a=b.transport||{};a.ufrag&&(c.iceCredentials.remote[b.name]={ufrag:a.ufrag,pwd:a.pwd})}));b.sdp.split("\r\n").forEach(function(b){0===b.indexOf("a=candidate:")&&c._checkRemoteCandidate(b)});c.pc.setRemoteDescription(new RTCSessionDescription(b),function(){c.wtFirefox&&window.setTimeout(function(){c.firefoxcandidatebuffer.forEach(function(b){c.pc.addIceCandidate(new RTCIceCandidate(b),
function(){},function(b){c.emit("error",b)});c._checkRemoteCandidate(b.candidate)});c.firefoxcandidatebuffer=null},c.wtFirefox);a(null)},a)};d.prototype.close=function(){this.pc.close();this._localDataChannels=[];this._remoteDataChannels=[];this.emit("close")};d.prototype._answer=function(b,a){a=a||function(){};var c=this;if(!this.pc.remoteDescription)throw Error("remoteDescription not set");if("closed"===this.pc.signalingState)return a("Already closed");c.pc.createAnswer(function(b){var d=[];if(c.enableChromeNativeSimulcast&&
(b.jingle=e.toSessionJSON(b.sdp,{role:c._role(),direction:"outgoing"}),2<=b.jingle.contents.length&&"video"===b.jingle.contents[1].name)){var h=b.jingle.contents[1].application.sourceGroups||[],l=!1;h.forEach(function(b){"SIM"==b.semantics&&(l=!0)});if(!l&&b.jingle.contents[1].application.sources.length){var p=JSON.parse(JSON.stringify(b.jingle.contents[1].application.sources[0]));p.ssrc=""+Math.floor(4294967295*Math.random());b.jingle.contents[1].application.sources.push(p);d.push(b.jingle.contents[1].application.sources[0].ssrc);
d.push(p.ssrc);h.push({semantics:"SIM",sources:d});d=JSON.parse(JSON.stringify(p));d.ssrc=""+Math.floor(4294967295*Math.random());b.jingle.contents[1].application.sources.push(d);h.push({semantics:"FID",sources:[p.ssrc,d.ssrc]});b.jingle.contents[1].application.sourceGroups=h;b.sdp=e.toSessionSDP(b.jingle,{sid:c.config.sdpSessionID,role:c._role(),direction:"outgoing"})}}var m={type:"answer",sdp:b.sdp};c.assumeSetLocalSuccess&&(h=t(m),c.emit("answer",h),a(null,h));c._candidateBuffer=[];c.pc.setLocalDescription(b,
function(){if(c.config.useJingle){var d=e.toSessionJSON(b.sdp,{role:c._role(),direction:"outgoing"});d.sid=c.config.sid;c.localDescription=d;m.jingle=d}c.enableChromeNativeSimulcast&&(m.jingle||(m.jingle=e.toSessionJSON(b.sdp,{role:c._role(),direction:"outgoing"})),m.jingle.contents[1].application.sources.forEach(function(b,a){b.parameters=b.parameters.map(function(b){"msid"===b.key&&(b.value+="-"+Math.floor(a/2));return b})}),m.sdp=e.toSessionSDP(m.jingle,{sid:c.sdpSessionID,role:c._role(),direction:"outgoing"}));
m.sdp.split("\r\n").forEach(function(b){0===b.indexOf("a=candidate:")&&c._checkLocalCandidate(b)});c.assumeSetLocalSuccess||(d=t(m),c.emit("answer",d),a(null,d))},function(b){c.emit("error",b);a(b)})},function(b){c.emit("error",b);a(b)},b)};d.prototype._onIce=function(b){var a=this;if(b.candidate){if(!this.dontSignalCandidates){b=b.candidate;var c={candidate:{candidate:b.candidate,sdpMid:b.sdpMid,sdpMLineIndex:b.sdpMLineIndex}};this._checkLocalCandidate(b.candidate);var d=e.toCandidateJSON(b.candidate);
if(this.eliminateDuplicateCandidates&&"relay"===d.type){var h=this._candidateBuffer.filter(function(b){return"relay"===b.type}).map(function(b){return b.foundation+":"+b.component});var l=h.indexOf(d.foundation+":"+d.component);if(-1<l&&d.priority>>24>=h[l].priority>>24)return}if("max-bundle"===this.config.bundlePolicy&&(h=this._candidateBuffer.filter(function(b){return d.type===b.type}).map(function(b){return b.address+":"+b.port}),l=h.indexOf(d.address+":"+d.port),-1<l))return;if("require"!==this.config.rtcpMuxPolicy||
"2"!==d.component){this._candidateBuffer.push(d);if(a.config.useJingle&&(b.sdpMid||(b.sdpMid=a.pc.remoteDescription&&"offer"===a.pc.remoteDescription.type?a.remoteDescription.contents[b.sdpMLineIndex].name:a.localDescription.contents[b.sdpMLineIndex].name),a.iceCredentials.local[b.sdpMid]||e.toSessionJSON(a.pc.localDescription.sdp,{role:a._role(),direction:"outgoing"}).contents.forEach(function(b){var c=b.transport||{};c.ufrag&&(a.iceCredentials.local[b.name]={ufrag:c.ufrag,pwd:c.pwd})}),c.jingle=
{contents:[{name:b.sdpMid,creator:a._role(),transport:{transportType:"iceUdp",ufrag:a.iceCredentials.local[b.sdpMid].ufrag,pwd:a.iceCredentials.local[b.sdpMid].pwd,candidates:[d]}}]},0<a.batchIceCandidates)){0===a.batchedIceCandidates.length&&window.setTimeout(function(){var b={};a.batchedIceCandidates.forEach(function(a){a=a.contents[0];b[a.name]||(b[a.name]=a);b[a.name].transport.candidates.push(a.transport.candidates[0])});var c={jingle:{contents:[]}};Object.keys(b).forEach(function(a){c.jingle.contents.push(b[a])});
a.batchedIceCandidates=[];a.emit("ice",c)},a.batchIceCandidates);a.batchedIceCandidates.push(c.jingle);return}this.emit("ice",c)}}}else this.emit("endOfCandidates")};d.prototype._onDataChannel=function(b){b=b.channel;this._remoteDataChannels.push(b);this.emit("addChannel",b)};d.prototype.createDataChannel=function(b,a){b=this.pc.createDataChannel(b,a);this._localDataChannels.push(b);return b};d.prototype.getStats=function(){if("function"===typeof arguments[0]){var b=arguments[0];this.pc.getStats().then(function(a){b(null,
a)},function(a){b(a)})}else return this.pc.getStats.apply(this.pc,arguments)};a.exports=d},{"lodash.clonedeep":36,"sdp-jingle-json":45,util:63,wildemitter:65}],45:[function(b,a,c){var d=b("./lib/tosdp"),e=b("./lib/tojson");c.toIncomingSDPOffer=function(b){return d.toSessionSDP(b,{role:"responder",direction:"incoming"})};c.toOutgoingSDPOffer=function(b){return d.toSessionSDP(b,{role:"initiator",direction:"outgoing"})};c.toIncomingSDPAnswer=function(b){return d.toSessionSDP(b,{role:"initiator",direction:"incoming"})};
c.toOutgoingSDPAnswer=function(b){return d.toSessionSDP(b,{role:"responder",direction:"outgoing"})};c.toIncomingMediaSDPOffer=function(b){return d.toMediaSDP(b,{role:"responder",direction:"incoming"})};c.toOutgoingMediaSDPOffer=function(b){return d.toMediaSDP(b,{role:"initiator",direction:"outgoing"})};c.toIncomingMediaSDPAnswer=function(b){return d.toMediaSDP(b,{role:"initiator",direction:"incoming"})};c.toOutgoingMediaSDPAnswer=function(b){return d.toMediaSDP(b,{role:"responder",direction:"outgoing"})};
c.toCandidateSDP=d.toCandidateSDP;c.toMediaSDP=d.toMediaSDP;c.toSessionSDP=d.toSessionSDP;c.toIncomingJSONOffer=function(b,a){return e.toSessionJSON(b,{role:"responder",direction:"incoming",creators:a})};c.toOutgoingJSONOffer=function(b,a){return e.toSessionJSON(b,{role:"initiator",direction:"outgoing",creators:a})};c.toIncomingJSONAnswer=function(b,a){return e.toSessionJSON(b,{role:"initiator",direction:"incoming",creators:a})};c.toOutgoingJSONAnswer=function(b,a){return e.toSessionJSON(b,{role:"responder",
direction:"outgoing",creators:a})};c.toIncomingMediaJSONOffer=function(b,a){return e.toMediaJSON(b,{role:"responder",direction:"incoming",creator:a})};c.toOutgoingMediaJSONOffer=function(b,a){return e.toMediaJSON(b,{role:"initiator",direction:"outgoing",creator:a})};c.toIncomingMediaJSONAnswer=function(b,a){return e.toMediaJSON(b,{role:"initiator",direction:"incoming",creator:a})};c.toOutgoingMediaJSONAnswer=function(b,a){return e.toMediaJSON(b,{role:"responder",direction:"outgoing",creator:a})};
c.toCandidateJSON=e.toCandidateJSON;c.toMediaJSON=e.toMediaJSON;c.toSessionJSON=e.toSessionJSON},{"./lib/tojson":48,"./lib/tosdp":49}],46:[function(b,a,c){c.lines=function(b){return b.split("\r\n").filter(function(b){return 0<b.length})};c.findLine=function(b,a,c){for(var d=b.length,e=0;e<a.length;e++)if(a[e].substr(0,d)===b)return a[e];if(!c)return!1;for(a=0;a<c.length;a++)if(c[a].substr(0,d)===b)return c[a];return!1};c.findLines=function(b,a,c){for(var d=[],e=b.length,h=0;h<a.length;h++)a[h].substr(0,
e)===b&&d.push(a[h]);if(d.length||!c)return d;for(a=0;a<c.length;a++)c[a].substr(0,e)===b&&d.push(c[a]);return d};c.mline=function(b){b=b.substr(2).split(" ");for(var a={media:b[0],port:b[1],proto:b[2],formats:[]},c=3;c<b.length;c++)b[c]&&a.formats.push(b[c]);return a};c.rtpmap=function(b){b=b.substr(9).split(" ");var a={id:b.shift()};b=b[0].split("/");a.name=b[0];a.clockrate=b[1];a.channels=3==b.length?b[2]:"1";return a};c.sctpmap=function(b){b=b.substr(10).split(" ");return{number:b.shift(),protocol:b.shift(),
streams:b.shift()}};c.fmtp=function(b){for(var a,c=b.substr(b.indexOf(" ")+1).split(";"),e=[],d=0;d<c.length;d++)a=c[d].split("="),b=a[0].trim(),a=a[1],b&&a?e.push({key:b,value:a}):b&&e.push({key:"",value:b});return e};c.crypto=function(b){b=b.substr(9).split(" ");return{tag:b[0],cipherSuite:b[1],keyParams:b[2],sessionParams:b.slice(3).join(" ")}};c.fingerprint=function(b){b=b.substr(14).split(" ");return{hash:b[0],value:b[1]}};c.extmap=function(b){b=b.substr(9).split(" ");var a={},c=b.shift(),e=
c.indexOf("/");0<=e?(a.id=c.substr(0,e),a.senders=c.substr(e+1)):(a.id=c,a.senders="sendrecv");a.uri=b.shift()||"";return a};c.rtcpfb=function(b){b=b.substr(10).split(" ");var a={};a.id=b.shift();a.type=b.shift();"trr-int"===a.type?a.value=b.shift():a.subtype=b.shift()||"";a.parameters=b;return a};c.candidate=function(b){b=0===b.indexOf("a=candidate:")?b.substring(12).split(" "):b.substring(10).split(" ");for(var a={foundation:b[0],component:b[1],protocol:b[2].toLowerCase(),priority:b[3],ip:b[4],
port:b[5],type:b[7],generation:"0"},c=8;c<b.length;c+=2)"raddr"===b[c]?a.relAddr=b[c+1]:"rport"===b[c]?a.relPort=b[c+1]:"generation"===b[c]?a.generation=b[c+1]:"tcptype"===b[c]&&(a.tcpType=b[c+1]);a.network="1";return a};c.sourceGroups=function(b){for(var a=[],c=0;c<b.length;c++){var e=b[c].substr(13).split(" ");a.push({semantics:e.shift(),sources:e})}return a};c.sources=function(b){for(var a=[],c={},e=0;e<b.length;e++){var d=b[e].substr(7).split(" "),m=d.shift();if(!c[m]){var n={ssrc:m,parameters:[]};
a.push(n);c[m]=n}d=d.join(" ").split(":");n=d.shift();d=d.join(":")||null;c[m].parameters.push({key:n,value:d})}return a};c.groups=function(b){for(var a=[],c,e=0;e<b.length;e++)c=b[e].substr(8).split(" "),a.push({semantics:c.shift(),contents:c});return a};c.bandwidth=function(b){b=b.substr(2).split(":");var a={};a.type=b.shift();a.bandwidth=b.shift();return a};c.msid=function(b){b=b.substr(7);var a=b.split(" ");return{msid:b,mslabel:a[0],label:a[1]}}},{}],47:[function(b,a,c){a.exports={initiator:{incoming:{initiator:"recvonly",
responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",
both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],48:[function(b,a,c){var e=b("./senders"),h=b("./parsers"),l=Math.random();c._setIdCounter=function(b){l=b};c.toSessionJSON=function(b,a){var e,d=a.creators||[],l=a.role||"initiator";a=a.direction||"outgoing";var t=b.split("\r\nm=");for(e=1;e<t.length;e++)t[e]="m="+t[e],e!==t.length-1&&(t[e]+="\r\n");var p=t.shift()+"\r\n",g=h.lines(p);b={};var k=[];for(e=0;e<t.length;e++)k.push(c.toMediaJSON(t[e],
p,{role:l,direction:a,creator:d[e]||"initiator"}));b.contents=k;d=h.findLines("a=group:",g);d.length&&(b.groups=h.groups(d));return b};c.toMediaJSON=function(b,a,d){var l=d.creator||"initiator",t=d.role||"initiator",m=d.direction||"outgoing",p=h.lines(b);b=h.lines(a);a=h.mline(p[0]);l={creator:l,name:a.media,application:{applicationType:"rtp",media:a.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==a.media&&
(l.application={applicationType:"datachannel"},l.transport.sctp=[]);var g=l.application,k=l.transport;if(a=h.findLine("a=mid:",p))l.name=a.substr(6);h.findLine("a=sendrecv",p,b)?l.senders="both":h.findLine("a=sendonly",p,b)?l.senders=e[t][m].sendonly:h.findLine("a=recvonly",p,b)?l.senders=e[t][m].recvonly:h.findLine("a=inactive",p,b)&&(l.senders="none");if("rtp"==g.applicationType){if(a=h.findLine("b=",p))g.bandwidth=h.bandwidth(a);if(a=h.findLine("a=ssrc:",p))g.ssrc=a.substr(7).split(" ")[0];h.findLines("a=rtpmap:",
p).forEach(function(b){var a=h.rtpmap(b);a.parameters=[];a.feedback=[];h.findLines("a=fmtp:"+a.id,p).forEach(function(b){a.parameters=h.fmtp(b)});h.findLines("a=rtcp-fb:"+a.id,p).forEach(function(b){a.feedback.push(h.rtcpfb(b))});g.payloads.push(a)});h.findLines("a=crypto:",p,b).forEach(function(b){g.encryption.push(h.crypto(b))});h.findLine("a=rtcp-mux",p)&&(g.mux=!0);h.findLines("a=rtcp-fb:*",p).forEach(function(b){g.feedback.push(h.rtcpfb(b))});h.findLines("a=extmap:",p).forEach(function(b){b=
h.extmap(b);b.senders=e[t][m][b.senders];g.headerExtensions.push(b)});a=h.findLines("a=ssrc-group:",p);g.sourceGroups=h.sourceGroups(a||[]);a=h.findLines("a=ssrc:",p);var E=g.sources=h.sources(a||[]);if(a=h.findLine("a=msid:",p)){var u=h.msid(a);["msid","mslabel","label"].forEach(function(b){for(var a=0;a<E.length;a++){for(var c=!1,e=0;e<E[a].parameters.length;e++)E[a].parameters[e].key===b&&(c=!0);c||E[a].parameters.push({key:b,value:u[b]})}})}h.findLine("a=x-google-flag:conference",p,b)&&(g.googConferenceFlag=
!0)}a=h.findLines("a=fingerprint:",p,b);var na=h.findLine("a=setup:",p,b);a.forEach(function(b){b=h.fingerprint(b);na&&(b.setup=na.substr(8));k.fingerprints.push(b)});a=h.findLine("a=ice-ufrag:",p,b);d=h.findLine("a=ice-pwd:",p,b);a&&d&&(k.ufrag=a.substr(12),k.pwd=d.substr(10),k.candidates=[],h.findLines("a=candidate:",p,b).forEach(function(b){k.candidates.push(c.toCandidateJSON(b))}));"datachannel"==g.applicationType&&h.findLines("a=sctpmap:",p).forEach(function(b){b=h.sctpmap(b);k.sctp.push(b)});
return l};c.toCandidateJSON=function(b){b=h.candidate(b.split("\r\n")[0]);b.id=(l++).toString(36).substr(0,12);return b}},{"./parsers":46,"./senders":47}],49:[function(b,a,c){var e=b("./senders");c.toSessionSDP=function(b,a){var e=a.sid||b.sid||Date.now(),d=a.time||Date.now(),h=["v=0","o=- "+e+" "+d+" IN IP4 0.0.0.0","s=-","t=0 0"];e=b.contents||[];var l=!1;e.forEach(function(b){b.application.sources&&b.application.sources.length&&(l=!0)});l&&h.push("a=msid-semantic: WMS *");(b.groups||[]).forEach(function(b){h.push("a=group:"+
b.semantics+" "+b.contents.join(" "))});e.forEach(function(b){h.push(c.toMediaSDP(b,a))});return h.join("\r\n")+"\r\n"};c.toMediaSDP=function(b,a){var d=[],h=a.role||"initiator",l=a.direction||"outgoing",n=b.application;a=b.transport;var g=n.payloads||[],k=a&&a.fingerprints||[],V=[];"datachannel"==n.applicationType?(V.push("application"),V.push("1"),V.push("DTLS/SCTP"),a.sctp&&a.sctp.forEach(function(b){V.push(b.number)})):(V.push(n.media),V.push("1"),0<k.length?V.push("UDP/TLS/RTP/SAVPF"):n.encryption&&
0<n.encryption.length?V.push("RTP/SAVPF"):V.push("RTP/AVPF"),g.forEach(function(b){V.push(b.id)}));d.push("m="+V.join(" "));d.push("c=IN IP4 0.0.0.0");n.bandwidth&&n.bandwidth.type&&n.bandwidth.bandwidth&&d.push("b="+n.bandwidth.type+":"+n.bandwidth.bandwidth);"rtp"==n.applicationType&&d.push("a=rtcp:1 IN IP4 0.0.0.0");a&&(a.ufrag&&d.push("a=ice-ufrag:"+a.ufrag),a.pwd&&d.push("a=ice-pwd:"+a.pwd),k.forEach(function(b){d.push("a=fingerprint:"+b.hash+" "+b.value);b.setup&&d.push("a=setup:"+b.setup)}),
a.sctp&&a.sctp.forEach(function(b){d.push("a=sctpmap:"+b.number+" "+b.protocol+" "+b.streams)}));"rtp"==n.applicationType&&d.push("a="+(e[h][l][b.senders]||"sendrecv"));d.push("a=mid:"+b.name);n.sources&&n.sources.length&&(n.sources[0].parameters||[]).forEach(function(b){"msid"===b.key&&d.push("a=msid:"+b.value)});n.mux&&d.push("a=rtcp-mux");(n.encryption||[]).forEach(function(b){d.push("a=crypto:"+b.tag+" "+b.cipherSuite+" "+b.keyParams+(b.sessionParams?" "+b.sessionParams:""))});n.googConferenceFlag&&
d.push("a=x-google-flag:conference");g.forEach(function(b){var a="a=rtpmap:"+b.id+" "+b.name+"/"+b.clockrate;b.channels&&"1"!=b.channels&&(a+="/"+b.channels);d.push(a);if(b.parameters&&b.parameters.length){a=["a=fmtp:"+b.id];var c=[];b.parameters.forEach(function(b){c.push((b.key?b.key+"=":"")+b.value)});a.push(c.join(";"));d.push(a.join(" "))}b.feedback&&b.feedback.forEach(function(a){"trr-int"===a.type?d.push("a=rtcp-fb:"+b.id+" trr-int "+(a.value?a.value:"0")):d.push("a=rtcp-fb:"+b.id+" "+a.type+
(a.subtype?" "+a.subtype:""))})});n.feedback&&n.feedback.forEach(function(b){"trr-int"===b.type?d.push("a=rtcp-fb:* trr-int "+(b.value?b.value:"0")):d.push("a=rtcp-fb:* "+b.type+(b.subtype?" "+b.subtype:""))});(n.headerExtensions||[]).forEach(function(b){d.push("a=extmap:"+b.id+(b.senders?"/"+e[h][l][b.senders]:"")+" "+b.uri)});(n.sourceGroups||[]).forEach(function(b){d.push("a=ssrc-group:"+b.semantics+" "+b.sources.join(" "))});(n.sources||[]).forEach(function(b){for(var a=0;a<b.parameters.length;a++){var c=
b.parameters[a];d.push("a=ssrc:"+(b.ssrc||n.ssrc)+" "+c.key+(c.value?":"+c.value:""))}});(a.candidates||[]).forEach(function(b){d.push(c.toCandidateSDP(b))});return d.join("\r\n")};c.toCandidateSDP=function(b){var a=[];a.push(b.foundation);a.push(b.component);a.push(b.protocol.toUpperCase());a.push(b.priority);a.push(b.ip);a.push(b.port);var c=b.type;a.push("typ");a.push(c);("srflx"===c||"prflx"===c||"relay"===c)&&b.relAddr&&b.relPort&&(a.push("raddr"),a.push(b.relAddr),a.push("rport"),a.push(b.relPort));
b.tcpType&&"TCP"==b.protocol.toUpperCase()&&(a.push("tcptype"),a.push(b.tcpType));a.push("generation");a.push(b.generation||"0");return"a=candidate:"+a.join(" ")}},{"./senders":47}],50:[function(b,a,c){a.exports=b("./lib/")},{"./lib/":51}],51:[function(b,a,c){function e(b,a){"object"==typeof b&&(a=b,b=void 0);a=a||{};b=h(b);var c=b.source,e=b.id;a.forceNew||a["force new connection"]||!1===a.multiplex?(p("ignoring socket cache for %s",c),a=t(c,a)):(m[e]||(p("new io instance for %s",c),m[e]=t(c,a)),
a=m[e]);return a.socket(b.path)}var h=b("./url"),l=b("socket.io-parser"),t=b("./manager"),p=b("debug")("socket.io-client");a.exports=c=e;var m=c.managers={};c.protocol=l.protocol;c.connect=e;c.Manager=b("./manager");c.Socket=b("./socket")},{"./manager":52,"./socket":54,"./url":55,debug:10,"socket.io-parser":57}],52:[function(b,a,c){function e(b,a){if(!(this instanceof e))return new e(b,a);b&&"object"==typeof b&&(a=b,b=void 0);a=a||{};a.path=a.path||"/socket.io";this.nsps={};this.subs=[];this.opts=
a;this.reconnection(!1!==a.reconnection);this.reconnectionAttempts(a.reconnectionAttempts||Infinity);this.reconnectionDelay(a.reconnectionDelay||1E3);this.reconnectionDelayMax(a.reconnectionDelayMax||5E3);this.randomizationFactor(a.randomizationFactor||.5);this.backoff=new k({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==a.timeout?2E4:a.timeout);this.readyState="closed";this.uri=b;this.connected=[];this.encoding=!1;this.packetBuffer=
[];this.encoder=new t.Encoder;this.decoder=new t.Decoder;(this.autoConnect=!1!==a.autoConnect)&&this.open()}b("./url");var h=b("engine.io-client"),l=b("./socket");c=b("component-emitter");var t=b("socket.io-parser"),p=b("./on"),m=b("component-bind");b("object-component");var n=b("debug")("socket.io-client:manager"),g=b("indexof"),k=b("backo2");a.exports=e;e.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var b in this.nsps)this.nsps[b].emit.apply(this.nsps[b],arguments)};e.prototype.updateSocketIds=
function(){for(var b in this.nsps)this.nsps[b].id=this.engine.id};c(e.prototype);e.prototype.reconnection=function(b){if(!arguments.length)return this._reconnection;this._reconnection=!!b;return this};e.prototype.reconnectionAttempts=function(b){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=b;return this};e.prototype.reconnectionDelay=function(b){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=b;this.backoff&&this.backoff.setMin(b);return this};
e.prototype.randomizationFactor=function(b){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=b;this.backoff&&this.backoff.setJitter(b);return this};e.prototype.reconnectionDelayMax=function(b){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=b;this.backoff&&this.backoff.setMax(b);return this};e.prototype.timeout=function(b){if(!arguments.length)return this._timeout;this._timeout=b;return this};e.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&
this._reconnection&&0===this.backoff.attempts&&this.reconnect()};e.prototype.open=e.prototype.connect=function(b){n("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;n("opening %s",this.uri);var a=this.engine=h(this.uri,this.opts),c=this;this.readyState="opening";this.skipReconnect=!1;var e=p(a,"open",function(){c.onopen();b&&b()}),d=p(a,"error",function(a){n("connect_error");c.cleanup();c.readyState="closed";c.emitAll("connect_error",a);if(b){var e=Error("Connection error");
e.data=a;b(e)}else c.maybeReconnectOnOpen()});if(!1!==this._timeout){var l=this._timeout;n("connect attempt will timeout after %d",l);var t=setTimeout(function(){n("connect attempt timed out after %d",l);e.destroy();a.close();a.emit("error","timeout");c.emitAll("connect_timeout",l)},l);this.subs.push({destroy:function(){clearTimeout(t)}})}this.subs.push(e);this.subs.push(d);return this};e.prototype.onopen=function(){n("open");this.cleanup();this.readyState="open";this.emit("open");var b=this.engine;
this.subs.push(p(b,"data",m(this,"ondata")));this.subs.push(p(this.decoder,"decoded",m(this,"ondecoded")));this.subs.push(p(b,"error",m(this,"onerror")));this.subs.push(p(b,"close",m(this,"onclose")))};e.prototype.ondata=function(b){this.decoder.add(b)};e.prototype.ondecoded=function(b){this.emit("packet",b)};e.prototype.onerror=function(b){n("error",b);this.emitAll("error",b)};e.prototype.socket=function(b){var a=this.nsps[b];if(!a){a=new l(this,b);this.nsps[b]=a;var c=this;a.on("connect",function(){a.id=
c.engine.id;~g(c.connected,a)||c.connected.push(a)})}return a};e.prototype.destroy=function(b){b=g(this.connected,b);~b&&this.connected.splice(b,1);this.connected.length||this.close()};e.prototype.packet=function(b){n("writing packet %j",b);var a=this;a.encoding?a.packetBuffer.push(b):(a.encoding=!0,this.encoder.encode(b,function(b){for(var c=0;c<b.length;c++)a.engine.write(b[c]);a.encoding=!1;a.processPacketQueue()}))};e.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var b=
this.packetBuffer.shift();this.packet(b)}};e.prototype.cleanup=function(){for(var b;b=this.subs.shift();)b.destroy();this.packetBuffer=[];this.encoding=!1;this.decoder.destroy()};e.prototype.close=e.prototype.disconnect=function(){this.skipReconnect=!0;this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};e.prototype.onclose=function(b){n("close");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",b);this._reconnection&&!this.skipReconnect&&this.reconnect()};
e.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var b=this;if(this.backoff.attempts>=this._reconnectionAttempts)n("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var a=this.backoff.duration();n("will wait %dms before reconnect attempt",a);this.reconnecting=!0;var c=setTimeout(function(){b.skipReconnect||(n("attempting reconnect"),b.emitAll("reconnect_attempt",b.backoff.attempts),b.emitAll("reconnecting",b.backoff.attempts),
b.skipReconnect||b.open(function(a){a?(n("reconnect attempt error"),b.reconnecting=!1,b.reconnect(),b.emitAll("reconnect_error",a.data)):(n("reconnect success"),b.onreconnect())}))},a);this.subs.push({destroy:function(){clearTimeout(c)}})}};e.prototype.onreconnect=function(){var b=this.backoff.attempts;this.reconnecting=!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",b)}},{"./on":53,"./socket":54,"./url":55,backo2:4,"component-bind":7,"component-emitter":8,debug:10,"engine.io-client":11,
indexof:32,"object-component":39,"socket.io-parser":57}],53:[function(b,a,c){a.exports=function(b,a,c){b.on(a,c);return{destroy:function(){b.removeListener(a,c)}}}},{}],54:[function(b,a,c){function e(b,a){this.io=b;this.nsp=a;this.json=this;this.ids=0;this.acks={};this.io.autoConnect&&this.open();this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0}var h=b("socket.io-parser");c=b("component-emitter");var l=b("to-array"),t=b("./on"),p=b("component-bind"),m=b("debug")("socket.io-client:socket"),
n=b("has-binary");a.exports=e;var g={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},k=c.prototype.emit;c(e.prototype);e.prototype.subEvents=function(){if(!this.subs){var b=this.io;this.subs=[t(b,"open",p(this,"onopen")),t(b,"packet",p(this,"onpacket")),t(b,"close",p(this,"onclose"))]}};e.prototype.open=e.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==
this.io.readyState)this.onopen();return this};e.prototype.send=function(){var b=l(arguments);b.unshift("message");this.emit.apply(this,b);return this};e.prototype.emit=function(b){if(g.hasOwnProperty(b))return k.apply(this,arguments),this;var a=l(arguments),c=h.EVENT;n(a)&&(c=h.BINARY_EVENT);c={type:c,data:a};"function"==typeof a[a.length-1]&&(m("emitting packet with ack id %d",this.ids),this.acks[this.ids]=a.pop(),c.id=this.ids++);this.connected?this.packet(c):this.sendBuffer.push(c);return this};
e.prototype.packet=function(b){b.nsp=this.nsp;this.io.packet(b)};e.prototype.onopen=function(){m("transport is open - connecting");"/"!=this.nsp&&this.packet({type:h.CONNECT})};e.prototype.onclose=function(b){m("close (%s)",b);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",b)};e.prototype.onpacket=function(b){if(b.nsp==this.nsp)switch(b.type){case h.CONNECT:this.onconnect();break;case h.EVENT:this.onevent(b);break;case h.BINARY_EVENT:this.onevent(b);break;case h.ACK:this.onack(b);
break;case h.BINARY_ACK:this.onack(b);break;case h.DISCONNECT:this.ondisconnect();break;case h.ERROR:this.emit("error",b.data)}};e.prototype.onevent=function(b){var a=b.data||[];m("emitting event %j",a);null!=b.id&&(m("attaching ack callback to event"),a.push(this.ack(b.id)));this.connected?k.apply(this,a):this.receiveBuffer.push(a)};e.prototype.ack=function(b){var a=this,c=!1;return function(){if(!c){c=!0;var e=l(arguments);m("sending ack %j",e);var d=n(e)?h.BINARY_ACK:h.ACK;a.packet({type:d,id:b,
data:e})}}};e.prototype.onack=function(b){m("calling ack %s with %j",b.id,b.data);this.acks[b.id].apply(this,b.data);delete this.acks[b.id]};e.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};e.prototype.emitBuffered=function(){var b;for(b=0;b<this.receiveBuffer.length;b++)k.apply(this,this.receiveBuffer[b]);this.receiveBuffer=[];for(b=0;b<this.sendBuffer.length;b++)this.packet(this.sendBuffer[b]);this.sendBuffer=[]};e.prototype.ondisconnect=
function(){m("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};e.prototype.destroy=function(){if(this.subs){for(var b=0;b<this.subs.length;b++)this.subs[b].destroy();this.subs=null}this.io.destroy(this)};e.prototype.close=e.prototype.disconnect=function(){this.connected&&(m("performing disconnect (%s)",this.nsp),this.packet({type:h.DISCONNECT}));this.destroy();if(this.connected)this.onclose("io client disconnect");return this}},{"./on":53,"component-bind":7,"component-emitter":8,
debug:10,"has-binary":30,"socket.io-parser":57,"to-array":59}],55:[function(b,a,c){(function(c){var e=b("parseuri"),d=b("debug")("socket.io-client:url");a.exports=function(b,a){var h=b;a=a||c.location;null==b&&(b=a.protocol+"//"+a.host);"string"==typeof b&&("/"==b.charAt(0)&&(b="/"==b.charAt(1)?a.protocol+b:a.hostname+b),/^(https?|wss?):\/\//.test(b)||(d("protocol-less url %s",b),b="undefined"!=typeof a?a.protocol+"//"+b:"https://"+b),d("parse %s",b),h=e(b));h.port||(/^(http|ws)$/.test(h.protocol)?
h.port="80":/^(http|ws)s$/.test(h.protocol)&&(h.port="443"));h.path=h.path||"/";h.id=h.protocol+"://"+h.host+":"+h.port;h.href=h.protocol+"://"+h.host+(a&&a.port==h.port?"":":"+h.port);return h}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{debug:10,parseuri:42}],56:[function(b,a,c){(function(a){var e=b("isarray"),d=b("./is-buffer");c.deconstructPacket=function(b){function a(b){if(!b)return b;if(d(b)){var h={_placeholder:!0,
num:c.length};c.push(b);return h}if(e(b)){h=Array(b.length);for(var l=0;l<b.length;l++)h[l]=a(b[l]);return h}if("object"==typeof b&&!(b instanceof Date)){h={};for(l in b)h[l]=a(b[l]);return h}return b}var c=[];b.data=a(b.data);b.attachments=c.length;return{packet:b,buffers:c}};c.reconstructPacket=function(b,a){function c(b){if(b&&b._placeholder)return a[b.num];if(e(b))for(var d=0;d<b.length;d++)b[d]=c(b[d]);else if(b&&"object"==typeof b)for(d in b)b[d]=c(b[d]);return b}b.data=c(b.data);b.attachments=
void 0;return b};c.removeBlobs=function(b,c){function h(b,p,m){if(!b)return b;if(a.Blob&&b instanceof Blob||a.File&&b instanceof File){l++;var n=new FileReader;n.onload=function(){m?m[p]=this.result:t=this.result;--l||c(t)};n.readAsArrayBuffer(b)}else if(e(b))for(n=0;n<b.length;n++)h(b[n],n,b);else if(b&&"object"==typeof b&&!d(b))for(n in b)h(b[n],n,b)}var l=0,t=b;h(t);l||c(t)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./is-buffer":58,
isarray:33}],57:[function(b,a,c){function e(){}function h(b){var a=!1;var e=""+b.type;if(c.BINARY_EVENT==b.type||c.BINARY_ACK==b.type)e+=b.attachments,e+="-";b.nsp&&"/"!=b.nsp&&(a=!0,e+=b.nsp);null!=b.id&&(a&&(e+=",",a=!1),e+=b.id);null!=b.data&&(a&&(e+=","),e+=n.stringify(b.data));m("encoded %j as %s",b,e);return e}function l(b,a){g.removeBlobs(b,function(b){var c=g.deconstructPacket(b);b=h(c.packet);c=c.buffers;c.unshift(b);a(c)})}function t(){this.reconstructor=null}function p(b){this.reconPack=
b;this.buffers=[]}var m=b("debug")("socket.io-parser"),n=b("json3");b("isarray");a=b("component-emitter");var g=b("./binary"),k=b("./is-buffer");c.protocol=4;c.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" ");c.CONNECT=0;c.DISCONNECT=1;c.EVENT=2;c.ACK=3;c.ERROR=4;c.BINARY_EVENT=5;c.BINARY_ACK=6;c.Encoder=e;c.Decoder=t;e.prototype.encode=function(b,a){m("encoding packet %j",b);c.BINARY_EVENT==b.type||c.BINARY_ACK==b.type?l(b,a):(b=h(b),a([b]))};a(t.prototype);t.prototype.add=
function(b){if("string"==typeof b){a:{var a={},e=0;a.type=Number(b.charAt(0));if(null==c.types[a.type])b={type:c.ERROR,data:"parser error"};else{if(c.BINARY_EVENT==a.type||c.BINARY_ACK==a.type){for(var d="";"-"!=b.charAt(++e)&&(d+=b.charAt(e),e!=b.length););if(d!=Number(d)||"-"!=b.charAt(e))throw Error("Illegal attachments");a.attachments=Number(d)}if("/"==b.charAt(e+1))for(a.nsp="";++e;){d=b.charAt(e);if(","==d)break;a.nsp+=d;if(e==b.length)break}else a.nsp="/";d=b.charAt(e+1);if(""!==d&&Number(d)==
d){for(a.id="";++e;){d=b.charAt(e);if(null==d||Number(d)!=d){--e;break}a.id+=b.charAt(e);if(e==b.length)break}a.id=Number(a.id)}if(b.charAt(++e))try{a.data=n.parse(b.substr(e))}catch(vf){b={type:c.ERROR,data:"parser error"};break a}m("decoded %s as %j",b,a);b=a}}c.BINARY_EVENT==b.type||c.BINARY_ACK==b.type?(this.reconstructor=new p(b),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",b)):this.emit("decoded",b)}else if(k(b)||b.base64)if(this.reconstructor){if(b=this.reconstructor.takeBinaryData(b))this.reconstructor=
null,this.emit("decoded",b)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+b);};t.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};p.prototype.takeBinaryData=function(b){this.buffers.push(b);return this.buffers.length==this.reconPack.attachments?(b=g.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),b):null};p.prototype.finishedReconstruction=function(){this.reconPack=null;
this.buffers=[]}},{"./binary":56,"./is-buffer":58,"component-emitter":8,debug:10,isarray:33,json3:34}],58:[function(b,a,c){(function(b){a.exports=function(a){return b.Buffer&&b.Buffer.isBuffer(a)||b.ArrayBuffer&&a instanceof ArrayBuffer}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],59:[function(b,a,c){a.exports=function(b,a){for(var c=[],e=(a=a||0)||0;e<b.length;e++)c[e-a]=b[e];return c}},{}],60:[function(b,a,c){(function(b){(function(e){function d(b){for(var a=
[],c=0,e=b.length,d,h;c<e;)d=b.charCodeAt(c++),55296<=d&&56319>=d&&c<e?(h=b.charCodeAt(c++),56320==(h&64512)?a.push(((d&1023)<<10)+(h&1023)+65536):(a.push(d),c--)):a.push(d);return a}function h(b){if(55296<=b&&57343>=b)throw Error("Lone surrogate U+"+b.toString(16).toUpperCase()+" is not a scalar value");}function p(){if(E>=x)throw Error("Invalid byte index");var b=u[E]&255;E++;if(128==(b&192))return b&63;throw Error("Invalid continuation byte");}function m(){if(E>x)throw Error("Invalid byte index");
if(E==x)return!1;var b=u[E]&255;E++;if(0==(b&128))return b;if(192==(b&224)){var a=p();b=(b&31)<<6|a;if(128<=b)return b;throw Error("Invalid continuation byte");}if(224==(b&240)){a=p();var c=p();b=(b&15)<<12|a<<6|c;if(2048<=b)return h(b),b;throw Error("Invalid continuation byte");}if(240==(b&248)){a=p();c=p();var e=p();b=(b&15)<<18|a<<12|c<<6|e;if(65536<=b&&1114111>=b)return b}throw Error("Invalid UTF-8 detected");}var n="object"==typeof c&&c,g="object"==typeof a&&a&&a.exports==n&&a,k="object"==typeof b&&
b;if(k.global===k||k.window===k)e=k;var V=String.fromCharCode,u,x,E;k={version:"2.0.0",encode:function(b){b=d(b);for(var a=b.length,c=-1,e,l="";++c<a;){e=b[c];if(0==(e&4294967168))e=V(e);else{var t="";0==(e&4294965248)?t=V(e>>6&31|192):0==(e&4294901760)?(h(e),t=V(e>>12&15|224),t+=V(e>>6&63|128)):0==(e&4292870144)&&(t=V(e>>18&7|240),t+=V(e>>12&63|128),t+=V(e>>6&63|128));e=t+=V(e&63|128)}l+=e}return l},decode:function(b){u=d(b);x=u.length;E=0;b=[];for(var a;!1!==(a=m());)b.push(a);a=b.length;for(var c=
-1,e,h="";++c<a;)e=b[c],65535<e&&(e-=65536,h+=V(e>>>10&1023|55296),e=56320|e&1023),h+=V(e);return h}};if(n&&!n.nodeType)if(g)g.exports=k;else{e={}.hasOwnProperty;for(var v in k)e.call(k,v)&&(n[v]=k[v])}else e.utf8=k})(this)}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],61:[function(b,a,c){a.exports="function"===typeof Object.create?function(b,a){b.super_=a;b.prototype=Object.create(a.prototype,{constructor:{value:b,enumerable:!1,
writable:!0,configurable:!0}})}:function(b,a){b.super_=a;var c=function(){};c.prototype=a.prototype;b.prototype=new c;b.prototype.constructor=b}},{}],62:[function(b,a,c){a.exports=function(b){return b&&"object"===typeof b&&"function"===typeof b.copy&&"function"===typeof b.fill&&"function"===typeof b.readUInt8}},{}],63:[function(b,a,c){(function(a,e){function d(b,a){var e={seen:[],stylize:p};3<=arguments.length&&(e.depth=arguments[2]);4<=arguments.length&&(e.colors=arguments[3]);v(a)?e.showHidden=
a:a&&c._extend(e,a);w(e.showHidden)&&(e.showHidden=!1);w(e.depth)&&(e.depth=2);w(e.colors)&&(e.colors=!1);w(e.customInspect)&&(e.customInspect=!0);e.colors&&(e.stylize=h);return n(e,b,e.depth)}function h(b,a){return(a=d.styles[a])?"\u001b["+d.colors[a][0]+"m"+b+"\u001b["+d.colors[a][1]+"m":b}function p(b,a){return b}function m(b){var a={};b.forEach(function(b,c){a[b]=!0});return a}function n(b,a,e){if(b.customInspect&&a&&D(a.inspect)&&a.inspect!==c.inspect&&(!a.constructor||a.constructor.prototype!==
a)){var d=a.inspect(e,b);O(d)||(d=n(b,d,e));return d}if(d=g(b,a))return d;var h=Object.keys(a),l=m(h);b.showHidden&&(h=Object.getOwnPropertyNames(a));if(F(a)&&(0<=h.indexOf("message")||0<=h.indexOf("description")))return k(a);if(0===h.length){if(D(a))return b.stylize("[Function"+(a.name?": "+a.name:"")+"]","special");if(B(a))return b.stylize(RegExp.prototype.toString.call(a),"regexp");if(A(a))return b.stylize(Date.prototype.toString.call(a),"date");if(F(a))return k(a)}d="";var t=!1,p=["{","}"];E(a)&&
(t=!0,p=["[","]"]);D(a)&&(d=" [Function"+(a.name?": "+a.name:"")+"]");B(a)&&(d=" "+RegExp.prototype.toString.call(a));A(a)&&(d=" "+Date.prototype.toUTCString.call(a));F(a)&&(d=" "+k(a));if(0===h.length&&(!t||0==a.length))return p[0]+d+p[1];if(0>e)return B(a)?b.stylize(RegExp.prototype.toString.call(a),"regexp"):b.stylize("[Object]","special");b.seen.push(a);h=t?V(b,a,e,l,h):h.map(function(c){return u(b,a,e,l,c,t)});b.seen.pop();return x(h,d,p)}function g(b,a){if(w(a))return b.stylize("undefined",
"undefined");if(O(a))return a="'"+JSON.stringify(a).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",b.stylize(a,"string");if(y(a))return b.stylize(""+a,"number");if(v(a))return b.stylize(""+a,"boolean");if(null===a)return b.stylize("null","null")}function k(b){return"["+Error.prototype.toString.call(b)+"]"}function V(b,a,c,e,d){for(var h=[],l=0,t=a.length;l<t;++l)Object.prototype.hasOwnProperty.call(a,String(l))?h.push(u(b,a,c,e,String(l),!0)):h.push("");d.forEach(function(d){d.match(/^\d+$/)||
h.push(u(b,a,c,e,d,!0))});return h}function u(b,a,c,e,d,h){var l,t;a=Object.getOwnPropertyDescriptor(a,d)||{value:a[d]};a.get?t=a.set?b.stylize("[Getter/Setter]","special"):b.stylize("[Getter]","special"):a.set&&(t=b.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(e,d)||(l="["+d+"]");t||(0>b.seen.indexOf(a.value)?(t=null===c?n(b,a.value,null):n(b,a.value,c-1),-1<t.indexOf("\n")&&(t=h?t.split("\n").map(function(b){return"  "+b}).join("\n").substr(2):"\n"+t.split("\n").map(function(b){return"   "+
b}).join("\n"))):t=b.stylize("[Circular]","special"));if(w(l)){if(h&&d.match(/^\d+$/))return t;l=JSON.stringify(""+d);l.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(l=l.substr(1,l.length-2),l=b.stylize(l,"name")):(l=l.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),l=b.stylize(l,"string"))}return l+": "+t}function x(b,a,c){var e=0;return 60<b.reduce(function(b,a){e++;0<=a.indexOf("\n")&&e++;return b+a.replace(/\u001b\[\d\d?m/g,"").length+1},0)?c[0]+(""===a?"":a+"\n ")+" "+b.join(",\n  ")+
" "+c[1]:c[0]+a+" "+b.join(", ")+" "+c[1]}function E(b){return Array.isArray(b)}function v(b){return"boolean"===typeof b}function y(b){return"number"===typeof b}function O(b){return"string"===typeof b}function w(b){return void 0===b}function B(b){return z(b)&&"[object RegExp]"===Object.prototype.toString.call(b)}function z(b){return"object"===typeof b&&null!==b}function A(b){return z(b)&&"[object Date]"===Object.prototype.toString.call(b)}function F(b){return z(b)&&("[object Error]"===Object.prototype.toString.call(b)||
b instanceof Error)}function D(b){return"function"===typeof b}function C(b){return 10>b?"0"+b.toString(10):b.toString(10)}function K(){var b=new Date,a=[C(b.getHours()),C(b.getMinutes()),C(b.getSeconds())].join(":");return[b.getDate(),N[b.getMonth()],a].join(" ")}var H=/%[sdj%]/g;c.format=function(b){if(!O(b)){for(var a=[],c=0;c<arguments.length;c++)a.push(d(arguments[c]));return a.join(" ")}c=1;var e=arguments,h=e.length;a=String(b).replace(H,function(b){if("%%"===b)return"%";if(c>=h)return b;switch(b){case "%s":return String(e[c++]);
case "%d":return Number(e[c++]);case "%j":try{return JSON.stringify(e[c++])}catch(Zk){return"[Circular]"}default:return b}});for(var l=e[c];c<h;l=e[++c])a=null!==l&&z(l)?a+(" "+d(l)):a+(" "+l);return a};c.deprecate=function(b,d){if(w(e.process))return function(){return c.deprecate(b,d).apply(this,arguments)};if(!0===a.noDeprecation)return b;var h=!1;return function(){if(!h){if(a.throwDeprecation)throw Error(d);a.traceDeprecation?console.trace(d):console.error(d);h=!0}return b.apply(this,arguments)}};
var J={},M;c.debuglog=function(b){w(M)&&(M=a.env.NODE_DEBUG||"");b=b.toUpperCase();if(!J[b])if((new RegExp("\\b"+b+"\\b","i")).test(M)){var e=a.pid;J[b]=function(){var a=c.format.apply(c,arguments);console.error("%s %d: %s",b,e,a)}}else J[b]=function(){};return J[b]};c.inspect=d;d.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};d.styles={special:"cyan",number:"yellow",
"boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};c.isArray=E;c.isBoolean=v;c.isNull=function(b){return null===b};c.isNullOrUndefined=function(b){return null==b};c.isNumber=y;c.isString=O;c.isSymbol=function(b){return"symbol"===typeof b};c.isUndefined=w;c.isRegExp=B;c.isObject=z;c.isDate=A;c.isError=F;c.isFunction=D;c.isPrimitive=function(b){return null===b||"boolean"===typeof b||"number"===typeof b||"string"===typeof b||"symbol"===typeof b||"undefined"===
typeof b};c.isBuffer=b("./support/isBuffer");var N="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");c.log=function(){console.log("%s - %s",K(),c.format.apply(c,arguments))};c.inherits=b("inherits");c._extend=function(b,a){if(!a||!z(a))return b;for(var c=Object.keys(a),e=c.length;e--;)b[c[e]]=a[c[e]];return b}}).call(this,b("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":62,_process:43,inherits:61}],
64:[function(b,a,c){if(window.mozRTCPeerConnection||navigator.mozGetUserMedia){var e="moz";var h=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)}else if(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)e="webkit",h=navigator.userAgent.match(/Chrom(e|ium)/)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10);b=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;c=window.mozRTCIceCandidate||window.RTCIceCandidate;var l=
window.mozRTCSessionDescription||window.RTCSessionDescription,t=window.webkitMediaStream||window.MediaStream,p="https:"===window.location.protocol&&("webkit"===e&&26<=h||"moz"===e&&33<=h),m=window.AudioContext||window.webkitAudioContext,n=document.createElement("video");n=n&&n.canPlayType&&"probably"===n.canPlayType('video/webm; codecs="vp8", vorbis');var g=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;a.exports={prefix:e,browserVersion:h,
support:!!b&&!!g,supportRTCPeerConnection:!!b,supportVp8:n,supportGetUserMedia:!!g,supportDataChannel:!!(b&&b.prototype&&b.prototype.createDataChannel),supportWebAudio:!(!m||!m.prototype.createMediaStreamSource),supportMediaStream:!(!t||!t.prototype.removeTrack),supportScreenSharing:!!p,AudioContext:m,PeerConnection:b,SessionDescription:l,IceCandidate:c,MediaStream:t,getUserMedia:g}},{}],65:[function(b,a,c){function e(){}a.exports=e;e.mixin=function(b){b=b.prototype||b;b.isWildEmitter=!0;b.on=function(b,
a,c){this.callbacks=this.callbacks||{};var e=3===arguments.length,d=e?arguments[2]:arguments[1];d._groupName=e?arguments[1]:void 0;(this.callbacks[b]=this.callbacks[b]||[]).push(d);return this};b.once=function(b,a,c){function e(){d.off(b,e);l.apply(this,arguments)}var d=this,h=3===arguments.length,l=h?arguments[2]:arguments[1];this.on(b,h?arguments[1]:void 0,e);return this};b.releaseGroup=function(b){this.callbacks=this.callbacks||{};var a,c;for(a in this.callbacks){var e=this.callbacks[a];var d=
0;for(c=e.length;d<c;d++)e[d]._groupName===b&&(e.splice(d,1),d--,c--)}return this};b.off=function(b,a){this.callbacks=this.callbacks||{};var c=this.callbacks[b];if(!c)return this;if(1===arguments.length)return delete this.callbacks[b],this;var e=c.indexOf(a);c.splice(e,1);0===c.length&&delete this.callbacks[b];return this};b.emit=function(b){this.callbacks=this.callbacks||{};var a=[].slice.call(arguments,1),c=this.callbacks[b],e=this.getWildcardCallbacks(b),d;if(c){var h=c.slice();c=0;for(d=h.length;c<
d&&h[c];++c)h[c].apply(this,a)}if(e)for(h=e.slice(),c=0,d=h.length;c<d&&h[c];++c)h[c].apply(this,[b].concat(a));return this};b.getWildcardCallbacks=function(b){this.callbacks=this.callbacks||{};var a,c=[];for(a in this.callbacks){var e=a.split("*");if("*"===a||2===e.length&&b.slice(0,e[0].length)===e[0])c=c.concat(this.callbacks[a])}return c}};e.mixin(e)},{}],66:[function(b,a,c){function e(b,a,c){return a?new h(b,a):new h(b)}b=function(){return this}();var h=b.WebSocket||b.MozWebSocket;a.exports=
h?e:null;h&&(e.prototype=h.prototype)},{}],67:[function(b,a,c){function e(b){var a=!0;b.getTracks().forEach(function(b){a="ended"===b.readyState&&a});return a}function h(b){var a=this;p.call(this);this.id=b.id;this.parent=b.parent;this.type=b.type||"video";this.oneway=b.oneway||!1;this.sharemyscreen=b.sharemyscreen||!1;this.browserPrefix=b.prefix;this.stream=b.stream;this.enableDataChannels=void 0===b.enableDataChannels?this.parent.config.enableDataChannels:b.enableDataChannels;this.receiveMedia=
b.receiveMedia||this.parent.config.receiveMedia;this.channels={};this.sid=b.sid||Date.now().toString();this.pc=new t(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints);this.pc.on("ice",this.onIceCandidate.bind(this));this.pc.on("endOfCandidates",function(b){a.send("endOfCandidates",b)});this.pc.on("offer",function(b){a.parent.config.nick&&(b.nick=a.parent.config.nick);a.send("offer",b)});this.pc.on("answer",function(b){a.parent.config.nick&&(b.nick=a.parent.config.nick);
a.send("answer",b)});this.pc.on("addStream",this.handleRemoteStreamAdded.bind(this));this.pc.on("addChannel",this.handleDataChannelAdded.bind(this));this.pc.on("removeStream",this.handleStreamRemoved.bind(this));this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded"));this.pc.on("iceConnectionStateChange",this.emit.bind(this,"iceConnectionStateChange"));this.pc.on("iceConnectionStateChange",function(){switch(a.pc.iceConnectionState){case "failed":"offer"===a.pc.pc.localDescription.type&&
(a.parent.emit("iceFailed",a),a.send("connectivityError"))}});this.pc.on("signalingStateChange",this.emit.bind(this,"signalingStateChange"));this.logger=this.parent.logger;"screen"===b.type?this.parent.localScreens&&this.parent.localScreens[0]&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),this.pc.addStream(this.parent.localScreens[0]),this.broadcaster=b.broadcaster):this.parent.localStreams.forEach(function(b){a.pc.addStream(b)});this.on("channelOpen",function(b){"https://simplewebrtc.com/protocol/filetransfer#inband-v1"===
b.protocol&&(b.onmessage=function(c){c=JSON.parse(c.data);var e=new m.Receiver;e.receive(c,b);a.emit("fileTransfer",c,e);e.on("receivedFile",function(b,a){e.channel.close()})})});this.on("*",function(){a.parent.emit.apply(a.parent,arguments)})}c=b("util");var l=b("webrtcsupport"),t=b("rtcpeerconnection"),p=b("wildemitter"),m=b("filetransfer");c.inherits(h,p);h.prototype.handleMessage=function(b){var a=this;this.logger.log("getting",b.type,b);b.prefix&&(this.browserPrefix=b.prefix);"offer"===b.type?
(this.nick||(this.nick=b.payload.nick),delete b.payload.nick,this.pc.handleOffer(b.payload,function(b){b||a.pc.answer(function(b,a){})})):"answer"===b.type?(this.nick||(this.nick=b.payload.nick),delete b.payload.nick,this.pc.handleAnswer(b.payload)):"candidate"===b.type?this.pc.processIce(b.payload):"connectivityError"===b.type?this.parent.emit("connectivityError",a):"mute"===b.type?this.parent.emit("mute",{id:b.from,name:b.payload.name}):"unmute"===b.type?this.parent.emit("unmute",{id:b.from,name:b.payload.name}):
"endOfCandidates"===b.type&&this.pc.pc.addIceCandidate(void 0)};h.prototype.send=function(b,a){a={to:this.id,sid:this.sid,broadcaster:this.broadcaster,roomType:this.type,type:b,payload:a,prefix:l.prefix};this.logger.log("sending",b,a);this.parent.emit("message",a)};h.prototype.sendDirectly=function(b,a,c){c={type:a,payload:c};this.logger.log("sending via datachannel",b,a,c);b=this.getDataChannel(b);if("open"!=b.readyState)return!1;b.send(JSON.stringify(c));return!0};h.prototype._observeDataChannel=
function(b){var a=this;b.onclose=this.emit.bind(this,"channelClose",b);b.onerror=this.emit.bind(this,"channelError",b);b.onmessage=function(c){a.emit("channelMessage",a,b.label,JSON.parse(c.data),b,c)};b.onopen=this.emit.bind(this,"channelOpen",b)};h.prototype.getDataChannel=function(b,a){if(!l.supportDataChannel)return this.emit("error",Error("createDataChannel not supported"));var c=this.channels[b];a||(a={});if(c)return c;c=this.channels[b]=this.pc.createDataChannel(b,a);this._observeDataChannel(c);
return c};h.prototype.onIceCandidate=function(b){if(!this.closed)if(b){var a=this.parent.config.peerConnectionConfig;"moz"===l.prefix&&a&&a.iceTransports&&b.candidate&&b.candidate.candidate&&0>b.candidate.candidate.indexOf(a.iceTransports)?this.logger.log("Ignoring ice candidate not matching pcConfig iceTransports type: ",a.iceTransports):this.send("candidate",b)}else this.logger.log("End of candidates.")};h.prototype.start=function(){this.enableDataChannels&&this.getDataChannel("simplewebrtc");this.pc.offer(this.receiveMedia,
function(b,a){})};h.prototype.icerestart=function(){var b=this.receiveMedia;b.mandatory.IceRestart=!0;this.pc.offer(b,function(b,a){})};h.prototype.end=function(){this.closed||(this.pc.close(),this.handleStreamRemoved())};h.prototype.handleRemoteStreamAdded=function(b){var a=this;this.stream?this.logger.warn("Already have a remote stream"):(this.stream=b.stream,this.stream.getTracks().forEach(function(b){b.addEventListener("ended",function(){e(a.stream)&&a.end()})}),this.parent.emit("peerStreamAdded",
this))};h.prototype.handleStreamRemoved=function(){var b=this.parent.peers.indexOf(this);-1<b&&(this.parent.peers.splice(b,1),this.closed=!0,this.parent.emit("peerStreamRemoved",this))};h.prototype.handleDataChannelAdded=function(b){this.channels[b.label]=b;this._observeDataChannel(b)};h.prototype.sendFile=function(b){var a=new m.Sender,c=this.getDataChannel("filetransfer"+(new Date).getTime(),{protocol:"https://simplewebrtc.com/protocol/filetransfer#inband-v1"});c.onopen=function(){c.send(JSON.stringify({size:b.size,
name:b.name}));a.send(b,c)};c.onclose=function(){console.log("sender received transfer");a.emit("complete")};return a};a.exports=h},{filetransfer:26,rtcpeerconnection:44,util:63,webrtcsupport:64,wildemitter:65}],68:[function(b,a,c){function e(b){var a=this,c=b||{},e=this.config={url:"https://sandbox.simplewebrtc.com:443/",socketio:{},connection:null,debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!1,peerVolumeWhenSpeaking:.25,
media:{video:!0,audio:!0},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},localVideo:{autoplay:!0,mirror:!0,muted:!0}},d;var k=b.debug?b.logger||console:b.logger||m;this.logger=k;for(d in c)c.hasOwnProperty(d)&&(this.config[d]=c[d]);this.capabilities=t;l.call(this);var n=null===this.config.connection?this.connection=new g(this.config):this.connection=this.config.connection;n.on("connect",function(){a.emit("connectionReady",n.getSessionid());a.sessionReady=!0;a.testReadiness()});n.on("message",
function(b){var c=a.webrtc.getPeers(b.from,b.roomType);if("offer"===b.type){c.length&&c.forEach(function(a){a.sid==b.sid&&(e=a)});if(!e){var e=a.webrtc.createPeer({id:b.from,sid:b.sid,type:b.roomType,enableDataChannels:a.config.enableDataChannels&&"screen"!==b.roomType,sharemyscreen:"screen"===b.roomType&&!b.broadcaster,broadcaster:"screen"!==b.roomType||b.broadcaster?null:a.connection.getSessionid()});a.emit("createdPeer",e)}e.handleMessage(b)}else c.length&&c.forEach(function(a){b.sid?a.sid===b.sid&&
a.handleMessage(b):a.handleMessage(b)})});n.on("remove",function(b){b.id!==a.connection.getSessionid()&&a.webrtc.removePeers(b.id,b.type)});b.logger=this.logger;b.debug=!1;this.webrtc=new h(b);"mute unmute pauseVideo resumeVideo pause resume sendToAll sendDirectlyToAll getPeers".split(" ").forEach(function(b){a[b]=a.webrtc[b].bind(a.webrtc)});this.webrtc.on("*",function(){a.emit.apply(a,arguments)});if(e.debug)this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:"));this.webrtc.on("localStream",
function(){a.testReadiness()});this.webrtc.on("message",function(b){a.connection.emit("message",b)});this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this));this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this));this.config.adjustPeerVolume&&(this.webrtc.on("speaking",this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1)));n.on("stunservers",function(b){a.webrtc.config.peerConnectionConfig.iceServers=
b;a.emit("stunservers",b)});n.on("turnservers",function(b){a.webrtc.config.peerConnectionConfig.iceServers=a.webrtc.config.peerConnectionConfig.iceServers.concat(b);a.emit("turnservers",b)});this.webrtc.on("iceFailed",function(b){});this.webrtc.on("connectivityError",function(b){});this.webrtc.on("audioOn",function(){a.webrtc.sendToAll("unmute",{name:"audio"})});this.webrtc.on("audioOff",function(){a.webrtc.sendToAll("mute",{name:"audio"})});this.webrtc.on("videoOn",function(){a.webrtc.sendToAll("unmute",
{name:"video"})});this.webrtc.on("videoOff",function(){a.webrtc.sendToAll("mute",{name:"video"})});this.webrtc.on("localScreen",function(b){var c=document.createElement("video"),e=a.getRemoteVideoContainer();c.oncontextmenu=function(){return!1};c.id="localScreen";p(b,c);e&&e.appendChild(c);a.emit("localScreenAdded",c);a.connection.emit("shareScreen");a.webrtc.peers.forEach(function(b){"video"===b.type&&(b=a.webrtc.createPeer({id:b.id,type:"screen",sharemyscreen:!0,enableDataChannels:!1,receiveMedia:{offerToReceiveAudio:0,
offerToReceiveVideo:0},broadcaster:a.connection.getSessionid()}),a.emit("createdPeer",b),b.start())})});this.webrtc.on("localScreenStopped",function(b){a.getLocalScreen()&&a.stopScreenShare()});this.webrtc.on("channelMessage",function(b,c,e){"volume"==e.type&&a.emit("remoteVolumeChange",b,e.volume)});this.config.autoRequestMedia&&this.startLocalVideo()}var h=b("./webrtc"),l=b("wildemitter"),t=b("webrtcsupport"),p=b("attachmediastream"),m=b("mockconsole"),g=b("./socketioconnection");e.prototype=Object.create(l.prototype,
{constructor:{value:e}});e.prototype.leaveRoom=function(){if(this.roomName){for(this.connection.emit("leave");this.webrtc.peers.length;)this.webrtc.peers[0].end();this.getLocalScreen()&&this.stopScreenShare();this.emit("leftRoom",this.roomName);this.roomName=void 0}};e.prototype.disconnect=function(){this.connection.disconnect();delete this.connection};e.prototype.handlePeerStreamAdded=function(b){var a=this,c=this.getRemoteVideoContainer(),e=p(b.stream);b.videoEl=e;e.id=this.getDomId(b);c&&c.appendChild(e);
this.emit("videoAdded",e,b);window.setTimeout(function(){a.webrtc.isAudioEnabled()||b.send("mute",{name:"audio"});a.webrtc.isVideoEnabled()||b.send("mute",{name:"video"})},250)};e.prototype.handlePeerStreamRemoved=function(b){var a=this.getRemoteVideoContainer(),c=b.videoEl;this.config.autoRemoveVideos&&a&&c&&a.removeChild(c);c&&this.emit("videoRemoved",c,b)};e.prototype.getDomId=function(b){return[b.id,b.type,b.broadcaster?"broadcasting":"incoming"].join("_")};e.prototype.setVolumeForAll=function(b){this.webrtc.peers.forEach(function(a){a.videoEl&&
(a.videoEl.volume=b)})};e.prototype.joinRoom=function(b,a){var c=this;this.roomName=b;this.connection.emit("join",b,function(e,d){console.log("join CB",e);if(e)c.emit("error",e);else{z.room=d.xtra;var h,l;for(h in d.clients){var t=d.clients[h];for(l in t)if(t[l]){var p=c.webrtc.createPeer({id:h,type:l,enableDataChannels:c.config.enableDataChannels&&"screen"!==l,receiveMedia:{offerToReceiveAudio:"screen"!==l&&c.config.receiveMedia.offerToReceiveAudio?1:0,offerToReceiveVideo:c.config.receiveMedia.offerToReceiveVideo}});
c.emit("createdPeer",p);p.start()}}}a&&a(e,d);c.emit("joinedRoom",b)})};e.prototype.getEl=function(b){return"string"===typeof b?document.getElementById(b):b};e.prototype.startLocalVideo=function(){var b=this;this.webrtc.start(this.config.media,function(a,c){a?b.emit("localMediaError",a):p(c,b.getLocalVideoContainer(),b.config.localVideo)})};e.prototype.stopLocalVideo=function(){this.webrtc.stop()};e.prototype.getLocalVideoContainer=function(){var b=this.getEl(this.config.localVideoEl);if(b&&"VIDEO"===
b.tagName)return b.oncontextmenu=function(){return!1},b;if(b){var a=document.createElement("video");a.oncontextmenu=function(){return!1};b.appendChild(a);return a}};e.prototype.getRemoteVideoContainer=function(){return this.getEl(this.config.remoteVideosEl)};e.prototype.shareScreen=function(b){this.webrtc.startScreenShare(b)};e.prototype.getLocalScreen=function(){return this.webrtc.localScreens&&this.webrtc.localScreens[0]};e.prototype.stopScreenShare=function(){this.connection.emit("unshareScreen");
var b=document.getElementById("localScreen"),a=this.getRemoteVideoContainer();this.config.autoRemoveVideos&&a&&b&&a.removeChild(b);b&&this.emit("videoRemoved",b);this.getLocalScreen()&&this.webrtc.stopScreenShare();this.webrtc.peers.forEach(function(b){b.broadcaster&&b.end()})};e.prototype.testReadiness=function(){this.sessionReady&&(this.config.media.video||this.config.media.audio?0<this.webrtc.localStreams.length&&this.emit("readyToCall",this.connection.getSessionid()):this.emit("readyToCall",this.connection.getSessionid()))};
e.prototype.createRoom=function(b,a){this.roomName=b;this.connection.emit("create",z.room,a)};e.prototype.sendFile=function(){if(!t.dataChannel)return this.emit("error",Error("DataChannelNotSupported"))};a.exports=e},{"./socketioconnection":69,"./webrtc":70,attachmediastream:3,mockconsole:37,webrtcsupport:64,wildemitter:65}],69:[function(b,a,c){function e(b){this.connection=h.connect(b.url,b.socketio)}var h=b("socket.io-client");e.prototype.on=function(b,a){this.connection.on(b,a)};e.prototype.emit=
function(){this.connection.emit.apply(this.connection,arguments)};e.prototype.getSessionid=function(){return this.connection.id};e.prototype.disconnect=function(){return this.connection.disconnect()};a.exports=e},{"socket.io-client":50}],70:[function(b,a,c){function e(b){var a=this,c=b||{};this.config={debug:!1,peerConnectionConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[]},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},enableDataChannels:!0};
var e;b=b.debug?b.logger||console:b.logger||l;this.logger=b;for(e in c)c.hasOwnProperty(e)&&(this.config[e]=c[e]);h.support||this.logger.error("Your browser doesn't seem to support WebRTC");this.peers=[];t.call(this,this.config);this.on("speaking",function(){a.hardMuted||a.peers.forEach(function(b){b.enableDataChannels&&(b=b.getDataChannel("hark"),"open"==b.readyState&&b.send(JSON.stringify({type:"speaking"})))})});this.on("stoppedSpeaking",function(){a.hardMuted||a.peers.forEach(function(b){b.enableDataChannels&&
(b=b.getDataChannel("hark"),"open"==b.readyState&&b.send(JSON.stringify({type:"stoppedSpeaking"})))})});this.on("volumeChange",function(b,c){a.hardMuted||a.peers.forEach(function(a){a.enableDataChannels&&(a=a.getDataChannel("hark"),"open"==a.readyState&&a.send(JSON.stringify({type:"volume",volume:b})))})});if(this.config.debug)this.on("*",function(b,c,e){(a.config.logger===l?console:a.logger).log("event:",b,c,e)})}c=b("util");var h=b("webrtcsupport"),l=b("mockconsole"),t=b("localmedia"),p=b("./peer");
c.inherits(e,t);e.prototype.createPeer=function(b){b.parent=this;b=new p(b);this.peers.push(b);return b};e.prototype.removePeers=function(b,a){this.getPeers(b,a).forEach(function(b){b.end()})};e.prototype.getPeers=function(b,a){return this.peers.filter(function(c){return(!b||c.id===b)&&(!a||c.type===a)})};e.prototype.sendToAll=function(b,a){this.peers.forEach(function(c){c.send(b,a)})};e.prototype.sendDirectlyToAll=function(b,a,c){this.peers.forEach(function(e){e.enableDataChannels&&e.sendDirectly(b,
a,c)})};a.exports=e},{"./peer":67,localmedia:35,mockconsole:37,util:63,webrtcsupport:64}]},{},[68])(68)});var x,la,A={},z={name:"Guest"};console.log("%c nehhon %c POWER ","background: #000; color: #00ffff; font-size:35px","background: #00ffff; color: #000; font-size:35px");console.log("%c Author: Ruben ","background: #00ffff; color: #000; font-size:35px");console.log("%c webmaster@nehhon.com ","background: #00ffff; color: #000; font-size:35px");console.log("%c @nehhon ","background: #00ffff; color: #000; font-size:35px");
var Dj=!!window.opr||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),Ej="undefined"!==typeof InstallTrigger,Fj=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),qh=!!document.documentMode,Gj=!qh&&!!window.StyleMedia,Hj=!!window.chrome&&!!window.chrome.webstore,nc;Dj?nc="Opera":Ej?nc="Firefox":Fj?nc="Safari":qh?nc="IE":Gj?nc="Edge":Hj&&(nc="Chrome");z.navLang=navigator.language||navigator.userLanguage;z.race=0;z.navigator=nc;z.mx=151;z.onlineID=null;z.temperature=
0;var Ij=location.pathname.split("/")[1],rh="en es it pt ru pl bg de".split(" ");z.lang=rh.indexOf(Ij);0>z.lang&&(z.lang=0);z.langCodeUrl=z.lang?rh[z.lang]+"/":"";var M=console.log,Jj=document.getElementById("alerttitle"),Kj=document.getElementById("alerttext"),Lj=document.getElementById("alert"),Ub=function(a,b,e){Lj.style.display="block";Jj.innerHTML=b||A.warning;Kj.innerHTML=a;e?document.getElementById("alertok").style.display="none":document.getElementById("alertok").style.display="block"},Cf,
th=function(a,b,e){var f=new XMLHttpRequest;f.open("GET",a,!0);f.responseType="arraybuffer";f.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");f.onreadystatechange=function(){4==this.readyState&&200==this.status&&(b.length?J[b]=sh(f.response):J.xtra[b]=sh(f.response),J.load++,Gb&&J.load===J.images&&Gb())};e&&(f.onprogress=function(b){e(b)});f.send(!0)},sh=function(a){performance.now();a=new Uint16Array(a);var b=a.length,f=a[b-4]+65536*a[b-3],c=a[b-2]+65536*a[b-1];
b-=2;var d=-1;c=new Uint8Array(4*c);for(var h=0;f<b;f++){var l=a[f];if(65533<l){65535==l?(l=a[f+1],f+=1):(l=a[f+1]+65536*a[f+2],f+=2);for(var t=0;t<l;t++)c[h++]=d&255,c[h++]=d>>8&255,c[h++]=d>>16&255,c[h++]=d>>24&255}else l=a[2*l]+65536*a[2*l+1],c[h++]=l&255,c[h++]=l>>8&255,c[h++]=l>>16&255,c[h++]=l>>24&255,d=l}return c},J={size:512,load:0,xtra:[]},Gb;J.xtraRes=[];var S={page:0,length:8,leftButton:document.getElementById("aleft"),rightButton:document.getElementById("aright"),stock:document.getElementById("stock")},
k;(function(){var a=0,b=0,e=function(f){f.target.loadedSize||(b+=f.total,f.target.lastLoaded=0,f.target.loadedSize=!0);a+=f.loaded-f.target.lastLoaded;f.target.lastLoaded=f.loaded;c.innerHTML=A.loadgraphics+" "+~~(100*a/b)+"%";c.style.display=a>=b?"none":"block"},c=document.getElementById("notifybottom"),d=function(b){var a=!!b.icons;J.images=Object.keys(b).length;if(a){var f=new XMLHttpRequest;f.open("GET",b.icons,!0);f.responseType="arraybuffer";f.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");
f.onreadystatechange=function(){if(4===f.readyState&&200===f.status){var b=new Uint8Array(f.response);b=new Blob([b],{type:"image/png"});var a=new Image;a.src=URL.createObjectURL(b);J.load++;S.icons=a;Gb&&J.load===J.images&&Gb();Date.now()}};f.onprogress=function(b){e(b)};f.send("")}Date.now();var c=new XMLHttpRequest;c.open("GET",b.imageJSON,!0);a&&c.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");c.onreadystatechange=function(){4==this.readyState&&200==this.status&&
(J.load++,Gb&&J.load===J.images&&Gb(),k=JSON.parse(c.response))};c.onprogress=function(b){e(b)};c.send(!0);th(b.common,"common",e)};(function(){var b=!1;"serviceWorker"in navigator?(console.log("CLIENT: service worker registration in progress."),navigator.serviceWorker.register("/sworker.js").then(function(){console.log("CLIENT: service worker registration complete.")},function(b){M(b);console.log("CLIENT: service worker registration failure.")})):console.log("CLIENT: service worker is not supported.");
Cf=function(){J.started=!0;b||(b=!0,d({icons:"https://dl.dropboxusercontent.com/s/mpc0k7ep2l0v0j2/icons.png",imageJSON:"https://dl.dropboxusercontent.com/s/iea7wlmxml6pus0/images.json",common:"https://dl.dropboxusercontent.com/s/avpm3elzmphq5b1/graphics.nh17"}))}})();setTimeout(function(){J.load<J.images&&(c.style.display="block")},1200)})();var Df={grass:{json:"agjeb95idjel2dr/terrainData.json?v5",main:"xg1qh97bjrm61x0/grass.nh17"},snow:{json:"hwja6mugluokbkh/terrainData.json?v3",main:"1x2cwzm0i7v2sz8/terrain.nh17?v1"},
last:""},Wd,xj=function(){J.images+=2;var a=Df[B("terrainSelect").value];Df.last=B("terrainSelect").value;var b=new XMLHttpRequest;b.open("GET","https://dl.dropboxusercontent.com/s/"+a.json,!0);b.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");b.onreadystatechange=function(){if(4==this.readyState&&200==this.status){J.xtraRes[0]=JSON.parse(b.response);fd=J.xtraRes[0];var a=fd.specialColor;Wd=new Float32Array(wb(a[0]/255,a[1]/255,a[2]/255,.9));J.load++;a="rgb("+a[0]+
","+a[1]+","+a[2]+")";B("msgs1").style.color=a;B("playersinfo").style.color=a;B("topinfo").style.color=a;Gb&&J.load===J.images&&Gb()}};b.send(!0);th("https://dl.dropboxusercontent.com/s/"+a.main,0,!1)};if("undefined"!==typeof AudioContext){var uh=function(a,b,e){b=b.split("/")[1].split(".")[0].toLowerCase();Xd[b]=a;!e||e.music&&e.mid!=Ga.id||(xa(b,e.x,e.y,e.k,e.music,e.date),e.date=0)},vh=function(a,b,e){this.context=a;this.urlList=b;this.onload=e;this.loadCount=0};vh.prototype.loadBuffer=function(a,
b){var f=new XMLHttpRequest;f.open("GET",Mj+a,!0);f.responseType="arraybuffer";f.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");var c=this;f.onreadystatechange=function(){4===f.readyState&&200===f.status&&c.context.decodeAudioData(f.response).then(function(f){f&&uh(f,a,b)})};f.send()};var Xd={},wh="kwf09yi8p5vq1px/Tzar%20Soundtrack%201.mp3 0d7r5b6yq8rvzxa/Tzar%20Soundtrack%202.mp3 6sc2lejtpq5hn1p/Tzar%20Soundtrack%203.mp3 0r454nszfs18sk8/Tzar%20Soundtrack%204.mp3 2qza05mvhvojepw/Tzar%20Soundtrack%205.mp3 55yuwxmo3ebav3v/Tzar%20Soundtrack%206.mp3 d9ifze8utu7b1d4/Tzar%20Soundtrack%207.mp3 ewnlwat5mpm3a6i/Tzar%20Soundtrack%208.mp3 emy8tmk7wrbxqik/Tzar%20Soundtrack%209.mp3 0ryt8t85pu140ys/Tzar%20Soundtrack%2010.mp3 ux3nmflf1efo0si/sr1.mp3 mb8leyhrlx3a8ep/sr2.mp3 uepj5sz037fs6jm/sr3.mp3 aqgug89aiyh78ym/sr4.mp3 v4mnk06t1cm5g2x/sr5.mp3 nnkkl7jddynbbg8/sr6.mp3 0foqk5c3t91c0ll/sr7.mp3 cacamdny4wwisyj/sr8.mp3 m8mbt8r1vlj2i9l/sr9.mp3 ubig3no0l96pnxp/sr10.mp3 jajip2pw72hwz5q/1.mp3 eub8hy6mtuw12vk/2.mp3 mml4nqhhj0ph30d/3.mp3 p72cdqjbjc7oa6v/4.mp3 m895z5a7e1stzg1/5.mp3 ya1yue1ti1ehyo8/6.mp3 lfq7ac9jvtcb8tr/7.mp3 onxh886y06v9c1m/8.mp3 u01v2nu5u1mooma/9.mp3 hfvvah4t7ngs942/10.mp3 zghe44ohag94non/INTRO.mp3 bjdukzb5x2d148f/OUTRO.mp3 m335ymfbydtah6n/WIN1.mp3 j0nl2nra3633p0m/WIN2.mp3 9igi2qh7ixqej07/ATTACK.WAV d48c9woeedsefpq/BALLISTA.WAV toc4s5nzofcrl7a/BLDGDONE.WAV c8k3wd0wmlgxzbj/CHAT%20LOCATION.WAV ser4l9wo87txp9k/TECHDONE.WAV 9f37sjm7co5ccuj/UNITDONE.WAV 6xn0s3j79267158/CHAT.WAV v39gv0xmfobxhm6/E_CASTLE1.WAV 2d9cjalgge5ig3g/E_CATHEDRAL1.WAV xmfkvzft63m3ivi/E_CATHEDRAL2.WAV vzzhxrrqftezh2b/E_FARM1.WAV ftrazbogpf8foip/E_CHURCH1.WAV 961xangoq096ta1/E_FARM2.WAV 5927kzdwz5znu6o/E_HARBOR1.WAV wwjtlgwpm230rqx/E_LUMBER1.WAV a4buxao1lfo5txs/E_MAGETOWER1.WAV mgcz1j57ijivnrx/E_MAGETOWER2.WAV mlqr06rsg0ebg5c/E_MAGETOWER3.WAV jcut9rj4pedruuf/E_MARKET1.WAV m7rpubt227a2mqm/E_SHIPYARD1.WAV dtlikm0f72bqts6/E_STABLES1.WAV 189t8l14j3gfbcd/E_STORAGE1.WAV 6u92t20jjl2ibax/E_OUTPOST1.WAV o6psq5jg611te7h/E_STORAGE2.WAV jpnp0pwsjfajpqh/E_TAVERN1.WAV omdobwnv6ijrdk6/E_WARACADEMY1.WAV xfph6w0wl72iy14/E_WORKSHOP1.WAV m9nzrabgjly054c/EVILCASTLE.WAV o1vdoiexa6q41kd/GATE1.WAV 0i8okhmc24fie1i/GATE2.WAV gcic4rgv7th76g5/GATE3.WAV 1gcczjnk6800a0w/GATE4.WAV s35f76gtwm27r2t/GATE5.WAV jkkktkeqcinw0qk/GATE6.WAV 0qsz059kx5x0fna/GATEWAY.WAV dx4ykguy0c2gkec/HOUSE1.WAV 0bu3c206awygol8/HOUSE2.WAV ixuujwh5i34jqyn/HOUSE3.WAV gtsdx7aq1qo1af9/HOUSE4.WAV y89q2pti77rnl62/HOUSE5.WAV slzdb82f2pq9efh/MERCHANT.WAV hxb9ppcht4b1agh/MINE1.WAV kmvph19wybjvtk3/MONASTERY1.WAV trjbjumhpdq2r6c/MONASTERY2.WAV xdzl5qyez51vp0i/R_CATHEDRAL1.WAV 0jfe5axwda2zy9m/R_CHURCH1.WAV jp0ya01e6lovbpv/SHAOLIN2.WAV sa97rwaqc4bczzg/SHAOLIN.WAV ba9yor9562k8rmk/CHOP%201.WAV 0yq403uktwmaskq/CHOP%202.WAV oumccxj3ppx74lb/CHOP%203.WAV zjlmh6oyt9z80vn/CHOP%204.WAV 8q3x45ooavhgdxf/CHOP%205.WAV tyyuf0ai2b7td9d/CHOP%206.WAV mxk7ilq612mco8y/CHOP%207.WAV vi1nql8csgxue0d/CHOP%208.WAV ptkzwv8er5r250q/CHOP%209.WAV e47rp6twlz7cvor/CHOP%2010.WAV swpbug0t56ool1r/CHOP%2011.WAV 2ddruqf84gi974h/DIG%201.WAV mdv1kf8bb7e6bwj/DIG%202.WAV u7h8iw95x8ufogy/DIG%203.WAV myb354s27trhsgb/MINE%201.WAV 3jca7grtu2uphde/MINE%202.WAV 0sgl0kc77mryj1j/MINE%203.WAV ry9mlisv1lqqp9d/HIT%201.WAV 2ufyfcq4wu9bk1i/HIT%202.WAV cqzlr7gy6mj0k66/HIT%203.WAV i86tqxj1sz91cru/HIT%204.WAV vf604r6t01qe6zd/HIT%205.WAV mnslicm4wy9wdj0/HIT%206.WAV p1ta2wlhfse37db/HIT%207.WAV emwp2hib6msgj22/GHOST1.WAV lrsl9rbxku5cjg7/GHOST2.WAV txbl2bb91s38dqx/GOLEM1.WAV pcfkaldpd7hfrjp/GOLEM2.WAV ivfai5ayu6q99yx/H%20SWORD%201.WAV gedtsneew008x4h/H%20SWORD%202.WAV 57xjkhtc93001et/H%20SWORD%203.WAV ni97b3dbi91yr8b/H%20SWORD%204.WAV 0ls1kz4but9zl51/H%20SWORD%205.WAV ks9mme9djnvdyi5/H%20SWORD%206.WAV hlinmaxi6xj6mv2/H%20SWORD%207.WAV hlinmaxi6xj6mv2/H%20SWORD%207.WAV dt4o378w3100sfu/H%20SWORD%208.WAV ks909spplow4fjz/H%20SWORD%209.WAV w2xfv47ffd7sb72/H%20SWORD%2010.WAV ypapwgz03m7utmq/H%20SWORD%2011.WAV zdcr00adm5qc6hs/H%20SWORD%2012.WAV y90qo1djcx5bzxa/HAND1.WAV 56vhwy7iiu9cpzy/HAND2.WAV 6zhms0m94qg4mvt/HAND3.WAV 41wm4r3cpgjaxly/HAND4.WAV tt4q17tzh6i7u1g/MAGE%20ATTACK.WAV ldhx6mr9upxefci/MESSIAH.WAV 07mie3az1eg1xxh/ORC%20SWORD%201.WAV 9v7spriyxf9szgh/ORC%20SWORD%202.WAV gcfojobbzl2drpn/ORC%20SWORD%203.WAV x0wz0zwpye9i5y3/ORC%20SWORD%204.WAV 2300jmtwppvm452/ORC%20SWORD%205.WAV 3yz2rottu8o8ggt/ORC%20SWORD%206.WAV x5s65vpufpj8t06/ORC%20SWORD%20V1.WAV 0nrb17mzbu3lxtc/ORC%20SWORD%20V2.WAV cypkkpihc1w1hcq/ORC%20SWORD%20V3.WAV y8umilh5cud7jih/SHIP%20CANNON%201.WAV 09kjxvpfn9bdprd/SHIP%20CANNON%202.WAV atj8b8w1k24aqfm/SHIP%20CANNON%203.WAV 6ju34h2pw3nhg7s/SHIP%20CANNON%204.WAV l18s2fbq9q6nzpm/SHIP%20CANNON%205.WAV vrgh4puvgdbpwae/SHIP%20CANNON%206.WAV tmbpku710qnx85q/SHIP%20CANNON%207.WAV 2nomenens1x41lf/SIEGE.WAV 8t9zd51oee3n6vw/SWORD%201.WAV gmwu6lxjaf4mxvv/SWORD%202.WAV tfjzh0u37b60xfc/SWORD%203.WAV s0w71lijsebscys/SWORD%204.WAV 63xcxvtf6fz4nmv/SWORD%205.WAV qpqihts3djiavqd/SWORD%206.WAV zw2cqwnqq5bo3aw/SWORD%207.WAV ub1hntg5qh5h58k/SWORD%208.WAV r4viyma73vblsf5/SWORD%209.WAV 8lxp86hri1yejyt/SWORD%2010.WAV r63199ryslobulc/SWORD%2011.WAV ph48z41qbgbaina/SWORD%2012.WAV o87veypm8qensdd/SWORD%2013.WAV fwapbo29d97mer1/SWORD%2014.WAV tyzv9eybfmt378i/SWORD%2015.WAV 0164fmqamf7yr9s/SWORD%2016.WAV c9renf4qsr56ab4/V%20SWORD%201.WAV gge4f1nb5o7m9qd/V%20SWORD%202.WAV wo0f0ul88unnh01/V%20SWORD%203.WAV q48z5txon4bv76v/V%20SWORD%204.WAV kibmb5mtp1oasan/V%20SWORD%205.WAV 360bl44ii251dus/V%20SWORD%206.WAV oya931j5cn584vn/V%20SWORD%207.WAV rgh3xwlvihecsur/ADRAGON2.WAV jafi9t4hdx4gjnu/ADRAGON3.WAV p7yau58i9x9tznf/ARROW%201.WAV 16jf0mu2c4902ad/ARROW%202.WAV 3gf1vmhszlzsvp6/ARROW%203.WAV hastp290kjpatul/ARROW%204.WAV rzf63kcptscqqb6/ARROW%205.WAV ueysrsca11dznn1/ARROW%206.WAV 2l7ncb4kro91hjp/ARROW%20V1.WAV 6z1zfcuve202wlt/ARROW%20V2.WAV 4al06dvukghp9p8/ARROW%20V3.WAV y3cj0obmsklz7kb/ARROW%20V4.WAV zopzovz1zdos9qn/BEAR1.WAV glbc40fzxrz7x4u/BEAR2.WAV mq7830e9lsw539i/BEAR3.WAV s5h4p53936jqf0m/BEAR4.WAV at4kj0gz88632rt/BEAR5.WAV uq2u4sgg8g6tmou/MWORKSHOP.WAV 09hjcqjlhkgwjsi/DESTROY%20BUILDING.WAV rxan7ebabmxn77z/DESTROY%20MINE.WAV pcwbjrjklna7q57/LIGHTING2.WAV uv2jv59kstujpap/LIGHTING.WAV 6omy17asgyyvcdg/METEOR.WAV r193yz5l7k7yb2i/SMALL%20EXPLOSION.WAV os6jelw7rx49obm/WATER%20BLOP.WAV tjdz2vmlil8c8ud/SPY%20KILL%201.WAV z9tqra8z2pj8fto/SPY%20KILL%203.WAV l85d5424o8s1tq3/SPY%20KILL%202.WAV 97k844atrp03l71/PRIEST%20ATTACK.WAV 2rs81eunjj79t8m/LIGHTNING.WAV i16vdcztiiyd9pl/INVISIBLE.WAV 01a581w494e6nc3/HEAL.WAV v0f62hdvhy2vhiw/FREEZE.WAV e9xkwqnmq1h3xii/FLAME%20BALL.WAV yn1958raqi2el4a/CURSE.WAV 455t0hvitbn4nns/CRUSADE.WAV 1wl7qmtar3y1j2v/CONFUSION.WAV fz21lqeozbq043o/BLESS.WAV xyq2n7ixn80pyn5/WHIRLPOOL.WAV 1t99pip34fvthkq/TURN%20TO%20STONE.WAV jdclsge6rjo7vgo/TEACH.WAV xt7pqtetzsvtgai/SUMMON10.WAV yxcdbheu9s6sqbp/SUMMON9.WAV oum26s9h0mkg6ya/SUMMON8.WAV 46cvrb8px83r1ze/SUMMON7.WAV of68oo8ne7cgdtw/SUMMON6.WAV 3awiprcaujqvohu/SUMMON5.WAV 5kq2b6q3d8ncpww/SUMMON4.WAV avx69olt3m6rrnr/SUMMON3.WAV m08n1qafeiyqe05/SUMMON2.WAV ui2kvbd47bfmx2b/SUMMON1.WAV k8qekk7sutmpcot/REVEAL.WAV 0q9fghfa9qhq5qw/RESSURECT.WAV cb1pq0ssnmj4jic/COWDIE1.WAV f7wgvizjaklyf7n/COWDIE2.WAV cb1pq0ssnmj4jic/COWDIE1.WAV y5zib4fpfywsurg/COWDIE3.WAV oy9j73ss27gix5z/COWDIE4.WAV 1eyn0em70qu0f2i/DIE%201.WAV 27kh2wyo2o9znoz/DIE%202.WAV u572ytnhxy4km3h/DIE%203.WAV 182gaz77ml2mei7/DIE%204.WAV wpvdhtxbe6yy29z/DIE%205.WAV un94l6ebn0l9y2p/DIE%206.WAV 3k2ph5z9vm6ytvz/DIE%207.WAV hjnvqvyet103hf7/DIE%208.WAV umjfyhfxku3dwvp/DIE%209.WAV x1evcyyuhwy2vd3/DIE%2010.WAV xzk59hp6c4wdk3t/DRAGON%20DIE%201.WAV ar7eck4ow8r5w3s/DRAGON%20DIE%202.WAV emwp2hib6msgj22/GHOST1.WAV lrsl9rbxku5cjg7/GHOST2.WAV 6at0jqhx4dza704/GOLEM.WAV h5ydq4j2zdpkiu8/H%20DIE%201.WAV 1bp2u30m504f314/H%20DIE%202.WAV r5kdxiuj8chfl55/H%20DIE%203.WAV 0gubmigjng965ss/H%20DIE%204.WAV 4xzstnrfwevpx21/H%20DIE%205.WAV pnrvg1i5b0jf50i/H%20DIE%206.WAV wkzig2jil3z2hgi/H%20DIE%207.WAV ue13nwsyc6t5ox9/H%20DIE%208.WAV dxk8rptrddombo8/H%20DIE%209.WAV tsdk3uma1x5rz2v/H%20DIE%2010.WAV i3x6klg1g1tx9xx/MAGE.WAV t7c9h3ntknga8i7/ORC%20DIE%201.WAV zwf40uvu5rdu1wy/ORC%20DIE%202.WAV p9gga0rk3ftkkdf/SHIP%20SINK.WAV 5ihoed06p5cm26r/SIEGE%20DIE%201.WAV tahsd6hynfrv1qg/SIEGE%20DIE%202.WAV xboh1sh4rbvx88r/SIEGE%20DIE%203.WAV 4chclvk26ech3mz/SIEGE%20DIE%204.WAV w401vbbvvj99msr/SKELETON%20DIE%201.WAV 0ff119o39785ttm/SKELETON%20DIE%202.WAV 6lxfa75vtxfl2bb/SKELETON%20DIE%203.WAV f3aokr2ngvqpfit/SKELETON%20DIE%204.WAV omfzz21cazinkkm/MESSIAH_ATTACK.WAV 1w2vexiw5aqtrw4/C%20DIE%201.WAV h32280ztxrrz5aa/C%20DIE%202.WAV rq5rgbwaynrdtfc/C%20DIE%203.WAV usywc7awecnolh0/C%20DIE%204.WAV x33opiu95eb78ie/C%20DIE%205.WAV 4lo6hly2n52aq5b/CAMELDIE1.WAV gwsglwtm1fg2eqf/CAMELDIE2.WAV u3mxrmlb10sje2u/CAMELDIE3.WAV nw0ipg198lvq519/BAT%20ATTACK.WAV hukqtscgut9xic7/BAT%20CMD.WAV 77915sxy83vzump/BAT%20DIE.WAV".split(" ");
(function(){for(var a=0,b=wh.length;a<b;a++){var e=wh[a];Xd[e.split("/")[1].split(".")[0].toLowerCase()]=e}})();var md="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206 arrow%20v1 arrow%20v2 arrow%20v3 arrow%20v4".split(" "),Nf="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206".split(" "),oc="sword%201 sword%202 sword%203 sword%204 sword%205 sword%206 sword%207 sword%208 sword%209 sword%2010 sword%2011 sword%2012 sword%2013 sword%2014 sword%2015 sword%2016 v%20sword%201 v%20sword%202 v%20sword%203 v%20sword%204 v%20sword%205 v%20sword%206 v%20sword%207".split(" "),
Of=["siege"],xh=["hand1","hand2","hand3","hand4"],Yd="h%20sword%201 h%20sword%202 h%20sword%203 h%20sword%204 h%20sword%205 h%20sword%206 h%20sword%207 h%20sword%208 h%20sword%209 h%20sword%2010 h%20sword%2011 h%20sword%2012".split(" "),Nj=["ork%20sword%20v1","ork%20sword%20v2","ork%20sword%20v3"],Zd="ship%20cannon%201 ship%20cannon%202 ship%20cannon%203 ship%20cannon%204 ship%20cannon%205 ship%20cannon%206 ship%20cannon%207".split(" "),Oj=["ghost%201","ghost%202"],Pj=["mage%20attack"],N=["destroy%20building"],
Pf=["siege%20die%201","siege%20die%202","siege%20die%203","siege%20die%204"],$d="h%20die%201 h%20die%202 h%20die%203 h%20die%204 h%20die%205 h%20die%206 h%20die%207 h%20die%208 h%20die%209 h%20die%2010".split(" "),lb="die%201 die%202 die%203 die%204 die%205 die%206 die%207 die%208 die%209 die%2010".split(" "),yh=["e_barrack1"],Mj="https://dl.dropboxusercontent.com/s/";window.AudioContext=window.AudioContext||window.webkitAudioContext;var pc=new AudioContext;var ae=pc.createGain();var be=pc.createGain();
var Qj=new vh(pc,void 0,uh);ae.gain.value=parseInt(document.getElementById("musicRange").value)/100;be.gain.value=parseInt(document.getElementById("soundRange").value)/100;var Ga=function(){if(!u.editor){Ga.id++;localStorage.setItem("favMusic",musicSelect.mversion.value);var a=Ga.list[musicSelect.mversion.value];a&&xa(a[~~(a.length*Math.random())],0,0,void 0,1,0,Ga.id)}};document.getElementById("musicRange").oninput=function(){ae.gain.value=parseInt(document.getElementById("musicRange").value)/100};
document.getElementById("soundRange").oninput=function(){be.gain.value=parseInt(document.getElementById("soundRange").value)/100};Ga.reset=function(){Ga.stop();Ga()};Ga.stop=function(){Ga.active&&(Ga.active.stop(),clearTimeout(Ga.intv))};Ga.id=0;Ga.list={originalMusic1:[1,2,3,4,5,6,7,8,9,10,"outro"],originalMusic:"tzar%20soundtrack%201 tzar%20soundtrack%202 tzar%20soundtrack%203 tzar%20soundtrack%204 tzar%20soundtrack%205 tzar%20soundtrack%206 tzar%20soundtrack%207 tzar%20soundtrack%208 tzar%20soundtrack%209 tzar%20soundtrack%2010".split(" "),
sharpRain:"sr1 sr2 sr3 sr4 sr5 sr6 sr7 sr8 sr9 sr10".split(" ")};var xa=function(a,b,e,c,d,h,l){var f=a;if((a=Xd[a])&&"loading"!==a&&!u.canceled){var p=-gb+(window.innerWidth-z.mx)/2,m=-rb+window.innerHeight/2;if(a.duration){if(u.started)if(64<u.now()-a.lastPlayed||!a.lastPlayed)a.lastPlayed=u.now();else return;!d&&"attack"!=f&&h&&600<Date.now()-h||(b?(b=(-p+32*b)/80,e=(-m+32*e)/80,m=ba/8):m=e=b=0,void 0!==c&&c!==z.kingdom||u.mute||(c=pc.createBufferSource(),c.buffer=a,d?(c.connect(ae),ae.connect(pc.destination),
Ga.active=c,Ga.intv=setTimeout(Ga,~~(1E3*a.duration)+1E3)):(a=pc.createPanner(),a.panningModel="HRTF",a.setPosition(b,e,m),c.connect(a),a.connect(be),be.connect(pc.destination)),c.start(0)))}else Xd[f]="loading",d={x:b,y:e,k:c,music:d,date:Date.now(),mid:l},Qj.loadBuffer(a,d)}}}else Ub(A.audioproblem);var nd=function(a,b,e,c){a.img===c.url&&(xa(b+~~(Math.random()*e+1),a.x32,a.y32),setTimeout(nd,Ta(c),a,b,e,c))};(function(){for(var a=document.getElementById("musicSelect").getElementsByTagName("input"),
b=0,e=a.length;b<e;b++)a[b].onchange=Ga.reset})();var Rj=function(a){for(var b=[],f=0,c=[a.icons],d=0,h=c.length;d<h;d++)for(var l=c[d],t=0,p=l.length;t<p;t++)if(l[t]){var m=l[t];m.doneBy||(m.doneBy=[]);m.doneBy.put(a);b[f++]=m;m.xtra&&(c.put(m.xtra),h++)}a.habilities=b},Sj=function(a,b){return b.balanceTotal-a.balanceTotal},Qf=function(a,b){return b.priority-a.priority},Tj=function(a,b){return a-b},ce=function(a,b){if(!a.url.attack||a.attackOnly&&!a.attackOnly[b.type])return 0;var f=25*~~(Ta(a.url.attack)/
25);a=a.attack*((Rc[a.type][b.type]||0)+1);a-=b.defence;1>a&&(a=1);return~~(b.health/a)*f},tb=function(a){this.kingdom=a.k;this.aggressive=this.perfection=1;tb.arr.put(this)};tb.prototype.valorateLost=function(a){this.script.put({order:a.nu,obj:a,priority:1})};var Rf=function(a,b,e,c,d){var f=e.obj.cost;c[0]+=f[0];c[1]+=f[1];c[2]+=f[2];c[3]+=f[3];a[a.length]={order:e,priority:b.priority,name:e.obj.name,obj:e.obj,pTime:b.obj.time,required:1,doner:d};a.changed=!0},Sf=function(a,b,e,c,d){var f=[a],l=
[],t={},p=d.target;l.put(a);for(var m=0;m<f.length;m++){var g=f[m];g.availables&&(g.availables=void 0);if((a=g.order)&&!t[g.order.id]&&(t[g.order.id]=1,!e[a.id])){var k=a.requireObj;if(k)for(var r=0,V=k.length;r<V;r++)if(a=k[r],a.tech)b[a.nu.id]||e[a.nu.id]||Rf(f,g,a.nu,p);else{var u=c[a.type];u.length||Rf(f,g,a.nu,p)}if(k=a.doneBy)for(r=0,V=k.length;r<V;r++)a=k[r],u=c[a.type],u.length||a.race!=d.racestr||Rf(f,g,a.nu,p,1);m&&!g.doner&&l.put(g)}}return l},Tf={food:2,wood:1,gold:0,stone:3},od=function(a,
b){a=a.order;var f=od.tech;a.obj.build&&(f=od.build);return f(a,b)};od.tech=function(a,b){a=a.doneBy;for(var f=0,c=a.length;f<c;f++)for(var d=b[a[f].type],h=0,l=d.length;h<l;h++)if(d[h].free)return d[h].free=0,[d[h]];return!1};od.build=function(a,b){a=a.doneBy;for(var f=0,c=a.length;f<c;f++)for(var d=b[a[f].type],h=0,l=d.length;h<l;h++)if(d[h].free)return d[h].free=0,[d[h]];return!1};var dc=function(a,b){if(a){var f=a.order,c=f.obj,d=dc.unit;c.tech?d=dc.tech:c.build&&(d=dc.build);return d(f,b,a)}};
dc.build=function(a,b){for(var f=[],c=a.doneBy,d=eb[b.k],h=0,l=c.length;h<l;h++)for(var t=d[c[h].type],p=0,m=t.length;p<m;p++){var g=y[t[p]];if(!g.func&&!g.in){f.put(g.id);break}}if(!f.length)return!1;c=x;g=a.obj;a=g.space;d=g.validator.check;t=b.origin[0];p=b.origin[1];m=p-1;var k=t-1,r=t-40,V=p-40,u=Infinity,v=-1;l=6400;for(h=0;h<l;h++){var E=h%80+r,w=~~(h/80)+V,z=(t-E)*(t-E)+(p-w)*(p-w);1600>z&&z<u&&d(E,w,a,m,k,900>z,b.k)&&(u=z,v=E+w*c)}if(0>v)return!1;ca(Sc,[v,g.type],f);return!0};dc.tech=function(a,
b){var f=a.doneBy;b=eb[b.k];for(var c=[],d=0,h=f.length;d<h;d++)for(var l=b[f[d].type],t=0,p=l.length;t<p;t++){var g=y[l[t]];g.working||g.techStart||!g.built||c.put(g.id)}if(!c.length)return!1;ca(Uf,[a.obj.id,a.id],c[0]);return!0};dc.unit=function(a,b,e){e=a.doneBy;b=eb[b.k];for(var f=[],d=0,h=e.length;d<h;d++)for(var l=b[e[d].type],t=0,p=l.length;t<p;t++){var g=y[l[t]];g.working||g.techStart||!g.built||f.put(g.id)}if(!f.length)return!1;ca(de,[a.obj.type,1,0],f[0]);return!0};tb.prototype.leaveMeAloneIKnowWhatToDo=
function(){performance.now();var a=K[this.kingdom],b=a.resources,e=eb[this.kingdom],c=x,d=a.origin[0],h=a.origin[1],l=h-1,t=d-1,p=d-40,g=h-40;M(p,g);for(var k=0,q=6400,r=0;r<q;r++){var V=r%80+p,v=~~(r/80)+g;1600>(d-V)*(d-V)+(h-v)*(h-v)&&(!(V>=t&&V<=t+2)||v>=l&&v<=l+2)&&0===R[V+v*c]&&qa(V,v)&&k++}var z=[];performance.now();for(var E=0,B=0,na=w.length;B<na;B++){var O=w[B];if(!O.build&&!O.item&&!O.boat&&O.url.attack&&O.race==a.racestr&&8!=O.type){z.put(O);O.balanceSum=0;O.bestBalance=-1;O.balanceDefence=
{};for(var A=Infinity,D=O.attDist,C=0;C<na;C++){var H=w[C];if(!H.build&&!H.item&&!H.boat&&H.race==a.racestr&&H.url.attack&&8!=H.type&&(E=ce(H,O))){var J=ce(O,H);J&&(E-=J,E+=2E3*D,E<A&&(A=E,O.bestBalance=H),O.balanceSum+=E)}}}O.balanceTotal=O.balanceSum}z.sort(Sj);O=z[0];for(var N=1E3,I={},ub=[],T=0,L=N;!I[O.type];)I[O.type]=1,ub[T++]=O,ub[T++]=N,H=O.bestBalance,N=~~(N*ce(H,O)/ce(O,H)+.5),L+=N,O=H;ub.nu=L-N;for(var Y=a.target,U=F,G=U.length,Q=[],ba=0;ba<G;ba++){var S=U[ba],ca;if(!(ca=!S.type||S.upgrade||
S.type==P||void 0!==Tf[S.value]&&a.resources[S.value]>=Y[S.value])){a:{for(var aa=S.nu.doneBy,W=0,da=aa.length;W<da;W++)if(aa[W].race==a.racestr){var fa=!0;break a}fa=!1}ca=!fa}ca||Q.put({order:S.nu,obj:S,original:1,priority:1E-10})}var X=[];r=0;q=ub.length;for(var ja=ub.nu;r<q;r+=2){var ka=~~(.5+ub[r+1]/ja*250)-e[ub[r].type].length,Z=ub[r];Z=Z.nu;for(var ha=0;ha<ka;ha++)priority=1-ha/ka,Q.put({order:Z,priority:priority,obj:Z.obj,original:1})}var ea=0,pa=0,la=a.target,ma={};pa++;la[0]=0;la[1]=0;la[2]=
0;la[3]=0;r=ea=X.length=0;for(q=Q.length;r<q;r++){var xa=Q[r].priority,wa=Sf(Q[r],a.technology.actived,a.technology.hidden,e,a);ha=0;for(var oa=wa.length;ha<oa;ha++){Z=wa[ha];Z.original||(Z.priority=xa);var sa=1;void 0!==Z.priority&&(sa=Z.priority);var ta=Z.obj;ta.increase&&void 0!==Tf[ta.value]&&(sa=ta.increase*sa/b[Tf[ta.value]]);sa/=ta.time;Z.priority=sa;if(!(0>=Z.priority)){var ya=Z.order.id;!ma[ya]||Z.original?(ma[ya]=ea,X[ea++]=Z):X[ma[ya]].priority+=Z.priority}}}var za=!1;X.sort(Qf);var Aa=
{},Ba={},va={},ra=[],Ka=w.length;for(r=0;r<Ka;va[r++]=0);for(r=0;r<X.length;r++){var ia=X[r];Z=ia.order;var Ha=ia.obj;if(ia.original||ia.required)ia.obj.tech||va[ia.obj.type]++,ra.put(ia);var Ia=Z.doneBy,Ga=Ha.time;ha=0;for(q=Ia.length;1>ha;ha++){var ua=Ia[ha],Na=ua.time;if(Ha){for(var Oa=ua,La=e[ua.type],Ma=tb.process,Ua=Ga,Wa=La.length,Ea=!1,Pa=Infinity,Qa=0;Qa<Wa;Qa++){var Ja=y[La[Qa]],Ca=0;Ja.build&&(Ja.working||Ja.techStart||!Ja.built)&&(Ja.built?(Ca=(Ja.c-u.cycle)*ec.speed,Ca/=1E3):(Ca=Ja.time*
(Ja.maxHealth-Ja.health)/Ja.maxHealth,Ja.workers&&Ja.workers.length&&(Ca/=Ja.workers.length)));Ja.build||!Ja.func&&!Ja.in||(Ca=Infinity);Ja.nato!=Ma?(Ja.nato=Ma,Ja.natoTime=0):Ca+=Ja.natoTime;Ca<Pa&&(Pa=Ca,Ea=Ja)}Ea&&Pa<=Oa.time?(Ea.natoTime+=Ua,za=Ea):za=!1}if(!za){Aa[ua.type]||(Aa[ua.type]=[],Ba[ua.type]=[]);var Fa=Aa[ua.type],Ta=Ba[ua.type];va[ua.type]||(va[ua.type]=0);var bb=!1,ib=0;for(oa=Fa.length+1;ib<oa;ib++){if(void 0==Fa[ib]){var Ya={order:ua.nu,priority:0,obj:ua};X.put(Ya);ra.put(Ya);Fa[ib]=
0;Ta[ib]=Ya;va[ua.type]++;bb=!0}if(Fa[ib]+Ga<=Na||bb){Fa[ib]+=Ga;Ta[ib].priority+=ia.priority;break}}}}}ra.sort(Qf);var Sa=0;r=0;for(q=ra.length;r<q;r++)if(ia=ra[r].obj,ia.build){var hb=ia.space[ia.space.length-1]+2;Sa+=hb*((ia.space.length-1)/hb+2)}M(Sa,k);if(Sa>k){var pb=k/Sa*.7;r=0;for(q=w.length;r<q;r++)w[r].build&&(ia=va[r])&&((ia=~~(ia*pb))||(ia=1),va[r]=ia)}r=0;for(q=ra.length;r<q;r++)ia=ra[r].obj,ia.build&&(va[ia.type]?va[ia.type]--:ra[r]=0);for(var jb=0;1>jb;jb++){var Va=[],kb={},db={},Za=
{},lb={},ab=[[]],gb=[0];r=0;for(q=e.length;r<q;r++){lb[r]=0;ia=e[r];var rb=[];Za[r]=rb;ib=0;for(oa=ia.length;ib<oa;ib++)rb[ib]={free:1,type:r}}for(ea=0;ea<gb.length;ea++){var qb=gb[ea],sb=ab[qb];r=0;for(q=sb.length;r<q;r++){var $a=sb[r],mb=$a.list;ib=0;for(oa=mb.length;ib<oa;ib++)ia=mb[ib],ia.used||(lb[ia.type]++,ia.used=1,Va.put(ia.action)),ia.free=1;$a.obj.tech?kb[$a.obj.nu.id]=1:Za[$a.obj.type].put({free:1,type:$a.obj.type,action:$a.action})}r=0;for(q=ra.length;r<q;r++)if((ia=ra[r])&&1===Sf(ia,
kb,db,Za,a).length&&(mb=od(ia,Za))){var nb=ia.obj.time+qb;ab[nb]||(ab[nb]=[],gb.put(nb));if(ia.obj.tech){if(db[ia.order.id])continue;db[ia.order.id]=1}(ia.original||ia.required)&&Va.put(ia);ab[nb].put({list:mb,obj:ia.obj,action:ia});ra[r]=void 0}gb.sort(Tj)}M(qb);for(var cb=Va,ob={},Xa=0;Xa<cb.length;Xa++)cb[Xa]&&!cb[Xa].obj.tech&&(ob[cb[Xa].obj.name]||(ob[cb[Xa].obj.name]=0),ob[cb[Xa].obj.name]++);M(ob);ra=Va;ra.sort(Qf)}this.script=ra};var Vf=function(){for(var a=0,b=tb.arr,e=b.length;a<e;b[a++].maintenance());
va({func:Vf},tb.time,1);tb.process++};tb.prototype.maintenance=function(){var a=this.script,b=K[this.kingdom],e=b.technology,c=e.actived,d=e.hidden,h=eb[b.k];e=x;var l={};if(b.values.pop+b.unitLoading>b.values.popMax&&b.values.popMax<=b.values.popLimit){for(var t=ab[b.race].house.nu,p=1,g=0,k=pd.length;g<k;g++)p+=h[pd[g].type].length*pd[g].population;p+b.unitLoading>b.values.popMax&&p<=b.values.popLimit&&dc({order:t,priority:1,obj:t.obj},b)}g=0;for(k=a.length;g<k;g++)(t=a[g])&&!l[t.order.id]&&1===
Sf(t,c,d,h,b).length&&(dc(t,b)?a[g]=0:l[t.order.id]=1);a=!1;l=Infinity;var q=b.diplomacy;d=b.origin[0];h=b.origin[1];c=eb[b.k];g=1;for(k=K.length-1;g<k;g++)if(q[g]&&!K[g].death){t=K[g];p=t.origin[0]-d;var r=t.origin[1]-h;b=p*p+r*r;b<l&&(l=b,a=t)}if(a){b=[];g=p=0;for(k=c.length;g<k;g++)for(r=c[g],l=0,q=r.length;l<q;l++)t=y[r[l]],t.func==Qd.url&&(b[p++]=t.id);if(60<b.length){c=a.origin[0];q=a.origin[1];t=[40,0,-40,0,0,40,0,-40];l=Infinity;g=0;for(k=t.length;g<k;g+=2)if(p=t[g],r=t[g+1],p+=d+10*Math.sign(p),
r+=h+10*Math.sign(r),(p-c)*(p-c)+(q-r)*(q-r)<l&&qa(p,r)){l=(p-c)*(p-c)+(q-r)*(q-r);var V=p+r*e}k=V%e;d=~~(V/e);h=-1;p=Infinity;c=eb[a.k];g=0;for(length=c.length;g<length;g++)for(a=c[g],l=0,r=a.length;l<r;l++)t=y[a[l]],t.build&&t.built&&(q=(t.x32-k)*(t.x32-k)+(t.y32-d)*(t.y32-d),q<p&&(p=q,h=t.x32+t.y32*e));-1<h&&ca(zh,[V,h],b)}}};var zh=function(a,b){var f=x,c=a[0];a=a[1];var d=a%f;f=~~(a/f);i=0;for(length=b.length;i<length;i++){var h=y[b[i]];6400<(h.x32-d)*(h.x32-d)+(h.y32-f)*(h.y32-f)?ea(-c,h,qd,
h.url.move):ea(-a,h,qd,h.url.move)}va({func:Ah,data:{list:b,xy:-a}},3E4,1)},Ah=function(a){var b=a.list;a=a.xy;for(var f=0,c=b.length;f<c;f++){var d=y[b[f]];d.death||ea(a,d,qd,d.url.move)}},Uj=function(a,b,e,c){var f=x,h;for(h=2;60>=h;h+=2){a--;b--;for(var l=0;l<=h;){var t=R[a+l+f*b];if(2<t&&t!=c&&y[t].type==e)return t;t=R[a+l+f*(b+h)];if(2<t&&t!=c&&y[t].type==e)return t;l++}for(l=0;l<h-1;){l++;t=R[a+f*(b+l)];if(2<t&&t!=c&&y[t].type==e)return t;t=R[a+h+f*(b+l)];if(2<t&&t!=c&&y[t].type==e)return t}}return!1},
Qd=function(a){a=y[a];performance.now();var b=Wf(a.id);if(b)return qc(b,[a.id],1);mb(a,1E3)},Wf=function(a){a=y[a];if(!a.freezed&&!a.invisible){for(var b=a.x32,f=a.y32,c=K[a.kingdom].diplomacy,d=a.sight,h=x,l=2*d+1,t,p=!!a.confused,g=Infinity,k=!1,q=0,r=l*l;q<r;q++){var V=q%l-d,u=~~(q/l)-d,v=Math.sqrt(V*V+u*u);if(~~v<=d){V+=b;u+=f;for(var E=0;3>E;E++){t=Ua[E][V+h*u];var w=y[t];if((w&&w.kingdom&&c[w.kingdom]||p)&&!(w.death||w.invisible||a.attackOnly&&!a.attackOnly[w.type]||t==a.id||w.item)){var z=
Rc[a.type][w.type];z||(z=0);w=v*v+.05*w.health-(z+1)*a.attack;w<g&&(k=t,g=w)}}}}return k}},Vj=function(a){a.setupINTV(Bh,a.id,1E3)},Bh=function(a){a=y[a];var b=a.free;b||(b=Ch);var f=x,c=a.x32,d=a.y32,h=[];h.length=K.length;for(var l=h.length,t=0;t<l;h[t++]=0);t=0;for(var g=b.length;t<g;t+=2){var k=b[t]+c,n=b[t+1]+d;qa(k,n)&&(k=y[R[k+n*f]],k.nocapture||k.build||h[k.kingdom]++)}f=b=0;for(t=1;t<l;t++)h[t]>b&&(f=t,b=h[t]);b&&a.kingdom!=f&&a.changeKingdom(f);mb(a,1E3)},ee,Wj=[1,1],Dh=function(){return 25*
(Date.now()-u.loadDate+u.pausedTime+u.deltaTime)/ec.speed},nb=function(a){if(!(a&&u.online||nb.bySystem&&a))if(0===u.paused){u.paused=1;void 0!=ee&&clearInterval(ee);var b=u.now();u.pausedTime+=Date.now();a?Ub("",A.paused,1):nb.bySystem=1;u.now=function(){return b}}else u.pausedTime-=Date.now(),u.paused=0,nb.bySystem=0,a&&(document.getElementById("alert").style.display="none"),ee=setInterval(ec,ec.speed),u.now=Dh};nb.bySystem=0;var xb=function(a,b){var f=!1;if(1>a){a*=-1;var c=~~(a/la),d=a%la}else f=
a;a=0;for(var h=b.length;a<h;a++){var l=y[b[a]];l.build||l.cow&&l.workers.length||f==l.id||(l.action=null,l.distance=0,l.mv&&null!=l.xf?f?(l.xf=f,l.yf=!0):(l.xf=d,l.yf=c):l.x32==d&&l.y32==c?l.stay():(l.dix=(d-l.x32)/Math.abs(d-l.x32),l.diy=(c-l.y32)/Math.abs(c-l.y32),f?(l.xf=f,l.yf=!0):(l.xf=d,l.yf=c),l.mv=!0,l.setupINTV(fe,l.id,0),Xf(l),l.action=null))}},Xf=function(a){a.stock&&0!==a.stock[0]?(a.mimg=a.url[a.stock[4].url],a.stock[3]===rc&&(a.mimg=a.url.milk)):a.mimg=a.url.move};xb.cursor=7;xb.allowPos=
1;var mb=function(a,b,e){b=~~(b/25)+u.cycle;e=sc[b];e||(e=[],sc[b]=e);var f=e.length;a.c=b;e[f]=a.id;a.timestamp=u.now()},sc={},ge=function(a){var b=y[a[0]];if(!b.death){var f=a[1],c=a[2],d=a[3];b.cow&&"milk"==f&&b.workers&&b.workers.length||(b[f]+=K[b.kingdom].values[c],c=b[f+"Max"],b[f]>c&&2!==b.blocked&&(b[f]=c));"mana"==f&&(c=b.manaTask)&&c[2]<=b[f]&&(M(c),ea(c[1],b,tc[c[0]],b.url.move),b.manaTask=void 0,b.blockedAction(1));aa(b.id,1);va({func:ge,data:a},d,1)}},va=function(a,b,e){a.func.url||
M(a.func);a.func=a.func.url;e&&(b=~~(b/25)+u.cycle);e=uc[b];e||(e=[],uc[b]=e);e.put(a)},uc={},fe=function(a){a=y[a];var b=x,f=!1;5===a.distance&&(a.distance=-1);a.waiting&&Xf(a);var c=a.y32,d=a.x32,h=tc[a.action];ObjectsetupPosition(a,32*c);var l=Ua[a.zLevel],t=d+c*b;if(a.id===l[t]){var g=a.size;if(2>g)l[t]=a.radix;else for(var k=g*g,n=-b,q=0;q<k;q++){var r=q%g;0===r&&(n+=b);l[t+r+n]=0}}if(a.stop)return l[t]=a.id,a.stay(),a.stop=void 0,0;if(a.kx||a.ky){var u=a.kx||0,v=a.ky||0;k=!1;if(0!==l[u+d+(v+
c)*b])return a.aspettare()}else{h&&h.rev&&(k=h.rev(a))&&(a.action=k[0],h=tc[a.action],a.xf=k[1],a.yf=!0);if(!0===a.yf){k=a.xf;var w=y[k];if(!w||w.death&&(!h||!h.available))return l[t]=a.id,a.stay();q=!0;n=!1;if(h&&h.available){if(n=h.available(a,w),q=n[2],!1===n)return a.aspettare()}else w.death||(n=Jb(w,a,50,a.radix));a.xf!==k&&(w=y[a.xf]);if(!w||w.death||w.in)return l[t]=a.id,a.stay();if(!q&&(E+z*b===t||h))return a.aspettare();var E=n[0],z=n[1];if(h&&h.distance){var B=h.distance;B=0>B?a.attDist:
K[a.kingdom].values[B];n=Yf(w,d,c);rd(d,c,n%x,~~(n/x),B)&&(f=2)}a==w&&(f=2)}else{E=a.xf;z=a.yf;k=l[E+z*b];if(2<k&&(!h||h&&h.rev)){k=y[k];n=Jb(k,a,50,a.radix);if(!1===n)return l[t]=a.id,a.stay();E=n[0];z=n[1]}h&&h.distance&&(B=h.distance,B=0>B?a.attDist:K[a.kingdom].values[B],rd(d,c,E,z,B)&&(f=2))}k=E+z*b;if(!f){performance.now();a:{u=d;v=c;n=E;q=z;r=a.radix;var O=x,A=u+v*O,F=A,D=n+q*O,C;performance.now();var H=A+bb[~~(8*vc(A%O-n,~~(A/O)-q)+.5)%8];for(C=0;24>C;C++){var J=~~(8*vc(A%O-n,~~(A/O)-q)+.5)%
8;if(A===D)break;var M=l[A+bb[J]];if(M===r||1>=Math.abs(y[M].d-(J+2)%8)&&null!=y[M].xf)A+=bb[J];else if(l[A+bb[J+1]]===r)A+=bb[J+1];else if(M=J-1,-1===M&&(M=7),l[A+bb[M]]===r)A+=bb[M];else{A+=bb[J];break}Zf&&he(A%O,~~(A/O),"stone")}if(l[A]>r){J=[A];M=1;var ub=0,N={};N[A]=2;for(var I,T=Infinity,L=0;void 0!==(I=J[ub++]);){Zf&&he(I%O,~~(I/O),"food");C=I%O-n;var S=~~(I/O)-q;C=C*C+S*S;C<T&&(T=C,L=I);for(C=0;4>C;C++)if(A=I+Eh[C],!N[A]&&l[A]!==r)for(D=0;8>D;D++)if(l[A+bb[D]]===r){J[M++]=A;N[A]=2;break}}I=
L;T=Infinity;for(D=0;8>D;D++)A=I+bb[D],l[A]===r&&(C=A%O-n,S=~~(A/O)-q,C=C*C+S*S,C<T&&(L=A,T=C));ub=0;M=1;J.length=0;J[0]=L;for(N[L]=1;void 0!==(I=J[ub++]);){Zf&&he(I%O,~~(I/O),"gold");A=I+bb[~~(8*vc(I%O-u,~~(I/O)-v)+.5)%8];if(l[A]===r&&!N[A]){if(A==F){u=I;break a}J[M++]=A;N[A]=1}for(C=0;8>C;C++)if(A=I+bb[C],!N[A]&&l[A]===r)for(D=0;8>D;D++)if(2===N[A+bb[D]]){J[M++]=A;N[A]=1;break}}}u=H}v=~~((8*vc(-(u%b)+d,-~~(u/b)+c)+.5)%8);u=Fh[2*v];v=Fh[2*v+1];if(l[d+u+(c+v)*b]!==a.radix||!qa(d+u,c+v)){u=[d+1,c,
d-1,c,d+1,c+1,d+1,c-1,d,c-1,d-1,c+1,d,c+1,d-1,c-1];v=E;n=z;q=x;r=Infinity;for(O=0;O<u.length;O+=2)if(0===l[u[O]+u[O+1]*q]&&qa(u[O],u[O+1])&&r>=(u[O]-v)*(u[O]-v)+(u[O+1]-n)*(u[O+1]-n)){r=(u[O]-v)*(u[O]-v)+(u[O+1]-n)*(u[O+1]-n);var Y=O}n=[u[Y],u[Y+1]];u=n[0]-d;v=n[1]-c;u=0<u?1:0>u?-1:0;v=0<v?1:0>v?-1:0;if(l[d+u+(c+v)*b]!==a.radix){l[t]=a.id;a.stay();return}}}}if(t==k||f)if(l[d+c*b]=a.id,a.x32=d,a.y32=c,h){if(h.distance&&2!==f)return a.aspettare();a.stay(1);w||(w=E+z*b);a.action=void 0;h(w,a,B)}else a.stay();
else{if(0===u&&0===v)return a.aspettare();a.setupDir(u,v);f=a.spd;ObjectsetupIMG(a,a.mimg,-1,a.spd/a.__proto__.spd);a.dix=u*f;a.diy=v*f;c+=v;d+=u;a.x32=d;a.y32=c;a.distance++;mb(a,~~(32E3/f));ObjectsetupPhysics(a,u*f,v*f,0);t=d+c*b;if(2>g)l[t]=a.id;else for(k=g*g,n=-b,q=0;q<k;q++)r=q%g,0===r&&(n+=b),l[t+r+n]=a.id}},ec=function(){var a=u.cycle;u.now();if(u.demo){var b=u.record[a];if(b)for(var e=0;e<b.length;e+=3)ie[b[e]](b[e+1],b[e+2])}if(b=uc[a]){for(e=0;e<b.length;e++){var c=b[e];tc[c.func](c.data)}delete uc[a]}if(b=
sc[a]){for(e=0;e<b.length;e++)c=y[b[e]],c.c===a&&(c.death&&M(c.func),c.c=void 0,tc[c.func](c.funcObj));delete sc[a]}u.cycle++;if(u.online&&0===u.cycle%8)var d=$f();!d&&!u.automatic&&u.now()-(u.cycle-1)*ec.speed>=ec.speed&&ec()};ec.speed=25;var bb,Eh,he=function(a,b,e){e=Object.assign({},Kb[e]);e.x32=a;e.y32=b;e.z32=2;Sa(e);yb.new(e,500)},Zf,Fh=[1,0,1,-1,0,-1,-1,-1,-1,0,-1,1,0,1,1,1],vc=function(a,b){a=.5-Math.atan2(b,a)/(2*Math.PI);1==a&&(a=0);return a},wb=function(a,b,e,c){return[a,b,e,c,a,b,e,c,
a,b,e,c,a,b,e,c]},je=new Float32Array(wb(1,0,0,.75)),Xj=new Float32Array(wb(1,1,1,.5)),Gh=new Float32Array(wb(0,1,0,.75)),Yj=new Float32Array(wb(0,1,0,.9)),Zj=new Float32Array(wb(.3515625,.29296875,.21875,.9)),Hh=new Float32Array(wb(0,1,1,.9)),ag=new Float32Array(wb(1,1,1,.5)),Ih=new Float32Array(wb(.3,.3,.3,.9)),Jh=new Float32Array(wb(.7,.2,.2,.9));Hh.noAlpha=1;Ih.noAlpha=1;Jh.noAlpha=1;var W=function(a){ca(de,[a,4*cb.shift+1,ob],H[0])},de=function(a,b){var f=a[0],c=a[1],d=a[2];a=w[f];b=y[b];var h=
b.icons.indexOf(a.nu);if(!(0>h)){performance.now();if(0==d)for(d=0;d<c;d++){var l=K[b.kingdom],t=l.mod[f].cost||a.cost;if(l.paypal(t))return!1;b.waitlist||(b.waitlist=[]);b.waitlist.push(f,-h-1);b.work||(b.work={});b.work[h]||(b.work[h]=0);b.work[h]++;b.working=1;l.unitLoading++;2==b.waitlist.length&&(t=1E3*a.time,b.setupINTV(sd,b.id,t))}else{if(!b.work)return;var g=b.waitlist;l=K[b.kingdom];for(d=0;d<c;d++){t=l.mod[f].cost||a.cost;l.setupResources(t,-1);t=g.lastIndexOf(f);if(0>t)break;g.splice(t,
2);M(b.work[h]);b.work[h]--;if(0==g.length){b.c=-1;b.working=0;break}l.unitLoading--;0===t&&(t=1E3*w[g[0]].time,b.setupINTV(sd,b.id,t))}}aa(b.id)}},Kh=0,sd=function(a){a=y[a];var b=a.kingdom;b=K[b];var f=b.values.pop>=b.values.popMax?A.houseLimit:A.popLimit;if(b.values.pop>=b.values.popMax||b.values.pop>=b.values.popLimit)return document.getElementById("msgs1").getElementsByTagName("li"),3E4<Date.now()-Kh&&b.k==z.kingdom&&zb(f,0,5),Kh=Date.now(),b.onFreePop.put(a.id);b.unitLoading--;b=a.waitlist[0];
f=w[b];a.work[-a.waitlist[1]-1]--;a.waitlist.splice(0,2);0<a.waitlist.length?a.setupINTV(sd,a.id,1E3*f.time):a.working=0;wc(b,a);aa(a.id)},ua=function(){if(0==ob){var a=y[H[0]];ca(bg,[a.mlistID[pb.nu],!0],a.id)}},Na=function(){if(0==ob){var a=y[H[0]];ca(bg,[a.hlistID[pb.nu],!1],a.id)}},Lh=function(a,b,e){var f=1.6,d=0;1===b&&(e=0,f=3.6,d=620);return[d+~~(f*a[0]*b+.5)+120*e,~~(f*a[1]*b+.5),~~(f*a[2]*b+.5),~~(f*a[3]*b+.5)]},bg=function(a,b){var f=a[0];a=a[1];b=y[b];var c=K[b.kingdom];if(c.values.pop>=
c.values.popMax)return zb(A.popLimit,0,5);if(a)var d=c.values.fameTech;c=4;var h=9*a;h||(h=1);if(a)var l=b.mlist,t=b.mlistID;else l=b.hlist,t=b.hlistID;var g=t.indexOf(f);if(!(0>g)){f=l[g].unit;l.splice(g,1);t.splice(g,1);t=Lh(w[f].cost,h,d);if(K[b.kingdom].paypal(t))return 0;S.active==l&&ka(l);for(t=0;t<h;t++)g=wc(f,b),d?g.level=c:a||(c=16,g.level=c,l=Mh[g.race],g.name=l[g.id%l.length],Nh(g))}},wc=function(a,b,e,c){var f=x,h=b.kingdom;b.rnd||cg(b);var l=-1,t=-1;if(b.point&&!b.disallowPoint){var g=
b.point[0],k=b.point[1];l=Oh(b,g,k,w[a].radix,w[a].rbase())[0]}else l=Oh(b,l,t,w[a].radix,w[a].rbase())[1],l=l[Ph(b,l.length)];t=~~(l/f);a=new fc(a,h,l%f,t,0,!1,c);td(h);e||xa("unitdone",0,0,a.kingdom);if(b.point&&(b=dg(g,k,a),e=b[1],b[0]))b[0](e,[a.id]);return a},ke=0,le=0,Ib,hb,ld,I=function(a){L=function(){};a=w[a];Ib=!1;var b=da;ObjectsetupIMG(b,a.img);b.active=!0;hb=a;ld=!1;document.addEventListener("mousemove",Mf);document.addEventListener("mousedown",Vd)},Vd=function(a){var b=hb.validator,
f=hb.space,c=ta[hb.img];if(0==a.button&&151<a.pageX){c=Lb(a.pageX-z.mx-.5*c[8]/ba,a.pageY-.5*c[9]/ba);var d=~~(.03125*c[1]);c=~~(.03125*c[0]);b(c,d,f,z.kingdom)[1]&&(Ib=!0,da.active=!0,da.x=-9999,da.y=-9999,L=151<a.pageX?0:jb,document.removeEventListener("mousedown",Vd),ca(Sc,[c+x*d,hb.type,ld],H),cb.shift&&(ld?oh(ld):I(hb.type)));L=function(){}}else da.active=!0,da.x=-9999,da.y=-9999,Ib=!0,L=151<a.pageX?0:jb,document.removeEventListener("mousedown",Vd)},Mf=function(a){var b=hb.validator,f=hb.space,
c=ta[hb.img];if(Ib)document.removeEventListener("mousemove",Mf);else{var d=a.pageX,h=a.pageY;if(d!=ke||h!=le)da.active=!0,ke=d,le=h,d=Lb(a.pageX-z.mx-.5*c[8]/ba,a.pageY-.5*c[9]/ba),h=~~(.03125*d[1]),d=~~(.03125*d[0]),a=32*d,c=32*h,(b=!b(d,h,f,Va.k)[1])?b!=gc&&(gc=b,g.bindBuffer(g.ARRAY_BUFFER,Ya),g.bufferSubData(g.ARRAY_BUFFER,16*da.bufferID,je)):b!=gc&&(gc=b,g.bindBuffer(g.ARRAY_BUFFER,Ya),g.bufferSubData(g.ARRAY_BUFFER,16*da.bufferID,Gh)),da.x=a,da.y=c}},Sc=function(a,b){var f=a[0],c=f%la,d=~~(f/
la),h=u.editor?1:y[b[0]].kingdom;f=a[1];var l=w[f].cost,t=K[h];if(!u.editor&&t.paypal(l))return!1;a=new fc(f,h,c,d,0,!u.editor,a[2]);if(!0===a.invalid||u.editor)return!1;a.waitlist=[];if(20===f)a.built=1,c=y[b[0]],ea(a.id,c,xc,c.url.move),L=function(){L=jb};else for(a.health=1,ObjectsetupIMG(a,a.bimg),a=a.id,f=0,d=b.length;f<d;f++)c=y[b[f]],c.buildList?(c.buildList.put(a),c.func!==eg&&(h=me(c.buildList,c.x32,c.y32))&&ea(h,c,yc,c.url.move)):(c.buildList=[a],ea(a,c,yc,c.url.move))},gc=null,gg=function(a){L=
function(){};a=w[a];Ib=!1;var b=da;hb=a;ObjectsetupIMG(b,a.img);document.addEventListener("mousemove",Qh);document.addEventListener("mousedown",fg)},fg=function(a){var b=x,f=ta[hb.img];if(0==a.button&&151<a.pageX){a=Lb(a.pageX-z.mx-.5*f[8]/ba,a.pageY-.5*f[9]/ba);var c=~~(.03125*a[1]);a=~~(.03125*a[0]);g.bindBuffer(g.ARRAY_BUFFER,Ya);g.bufferSubData(g.ARRAY_BUFFER,0,Zj);var d=fa[2];fa[2]=32;fa[5]=32;fa[8]=32;fa[11]=32;da.wall=a+c*b;var h=a;document.addEventListener("mouseup",function p(a){sb.forced=
!1;a=za[3*z.kingdom];var f=za[3*z.kingdom+1],e=za[3*z.kingdom+2];v[0]=a;v[1]=f;v[2]=e;v[3]=.5;v[4]=a;v[5]=f;v[6]=e;v[7]=.5;v[8]=a;v[9]=f;v[10]=e;v[11]=.5;v[12]=a;v[13]=f;v[14]=e;v[15]=.5;g.bindBuffer(g.ARRAY_BUFFER,Ya);g.bufferSubData(g.ARRAY_BUFFER,0,v);fa[2]=d;fa[5]=d;fa[8]=d;fa[11]=d;var t=~~(fa[9]/32),k=~~(fa[10]/32);f=Math.abs(h-t);e=Math.abs(c-k);f&&--f;e&&--e;a=1;t=t<h?t:h;var u=k<c?k:c;k=[t+u*b];for(var x=0;x<f;x++)k[a++]=t+x+u*b+1,k[a++]=t+x+(u+e)*b;for(x=0;x<e;x++)k[a++]=t+(u+x)*b,k[a++]=
t+(u+x+1)*b+f;for(x=1;x<a;x++)f=k[x],Ib=!0,L=function(){L=jb},hc(2),ca(Sc,[f,hb.type],H);da.active=!0;da.x=-9999;da.y=-9999;cb.shift&&gg(hb.type);document.removeEventListener("mouseup",p)});document.removeEventListener("mousedown",fg);Ib=!0}else da.active=!0,da.x=-9999,da.y=-9999,Ib=!0,L=151<a.pageX?0:jb,document.removeEventListener("mousedown",fg)},Qh=function(a){var b=x,f=ta[hb.img];if(Ib)document.removeEventListener("mousemove",Qh);else{var c=a.pageX,d=a.pageY;if(c!=ke||d!=le){var h=!0;ke=c;le=
d;da.active=!0;a=Lb(a.pageX-z.mx-.5*f[8]/ba,a.pageY-.5*f[9]/ba);f=~~(a[1]/32);a=~~(a[0]/32);c=32*a;d=32*f;0==R[a+f*b]&&(h=!1);h?h!=gc&&(gc=h,g.bindBuffer(g.ARRAY_BUFFER,Ya),g.bufferSubData(g.ARRAY_BUFFER,16*da.bufferID,je)):h!=gc&&(gc=h,g.bindBuffer(g.ARRAY_BUFFER,Ya),g.bufferSubData(g.ARRAY_BUFFER,16*da.bufferID,Gh));da.x=c;da.y=d}}},hg=function(a,b){a=0;for(var f=b.length;a<f;a++){var c=y[b[a]];c.xf?c.stop=1:c.stay()}},ne=function(a,b){a=y[b[0]];a.techStart=0;a.c=void 0;if(b=a.techID){var f=K[a.kingdom].technology.hidden;
-1<b&&(f[b]=0);K[a.kingdom].setupResources(F[a.activeTech].cost,-1)}else K[a.kingdom].setupResources(a.lcost,-1)},C=function(a){var b=y[H[0]];if(K[b.kingdom].paypal(F[a].cost))return!1;ca(Uf,[a,pb.lastFunc.id],b.id)},Uf=function(a,b){var f=a[0];a=a[1];var c=F[f],d=y[b];c.upgrade&&(a=-1);d.activeTech=f;d.techID=a;d.setupINTV(c.type,[f,a,b],1E3*c.time);d.techStart=d.c-u.cycle;f=K[y[b].kingdom].technology.hidden;-1<a&&(f[a]=1);aa(b)},P=function(a){var b=a[1],f=y[a[2]];a=F[a[0]];Xb(f,a,b)},ud=function(a){var b=
a[1],f=y[a[2]];a=F[a[0]];var c=w[a.obj],d=K[f.kingdom].mod[c.type];Rh(f);f.img=c.img;f.attack=d.attack||c.attack;f.health=f.health/f.maxHealth*c.health;f.maxHealth=c.health;f.__proto__=c;Sa(f);Xb(f,a,b)},oe=function(a){var b=a[1],f=y[a[2]];a=F[a[0]];if(a.actvintv)for(var c=a.actvintv,d=0,h=c.length;d<h;d++){var l=c[d];K[f.kingdom].technology.disabled[l.id]=0;for(var t=l.builds,g=eb[f.kingdom],k=0,n=t.length;k<n;k++)for(var q=g[t[k]],r=0,u=q.length;r<u;r++)l(y[q[r]])}Xb(f,a,b)},Oa=function(a,b){var f=
a[1];b=y[a[2]];a=F[a[0]];K[b.kingdom].values[a.value]+=a.increase;"popMax"==a.value&&td(b.kingdom);Xb(b,a,f)},Sh=function(a,b){var f=a[1];b=y[a[2]];a=F[a[0]];for(var c=a.group,d=K[b.kingdom].mod,h=0,l=c.length;h<l;h++)for(var t=d[c[h].type],g=0,k=a.values,n=k.length;g<n;g+=2){var q=k[g],r=k[g+1];t[q]||(t[q]=c[h][q]||0);t[q]+=r}Xb(b,a,f)},kb=function(a,b){var f=a[1];b=y[a[2]];a=F[a[0]];for(var c=a.group,d=K[b.kingdom].mod,h=0,l=c.length;h<l;h++){var t=d[c[h].type];t[a.value]||(t[a.value]=c[h][a.value]||
0);t[a.value]+=a.increase}Xb(b,a,f)},pe=function(a,b){var f=a[1];b=y[a[2]];a=F[a[0]];for(var c=K[b.kingdom].mod,d=a.mulp,h=0,l=a.group.length;h<l;h++){var t=a.group[h],g=c[t.type].cost||t.cost;c[t.type].cost=d?[~~(g[0]*d),~~(g[1]*d),~~(g[2]*d),~~(g[3]*d)]:[g[0]-a.decrease[0],g[1]-a.decrease[1],g[2]-a.decrease[2],g[3]-a.decrease[3]]}Xb(b,a,f)},ig=function(a,b){var f=a[1];b=y[a[2]];a=F[a[0]];for(var c=K[b.kingdom].mod,d=0,h=a.decrease,l=h.length;d<l;d+=2){var t=h[d],g=h[d+1],k=c[t.type].cost||t.cost;
c[t.type].cost=[k[0]-g[0],k[1]-g[1],k[2]-g[2],k[3]-g[3]]}Xb(b,a,f)},Xb=function(a,b,e){a.techStart=void 0;a.activeTech=void 0;a.techID=void 0;a.func=void 0;var f=K[a.kingdom].technology,d=f.disabled;f.investigated[e]=1;xa("techdone",0,0,a.kingdom);if(b=b.next){e=!1;f=0;for(var h=b.length;f<h;f++){var l=b[f].id;d[l]--;ka.actv[l]&&(e=!0)}e&&ka(S.active)}aa(a.id)},ak=[[12,62,63,18],[12,62,63,15],[12,62,63,23],[12,62,63,18]],bk={icon:"food",img:"item_meat",url:"meat"},ck={icon:"milk",img:"milk",url:"milk"},
dk={icon:"gold",img:"item_gold",url:"gold"},ek={icon:"stone",img:"item_stone",url:"stone"},Th={icon:"wood",img:"item_tree",url:"tree"},fk={icon:"food",img:"item_food",url:"food"},vd=function(a,b,e,c){a=eb[a];var f=ak[b];b=[];b.length=f.length;for(var h=0,l=f.length;h<l;b[h]=a[f[h++]]);a=Infinity;f=-1;for(h=0;h<b.length;h++){l=b[h];for(var g=l.length,k=0;k<g;k++){var m=y[l[k]],n=m.x32,q=m.y32,r=m.space;m=r[r.length-1];r=(r.length-1)/m;m*=.5;r*=.5;n+=m;q+=r;m=.5*(m+r);n=Math.sqrt((n-e)*(n-e)+(q-c)*
(q-c))-m;a>=n&&(a=n,f=l[k])}}return f},ja,gk=function(a){if("string"==typeof a){for(var b=1,f=0,c=a.length;f<c;f++)b+=b*(a.charCodeAt(f)/65535)*(f+1);a=b+c}var d=4294967295-a,h=4294967295+a;f=0;ja=function(){h+=f;d-=f++;h=36969*(h&65535)+(h>>16)&4294967295;d=18E3*(d&65535)+(d>>16)&4294967295;return((h<<16)+d&4294967295)/4294967295+.5}},Ph=function(a,b){a=a.rnd;var f=a[0],c=a[1],d=a[2];f+=d;c-=d;f=36969*(f&65535)+(f>>16)&4294967295;c=18E3*(c&65535)+(c>>16)&4294967295;a[0]=f;a[1]=c;a[2]++;return~~((((f<<
16)+c&4294967295)/4294967295+.5)*b)},hc=function(a){a!=hk&&(document.body.className="ncursor"+a)},hk=-1,Tc=function(a,b){for(var f=0,c=b.length;f<c;f++){var d=y[b[f]];ea(a,d,wd,d.url.move)}};Tc.spLevel=function(a){var b=0;2<ra[a]&&(b=ra[a]);return b};var wd=function(a,b){b.stay55();if(b.inventory&&b.invMax===b.inventory.length||!a.item)return 1;ra[a.x32+a.y32*x]=a.radix;ObjectindexHide(a);if(b.peon&&a.contain){var f=a.contain[1],c=a.contain[0];b.stock&&Uh(b);var d=x;var h=Infinity;for(var l=!1,g=
0;121>g;g++){var k=g%11-5;var m=~~(g/11)-5,n=k*k+m*m;k+=b.x32;m+=b.y32;n<h&&(k=ra[k+d*m],0<k&&(k=y[k],k.contain&&(h=n,l=k.id)))}h=l;d=a.contain[2];a.die(1);b.stock=[c,f,h,wd,d];a=vd(b.kingdom,f,b.x32,b.y32);ea(a,b,Yb,b.url[d.url]);aa(b.id);return 1}b.addItem(a);aa(b.id)},Uh=function(a){var b=Vh(a.x32,a.y32),f=~~(b/x);b%=x;b=new fc(52,a.kingdom,b,f,0);ObjectsetupIMG(b,k[a.stock[4].img]);b.contain=[a.stock[0],2,a.stock[4]]},Wh=function(a,b){a=0;for(var f=b.length;a<f;a++){var c=y[b[a]];c.xf?c.stop=
2:(c.stop=2,c.stay(),c.stop=void 0)}},Uc=function(a,b){var f=x;a=y[a];for(var c=0,d=b.length;c<d;c++){var h=y[b[c]],l=Ua[h.zLevel],g=h.x32+h.y32*f;if(0!==l[g]||!a.build){g=a.build?jg(h,h.x32,h.y32):jg(h,a.x32,a.y32);if(!1===g)continue;h.x32=g%x;h.y32=~~(g/x)}h.item&&(a.attack-=h.attack||0,a.defence-=h.defence||0);h.url.idle&&ObjectsetupIMG(h,h.url.idle,1);l[g]=h.id;h.in=0;a.inventory.quit(h.id);ObjectindexShow(h)}aa(a.id,1)},xd=function(a,b){a=y[a];if(1===a.invType)for(var f=0,c=b.length;f<c;f++){var d=
y[b[f]];d!=a&&ea(a.id,d,kg,d.url.move)}},kg=function(a,b){var f=a.inventory;if(f.length<a.invMax){var c=b.x32,d=b.y32;b.rbase()[c+d*x]=b.radix;f.put(b.id);ObjectindexHide(b);b.in=a.id;yd(b.id);aa(a.id)}else b.stay55()},Vc=function(a,b){for(var f=b.length,c=0;c<f;c++){var d=y[b[c]];d.buildList=!1;ea(a,d,yc,d.url.move)}},yc=function(a,b){if(a.dummy&&a.dummy.built)return b.stay55();if(a.health<a.maxHealth)b.dix=0,b.diy=0,b.mv=!0,b.setupDirBuild(a),ObjectsetupIMG(b,b.url.build,1),b.setupINTV(eg,{u:a.id,
a:b.id},Ta(b.img)),nd(b,"hit%20",7,b.img);else{if(b.buildList&&(a=me(b.buildList,b.x32,b.y32)))return ea(a,b,yc,b.url.move),0;b.stay55()}},eg=function(a){var b=y[a.u];a=y[a.a];var f=a.x32,c=a.y32,d=b.x32+b.y32*x;if(b.death)return a.stay();var h=b.maxHealth,l=h/b.time*K[a.kingdom].values.buildSpeed;if(1===b.health){for(var g=b.onbuild1,p=b.id,m=b.getRadix(),n=0,q=g.length;n<q;n++)if(2<m[g[n]]){mb(a,Ta(a.img));return}var r=qb[b.kingdom];n=0;for(q=g.length;n<q;n++)m[g[n]]=p,r[g[n]]=void 0;ic(b)}b.health+=
l;p=b.health;0==b.built&&1>(p-1)/l%(h/l/4)&&(b.d++,ObjectsetupIMG(b,b.img));if(p>=h){p=b.health=h;aa(b.id);if(!b.built){b.d=0;l=b.url;r=qb[b.kingdom];1343===b.type&&(r[d+1]&&13==y[r[d+1]].type&&r[d-1]&&13==y[r[d-1]].type?(l=k.wood_horz,b.child=void 0):r[d+x]&&13==y[r[d+x]].type&&r[d-x]&&13==y[r[d-x]].type&&(l=k.wood_vert,b.child=void 0));b.built=1;b.img=l;Sa(b);if(g=b.onbuildValid)for(m=b.validator.dimension,n=0,q=g.length;n<q;m[g[n++]]=0);Xh(b);xa("bldgdone",0,0,b.kingdom);aa(b.id)}b.action=void 0;
(d=a.buildList)&&d.quit(b.id);if(!d||a.buildList&&0===a.buildList.length)a.buildList=Yh(a),d=a.buildList;if(f=me(d,f,c))return ea(f,a,yc,a.url.move),0;a.buildList.length=0;a.stay();a.stock&&a.stock[0]&&ObjectsetupIMG(a,a.url[a.stock[4].url])}else aa(b.id),mb(a,Ta(a.img));H[0]==b&&(jc.innerHTML=p+"/"+h,Ka.value=p)},qe=function(a,b){if(2<a)for(var f=0,c=b.length;f<c;f++){var d=y[b[f]];ea(a,d,xc,d.url.move)}},Ad=function(a,b){var f=a;a=y[a];if(a.field)for(c=0,a=b.length;c<a;c++)d=y[b[c]],ea(f,d,xc,d.url.move);
else if(0===a.res||3===a.res){var c=0;for(a=b.length;c<a;c++){var d=y[b[c]];ea(f,d,zd,d.url.move)}}else if(1===a.res)for(c=0,a=b.length;c<a;c++)d=y[b[c]],ea(f,d,zc,d.url.move);else if(2===a.res)for(c=0,a=b.length;c<a;c++)d=y[b[c]],ea(f,d,rc,d.url.move)},qc=function(a,b,e){e=e?Bd:Wc;if(!(3>a||(a=y[a],void 0!=a.res||a.magicGateway)))for(var f=0,d=b.length;f<d;f++){var h=y[b[f]];h==a||h.attackOnly&&!h.attackOnly[a.type]||h.bat&&a.build||a.stoned||(h.build?Wc(a,h):ea(a.id,h,e,h.url.move))}},zc=function(a,
b){if(0<a.health){var f=b.x32,c=b.y32;b.mv=!0;b.setupDir(a.x32-f,a.y32-c);ObjectsetupIMG(b,b.url.cut,1);b.dix=0;b.diy=0;nd(b,"chop%20",11,b.img);b.setupINTV(Zh,{u:a.id,a:b.id},7E3);a.addWorker(b)}else b.stay55()},Zh=function(a){var b=x,f=y[a.u];a=y[a.a];var c=K[a.kingdom].values.wood;f.workers.quit(a.id);var d=vd(a.kingdom,1,a.x32,a.y32);f.health-=c;a.mv=!1;aa(f.id);if(1>f.health){c+=f.health;R[f.x32+f.y32*b]=0;b=y[d];b=wa(b.x32,b.y32);for(var h=f.health=0,l=f.workers.slice(0),g=l.length;h<g;h++){var k=
y[l[h]];M(k);b?ea(b,k,zc,a.url.move):k.stay()}a.stock=[c,1,b,zc,Th];a.mv=!1;ea(d,a,Yb,a.url.tree);aa(a.id,1);f.workers.length=0;f.die()}else a.stock=[c,1,f.id,zc,Th],ea(d,a,Yb,a.url.tree),aa(a.id,1);if(0>d)return a.stay()},xc=function(a,b){b.mv=!0;b.setupDir(a.x32-b.x32,a.y32-b.y32);ObjectsetupIMG(b,b.url.dig,1);nd(b,"dig%20",3,b.img);b.setupINTV($h,{u:a.id,a:b.id},7E3)},$h=function(a){var b=y[a.u];a=y[a.a];var f=K[a.kingdom].values.food,c=vd(a.kingdom,2,a.x32,a.y32);a.mv=!1;a.stock=[f,2,b.id,xc,
fk];ea(c,a,Yb,a.url.food);aa(a.id,1);if(0>c)return a.stay()},rc=function(a,b){b.mv=!0;b.setupDir(a.x32-b.x32,a.y32-b.y32);ObjectsetupIMG(b,b.url.milk1,1);b.stock=[0,2,a.id,rc,ck];b.setupINTV(lg,{u:a.id,a:b.id},1E3);a.addWorker(b);a.d=8-b.d;a.stay()},lg=function(a){var b=y[a.u];a=y[a.a];b.milk-=3;var f=a.x32,c=a.y32;a.stock[0]+=3;aa(a.id,1);if(0>=b.milk||b.death){if(50<a.stock[0]&&(a.stock[0]=50),a.mv=!1,b=vd(a.kingdom,2,f,c),ea(b,a,Yb,a.url.milk),0>b)return a.stay()}else mb(a,1E3)},qd=function(a,
b){b.stay55()},Bd=function(a,b){Wc(a,b)},Wc=function(a,b){if(1!==a.death&&a!=b){if(a.dummy&&!K[b.kingdom].values.experience)return b.stay55();b.invisible&&Xc(b.id);if(!0!==b.build){b.mv=1;var f=a.x32-b.x32,c=a.y32-b.y32;a.space&&(c=Yf(a,b.x32,b.y32),f=c%x-b.x32,c=~~(c/x)-b.y32);b.setupDir(f,c,b.d2attack);b.url.attack&&ObjectsetupIMG(b,b.url.attack,1)}b.setupINTV(ai,{u:a.id,a:b.id},Ta(b.img));a.addWorker(b)}else b.stay55()};Wc.distance=-1;Bd.distance=-1;var mg=function(a,b){var f=K[a.kingdom];if(f.values.experience&&
(!b||0!=f.diplomacy[b.kingdom]||b.dummy)){if(0==a.level||null==a.level)a.level=0,a.levelProgress=0;a.levelProgress++;a.levelProgress>=~~(a.level/f.values.experience)&&a.level<f.values.maxLevel&&(a.level++,a.health+=f.values.healthJump,a.maxHealth+=f.values.healthJump,a.levelProgress=0,a.attack+=a.level,a.defence+=a.level%2,aa(a.id,1))}},Nh=function(a){var b=a.level;a.attack+=b;a.defence+=~~(.5*b)},ai=function(a){var b=y[a.u];a=y[a.a];var f=a.attDist,c=b.x32-a.x32,d=b.y32-a.y32,h=b.x32,l=b.y32,g=!a.build;
if(a.attackSound){var k=a.attackSound;xa(k[~~(k.length*Math.random())],a.x32,a.y32)}g&&!b.build&&a.setupDir(c,d,a.d2attack);ObjectsetupIMG(a,a.img,1);if(b.death||a.level&&8<=a.level&&b.dummy||b.dummy&&a.level&&a.level>=K[a.kingdom].values.maxLevel)return a.stay();if(1<f&&!a.dragon){g=!0;var m=a.attimg}else g=!1;if(b.build||rd(b.x32,b.y32,a.x32,a.y32,f)){b.onattack(a);f=a.attack*((Rc[a.type][b.type]||0)+1);if(g){b.space&&(c=Yf(b,a.x32,a.y32),h=c%x,l=~~(c/x),c=h-a.x32,d=l-a.y32);g=0;if(a.arrow||a.ball){k=
bi;var n=vc(-c,-d);var q=c;var r=d;var v=411/Math.sqrt(q*q+r*r);q*=v;r*=v;var w=Math.sqrt(1024*c*c+d*d*1024)/Math.sqrt(q*q+r*r);a.ball&&(m[1]=m[0]/w)}else{var A=2;k=re;g=q=u.gravity;n=Math.PI/180*60;v=Math.cos(n);n=a.attackDeg;n*=Math.PI/180;r=Math.sin(n);w=Math.cos(n);n=32*Math.sqrt(c*c+d*d);q=w*Math.sqrt(q*n/(r*w*2));w=n/q;r=-Math.sin(Math.atan2(-c,-d));n=vc(-c,-d);q*=r;g=Math.abs(g*v*r);r=(32*d-g*w*w*.5)/w}w=Math.round(1E3*w);v={x32:a.x32+.5,y32:a.y32+.5,img:m,mv:a.ball,d:0,rotation:-n+1.5,xf:h,
yf:l,obj:b.id,attack:f,range:A};Sa(v);ObjectsetupPhysics(v,q,r,g);va({func:k,data:v},w,1)}v||b.damage(f,a);if(b.dummy){if(50<=a.dummyDamage||!a.dummyDamage)a.dummyDamage=0;a.dummyDamage+=f;50<=a.dummyDamage&&mg(a,b)}b.death?(a.stay(),a.action=null,b.build||a.build||mg(a,b)):mb(a,Ta(a.img))}else a.mv=!1,0!==a.state&&ea(b.id,a,Wc,a.url.move)},zd=function(a,b){0<a.health?(b.dix=0,b.diy=0,b.mv=1,b.setupDirBuild(a),ObjectsetupIMG(b,b.url.kirka,1),nd(b,"mine%20",3,b.img),b.setupINTV(ci,{u:a.id,a:b.id},
7E3),a.addWorker(b)):b.stay()},ci=function(a){var b=y[a.u];a=y[a.a];var f=b.res,c=K[a.kingdom].values[0==f?"gold":"stone"],d=a.x32,h=a.y32;b.health-=c;aa(b.id);1>b.health&&(c=b.health+c,b.health=0,b.d=3,b.die());a.mv=!1;d=vd(a.kingdom,f,d,h);0==f?(a.stock=[c,f,b.id,zd,dk],ea(d,a,Yb,a.url.gold)):(a.stock=[c,f,b.id,zd,ek],ea(d,a,Yb,a.url.stone));aa(a.id,1);if(0>d)return a.stay()},ea=function(a,b,e,c){b.cow&&b.workers.length||(b.action=e.url,b.distance=0,0<a?(b.xf=a,b.yf=!0):(a*=-1,b.xf=a%x,b.yf=~~(a/
x)),b.func!=fe.url&&(c==b.url.move?Xf(b):b.mimg=c,b.dix=0,b.diy=0,b.mv=!0,b.setupINTV(fe,b.id,0)))},te=function(a,b){M(a);se(b,a,ik)};te.allowPos=1;var ik=function(a,b){Uc(b.id,b.inventory.slice(0));b.stay55()},Yf=function(a,b,e){var f=a.space||Wj,d=f.length-1,h=f[d],l=a.x32;a=a.y32-1;for(var g=Infinity,k=0,m=0;m<d;m++){var n=m%h;n||a++;var q=(l+n-b)*(l+n-b)+(a-e)*(a-e);q<g&&f[m]&&(k=l+n+a*x,g=q)}return k},jg=function(a,b,e){var f=x,d=a.radix,h=Ua[a.zLevel];for(a=2;60>=a;a+=2){b--;e--;for(var l=0;l<=
a;){var g=b+l+f*e;if(h[g]===d)return g;g=b+l+f*(e+a);if(h[g]===d)return g;l++}for(l=0;l<a-1;){l++;g=b+f*(e+l);if(h[g]===d)return g;g=b+a+f*(e+l);if(h[g]===d)return g}}return!1},Vh=function(a,b){var f=x,c,d=ra;for(c=2;60>=c;c+=2){a--;b--;for(var h=0;h<=c;){var l=a+h+f*b;if(0===d[l]&&0===R[l])return l;l=a+h+f*(b+c);if(0===d[l]&&0===R[l])return l;h++}for(h=0;h<c-1;){h++;l=a+f*(b+h);if(0===d[l]&&0===R[l])return l;l=a+c+f*(b+h);if(0===d[l]&&0===R[l])return l}}return!1},Cd=function(a,b){var f=a%x;a=~~(a/
x);var c=b%x;b=~~(b/x);var d=Cd.x,h=Cd.y;return(f-d)*(f-d)+(a-h)*(a-h)-((c-d)*(c-d)+(b-h)*(b-h))},Jb=function(a,b,e,c){var f=b.x32,h=b.y32,l=x,g=f+h*l,k=a.x32,m=a.y32,n=a.space;if(n){var q=n[n.length-1];n=(n.length-1)/q;a=a.free}else n=q=1,a=Ch;b=b.rbase();for(var r,u=Infinity,v=-1,w=!1,E=0,A=0;E<e&&-1==v;){if(0==E&&a){r=[];for(var z=0,B=a.length;z<B;z+=2){var D=a[z]+k,F=a[z+1]+m;!qa(D,F)||b[D+F*l]!==c&&D+F*l!=g||(r[A++]=D+F*l)}Cd.x=f;Cd.y=h;r.sort(Cd);for(z=0;z<A;z++){D=r[z];B=D%l;F=~~(D/l);if(!(B=
100<(f-B)*(f-B)+(h-F)*(h-F))){var C=f,J=h,H=D%l,K=~~(D/l),M=c,I=b;performance.now();B=x;var N=-B,T=+B,L=0,S=0;F=[];var Y={};Y[C+J*B]=1;var R=H+K*B,Q=0;H=!1;var U=0;b:do{K=R%B;var G=~~(R/B);U++;K=(K-C)*(K-C)+(G-J)*(G-J);if(void 0==R||2>=K){H=!0;break b}Y[R]=1;K=5>=K?0:1;G=bb[~~(8*vc(R%B-C,~~(R/B)-J)+.5*K)%8];if(I[R+G]!==M&&null==y[I[R+G]].xf||Y[R+G]){var ba=!1;for(var P=0;8>P;P++)if(G=R+bb[P],I[G]==M&&!Y[G]&&(I[-1+N+G]!=M||I[N+G]!=M||I[1+N+G]!=M||I[-1+G]!=M||I[1+G]!=M||I[-1+T+G]!=M||I[T+G]!=M||I[T+
1+G]!=M)){if(ba&&12<Q++)break;ba=!0;F[L++]=G;K=G%B;G=~~(G/B);if(2>=(K-C)*(K-C)+(G-J)*(G-J)){H=!0;break b}}ba||Q--}else if(F[L++]=R+G,K=(R+G)%B,G=~~((R+G)/B),2>=(K-C)*(K-C)+(G-J)*(G-J)){H=!0;break b}do R=F[S++];while(Y[R])}while(S<=L);C=F;for(J=0;J<0*C.length;J++)K=C[J]%B,G=~~(C[J]/B),M=new fc(0,1,K,G,0),M.c=NaN,ObjectsetupPosition(M,32*x),M.x=32*M.x32+16,M.y=32*M.y32,yb.new(M,2E3);B=H?F:!1;B=!1!==B}if(B){v=D;break}}if(-1<v){w=!0;break}if(1==e)break}E++;--k;--m;for(z=0;z<q+2*E;z++)b[k+m*l+z]==c&&qa(k+
z,m)&&(r=(k+z-f)*(k+z-f)+(m-h)*(m-h),u>r&&(u=r,v=k+z+m*l)),b[k+(m+n+2*E-1)*l+z]==c&&qa(k+z,m+n+2*E-1)&&(r=(k+z-f)*(k+z-f)+(m+n+2*E-1-h)*(m+n+2*E-1-h),u>r&&(u=r,v=k+(m+n+2*E-1)*l+z));for(z=1;z<n+2*E-1;z++)b[k+(m+z)*l]==c&&qa(k,m+z)&&(r=(k-f)*(k-f)+(m+z-h)*(m+z-h),u>r&&(u=r,v=k+(m+z)*l)),b[k+q+2*E-1+(m+z)*l]==c&&qa(k+q+2*E-1,m+z)&&(r=(k+q+2*E-1-f)*(k+q+2*E-1-f)+(m+z-h)*(m+z-h),u>r&&(u=r,v=k+q+2*E-1+(m+z)*l))}return-1<v?[v%l,~~(v/l),w]:!1},Oh=function(a,b,e,c,d){performance.now();var f=x,l=a.x32,g=a.y32,
k=a.space,m=[],n=0;if(k){var q=k[k.length-1];k=(k.length-1)/q;var r=a.free}else k=q=1;a=-1==b?-Infinity:Infinity;for(var u=-1,v=0,w=0;0==m.length;){if(r&&0==w){for(var E=0,z=r.length;E<z;E+=2){var y=r[E]+l,A=r[E+1]+g;qa(y,A)&&d[y+A*f]===c&&(m[n++]=y+A*f,v=(y-b)*(y-b)+(A-e)*(A-e),a>v&&(a=v,u=y+A*f))}if(m.length)break}w++;--l;--g;for(E=0;E<q+2*w;E++)d[l+g*f+E]==c&&qa(l+E,g)&&(m[n++]=l+E+g*f,v=(l+E-b)*(l+E-b)+(g-e)*(g-e),a>v&&(a=v,u=l+E+g*f)),d[l+(g+k+2*w-1)*f+E]==c&&qa(l+E,g+k+2*w-1)&&(m[n++]=l+(g+
k+2*w-1)*f+E,v=(l+E-b)*(l+E-b)+(g+k+2*w-1-e)*(g+k+2*w-1-e),a>v&&(a=v,u=l+(g+k+2*w-1)*f+E));for(E=1;E<k+2*w-1;E++)d[l+(g+E)*f]==c&&qa(l,g+E)&&(m[n++]=l+(g+E)*f,v=(l-b)*(l-b)+(g+E-e)*(g+E-e),a>v&&(a=v,u=l+(g+E)*f)),d[l+q+2*w-1+(g+E)*f]==c&&qa(l+q+2*w-1,g+E)&&(m[n++]=l+q+2*w-1+(g+E)*f,a>v&&(a=v,u=l+q+2*w-1+(g+E)*f))}return[u,m]},Ch=[-1,0,-1,-1,0,-1,1,-1,1,0,1,1,0,1,-1,1],me=function(a,b,e){for(var f=Infinity,d=!1,h=0,l=a.length;h<l;h++){var g=a[h],k=y[a[h]];if(0!=k.built||k.death)h--,l--,a.quit(g);else{var m=
k.x32;k=k.y32;k=(m-b)*(m-b)+(k-e)*(k-e);f>=k&&(f=k,d=g)}}return d},di=function(a){for(var b=0,f=a.length;b<f;b++){var c=y[a[b]];c.spd=c.__proto__.spd}},ei=function(a){for(var b=Infinity,f=0,c=a.length;f<c;f++){var d=y[a[f]];M(d.spd);d.spd<b&&(b=d.spd)}ng(b,a)},og=function(a,b){se(b,a,Yb)},Yb=function(a,b){a=K[b.kingdom];a.resources[b.stock[1]]+=b.stock[0];a.stats.resources[b.stock[1]]+=b.stock[0];ue(b.kingdom);b.func=1;var f=b.stock[3];a=y[b.stock[2]];if(f==rc){var c=x;for(var d,h=Infinity,l=!1,g=
0;961>g;g++){var k=g%31-15,m=~~(g/31)-15,n=k*k+m*m;k+=b.x32;m+=b.y32;n<h&&(d=ra[k+c*m],0<d&&0===R[k+c*m]&&(d=y[d],d.contain&&"meat"==d.contain[2].url&&(h=n,l=d)))}if(c=l)f=wd,a=c}else"meat"==b.stock[4].url&&!1===b.stock[2]&&(c=fi(b.x32,b.y32,!0))&&(f=rc,a=c,b.stock[2]=1);if(!1===b.stock[2])return b.stock=void 0,b.stay();b.stock=void 0;ea(a.id,b,f,b.url.move);aa(b.id,1)};Ad.cursor=6;qc.cursor=1;Vc.cursor=9;Tc.cursor=5;xd.cursor=7;te.cursor=7;qe.cursor=6;og.cursor=6;var Yh=function(a){var b=x,f=a.kingdom,
c=a.x32,d=a.y32;c-=8;d-=8;for(var h={},l=[],g=0,k=qb[f],m=0;256>m;m++){a=m%16+c;var n=~~(m/16)+d;qa(a,n)&&(a=k[a+n*b],void 0!==a&&(a=y[a],a.kingdom!=f||!1!==a.built||h[a.id]||(l[g++]=a.id,h[a.id]=1)))}return l};zc.available=function(a,b){var f=K[a.kingdom].values.wood;if(b.death||1>b.health-f&&b.workers.length)b=wa(b.x32,b.y32),a.xf=b,b=y[b];return Jb(b,a,1,a.radix)};zd.available=function(a,b){if(!b.death){var f=Jb(b,a,1,a.radix);if(f[2])return f}for(var c=b.x32,d=b.y32,h=0;5>h;){b=Uj(c,d,b.type,
b.id);if(!1===b)break;b=y[b];f=Jb(b,a,1,a.radix);if(f[2])return a.xf=b.id,f;h++}return!1};xc.available=function(a,b){if(b.death)return!1;a=b.x32+1;b=b.y32+1;return 0===R[a+b*x]?[a,b,1]:!1};yc.available=function(a,b){var f=a.x32,c=a.y32;if(!b.death){var d=Jb(b,a,1,a.radix);if(d[2])return d}a.buildList?(d=a.buildList,d.quit(b.id)):(a.buildList=Yh(a),d=a.buildList);b=me(d,f,c);if(!b)return!1;a.xf=b;b=y[b];return Jb(b,a,1,a.radix)};qd.rev=function(a){return(a=Wf(a.id))?[Bd.url,a]:!1};Bd.available=function(a,
b){var f=Wf(a.id);f&&(a.xf=f,b=y[f]);return Jb(b,a,5,a.radix)};wd.available=function(a,b){if(b.death)return!1;a=b.x32;b=b.y32;return 0===R[a+b*x]?[a,b,1]:!1};rc.available=function(a,b){if(b.workers.length||b.milk<50/1.5||b.death){b=fi(a.x32,a.y32);if(!b)return!1;a.xf=b.id}return Jb(b,a,5,a.radix)};kg.available=function(a,b){if(b.death)return a.stay(),!1;var f=1;b.boat&&(f=2);return(a=Jb(b,a,f,a.radix))?(a[2]=1,a):!1};var fi=function(a,b,e){for(var c=x,f,h=Infinity,l=!1,g=0;441>g;g++){f=g%21-10;var k=
~~(g/21)-10,m=f*f+k*k;f+=a;k+=b;m<h&&(f=R[f+c*k],0<f&&(f=y[f],f.cow&&(!f.workers.length&&f.milk>=50/1.5||e)&&(h=m,l=f)))}return l},se=function(a,b,e){for(var c=0,f=a.length;c<f;c++){var h=y[a[c]];ea(b,h,e,h.url.move)}},we=function(a,b){Wa(b,a,ve)};we.noObj=1;var ve=function(a,b){Dd(b,-a,77,ve)},ye=function(a,b){Wa(b,a,xe)};ye.noObj=1;var xe=function(a,b){Dd(b,-a,130,xe)},Ae=function(a,b){Wa(b,a,ze)};Ae.noObj=1;var ze=function(a,b){Dd(b,-a,78,ze)},Ce=function(a,b){Wa(b,a,Be)};Ce.noObj=1;Ce.cursor=
10;var Be=function(a,b){Dd(b,-a,132,Be)},Ee=function(a,b){Wa(b,a,De)};Ee.cursor=10;Ee.noObj=1;var De=function(a,b){Dd(b,-a,131,De)},Dd=function(a,b,e,c){var f=x,h=K[a.kingdom],l=w[e],g=w[e].cost,k=a.mana>a.manaMax;if(Xa(a)||a.checkMana(g[4],b,c,g)){k||h.paypal(g);c=e;b*=-1;k=b%f;var m=~~(b/f),n=k,q=m,r=Ua[l.zLevel],u=~~(a.mana/g[4])+1;1<u&&(h.resources[0]-=g[0]*(u-1),a.mana-=g[4]*(u-1));for(h=0;h<u;h++)0!==r[b]&&(e=jg(l,k,m),n=e%f,q=~~(e/f)),xa("summon"+~~(10*Math.random()+1),n,q),e=new fc(c,a.kingdom,
n,q,0),e.setupChild(Ab.spawn);a.setupDir(-a.x32+e.x32,-a.y32+e.y32);a.setupSpellIMG()}else h.paypal(g);aa(a.id)},rd=function(a,b,e,c,d){return~~Math.sqrt((a-e)*(a-e)+(b-c)*(b-c))<=d},pg=function(a,b){Wa(b,a,Fe)};pg.cursor=0;var Fe=function(a,b){a.build||a.terrain||a.nofreeze||!Xa(b)&&!b.checkMana(50,a.id,Fe)||(a.freezed=1,a.stoned=1,ObjectsetupPosition(a,32*a.y32),a.stay(),ObjectsetupIMG(a,a.img,0),a.setupChild(Ab.turnStone),Yc(a,Ih),yd(a.id),b.setupDir(-b.x32+a.x32,-b.y32+a.y32),b.setupSpellIMG(),
xa("turn%20to%20stone",b.x32,b.y32),va({func:gi,data:a.id},24E4,1))},gi=function(a){a=y[a];a.freezed=0;ic(a);a.stoned=0},qg=function(a,b){Wa(b,a,Ed)},Ed=function(a,b){a.health<a.maxHealth&&!a.build?(b.setupDir(a.x32-b.x32,a.y32-b.y32),M("heal",Ta(b.img)),b.setupSpellIMG(!0),b.setupINTV(jk,{u:a.id,a:b.id},0),a.addWorker(b)):b.stay()},ii=function(){Wa(list,obj,hi)},hi=function(){},jk=function(a){var b=y[a.a];a=y[a.u];var f=K[b.kingdom].values.healingRange;xa("heal",b.x32,b.y32);if(!rd(a.x32,a.y32,b.x32,
b.y32,f))return ea(a.id,b,Ed,b.url.move);if(Xa(b)||b.checkMana(4,a.id,Ed)){b.setupDir(a.x32-b.x32,a.y32-b.y32);a.health+=6;a.setupChild(Ab.heal);if(a.health>=a.maxHealth)return a.health=a.maxHealth,aa(a.id,1),aa(b.id,1),b.stay();aa(a.id,1);aa(b.id,1);mb(b,Ta(b.url.spell))}},He=function(a,b){Wa(b,a,Ge)};He.cursor=10;var ji=function(f,b){f=y[f];b=y[b];if(f.inventory.quit(b.id)){b=a[b.spell];f.icons==f.__proto__.icons&&(f.icons=f.icons.slice(0));f.icons.put(b);var e=f.icons;e.olegal||(e.olegal={});e.olegal[b.id]=
1;aa(f.id)}},Fd=function(a,b){var f=b[1];b=y[b[0]];y[a].nopotion||y[a].build||(ea(a,b,ki,b.url.move),b.actionItem=f)};Fd.item=1;var ki=function(a,b){var f=y[b.actionItem];b.actionItem=void 0;f.attack&&(a.attack+=f.attack);f.defence&&(a.defence+=f.defence);f.mana&&(a.mana||(a.mana=0,a.manaMax=0,a.update?a.update.push("mana","manaSpeed",1E3):a.update=["mana","manaSpeed",1E3],va({func:ge,data:[a.id,"mana","manaSpeed",1E3]},1E3,1)),a.manaMax+=f.mana,a.mana+=f.mana);f.level&&(a.level||(a.level=0),a.level+=
f.level,a.attack+=f.level,a.defence+=~~f.level);xa("bless",a.x32,a.y32);b.inventory.quit(f.id);b.stay55();aa(b.id)};Fd.cursor=10;qg.cursor=10;we.cursor=10;ye.cursor=10;Ae.cursor=10;var rg=function(a,b){Wa(b,a,kk)};rg.cursor=1;var kk=function(a,b){a.isSpy&&a==b?b.stay55():(b.setupDir(-b.x32+a.x32,-b.y32+a.y32),ObjectsetupIMG(b,b.url.attack,1),va({func:li,data:[a,b]},Ta(b.img)-25,1))},li=function(f){var b=f[1];f=f[0];f.die(1);var e=f.getRadix();e[b.x32+b.y32*x]=b.radix;b.x32=f.x32;b.y32=f.y32;b.d=f.d;
b.name=b.name;b.attack=f.attack;b.defence=f.defence;b.update=b.update;b.mana=0;b.manaMax=b.manaMax;e[b.x32+b.y32*x]=b.id;ObjectsetupPosition(b,32*b.y32);b.__proto__=f.__proto__;ObjectsetupIMG(b,b.url.idle);e=f.icons.slice(0);e.quit(a.menuBuilds);e.quit(a.menuBuilds1);e.quit(a.menuBuilds2);e.put(a.impersonate);e.put(a.revealSelf);b.icons=e;b.spy||(b.spy=b.kingdom);b.kingdom!==f.kingdom&&b.changeKingdom(f.kingdom);b.setupChild(Ab.impersonate);aa(b.id)},mi=function(a){a=y[a];if(a.spy){var b=w[2];a.attack=
b.attack;a.defence=b.defence;a.__proto__=b;a.icons=b.icons;a.kingdom!==a.spy?a.changeKingdom(a.spy):a.stay();ObjectsetupIMG(a,a.url.idle);aa(a.id)}};He.allowPos=1;var Ge=function(a,b){if(a.id){var f=a.id,c=a.x32;a=a.y32}else f=-a,c=a%x,a=~~(a/x);if(Xa(b)||b.checkMana(60,f,Ge)){b.setupDir(-b.x32+c,-b.y32+a);b.setupSpellIMG();f=8;c-=.5*f;a-=.5*f;var d=[];f+=1;var h=f*f;xa("bless",b.x32,b.y32);for(b=0;b<h;b++)for(var l=1;3>l;l++){var g=y[Ua[l][b%f+c+(~~(b/f)+a)*x]];g.build||g.terrain||(g.setupChild(Ab.bless),
g.blessed||(g.blessed=1,g.attack+=5,aa(g.id,1),d.put(g)))}va({func:ni,data:d},3E4,1)}},Wa=function(a,b,e){if(a[1]&&y[a[1]].item){var c=a[1];a.length--;se(a,b,e);y[a[0]].actionItem=c}else se(a,b,e)},Xa=function(a){var b=a.actionItem;if(!b)return!1;b=y[b];b.attack&&(b.attack--,0===b.attack&&(a.inventory.quit(b.id),aa(a.id)));return!0},ni=function(a){for(var b=0,f=a.length;b<f;b++){var c=a[b];c.blessed=void 0;c.attack-=5;aa(c.id,1)}},Je=function(a,b){Wa(b,a,Ie)};Je.cursor=10;var Ie=function(a,b){a.freezed||
!Xa(b)&&!b.checkMana(50,a.id,Ie)?b.stay55():(b.setupDir(-b.x32+a.x32,-b.y32+a.y32),b.setupSpellIMG(),xa("invisible",a.x32,a.y32),a.invisible||(Yc(a,ag),a.invisible=1,a.stay()),aa(a.id),va({func:Xc,data:a.id},5E4,1))},Xc=function(a){a=y[a];a.death||(a.invisible=void 0,ic(a))},tg=function(a,b){Wa(b,a,sg)};tg.cursor=0;var sg=function(a,b){if(Xa(b)||b.checkMana(50,a.id,sg))b.setupDir(-b.x32+a.x32,-b.y32+a.y32),b.setupSpellIMG(),xa("lightning",b.x32,b.y32),a.damage(50,b)},Le=function(a,b){Wa(b,a,Ke)};
Le.cursor=0;Le.noObj=1;var Ke=function(a,b){var f=x;if(a.id){var c=a.id,d=a.x32;a=a.y32}else c=-a,d=a%f,a=~~(a/f);if(Xa(b)||b.checkMana(50,c,Ke)){b.setupDir(-b.x32+d,-b.y32+a);b.setupSpellIMG();xa("flame%20ball",d,a);c=d-b.x32;d=a-b.y32;a=Math.sqrt(c*c+d*d);c/=a;d/=a;for(var h=b.x32+.5,l=b.y32+.5,g=[],k=[],m=0,n,q,r=0;r<a;r++)n=h+c*r,q=l+d*r,k.put(n),k.put(q),n=~~n,q=~~q,g[m++]=n+q*f,g[m++]=~~(n+d)+~~(q+c)*f,g[m++]=~~(n-d)+~~(q-c)*f;for(r=0;r<0*g.length;r++)he(g[r]%f,~~(g[r]/f),"food");va({func:ug,
data:{list:g,anim:k,i:2,a:b}},1E3,1)}},vg=function(a,b){Wa(b,a,Gd)};vg.cursor=10;var Gd=function(a,b){b.setupDir(-b.x32+a.x32,-b.y32+a.y32);b.setupSpellIMG(!0);b.setupINTV(lk,{u:a.id,a:b.id},0);a.addWorker(b)},lk=function(a){var b=y[a.a];a=y[a.u];if(!rd(a.x32,a.y32,b.x32,b.y32,K[b.kingdom].values.teachDistance))return ea(a.id,b,Gd,b.url.move);if(a.level>=b.level)return b.stay();if(Xa(b)||b.checkMana(10,a.id,Gd))xa("teach",b.x32,b.y32),b.setupDir(a.x32-b.x32,a.y32-b.y32),a.setupChild(Ab.curse,!1,Yj),
mg(a,!1),aa(a.id,1),aa(b.id,1),mb(b,Ta(b.url.spell))},Ne=function(a,b){Wa(b,a,Me)};Ne.cursor=0;Ne.noObj=1;var Me=function(a,b){var f=x;if(a.id){var c=a.id,d=a.x32;a=a.y32}else c=-a,d=a%f,a=~~(a/f);if(Xa(b)||b.checkMana(70,c,Me)){b.setupDir(-b.x32+d,-b.y32+a);b.setupSpellIMG();c=d;var h=a;d-=8;a-=8;for(var l=0;256>l;l++){var g=d+l%16,k=~~(l/16)+a,m=g+k*f;qa(g,k)&&64>=Math.pow(g-c,2)+Math.pow(k-h,2)&&Oe[m]&&0===R[m]&&(M(g,k),new fc(60,b.kingdom,g,k,0))}}},ug=function(a){var b=a.list,f=a.anim,c=a.i,
d=a.a,h={x32:f[2*c],y32:f[2*c+1],d:0,img:k.flame_trail,mv:1,z32:2,alpha:!0};Sa(h);yb.new(h,Ta(h.img));for(h=0;3>h;h++){var l=y[R[b[h+3*c]]];l.health&&l.damage(96,d)}a.i++;a.i<.5*f.length&&va({func:ug,data:a},50,1)},Qe=function(a,b){Wa(b,a,Pe)};Qe.cursor=0;Qe.noObj=1;var Pe=function(a,b){if(a.id){var f=a.id,c=a.x32;a=a.y32}else f=-a,c=a%x,a=~~(a/x);if(Xa(b)||b.checkMana(60,f,Pe))b.setupDir(-b.x32+c,-b.y32+a),b.setupSpellIMG(),xa("freeze",c,a),va({func:oi,data:[c,a]},1E3,1)},Se=function(a,b){Wa(b,a,
Re)};Se.cursor=0;Se.noObj=1;var Re=function(a,b){if(a.id){var f=a.id,c=a.x32;a=a.y32}else f=-a,c=a%x,a=~~(a/x);if(Xa(b)||b.checkMana(70,f,Re)){b.setupDir(-b.x32+c,-b.y32+a);b.setupSpellIMG();xa("confusion",c,a);b=4;c-=.5*b;a-=.5*b;f=x;var d=[];b+=1;for(var h=b*b,l=0;l<h;l++)for(var g=1;3>g;g++){var k=y[Ua[g][l%b+c+(~~(l/b)+a)*f]];k.build||k.terrain||k.stoned||(k.confused=1,k.invisible&&Xc(k),Yc(k,Jh),k.stay(),k.oking=k.kingdom,k.kingdom=K.length-1,d.put(k),yd(k.id))}h&&1===H.length&&aa(H[0]);d.length&&
va({func:pi,data:d},2E4,1)}},pi=function(a){for(var b=0,f=a.length;b<f;b++){var c=a[b];c.confused=void 0;c.kingdom=c.oking;c.oking=void 0;c.death||(ObjectsetupIMG(c,c.img,1),ic(c),c.stay(),Pa==c&&(Pa=void 0,H[0]=c.id,aa(c.id)))}},oi=function(a){var b=6,f=a[0]-.5*b,c=a[1]-.5*b,d=x,h=[];b+=1;var l=b*b;a={img:k.freeze_expl,d:0,mv:1,x32:a[0],y32:a[1]};Sa(a);yb.new(a,Ta(a.img));for(var g=0;g<l;g++)for(var p=1;3>p;p++)a=y[Ua[p][g%b+f+(~~(g/b)+c)*d]],a.build||a.terrain||a.nofreeze||a.stoned||(a.freezed=
1,ObjectsetupPosition(a,32*a.y32),a.stay(),ObjectsetupIMG(a,a.img,0),a.invisible&&Xc(a),Yc(a,Hh),a.health-=40,1>a.health&&(a.health=1),h.put(a),yd(a.id));l&&1===H.length&&aa(H[0]);va({func:qi,data:h},2E4,1)},qi=function(a){for(var b=0,f=a.length;b<f;b++){var c=a[b];c.freezed=void 0;c.death||(ObjectsetupIMG(c,c.img,1),ic(c),Pa==c&&(Pa=void 0,H[0]=c.id,aa(c.id)))}},Ue=function(a,b){M(b);Wa(b,a,Te)};Ue.cursor=0;Ue.noObj=1;var Te=function(a,b){M(a,b);if(a.id){var f=a.id,c=a.x32;a=a.y32}else f=-a,c=a%
x,a=~~(a/x);if(Xa(b)||b.checkMana(100,f,Te))b.setupDir(-b.x32+c,-b.y32+a),b.setupSpellIMG(),wg(c,a,3,20,4500,b.id)},wg=function(a,b,e,c,d,h){for(var f=k.fire_rain,g=u.gravity,p=Date.now(),m=wg.rnd,n=Math.PI,q=performance.now(),r=0;r<c;r++){var v=2*m()*n,w=e*m(),x=a+w*Math.cos(v);v=b+w*Math.sin(v);w=~~(r/c*d);qa(x,v)&&va({func:ri,data:{x32:x,y32:v-6,dix:0,diy:140,img:f,mv:1,d:0,timestamp:p,finnish:Infinity,aceleration:g,attack:40,xf:x,yf:v,range:2,kingdom:0,obj:h,crashTime:(Math.sqrt(19600+384*g)-
140)/g*1E3}},w,1)}M(performance.now()-q)},ri=function(a){va({func:re,data:a},a.crashTime,1);Sa(a,0,a.diy,u.gravity)};wg.rnd=function(){var a=4096,b=2048;return function(){b=36969*(b&65535)+(b>>16)&4294967295;a=18E3*(a&65535)+(a>>16)&4294967295;return((b<<16)+a&4294967295)/4294967296+.5}}();var bi=function(a){y[a.obj].damage(a.attack,y[a.obj]);vb(a);Zb.put(a.bufferID)},si=function(a){a=y[a];a.bufferID&&(vb(a),Zb.put(a.bufferID));Oe[a.x32+a.y32*x]=void 0},re=function(a){var b=x,f=a.xf,c=a.yf,d=a.attack;
a.mv=1;a.func=void 0;a.x32=f;a.y32=c;ObjectsetupPhysics(a,0,0,0);ObjectsetupPosition(a,2);f=~~f;c=~~c;var h=f+c*b,l=R[h];Mb[h]?(a.img=k.expl_small_water,xa("water%blop",a.x32,a.y32)):(a.img=k.expl_small_hole,xa("small%20explosion",a.x32,a.y32));ObjectsetupIMG(a,a.img,1);yb.new(a,ti(ta[a.img]));if(2<l){var g=y[l];g.damage(d,y[a.obj])}h=a.range;l=2*h+1;for(var p=0,m=l*l;p<m;p++){g=p%l-h;var n=~~(p/l)-h,q=~~Math.sqrt(g*g+n*n);q<h&&(g+=f,n+=c,g=R[g+n*b],2<g&&(g=y[g],g.damage(d*(1-q/h),y[a.obj])))}},mk=
function(a){if(0<H.length){var b=y[H[0]],f=0,c=0,d=0,h=0;void 0!==b.dix&&(a=.001*(a-b.timestamp),h=b.dix,d=b.diy,f=h*a,c=d*a);if(b.space){var l=b.space;a=l[l.length-1];l=(l.length-1)/a}else l=a=1;f+=32*(b.x32+.5*a-Math.sign(h))+.5*-tzar.width+.5;c+=32*(b.y32+.5*l-Math.sign(d))+.5*-tzar.height+.5;gb=~~-f;rb=~~-c}},ui=function(){};Ed.distance="healingRange";ve.distance="createGolemRange";Ge.distance="blessDistance";Pe.distance="freezeDistance";Re.distance="confusionDistance";Ie.distance="invisibilityDistance";
sg.distance="lightningDistance";ze.distance="createBatDistance";xe.distance="createDragonDistance";De.distance="createCarpetDistance";Be.distance="createJinnDistance";Fe.distance="turnToStoneDistance";Ke.distance="flameBoltDistance";Te.distance="fireRainDistance";Me.distance="freezeDistance";Gd.distance="teachDistance";var eb;var K=[];var cc=function(a,b,e,c,d,h,l){this.name=a;this.k=K.length;this.color=b;this.status="";this.stats={dmgInflicted:0,dmgTaken:0,resources:[0,0,0,0],score:0,unitsKilled:0,
unitsLosed:0,buildsLosed:0,buildsDestroyed:0,unitCount:new Uint32Array(w.length),unitCountMax:new Uint32Array(w.length),unitCountDeath:new Uint32Array(w.length),goldTraded:0,goldConverted:0,stoneTraded:0};this.team=l;this.resources=h||[5E4,5E4,5E4,5E4];this.values={gold:10,wood:10,food:10,stone:10,buildSpeed:1,experience:0,healthJump:0,maxLevel:4,pop:0,popMax:1,popLimit:200,healingRange:1,blessDistance:9,createGolemRange:5,freezeDistance:13,invisibilityDistance:9,createBatDistance:16,lightningDistance:12,
createDragonDistance:4,turnToStoneDistance:21,flameBoltDistance:19,fameTech:0,confusionDistance:13,manaSpeed:2,milkSpeed:2,cowSpeed:2,stealCow:0,miningPerf:1,fireRainDistance:15,createCarpetDistance:3,createJinnDistance:3,teachDistance:2};this.race=c;this.racestr=xg[c];this.IA=d||0;this.diplomacy=e;this.control={};this.control[this.k]=1;this.onFreePop=[];a=[];a.length0function=nk;this.unitLoading=0;this.target=[0,0,0,0];this.crusade={number:0,list:a};this.technology={hidden:{},disabled:{},actived:{},
investigated:{}};this.mod=a=[];vi[this.racestr]++;b=0;for(e=w.length;b<e;a[b++]={});K[K.length]=this};cc.prototype.setupResources=function(a,b){var f=this.resources;b||(b=1);f[0]-=a[0]*b;f[1]-=a[1]*b;f[2]-=a[2]*b;f[3]-=a[3]*b;ue(this.k)};var za,Rd,qb;cc.prototype.check=function(){for(var a=ok,b=eb[this.k],e=0,c=w.length;e<c;e++)if(!a[e]&&0<b[e].length)return!0;this.die()};cc.prototype.checkPopArray=function(){this.onFreePop.length&&sd(this.onFreePop.shift())};cc.prototype.die=function(){this.k+1!=
K.length&&(this.death=1,this.status="defeated",wi(),zb(Zc(A.playerDefeated,this.name),0,5))};cc.prototype.paypal=function(a){var b=this.resources,f=!1;b[0]<a[0]&&(zb(Zc(A.notEnough,A.gold),0,5),f=!0);b[1]<a[1]&&(zb(Zc(A.notEnough,A.wood),0,5),f=!0);b[2]<a[2]&&(zb(Zc(A.notEnough,A.food),0,5),f=!0);b[3]<a[3]&&(zb(Zc(A.notEnough,A.stone),0,5),f=!0);if(f)return f;b[0]-=a[0];b[1]-=a[1];b[2]-=a[2];b[3]-=a[3];ue(this.k)};var ue=function(a){if(a==z.kingdom){var b=K[a].resources;a=b[0];var f=b[1],c=b[2];b=
b[3];Infinity==a&&(a="***");Infinity==f&&(f="***");Infinity==c&&(c="***");Infinity==b&&(b="***");pk.innerHTML=a;qk.innerHTML=f;rk.innerHTML=c;sk.innerHTML=b}},ok={13:1,20:1,21:1,22:1,27:1,32:1,35:1,36:1,43:1,44:1,55:1,56:1,57:1},Va;var xi=[];(function(){var a="",b=new Image;b.src="data:image/gif;base64,R0lGODlhIQB2AfcAAAAAABAIAAgAABEhACE6ABkbChAQAAgIABAQCO/vlN7epf/6hZSQUv76n721a//rY/XmhnNjECklEP7oecW1Y+7ZeP/rhvvrljEpCCgiB+/Wa97OjP/WSu3YhyEZAIhzLf/WWOnHWv7baL2lVt3Db/vsvUo3BGtSCGhVIdq1SnhjKdy4V62USuvIaPzad/felO/XlzopAGtaMe3Kd/zbiOjMhv/9+JxzGWNKECEZCP/JSuu5Sc6lSMynV4tzPdSyaK2UWjEhADopCNacKWNKGVdCGf/IVuu4VruUSPzJZ7qYU0IqABkQAGdFB2tKEFI6D5tzKMqVN9unSNyrVlRDI/nLd7JwACkZAOaUEDEhCMSMMZRrKYlkJ/u3SJt0M8yYRquDQO66Zu3MlrWcc5haAItSAf+lGUIqCGNCEJdjGXpTGJxrIfisOGtKGcSNOtacQruHOfu6VsiYVOm6dPvLh/rZqTohAHdHB3NKEFo6D0kxEJRjIc6MMalzKYRaIZxrKXlTIuCcP6x5M+umR1I6GX5aKdacSuqqVdedUollNK2HVUopAFQxBXtKEGtCEMmBJ7h2J3NKGdeNNMOCMWNBGZRjKf2rR86MOtaUQpdpMt6cSrqFQkk0GnVWL9OjZolVGeeQLJ5jIKdqJ4xaIeCTObd6NembRt6UQsWEPGlHIf+tUsuMQ9aUSppyRzEZAGU1BkopCHNCEDohCFIxECkZCPeXM3tKGdKDMIRSIZxjKlo6Gc6EOoxaKahwNt6USjUkE/zLmUIgACEQAIZLEtZ2H5ZUF2Y6ELlpIN9/KGtBGUUpEHVKIRkQCNaMRntCEHNCGZdZI86MUjoZAFQoBs5qIF0xECUZEE8hAHQ0CIQ9C5RHD65TFb5cGXY6EDEZCHtCGYRKIVIxGSkQAEohCEIfCVIpEKJEEUUpGWgnBzoZCEIzKzEQABkIAHMpCIw0CyEQCFsZAlEZBikQCDQZECEHAD4PATEQCGshEDEIAPNGKRkAABAAABkICBAICAgICP///yH5BAEAAP8ALAAAAAAhAHYBAAj/AP8JHEiwIEEBBhMqXPiP3QGEAwVAZKgQYoBwLAIMpIUCwESKE5lI/CeA0woU+wTSIvHk40IBD/9x+vHrnYB9+358EbdPwDsavfi5NMiEChcA/5i0QIKrzTsANeQoC+DzAhJvKYcK3AeoAheqAlbo0XNGlpIKR5axEyChwwo/U7UK+EWiAxRdgH5RGnWpD6ArwpCUWlaES40WX0pRompQwIcXLbR8ObKi1BdUcXatMsZuFCUuUtxKidLr11ABT5Ag+tIHjK5MYb5UilPqlK0rVwKkmiJFyyVBpgsyCRCAEpIvyubJC4CkCq9Rh3JhqiRSAJQvcPgIUgaTIIofMvL8/5hCKwfEHmEiDcq0CtosdklHjeoDaSpSgQKoWGjRowMYWh4JlEgYm4wyhR+buaKLAEwoQ4gfs9CikUBM/OBWCytEAuBESIThhyZbVGILOU+QJEAOhFBCyy/44QDDDFKsgJwwqRA0oBejiBJJMmecYSIAOSxjjzf4jeLCFNi9ocxugAyk3hSVhIILGmd4U6KJ77yTAzu/cMIOZXBQ4gcsRXyRhB4CPXEJHT2U4kUyeggzS0QCABAAHD0koUIP/HkjzwH/+ODCFz7qUQoNM3zBVB5X+GjQLGBQtkIHSTxDXAB5wGFBGEUUcUsVF8SWSzJZyJLQTZUc0cIMK7ghhAAZ/P9DySAWuBCHKYdcMMMUgkQSZxGnyiPFF27wIAUX9hgQQBu4DOKCrVLQUMURboySBxNonurFCmn4UYoWfsiT0l6TDBLHIWGEgeQfaAQhREXhrADHLLrgIsgswgiURySiuCEFK4dg4oYoz5yhlUDiRCEFJfZk0UYeNgkkizGfiCJKKajAkYstswTQpEKzVsIOO+Rk4Y1IAglzRh7OQFOKIKF8wmgWClHVhyRFBOARLbRMxI4wsDgSSh99jJKMLKfNxY4abgiii851fiQAO64Yc4woebiCckE5qFCFEnB8IcUWv2zdmDDDSCMRg40RIkgILVAmxRPvTJjQPuwA4FG+pzL/w8UkYGCXzC8BJkSVnSBloYssnMxSsgEHU2RQFjoH4I0wkUuuEAB4Z655RZ8rVAIgzIQeehx0RMKE6Z9XkcQspbNOESZ0xAG77BQFAoztseOukO6WlNO77waZUocls+RAvEKHHJ/88gk1X4sxtEBvUBh1sGGM8tYTNIgNtXzC/T9kVA99IOA/f0cJtYxPPB82gHLHP03QYAU93fOBzDE5bGLKK90byB1I4Q3zdS8PjGhCCaxgQOjdwQZWMAMtzIAFmlmPBmzIAiX+8YohlKEM81teGXg2kDLYgAZkCOBAmlCLWtxHhf/4IAxnSMMa2vCGOMyhDnfIwx768B82QEMN/2dgg3fN0BNhsAERZtgKRMDABsaYISvCAIMSPINIAczEEeRQhxK8woLWe8UOLrGCElzAFukIIB+O8IgpXGAOr0hHH6yXiyQkRgwwSMIdvGGx5anBCFNYhSjmMIcj3MAbgIDE8jQRBkQIYg3j2YEUZBELLRAPCUk4hBy4kAs5wEFh8nDEG6KAuyZkcgpwaEQvFCGIK3jjDIx4xA5wd4QjBPITjviDMITBjiysCAMvDF0f4iCFUkBDDx6QhTVmIY/CyY4eSZACKi5BjgA0QgtbkEUDZReFHexAHOKoRAPC0IZXLm8ZIBCHzvTgiVKlwhrLO4cx9oEUAGSAFnKYAhf6of9CABxAEDtIhCxMAMMA7OEMPSiGGmDIiDF0AAnQgOEBQFEDRgSzeyYoBqZ+yNGOevSjIA2pSAVygic0gXVLkFwT3BGPeIQOHYx4wkUL0gRzcCMe2KiH5tCBDnfo7R/kUIg79hcPdLhUcuiwqUvrwQiDtJQatQiEOdxBAKQO9RgR6GlCpsENZOgAGdxoRzAo8tSoTpUA7RhIPYo6VB3ooAuSaCpFuOpVsLZDrsFohzt4So0u6MAIICjGWBligra+Na7uYEQw3OGOf5iAG2z46wOksA10UAQdff1rYBlbD3MU4x/40EYtACuCB1SWIo+NrBEmy9MMcIMa7sAHPh6hAxD/GIEDoOAGNggrWtKaFh3C2AYoGCvbY7CBDaAgRjF2S9ha1Pa2oMgGPhhRC9hqY6/aSC4xZMHchZgAG9g4bnKLEQ/hgsIc1KCGOeqhjW6wFJwUwYY7skuM7b5iG1A9BlSJgQ5yoMMY2CiA5kyAjm24Nx5LcAc12BAIZBx3G8HARgbEEVTJYWMc4/gvNmiBDmKAQge1YEMXkGEOciDucxgex4QZUY/6dsEIx60FMnA3DmwwIwCMYIQ5zEGMOOiADSGuMOsC8F1s5HjHo+1CLUABCuIFYLc7tikpunAL4Q4Deozdhja2wQ1zwOMRw7gy8eABj20Uoxxchgc5lKGM5cGj/7NnCEA3wgqAJaQUeu2gypPRUY9pbMN6AchCBhAQjAybo3tkzkA83lEAIXcvB9gQRwGkMdJKW/rSBlHGDFhHAxZRJAdV2PTnfhCGbSbkHZqgQRg0hwgXaMLTDBEGL1ywK4qsIgxJyISpDSKMZEBCD0VIxEIooQxvbCMZuy6IN6YSgGQPJAuY24ezB+IndsDCCFFUSB6mAIt3sAOLmnsGJXRBhSIAQhB9EIUXEkGIZETI0Zr7hS5IMYELXKABF6hAC5JwhC+0wZes08UXBpEEC1igAQ2oVRICAYdKKAPeklvGwI0wgYM3YAJJiMMb4MALPUw7Ictwg7lEgHFTTCEJYf9wQy9SUZOA/yEQcQDBD/KRD3f4AA598MMTaPEO1inDW4OwRCvu4Y56qAMQe2iDMnIgD9Z5IxJ9MIUlOsGJeajj6J/QxS+Y8XGD0IISezhFF7rwB3VQAQqTiESEEADuz3ljFkDvgghEYIRBKGbpzADj52ThsJfL3QVGOAIXnpAFZuRddjl4Ai5IYQkjiICYfvA4M3ouO1n8IhKCGIQRkmCJLwBi6c32nTcI0Qdz1V0QRaBc1xkiC13AwQinJwQz2o67TCjDGKUwRR+MUQ0JWO8Qn3+HhNjxiVNA7xBfqIaQx5EHTKyCeGCYAiXSSJB08IIUgsBdKwyBC9oLRBm5sLv/7MCQiDYrJBWtyASm189+9tvBDq4QBwyfMApW9CEZ7EhJ98Cwik3EYRKrYFHdkwhV8AW4kASiYAqRMDLWIwc0gAu2cAi4oAm84DmjVgV5IIHNMApnMFOy4zWbAAiH8AyowAj0MCfQowRzEAmHUAi84AhXQFCycyUCUgWZgAu5gAbGcAWuIDtEcAjAIhDJcAg/wAuVoAbV4ArsIIOh8wRy4AJBIBBnsAoX8AOb4AXGEAz7YCqs4wMQgAhX8A9nUAoXQANToARqwAhUIzsmsAoJEAZjsQs00AAFWAnGsEu4kwdxkAATcASkEAYNoGqCEAvBIADZYjqUoAaHAAEYlyuq/2aAsCAAjsI6eTAKbnAIKFcFVRAGhvAHeSAMYYg7JuAIorAKU4AIYcAKXyAKO+iBnyMOjKAGfyAKvVAKm5ALjhAMAPAxuLMP0jANxjAMgiAI0OAIsPAzy+MRrjANwwAN0MB74uCKoaM3+jANxVAMdrAW0mg6nPMK9KA3zgQ9HgGOdmM94LiN7ZeO6riO7HhpvdALgJAKNdI9QFAKq7AKqggGhQBrvvMDM2AKvsAK94gKm5AJ50A8PwADdBAGAMkKqECQmyAInOA7JFACM3AIhzAIlXBurLAJBTmRsvMDJVADh7ADEPACiZAKuXePnYA7P2ADdRAGgzAHNqAA35AKnP+QCJ1ABbjDRSUQBhipATZwBLkAADc2ALgDBh1AA3FzBKkQAhuwCalQjrKDCPl2BILgD9TQC60QDa0gYL6TCj/QAodwDgDACZsADK3ADAiwPKmQCVQQO5nQCe/Qb9XglsFEBb9QBz8gCLYAQ79ABXy5ChukQr/QCTDgCaUQDoBJBWLgCZkAkgH0C4nwmJnAmIbZCmIgB51AldDzC62gCOqQAZ65PL/wCwdAHDN0Ke3Ymq75mrAZm7ApmbhDmwSRCqdQmOFgfp9DCKigC5kGCKUADsogAnCFmQwRB3GgBxeDC6aWBctwBtzwAA1gCZFAEV0wAQ1wDNWQDJRnEAeQBZD/YAkuUJ28aRCWUHGWgAzCoHeZJgi7kJ4NcAsKUQsNIAKmIAmiAJwMkQOUwC+3cAQQkAwGkQsL0AWQMArQoCGSkwM8MwvVMAu+QhCzoAbdMA16oE3uwzq4EAeqcJ7W06ElIALQAKLLE4E0cAvpUJq+MwtWMw4BsDoq9A4ZyqIU8XV/UAqScJ9GwIsDMQopQAKBMAkv0waHyDX+VApJUAITEAi8gJwDoQzHcAQlQAeDwAVTYaL/ACBMcABwMAinIApQShCyAAldkACJEAAHACQJoQx/gAzKcABuUApaOhDGIAnHAADdoA0kVBCzIAmWwAbcAADLkAx1+n1/wAS/wAeg/0ANBaEMcKAKpoAJnZAFAKAHhzoQyaAzlPAFpkAKkGBBunEJojALT2GUR6oQlKM3utALl0CnysMMB7AM5sMzY7oQv2A+DqML72B+zMCPxMMJB7B6slmsxnqsyNqO+0AfvoMOxcANxIAMknALx9AHoHgEgzAIxxA6jNAIj0AKRxCI0hIGkjAM7JAG5UmHpvA5mNMIXeAGaeAIS3AF4tAEWfMIoGAEFjcDbyA5IoEbxMEOTMAEAssEwuAEofAIjyAJSfAsUyA5+ReF//AJgjAJdwaKrrAIefAKd3AHogAH/fo5dyAGJWAJ1BAD/yAM4mAHMWAHgLFLBksRFisQV0ADSf8wCKGwCLgzCW/AB4GABsPxD3aQbq/wCnbwOVwABsYyAzRgK4MQBIUDGOIgo/8AB1uABqJAgwQhDksjBWFQBS5QBVGAOaIACYvwBGcQA4wgCF57CHFACqJwZwkBAMGwDccACX2xD0EgCpJgBC5gAWVYBdIyGsVAD/LHEPtwDdjwCX2wFsWQBpCgsNN6CZOQBp8QC9JwBVTLEAHADoygM0zgCuswDdfAU9LQE5wTDD34OewQAK6gfzPEN8k6u7Rbu7Z7u7ibu5rTB+LAhSr0LNPAN4VgqbuoBJ+FOyKwAq9gCAYXBqUwAxVAAz8wDdhwvKxTDCFgAUlwb67TAmEwA47/kA2LKzsNsABJAHtx0AWB0AMkQAl5EwvOwDoJB3tG0AWDQApTAAaYQxw/FTrl6wIZ1wWgQAqIsARrozcWWBAAbARxMAiSgAibsL/nKDthgK2kgAmIYAwSoY11gjtTsAluoAmlQBX0cAYqEBO+AwdKoASMIBH0Cgap4AqhiDtKoAiuQBUHgAcqsAAO0AEMQDxMIA514hEBIAwU8ASfcAUJ/DlXUAFPYLfXsBYBdAbbUAWmEAoC2D2u8AoAPAmfIMXdIwClUAWaAA0trEKycAhVAAmOgDkBZAe4EAY/8AmRqEJnAAdzIAiOcMMqxAhfMAqzQDl2nMRqaqO4kxtLrLuK/7zIjBxSsLAIROIEgMkCUqAOUDANAbQFH8ACK+ACbfAJAqEGLLBQvpMBbbACK9AFXOAov7ADR+s7A5ACPAACg2ALRiQNtHANy+MNn5AMsMAEJ2UQetAGbcAIsAAFn0MLJsAOdiBXBgEASAAIPdAK5ODMC+EIjjANWSACSDEWZSEQX0ACYcADK2AIMkIR2VAEKwA0D8AEe9EXfyEMAGAMSRACIdArM7wQAXAEI8AFM9AGXnAZmbEZ7JC8UoAEUfAJqWo4gGABSqABI6AHmyAbtGEbuNEHe4AHdWYQd2DCjKAJLoAEIr0CUiAFhFAERQgd0kEd7CAPApBsDDABLSAA5P/gLCtAGVPwB0TgA+mxHu3xHuxwDbsGAJsQAl2gN8swCFMgKVJgDHpAIAaCIMagIAshDVzQBVpwAFywADCCylOQCZSgB53gISAiIiTCEOGgN1CgBUUbBVGgDFygBt7wDlwQBjiiIzwyiQnxCgLACK7gCrvIBYSwCUXwBHP9JFEyJVWitQzRD81w0mYyFkygJmziJnAiJ5rzCrLwDD4hKIQyD4aCKIqCC4yi1wvxCvQkDrSQKZvSKZ8SKl8wKqXCOgbgDbNSK7eSK7vSK7/CED4ABipQEMziLNAiLdRiLdiyEMxwBF1gouRiLuiiLl/ALu6yENOQCG0ACwmxL/3yLwFJMzAFkzmguBATUzEXkzEb0zE+yjoqwzIuAzMycwXuyTo/EzRDUzRHk8gVQTVWgzVao98vgTZqIxGbuzx4g8CyC2h1YsiN/DkBAQA7";
var e=document.createElement("canvas"),c=e.getContext("2d");b.onload=function(){e.width=33;e.height=34;for(var f=0;11>f;f++)c.drawImage(b,0,34*f,33,34,0,0,33,34),xi[f]=e.toDataURL("image/png"),a+=".ncursor"+f+"{cursor:url('"+xi[f]+"'), default}",c.clearRect(0,0,33,34);document.getElementsByTagName("style")[0].innerHTML=a};hc(2)})();var B=function(a){return document.getElementById(a)},Hd=function(a,b){B(a).style.display="block";Hd.actived=a;b.actual="potion";b.id=0;b.amount=100;b.func()};Hd.actived=
"";var X={potion:{bak:1,max:4,ord:["level","mana","attack","defence"]},sword:{bak:5,max:3,ord:["attack","attackBow","defence"]},book:{bak:8,max:18,ord:"fireRain lightning healing createCarpet createBat bless freeze confusion invisibility createGolem magicVision raiseDead turnToStone whirlpool createDragon flameBolt teach createJinn".split(" ")}};B("mgbook").onclick=function(){X.actual="book";X.id=0;X.amount=a[X.book.ord[X.id]].obj.spcost[0];X.func()};B("mgpotion").onclick=function(){X.actual="potion";
X.id=0;X.amount=100;X.func()};B("mgsword").onclick=function(){X.actual="sword";X.id=0;X.amount=100;X.func()};B("mgdecline").onclick=function(){B("magicworkshopmenu").style.display="none"};B("mgitem").onmousedown=function(f){var b=1;f.button&&(b*=-1);f=X[X.actual].max;0>X.id+b&&(X.id=f);X.id=(X.id+b)%f;"book"==X.actual&&(X.amount=a[X.book.ord[X.id]].obj.spcost[0]);X.func()};B("mgaccept").onclick=function(){ca(yi,[X.actual,X.id,parseInt(B("mgamount").innerHTML)],H[0])};var yi=function(a,b){b=y[b];var f=
a[2],c=[f,0,0,0];Va.paypal(c)||(f=~~(250*f),"book"==a[0]&&(f*=2),b.setupINTV(zi,[a,b.id],f),b.lcost=c,b.techStart=b.c-u.cycle,aa(b.id)&&(B("magicworkshopmenu").style.display="none"))},tk={defence:6,mana:0,level:2,health:1,attack:5},uk={attack:"sword",attackBow:"bow",defence:"shield"},vk={attack:.5,mana:1,defence:.5,level:.2},zi=function(f){var b=y[f[1]],e=f[0][0],c=X[e].ord[f[0][1]];f=f[0][2];b.lcost=void 0;"sword"==e&&(e=uk[c]);"attackBow"==c&&(c="attack");e=Object.assign({},Kb[e]);if(e.potion)e.d=
tk[c],e[c]=~~(f*vk[c]);else if(e.book){var d=a[c],h=d.obj;e.spell=c;e.attack=~~(f/h.spcost[0]);e.name=h.name;e.iconID=d.iconIDbook}else e[c]=~~(.25*f),250<e[c]&&(e[c]=250);M(e);wc(52,b,!0,e);b.techStart=void 0;aa(b.id)};B("mgamount").onmousedown=function(f){var b=10;"book"==X.actual&&(b=a[X.book.ord[X.id]].obj.spcost[0]);var e=b;f.button&&(b*=-1);cb.shift&&(b*=5);X.amount+=b;0>=X.amount&&(X.amount=e);B("mgamount").innerHTML=X.amount};X.func=function(){B("mgitem").style.backgroundPositionY=-48*(X.id+
X[X.actual].bak)+"px";B("mgamount").innerHTML=X.amount};var Ve=[0,0,0,0,0,0,0,0],ob,Pc,Ia=[document.getElementById("order1"),document.getElementById("order2"),document.getElementById("order3"),document.getElementById("order4"),document.getElementById("order5"),document.getElementById("order6"),document.getElementById("order7"),document.getElementById("order8")],Ai=document.getElementById("bottominfo"),We=Ia[0],Xe=Ia[1],Ye=Ia[2],Ze=Ia[3],$e=Ia[4],af=Ia[5],bf=Ia[6],cf=Ia[7];We.addEventListener("mousedown",
function(){We.style.transform="translate(2px,2px)"});Xe.addEventListener("mousedown",function(){Xe.style.transform="translate(2px,2px)"});Ye.addEventListener("mousedown",function(){Ye.style.transform="translate(2px,2px)"});Ze.addEventListener("mousedown",function(){Ze.style.transform="translate(2px,2px)"});$e.addEventListener("mousedown",function(){$e.style.transform="translate(2px,2px)"});af.addEventListener("mousedown",function(){af.style.transform="translate(2px,2px)"});bf.addEventListener("mousedown",
function(){bf.style.transform="translate(2px,2px)"});cf.addEventListener("mousedown",function(){cf.style.transform="translate(2px,2px)"});We.addEventListener("mouseup",function(a){ob=a.button;pb(0)});Xe.addEventListener("mouseup",function(a){ob=a.button;pb(1)});Ye.addEventListener("mouseup",function(a){ob=a.button;pb(2)});Ze.addEventListener("mouseup",function(a){ob=a.button;pb(3)});$e.addEventListener("mouseup",function(a){ob=a.button;pb(4)});af.addEventListener("mouseup",function(a){ob=a.button;
pb(5)});bf.addEventListener("mouseup",function(a){ob=a.button;pb(6)});cf.addEventListener("mouseup",function(a){ob=a.button;pb(7)});document.getElementById("stock").addEventListener("click",function(a){Bi(y[H[0]])});var Bi=function(a,b){if(0==S.stockActive||b){if(b=a.inventory,b.length){var f=[];f.length=b.length;for(var c=0,d=b.length;c<d;f[c]=y[b[c++]]);ka(f,a,1)}}else ka(a.icons,a)};(function(){for(var a={},b=0,e=Ia.length;b<e;a={l:a.l},b++)a.l=b,Ia[b].addEventListener("mouseenter",function(b){return function(){var a=
S.displayed[b.l],c=y[H[0]];if(c&&c.kingdom)var f=K[c.kingdom];if(a){if(void 0!==a.unit){c=w[a.unit];var e={name:c.name,cost:Lh(c.cost,a.hero||a.merc,f.values.fameTech)}}else e=a.obj;S.stockActive&&Ac(S.active[b.l].id,1,1);if(e&&e.name){var g=e.name;c="<span>";c=2==g.length?c+(g[0]+" - "+g[1]):c+g;if(g=e.cost){!e.tech&&f.mod[e.type]&&f.mod[e.type].cost&&(g=f.mod[e.type].cost);c+=" - (";for(f=0;5>f;f++)g[f]&&(c+=g[f]+"<img class='resource' src='"+wk[f]+"' /> ");c=c.substring(0,c.length-1);c+=")"}c+=
"</span>";K[y[H[0]].kingdom].technology.disabled[a.id]&&(c+="<span class='red'>"+A.requires+": "+a.require+"</span>");e.type==kb&&(c+="<span class='increase'>+"+e.increase+"</span>");(f=df[y[H[0]].strID])&&f[a.objName]&&(c+="<span class='shotcut'>"+f[a.objName].toLocaleUpperCase()+"</span>");Ai.innerHTML=c}}}}(a)),Ia[b].addEventListener("mouseout",function(){S.stockActive&&Ac(H[0],1,1);Ai.innerHTML=""})})();var Ci=function(){history.pushState("",document.title,window.location.pathname)},Bc=function(){u.online=
0;location.hash="";B("MatchX").style.display="none";document.getElementById("index").style.display="block";document.getElementById("returnmenu").style.display="none";document.getElementById("game").style.display="none";document.getElementById("chat").style.display="none";document.getElementById("gameFinish").style.display="none";setTimeout(Ci,200)},pb=function(f){var b=Ve[f];pb.lastFunc=b;pb.nu=f;if(S.stockActive){b=y[H[0]];var e=y[b.inventory[f]];e&&(e.potion?cb.control?ca(Fd,b.id,[b.id,e.id]):(L=
Fd,L.item=e.id):e.spell?cb.control&&b.mana?ca(ji,b.id,e.id):(a[e.spell](),L.item=e.id):(ca(Uc,b.id,[e.id]),aa(b.id)))}else b&&b();pb.lastFunc=void 0;pb.nu=void 0;Ia[f].style.transform=""},eh=function(a){var b=[.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.27,.3,1,.5,.5,.5,1,.62,.62,.62,1,.74,.74,.74,1,.3+.58,.3+.58,.3+.58,1,.94,.94,.94,1,1,1,1,1,1.06,1.06,1.06,1,.3+.82,.3+.82,.3+.82,1,1.08,1.08,1.08,1,1.04,1.04,1.04,1,1,1,1,1,.95,.95,.95,1,.3+.58,.8,.7,1,.3+.54,.72,.6,1,.7,.62,.5,
1,.6,.55,.3+.15,1,.5,.44,.42,1,.4,.37,.35,1],f=new Date;null!=a&&(f=a);a=f.getMinutes()/60;f=f.getHours();document.getElementById("daynighticon").style.backgroundPosition="0 -"+36*f+"px";var c=[b[4*f],b[4*f+1],b[4*f+2],b[4*f+3]];f=(f+1)%24*4;c[0]+=(-c[0]+b[f])*a;c[1]+=(-c[1]+b[f+1])*a;c[2]+=(-c[2]+b[f+2])*a;c[3]+=(-c[3]+b[f+3])*a;return c},gb=0,rb=0,Cc=0,Dc=0,jd=function(a,b){var f=tzar.width,c=tzar.height,d=z.mx/32;a/=32;b/=32;var h=ba*f*.03125,l=ba*c*.03125,g=.03125*f,k=.03125*c,m=a+.5*(g-h),n=
b+.5*(k-l);0>m?a=.5*-(g-h):m+h-d*ba>x&&(a=x-h-.5*(g-h)+d*ba);0>n?b=.5*-(k-l):n+l>la&&(b=la-l-.5*(k-l));h-z.mx>x&&(ba=x/(.03125*f),M(ba));l>la&&(ba=la/(.03125*c),M(ba));gb=32*-a;rb=32*-b},lc=document.getElementById("minimap"),ef=function(a){var b=a.pageX-parseInt(lc.style.left);a=a.pageY-parseInt(lc.style.top);var f=tzar.height*$a/(32*la);b=~~(.5+(b-tzar.width*Tb/(32*x)*.5)*x/Tb);a=~~(.5+(a-.5*f)*la/$a);jd(32*b,32*a);0==Pc&&document.removeEventListener("mousemove",ef)};lc.addEventListener("mousedown",
function(a){var b=a.pageX-4,f=a.pageY-31;0==a.button?(document.addEventListener("mouseup",function h(b){document.removeEventListener("mouseup",h);document.removeEventListener("mousemove",ef)}),Pc=!0,ef(a),document.addEventListener("mousemove",ef)):2==a.button&&(b=~~(x*(a.pageX-4)/Tb),f=~~(la*(a.pageY-31)/$a),ca(xb,b+f*x,H))});var cb={control:0,shift:0,esc:0},oa=function(f,b){if(f&&1==H.length){if(f=S.active)f=f.menuName;b=xk[b];if(f=df[f])f=a[f[b]],-1!==S.active.indexOf(f)&&(b=Va.technology,ob=0,
b.disabled[f.id]||b.hidden[f.id]||f())}},Bb={37:function(a){Cc=a},40:function(a){Dc=-a},39:function(a){Cc=-a},38:function(a){Dc=a},32:function(a){ui=a?mk:function(){}},46:function(a){a||ca(Id,cb.shift,H.slice(0))},16:function(a){cb.shift=a},17:function(a){cb.control=a},27:function(a){cb.esc=a},13:function(a){a&&!u.editor&&("displaynone"==yg.className?(yg.className="displayblock",zg.focus(),Bb.blocked=13):(Ag(),yg.className="displaynone",Bb.blocked=null))},19:function(a){a||u.online||nb(1)},48:function(a){a&&
cb.control&&(ba=1,xf({deltaY:0}))},176:function(a){a&&(u.deltaTime+=3E4)},65:oa,66:oa,67:oa,68:oa,69:oa,70:oa,71:oa,72:oa,73:oa,74:oa,75:oa,76:oa,77:oa,78:oa,79:oa,80:oa,81:oa,82:oa,83:oa,84:oa,85:oa,86:oa,87:oa,88:oa,89:oa,90:oa},xk={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z"};Bb.blocked=null;(function(){for(var a=[65,37,40,83,39,68,38,87],b=a.length=0,e=a.length;b<
e;b+=2)Bb[a[b]]=Bb[a[b+1]]})();window.addEventListener("beforeunload",function(a){z.admin&&Di();return null});document.oncontextmenu=function(){return!1};var Nb=document.getElementById("attackmenu"),Ec=document.getElementById("defencemenu"),Fc=document.getElementById("levelmenu"),$c=document.getElementById("kingdom"),Ka=document.getElementById("progressone"),ff=document.getElementById("unitname"),jc=document.getElementById("progressvalue");document.getElementById("selectedobject");var Id=function(a,
b){if(b.length){a=a||u.editor?b.length:1;for(var f=0;f<a;f++)y[b[f]].die()}},Ha=function(f,b){f.sound&&!b&&(b=f.sound,xa(b[~~(b.length*Math.random())]));Fc.style.display="none";Jd.style.display="none";$c.style.display="block";Ka.style.display="block";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";Ec.style.display="none";ff.innerHTML=f.name;Kd(f);$c.innerHTML=K[f.kingdom].name;f.attack?(Nb.style.display="block",Nb.innerHTML=f.attack):Nb.style.display=
"none";b=f.health;var e=f.maxHealth;Infinity==b?(Ka.value=100,Ka.max=100,jc.innerHTML=b):Ka.value=b;Infinity==e&&Infinity!=b?(Ka.max=100,Ka.value=1):Infinity!==e&&(Ka.max=e);f.inventory&&f.inventory.length&&(manamenu1.style.display="block",manamenu1.style.backgroundPosition="0px -80px",manamenu1.innerHTML=f.inventory.length);jc.innerHTML=~~b+"/"+e;if(!Ob(f,z))return ka([]);f.point&&(b=f.point,Ea.x32=b[0],Ea.y32=b[1],ObjectsetupPosition(Ea,96*(la-1)),Ea.show=1);if(!1===f.built)ka([a.stopBuilding]),
Kd(f);else if(f.techStart)ka([a.stopTech]),Kd(f),manamenu.style.display="block",manamenu.style.backgroundPosition="0px -200px",manamenu.innerHTML=100-~~(100*(f.c-u.cycle)/f.techStart)+"%",Ha.intv&&clearInterval(Ha.intv),Ha.intv=setInterval(function(){H[0]==f.id?manamenu.innerHTML=100-~~(100*(f.c-u.cycle)/f.techStart)+"%":clearInterval(Ha.intv)},400);else{vj();if(f.working){e=f.work;var c=S.page*S.length;b=0;for(var d=S.length;b<d;b++){var h=e[b+c];Ia[b].innerHTML=h?h:""}manamenu.style.display="block";
manamenu.style.backgroundPosition="0px -200px";var l=1E3*w[f.waitlist[0]].time;b=~~(100*(u.now()-f.timestamp)/l);100<b&&(b=100);manamenu.innerHTML=b+"%";Ha.intv&&clearInterval(Ha.intv);Ha.intv=setInterval(function(){if(H[0]==f.id&&f.working){var b=~~(100*(u.now()-f.timestamp)/l);100<b&&(b=100);manamenu.innerHTML=b+"%"}else clearInterval(Ha.intv)},400)}else for(b=0,e=S.length;b<e;Ia[b++].innerHTML="");ka(f.icons,f)}};Ha.intv=!1;var Ld=function(){Nb.style.display="none";Ec.style.display="none";Fc.style.display=
"none";Ka.style.display="none";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";ff.innerHTML="";Nb.innerHTML="";Ec.innerHTML="";manamenu.innerHTML="";Fc.innerHTML="";$c.innerHTML="";jc.innerHTML="";Ka.value="";jc.maxLength="";Jd.style.display="none";gf();Ei()},L,Pa,Pb,xf,Qb={},dg=function(a,b,e){var c=e||y[H[0]];if("peon"==(e?c.clss:Pb))var f=!0;if(u.editor)return[jb,h];var h=a+b*x;if(L!=jb)return[L,h];a=R[h];b=0;if(!c)return[b,h];if(2<a||(a=Gc[h])&&2<
a){var l=y[a];l.invisible||(f&&l.storage&&c.stock?b=og:f&&void 0!=l.res?b=Ad:f&&l.health<l.maxHealth&&!Va.diplomacy[l.kingdom]&&l.build&&!l.dummy||l.dummy&&!l.built?b=Vc:Va.diplomacy[l.kingdom]||l.dummy&&Va.values.experience?b=qc:1===l.invType&&!c.build&&!c.boat&&0<l.invMax&&Ob(c,l)&&(b=xd))}else a=ra[h],2<a&&!c.build&&!c.boat&&(l=y[a],l.item?b=Tc:l.field&&f?b=qe:1===l.invType&&!c.build&&!c.boat&&0<l.invMax&&Ob(c,l)&&(b=xd));0===b&&(c=qb[z.kingdom],c[h]&&f?(a=c[h],b=Vc):(l||(a=-h),b=xb,xb.cursor=
2));return[b,a]},H=[];H.change=1;var Fi,pk=document.getElementById("gold"),qk=document.getElementById("wood"),rk=document.getElementById("food"),sk=document.getElementById("stone"),fa,Bg;var Cg=!1;var Lb=function(a,b){var f=ba,c=tzar.width,d=tzar.height;a=a*f-gb+.5*(c-f*c);b=b*f-rb+.5*(d-f*d);return[a,b]},sb=function(a){if(a){var b=a.pageX;a=a.pageY;sb.lastX=b;sb.lastY=a}else b=sb.lastX,a=sb.lastY;b=Lb(b-z.mx,a);a=b[1];b=b[0];0==Cg?(window.removeEventListener("mousemove",sb),Bg=!1):Bg=!0;if(1===fa[2]||
sb.forced)a=32*~~(a/32),b=32*~~(b/32);fa[4]=a;fa[6]=b;fa[9]=b;fa[10]=a},Gi=function(a,b){b=y[b];R[a[0]+a[1]*x]==b.id?(b.point=void 0,H[0]==b.id&&(Ea.x32=2*x,ObjectsetupPosition(Ea,128*x),Ea.show=0)):(b.point=a,Ea.x32=a[0],Ea.y32=a[1],H[0]==b.id&&(ObjectsetupPosition(Ea,96*(la-1)),Ea.show=1))},Hi=function(a){if(null==Bb.blocked||Bb.blocked==a.keyCode){var b=Bb[a.keyCode];M(a.keyCode);b&&b(1,a.keyCode)}},Ii=function(a){if(null==Bb.blocked||Bb.blocked==a.keyCode){var b=Bb[a.keyCode];b&&b(0,a.keyCode)}},
Ji=function(a){var b=window.innerWidth,f=window.innerHeight,c=a.pageX,d=a.pageY;if(screen.height-10<=f){if(1.2==Math.abs(Cc)||0==Cc)Cc=1.2*((10>c)-(c>b-10));if(1.2==Math.abs(Dc)||0==Dc)Dc=1.2*((10>d)-(d>f-10))}c=Lb(c-z.mx,d);d=~~(.03125*c[1]);c=~~(.03125*c[0]);a.pageX<z.mx?hc(2):(a=dg(c,d)[0],0==a||void 0==a.cursor?hc(2):hc(a.cursor))},Ki=function(a){if(a.pageX>z.menumx){if(0==a.button){window.addEventListener("mousemove",sb);a=Lb(a.pageX-z.mx,a.pageY);var b=a[1];a=a[0];void 0!=da.wall&&(a=da.wall,
b=32*~~(a/x),a=a%x*32,sb.forced=!0,da.wall=void 0);Cg=!0;fa[0]=a;fa[1]=b;fa[9]=fa[0];fa[10]=fa[1];fa[3]=fa[0];fa[7]=fa[1];hf=!1}}else hf=!0},hf=!1,yk=function(a){if(a.pageX>z.menumx&&a.pageY>z.menumy&&!Pc&&0==hf){Cg=!1;var b=Lb(a.pageX-z.mx,a.pageY),f=~~(b[1]/32);b=~~(b[0]/32);M(b,f);var c=la;if(2==a.button&&!u.editor){if(L!=jb){L=jb;return}if(0<H.length)if(c=y[H[0]],1!=c.build||c.arrow){if(0===L){L=jb;return}c=dg(b,f);a=c[1];c=c[0];c==xb&&(b={x32:b,y32:f,d:0,mv:1,img:k.cursor},Sa(b),yb.new(b,Ta(b.img)));
ca(c,a,H)}else ca(Gi,[b,f],H[0]);return!1}if(0==a.button){if(L==jb)return jb();a=b+f*c;if(L.spLevel)a=L.spLevel(a);else{var d=0;2<Gc[a]?d=Gc[a]:2<R[a]?d=R[a]:2<ra[a]&&(d=ra[a]);a=d}if(a)L.allowPos&&y[a].build&&(a=-(b+f*c));else if(L.allowPos||L.noObj)a=-(b+f*c);else return L=jb;L.noObj&&3<=a&&(a=-(b+f*c));L.item?(ca(L,a,[H[0],L.item]),L.item=void 0):ca(L,a,H);cb.shift||(L=jb)}}hf=!1},Li=function(a){yk(a);fa[0]=NaN;fa[1]=NaN;fa[9]=NaN;fa[10]=NaN;fa[3]=NaN;fa[7]=NaN;g.bindBuffer(g.ARRAY_BUFFER,Sb);
g.bufferSubData(g.ARRAY_BUFFER,0,fa);Pc&&(Pc=!1)},Mi=function(a){a=y[a];a.tempChild.quit(a.selectAnim);vb(a.selectAnim);a.selectAnim=void 0},jb=function(){for(var a=0,b=H.length;a<b;Mi(H[a++]));Hd.actived&&(B(Hd.actived).style.display="none");Pa&&(Mi(Pa.id),Pa=void 0);H.length=0;Pb=-1;Qb={};Jd.style.display="none";We.innerHTML="";Xe.innerHTML="";Ye.innerHTML="";Ze.innerHTML="";$e.innerHTML="";af.innerHTML="";bf.innerHTML="";cf.innerHTML="";Nb.className="";S.page=0;Ea.show&&(Ea.x32=2*x,ObjectsetupPosition(Ea,
128*x),Ea.show=0);var e=x,c=fa[0],d=fa[1];a=fa[9];var h=fa[10];if(0===d-h&&0===c-a){h=~~(c/32);var l=~~(d/32),g=d,k=c,m=0;for(a=0;3>a;a++){b=Ua[a];var n=h,q=l;c=k;d=g;2<b[n+q*e]?(c=n,d=q,m=y[b[c+d*e]]):(.5<=d/32-q?q++:q--,2<b[n+q*e]?(c=n,d=q,m=y[b[c+d*e]]):(.5<=c/32-n?n++:n--,2<b[n+q*e]?(c=n,d=q,m=y[b[c+d*e]]):(q=~~(d/32),2<b[n+q*e]&&(c=n,d=q,m=y[b[c+d*e]]))))}m.id||(m=qb[z.kingdom][h+l*e])&&(m=y[m]);if(m&&2<m.id&&(!m.invisible||Ob(m,z)))if(Qb[m.id]=1,H.length=0,m.setupChild(Ab.select,1,Wd),Ob(m,
z)&&!u.demo){H[0]=m.id;Pb=null!=m.defence?m.clss:-2;if(m.build)return Ha(m);if(256>Date.now()-Fi)for(e=~~(ba*tzar.width*.03125),c=~~(ba*tzar.height*.03125),h=~~(.03125*-gb+.5*(~~(.03125*tzar.width)-e)),g=~~(.03125*-rb+.5*(~~(.03125*tzar.height)-c)),c*=e,h+=g*x,a=0;a<c;a++)for(d=h+a%e+~~(a/e)*x,l=0;3>l;l++)g=Ua[l][d],2<g&&(k=y[g],k.clss!=m.clss||Qb[g]||!Ob(k,m)||k.item||(k.setupChild(Ab.select,1,Wd),Qb[g]=1,H.put(g)));Fi=Date.now()}else return Pa=m,Ac(m.id),!1}else if(!u.demo)for(c=~~(c/32),a=~~(a/
32),d=~~(d/32),h=~~(h/32),c>=a&&(m=c,c=a,a=m),d>=h&&(m=d,d=h,h=m),a++,m=[1,1,1],k=a-c,a=0,b=k*(h-d+1);a<b;a++)for(h=a%k+c,g=~~(a/k)+d,l=0;3>l;l++)n=Ua[l][h+g*e],q=y[n],q.selected=1,m[n]||(m[n]=1,q.build||!Ob(q,z)||q.item||(H[H.length]=n,q.setupChild(Ab.select,1,Wd),Qb[n]=1));1<H.length?Dg(H):1==H.length?Ac(H[0]):(ka([]),Ld(),Pb=-1,H.length=0)},Ni=[manamenu,manamenu1],Oi={mana:{background:"0px -120px",progress:progressmana},food:{background:"0px -240px"},milk:{background:"0px -280px"},gold:{background:"0px -260px"},
stone:{background:"0px -320px"},wood:{background:"0px -340px"}},wk=["https://i.imgur.com/toj2Nv3.gif","https://i.imgur.com/TwImKWn.gif","https://i.imgur.com/wFIu276.gif","https://i.imgur.com/kIWwIhG.gif","https://i.imgur.com/JBGA2KM.gif"],Jd=document.getElementById("unitSpeed"),Ac=function(a,b,e){manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";a=y[a];a.sound&&!e&&(e=a.sound,xa(e[~~(e.length*Math.random())]));Pb=a.clss;a.inventory&&a.inventory.length&&
Ob(a,z)&&(manamenu1.style.display="block",manamenu1.style.backgroundPosition="0px -80px",manamenu1.innerHTML=a.inventory.length);b||(Ob(a,z)&&!u.demo?ka(a.icons,a):gf());$c.style.display="block";ff.innerHTML=a.name;a.attack&&a.item||void 0!==a.attack?(Nb.innerHTML=a.attack,Nb.style.display="block"):Nb.style.display="none";a.defence&&a.item||void 0!==a.defence?(Ec.innerHTML=a.defence,Ec.style.display="block"):Ec.style.display="none";a.mana&&!a.manaTarget&&(manamenu.style.display="block",manamenu.innerHTML=
a.mana,manamenu.style.backgroundPosition="0px -120px");b=0;var c=a.update;if(c){b=0;for(var f=c.length;b<f;b+=3){var h=c[b],l=Oi[h];e=Ni[b/3];e.innerHTML=a[h];e.style.display="block";e.style.backgroundPosition=l.background;"mana"==h&&a.manaTarget&&(e.innerHTML=~~(100*a.mana/a.manaTarget+.5)+"%",e.style.backgroundPosition="0px -200px");l.progress&&(l.progress.style.display="block",l.progress.value=a[h],l.progress.max=a[h+"Max"])}}a.stock&&(c=a.stock,e=Ni[b/3],e.style.display="block",e.style.backgroundPosition=
Oi[c[4].icon].background,e.innerHTML=c[0]);b=a.level?a.level:0;Fc.innerHTML=b;Fc.style.display="block";0===b&&(a.item||a.build)&&(Fc.style.display="none");$c.innerHTML=K[a.kingdom].name;Ka.style.display="block";Pi(a);Kd(a)},Pi=function(a){var b=a.health;a=a.maxHealth;Infinity==b?(Ka.value=100,Ka.max=100,jc.innerHTML=b):(Ka.value=b,Infinity==a?(Ka.max=100,Ka.value=1):Ka.max=a,jc.innerHTML=~~b+"/"+a)},Dg=function(a,b){for(var f=y[a[0]],c=0,d=0,h=f.clss,l=a.length,g={},k=[],m=0;m<l;m++){f=y[a[m]];c+=
f.maxHealth;d+=f.health;Pb=h!=f.clss?-1:!0;for(var n=f.icons,q=n.length,r=0;r<q;r++){var u=n[r].id;void 0===g[u]?g[u]=1:g[u]++;g[u]===l&&k.put(n[r])}}!0===Pb&&(Pb=f.clss);d=Infinity==d?100:~~(d/c*100);jc.innerHTML=d+"/100(%)";Qi();ff.innerHTML="";Nb.style.display="none";Ec.style.display="none";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";Fc.style.display="none";$c.innerHTML=l+" "+A.units;Ka.style.display="block";Ka.value=d;Ka.max=100;b||(!0!==Pb?ka(k):
ka(f.icons))},dh=function(){};new Float32Array(8);var Ya,Nc,Sb,kd,hd,ba=1,zk=function(a){vb(a);Zb.put(a.bufferID)},yb={table:{},dates:[],new:function(a,b,e){b=Math.floor(b)+u.now();var c=this.table;e||(e=zk);c[b]||(c[b]=[]);a.animFunc=e;c[b].put(a);this.dates.add(b);this.needOrder=!0}},Ta=function(a){a=ta[a];return 0>a[1]?k.delay[a[0]-a[1]-1]:a[0]/a[1]*1E3},sa=new Float32Array(12),cg=function(a){var b=a.id+u.arje+a.x32+a.y32;a.rnd=[4294967295+b,4294967295-b,0]},Eg=function(a){a=y[a];a.mlist&&Ri(a,
!0);a.hlist&&Ri(a,!1)},Ri=function(a,b){if(b)var f=a.mlist,c=a.mlistID,d=ad.mercenaries;else f=a.hlist,c=a.hlistID,d=ad.heroes;f.unshift(d[Ph(a,d.length)]);b?c.unshift(a.mercID++):c.unshift(a.heroID++);8<f.length&&(f.length=8,c.length=8);S.active==f&&ka(f);mb(a,5E4)},Fg=function(f){f=y[f];var b=K[f.kingdom],e=16+4*b.crusade.number;b.crusade.number++;32<e&&(e=32);var c=b.crusade.list;c.length=e;for(var d=0;d<e;d++)(c[d]=wc(8,f,1)).deleteFromList=c;xa("crusade",f.x32,f.y32);b.technology.disabled[a.createCrusaders.id]=
1;aa(f.id)},nk=function(f){K[f.kingdom].technology.disabled[a.createCrusaders.id]=0},Oc,R=[],ra=[],Gc=[],Ua=[];Ua.length=3;var gf=function(){for(var a=S.displayed.length=0,b=S.length;a<b;a++){var e=Ia[a];e.className="blocked";e.style.backgroundPosition="48px 96px";Ve[a]=Gg}S.rightButton.className="blocked";S.leftButton.className="blocked";S.stock.className="blocked";S.rightBlocked=1};S.leftButton.onclick=function(){S.page&&(S.page--,ka(S.active,0,S.stockActive))};S.rightButton.onclick=function(){S.rightBlocked||
(S.page++,ka(S.active,0,S.stockActive))};S.displayed=[];var ka=function(a,b,e){e=!!e;b||(b=NaN);var c=a.olegal||NaN;if(b.working&&!e)var f=1;S.active=a;S.displayed.length=0;var h=Va.technology,l=S.page,g=S.length;gf();!1!==e&&b?S.stockActive=b:!1===e&&(S.stockActive=!1);ka.actv={};a.length<=l*g&&a.length&&(S.page--,l--);for(var k=0,m=0,n;k<g;k++){n=a[k+l*g];if(!n)break;var q=Ia[m];if(!e&&(ka.actv[n.id]=1,h.hidden[n.id]||n.obj.tech&&f)){g++;continue}q.style.backgroundPosition=48*e+"px "+(-e||1)*n.iconID*
48+"px";e||!h.disabled[n.id]||c[n.id]?(q.className="",Ve[m]=n):q.className="blocked";S.displayed[m]=n;m++}a[k+l*g]&&(S.rightButton.className="",S.rightBlocked=0);0<l&&(S.leftButton.className="");1===H.length&&(b=y[H[0]]);b.inventory&&0<b.inventory.length&&(S.stock.className="")};ka.actv={};var ch,Z,ma,yf;var g=document.getElementById("tzar").getContext("webgl2",{antialias:!0,alpha:!1});z.gl=!!g;if(g){var Ak=g.getExtension("WEBGL_lose_context");g.canvas.addEventListener("webglcontextlost",function(a){setTimeout(function(){Ak.restoreContext()},
2E3);a.preventDefault()},!1);g.canvas.addEventListener("webglcontextrestored",function(a){M("restored 2")},!1)}var bh,zf,Af,fh,Td,sf,rf,Sd,Ud,id,gd,Mc,tf,uf,Za=function(){if(u.canceled)return 0;requestAnimationFrame(Za);var a=Za.fp1000,b=Za.delta,e=Za.now,c=Za.frameCount;performance.now();var d=e;Za.frameCount++;e=u.now();Za.now=e;b=(b+(e-d))/1E3;Za.delta=b;if(!(c%8||u.editor)){c=u.now()/1E3;d=~~(c/60)%60;var h=~~(c/3600);c=~~(c%60);B("topinfo").innerHTML=~~(1/b)+"fps "+h+":"+d+":"+c}Za.fp1000=a+
b;a=yb.table;c=yb.dates;yb.needOrder&&(c.sort(function(a,b){return a-b}),yb.needOrder=0);for(d=0;c[d]<=e+17;d++){h=a[c[d]];for(var l=0,k=h.length;l<k;l++){var p=h[l];p.animFunc(p)}delete a[c[d]];d--;c.shift()}if(0!=Cc||0!=Dc)gb+=Cc*b*640*ba,rb+=Dc*b*640*ba,jd(-gb,-rb),sb();ui(e);dh();g.uniform1f(bh,e);g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT);if(b=Aa.length)g.bindFramebuffer(g.FRAMEBUFFER,fb),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,fh),d=Aa,d.changed&&(d.typed=new Uint32Array(d),d.changed=!1,g.bufferData(g.ELEMENT_ARRAY_BUFFER,
d.typed,g.STATIC_DRAW)),g.enable(g.BLEND),g.blendEquation(g.MAX),g.blendFunc(g.SRC_COLOR,g.SRC_COLOR),g.bindTexture(g.TEXTURE_2D,yf),g.drawElements(g.TRIANGLES,b,g.UNSIGNED_INT,0),g.bindTexture(g.TEXTURE_2D,Lighttexture),g.disable(g.BLEND),g.bindFramebuffer(g.FRAMEBUFFER,null);Si(zf);a=window.innerWidth;c=window.innerHeight;g.viewport(z.marx,c-$a-z.mary,Tb,$a);g.uniform2f(Td,32*x,32*la);g.uniform2fv(id,[0,0]);g.uniform1i(Ud,1);g.uniform1f(Oc,1);Si(zf);g.viewport(z.mx,0,a,c);performance.now();g.useProgram(ma);
g.bindVertexArray(tf);g.uniform1f(sf,~~((.01*e+.5)%5));g.drawArrays(g.TRIANGLES,0,6);g.viewport(z.marx,c-$a-z.mary,Tb,$a);g.uniform1i(Sd,1);g.uniform2fv(gd,[0,0]);g.uniform1f(Mc,4/x);g.drawArrays(g.TRIANGLES,0,6);g.uniform1i(Sd,0);g.uniform2f(rf,a,c);g.uniform2fv(gd,[gb,rb]);g.uniform1f(Mc,1/ba);g.viewport(z.mx,0,a,c);g.useProgram(Z);g.bindVertexArray(uf);if(b=ha.length)g.enable(g.BLEND),g.blendEquation(g.FUNC_ADD),g.blendFunc(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA),g.bindBuffer(g.ARRAY_BUFFER,Sb),a=tzar.width,
c=tzar.height,e=-gb+.5*(a-ba*a),d=-rb+.5*(c-ba*c),h=ba*(a-z.mx),l=ba*c,g.bufferSubData(g.ARRAY_BUFFER,0,new Float32Array([e,d,24576,e+h,d,24576,e,d+l,24576,e+h,d+l,24576])),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,Af),d=ha,d.changed&&(d.typed=new Uint32Array(d),d.changed=!1,g.bufferData(g.ELEMENT_ARRAY_BUFFER,d.typed,g.STATIC_DRAW)),g.viewport(z.marx,c-$a-z.mary,Tb,$a),g.drawElements(g.TRIANGLES,12,g.UNSIGNED_INT,0),g.uniform1i(Ud,0),g.uniform2f(Td,a,c),g.uniform2fv(id,[gb,rb]),g.uniform1f(Oc,1/ba),g.viewport(z.mx,
0,a,c),g.bindBuffer(g.ARRAY_BUFFER,Sb),Bg&&!Hg?g.bufferSubData(g.ARRAY_BUFFER,0,fa):g.bufferSubData(g.ARRAY_BUFFER,0,new Float32Array([NaN,NaN,24576,NaN,4347,24576,5551,NaN,24576,NaN,NaN,24576])),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,Af),d=ha,d.changed&&(d.typed=new Uint32Array(d),d.changed=!1,g.bufferData(g.ELEMENT_ARRAY_BUFFER,d.typed,g.STATIC_DRAW)),g.drawElements(g.TRIANGLES,b,g.UNSIGNED_INT,0),g.disable(g.BLEND);da.active&&(e=da.x,d=da.y,b=96*x,sa[0]=e,sa[1]=d,sa[2]=b,sa[3]=e,sa[4]=d,sa[5]=b,sa[6]=
e,sa[7]=d,sa[8]=b,sa[9]=e,sa[10]=d,sa[11]=b,e=da.bufferID,g.bindBuffer(g.ARRAY_BUFFER,Sb),g.bufferSubData(g.ARRAY_BUFFER,12*e,sa),da.active=!1)},Si=function(a){var b=pa.length;b&&(g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,a),a=pa,a.changed&&(a.typed=new Uint32Array(a),a.changed=!1,g.bufferData(g.ELEMENT_ARRAY_BUFFER,a.typed,g.STATIC_DRAW)),g.drawElements(g.TRIANGLES,b,g.UNSIGNED_INT,0))},ed=!1,qa=function(a,b){return a<x&&0<=a&&0<=b&&b<la?!0:!1};Array.prototype.put=function(a){this[this.length]=a};var Gg=
function(){},Ab,Md,Kb,Ig,Hc=function(a,b,e,c){c&&0==Hc.cols[c]&&(Hc.list.push(c,a),Hc.cols[c]=1)};Hc.cols={};Hc.list=[];window.onerror=Hc;var u={},ta=[],Bk=function(a,b,e,c){for(var f=0,h=Object.keys(a),l=0,g=h.length;l<g;l++){var k=h[l],m=a[k];if(Array.isArray(m)){a[k]=f;m.url=f;k=ta[f++]=m;var n=m.deltaY?m.deltaY:0;k.id=c/4;for(var q=6,r=k.length;q<r;q+=6){var u=k[q-2],v=k[q-1],w=k[q+2],x=k[q+3];b[c++]=k[q]/e;b[c++]=(n+k[q+1])/e;b[c++]=u;b[c++]=v;b[c++]=(k[q]+w)/e;b[c++]=(k[q+1]+n)/e;b[c++]=u+w;
b[c++]=v;b[c++]=k[q]/e;b[c++]=(k[q+1]+x+n)/e;b[c++]=u;b[c++]=v+x;b[c++]=(k[q]+w)/e;b[c++]=(k[q+1]+x+n)/e;b[c++]=u+w;b[c++]=v+x}}else for(var z=Object.keys(m),y=0,A=z.length;y<A;y++)for(k=m[z[y]],k.id=c/4,k.url=f,m[z[y]]=f,ta[f++]=k,n=k.deltaY?k.deltaY:0,q=6,r=k.length;q<r;q+=6)u=k[q-2],v=k[q-1],w=k[q+2],x=k[q+3],b[c++]=k[q]/e,b[c++]=(n+k[q+1])/e,b[c++]=u,b[c++]=v,b[c++]=(k[q]+w)/e,b[c++]=(k[q+1]+n)/e,b[c++]=u+w,b[c++]=v,b[c++]=k[q]/e,b[c++]=(k[q+1]+x+n)/e,b[c++]=u,b[c++]=v+x,b[c++]=(k[q]+w)/e,b[c++]=
(k[q+1]+x+n)/e,b[c++]=u+w,b[c++]=v+x}return c},T=function(a,b,e,c){var f=0,h=e.length-1,l=e[h];c=qb[c];var g=[],k=0,m=!0;qa(a,b)&&qa(a+l-1,b+h/l-1)||(m=!1);for(var n=x,q=0;q<h;q++){f==l&&(f=0,b++);if(e[q]){var r=a+f+n*b;c[r]&&(m=!1);if(0<R[r]||Mb[r])m=!1;g[k++]=r}f++}return[g,m]};T.check=function(a,b,e,c,d,h,l){var f=e.length-1;e=e[f];var g=f/e;f=x;l=qb[l];e+=2;--a;--b;g=e*(g+2);for(var k=0;k<g;k++){var n=a+k%e,q=b+~~(k/e),r=n+q*f;if(0<R[r]||Mb[r]||h&&(n>=d&&n<=d+2||q>=c&&q<=c+2)||!qa(n,q)||l[r])return!1}return!0};
var Ti=function(a,b,e){var c=0,f=e.length-1,h=e[f],l=[],g=[],k=0,m=!0;qa(a,b)&&qa(a+h-1,b+f/h-1)||(m=!1);for(var n=0,q=0;q<f;q++){c==h&&(c=0,b++);var r=a+c+x*b;e[q]?(2<R[r]&&(m=!1),l[k++]=r):(g[n++]=r,2<R[r]&&(m=!1));c++}return[l,m,g]},Ui=function(a,b,e){var c=0,f=e.length-1,h=e[f],l=[],g=0,k=!0;qa(a,b)&&qa(a+h-1,b+f/h-1)||(k=!1);for(var m=0;m<f;m++){c==h&&(c=0,b++);var n=a+c+b*x;if(e[m]&&2<R[n]&&1==y[R[n]].build||0<ra[n])k=!1;l[g++]=n;c++}return[l,k]},jf=function(a,b,e){var c=!1,f=0,h=[],l=0,g=e.length-
1,k=e[g],m=0,n=!0;qa(a,b)&&qa(a+k-1,b+g/k-1)||(n=!1);for(var q=0;q<g;q++){m==k&&(m=0,b++);if(e[q]){var r=a+m+x*b,u=R[r];2<u&&(n=!1);0<u?f++:c=!0;h[l++]=r}m++}f>.5*(g-1)&&c||(n=!1);return[h,n]},Nd=function(a,b,e){e=!0;qa(a,b)||(e=!1);1!==ra[a+b*x]&&(e=!1);return[[a+b*x],e]},Y=function(a,b,e){e=!0;qa(a,b)||(e=!1);0<R[a+b*x]&&(e=!1);return[[a+b*x],e]},kf=function(a,b,e){e=!0;qa(a,b)||(e=!1);0<Gc[a+b*x]&&(e=!1);return[[a+b*x],e]},Cb=function(a,b,e){e=!0;qa(a,b)||(e=!1);if(0<ra[a+b*x]||2==R[a+b*x]||1==
R[a+b*x])e=!1;return[[a+b*x],e]},Ck=function(a){for(var b=Object.keys(a),f=J.common.length/1048576,c=0,d=b.length;c<d;c++)a[b[c]].deltaY=512*f},da,F,Qa,ab,yj=function(){da={img:0,x32:-1E3,y32:-1E3,rgb:[0,0,0,.5],d:0,active:!1};var f=8,b=9;if(!ed){Dk();var e=[a.move,a.attack,a.guard,a.patrol,a.pickUp,a.explore,a.stop,a.stand,a.sameSpeed,a.restoreSpeed];Md={magic_creatures:[58,40,59,5,78,77,60,130,131,132,89,129]};for(var c=Object.keys(Md),d=0,h=c.length;d<h;d++){var l=Md[c[d]],g={};l.obj=g;for(var p=
0,m=l.length;p<m;g[l[p++]]=1);}ad.mercenaries=[a.mercArcher,a.mercFootman,a.mercMaceman,a.mercLongbowman,a.mercPikeman,a.mercKnight,a.mercArcherAsian,a.mercSamurai,a.mercHourseSamurai,a.mercRonin,a.mercHorseArcher,a.mercChariot,a.mercFootmanArab,a.mercArcherArab,a.mercMacemanArab,a.mercPikemanArab,a.mercCavalry,a.mercEnichar,a.mercJihad];ad.heroes=[a.mercArcher6,a.mercFootman6,a.mercMaceman6,a.mercLongbowman6,a.mercPikeman6,a.mercKnight6,a.mercArcherAsian6,a.mercSamurai6,a.mercHourseSamurai6,a.mercRonin6,
a.mercHorseArcher6,a.mercChariot6,a.mercFootmanArab6,a.mercArcherArab6,a.mercMacemanArab6,a.mercPikemanArab6,a.mercCavalry6,a.mercEnichar6,a.mercJihad6];c=ad.mercenaries;d=0;for(h=c.length;d<h;c[d++].merc=9);c=ad.heroes;d=0;for(h=c.length;d<h;c[d++].hero=1);m=k;m.build2x2[2]=1;m.build3x3[2]=1;m.build4x4[2]=1;m.build5x5[2]=1;m.build6x6[2]=1;m.items1[2]=1;m.build_harbor[2]=1;m.bridge_horz_build[2]=1;m.bridge_vert_build[2]=1;m.sexplosion[0]=13;m.sexplosion[1]=25;m.flame_trail[0]=16;m.flame_trail[1]=
25;d=0;for(p=m.flame_trail.length;d<p;d+=6)m.flame_trail[4+d]-=32,m.flame_trail[5+d]-=32;d=0;for(p=m.sexplosion.length;d<p;d+=6)m.sexplosion[4+d]-=48,m.sexplosion[5+d]-=48;m.items1[1]=0;m.books[1]=0;m.potions[1]=0;m.troll.attack[1]=14;m.ork.attack[1]=14;m.dwarf.attack[1]=14;m.asian_mage.move[1]=14;m.arab_priest.attack=m.arab_priest.spell;m.asian_mage.spell=m.asian_mage.castspell;m.asian_mage.attack=m.asian_mage.castspell;m.asian_mage.spell[1]=13;m.arab_horse_archer.move=m.arab_horse.archer;m.arab_jwarrior.attack[1]=
14;m.arab_peasant.attack=m.arab_peasant.attack1;m.arab_peasant.tree=m.arab_peasant.wood;m.asian_peasant.attack=m.asian_peasant.attack1;m.asian_peasant.cut=m.asian_peasant.chop;m.asian_peasant.tree=m.asian_peasant.wood;m.asian_peasant.dig[1]=14;m.asian_archer.die[1]=14;m.asian_ronin.attack=m.asian_ronin.attack1;d=0;for(p=m.turn_to_stone.length;d<p;d+=6)m.turn_to_stone[4+d]-=56,m.turn_to_stone[5+d]-=64;m.arab_tcguild_c[4]=31;m.arab_tcguild_c[5]=85;m.dragon.idle=m.dragon.move;m.asian_samurai.attack=
m.asian_samurai.attack1;m.asian_horsamurai.idle=m.asian_horsamurai.idle1;m.asian_horsarcher.idle=m.asian_horsarcher.idle2;m.asian_priest.attack=m.asian_priest.attack1;m.asian_priest.spell=m.asian_priest.pray;m.asian_monk.attack[1]=12;m.euro_mage.attack=m.euro_mage.spell;m.euro_ghost.idle=m.euro_ghost.move;m.euro_priest.attack=m.euro_priest.spell;m.arab_mage.spell=m.arab_mage.attack;m.cursor[1]=15;m.star[1]=15;m.select[4]+=3;m.select[5]+=3;m.arab_houses_c[f]=96;m.asia_houses_c[f]=96;m.asia_houses_c[4]-=
9;m.asia_houses_c[5]-=15;m.wood_build[2]=1;m.res_gold[2]=1;m.res_gold_s[2]=1;m.res_stone[2]=1;m.res_stone_s[2]=1;m.bridge_horz1[4]=-9;m.bridge_horz1[5]=132;m.bridge_horz1[4]=-9;m.bridge_horz1[5]=132;m.euro_stable_c[4]+=18;m.euro_stable_c[5]-=10;m.euro_lumbermill_s[4]-=19;m.euro_lumbermill_s[5]-=17;m.wood_tower_c[4]=0;m.wood_tower_c[5]*=1;m.bat.idle=m.bat.move;d=0;for(p=m.curse.length;d<p;d+=6)m.curse[5+d]-=48;d=0;for(p=m.impersonate.length;d<p;d+=6)m.impersonate[5+d]-=48;d=0;for(p=m.bless.length;d<
p;d+=6)m.bless[5+d]-=48;d=0;for(p=m.euro_barracks_c.length;d<p;d+=6)m.euro_barracks_c[4+d]+=50;d=0;for(p=m.healing.length;d<p;d+=6)m.healing[5+d]-=48;d=0;for(p=m.expl_small_hole.length;d<p;d+=6)m.expl_small_hole[4+d]-=4,m.expl_small_hole[5+d]-=34;Date.now();c=[a.createKnight,a.createHorseArcher1,a.createHorseArcher2,a.createHorseSamurai,a.createChariot,a.createEnichar,a.createCavalry]}if(Ef){Ef=!1;M("TErrain changed");d=0;for(h=J.xtra.length;d<h;d++){m=J.xtraRes[d].coords;Ck(m);m.terrain_water[f]=
512;m.terrain_water[b]=512;m.terrain_water[6]+=32;m.terrain_water[7]+=32;l=0;for(p=m.terrain_tree.length;l<p;l+=6)m.terrain_tree[4+l]-=32,m.terrain_tree[5+l]-=96;l=0;for(p=m.terrain_tree_s.length;l<p;l+=6)m.terrain_tree_s[5+l]-=32;m.terrain_tree[2]=1;Object.assign(k,m)}f=J.size;h=new Float32Array(1048576);m=Bk(k,h,f,0);J.info=h;J.ids=m/16}if(!ed){Kb={sword:{name:"Sword",iconID:16,img:k.items1,d:0,dMax:7,attack:1,type:52,sword:1},bow:{name:"Bow",iconID:4,img:k.items1,d:15,dMax:4,attack:1,type:52,sword:1},
shield:{name:"Shield",iconID:1,img:k.items1,d:8,dMax:6,defence:1,type:52,shield:1},potion:{name:"Potion",iconID:11,img:k.potions,d:0,dMax:7,type:52,potion:1},book:{name:"Book",iconID:9,img:k.books,d:0,dMax:4,type:52,book:1},gold:{name:"Gold",iconID:20,img:k.item_gold,d:0,dMax:0,type:52},stone:{name:"Stone",iconID:22,img:k.item_stone,d:0,dMax:0,type:52},food:{name:"Food",iconID:14,img:k.item_food,d:0,dMax:0,type:52},wood:{name:"Wood",iconID:15,img:k.item_tree,d:0,dMax:0,type:52},iron:{name:"Iron",
iconID:21,img:k.item_iron,d:0,dMax:0,type:52}};Ig=[Kb.sword,Kb.potion,Kb.book,Kb.bow,Kb.shield];h=[a.move,a.attack,a.stop,a.stand,a.pickUp,a.explore,a.healing,a.bless];f=[a.attack,a.guard,a.patrol,a.explore,a.stop,a.stand,a.attackGround,a.steady,a.move];b=[a.buildAcademy,a.buildWorkshop,a.buildWorkshop1,a.buildAcademy1,a.buildWorkshop2,a.buildAcademy2];d=[a.buildMerchands1,a.buildMerchands2,a.buildMerchands];ab={euro:{},asia:{},arab:{},common:{}};w=[{name:"Footman",attack:6,defence:3,health:65,maxHealth:65,
img:k.euro_footman.idle,attackSound:oc,invType:0,invMax:8,validator:Y,human:12,iconID:36,time:12,sight:5,url:k.euro_footman,icons:e,cost:[0,0,50,0],attDist:1,spd:50,dieSound:lb,clss:"footman",size:1,standardFunc:U,radix:0,zLevel:1,strID:"e_footman",race:"euro"},{name:"Pikeman",radix:0,attackSound:oc,attack:8,defence:4,health:75,maxHealth:75,img:k.euro_pikeman.idle,invType:0,dieSound:lb,invMax:8,validator:Y,human:1,iconID:39,time:18,sight:5,url:k.euro_pikeman,icons:e,cost:[40,0,60,0],attDist:1,spd:50,
standardFunc:U,clss:"e_pikeman",zLevel:1,size:1,strID:"e_pikeman",nu:a.createPikeman,race:"euro"},{name:"Spy",radix:0,attack:20,defence:0,mana:100,manaMax:100,health:50,maxHealth:50,img:k.euro_spy.idle,attackSound:["spy%20kill%201","spy%20kill%202","spy%20kill%203"],invType:0,invMax:8,validator:Y,human:1,dieSound:lb,iconID:41,time:30,sight:12,url:k.euro_spy,icons:[a.move,a.attack,a.guard,a.patrol,a.pickUp,a.explore,a.stop,a.stand,a.impersonate,a.revealSelf],zLevel:1,cost:[120,0,0,0],attDist:1,spd:50,
clss:"spy",standardFunc:U,size:1,update:["mana","manaSpeed",1E3],isSpy:1,strID:"spy",nu:a.createSpy,race:"common"},{name:"Maceman",radix:0,attack:8,defence:0,health:120,maxHealth:120,img:k.euro_maceman.idle,attackSound:oc,invType:0,invMax:8,validator:Y,human:1,iconID:37,time:14,dieSound:lb,sight:5,zLevel:1,url:k.euro_maceman,icons:e,cost:[0,0,120,0],attDist:1,spd:50,clss:"maceman",standardFunc:U,size:1,strID:"e_maceman",nu:a.createMaceman,race:"euro"},{radix:0,name:"Archer",attack:5,defence:0,health:50,
maxHealth:50,img:k.euro_archer1.idle,invType:0,invMax:8,validator:Y,human:1,sight:10,dieSound:lb,arrow:!0,iconID:38,zLevel:1,time:12,url:k.euro_archer1,icons:e,cost:[0,20,40,0],attDist:7,spd:50,clss:"archer",standardFunc:U,attimg:k.arrow1,attackSound:md,size:1,strID:"e_archer",nu:a.createArcher,race:"euro"},{radix:0,name:"Wizard",attackSound:Pj,dieSound:["mage"],attack:5,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:k.euro_mage.idle,zLevel:1,invType:0,invMax:8,validator:Y,human:1,iconID:42,
time:30,sight:15,url:k.euro_mage,icons:[a.stop,a.pickUp,a.explore,a.lightning,a.createBat,a.freeze,a.createGolem,a.invisibility,a.stand,a.attack,a.move],cost:[150,0,0,0],attDist:10,attimg:k.flame_bolt,ball:1,spd:50,clss:"mage",standardFunc:U,size:1,update:["mana","manaSpeed",1E3],strID:"e_mage",nu:a.createMage,race:"euro"},{radix:0,name:"Longbowman",attack:6,defence:2,health:50,maxHealth:50,img:k.euro_longbowman.idle,zLevel:1,invType:0,invMax:8,dieSound:lb,attackSound:md,arrow:!0,validator:Y,race:"euro",
human:1,iconID:35,time:18,sight:18,url:k.euro_longbowman,icons:e,cost:[50,0,90,0],attDist:12,spd:50,standardFunc:U,clss:"longbowman",size:1,d2attack:2,strID:"e_longbowman",attimg:k.arrow1,nu:a.createLongbowman},{radix:0,clss:"tree",name:"Tree",health:100,maxHealth:100,img:k.terrain_tree,invType:0,invMax:8,zLevel:1,mMapcolor:[11,131,11],validator:Y,child:[{img:k.terrain_tree_s,rgb:[0,0,0,.5],alpha:1,x:0,y:0}],iconID:23,url:k.terrain_tree,dimgInfinity:k.terrain_tree,dimgRND:3,icons:[],res:1,race:"common",
build:!0,size:1,zolotoy:1,strID:"tree"},{radix:0,name:"Crusader",zLevel:1,dieSound:$d,attackSound:Yd,attack:14,defence:8,health:180,maxHealth:180,img:k.crus.idle,invType:0,invMax:8,validator:Y,human:1,race:"euro",iconID:100,time:19,sight:5,url:k.crus,icons:e,cost:[0,0,0,0],attDist:1,spd:85,standardFunc:U,clss:"crusader",size:1,strID:"crusader"},{radix:0,name:"Priest",attack:20,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:k.euro_priest.idle,invType:0,zLevel:1,invMax:8,validator:Y,human:1,
iconID:40,time:30,ball:1,sight:21,dieSound:lb,url:k.euro_priest,icons:h,attackOnly:Md.magic_creatures.obj,cost:[150,0,0,0],attDist:18,race:"euro",spd:50,standardFunc:U,clss:"priest",size:1,update:["mana","manaSpeed",1E3],strID:"e_priest",nu:a.createPriest,attimg:k.flame_bolt},{radix:0,name:"Peasant",attackSound:xh,attack:5,defence:0,health:50,maxHealth:50,img:k.euro_peasant.idle,invType:0,invMax:8,dieSound:lb,zLevel:1,validator:Y,human:1,race:"euro",iconID:33,time:8,sight:5,url:k.euro_peasant,icons:[a.move,
a.menuBuilds,a.repair,a.conquest,a.dcm,a.pickUp,a.explore,a.stop,a.stand,a.attack,a.bribe,a.sameSpeed,a.restoreSpeed],cost:[0,0,50,0],attDist:1,spd:50,clss:"peon",size:1,peon:1,strID:"e_peon",nu:a.createPeon,nocapture:1},{radix:0,clss:"cathedral",name:"Cathedral",dieSound:N,sound:["e_cathedral1","e_cathedral2"],resistance:700,health:5E3,maxHealth:5E3,img:k.euro_cathedral,invType:0,invMax:8,race:"euro",zLevel:1,validator:T,bimg:k.build5x5,dimg:k.des_5x5,iconID:60,icons:[a.createCrusaders,a.techFanaticism,
a.techEspionage,a.techInquisition,a.techHealing,a.techBless,a.techCrusade,a.techMedicine],time:90,sight:8,child:[{img:k.euro_cathedral_c,x:0,y:0},{img:k.euro_cathedral_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,5]),url:k.euro_cathedral,build:!0,cost:[2E3,0,0,2E3],onbuild:[a.buildChurch],size:1,strID:"cathedral"},{radix:0,name:"Castle",clss:"castle",dieSound:N,sound:["e_castle1"],resistance:700,health:8E3,maxHealth:8E3,img:k.euro_castle,
invType:1,invMax:50,race:"euro",zLevel:1,validator:T,bimg:k.build6x6,dimg:k.des_6x6,iconID:59,time:120,sight:12,child:[{img:k.euro_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:k.euro_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[a.createPeon,a.createSpy,a.emergeAllUnits,a.techFeudalism,a.techArchitecture,a.techLearning],space:new Uint8Array([0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,0,1,1,7]),menu:Ha,url:k.euro_castle,build:!0,cost:[0,1500,0,1500],storage:-1,
castle:!0,population:20,size:1,strID:"e_castle"},{radix:0,name:"Wooden Wall",clss:"wall_wood",resistance:700,health:2E3,maxHealth:2E3,img:k.wood_tower,time:6,sight:1,zLevel:1,dieSound:N,validator:Y,bimg:k.wood_build,dimgInfinity:k.wood_debris,iconID:49,icons:[],mx:0,race:"common",my:0,hframe:71,menu:Ha,url:k.wood_tower,wall:1,build:!0,cost:[0,0,20,0],size:1,strID:"woodwall",child:[{img:k.wood_tower_c,x:0,y:0}]},{radix:0,name:"Barracks",clss:"barracks",strID:"e_barrack",sound:yh,generator:1,resistance:500,
health:1400,maxHealth:1400,img:k.euro_barrack,invType:1,invMax:0,dieSound:N,time:60,sight:6,zLevel:1,race:"euro",validator:T,bimg:k.build5x5,dimg:k.des_5x5,child:[{img:k.euro_barracks_c,mv:!0},{img:k.euro_barrack_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:57,icons:[a.createFootman,a.createArcher,a.createMaceman,a.createPikeman,a.createLongbowman,a.createKnight],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:k.euro_barrack,build:!0,cost:[0,200,0,200],size:1},{radix:0,
strID:"e_lumber",name:"Lumber Mill",sound:["e_lumber1"],clss:"lumber_mill",resistance:500,health:800,maxHealth:800,img:k.euro_lumbermill,invType:1,invMax:0,time:30,race:"euro",sight:4,dieSound:N,zLevel:1,validator:T,bimg:k.build2x2,dimg:k.des_2x2,iconID:64,child:[{img:k.euro_lumbermill_c,x:0,y:0},{alpha:!0,img:k.euro_lumbermill_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[a.techLongbow,a.techWoodCutting,a.techCrossbow],space:new Uint8Array([1,1,1,1,2]),hframe:98,url:k.euro_lumbermill,build:!0,cost:[0,100,0,
0],storage:1,size:1},{radix:0,name:"Mage Tower",strID:"e_magetower",sound:["e_magetower1","e_magetower2","e_magetower3"],clss:"magictower",resistance:700,health:5E3,maxHealth:5E3,img:k.euro_magetower,invType:1,invMax:0,time:90,race:"euro",dieSound:N,sight:8,validator:T,bimg:k.build5x5,dimg:k.des_5x5,zLevel:1,child:[{img:k.euro_magetower_c,x:0,y:0},{img:k.euro_magetower_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:71,icons:[a.createMage,a.techBat,a.techInvisibility,a.techLightning,a.techFreeze,a.techGolem],
space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:k.euro_magetower,build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,strID:"e_waracademy",name:"Warriors Guild",sound:["e_waracademy1"],clss:"academy",resistance:700,health:5E3,maxHealth:5E3,img:k.euro_waracademy,invType:1,invMax:0,race:"euro",time:90,sight:8,dieSound:N,zLevel:1,validator:T,bimg:k.build6x6,dimg:k.des_6x6,iconID:56,child:[{img:k.euro_waracademy_c,x:0,y:0,mv:!0},{img:k.euro_waracademy_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],icons:[a.techHeroism,
a.techWarfare,a.techMercenaries,a.techSiegeTactics,a.techBodyBuilding,a.techLeadership,a.techTactics,a.techHeroes,a.techHonor,a.techFame],space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,0,5]),url:k.euro_waracademy,build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,name:"Storage",strID:"e_storage",sound:["e_storage1","e_storage2"],clss:"storage",resistance:80,health:800,maxHealth:800,img:k.euro_storage,invType:1,invMax:0,time:30,dieSound:N,zLevel:1,sight:5,validator:T,bimg:k.build4x4,
dimg:k.des_4x4,iconID:69,race:"euro",icons:[a.techGoldMining,a.techStoneMining],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,4]),url:k.euro_storage,storage:0,build:!0,cost:[0,200,0,0],size:1,child:[{img:k.euro_storage_c,x:0,y:0},{img:k.euro_storage_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Knight",strID:"e_knight",dieSound:$d,clss:"knight",attackSound:Yd,attack:12,defence:6,health:120,maxHealth:120,img:k.euro_knight.idle,invType:0,zLevel:1,race:"euro",invMax:8,validator:Y,human:1,
iconID:43,d2attack:2,time:22,sight:5,url:k.euro_knight,icons:e,cost:[120,0,70,0],attDist:1,spd:85,nu:a.createKnight,standardFunc:U,size:1},{radix:0,name:"Field",clss:"field",strID:"field",instantBuild:1,resistance:80,health:100,maxHealth:100,img:k.fields,invMax:0,validator:Ui,zLevel:1,iconID:104,race:"common",icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:k.fields,build:!0,field:1,res:2,cost:[0,200,0,0],rndDirection:9,time:0,sight:1,z32:.5,size:1},{radix:0,name:"Golden rocks",mMapcolor:[148,
148,0],strID:"gold",sound:["mine1"],clss:"golden_rocks",resistance:0,health:6E3,maxHealth:6E3,img:k.res_gold,invMax:0,validator:T,iconID:20,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:k.res_gold,build:!0,zLevel:1,race:"common",res:0,cost:[0,0,0,0],time:0,sight:2,dieSound:["destroy%20mine"],size:1,zolotoy:1,child:[{img:k.res_gold_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:k.res_gold},{radix:0,name:"Rocks",strID:"stone",mMapcolor:[132,132,132],sound:["mine1"],clss:"rocks",
dieSound:["destroy%20mine"],resistance:0,health:6E3,maxHealth:6E3,img:k.res_stone,invMax:0,validator:T,zLevel:1,iconID:22,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:k.res_stone,build:!0,res:3,cost:[0,0,0,0],race:"common",time:0,sight:2,size:1,zolotoy:1,child:[{img:k.res_stone_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:k.res_stone},{radix:0,name:"Farm",strID:"e_farm",sound:["e_farm1","e_farm2"],clss:"farm",resistance:0,health:800,maxHealth:800,img:k.euro_farm,invType:1,
invMax:0,zLevel:1,validator:T,bimg:k.build4x4,dimg:k.des_4x4,iconID:61,dieSound:N,race:"euro",icons:[a.createCow,a.techCropRotation,a.techDomestication],space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),menu:Ha,url:k.euro_farm,build:!0,cost:[0,200,0,0],time:30,sight:5,storage:2,size:1,child:[{img:k.euro_farm_c,x:0,y:0}]},{radix:0,name:"Merchants Guild",strID:"e_merchant",sound:["merchant"],clss:"merchants_guild",resistance:0,health:5E3,maxHealth:5E3,img:k.euro_tcguild,invType:1,invMax:0,validator:T,
bimg:k.build6x6,zLevel:1,dimg:k.des_6x6,race:"euro",iconID:62,dieSound:N,icons:[a.techMapMaking,a.techTradeRoutes,a.techUsury,a.techSupplyStorage,a.techBribery,a.techTradeTaxes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),menu:Ha,url:k.euro_tcguild,build:!0,time:90,sight:8,cost:[2E3,0,0,2E3],onbuild:[a.buildMarket],size:1,child:[{img:k.euro_tcguild_c,x:0,y:0},{img:k.euro_tcguild_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Church",clss:"church",strID:"e_church",
sound:["e_church1"],resistance:0,health:800,maxHealth:800,img:k.euro_church,invType:1,invMax:0,dieSound:N,validator:T,bimg:k.build3x3,race:"euro",zLevel:1,dimg:k.des_3x3,iconID:139,icons:[a.createPriest],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),menu:Ha,url:k.euro_church,build:!0,cost:[0,0,200,200],time:40,sight:6,size:1,child:[{img:k.euro_church_c,x:0,y:0},{img:k.euro_church_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Blacksmith",clss:"blacksmith",strID:"e_blacksmith",resistance:0,health:800,
maxHealth:800,img:k.euro_blacksmith,invType:1,invMax:0,time:40,zLevel:1,sight:5,dieSound:N,validator:T,bimg:k.build4x4,race:"euro",dimg:k.des_4x4,child:[{img:k.euro_blacksmith_c,x:0,y:0}],iconID:58,icons:[a.techPlateArmor,a.techTemperIron,a.techScaleArmor,a.techHalberd,a.techChainMail],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),menu:Ha,url:k.euro_blacksmith,build:!0,cost:[0,0,200,200],onbuild:b,size:1},{radix:0,name:"Cow",clss:"cow",nu:a.createCow,race:"common",strID:"cow",attack:0,
defence:3,health:50,maxHealth:50,img:k.cow.idle,invType:0,invMax:8,zLevel:1,validator:Y,iconID:99,time:20,dieSound:["cowdie1","cowdie2","cowdie3","cowdie4"],url:k.cow,icons:[a.move,a.stop],sight:3,cost:[0,0,300,0],attDist:0,spd:32,res:2,food:300,milk:50,milkMax:50,foodMax:600,size:1,cow:1,update:["milk","milkSpeed",1E3,"food","cowSpeed",1E3]},{radix:0,name:"Stable",sound:["e_stables1"],clss:"stable",strID:"e_stable",onlyRequired:1,resistance:0,health:800,maxHealth:800,invType:1,invMax:0,race:"euro",
zLevel:1,validator:T,bimg:k.build4x4,dimg:k.des_4x4,iconID:68,dieSound:N,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,4]),url:k.euro_stables,build:!0,cost:[0,200,0,0],onbuild:c,size:1,time:40,sight:5,img:k.euro_stables,nu:a.createCow,child:[{img:k.euro_stable_c,x:0,y:0}]},{radix:0,name:"Workshop",sound:["e_workshop1"],clss:"workshop",strID:"e_workshop",zLevel:1,resistance:0,health:800,maxHealth:800,img:k.euro_workshop,invType:1,invMax:0,dieSound:N,validator:T,bimg:k.build4x4,race:"euro",
dimg:k.des_4x4,iconID:75,icons:[a.createCatapult,a.createHeavyCatapult,a.createBallist,a.techEngineering,a.techCannonTower],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,4]),url:k.euro_workshop,build:!0,cost:[0,200,200,0],size:1,time:40,sight:5,child:[{img:k.euro_workshop_c,x:0,y:0}]},{radix:0,name:"Tavern",sound:["e_tavern1"],clss:"tavern",strID:"e_tavern",dieSound:N,resistance:0,health:1E3,maxHealth:1E3,img:k.euro_tavern,invType:1,invMax:0,validator:T,race:"euro",bimg:k.build4x4,dimg:k.des_4x4,
zLevel:1,iconID:70,icons:[a.createMercenaries,a.createHeroes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,4]),url:k.euro_tavern,build:1,cost:[0,200,200,0],onbuild:d,actvintv:[a.iniMercenaries,a.iniHeroes],size:1,time:40,sight:5,child:[{img:k.euro_tavern_c,x:0,y:0}]},{name:"House",sound:["house1","house2","house3","house4","house5"],clss:"house",strID:"e_house",resistance:0,health:75,maxHealth:75,img:k.euro_houses,invType:1,invMax:0,validator:T,bimg:k.build3x3,dimg:k.des_3x3,race:"euro",
iconID:73,zLevel:1,dieSound:N,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:k.euro_houses,build:!0,cost:[0,75,0,0],population:10,size:1,time:20,sight:4,child:[{img:k.euro_houses_c,x:0,y:0}]},{name:"Watch Tower",attackSound:Nf,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),clss:"watch_tower",strID:"watch_tower",attack:7,health:400,maxHealth:400,img:k.euro_tower_wood_2,state:0,invType:1,race:"common",invMax:0,zLevel:1,dieSound:N,level:0,validator:T,child:[{img:k.euro_tower_wood_2_c,
x:0,y:0},{alpha:!0,img:k.euro_tower_wood_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attimg:k.arrow1,attDist:8,bimg:k.build2x2,dimg:k.des_2x2,iconID:53,icons:[a.attack,a.stop,a.upgradeGuildTower],space:new Uint8Array([1,1,1,1,2]),url:k.euro_tower_wood_2,build:!0,cost:[0,300,0,0],size:1,arrow:!0,time:10,sight:15,standardFunc:U},{name:"Market",sound:["e_market1"],clss:"market",strID:"e_market",resistance:0,health:1400,maxHealth:1400,img:k.euro_market,invType:1,invMax:0,dieSound:N,zLevel:1,validator:T,bimg:k.build4x4,
dimg:k.des_4x4,iconID:65,race:"euro",icons:[a.createCaravan],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,4]),url:k.euro_market,build:!0,cost:[0,200,200,0],size:1,time:60,sight:8,child:[{img:k.euro_market_c,x:0,y:0}]},{name:"Outpost",sound:["e_outpost1"],clss:"outpost",strID:"e_outpost",zLevel:1,resistance:0,health:2E3,maxHealth:2E3,img:k.euro_outpost,invType:1,dieSound:N,invMax:50,validator:T,race:"euro",bimg:k.build4x4,dimg:k.des_4x4,iconID:66,icons:[a.emergeAllUnits],space:new Uint8Array([0,
1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,4]),url:k.euro_outpost,build:!0,cost:[0,200,0,400],size:1,child:[{img:k.euro_outpost_c,x:0,y:0},{img:k.euro_outpost_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:60,sight:8},{name:"Bridge",clss:"bridge",strID:"bridge",resistance:0,health:1E4,maxHealth:1E4,img:k.bridge_horz,invMax:0,validator:Ti,bimg:k.bridge_horz_build,race:"common",zLevel:1,dieSound:N,child:[{alpha:!0,img:k.bridge_horz_s,x:0,y:0,rgb:[0,0,0,.5]},{img:k.bridge_horz1,x:0,y:0,z:6}],time:22,sight:1,dimg:k.bridge_horz_demol,
iconID:44,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,11]),url:k.bridge_horz,build:!0,cost:[0,200,0,400],size:1},{name:"Dummy",clss:"dummy",strID:"dummy",resistance:0,health:5E3,maxHealth:5E3,img:k.dummy1,invMax:0,validator:Y,bimg:k.dummy1_b,iconID:165,icons:[],mx:0,zLevel:1,my:16,hframe:65,race:"common",url:k.dummy1,dimg:k.dummy1_d,build:!0,cost:[0,300,0,0],
dummy:!0,child:[{img:k.dummy1_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:10,sight:1},{name:"Catapult",strID:"catapult",dieSound:Pf,clss:"catapult",attackSound:Of,defence:0,attack:10,health:110,maxHealth:110,img:k.catapult.idle,invMax:0,radix:0,validator:Y,iconID:30,time:30,sight:20,race:"common",url:k.catapult,level:0,zLevel:1,icons:f,cost:[0,600,0,0],nofreeze:1,arrow:!1,attDist:17,spd:40,standardFunc:U,size:1,attimg:k.cat_stone,space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:a.createCatapult},{name:"Ballista",
radix:0,strID:"ballista",attackSound:Of,dieSound:Pf,clss:"ballista",defence:0,attack:60,health:75,maxHealth:75,img:k.ballista.idle,invMax:0,validator:Y,iconID:31,time:30,sight:16,nofreeze:1,race:"common",zLevel:1,url:k.ballista,icons:f,cost:[0,800,0,0],attDist:13,spd:40,standardFunc:U,size:1,attimg:k.arrow_ballista1,space:new Uint8Array([1,1,1,1,2]),attackDeg:30,nu:a.createBallist},{name:"Heavy Catapult",strID:"heavy_catapult",attackSound:Of,defence:0,attack:25,health:250,maxHealth:250,img:k.h_catapult.idle,
invMax:0,radix:0,validator:Y,iconID:45,time:60,dieSound:Pf,sight:26,race:"common",url:k.h_catapult,zLevel:1,icons:f,standardFunc:U,cost:[0,1200,0,0],attDist:22,spd:40,nofreeze:1,clss:"heavy_catapult",size:1,attimg:k.cb_metal,space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:a.createHeavyCatapult},{radix:0,name:"Ghost",strID:"ghost",defence:0,attack:8,health:60,maxHealth:60,img:k.euro_ghost.idle,invType:0,invMax:8,dieSound:["ghost1","ghost2"],validator:Y,iconID:178,zLevel:1,race:"common",time:15,attackSound:Oj,
sight:5,standardFunc:U,url:k.euro_ghost,icons:e,w:1,cost:[40,0,0,0],attDist:1,spd:80,clss:"ghost",size:1,nu:a.createGhost},{name:"Harbor",strID:"e_harbor",resistance:80,health:800,maxHealth:800,img:k.euro_harbor,invType:1,invMax:0,validator:jf,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:k.build_harbor,dimg:k.des_harbor,zLevel:1,race:"euro",dieSound:N,iconID:63,icons:[a.createFishingBoat,a.createXebec,a.createHulk,a.createGalleon,a.techLandingTactics],clss:"harbor",url:k.euro_harbor,storage:4,
build:!0,cost:[0,200,200,0],child:[{img:k.euro_harbor_c,x:0,y:0},{img:k.euro_harbor_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:60,sight:8},{radix:0,name:"Messiah",strID:"messiah",attack:50,defence:10,mana:1E3,manaMax:1E3,health:1E3,maxHealth:1E3,img:k.messiah.idle,invType:0,invMax:0,race:"common",validator:Y,human:1,iconID:169,zLevel:1,attackSound:["messiah_attack"],dieSound:["messiah"],time:300,sight:26,url:k.messiah,standardFunc:U,icons:e,cost:[2E3,0,0,0],attDist:10,spd:50,clss:"messiah",size:1,update:["mana",
"manaSpeed",1E3]},{name:"Magic Gateway",sound:["gateway"],strID:"gateway",magicGateway:1,resistance:0,health:Infinity,maxHealth:Infinity,img:k.teleport,invMax:0,validator:T,bimg:k.build4x4,zLevel:1,dieSound:N,race:"common",iconID:180,clss:"magic_gateway",icons:[a.createOrk,a.createDwarf,a.createGhost,a.createSkeleton],space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,5]),url:k.teleport,build:!0,cost:[0,0,0,0],size:1,time:10,sight:10,zolotoy:1,child:[{img:k.teleport_c,x:0,y:0},
{alpha:!0,img:k.teleport_s,x:0,y:0,rgb:[0,0,0,.5]}],standardFunc:Vj},{name:"Guard Tower",strID:"guard_tower",race:"common",clss:"guard_tower",attackSound:Nf,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:12,health:1E3,maxHealth:1E3,img:k.euro_tower_wood,state:0,invType:1,invMax:0,dieSound:N,zLevel:1,validator:T,child:[{img:k.euro_tower_wood_c,x:0,y:0},{alpha:!0,img:k.euro_tower_wood_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:12,bimg:k.build2x2,dimg:k.des_2x2,iconID:52,icons:[a.attack,a.stop,
a.upgradeStoneTower,a.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:k.euro_tower_wood,build:!0,cost:[0,600,0,0],size:1,arrow:!0,attimg:k.arrow1,time:35,sight:16,standardFunc:U},{name:"Sword",attack:0,defence:0,health:25,maxHealth:25,img:k.items1,state:0,invMax:0,validator:Cb,iconID:16,url:k.items1,icons:[],cost:[0,0,0,0],size:1,zLevel:0,z32:.5,radix:0,race:"common",item:1},{name:"Bow",attack:0,defence:0,health:25,maxHealth:25,img:k.items1,state:0,invMax:0,validator:Cb,iconID:4,url:k.items1,
icons:[],cost:[0,0,0,0],size:1,z32:.5,zLevel:0,radix:0,race:"common",item:1},{name:"Shield",attack:0,defence:0,health:25,maxHealth:25,img:k.items1,state:0,invMax:0,validator:Cb,iconID:1,url:k.items1,icons:[],cost:[0,0,0,0],zLevel:0,race:"common",radix:0,size:1,z32:.5,item:1},{name:"Potion",attack:0,defence:0,health:25,maxHealth:25,img:k.potions,state:0,invMax:0,validator:Cb,iconID:11,url:k.potions,icons:[],radix:0,race:"common",zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Book",attack:0,defence:0,
health:25,maxHealth:25,img:k.book1,state:0,invMax:0,validator:Cb,iconID:9,zLevel:0,race:"common",radix:0,url:k.books,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Gold",health:1,maxHealth:1,img:k.item_gold,invMax:0,validator:Cb,iconID:20,radix:0,race:"common",zLevel:0,url:k.item_gold,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Stone",health:1,maxHealth:1,img:k.item_stone,invMax:0,validator:Cb,iconID:22,race:"common",radix:0,url:k.item_stone,zLevel:0,icons:[],cost:[0,0,0,0],size:1,
z32:.5,item:1},{name:"Food",health:15,maxHealth:15,img:k.item_food,invMax:0,mMapcolor:[0,255,255],validator:Cb,iconID:14,url:k.item_food,radix:0,race:"common",icons:[],zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Wood",health:1,maxHealth:1,img:k.item_wood,invMax:0,validator:Cb,iconID:15,url:k.item_wood,icons:[],race:"common",radix:0,zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Iron",health:1,maxHealth:1,img:k.item_iron,invMax:0,validator:Cb,iconID:21,zLevel:0,race:"common",url:k.item_iron,
radix:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Keep Tower",strID:"keep_tower",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:16,health:2E3,maxHealth:2E3,img:k.euro_tower_stone,state:0,invType:1,zLevel:1,attackSound:Nf,invMax:0,dieSound:N,validator:T,clss:"keep_tower",race:"common",child:[{alpha:!0,img:k.euro_tower_stone_s,x:0,y:0,rgb:[0,0,0,.5]},{img:k.euro_tower_stone_c,x:0,y:0}],attDist:14,bimg:k.build2x2,dimg:k.des_2x2,standardFunc:U,iconID:54,icons:[a.attack,a.stop,
a.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:k.euro_tower_stone,build:!0,cost:[0,600,0,0],size:1,arrow:!0,attimg:k.arrow_big1,time:40,sight:18},{name:"Cannon Tower",clss:"tower_stone2",strID:"tower_stone2",attackSound:Zd,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:40,health:2500,maxHealth:2500,img:k.euro_tower_stone_2,state:0,invType:1,invMax:0,dieSound:N,race:"common",validator:T,zLevel:1,child:[{img:k.euro_tower_stone_2_c,x:0,y:0},{alpha:!0,img:k.euro_tower_stone_2_s,
x:0,y:0,rgb:[0,0,0,.5]}],attDist:10,bimg:k.build2x2,dimg:k.des_2x2,iconID:54,icons:[a.attack,a.stop],space:new Uint8Array([1,1,1,1,2]),url:k.euro_tower_stone_2,build:!0,cost:[0,600,0,0],standardFunc:U,size:1,arrow:!1,attimg:k.hot_cannon,time:45,sight:18,attackDeg:30},{name:"Rocket Tower",strID:"tower_rocket",race:"asia",clss:"tower_rocket",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),zLevel:1,attack:30,health:1400,maxHealth:1400,img:k.rocket_tower,state:0,invType:1,invMax:0,dieSound:N,validator:T,
child:[{img:k.rocket_tower_c},{alpha:!0,img:k.rocket_tower_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:20,bimg:k.build2x2,dimg:k.des_2x2,iconID:186,icons:[],space:new Uint8Array([1,1,1,1,2]),url:k.rocket_tower,build:!0,cost:[0,600,0,0],standardFunc:U,size:1,arrow:!0,attimg:k.arrow_big1,time:60,sight:26},{radix:0,name:"Ork",race:"common",strID:"ork",dieSound:["orc%20die%201","orc%20die%202"],attackSound:Nj,attack:18,defence:2,health:75,maxHealth:75,img:k.ork.idle,invType:0,invMax:8,validator:Y,zLevel:1,iconID:143,
time:12,sight:5,url:k.ork,standardFunc:U,icons:e,cost:[60,0,0,0],attDist:1,spd:50,clss:"ork",size:1,nu:a.createOrk},{radix:0,name:"Dwarf",race:"common",attack:7,defence:7,health:120,maxHealth:120,img:k.dwarf.idle,invType:0,strID:"dwarf",invMax:8,zLevel:1,dieSound:lb,validator:Y,iconID:185,time:12,sight:3,url:k.dwarf,standardFunc:U,icons:e,cost:[80,0,0,0],attDist:1,spd:50,clss:"dwarf",size:1,nu:a.createDwarf},{radix:0,name:"Skeleton",strID:"skeleton",race:"common",dieSound:["skeleton%20die%201","skeleton%20die%202",
"skeleton%20die%203","skeleton%20die%204"],attack:4,defence:0,health:40,maxHealth:40,img:k.skeleton.idle,invType:0,zLevel:1,attackSound:oc,invMax:8,nofreeze:1,validator:Y,iconID:167,time:12,sight:3,url:k.skeleton,standardFunc:U,icons:e,cost:[0,0,30,0],attDist:1,spd:50,clss:"skeleton",size:1,nu:a.createSkeleton},{radix:0,name:"Caravan",race:"euro",strID:"e_caravan",attack:0,defence:0,health:350,maxHealth:350,img:k.caravan.idle,invType:1,invMax:8,validator:Y,iconID:34,zLevel:1,time:50,sight:7,url:k.caravan,
icons:[a.move,a.trade,a.explore,a.stop,a.stand,a.unload],cost:[0,200,400,0],attDist:1,spd:75,clss:"caravan",size:1,nu:a.createCaravan},{name:"Castle",health:8E3,maxHealth:8E3,img:k.asia_castle,invType:1,strID:"a_castle",zLevel:1,race:"asia",invMax:50,validator:T,bimg:k.build6x6,dimg:k.des_6x6,iconID:164,time:120,sight:12,dieSound:N,clss:"castle",child:[{img:k.asia_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:k.asia_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[a.createPeon1,a.createNinja,a.emergeAllUnits,a.techFeudalism,
a.techArchitecture,a.techLearning,a.techBuddhism,a.techGreatWall],space:new Uint8Array([0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,0,0,8]),menu:Ha,url:k.asia_castle,build:!0,cost:[0,1500,0,1500],storage:-1,castle:!0,population:20,size:1},{name:"Castle",dieSound:N,clss:"castle",strID:"r_castle",race:"arab",health:8E3,maxHealth:8E3,img:k.arab_castle,invType:1,invMax:50,validator:T,bimg:k.build6x6,dimg:k.des_6x6,zLevel:1,
iconID:97,time:120,sight:12,child:[{img:k.arab_castle_c}],icons:[a.createPeon2,a.createSpy,a.emergeAllUnits,a.techFeudalism,a.techArchitecture,a.techLearning,a.techSlavery],space:new Uint8Array([0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,0,0,1,1,0,0,0,,8]),menu:Ha,url:k.arab_castle,build:!0,cost:[0,1500,0,1500],storage:-1,castle:!0,population:20,size:1},{radix:0,name:"Peasant",attack:5,defence:0,health:50,maxHealth:50,img:k.asian_peasant.idle,
invType:0,invMax:8,attackSound:xh,race:"asia",validator:Y,human:1,strID:"a_peon",iconID:132,dieSound:lb,zLevel:1,time:8,peon:1,sight:5,url:k.asian_peasant,icons:[a.move,a.menuBuilds1,a.repair,a.conquest,a.dcm,a.pickUp,a.explore,a.stop,a.stand,a.attack,a.sameSpeed,a.restoreSpeed],cost:[0,0,40,0],attDist:1,spd:50,clss:"peon",nocapture:1,size:1},{radix:0,name:"Ninja",race:"asia",attack:12,defence:5,mana:100,manaMax:100,health:90,maxHealth:90,img:k.asian_ninja.idle,invType:0,invMax:8,attackSound:oc,validator:Y,
human:1,iconID:133,strID:"ninja",dieSound:lb,zLevel:1,time:20,standardFunc:U,sight:10,url:k.asian_ninja,icons:[a.guard,a.patrol,a.pickUp,a.explore,a.stop,a.stand,a.invisibility,a.murder,a.move,a.attack,a.sameSpeed,a.restoreSpeed],cost:[120,0,0,0],attDist:1,spd:85,clss:"ninja",size:1,update:["mana","manaSpeed",1E3]},{radix:0,name:"Ronin",attack:7,defence:0,health:45,maxHealth:45,img:k.asian_ronin.idle,invType:0,invMax:8,race:"asia",validator:Y,human:1,standardFunc:U,iconID:141,strID:"ronin",dieSound:lb,
zLevel:1,time:8,sight:5,url:k.asian_ronin,icons:e,cost:[0,0,40,0],attDist:1,spd:50,attackSound:oc,clss:"a_footman",size:1},{radix:0,name:"Archer",attack:5,defence:0,health:50,maxHealth:50,img:k.asian_archer.idle,invType:0,invMax:8,race:"asia",validator:Y,human:1,strID:"a_archer",dieSound:lb,zLevel:1,attimg:k.arrow1,iconID:136,arrow:1,attackSound:md,time:12,sight:10,url:k.asian_archer,icons:e,cost:[0,20,40,0],standardFunc:U,spd:50,clss:"archer",size:1,attDist:6},{radix:0,name:"Samurai",attack:10,defence:4,
health:90,maxHealth:90,img:k.asian_samurai.idle,invType:0,race:"asia",strID:"samurai",invMax:8,attackSound:oc,validator:Y,human:1,iconID:142,time:20,standardFunc:U,zLevel:1,dieSound:lb,sight:6,url:k.asian_samurai,icons:e,cost:[50,0,150,0],attDist:1,spd:50,clss:"a_maceman",size:1},{radix:0,name:"Horse Archer",attack:7,defence:0,health:75,maxHealth:75,img:k.asian_horsarcher.idle,invType:0,race:"asia",invMax:8,validator:Y,human:1,attackSound:md,iconID:183,strID:"a_horse_archer",dieSound:$d,time:20,standardFunc:U,
sight:12,url:k.asian_horsarcher,zLevel:1,icons:e,arrow:1,attimg:k.arrow1,cost:[40,0,120,0],spd:85,clss:"horse_archer",size:1,attDist:7},{radix:0,name:"Horse Samurai",attack:14,defence:4,health:160,maxHealth:160,img:k.asian_horsamurai.idle,invType:0,invMax:8,validator:Y,human:1,iconID:135,race:"asia",standardFunc:U,attackSound:Yd,time:22,zLevel:1,strID:"horse_samurai",dieSound:$d,sight:5,url:k.asian_horsamurai,icons:e,cost:[75,0,120,0],attDist:1,spd:85,clss:"horse_samurai",size:1},{name:"Barracks",
resistance:500,health:1400,maxHealth:1400,img:k.asia_barracks,invType:1,sound:yh,invMax:0,time:60,dieSound:N,radix:0,sight:6,race:"asia",strID:"a_barrack",validator:T,zLevel:1,bimg:k.build5x5,dimg:k.des_5x5,child:[{img:k.asia_barracks_c,x:0,y:0,mv:!0},{img:k.asia_barracks_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:146,icons:[a.createRonin,a.createArcher1,a.createSamurai,a.createHorseArcher1,a.createHorseSamurai,a.createChariot],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,5]),url:k.asia_barracks,build:!0,cost:[0,200,0,200],size:1,clss:"barracks"},{name:"Chariot",attack:4,defence:3,health:180,maxHealth:180,img:k.asian_charriot.idle,invType:0,radix:0,race:"asia",invMax:8,strID:"chariot",dieSound:["c%20die%201","c%20die%202","c%20die%203","c%20die%204","c%20die%205"],attackSound:Yd,validator:Y,human:1,zLevel:1,iconID:175,standardFunc:U,time:8,sight:5,url:k.asian_charriot,icons:e,cost:[0,200,150,0],attDist:1,spd:85,clss:"chariot",size:1},{radix:1,name:"Galleon",attackSound:Zd,
attack:35,attDist:12,race:"common",defence:0,health:1200,maxHealth:1200,strID:"galleon",nu:a.createGalleon,img:k.galleon.idle,invType:1,invMax:24,dieSound:["ship%20sink"],zLevel:0,validator:Nd,iconID:32,time:50,boat:!0,attimg:k.cb_metal,attackDeg:20,sight:16,url:k.galleon,icons:[a.move,a.explore,a.unload,a.attack,a.attackGround,a.stop,a.stand,a.stop,a.stand,a.attack,a.steady,a.upgradeShip],cost:[0,1200,800,0],spd:50,nofreeze:1,clss:"galleon",standardFunc:U,size:1,peon:1},{radix:1,name:"Fishing Boat",
attackSound:Zd,attack:1,attDist:8,race:"common",defence:0,health:50,boat:!0,nu:a.createFishingBoat,maxHealth:50,img:k.boat.idle,invType:1,invMax:0,strID:"fishing_boat",dieSound:["ship%20sink"],zLevel:0,validator:Nd,iconID:184,nofreeze:1,time:50,sight:16,url:k.boat,icons:[a.move,a.explore,a.stop,a.stand,a.fishing],cost:[0,200,100,0],spd:65,clss:"fishing_boat",size:1},{radix:1,name:"Hulk",attackSound:Zd,attack:18,attDist:10,race:"common",defence:0,health:700,maxHealth:700,strID:"hulk",img:k.hulk.idle,
invType:1,boat:!0,nu:a.createHulk,attackDeg:20,invMax:16,dieSound:["ship%20sink"],zLevel:0,validator:Nd,iconID:128,time:30,sight:14,attimg:k.cb_metal,url:k.hulk,icons:[a.move,a.explore,a.unload,a.attack,a.attackGround,a.stop,a.stand,a.stop,a.stand,a.attack,a.steady,a.upgradeShip],cost:[0,500,300,0],spd:65,nofreeze:1,clss:"hulk",standardFunc:U,size:1},{radix:1,name:"Pinque",attackSound:md,attack:10,race:"common",attDist:8,defence:0,health:300,boat:!0,maxHealth:300,img:k.xebec.idle,attimg:k.arrow1,
arrow:!0,strID:"pinque",invType:1,invMax:8,dieSound:["ship%20sink"],zLevel:0,validator:Nd,iconID:129,time:20,nofreeze:1,sight:12,url:k.xebec,icons:[a.move,a.explore,a.unload,a.attack,a.attackGround,a.stop,a.stand,a.stop,a.stand,a.attack,a.steady,a.upgradeShip],cost:[0,300,200,0],spd:80,clss:"xebec",size:1,standardFunc:U,nu:a.createXebec},{radix:0,name:"Stone Golem",strID:"troll",defence:3,attack:25,health:400,maxHealth:400,img:k.troll.idle,invType:0,invMax:0,dieSound:["golem"],validator:Y,iconID:144,
race:"common",zLevel:1,nofreeze:1,attackSound:["golem1","golem2"],sight:10,standardFunc:U,url:k.troll,icons:e,w:1,cost:[120,0,0,0,600],attDist:1,spd:56,clss:"troll",size:1},{radix:0,name:"Bat",strID:"bat",defence:0,attack:3,health:20,maxHealth:20,img:k.bat.move,invType:0,invMax:0,race:"common",bat:1,dieSound:["bat%20die"],validator:kf,iconID:105,zLevel:2,attackSound:["bat%20attack"],sight:10,standardFunc:U,url:k.bat,icons:e,w:1,cost:[0,0,0,0,25],attDist:1,spd:128,clss:"bat",size:1,z32:1.5},{race:"arab",
invType:0,invMax:8,iconID:138,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:k.arab_peasant,img:k.arab_peasant.idle,spd:50,validator:Y,human:1,icons:[a.move,a.menuBuilds2,a.repair,a.conquest,a.dcm,a.pickUp,a.explore,a.stop,a.stand,a.attack,a.convertJihad,a.bribe,a.sameSpeed,a.restoreSpeed],name:"Peasant",clss:"peon",cost:[0,0,50,0],attDist:1,time:8,nocapture:1,peon:1,sight:5,health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:172,zLevel:1,dieSound:[],attackSound:[],size:1,
radix:0,url:k.arab_footman,img:k.arab_footman.idle,standardFunc:U,spd:50,validator:Y,human:1,attDist:1,icons:e,name:"Footman",clss:"footman",cost:[0,0,50,0],time:12,sight:5,health:50,attack:6,defence:1},{race:"arab",invType:0,invMax:8,iconID:170,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:k.arab_archer,img:k.arab_archer.idle,spd:50,validator:Y,standardFunc:U,human:1,attimg:k.arrow1,arrow:1,icons:e,name:"Archer",clss:"archer",cost:[0,20,40,0],time:12,sight:10,attDist:6,health:50,attack:5,
defence:0},{race:"arab",invType:0,invMax:8,iconID:173,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:k.arab_spearman,img:k.arab_spearman.idle,spd:50,validator:Y,standardFunc:U,human:1,icons:e,name:"Spearman",clss:"pikeman",attDist:1,cost:[40,0,60,0],time:14,sight:5,health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:174,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,standardFunc:U,url:k.arab_satrap,img:k.arab_satrap.idle,spd:50,validator:Y,human:1,icons:e,name:"Satrap",
attDist:1,clss:"maceman",cost:[0,0,120,0],time:14,sight:5,health:120,attack:8,defence:0},{race:"arab",invType:0,invMax:8,iconID:171,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:k.arab_cavalry,standardFunc:U,img:k.arab_cavalry.idle,spd:85,validator:Y,human:1,attDist:1,icons:e,name:"Cavalry",clss:"heavy_cavalry",cost:[60,0,100,0],time:14,sight:5,health:90,attack:10,defence:4},{race:"arab",invType:0,invMax:8,iconID:168,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:k.arab_horse_archer,
img:k.arab_horse_archer.idle,spd:85,validator:Y,human:1,standardFunc:U,icons:e,name:"Horse Archer",clss:"horse_archer",cost:[50,0,100,0],time:14,attimg:k.arrow1,arrow:1,sight:12,attDist:7,health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:179,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:k.arab_jwarrior,img:k.arab_jwarrior.idle,spd:50,validator:Y,human:1,standardFunc:U,icons:e,name:"Jihad warrior",attDist:1,clss:"jihad_warrior",cost:[0,0,100,0],time:8,sight:5,health:75,
attack:10,defence:2},{race:"arab",invType:0,invMax:8,iconID:176,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:k.arab_priest,img:k.arab_priest.idle,standardFunc:U,spd:50,mana:100,validator:Y,human:1,icons:h,name:"Priest",clss:"priest",cost:[150,0,0,0],time:30,sight:21,attDist:18,health:60,attack:20,update:["mana","manaSpeed",1E3],manaMax:100,defence:0,attimg:k.flame_bolt,ball:1,attackOnly:Md.magic_creatures.obj},{race:"arab",invType:0,invMax:0,iconID:105,zLevel:1,dieSound:[],attackSound:[],
size:1,radix:0,url:0,img:0,testing:1,illegal:1,spd:50,validator:Y,human:1,icons:[],name:"Spy",clss:"spy",cost:150,time:30,sight:12,health:50,attack:20,defence:0},{race:"arab",invType:0,invMax:8,iconID:188,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,attimg:k.flame_bolt,url:k.arab_mage,img:k.arab_mage.idle,spd:50,validator:Y,human:1,icons:[a.stop,a.pickUp,a.explore,a.createCarpet,a.createJinn,a.fireRain,a.magicVision,a.raiseDead,a.attack,a.stand,a.move],standardFunc:U,name:"Mage",clss:"mage",
ball:1,mana:100,manaMax:100,update:["mana","manaSpeed",1E3],cost:[150,0,0,0],time:30,sight:15,attDist:10,health:60,attack:8,defence:0},{race:"arab",invType:1,invMax:8,iconID:126,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:k.arab_caravan,img:k.arab_caravan.idle,spd:75,validator:Y,human:1,icons:[],name:"Caravan",clss:"trader",cost:[0,0,500,0],time:30,sight:5,health:150},{race:"arab",invType:0,invMax:8,iconID:177,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:k.arab_enichar,img:k.arab_enichar.idle,
spd:85,validator:Y,human:1,standardFunc:U,icons:e,name:"Enichar",attDist:1,clss:"enichar",cost:[80,0,120,0],time:25,sight:5,health:130,attack:18,defence:4},{race:"arab",invType:1,invMax:0,iconID:82,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:k.build3x3,dimg:k.des_3x3,radix:0,population:10,url:k.arab_houses,validator:T,build:1,icons:[],child:[{img:k.arab_houses_c}],name:"House",clss:"house",cost:[0,75,0,0],time:20,sight:4,resistance:50,health:500},{race:"arab",invType:1,invMax:0,
iconID:85,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:k.build3x3,dimg:k.des_3x3,radix:0,url:k.arab_lumbermill,validator:T,build:1,icons:[a.techWoodCutting,a.techCrossbow],child:[{img:k.arab_lumbermill_c}],name:"Lumber Mill",clss:"lumber",cost:[0,100,0,0],storage:1,time:30,sight:4,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:96,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:k.build4x4,dimg:k.des_4x4,radix:0,url:k.arab_storage,
validator:T,build:1,storage:0,icons:[a.techGoldMining,a.techStoneMining],child:[{img:k.arab_storage_c},{alpha:!0,img:k.arab_storage_s,rgb:[0,0,0,.5]}],name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:80,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:k.build4x4,dimg:k.des_4x4,radix:0,url:k.arab_farm,validator:T,build:1,icons:[a.createCow,a.techCropRotation,a.techDomestication,a.techCowPoaching,
a.ridingHorses,a.techHorseManShip],child:[{img:k.arab_farm_c}],name:"Farm",storage:2,clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:81,zLevel:1,dieSound:N,validator:jf,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:k.build_harbor,dimg:k.des_harbor,radix:0,url:k.arab_harbour,build:1,icons:[a.createFishingBoat,a.createXebec,a.createHulk,a.techLandingTactics],child:[{img:k.arab_harbour_c},{alpha:!0,img:k.arab_harbour_s,rgb:[0,0,0,
.5]}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,iconID:79,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:k.build3x3,dimg:k.des_3x3,radix:0,url:k.arab_blacksmith,validator:T,build:1,icons:[a.techTemperIron,a.techScaleArmor,a.techScimitar,a.techChainMail,a.techHalberd],child:[{img:k.arab_blacksmith_c},{alpha:!0,img:k.arab_blacksmith_s,rgb:[0,0,0,.5]}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,
150,0],onbuild:b,time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:95,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:k.build4x4,dimg:k.des_4x4,radix:0,url:k.arab_workshop,validator:T,build:1,icons:[a.createCatapult,a.createBallist,a.techEngineering,a.techCannonTower],child:[{img:k.arab_workshop_c},{alpha:!0,img:k.arab_workshop_s,rgb:[0,0,0,.5]}],name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},
{race:"arab",invType:1,invMax:0,iconID:140,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:k.build3x3,dimg:k.des_3x3,radix:0,url:k.arab_church,validator:T,build:1,icons:[a.createPriest2],child:[{img:k.arab_church_c},{alpha:!0,img:k.arab_church_s,rgb:[0,0,0,.5]}],name:"Church",clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"arab",invType:1,invMax:0,iconID:92,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,4]),bimg:k.build4x4,
dimg:k.des_4x4,radix:0,url:k.arab_tavern,validator:T,build:1,icons:[a.createMercenaries,a.createHeroes],child:[{img:k.arab_tavern_c}],name:"Tavern",clss:"tavern",cost:[0,200,200,0],onbuild:d,actvintv:[a.iniMercenaries,a.iniHeroes],time:40,sight:5,resistance:150,health:1E3},{race:"arab",invType:1,invMax:0,iconID:87,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:k.build4x4,dimg:k.des_4x4,radix:0,url:k.arab_market,validator:T,build:1,icons:[a.createCaravan2],child:[{img:k.arab_market_c}],
name:"Market",clss:"market",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,iconID:98,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:k.build5x5,dimg:k.des_5x5,radix:0,url:k.arab_barracks,validator:T,build:1,icons:[a.createFootman2,a.createArcher2,a.createSatrap,a.createPikeman2,a.createHorseArcher2,a.createCavalry,a.createEnichar,a.createJihad],child:[{img:k.arab_barracks_c},{alpha:!0,img:k.arab_barracks_s,
rgb:[0,0,0,.5]}],name:"Barracks",clss:"barrack",cost:[0,0,200,200],time:60,sight:6,resistance:500,health:1400},{race:"arab",invType:1,invMax:0,iconID:91,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:k.build4x4,dimg:k.des_4x4,radix:0,url:k.arab_stables,validator:T,build:1,icons:[],child:[{img:k.arab_stables_c}],name:"Stable",clss:"stable",cost:[0,200,200,0],time:40,onbuild:c,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:50,iconID:89,zLevel:1,dieSound:N,
space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,4]),bimg:k.build4x4,dimg:k.des_4x4,radix:0,url:k.arab_outpost,validator:T,build:1,icons:[a.emergeAllUnits],child:[{img:k.arab_outpost_c,mv:1},{alpha:!0,img:k.arab_outpost_s,rgb:[0,0,0,.5]}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},{race:"arab",invType:1,invMax:0,iconID:105,zLevel:1,dieSound:N,space:23213123,bimg:k.build3x3,dimg:k.des_3x3,radix:0,url:0,img:0,validator:T,build:1,icons:[],child:[{img:3213123}],
name:"NULL",testing:1,clss:"castle",cost:[0,1500,0,1500],time:120,sight:12,resistance:1E3,health:8E3},{race:"arab",invType:1,invMax:0,iconID:88,zLevel:1,dieSound:N,space:new Uint8Array([0,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,0,6]),bimg:k.build5x5,dimg:k.des_5x5,radix:0,url:k.arab_mosque,validator:T,build:1,icons:[a.techFanaticism,a.techEspionage,a.techHealing,a.techBless,a.techJihad],child:[{img:k.arab_mosque_c},{alpha:!0,img:k.arab_mosque_s,rgb:[0,0,0,.5]}],name:"Mosque",
onbuild:[a.buildChurch2],clss:"mosque",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:86,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,4]),bimg:k.build4x4,dimg:k.des_4x4,radix:0,url:k.arab_magetower,validator:T,build:1,icons:[a.createMage2,a.techCarpet,a.techMagicWorkshop,a.techFireRain,a.techMagicVision,a.techNecromancy,a.techJinn],child:[{img:k.arab_magetower_c},{alpha:!0,img:k.arab_magetower_s,rgb:[0,0,0,.5]}],name:"Mage Guild",
clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:93,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,5]),bimg:k.build5x5,dimg:k.des_5x5,radix:0,url:k.arab_tc_guild,validator:T,build:1,icons:[a.techUsury,a.techTradeRoutes,a.techSupplyStorage,a.techBribery,a.techOreFloatation],child:[{img:k.arab_tcguild_c},{alpha:!0,img:k.arab_tc_guild_s,rgb:[0,0,0,.5]}],name:"Merchants Guild",clss:"tcguild",
cost:[2E3,0,0,2E3],time:90,onbuild:[a.buildMarket2],sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:94,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:k.build5x5,dimg:k.des_5x5,radix:0,url:k.arab_waracademy,validator:T,build:1,icons:[a.techHeroism,a.techWarfare,a.techMercenaries,a.techRiddingHorses,a.techBodyBuilding,a.techLeadership,a.techHeroes,a.techJanissary,a.techHonor,a.techFame],child:[{img:k.arab_waracademy_c},
{alpha:!0,img:k.arab_waracademy_s,rgb:[0,0,0,.5]}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:158,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:k.build3x3,dimg:k.des_3x3,radix:0,url:k.arab_magicworkshop,validator:T,build:1,icons:[a.createObjects],child:[{img:k.arab_magicworkshop_c},{alpha:!0,img:k.arab_magicworkshop_s,rgb:[0,0,0,.5]}],name:"Magic Workshop",disallowPoint:!0,clss:"magicworkshop",
cost:[0,0,0,300],time:20,sight:5,resistance:200,health:1200},{race:"asia",invType:1,invMax:0,iconID:161,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,0,1,3]),bimg:k.build3x3,dimg:k.des_3x3,radix:0,url:k.asia_houses,validator:T,build:1,icons:[],child:[{img:k.asia_houses_c}],name:"House",clss:"house",cost:[0,75,0,0],population:10,time:20,sight:4,resistance:50,health:500},{race:"asia",invType:1,invMax:0,iconID:149,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,1,1,1,1,1,3]),bimg:k.build3x3,
dimg:k.des_3x3,radix:0,storage:1,url:k.asia_lumbermill,validator:T,build:1,icons:[a.techWoodCutting,a.techCrossbow],child:[{img:k.asia_lumbermill_c},{img:k.asia_lumbermill_s,rgb:[0,0,0,.5],alpha:!0}],name:"Lumber Mill",clss:"lumber",cost:[0,100,0,0],time:30,sight:4,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:154,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:k.build4x4,dimg:k.des_4x4,radix:0,url:k.asia_storage,storage:0,validator:T,build:1,
icons:[a.techGoldMining,a.techStoneMining],child:[{img:k.asia_storage_s,rgb:[0,0,0,.5],alpha:!0},{img:k.asia_storage_c}],name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:147,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,4]),bimg:k.build4x4,dimg:k.des_4x4,radix:0,storage:2,url:k.asia_farm,validator:T,build:1,icons:[a.techCropRotation,a.ridingHorses,a.irrigation],child:[{img:k.asia_farm_c}],name:"Farm",
clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:148,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,1,1,1,1,1,3]),validator:jf,bimg:k.build_harbor,dimg:k.des_harbor,radix:0,url:k.asia_harbor,build:1,icons:[a.createFishingBoat,a.createXebec,a.createHulk,a.techLandingTactics],child:[{img:k.asia_harbor_c},{img:k.asia_harbor_s,rgb:[0,0,0,.5],alpha:!0}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},
{race:"asia",invType:1,invMax:0,iconID:145,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:k.build5x5,dimg:k.des_5x5,radix:0,url:k.asia_blacksmith,validator:T,build:1,icons:[a.techTemperIron,a.techScaleArmor,a.techArmoredChariot,a.techChainMail],child:[{img:k.asia_blacksmith_c},{img:k.asia_blacksmith_s,rgb:[0,0,0,.5],alpha:!0}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,150,0],time:40,sight:5,onbuild:b,resistance:80,health:800},{race:"asia",
invType:1,invMax:0,iconID:157,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:k.build4x4,dimg:k.des_4x4,radix:0,url:k.asia_workshop,validator:T,build:1,icons:[a.createCatapult,a.createBallist,a.techEngineering,a.techCannonTower],child:[{img:k.asia_workshop_c,x:0,y:0},{img:k.asia_workshop_s,rgb:[0,0,0,.5],alpha:!0}],name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:162,zLevel:1,dieSound:N,
space:new Uint8Array([0,1,1,0,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,1,0,0,1,1,0,5]),bimg:k.build5x5,dimg:k.des_5x5,radix:0,url:k.asian_monastery,validator:T,build:1,icons:[a.createMonk,a.createPriest1],child:[{img:k.asian_monastery_c},{img:k.asian_monastery_s,rgb:[0,0,0,.5],alpha:!0}],name:"Monastery",clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"asia",invType:1,invMax:0,iconID:155,zLevel:1,dieSound:N,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:k.build4x4,
dimg:k.des_4x4,radix:0,url:k.asia_tavern,validator:T,build:1,icons:[a.createMercenaries,a.createHeroes],child:[{img:k.asia_tavern_c},{img:k.asia_tavern_s,rgb:[0,0,0,.5],alpha:!0}],onbuild:d,name:"Tavern",clss:"tavern",actvintv:[a.iniMercenaries,a.iniHeroes],cost:[0,200,200,0],time:40,sight:5,resistance:150,health:1E3},{race:"asia",invType:1,invMax:0,iconID:150,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,4]),bimg:k.build4x4,dimg:k.des_4x4,radix:0,url:k.asia_market,validator:T,
build:1,icons:[],child:[{img:k.asia_market_c}],name:"Market",clss:"market",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:153,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:k.build4x4,dimg:k.des_4x4,radix:0,url:k.asia_stables,validator:T,build:1,icons:[],child:[{img:k.asia_stables_c,mv:!0},{img:k.asia_stables_s,rgb:[0,0,0,.5],alpha:!0}],name:"Stable",clss:"stable",onbuild:c,cost:[0,200,200,0],time:40,sight:5,
resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:151,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:k.build3x3,dimg:k.des_3x3,radix:0,url:k.asia_outpost,validator:T,build:1,icons:[a.emergeAllUnits],child:[{img:k.asia_outpost_c,mv:1},{img:k.asia_outpost_s,rgb:[0,0,0,.5],alpha:!0}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},{race:"asia",invType:1,invMax:0,iconID:163,zLevel:1,dieSound:N,space:new Uint8Array([0,0,1,
1,0,0,0,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,0,6]),bimg:k.build6x6,dimg:k.des_6x6,radix:0,url:k.asia_shao_lin,validator:T,build:1,icons:[a.techMeditation,a.techKungFu,a.techHealing,a.techPhilosophy,a.techNinjas,a.techMastery,a.techTournaments,a.techMedicine],child:[{img:k.asia_shao_lin_c},{img:k.asia_shao_lin_s,rgb:[0,0,0,.5],alpha:!0}],name:"Shao Linn",onbuild:[a.buildChurch1],clss:"shaolinn",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,
invMax:0,iconID:152,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:k.build5x5,dimg:k.des_5x5,radix:0,url:k.asia_wizardguild,validator:T,build:1,icons:[a.createMage1,a.techConcentration,a.techWhirlpool,a.techFlameBolt,a.techTurnToStone,a.techConfusion,a.techDragon],child:[{img:k.asia_wizardguild_c},{img:k.asia_wizardguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Mage Guild",clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},
{race:"asia",invType:1,invMax:0,iconID:159,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:k.build5x5,dimg:k.des_5x5,radix:0,url:k.asia_tcguild,validator:T,build:1,icons:[a.techTradeRoutes,a.techUsury,a.techJewelry,a.techSupplyStorage,a.techBanking,a.techChemistry,a.techSeaFood,a.techGunPowder,a.techRocketArrow],child:[{img:k.asia_tcguild_c,mv:!0},{img:k.asia_tcguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,
0,2E3],time:90,onbuild:[a.buildMarket1],sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:156,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:k.build5x5,dimg:k.des_5x5,radix:0,url:k.asia_warguild,validator:T,build:1,icons:[a.techBushido,a.techHeroism,a.techWarfare,a.techMercenaries,a.techLeadership,a.techTactics,a.techHeroes,a.techHonor,a.techSunTzu],child:[{img:k.asia_warguild_c,mv:!0},{img:k.asia_warguild_s,rgb:[0,0,0,
.5],alpha:!0}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:0,invMax:0,iconID:166,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:k.asian_priest,img:k.asian_priest.idle,spd:50,validator:Y,human:1,icons:[a.attack,a.stop,a.stand,a.pickUp,a.explore,a.healing,a.teach,a.move],name:"Priest",clss:"priest",cost:[170,0,0,0],time:30,sight:21,health:120,standardFunc:U,attDist:1,attack:10,defence:10,mana:100,update:["mana","manaSpeed",
1E3],manaMax:100},{race:"asia",invType:0,invMax:0,iconID:187,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:k.asian_monk,img:k.asian_monk.idle,spd:50,validator:Y,human:1,icons:e,name:"Monk",standardFunc:U,clss:"monk",cost:[0,0,200,0],time:20,sight:5,health:90,attack:6,defence:6,attDist:1},{race:"asia",invType:0,invMax:0,iconID:134,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:k.asian_mage,img:k.asian_mage.idle,spd:50,attimg:k.flame_bolt,validator:Y,standardFunc:U,human:1,icons:[a.stop,
a.pickUp,a.explore,a.confusion,a.turnToStone,a.whirlpool,a.flameBolt,a.createDragon,a.attack,a.stand,a.move],name:"Mage",clss:"mage",cost:[150,0,0,0],ball:1,time:30,sight:15,mana:100,attDist:10,health:60,attack:8,defence:0,update:["mana","manaSpeed",1E3],manaMax:100},{radix:0,name:"Dragon",strID:"dragon",defence:0,attack:25,health:300,maxHealth:300,img:k.dragon.idle,invType:0,invMax:0,dieSound:[],sSizex:2,sSizey:2,dragon:1,iconID:160,race:"common",zLevel:2,nofreeze:1,attackSound:[],sight:12,standardFunc:U,
url:k.dragon,icons:e,cost:[80,0,0,0,800],attDist:2,spd:128,clss:"drg",size:1,z32:1.5,validator:kf},{radix:0,name:"Carpet",strID:"carpet",defence:0,attack:0,health:90,maxHealth:90,img:k.carpet.idle,invType:1,invMax:8,dieSound:[],iconID:131,race:"common",zLevel:2,nofreeze:1,attackSound:[],sight:8,url:k.carpet,icons:[a.move,a.unload,a.explore,a.stop,a.stand],cost:[80,0,0,0,500],attDist:2,spd:120,clss:"carpet",size:1,z32:1.5,validator:kf},{radix:0,name:"Jinn",strID:"jinn",defence:5,attack:20,health:300,
maxHealth:300,img:k.arab_jinn.idle,invType:0,invMax:0,dieSound:[],validator:Y,iconID:182,race:"common",zLevel:1,nofreeze:1,attackSound:[],sight:8,standardFunc:U,url:k.arab_jinn,icons:e,w:1,cost:[80,0,0,0,300],attDist:1,spd:85,clss:"jinn",size:1}];Rc={};Jg={arr:[]};Qa={euro:[],asia:[],arab:[],common:[]};pd=[];m=0;for(l=w.length;m<l;m++){e=w[m];w[m].type=m;g=e.space;e.name.split(" ").join("");e.population&&pd.put(e);Rc[m]={};ab[e.race][e.name.toLowerCase().split(" ").join("")]=e;e.icons.menuName=e.strID;
Jg[e.name]=m;Jg.arr.put(m);e.img||(e.img=e.url);e.maxHealth=e.health;e.race&&Qa[e.race].put(e);d=0;c=e.icons;for(h=c.length;d<h;d++)(f=c[d])&&f.obj&&(f.orderOrigin=e);if(g){d=[];e.free=d;f=g[g.length-1];b=(g.length-1)/f;e=f+2;h=b+2;c=new Uint8Array(e*h);for(p=0;p<b;p++)for(var n=0;n<f;n++)c[(p+1)*e+n+1]=g[n+p*f];p=0;for(h*=e;p<h;p++)!c[p]&&(c[p+1]||c[p-1]||c[p+1+e]||c[p+1-e]||c[p-1+e]||c[p-1-e]||c[p+e]||c[p-e])&&(d.put(p%e-1),d.put(~~(p/e)-1))}}Qa.euro=Qa.euro.concat(Qa.common);Qa.asia=Qa.asia.concat(Qa.common);
Qa.arab=Qa.arab.concat(Qa.common);Qa[0]=Qa.euro;Qa[1]=Qa.arab;Qa[2]=Qa.asian;c=ab.euro;h=ab.asia;f=ab.arab;b=ab.common;ab[0]=ab.euro;ab[1]=ab.arab;ab[2]=ab.asia;d=[c.knight,h.horsesamurai,f.cavalry,f.enichar,c.crusader,h.chariot,h.horsearcher,f.horsearcher];m=[h.horsesamurai,c.crusader,f.enichar];e=[c.knight,f.cavalry,h.chariot,h.horsearcher,f.horsearcher];p=[c.longbowman,f.archer,h.archer,c.archer];l=[b.catapult,b.ballista,b.heavycatapult];g=[b.galleon,b.hulk,b.pinque,b.fishingboat];n=[b.galleon,
b.hulk,b.pinque];var q=[f.satrap,c.maceman],r=[c.longbowman,f.archer,h.archer,c.archer,h.horsearcher,f.horsearcher,b.pinque,b.watchtower,b.keeptower,b.guardtower],u=[b.stonegolem,b.ork,b.dwarf,b.skeleton,b.ghost,b.dragon,b.jinn,b.bat,c.wizard,f.mage,h.mage],v=[c.peasant,h.peasant,f.peasant,c.footman,f.footman,h.ronin,c.pikeman,f.spearman,f.satrap,c.maceman,f.cavalry,f.jihadwarrior,b.spy,f.enichar,h.horsesamurai,h.monk,h.chariot,h.ninja,b.stonegolem,b.ork,b.dwarf,b.jinn,b.skeleton,b.ghost,c.knight,
c.crusader],x=[b.watchtower,b.keeptower,b.guardtower,b.cannontower],z=[b.cannontower,h.rockettower],y=[c.cathedral,c.castle,b.woodenwall,c.barracks,c.lumbermill,c.magetower,c.warriorsguild,c.storage,c.farm,c.merchantsguild,c.church,c.blacksmith,c.stable,c.workshop,c.tavern,c.house,b.watchtower,c.market,c.outpost,b.bridge,c.harbor,b.guardtower,b.keeptower,b.cannontower,h.rockettower,h.castle,f.castle,h.barracks,f.house,f.lumbermill,f.storage,f.farm,f.harbor,f.blacksmith,f.workshop,f.church,f.tavern,
f.market,f.barracks,f.stable,f.outpost,f.mosque,f.mageguild,f.merchantsguild,f.warriorsguild,f.magicworkshop,h.house,h.lumbermill,h.storage,h.farm,h.harbor,h.blacksmith,h.workshop,h.monastery,h.tavern,h.market,h.stable,h.outpost,h.shaolinn,h.mageguild,h.merchantsguild,h.warriorsguild],A=[c.cathedral,c.castle,b.woodenwall,c.barracks,c.lumbermill,c.magetower,c.warriorsguild,c.storage,c.farm,c.merchantsguild,c.church,c.blacksmith,c.stable,c.workshop,c.tavern,c.house,b.watchtower,c.market,c.outpost,b.bridge,
c.harbor,h.castle,f.castle,h.barracks,f.house,f.lumbermill,f.storage,f.farm,f.harbor,f.blacksmith,f.workshop,f.church,f.tavern,f.market,f.barracks,f.stable,f.outpost,f.mosque,f.mageguild,f.merchantsguild,f.warriorsguild,f.magicworkshop,h.house,h.lumbermill,h.storage,h.farm,h.harbor,h.blacksmith,h.workshop,h.monastery,h.tavern,h.market,h.stable,h.outpost,h.shaolinn,h.mageguild,h.merchantsguild,h.warriorsguild],B=[b.catapult,b.heavycatapult],D=[c.pikeman,f.spearman],C=[h.monk,h.priest],K=[b.woodenwall],
H=[c.peasant,h.peasant,f.peasant],I=[c.wizard,f.mage,h.mage],G=[c.footman,f.footman,h.ronin],R=[c.priest,f.priest,h.priest];Ab={bless:{img:k.bless,d:0,mv:1},star:{img:k.star,d:0,mv:1},heal:{img:k.healing,d:0,mv:1},impersonate:{img:k.impersonate,d:0,mv:1},select:{img:k.select,d:0,mv:0,select:1,z32:.8},spawn:{img:k.spawn,d:0,mv:1},curse:{img:k.curse,d:0,mv:1},turnStone:{img:k.turn_to_stone,d:0,mv:1}};var L=function(a,b,c){for(var f=a.length,e=0,d=b.length;e<d;e++)for(var h=0;h<f;h++)Rc[a[h].type][b[e].type]=
c};L(z,n,4);L(n,n,3);L(n,A,3);L(n,x,3);L(n,K,5);L(n,l,2);L(B,A,4);L(B,g,4);L(B,x,6);L(B,l,4);L(B,K,9);L([h.samurai],m,.5);L([h.samurai],e,.3);L([h.ronin],H,1);L(D,d,6);L(G,D,1.5);L(G,p,1.5);L(G,[f.jihadwarrior],1);L([f.satrap],H,2);L(q,l,1.5);L(r,[b.dragon],.75);L(r,[b.bat],1);L(r,[c.pikeman],-.75);L(r,q,1);L(r,[h.chariot],-.3);L(r,C,.5);L(I,R,4);L(R,I,3);L(R,u,3);L(v,[b.bat],-.2);L(v,[b.dragon],-.5);L([b.stonegolem],y,1);L([b.dwarf],y,4);L(u,[h.priest],-.5);Ea={img:k.gath_point,x32:-10,y32:-10,d:0,
mv:!0};Bf=[Ea];e=ya;p=Object.keys(e);for(d=0;d<w.length;d++)for(l=w[d],m=0;m<p.length;m++)l[p[m]]=e[p[m]];d=[c.archer,c.longbowman,h.archer,h.horsearcher,f.archer,f.horsearcher];m=[c.footman,c.maceman,c.knight,c.crusader,c.pikeman,f.jihadwarrior,f.cavalry,f.footman,f.enichar,c.peasant,f.peasant,f.satrap,f.spearman,b.spy,h.chariot,h.monk,h.samurai,h.ronin,h.horsesamurai,h.ninja,h.peasant,b.skeleton,b.ghost,b.ork,b.dwarf];e=[c.footman,c.maceman,c.knight,c.crusader,c.pikeman,f.jihadwarrior,f.cavalry,
f.footman,f.enichar,c.peasant,f.peasant,f.satrap,f.spearman,b.spy,h.chariot,h.monk,h.samurai,h.ronin,h.horsesamurai,h.ninja,h.peasant,c.archer,c.longbowman,h.archer,h.horsearcher,f.archer,f.horsearcher,c.wizard,f.mage,h.mage,c.priest,f.priest,h.priest,b.skeleton,b.ghost,b.ork,b.dwarf];F=[{name:["Longbow","Allows the production of longbowmen"],next:[a.createLongbowman],cost:[400,0,0,0],time:45,type:P},{name:["Gold Mining","Increases gold production"],increase:2,value:"gold",cost:[400,0,0,0],time:20,
type:Oa},{name:["Stone Mining","Increases stone production"],increase:2,value:"stone",cost:[400,0,0,0],time:20,type:Oa},{name:["Wood Cutting","Increases wood production"],increase:2,value:"wood",cost:[400,0,0,0],time:20,type:Oa},{name:["Temper Iron","Increases hand-to-hand units' attack power"],increase:2,value:"attack",cost:[400,0,0,0],time:30,group:m,next:[a.techHalberd],type:kb},{name:["Scale Armor","Increases unit's defense"],increase:1,value:"defence",cost:[400,0,0,0],time:30,group:e,next:[a.techChainMail],
type:kb},{name:["Halberd","Allows the production of spear units"],next:[a.createPikeman,a.createPikeman2],cost:[400,0,0,0],time:30,type:P},{name:["Domestication","Allows the production of cows"],next:[a.createCow],cost:[300,0,0,0],time:20,type:P},{name:["Crop Rotation","Increases the production of fields"],increase:2,value:"food",cost:[400,0,0,0],time:20,type:Oa,next:[a.irrigation]},{name:["Chain Mail","Increases unit's defense"],increase:2,value:"defence",cost:[400,0,0,0],time:30,group:e,type:kb},
{name:["Plate Armor","Allows the production of knights"],next:[a.createKnight],cost:[400,0,0,0],time:60,type:P},{name:["Crossbow","Increases arrow units' attack power"],increase:2,value:"attack",cost:[400,0,0,0],time:30,group:d,type:kb},{name:["Feudalism","Makes peasants cheaper"],cost:[300,0,0,0],time:30,decrease:[h.peasant,[0,0,8,0],c.peasant,[0,0,10,0],f.peasant,[0,0,10,0]],type:ig,next:[a.techSlavery]},{name:["Architecture","Peasants build faster, and allows stone wall, gate and towers"],increase:.5,
value:"buildSpeed",cost:[300,0,0,0],time:30,type:Oa,next:[a.upgradeStoneTower,a.techGreatWall,a.buildBridge]},{name:["Learning","Allows units to gather experience"],increase:1,value:"experience",cost:[400,0,0,0],time:30,type:Oa,next:[a.buildAcademy,a.buildAcademy1,a.buildAcademy2]},{name:["Convert Resources",""],cost:[400,0,0,0],time:30},{name:["Map Making","Allows the production of galleons"],cost:[800,0,0,0],time:30,type:P},{name:["Trade Routes","Allows trading"],cost:[400,0,0,0],time:30,type:P,
next:[a.techTradeTaxes]},{name:["Trade Taxes","Increases trade profit"],cost:[400,0,0,0],time:30},{name:["Usury","Allows the obtaining of loans in taverns"],cost:[300,0,0,0],time:30,type:oe,changeicon:38,next:[a.techBanking]},{name:["Supply Storage","Increases the population limit"],cost:[500,0,0,0],time:30,increase:50,type:Oa,value:"popLimit",next:[a.techSeaFood]},{name:["Bribery","Allows the bribing of enemy units"],cost:[600,0,0,0],time:60,type:P,next:[a.bribe]},{name:["Heroism","Allows unlimited experience"],
cost:[500,0,0,0],time:30,increase:Infinity,value:"maxLevel",type:Oa,next:[a.techLeadership]},{name:["Warfare","Gain experience faster"],cost:[400,0,0,0],time:30,type:Oa,increase:1,value:"experience",next:[a.techTactics]},{name:["Tactics","Gain experience faster"],cost:[800,0,0,0],time:30,type:P,next:[a.buildDummy,a.techSunTzu]},{name:["Mercenaries","Allows the recruitment of units in taverns"],cost:[600,0,0,0],time:30,type:oe,next:[a.techHeroes,a.createMercenaries],actvintv:[a.iniMercenaries]},{name:["Heroes' Quest",
"Allows the recruitment of heroes in taverns"],cost:[800,0,0,0],time:30,type:oe,next:[a.techFame,a.createHeroes],actvintv:[a.iniHeroes]},{name:["Fame","Recruit better units from taverns"],cost:[500,0,0,0],time:30,value:"fameTech",increase:1,type:Oa},{name:["Siege Tactics","Allows the production of heavy catapults"],cost:[1200,0,0,0],time:60,type:P,next:[a.createHeavyCatapult]},{name:["Body Building","Increases unit's hit points at every new level"],cost:[800,0,0,0],time:60,value:"healthJump",increase:5,
type:Oa},{name:["Espionage","Allows the production of a spy"],cost:[400,0,0,0],time:30,type:P,next:[a.createSpy]},{name:["Fanaticism","Increases the building's resistance"],cost:[400,0,0,0],time:30,type:kb,group:[],increase:5,value:"resistance",next:[a.techCrusade,a.techJihad]},{name:["Crusade","Allows the preaching of a crusade"],cost:[1200,0,0,0],time:180,type:P,next:[a.createCrusaders]},{name:["Inquisition","Increases priest attack"],cost:[400,0,0,0],time:30,type:kb,group:[c.priest,f.priest,h.priest],
increase:5,value:"attack"},{name:["Healing","Allows healing of units"],cost:[400,0,0,0],time:30,next:[a.techMedicine,a.healing],type:P},{name:["Medicine","Allows remote healing of units"],cost:[500,0,0,0],time:30,value:"healingRange",increase:5,type:Oa},{name:["Bless","Temporarily increases unit attack skill"],cost:[400,0,0,0],time:30,type:P,next:[a.bless]},{name:["Invisibility","Invisibility spell"],cost:[500,0,0,0],time:30,type:P,next:[a.invisibility]},{name:["Bat","Researches bat summoning"],cost:[400,
0,0,0],time:240,type:P,next:[a.createBat]},{name:["Freeze","Freeze spell"],cost:[800,0,0,0],time:30,type:P,next:[a.freeze]},{name:["Lightning","Lightning spell"],cost:[400,0,0,0],time:30,type:P,next:[a.lightning]},{name:["Stone Golem","Researches stone golem summoning"],cost:[800,0,0,0],time:120,type:P,next:[a.createGolem]},{name:"Upgrade to Guard Tower",cost:[0,600,0,0],time:20,type:ud,obj:44,upgrade:1},{name:"Upgrade to Stone Tower",cost:[0,0,0,500],time:30,type:ud,obj:55,upgrade:1},{name:"Upgrade to Cannon Tower",
cost:[0,0,0,500],time:30,type:ud,obj:56,upgrade:1},{name:["Buddhism"],cost:[400,0,0,0],time:30,type:P,next:[a.buildCathedral1]},{name:["Cannon Tower","Allows the building of cannon towers"],next:[a.upgradeCannonTower],cost:[400,0,0,0],time:30,type:P},{name:["Engineering","Increases siege weapon's attack"],increase:5,value:"attack",cost:[400,0,0,0],time:30,group:[b.ballista,b.catapult,b.heavycatapult],type:kb},{name:["Great Wall","Makes stone walls, towers and gates stronger"],cost:[600,0,0,0],time:30,
type:P},{name:["Art of Riding","Allows the production of horse archers"],cost:[500,0,0,0],time:30,type:P,next:[a.createHorseArcher1,a.createHorseArcher2,a.techHorseManShip]},{name:["Irrigation","Increases field production"],increase:4,value:"food",cost:[400,0,0,0],time:30,type:Oa},{name:["Armored Chariot","Allows the production of armored chariots"],cost:[500,0,0,0],time:60,type:P,next:[a.createChariot]},{name:["Meditation","Makes monks cheaper"],cost:[300,0,0,0],time:30,decrease:[0,0,50,0],type:pe,
next:[a.techPhilosophy],group:[h.monk]},{name:["Kung-Fu","Increases the attack of all kung-fu units"],cost:[400,0,0,0],time:30,type:kb,increase:1,value:"attack",group:[h.peasant,h.ninja,h.monk,h.priest],next:[a.techMastery,a.techNinjas,a.techTournaments]},{name:["Tournaments","Allows sharing of experience between kung-fu units"],cost:[800,0,0,0],time:30,type:P,next:[]},{name:["Philosophy","Allows the production of more experienced monks"],cost:[400,0,0,0],time:30,type:kb,increase:2,value:"level",
group:[h.monk,h.priest],next:[a.createPriest1]},{name:["Ninjas","Allows the production of ninjas"],cost:[500,0,0,0],time:30,type:P,next:[a.createNinja]},{name:["Mastery","Allows priests to teach kung-fu units"],cost:[500,0,0,0],time:30,type:P,next:[a.teach]},{name:["Concentration","Allows faster manna restoration"],cost:[600,0,0,0],time:80,type:P,next:[a.techConfusion]},{name:["Confusion","Researches the Confusion spell"],cost:[400,0,0,0],time:30,type:P,next:[a.confusion]},{name:["Whirlpool","Researches the Whirlpool spell"],
cost:[300,0,0,0],time:30,type:P,next:[a.whirlpool]},{name:["Dragon","Researches Dragon summoning"],cost:[800,0,0,0],time:300,type:P,next:[a.createDragon]},{name:["Turn to Stone","Researches the Turn to Stone spell"],cost:[300,0,0,0],time:30,type:P,next:[a.turnToStone]},{name:["Flame Bolt","Researches the Flame Bolt spell"],cost:[400,0,0,0],time:30,type:P,next:[a.techDragon,a.flameBolt]},{name:["Jewelry","Allows trading of items"],cost:[400,0,0,0],time:30,type:P,next:[a.sellItems,a.buyItems]},{name:["Banking",
"Increases trade profit"],cost:[600,0,0,0],time:30,type:P},{name:["Chemistry","Increases arrow units' attack power"],cost:[500,0,0,0],time:30,type:kb,group:d,increase:1,value:"attack",next:[a.techGunPowder]},{name:["Sea Food","Increases the population limit"],cost:[500,0,0,0],time:30,increase:50,type:Oa,value:"popLimit"},{name:["Gun Powder","Increases cannon tower's attack power"],cost:[500,0,0,0],time:30,type:kb,increase:10,value:"attack",group:[b.cannontower],next:[a.techRocketArrow]},{name:["Rocket Arrow",
"Allows the building of rocket tower"],cost:[800,0,0,0],time:30,type:P,next:[a.buildRocketTower]},{name:["Bushido","Allows the production of horse samurai"],cost:[800,0,0,0],time:120,type:P,next:[a.createHorseSamurai]},{name:["Leadership","Units around a hero gain experience"],cost:[600,0,0,0],time:30,type:P,next:[a.techHonor]},{name:["Honor","Hero vs. hero attack bonus"],cost:[500,0,0,0],time:30,type:P},{name:["Sun Tzu's Book","Increases the speed of learning"],cost:[800,0,0,0],time:30,type:Oa,increase:1,
value:"experience"},{name:["Cow Poaching","Allows peasants to steal cows"],cost:[200,0,0,0],time:30,type:Oa,increase:1,value:"stealCows"},{name:["Horsemanship","Makes mounted units cheaper"],cost:[500,0,0,0],time:30,type:pe,mulp:.75,group:[h.horsearcher,f.cavalry,f.horsearcher]},{name:["Scimitar","Increases sword attack power and allows the production of satraps"],cost:[400,0,0,0],time:30,type:kb,increase:1,value:"attack",group:m,next:[a.createSatrap]},{name:["Jihad","Allows the production of Jihad Warriors"],
cost:[1200,0,0,0],time:30,type:P,next:[a.createJihad,a.convertJihad]},{name:["Magic Carpet","Researches Magic Carpet summoning"],cost:[300,0,0,0],time:30,type:P,next:[a.createCarpet,a.techJinn]},{name:["Magic Workshop","Allows the building of a magic workshop"],cost:[1200,0,0,0],time:180,type:P,next:[a.buildMagicWorkshop]},{name:["Rain of Fire",""],cost:[800,0,0,0],time:60,type:P,next:[a.fireRain]},{name:["Magic Vision","Researches the Magic Vision spell"],cost:[400,0,0,0],time:30,type:P,next:[a.magicVision]},
{name:["Necromancy","Researches the Raise the Dead spell"],cost:[400,0,0,0],time:30,type:P,next:[a.raiseDead]},{name:["Jinn","Researches Jinn summoning"],cost:[600,0,0,0],time:300,type:P,next:[a.createJinn]},{name:["Ore Enrichment","Increases mine production"],cost:[800,0,0,0],time:30,type:Oa,increase:1,value:"miningPerf"},{name:["Riding Horses","Increases the mounted units' attack and defense power"],cost:[500,0,0,0],time:30,type:Sh,values:["attack",2,"defence",1],group:[h.horsearcher,f.cavalry,
f.horsearcher],next:[a.techJanissary]},{name:["Janissary","Allows the production of Janissaries"],cost:[1200,0,0,0],time:120,type:P,next:[a.createEnichar]},{name:["Slavery","Makes peasants cheaper"],cost:[200,0,0,0],time:30,decrease:[h.peasant,[0,0,7,0],c.peasant,[0,0,8,0],f.peasant,[0,0,8,0]],type:ig}];Vi();a.buildMarket.disabled=1;Wi();m=0;for(l=w.length;m<l;m++)if(e=w[m],e.onbuild)for(c=e.onbuild,d=0,h=c.length;d<h;d++)f=c[d],f.obj.race==e.race&&(f.disabled=1,f.require=e.name,f.requireObj||(f.requireObj=
[]),f.requireObj.put(e));d=0;for(h=F.length;d<h;d++)if(f=F[d],f.tech=1,f.id=d,f.next)for(c=f.next,p=0,m=c.length;p<m;p++)e=c[p],e.disabled?(e.disabled++,e.require+=", "+f.name[0],e.requireObj.put(f)):(e.requireObj=[f],e.disabled=1,e.require=f.name[0]);d=0;c=w;for(h=c.length;d<h;Rj(c[d++]));}new cc("",[255,255,255],[0],!0)},w,Rc,Jg,Ea,Bf,pd,Kg=8,v=new Float32Array(16),fc=function(a,b,e,c,d,h,l){var f=w[a];if(h=h&&!f.instantBuild)this.built=!1;var g=K[b],k=g.mod[a],n=Object.keys(k);this.__proto__=f;
this.kingdom=b;this.d=d;this.x32=e;this.y32=c;this.taskList=[];d=0;for(var q=n.length;d<q;this[n[d]]=k[n[d++]]);if(l)for(k=Object.keys(l),d=0,q=k.length;d<q;this[k[d]]=l[k[d++]]);0<f.invMax&&(this.inventory=[]);f.build||(this.mv=1);l=g.technology.disabled;k=f.actvintv;this.workers=[];this.id=q=y.length;f.rndDirection&&(this.d=q*e%f.rndDirection);this.build||g.values.pop++;e=f.validator(e,c,f.space,b);if(e[1]){c=f.validator.dimension;n=e[0];if(h){c=ra;this.onbuild1=n;var r=qb[b];d=0;for(f=n.length;d<
f;d++)r[n[d]]=q}else for(d=0,f=n.length;d<f;c[n[d++]]=q);if(e[2])if(n=e[2],h){M(n);d=0;for(f=n.length;d<f;c[n[d++]]=q);this.onbuildValid=n}else for(d=0,f=n.length;d<f;c[n[d++]]=0);}else return this.invalid=!0,!1;y[q]=this;eb[b][a].put(q);if(this.update&&!u.custom)for(a=this.update,d=0,q=a.length;d<q;d+=3)va({func:ge,data:[this.id,a[d],a[d+1],a[d+2]]},a[d+2],1);if(k)for(a=0,f=k.length;a<f;a++)b=k[a],l[b.id]||b(this);h?(Sa(this),z.kingdom==this.kingdom?(M(h),Yc(this,Xj)):Yc(this,ag)):Sa(this);this.level&&
!this.potion&&Nh(this);!this.standardFunc||this.func||u.editor||this.standardFunc(this);h=g.stats;h.unitCount[this.type]++;g=h.unitCount[this.type]-h.unitCountDeath[this.type];g>h.unitCountMax[this.type]&&(h.unitCountMax[this.type]=g)},Xh=function(a){var b=K[a.kingdom];if(a.population){var f=a.population;b.values.popMax+=f;td(a.kingdom);for(var c=0;c<f;c++)b.checkPopArray()}if(a.onbuild)for(a=a.onbuild,f=b.technology,b=f.disabled,f=f.actived,c=0;c<a.length;c++){var d=a[c].id;f[d]||(f[d]=0);f[d]++;
f[d]-1||(b[d]--,!b[d]&&ka.actv[d]&&ka(S.active))}},Zb=[],Q=new Float32Array(12),Lg=function(a,b,e){var c=a.length;a[c]=b;a[c+1]=b+1;a[c+2]=b+2;a[c+3]=b+1;a[c+4]=b+2;a[c+5]=b+3;a.changed=!0;e.typeBuffer=a;e.elemtId=c},Yc=function(a,b){var f=b[3];if(b.noAlpha)c=pa;else{a.alpha=!0;var c=ha}if(a.typeBuffer!==c){if(b==ag){if(Va.diplomacy[a.kingdom]){vb(a);return}b=new Float32Array(wb(za[3*a.kingdom],za[3*a.kingdom+1],za[3*a.kingdom+2],f+1))}vb(a);Lg(c,a.bufferID,a)}g.bindBuffer(g.ARRAY_BUFFER,Ya);g.bufferSubData(g.ARRAY_BUFFER,
16*a.bufferID,b)},ic=function(a){var b=lf(a,a.kingdom),f=b[0],c=b[1],d=b[2];b=b[3];var h=a.bufferID;Xi(f,c,d,b,a.bufferID);1>b?(a.alpha=!0,f=ha):f=pa;a.typeBuffer!==f&&(vb(a),Lg(f,h,a));if(a.child&&(!1!==a.built||!a.build))for(var l=a.child,g=0,k=l.length;g<k;g++)h+=4,b=lf(l[g],a.kingdom),f=b[0],c=b[1],d=b[2],b=b[3],Xi(f,c,d,b,h)},lf=function(a,b){if(null!=a.rgb){var f=a.rgb;a=f[0];var c=f[1];b=f[2];f=f[3]}else ta[a.img][3]?(a=za[3*b],c=za[3*b+1],b=za[3*b+2],f=2):(a.mMapcolor?(b=a.mMapcolor,a=b[0]/
255,c=b[1]/255,b=b[2]/255):(a=za[3*b],c=za[3*b+1],b=za[3*b+2]),f=1);return[a,c,b,f]},Yi=function(){if(Zb.length){var a=Zb[Zb.length-1];Zb.length--}else a=Kg,Kg+=4;return a},Sa=function(a,b,e,c){void 0==b&&(c=e=b=0);var f=ta[a.img],h=1;if(a.bufferID){var l=a.bufferID;h=0}else l=Yi();a.bufferID=l;var k=f[2]*a.d*6+4,p=f[4+k],m=f[5+k];k=f[0];var n=f[1];0<=n&&(n*=.001);var q=f.id+4*a.d*f[2],r=-1;a.mv&&(r=u.now());v[0]=q;v[1]=r;v[2]=k;v[3]=n;v[4]=q+1;v[5]=r;v[6]=k;v[7]=n;v[8]=q+2;v[9]=r;v[10]=k;v[11]=n;
v[12]=q+3;v[13]=r;v[14]=k;v[15]=n;var w=32*a.x32,x=32*a.y32;k=32*a.y32;null!=a&&null!=a.z32&&(k*=a.z32);var z=pa;g.bindBuffer(g.ARRAY_BUFFER,Nc);g.bufferSubData(g.ARRAY_BUFFER,16*l,v);g.bindBuffer(g.ARRAY_BUFFER,Sb);if(a.rotation){var y=a.rotation;y*=2*Math.PI;var A=.5*f[8];n=.5*f[9];f=-1*k;q=-A;r=-n;var B=0*Q.length;Q[B]=q*Math.cos(y)-n*Math.sin(y)+w;Q[B+1]=n*Math.cos(y)+q*Math.sin(y)+x;Q[B+2]=f;Q[B+3]=q*Math.cos(y)-r*Math.sin(y)+w;Q[B+4]=r*Math.cos(y)+q*Math.sin(y)+x;Q[B+5]=f;Q[B+6]=A*Math.cos(y)-
n*Math.sin(y)+w;Q[B+7]=n*Math.cos(y)+A*Math.sin(y)+x;Q[B+8]=f;Q[B+9]=A*Math.cos(y)-r*Math.sin(y)+w;Q[B+10]=r*Math.cos(y)+A*Math.sin(y)+x;Q[B+11]=f}else a.wh?(y=a.wh[0],A=a.wh[1],y-=p,A-=m,Q[0]=w,Q[1]=x,Q[2]=k,Q[3]=w+y,Q[4]=x,Q[5]=k,Q[6]=w,Q[7]=x+A,Q[8]=k,Q[9]=w+y,Q[10]=x+A):(Q[0]=w,Q[1]=x,Q[2]=k,Q[3]=w,Q[4]=x,Q[5]=k,Q[6]=w,Q[7]=x,Q[8]=k,Q[9]=w,Q[10]=x),Q[11]=k;g.bufferSubData(g.ARRAY_BUFFER,12*l,Q);r=lf(a,a.kingdom);f=r[0];n=r[1];q=r[2];r=r[3];if(1>r||a.alpha)a.alpha=!0,z=ha;g.bindBuffer(g.ARRAY_BUFFER,
Ya);v[0]=f;v[1]=n;v[2]=q;v[3]=r;v[4]=f;v[5]=n;v[6]=q;v[7]=r;v[8]=f;v[9]=n;v[10]=q;v[11]=r;v[12]=f;v[13]=n;v[14]=q;v[15]=r;g.bufferSubData(g.ARRAY_BUFFER,16*l,v);g.bindBuffer(g.ARRAY_BUFFER,hd);y=u.now();v[0]=b;v[1]=e;v[2]=c;v[3]=y;v[4]=b;v[5]=e;v[6]=c;v[7]=y;v[8]=b;v[9]=e;v[10]=c;v[11]=y;v[12]=b;v[13]=e;v[14]=c;v[15]=y;g.bufferSubData(g.ARRAY_BUFFER,16*l,v);h&&Lg(z,l,a);if(a.child&&!1!==a.built)for(b=k,e=a.child.length,c=[],a.childLoc=c,h=0;h<e;h++){z=a.child[h];f=ta[z.img];k=f[2]*a.d*6+4;y=f[4+k];
A=f[5+k];k=f[0];n=f[1];0<=n&&(n*=.001);q=f.id+4*a.d;r=-1;z.mv&&(r=1);v[0]=q;v[1]=r;v[2]=k;v[3]=n;v[4]=q+1;v[5]=r;v[6]=k;v[7]=n;v[8]=q+2;v[9]=r;v[10]=k;v[11]=n;v[12]=q+3;v[13]=r;v[14]=k;v[15]=n;r=lf(z,a.kingdom);f=r[0];n=r[1];q=r[2];r=r[3];B=w;var D=x;z.wh1&&(y=z.wh[0],A=z.wh[1]);z.center&&(B-=.5*~~(y-p),D-=.5*~~(A-m));l=Yi();g.bindBuffer(g.ARRAY_BUFFER,Nc);g.bufferSubData(g.ARRAY_BUFFER,16*l,v);g.bindBuffer(g.ARRAY_BUFFER,Ya);v[0]=f;v[1]=n;v[2]=q;v[3]=r;v[4]=f;v[5]=n;v[6]=q;v[7]=r;v[8]=f;v[9]=n;v[10]=
q;v[11]=r;v[12]=f;v[13]=n;v[14]=q;v[15]=r;g.bufferSubData(g.ARRAY_BUFFER,16*l,v);k=z.z?32*z.z+b:b;g.bindBuffer(g.ARRAY_BUFFER,Sb);Q[0]=B;Q[1]=D;Q[2]=k;Q[3]=B;Q[4]=D;Q[5]=k;Q[6]=B;Q[7]=D;Q[8]=k;Q[9]=B;Q[10]=D;Q[11]=k;g.bufferSubData(g.ARRAY_BUFFER,12*l,Q);g.bindBuffer(g.ARRAY_BUFFER,hd);v[0]=0;v[1]=0;v[2]=0;v[3]=0;v[4]=0;v[5]=0;v[6]=0;v[7]=0;v[8]=0;v[9]=0;v[10]=0;v[11]=0;v[12]=0;v[13]=0;v[14]=0;v[15]=0;g.bufferSubData(g.ARRAY_BUFFER,16*l,v);k=1>r?ha:z.light?Aa:pa;c.put(k);y=k.length;c.put(y);k[y]=
l;k[y+1]=l+1;k[y+2]=l+2;k[y+3]=l+1;k[y+4]=l+2;k[y+5]=l+3;k.changed=!0}};ObjectsetupPhysics=function(a,b,e,c){var f=u.now(),h=a.bufferID;v[0]=b;v[1]=e;v[2]=c;v[3]=f;v[4]=b;v[5]=e;v[6]=c;v[7]=f;v[8]=b;v[9]=e;v[10]=c;v[11]=f;v[12]=b;v[13]=e;v[14]=c;v[15]=f;g.bindBuffer(g.ARRAY_BUFFER,hd);g.bufferSubData(g.ARRAY_BUFFER,16*h,v);g.bindBuffer(g.ARRAY_BUFFER,null);if(a.tempChild)for(f=0,a=a.tempChild,h=a.length;f<h;ObjectsetupPhysics(a[f++],b,e,c));};var Zi=function(a,b,e,c,d,h){sa[0]=a;sa[1]=b;sa[2]=e;sa[3]=
a+c;sa[4]=b;sa[5]=e;sa[6]=a;sa[7]=b+d;sa[8]=e;sa[9]=a+c;sa[10]=b+d;sa[11]=e;g.bindBuffer(g.ARRAY_BUFFER,Sb);g.bufferSubData(g.ARRAY_BUFFER,12*h,sa);g.bindBuffer(g.ARRAY_BUFFER,null)},Xi=function(a,b,e,c,d){v[0]=a;v[1]=b;v[2]=e;v[3]=c;v[4]=a;v[5]=b;v[6]=e;v[7]=c;v[8]=a;v[9]=b;v[10]=e;v[11]=c;v[12]=a;v[13]=b;v[14]=e;v[15]=c;g.bindBuffer(g.ARRAY_BUFFER,Ya);g.bufferSubData(g.ARRAY_BUFFER,16*d,v);g.bindBuffer(g.ARRAY_BUFFER,null)};ObjectsetupPosition=function(a,b){a.z32&&(b*=a.z32);var f=32*a.x32,c=32*
a.y32;a.wh?Zi(f,c,b,a.wh[0]-ta[a.img][8],a.wh[1]-ta[a.img][9],a.bufferID):Zi(f,c,b,0,0,a.bufferID);if(a.tempChild)for(b=a.tempChild,f=0,c=b.length;f<c;f++){var d=b[f];d.x32=a.x32;d.y32=a.y32;ObjectsetupPosition(d,32*a.y32)}};ObjectindexHide=function(a){ObjectsetupPosition(a,NaN)};ObjectindexShow=function(a){var b=1;a.z32&&(b=a.z32);ObjectsetupPosition(a,32*a.y32*b)};var ya={getRadix:function(){return Ua[this.zLevel]},checkMana:function(a,b,e,c){if(!this.mana)return!1;if(0>this.mana-a)return this.manaTask=
[e.url,b,a],this.stay55(),a>this.manaMax&&c&&(this.blockedCost=c,b=this.setupChild(Ab.curse,1),this.blocked=2,this.blockedimg=b,this.manaTarget=a,g.bindBuffer(g.ARRAY_BUFFER,Ya),g.bufferSubData(g.ARRAY_BUFFER,16*this.bufferID,je),g.bufferSubData(g.ARRAY_BUFFER,16*b.bufferID,je)),!1;this.mana-=a;return!0}},Ob=function(a,b){return u.editor?!0:a.freezed||a.confused?!1:K[a.spy||a.kingdom].control[b.spy||b.kingdom]};ya.changeKingdom=function(a){eb[this.kingdom][this.type].quit(this.id);if(Qb[this.id]){Qb[this.id]=
0;var b=!0;H.quit(this.id);0==H.length&&(ka([]),Ld(),Pb=-1)}this.kingdom=a;ic(this);this.childBuild&&(this.childBuild=0);this.build&&!this.arrow||this.stay();eb[a][this.type].put(this.id);b&&(Ob(this,z)&&H.put(this.id),Qb[this.id]=1,Pa=this,aa(this.id))};ya.aspettare=function(){this.getRadix()[this.x32+this.y32*x]=this.id;this.waiting=!0;ObjectsetupIMG(this,this.url.idle);ObjectsetupPhysics(this,0,0,0);mb(this,~~(32E3/this.spd))};ya.addItem=function(a){var b=this.inventory;b&&(b[b.length]=a.id,a.sword||
a.shield)&&(a.attack&&(this.attack+=a.attack),a.defence&&(this.defence+=a.defence))};ya.showInventory=function(){gf();for(var a=this.inventory,b=0;8>b;b++){var e=a[b];if(!e)break;var c=Ia[b];c.style.backgroundPosition="0px "+48*e.iconID+"px";c.className="";Ve[b]=null}};ya.deleteItem=function(a){this.inventory.quit(a.id);this.attack-=a.attack;this.defence-=a.defence};ya.useItem=function(a){48==a.type&&(this.health+=a.lives,this.health>this.maxHealth&&(this.maxHealth=this.health),this.inventory.quit(a.id))};
ya.onattack=function(a){!this.attack||this.freezed||this.death||this.func!=Qd.url&&this.func||qc(a.id,[this.id],1)};ObjectsetupINTV1=function(a,b,e){this.data=b;this.func=a.url;this.time=~~(.04*e);va(this,e);return e};ya.setupINTV=function(a,b,e){this.funcObj=b;a.url||M(a,a.url);this.func=a.url;this.deleteWorker();mb(this,e);return e};ya.damage=function(a,b){if(!(this.zolotoy||this.death||this.stoned)){this.defence&&(a-=this.defence);1>a&&(a=1);this.health-=a;b=K[b.kingdom].stats;b.dmgInflicted+=
a;var f=K[this.kingdom].stats;f.dmgTaken+=a;1>this.health?(this.build?(f.buildsLosed++,b.buildsKilled++):(f.unitsLosed++,b.unitsKilled++),this.die()):aa(this.id,1)}};var aa=function(a,b){if(Qb[a]||!1===a)return a=H.length,1===a?(a=y[H[0]],S.stockActive==a&&a.inventory.length?(Ac(a.id,1,1),Bi(a,1)):a.build?Ha(a,1):Ac(a.id,b)):1<a?Dg(H,b):Pi(Pa),!0};ya.setupSpellIMG=function(a){this.invisible&&Xc(this.id);this.url.spell&&ObjectsetupIMG(this,this.url.spell,1);a||va({func:$i,data:this.id},Ta(this.img),
1)};var $i=function(a){a=y[a];a.death||a.stay()};ya.setupChild=function(a,b,e){var c={x32:this.x32,y32:this.y32,d:a.d,img:a.img,mv:a.mv,parent:this.id,z32:a.z32};if((this.dix||this.diy)&&!this.waiting){var f=.001*(u.now()-this.timestamp);c.x32+=this.dix*f/32-Math.sign(this.dix);c.y32+=this.diy*f/32-Math.sign(this.diy)}if(a.select){if(this.space)a=this.space[this.space.length-1],h=(this.space.length-1)/a;else{a=this.sSizex||1;var h=this.sSizey||1}this.z32&&(c.z32=this.z32);c.wh=[32*a-3,32*h-3];this.selectAnim=
c}Sa(c);f&&ObjectsetupPhysics(c,this.dix,this.diy,0);e&&(g.bindBuffer(g.ARRAY_BUFFER,Ya),g.bufferSubData(g.ARRAY_BUFFER,16*c.bufferID,e));this.tempChild||(this.tempChild=[]);this.tempChild.put(c);b||yb.new(c,Ta(c.img),aj);return c};var aj=function(a){y[a.parent].tempChild.quit(a);vb(a)};ya.distance=0;ObjectsetupIMG=function(a,b,e,c){a.img=b;b=ta[b];var f=b[0],h=b[1];0<=h&&(h*=.001);c&&(h*=c);b=b.id+4*a.d*b[2];c=-1;1===e?c=u.now():0>e&&(c=1);e=c;a=a.bufferID;v[0]=b;v[1]=e;v[2]=f;v[3]=h;v[4]=b+1;v[5]=
e;v[6]=f;v[7]=h;v[8]=b+2;v[9]=e;v[10]=f;v[11]=h;v[12]=b+3;v[13]=e;v[14]=f;v[15]=h;g.bindBuffer(g.ARRAY_BUFFER,Nc);g.bufferSubData(g.ARRAY_BUFFER,16*a,v);g.bindBuffer(g.ARRAY_BUFFER,null)};ya.setupDir=function(a,b,e){a=Math.sign(a);b=Math.sign(b);a=3*(b-1)+(a+1);2==a?this.d=1:-6==a?this.d=5:0==a?this.d=7:-4==a?this.d=3:-1==a?this.d=2:1==a?this.d=0:-5==a?this.d=4:-3==a&&(this.d=6);e&&(this.d=(this.d+e)%8)};ya.setupDirBuild=function(a){var b=R;1==a.health&&0==a.built&&(b=qb[a.kingdom]);a=a.id;var f=
x,c=this.x32+this.y32*f;b[c+f]==a?this.d=0:b[c-f]==a?this.d=4:b[c+1]==a?this.d=2:b[c-1]==a?this.d=6:b[c+f+1]==a?this.d=1:b[c-f+1]==a?this.d=3:b[c+f-1]==a?this.d=7:b[c-f-1]==a&&(this.d=5)};ya.spdMod=0;var ng=function(a,b){b=b.length;for(var f=0;f<b;f++){var c=y[H[f]];c.build||(c.spd=a)}};ya.stay=function(a){this.mv=1;this.func=this.time=void 0;this.diy=this.dix=0;this.c=void 0;this.xf=null;ObjectsetupPhysics(this,0,0,0);a||(this.stock&&0!==this.stock[0]?ObjectsetupIMG(this,this.img,NaN):ObjectsetupIMG(this,
this.__proto__.img,1),this.deleteWorker(),this.standardFunc&&2!==this.stop&&this.standardFunc(this))};ya.stay55=function(){this.stock&&0!==this.stock[0]?ObjectsetupIMG(this,this.img,NaN):ObjectsetupIMG(this,this.__proto__.img,1);this.deleteWorker();this.standardFunc&&this.standardFunc(this)};var Ek=[],vb=function(a){a.elemtId&&(bj(a.elemtId,a.typeBuffer),a.elemtId=void 0,a.typeBuffer=void 0)},Rh=function(a){if(a.childLoc){a=a.childLoc;for(var b=0,f=a.length;b<f;b+=2)bj(a[b+1],a[b])}},bj=function(a,
b){b[a]=NaN;b[a+1]=NaN;b[a+2]=NaN;b[a+3]=NaN;b[a+4]=NaN;b[a+5]=NaN;b.changed=!0;Ek.put(a)};ya.addWorker=function(a){this.workers.put(a.id);a.workingOn=this.id};ya.deleteWorker=function(){this.workingOn&&(y[this.workingOn].workers.quit(this.id),this.workingOn=0);this.actionItem&&(this.actionItem=void 0);this.blockedAction()};ya.blockedAction=function(a){var b=this.blocked;if(cj[b])cj[b](this,a)};var cj={2:function(a,b){a.blocked=void 0;ic(a);aj(a.blockedimg);a.blockedimg=void 0;a.manaTarget=void 0;
b||(K[a.kingdom].setupResources(a.blockedCost,-1),a.blockedCost=void 0)}},ti=function(a){return k.delay[-a[1]+a[0]-1]},yd=function(a){var b=H.length;H.quit(a);if(b!=H.length){var f=y[a];f.selectAnim=void 0;b=0;for(f=f.tempChild;b<f.length;b++){var c=f[b];vb(c);var d=f.length;f.quit(c);d!=f.length&&b--}Qb[a]=void 0;0==H.length?Ld():1==H.length?Ac(a):Dg(H)}Pa&&Pa.id===a&&(Ld(),Pa.selectAnim&&(vb(Pa.selectAnim),Pa.selectAnim=void 0),Pa=void 0)};ya.base=function(a){return Ua[this.zLevel][a]};ya.rbase=
function(){return Ua[this.zLevel]};var Oe;ya.die=function(a){if(!this.death){var b=x,f=this.id,c=this.kingdom,d=K[c];this.waitlist&&(d.unitLoading-=.5*this.waitlist.length);if(this.dieSound&&!u.editor){var h=this.dieSound;xa(h[~~(h.length*Math.random())],this.x32,this.y32)}yd(this.id);(this.freezed||this.invisible)&&ic(this);var l=this.x32,g=this.y32;this.death=1;1==this.zLevel&&(Oe[l+g*b]=1);this.c=void 0;var p=this.url.die||this.dimg;Rh(this);d.IA&&d.IA.valorateLost&&d.IA.valorateLost(this);if(this.food&&
!u.editor){var m=100,n=this.food/m,q=~~n,r=~~((n-q)*m);for(h=0;h<n;h++){h==q&&r&&(m=r);var v=Vh(l,g),w=~~(v/b);v%=b;v=new fc(52,c,v,w,0);ObjectsetupIMG(v,k.item_meat);v.contain=[m,2,bk]}}d.stats.unitCountDeath[this.type]++;h=this.x32;b=this.y32;a||u.editor?(vb(this),Zb.put(this.bufferID)):p?(this.mv=!0,ObjectsetupIMG(this,p,1),a=ta[this.img],p=a[1],p=0>p?ti(a):1E3*a[0]/p,va({func:si,data:this.id},p-25,1),ObjectsetupPhysics(this,0,0,0),void 0!==this.dix&&(a=.001*(u.now()-this.timestamp),this.x32+=
this.dix*a/32-Math.sign(this.dix),this.y32+=this.diy*a/32-Math.sign(this.diy))):this.dimgInfinity?(this.dimgRND&&(this.d=this.id%this.dimgRND),ObjectsetupIMG(this,this.dimgInfinity)):(vb(this),Zb.put(this.bufferID));this.techStart&&ne(0,[this.id]);ObjectsetupPosition(this,32*this.y32-36);this.x32=h;this.y32=b;this.build||d.values.pop--;this.population&&this.built&&(d.values.popMax-=this.population);g=this.validator(l,g,this.space,this.kingdom);a=g[0];if(this.onbuild&&!u.editor)for(l=this.onbuild,
p=d.technology,h=p.disabled,p=p.actived,b=0;b<l.length;b++)c=l[b].id,p[c]--,0===p[c]&&h[c]++;l=this.validator.dimension;h=0;for(p=a.length;h<p;h++)b=a[h],l[b]=Mb[b]?Mb[b]:0;if(1==this.health&&!this.built)for(b=qb[this.kingdom],h=0,p=a.length;h<p;b[a[h++]]=void 0);if(g[2])for(a=g[2],h=0,p=a.length;h<p;h++)b=a[h],Mb[b]?(2<l[b]&&y[l[b]].die(1),l[b]=Mb[b]):(2<l[b]&&y[l[b]].die(),l[b]=0);eb[this.kingdom][this.type].quit(this.id);if(this.workers){h=0;l=this.workers.slice(0);for(p=l.length;h<p;h++)g=y[l[h]],
g.workingOn===f&&(g.workingOn=0,g.func!==lg.url&&g.stay());this.workers.length=0}this.deleteFromList&&(l=this.deleteFromList,l.quit(this),l.length||l.length0function(this));this.func=this.time=void 0;this.diy=this.dix=0;this.inventory&&0<this.inventory.length&&Uc(this.id,this.inventory.slice(0));this.stock&&Uh(this);u.editor||(d.check(),td(this.kingdom),d.checkPopArray());this.deleteWorker()}};Array.prototype.quit=function(a){a=this.indexOf(a);return-1<a?(this.splice(a,1),!0):!1};Array.prototype.add=
function(a){0>this.indexOf(a)&&(this[this.length]=a)};var La=["European","Arab","Asian"];A={open:"Open",loading:"Loading...",systemAlert:"System Message",notEnough:"Not enough %s",ok:"OK",yes:"Yes",no:"No",secure:"Are you sure?",gold:"Gold",stone:"Stone",wood:"Wood",food:"Food",mana:"Mana",warning:"Warning",play:"PLAY",close:"CLOSE",gameClosed:"The game was canceled by the server.",loadgraphics:"Downloading graphics...",waitImages:"Downloading graphics",wait:"Wait",audioproblem:"Your browser is not compatible with Web Audio",
defeated:"DEFEATED",victorious:"VICTORIOUS",options:"OPTIONS",refresh:"Refresh",back:"BACK",paused:"PAUSED",chatMsg:"CHAT MESSAGE",disconnect:"Disconnect",playerDisconnected:"%s has disconnected!",connectionError:"Connection error",noP2P:"Engine not loaded",startingResources:"Starting Resources",mapSize:"Map Size",menu:"MENU",quit:"QUIT",continue:"Continue",backToGame:"BACK TO GAME",initializing:"Initializing...",requires:"Requires",attack:"Attack enemy",stop:"Stop",pickItems:"Pick items",move:"Move",
stand:"Stand ground",explore:"Explore",patrol:"Patrol",guard:"Guard",extension:"Do you want download 'Tzared boost' extension?",errorLoading:"Error loading game.",waitingPlayers:"Waiting for players to connect",musicVolume:"Music Volume",soundVolume:"Sound Volume",common:"Common",popLimit:"Population limit reached",houseLimit:"Not enough houses",lightning:"Lightning",freeze:"Freeze",bless:"Bless",heal:"Heal",invisibility:"Invisibility",dcm:"Dig, chop or mine",repair:"Repair building",menuBuild:"See what you can build",
units:"Units",infinite:"Infinite",gameFull:"Sorry, the game is full.",terrainOption:"Terrain",playerDefeated:"%s has been defeated!",savegame:"SAVE GAME",loadRecord:"Recording",stats:"Stats",builds:"Builds",items:"Items",nature:"Nature",trees:"Trees",delete:"Delete",create:"Create",username:"Player Name",gameOptions:"GAME OPTIONS",nplayers:"Number of Players",gameName:"Enter Game Name"};var Mh={euro:"Lancelot Arthur Guivain Merlin Blackthorn Morin Golstuck Karambol Kelerick Rockmore Bridport Casevil Stirm Tonis Pelegrim Peresohn Pirk Pharn Gork".split(" "),
arab:"Ibn Fadlan;Mohammad;Al Ferissa;Harun Al Rashid;Sindbad;Mellemad;Moarrac;Sakhavan;Bellefars;Mokhac;Norahz;Kerhetin;Maham;Dushesh;Direkh".split(";"),asia:"Ishida Toranaga Ichinzen Haiako Mozuki Hitachi Tosheba Harachiko Marasuma Korodzum Ishinghen Genghis Musa Echibo Ichikahr Yotokan Maraga".split(" "),common:"Fistantilus Skenderbeg Raislin Tenis Morok Sokob Baras Haram Billihz Ynte Orgh Savael Birgos Savator Gandeh Gordor Fessh Gilmi Phergas".split(" ")},Mg=[A.gold,A.wood,A.food,A.stone,A.mana],
Zc=function(a,b,e){e&&(a=a.replace("%d",e));return a.replace("%s",b)},ad={},Vi=Gg,ej=function(f){f--;var b=new XMLHttpRequest;b.open("GET","https://dl.dropboxusercontent.com/s/ssnjwy6sm462q89/dictionary.json?dl=0",!0);b.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");b.onreadystatechange=function(){if(4==b.readyState&&200==b.status){var e=JSON.parse(b.response);Vi=function(){for(var a=w,b=0;b<a.length;b++){var c=a[b].name;e[c]&&(a[b].name=e[c][f])}for(b=0;b<F.length;b++)a=
F[b],e[a.name[0]]&&e[a.name[1]]&&(a.name[0]=e[a.name[0]][f],a.name[1]=e[a.name[1]][f]);e=null};for(var c=[],d=0;0>d;d++)"undefined"!=typeof a[d]&&null!=a[d].tech&&(c.push(a[d].tech.name),Object.freeze(a[d].tech));for(d=0;d<c.length;d++)c[d][0]=e[c[d][0]][f],c[d][1]=e[c[d][1]][f];c=Object.keys(A);for(d=0;d<c.length;d++){var h=c[d];void 0!=e[A[h]]&&(A[h]=e[A[h]][f])}Object.freeze(A);for(d=0;d<La.length;d++)La[d]=e[La[d]][f];for(d=0;d<0*Mg.length;d++)Mg[d]=e[Mg[d]][f];Object.freeze(La);dj()}};b.send()};
0<z.lang&&(ej(z.lang),ej.translated=!0);var dj=function(){for(var a=["refreshButton",A.refresh,"optionsButton",A.options,"startButton",A.play,"backButton",A.back,"closeButton",A.close,"quitButton",A.quit,"continueButton",A.continue],b=0,e=a.length;b<e;b+=2)for(var c=document.getElementsByClassName(a[b]),d=0,h=c.length;d<h;d++)c[d].innerHTML=a[b+1];a=["alertok",A.ok,"sendMessageH2",A.chatMsg,"mapsizeOption",A.mapSize,"startingResourcesOption",A.startingResources,"goldWord",A.gold,"stoneWord",A.stone,
"foodWord",A.food,"woodWord",A.wood,"gameMenu",A.menu,"infiniteWord",A.infinite,"backToGame",A.backToGame,"backToGameS",A.backToGame,"musicVolume",A.musicVolume,"soundVolume",A.soundVolume,"menueditor",A.menu,"terrainOption",A.terrainOption,"saveGame",A.savegame,"playrecord",A.loadRecord,"seeStats",A.stats,"selectBuilds",A.builds,"selectUnits",A.units,"selectItems",A.items,"selectNature",A.nature];b=0;for(e=a.length;b<e;b+=2)document.getElementById(a[b]).innerHTML=a[b+1]};dj();var Db={},bd,Ff=function(){for(var a=
"mapx mapwidth goldRes goldValue woodRes woodValue foodRes foodValue stoneRes stoneValue infinity infiniteValue".split(" "),b=0,e=a.length;b<e;b+=2){var c=document.getElementById(a[b+1]).value;M(c);"infinity"==a[b]?(c=document.getElementById(a[b+1]).checked,u[a[b]]=c):u[a[b]]=parseInt(c)}u.infinity&&(u.goldRes=Infinity,u.foodRes=Infinity,u.woodRes=Infinity,u.stoneRes=Infinity);u.mapy=u.mapx;u.gravity=parseFloat(document.getElementById("mapgravity").value)*(580.9/9.8);u.name="";u.arje=555555*Math.random()+
1;M(u.arje,"arje")},zj=function(){u.online&&(Fk(A.initializing),u.editor=0);u.mapx||Ff();u.pausedTime=0;u.canceled=0;for(var f=Object.keys(a),b=K.length,e=0,c=f.length;e<c;e++){var d=a[f[e]];d.id=e;if(d.disabled)for(var h=0;h<b;K[h++].technology.disabled[e]=d.disabled);if(d.hidden)for(h=0;h<b;K[h++].technology.hidden[e]=1);}var l=performance.now();$b=document.getElementById("msgs1");u.online||(location.hash="");B("playermenu").style.display="none";B("index").style.display="none";B("menu").style.display=
"block";B("statButton").style.display="block";B("mapeditorinfo").style.display="none";B("mapeditorinfotop").style.display="none";B("resources").style.display="block";uj(K);Va=K[z.kingdom];ue(z.kingdom);setTimeout(function(){u.cycle?u.deltaTime=25*u.cycle:(u.players=K.length-1,u.date=Date.now(),u.cycle=0,u.kingdoms=K,u.deltaTime=0);u.loadDate=Date.now();u.online||Ci();u.now=Dh;u.paused=0;u.pausedTime=0;u.zMax=96*u.mapy;nb();performance.now();u.allow14=!0;x=u.mapx;la=u.mapy;u.temperature=25;var b=u.temperature;
0==z.temperature&&(b+="&deg;C");document.getElementById("temperature").innerHTML=b;ba=1;Gk();Ld();Oe={};var c=x;b=-c;c=+c;bb=[1,1+b,b,-1+b,-1,-1+c,c,c+1];Eh=[b,-1,1,c];u.online&&(document.getElementById("content").style.display="block");b=["chat","loading","playermenu","index"];c=b.length;for(var d=0;d<c;document.getElementById(b[d++]).style.display="none");"Firefox"==z.navigator&&Ub("You are using Firefox, if you have performance problems try Chrome");B("loadingtext").innerHTML="Loading terrain";
b=performance.now();if(u.terrain)bd=new Int8Array(u.terrain);else{c=performance.now();var e=x,f=e*la,h=Math.sqrt(f),w,F,C=0,E,J;d=new Int8Array(new ArrayBuffer(f));var H=new Uint32Array([2,3,0,1,1,1,0,1,0,1,0,1,1,1,1,0,0,15,0,1]);for(gk(u.arje);C<f;d[C++]=0);var O=H.length;for(C=0;C<O;C+=4)H[C+3]&&(H[C+1]=~~(h/H[C+1]));for(E=0;E<O;E+=4){var I=H[E+1];var G=H[E];var N=H[E+2];for(C=0;C<I;C++){var S=~~(ja()*f+.5);var Q=6*ja()-3;var U=6*ja()-3;if(N){var P=ja()*h;var Z=~~(ja()*(h/15))+4;var W=~~(100*ja())/
4;var X=Z/12}else P=128*ja(),Z=~~(2.56*ja())+4,W=~~(100*ja())/2,X=1;var aa=S%e;S=~~(S/e);for(J=0;J<P;J++)for(100*ja()>W&&(Q=(6*ja()-3)*X,U=(6*ja()-3)*X),aa+=Q,S+=U,w=0;w<Z;w++)for(F=0;F<Z;F++)if((w-Z/2)*(w-Z/2)+(F-Z/2)*(F-Z/2)<Z*Z/4){var ea=~~aa+w+(F+~~S)*e;ea>=f?ea%=f:0>ea&&(ea+=f);d[ea]=G}}}e=performance.now();M("randomtxt1",e-c);M("drawTerrain: ",performance.now()-e);bd=d}Db.randomtxt=performance.now()-b;M("randomtxt: ",Db.randomtxt);b=performance.now();B("loadingtext").innerHTML="Creating map";
c=x*la*4;R=new Uint32Array(c);ra=new Uint32Array(c);Gc=new Uint32Array(c);T.dimension=R;Nd.dimension=ra;Ti.dimension=R;Ui.dimension=ra;Y.dimension=R;kf.dimension=Gc;Cb.dimension=ra;jf.dimension=R;Ua[0]=ra;Ua[1]=R;Ua[2]=Gc;Db.createMap=performance.now()-b;M("createMap: ",Db.createMap);B("content").style.display="block";b=performance.now();M(u.allunits);if(u.allunits)D=u.allunits;else{c=bd;d=u.mapx;N=u.mapy;e=performance.now();Q=d*N;E=Math.sqrt(Q);D=[];cd={};U=Hk;I=Ik;f=cd;h=Jk;W=[12,63,62];aa=[];C=
K.length-1;for(P=1;P<C;P++){H=!0;G=K[P];S=W[G.race];for(w=0;H&&25>w;){w++;X=~~(ja()*(d-15)+.5)+4;Z=~~(ja()*(N-15)+.5)+4;H=!1;O=aa.length;for(G=0;G<O;G+=2)60>Math.sqrt((X-aa[G])*(X-aa[G])+(Z-aa[G+1])*(Z-aa[G+1]))&&(H=!0);H||(aa.push(X+4,Z+3),U(X+Z*d,{type:S,kingdom:P}))}if(25==w){K.length=P;break}}W=2*(C-1);C=1*~~(E/3.2);for(P=0;P<C;P++)for(H=~~(ja()*d+.5),O=~~(ja()*N+.5),S=~~(25*ja())+10,w=~~(25*ja())+10,G=0;55>G;G++)X=~~(ja()*S+~~(H+18*ja()-9)+.5),Z=~~(ja()*w+~~(O+18*ja()-9)+.5),X+=Z*d,I(X)&&X<=
Q&&U(X,{type:7,d:~~(28*ja()+3)});C=40*~~(E/256);for(P=0;P<C;P++){X=~~(ja()*Q+.5);N=Ig[~~(ja()*Ig.length)];G=Object.assign({},N);G.d+=~~(N.dMax*ja());if(N.sword||N.potion)G.attack=~~(6*ja())+1;if(N.shield||N.potion)G.defence=~~(6*ja())+1;N.book&&(N=~~(ja()*mf.length),G.spell=mf[N],G.iconID=a[mf[N]].iconIDbook,G.name=A[G.spell],G.attack=~~(6*ja())+1);U(X,G)}C=3*~~(E/256);for(P=0;P<C;P++)X=~~(ja()*Q),I(X)&&U(X,{type:43});N=!!u.infinity;for(G=0;G<W*(1-N);G+=2)I=2*Math.round(ja())-1,P=aa[G]+10*(2*Math.round(ja())-
1)+~~(3*ja()),E=aa[G+1]+10*I+~~(3*ja()),C=aa[G]+10*(2*Math.round(ja())-1)+~~(3*ja()),I=aa[G+1]+10*-I+~~(3*ja()),0>P?P=0:P+4>x&&(P-=(P+4)%Q),0>E?E=0:E+4>la&&(E-=(E+4)%Q),0>C?C=0:C+4>x&&(C-=(C+4)%Q),0>I?I=0:I+4>la&&(I-=(I+4)%Q),U(P+E*d,{type:21}),U(C+I*d,{type:22});for(G=0;G<W;G+=2)for(P=aa[G]-25,E=aa[G+1]-25,C=0;50>C;C++)for(I=0;50>I;I++)625>(C-25)*(C-25)+(I-25)*(I-25)&&(Q=C+P+(I+E)*d,7===h(Q).type&&(f[Q].cancell=1),1===fd.type[c[Q]]&&(c[Q]=0));M("random:",performance.now()-e);Db.random=performance.now()-
e}u.movtable&&!u.demo&&(sc=u.movtable,uc=u.movtable2);c=performance.now();B("loadingtext").innerHTML="Loading textures";wj(bd);Db.setupGL=performance.now()-c;M("setupGL: ",Db.setupGL);c=performance.now();e=bd;f=fd.type;h=x*la;for(d=0;d<h;d++)f[e[d]]?(ra[d]=1,R[d]=1,Mb[d]=1):0>e[d]&&(Mb[d]=2,ra[d]=2,R[d]=2);e=D;u.custom||(u.ini=e);u.demo&&(e=u.ini);d=0;for(f=e.length;d<f;d++)W=e[d],W.death?y.put(W):W.cancell||(h=W.x32,aa=W.y32,Q=!1===W.built&&1===W.health?!0:!1,U=W.kingdom||0,W=new fc(W.type,U,h,aa,
0,Q,W),Q||Xh(W),W.castle&&(K[U].origin=[h+4,aa+3]));cd=D=null;M("positioned:",performance.now()-c);Db.positioned=performance.now()-c;Db.setupGL=performance.now()-b;M("setupGL: ",Db.setupGL);Sa(Ea);Sa(da);td(z.kingdom);wi();b=K[z.kingdom].origin;jd(~~(32*b[0]-.5*(window.innerWidth-z.mx)),~~(32*b[1]-.5*window.innerHeight));window.addEventListener("keydown",Hi);window.addEventListener("keyup",Ii);window.addEventListener("mousemove",Ji);L=jb;fa=new Float32Array(12);b=ta[k.blank].id;v[0]=b;v[1]=0;v[2]=
1;v[3]=0;v[4]=b;v[5]=0;v[6]=1;v[7]=0;v[8]=b;v[9]=0;v[10]=1;v[11]=0;v[12]=b;v[13]=0;v[14]=1;v[15]=0;b=ha;b[0]=0;b[1]=1;b[2]=2;b[3]=1;b[4]=2;b[5]=3;g.bindBuffer(g.ARRAY_BUFFER,Nc);g.bufferSubData(g.ARRAY_BUFFER,0,v);g.bindBuffer(g.ARRAY_BUFFER,Ya);d=3*z.kingdom;b=za[d];c=za[d+1];d=za[d+2];g.bufferSubData(g.ARRAY_BUFFER,0,new Float32Array([b,c,d,.5,b,c,d,.5,b,c,d,.5,b,c,d,.5]));b=96*x;fa[2]=b;fa[5]=b;fa[8]=b;fa[11]=b;window.addEventListener("mousedown",Ki);window.addEventListener("mouseup",Li);M("FULL: ",
performance.now()-l);u.record||(u.record={});u.online?(Ub(Od(),A.waitingPlayers,1),M(z.admin,"e21e21e"),z.admin?(M(88888888),Ic()):ca(Ic,0,0)):nf();u.allow14=!1;Hc.list.push(0,JSON.stringify(Db))},300)},Od=function(){for(var a=G.length,b=G,e="",c=0;c<a;c++)Od.obj[b[c].id]||b[c].id==z.onlineID||(e+="<br>"+b[c].name);return e};Od.obj={};var Ef=!1,wi=function(){var a=document.getElementById("playersinfo");a.innerHTML="";for(var b=1,e=K.length-1;b<e;b++){var c=K[b];M(c);var d=c.death?c.name.strike():
c.name;a.innerHTML+=d+"<span id='score"+b+"'> 0/0</span><div class='playercolor' style='background:rgb("+c.color[0]+","+c.color[1]+","+c.color[2]+")'></div><br>"}},Kd,Qi,Ei,Gk=function(){var a=document.getElementById("selectedobject").getContext("webgl",{antialias:!1,depth:!1}),b=a.createShader(a.VERTEX_SHADER);a.shaderSource(b,"void main() {\ngl_Position = vec4(0 ,0, 0, 1);\ngl_PointSize=48.0;\n}");a.compileShader(b);var e=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(e,"precision mediump float;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nuniform float txtCoord;\nvoid main() {\ngl_FragColor = texture2D(u_image, (vec2(\tmod(txtCoord,21.0) ,floor(txtCoord/21.0) ) + gl_PointCoord)*(0.046875));\nif(gl_FragColor.r==gl_FragColor.g&&gl_FragColor.r==gl_FragColor.b) gl_FragColor*=u_color;\n}");
a.compileShader(e);var c=a.createProgram();a.attachShader(c,b);a.attachShader(c,e);a.linkProgram(c);a.useProgram(c);b=a.createTexture();a.bindTexture(a.TEXTURE_2D,b);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texImage2D(a.TEXTURE_2D,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,S.icons);var d=a.getUniformLocation(c,"u_color"),
h=a.getUniformLocation(c,"txtCoord");Kd=function(b){if(ta[b.img][3]){var c=b.kingdom;a.uniform4f(d,za[3*c],za[3*c+1],za[3*c+2],1)}else a.uniform4f(d,1,1,1,1);a.uniform1f(h,b.iconID);a.drawArrays(a.POINTS,0,1)};Qi=function(){a.uniform4f(d,1,1,1,1);a.uniform1f(h,189);a.drawArrays(a.POINTS,0,1)};Ei=function(){a.uniform1f(h,0);a.uniform4f(d,0,0,0,0);a.drawArrays(a.POINTS,0,1)}},Tb=128,$a=128,y=[{terrain:1},{terrain:1},{terrain:1}],Mb={},td=function(a){a===z.kingdom&&(a=Va.values.popMax<Va.values.popLimit?
Va.values.popMax:Va.values.popLimit,document.getElementById("pop").innerHTML=Va.values.pop+"/"+a)};window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();var cd=D=void 0;var Hk=function(a,b){cd[a]||(b.x32=a%x,b.y32=~~(a/la),D.put(b),cd[a]=b)},Ik=function(a){return!D[a]},Jk=function(a){return cd[a]||NaN},Ba=[],Ng=function(){M("123");Fa.leaveRoom();Ba.length=0},dd={};
(function(){for(var a=["returnmenu","index","Account","accountIframe"],b=0,e=a.length;b<e;dd[a[b]]=document.getElementById(a[b++]));})();var Kk=function(){location.replace("#"+this.gameID+"Room")},jh=function(a){Ba=[];M("connecting to",a,A.loading);B("game").style.display="block";B("gameName").innerHTML=A.loading;B("returnmenu").style.display="none";B("index").style.display="none";kc.innerHTML="";$b.innerHTML="";z.p2p?Fa.joinRoom(a,fj):(Fa||Hb(),Hb.func=function(){jh(a)})},Lk=function(a){B("game").style.display=
"none";G.length=0;u.online=0;Ng();Bc();a.constructor==String&&Ub(a)},vi={euro:0,arab:0,asia:0},gh=function(a,b,e){if(e){M(a,e);b=Og(e.id);var c=b[1];b=b[0];gj[c].innerHTML=a;b.username||(b.name=a,e.username=a)}},db=function(a,b){if(b.resend)if(a.destinatary)(b=Jc(a.destinatary))&&b.id!=z.onlineID&&(a.bridge=f.id,b.send(a));else{b=b.resend;for(var e=0,c=b.length;e<c;e++){var d=b[e];a.bridge=f.id;d.send(a)}}else{var f=b;a.bridge&&(f=Jc(a.bridge));if(void 0===a.length){if(void 0!==a.func)(0,ie[a.func])(a[1],
a[2],f)}else b=a[0],f.orderList[b]=a,db.done[b]||(db.done[b]=0),db.done[b]++,db.done[b]==Ba.length&&db.func&&(db.func=!1,$f(),nb())}};db.done=[];var Kc=function(a,b,e){e&&(M(e.id,"CAN connect"),Kc.ids[a]||(Kc.ids[a]=1,z.admin||clearTimeout(Kc.intv[a]),M("MAKE BRIDGE"),Jc(a).bridge=e,ca(hj,a,0,[e],0)))};Kc.ids={};Kc.intv={};var hj=function(a,b,e){e&&(M("BRIDGE"),e.resend||(e.resend=[]),e.resend.put(Jc(a)))},Jc=function(a){for(var b=0,e=Ba.length;b<e;b++){var c=Ba[b];if(c.id==a)return c}},Fa,Mk=function(){z.name=
B("usernameVal").value;localStorage.username=z.name;document.body.removeChild(B("usernameForm"));Hb()},Hb=function(){if("Guest"!==z.name&&z.name)Fa=new SimpleWebRTC({localVideoEl:"",remoteVideosEl:"",autoRequestMedia:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},url:"https://solar.tza.red/"}),Fa.on("channelMessage",function(a,b,d){"nehhof"==d.type&&(b=JSON.parse(d.payload),db(b,a))}),Fa.on("connectionReady",function(a){var b=Fa.connection.connection;z.p2p=b;b.username=z.name;b.on("getRooms",
function(a){var b=Object.keys(a),c=B("gameList");if(0<b.length){c.innerHTML="";for(var d=0,e=b.length;d<e;d++){var f=b[d],g=a[f],k=g.len;if(k){M(g);var r=document.createElement("tr");r.innerHTML="<td>"+g.description+"</td><td>"+k+"/"+g.max+"</td>";r.gameID=f;r.onclick=Kk;c.appendChild(r)}}}else c.innerHTML='<tr style="background:rgba(56, 56, 56, 0.7);"><td>No games found</td></tr>'});z.onlineID=a;Hb.func&&Hb.func()}),Fa.on("createdPeer",function(a){u.started||(Ba.put(a),xa("attack"),Aj(a),Pg())});
else if(!B("usernameForm")){var a=localStorage.username||"",b=document.createElement("div");b.id="usernameForm";b.innerHTML="\n            <h2>"+A.username+'</h2>\n            <input id=\'usernameVal\' type="text" value="'+a+'" /><br />\n            ';a=document.createElement("button");a.innerHTML=A.continue;a.onclick=Mk;b.appendChild(a);document.body.appendChild(b)}};Hb();var Nk=function(){B("game").style.display="block";B("gameName").innerHTML=A.loading;B("returnmenu").style.display="none";B("index").style.display=
"none";kc.innerHTML="";$b.innerHTML="";Fa||Hb();z.onlineID?(Ba=[],hh(),z.admin=1,z.room={description:B("gameFormName").value,max:parseInt(B("gameMax").value),public:!0},Fa.createRoom(z.onlineID+"b",fj),u.online=1,document.body.removeChild(B("gameForm"))):(setTimeout(function(){location.hash=""},200),Hb.func=ij)},ij=function(){var a=document.createElement("div");a.id="gameForm";a.innerHTML="\n            <h2>"+A.gameOptions+"</h2>\n            "+A.gameName+': <input id=\'gameFormName\' type="text" value="'+
z.name+'\'s room" maxlength="29" /><br />\n'+A.nplayers+': <input id="gameMax" type="number" value="14" max="14" min="2"/><br />\n            ';var b=document.createElement("button");b.innerHTML=A.continue;b.onclick=Nk;a.appendChild(b);document.body.appendChild(a)},Qg=function(a,b){b=JSON.stringify(b);a.sendDirectly("channelMessage","nehhof",b)},Pd=[],ca=function(a,b,e,c,d){if(!0===d&&u.online&&Ba.length)e.change&&(e=e.slice(0)),Ma(function(){ca(a,b,e,c,55)});else if(void 0===a.location)a();else{if(u.started&&
!u.editor){var f=u.record;f[u.cycle]||(f[u.cycle]=[]);var g=f[u.cycle];f=g.length;g[f]=a.location;g[f+1]=b;e.length&&(e=e.slice(0));g[f+2]=e}if(u.online&&Ba.length){if(55===d)var k=!1;var p={func:a.location,1:b,2:e,active:k,rnd:4294967296*Math.random()};if(a==nb||a==nf){k=Ma.max;p.active=!1;f=0;for(d=Ba.length;f<d;f++)g=Ba[f],g.bridge||setTimeout(function(a){Qg(a,p)},k-g.ping,g);setTimeout(function(){a(b,e)},k)}else if(u.started)if(c)for(f=0,d=c.length;f<d;f++)g=c[f],p.destinatary=g.id,g.bridge?Qg(g.bridge,
p):Qg(g,p);else Pd.put(p);else Rg(p),a(b,e)}else a(b,e)}},Ok=function(){if(Ba.length){Ff();Ic.i=0;for(var a={},b=0,e=G.length;b<e;b++)a[G[b].id]=b;ca(Sg,u,a,0,0)}},Ic=function(a,b,e){e&&(Od.obj[e.id]=1,a=Od(),""==a?Ub(a,A.loading,1):Ub(a,A.waitingPlayers,1));z.admin&&(Ic.i++,Ic.i==G.length&&setTimeout(function(){ca(nf,0,0,0,!0)},2500))};Ic.i=0;var Rg=function(a){a=JSON.stringify(a);for(var b=0,e=Ba.length;b<e;b++)Ba[b].sendDirectly("channelMessage","nehhof",a)},Lc,Tg,$f=function(){if(!db.done[Lc]||
db.done[Lc]<Ba.length)return db.func=!0,nb(),!0;for(var a=0,b=G.length;a<b;a++){var e=Jc(G[a].id);if(a==z.kingdom-1)var c=Tg;else{if(!e)continue;c=e.orderList[Lc]}for(var d=1,h=c.length;d<h;d++){var g=c[d];ie[g.func](g[1],g[2],e)}}db.func=!1;Rg(Pd);Tg=Pd;Lc++;Pd=[Lc+1];return!1},nf=function(){document.getElementById("alert").style.display="none";u.started=1;u.date=Date.now();nb();Ga();Lc=0;if(!u.custom||u.demo)for(var a=1,b=K.length-1;a<b;a++){var e=ab[xg[K[a].race]],c=e.peasant.type;if(e=y[eb[a][e.castle.type][0]])wc(c,
e,1),wc(c,e,1),wc(c,e,1)}tb.arr=[];tb.units=[];tb.time=500;tb.steps=0;tb.process=0;if(!u.editor&&!u.demo){for(a=1;a<K.length-1;a++)K[a].IA&&Infinity==u.goldRes&&new tb(K[a]);a=0;b=tb.arr;for(c=b.length;a<c;b[a++].leaveMeAloneIKnowWhatToDo());Vf()}u.online&&(Rg([0]),Pd=[1],Tg=[0]);Za()},Sg=function(a,b,e){if(e&&e.admin){e=[G[0]];for(var c=0,d=G.length;c<d;c++)e[b[G[c].id]]=G[c];G=e}xa("bless");u=a;u.infinity&&(u.goldRes=Infinity,u.woodRes=Infinity,u.foodRes=Infinity,u.stoneRes=Infinity);Qc()};var Di=
function(){B("game").style.display="none";Ng();Bc();z.admin=0};var fj=function(){var a=Fa.roomName;a+="Room";M("login");if(0!==Fa.getPeers().length||z.admin){var b=z.room||NaN;M(a);u.id=a;u.online=1;hh();B("chat").style.display="block";B("gameName").innerHTML=b.description||"Online Game";B("onlineID").value=location.origin+"/#"+u.id;B("returnmenu").style.display="none";Pg();z.admin?(location.replace("#"+u.id),B("buttons").innerHTML='<button id="startbutton">'+A.play+'</button><button id="optionbutton">'+
A.options+'</button><button id="closebutton">'+A.close+"</button>",B("startbutton").onclick=Ok,B("optionbutton").onclick=Ug,B("closebutton").onclick=Di):(B("buttons").innerHTML='<button id="quitbutton">'+A.disconnect+"</button>",B("quitbutton").onclick=Lk);Fa.connection.on("remove",function(a){if(a=Jc(a.id))if(zb(Zc(A.playerDisconnected,a.username),0,5),u.online){if(u.started)for(var b=0;b<G.length;b++)if(G[b].id==a.id){K[b+1].die();break}Ba.quit(a);u.started?db.done[Lc]==Ba.length&&db.func&&(db.func=
!1,$f(),nb()):(Pg(),a.admin&&(Bc(),Fa.leaveRoom(),Ub(A.gameClosed)))}})}else location.hash="",Bc()},Ma=function(a){Ma.func.put(a);0===Ma.active&&(ca(jj,0,0,0,0),Ma.date=Date.now(),Ma.received=0,Ma.max=-Infinity,Ma.active=1)};Ma.func=[];Ma.active=0;var jj=function(a,b,e){e&&ca(kj,0,0,[e],0)},Vg={},kj=function(a,b,e){if(e&&(e.ping=~~(.5*(Date.now()-Ma.date)+.5),Vg[e.id]?Vg[e.id].put(e.ping):Vg[e.id]=[e.ping],e.ping>Ma.max&&(Ma.max=e.ping),Ma.received++,Ma.received==Ba.length)){a=performance.now();b=
0;for(e=Ma.func.length;b<e;Ma.func[b++]());M(-a+performance.now());Ma.func.length=0;Ma.active=0}},Wg=document.getElementsByClassName("ucolor"),gj=document.getElementsByClassName("username"),Xg=document.getElementsByClassName("race"),of=document.getElementsByClassName("team"),Vb=document.getElementsByClassName("isconnected"),Kf=function(a,b,e){e&&(b=Og(e.id),e=b[1],b=b[0],b.race=a%3,Xg[e].innerHTML=La[b.race])},Og=function(a){for(var b=0,e=G.length;b<e;b++){var c=G[b];if(c.id==a)return[c,b]}},If=function(a,
b,e){if(e){b=a.match(/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i);e=Og(e.id);var c=e[1];e=e[0];Wg[c].style.background=a;e.color=[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]}},Jf=function(a,b,e){a=parseInt(a);if(isNaN(a)||!a)a=0;a%=5;if(e){b=e.id;e=0;for(var c=G.length;e<c;e++){var d=G[e];if(d.id==b){d.team=a;of[e].innerHTML=a;break}}}},Pg=function(){M("setup MENU");var a=document.getElementById("multiplayertable");a.innerHTML="";for(var b=z.room?z.room.max:14,e=0;e<b;e++)a.innerHTML+='<tr><td class="ucolor"></td><td class="username">'+
A.open+'</td><td class="race"></td><td class="team"></td><td class="isconnected"></td></tr>';a=Fa.roomName;a=a.substr(0,a.length-1);var c=[z.p2p];e=0;for(b=Ba.length;e<b;e++){var d=Ba[e];d.admin?c.unshift(d):c.put(d)}for(b=0;b<c.length;b++){d=c[b];e=G[b]&&G[b].id==d.id?G[b]:{color:[128,128,128],ia:0,name:d.username,race:0,team:0,id:d.id,cID:b};d&&d.id?(Vb[b].style.background="#00ff00",Vb[b].style.boxShadow="0px 0px 30px 0px #00ff00"):(Vb[b].style.background="#ff0000",Vb[b].style.boxShadow="0px 0px 30px 0px #ff0000");
Wg[b].style.background="rgb("+e.color[0]+","+e.color[1]+","+e.color[2]+")";gj[b].innerHTML=e.name;e.id==a&&(d.admin=!0);if(z.onlineID==e.id){of[b].innerHTML="";d=document.createElement("button");d.onmousedown=lj;d.iteam=b;d.innerHTML=e.team;of[b].appendChild(d);d=document.createElement("button");d.onmousedown=mj;d.iteam=b;d.innerHTML=La[e.race];Xg[b].appendChild(d);d=document.createElement("input");d.type="color";var h=e.color;d.iteam=b;d.value="#"+(16777216+(h[0]<<16)+(h[1]<<8)+h[2]).toString(16).slice(1);
Wg[b].appendChild(d);d.onchange=nj;Vb[b].style.background="#00ff00";Vb[b].style.boxShadow="0px 0px 30px 0px #00ff00"}else of[b].innerHTML=e.team,Xg[b].innerHTML=La[e.race];G[b]=e}G.length=c.length},G=[];window.onhashchange=ih;var $b=document.getElementById("msgs"),kc=document.getElementById("msgs1"),pf=document.getElementById("msginput"),zg=document.getElementById("msginputGame"),yg=document.getElementById("enterwindow");pf.addEventListener("keyup",function(a){13==a.keyCode&&Ag()});var zb=function(a,
b,e){xa("chat");e&&(u.started?(b=kc,qf()):b=$b,M(e),b.innerHTML=5!==e?b.innerHTML+("<li><span>"+e.username+" \u2014</span> "+Rb(a)+"</li>"):b.innerHTML+("<li>"+a+"</li>"),b.scrollTop=b.scrollHeight)},qf=function(){11==$b.children.length&&kc.removeChild(kc.children[0]);1==$b.children.length&&(qf.intv=setInterval(function(){kc.removeChild(kc.children[0]);0==$b.children.length&&clearInterval(qf.intv)},3E4))},Rb=function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,
"&quot;")},Ag=function(){if(u.started){var a=kc,b=zg.value;zg.value="";qf()}else a=$b,b=pf.value,pf.value="";""!=b&&(b=Rb(b),a.innerHTML+="<li><span>"+z.name+" \u2014</span> "+b+"</li>",ca(zb,b,0,0,0),a.scrollTop=a.scrollHeight)},ie=[Sg,xb,Ad,qc,qe,Vc,Sc,lh,mh,zb,de,xd,Tc,Fg,Uc,Id,hg,ne,bg,Ic,nb,jj,kj,Jf,Gi,function(a,b,e){e&&(a=Jc(a))&&a.open&&(M("I CAN connect"),ca(Kc,a.id,0,[e],0))},Kc,hj,nf,Uf,qg,He,rg,mi,og,te,we,Qe,Je,tg,Ae,Wh,Fd,If,function(a,b){b=y[b];var e=a[0];a=a[1];var c=x;!1!==e&&(b.kx=
e);!1!==a&&(b.ky=a);e=-(b.x32+e+(a+b.y32)*c);b.stop=b.kx||b.ky?!1:!0;Number.isInteger(b.xf)||xb(e,[b.id])},ng,di,ei,Kf,ye,pg,Se,Le,ii,Ue,Ee,Ce,Ne,vg,yi,ji,zh,gh];localStorage.favMusic&&(musicSelect.mversion.value=localStorage.favMusic);Sg.antiHack=0;xb.antiHack=0;Ad.antiHack=0;qc.antiHack=0;qe.antiHack=0;Vc.antiHack=0;Sc.antiHack=0;P.antiHack=0;pe.antiHack=0;Oa.antiHack=0;kb.antiHack=0;P.antiHack=0;lh.antiHack=0;mh.antiHack=0;zb.antiHack=0;de.antiHack=0;xd.antiHack=0;Tc.antiHack=0;ud.antiHack=0;Fg.antiHack=
0;Uc.antiHack=0;Id.antiHack=0;hg.antiHack=0;ne.antiHack=0;(function(){for(var a=ie,b=0,e=a.length;b<e;b++)a[b].location=b})();var Ug=function(){var a=document.getElementById("mapconfiguration").style;a.display="none"==a.display?"block":"none"},oj=document.getElementsByClassName("ucolor1"),Pk=document.getElementsByClassName("username1"),Qk=document.getElementsByClassName("race1"),Rk=document.getElementsByClassName("team1"),lj=function(a){var b=1;2==a.button&&(b=-1);a=this.iteam;G[a].team+=b;0>G[a].team&&
(G[a].team=0);this.innerHTML=G[a].team;u.online&&(b=parseInt(this.innerHTML),this.innerHTML=b%=5,ca(Jf,b,0,0,2),G[a].team=b)},mj=function(a){a=G[this.iteam];a.race=(a.race+1)%3;this.innerHTML=La[a.race];ca(Kf,a.race,0,0,2)},nj=function(){this.parentElement.style.background=this.value;var a=this.value.match(/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i);G[this.iteam].color=[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)];Ba.length&&ca(If,this.value,0,0,2)},Sk=function(){ac.nu++;ac()},Tk=function(){ac.nu--;
0>=ac.nu?ac.nu=1:G.length--;ac()},xg={0:"euro",1:"arab",2:"asia"},pj=[["a","e","i","o","u"],"bcdfghjklmnpqrstvwxyz".split("")],ac=function(){document.getElementById("returnmenu").style.display="block";document.getElementById("oneplayertbody").innerHTML="";document.getElementById("oneplayertbody").innerHTML+='<tr><td></td><td id="addremove"><button id="addPlayer">+</button><button id="removePlayer">-</button></td><td></td><td></td></tr>';for(var a=ac.nu,b=0;b<a;b++)if(document.getElementById("oneplayertbody").innerHTML+=
'<tr><td class="ucolor1"></td><td class="username1"></td><td class="race1"><button></button></td><td class="team1"><button></button></td></tr>',!G[b]){var e=~~(16777216*Math.random());G[b]={color:[e>>16&255,e>>8&255,e&255],IA:1,race:~~(3*Math.random()),team:b}}document.getElementById("addPlayer").onclick=Sk;document.getElementById("removePlayer").onclick=Tk;G[0].color=[0,0,189];G[0].name=z.name;for(b=e=G[0].IA=0;b<a;b++){var c=G[b],d=Mh[xg[c.race]];if(c.IA)if(e<d.length)c.name=d[e++];else{d=c;var h=
~~(9*Math.random())+2,g=pj[1],k=g[~~(Math.random()*g.length)].toUpperCase();.85<Math.random()&&(k+=g[~~(Math.random()*g.length)]);for(g=0;g<h;g++){var p=pj[g%2];k+=p[~~(Math.random()*p.length)];.8<Math.random()&&(k+=p[~~(Math.random()*p.length)])}d.name=k}oj[b].style.background="rgb("+c.color[0]+","+c.color[1]+","+c.color[2]+")";Pk[b].innerHTML=c.name;d=Rk[b].getElementsByTagName("button")[0];d.iteam=b;d.onmousedown=lj;d.innerHTML=b;d=Qk[b].getElementsByTagName("button")[0];d.iteam=b;d.onmousedown=
mj;d.innerHTML=La[c.race];c=G[b].color;d=document.createElement("input");d.type="color";d.iteam=b;d.value="#"+(16777216+(c[0]<<16)+(c[1]<<8)+c[2]).toString(16).slice(1);oj[b].appendChild(d);d.onchange=nj}};ac.nu=4;var Fk=function(a,b,e){var c=new Notification(a,{icon:"https://pbs.twimg.com/profile_images/861248696176062464/ANKhddMo_400x400.jpg",body:b,requireInteraction:!0});e||(e=5E3);setTimeout(function(){c.close()},e)},fd,a,Wi,mf,Dk=function(){var f={};a={move:function(){L=xb;xb.cursor=7}};a.move.iconID=
262;a.move.obj={name:A.move};a.attack=function(){L=qc};a.attack.iconID=250;a.attack.obj={name:A.attack};a.guard=function(){hc(4)};a.guard.iconID=237;a.guard.obj={name:A.guard};a.patrol=function(){hc(8)};a.patrol.iconID=238;a.patrol.obj={name:A.patrol};a.pickUp=function(){L=Tc};a.pickUp.iconID=240;a.pickUp.obj={name:A.pickItems};a.explore=function(){hc(7)};a.explore.iconID=40;a.explore.obj={name:A.explore};a.stop=function(){ca(hg,0,H)};a.stop.iconID=160;a.stop.obj={name:A.stop};a.stand=function(){ca(Wh,
0,H)};a.stand.iconID=27;a.stand.obj={name:A.stand};a.attackGround=function(){};a.attackGround.iconID=100;a.steady=function(){};a.steady.iconID=21;a.createOrk=function(){W(58)};a.createOrk.iconID=120;a.createDwarf=function(){W(59)};a.createDwarf.iconID=117;a.createSkeleton=function(){W(60)};a.createSkeleton.iconID=87;a.createGhost=function(){W(40)};a.createGhost.iconID=222;a.createFootman=function(){W(0)};a.createFootman.iconID=182;a.createArcher=function(){W(4)};a.createArcher.iconID=185;a.createMaceman=
function(){W(3)};a.createMaceman.iconID=186;a.createPikeman=function(){W(1)};a.createPikeman.iconID=183;a.createLongbowman=function(){W(6)};a.createLongbowman.iconID=184;a.createKnight=function(){W(19)};a.createKnight.iconID=180;a.iniMercenaries=function(a){a.mlist=[];a.mlistID=[];a.mercID=0;cg(a);a.setupINTV(Eg,a.id,2E3)};a.iniMercenaries.builds=[30];a.iniHeroes=function(a){a.hlist=[];a.hlistID=[];a.heroID=0;cg(a);a.setupINTV(Eg,a.id,2E3)};a.iniHeroes.builds=[30];a.mercFootmanArab=function(){ua()};
a.mercFootmanArab.iconID=49;a.mercFootmanArab.unit=80;a.mercFootmanArab.obj={};a.mercArcherArab=function(){ua()};a.mercArcherArab.iconID=52;a.mercArcherArab.unit=85;a.mercArcherArab.obj={};a.mercMacemanArab=function(){ua()};a.mercMacemanArab.iconID=116;a.mercMacemanArab.obj={};a.mercMacemanArab.unit=83;a.mercPikemanArab=function(){ua()};a.mercPikemanArab.iconID=52;a.mercPikemanArab.unit=82;a.mercPikemanArab.obj={};a.mercCavalry=function(){ua()};a.mercCavalry.iconID=133;a.mercCavalry.unit=84;a.mercCavalry.obj=
{};a.mercEnichar=function(){ua()};a.mercEnichar.iconID=123;a.mercEnichar.unit=91;a.mercEnichar.obj={};a.mercJihad=function(){ua()};a.mercJihad.iconID=236;a.mercJihad.unit=86;a.mercJihad.obj={};a.mercFootmanArab6=function(){Na()};a.mercFootmanArab6.iconID=49;a.mercFootmanArab6.unit=80;a.mercFootmanArab6.obj={};a.mercArcherArab6=function(){Na()};a.mercArcherArab6.iconID=52;a.mercArcherArab6.unit=85;a.mercArcherArab6.obj={};a.mercMacemanArab6=function(){Na()};a.mercMacemanArab6.iconID=116;a.mercMacemanArab6.unit=
83;a.mercMacemanArab6.obj={};a.mercPikemanArab6=function(){Na()};a.mercPikemanArab6.iconID=52;a.mercPikemanArab6.unit=82;a.mercPikemanArab6.obj={};a.mercCavalry6=function(){Na()};a.mercCavalry6.iconID=133;a.mercCavalry6.unit=84;a.mercCavalry6.obj={};a.mercEnichar6=function(){Na()};a.mercEnichar6.iconID=123;a.mercEnichar6.unit=91;a.mercEnichar6.obj={};a.mercJihad6=function(){Na()};a.mercJihad6.iconID=236;a.mercJihad6.unit=86;a.mercJihad6.obj={};a.mercFootman=function(){ua()};a.mercFootman.iconID=182;
a.mercFootman.unit=0;a.mercArcher=function(){ua()};a.mercArcher.iconID=185;a.mercArcher.unit=4;a.mercMaceman=function(){ua()};a.mercMaceman.iconID=186;a.mercMaceman.unit=3;a.mercPikeman=function(){ua()};a.mercPikeman.iconID=183;a.mercPikeman.unit=1;a.mercLongbowman=function(){ua()};a.mercLongbowman.iconID=184;a.mercLongbowman.unit=6;a.mercKnight=function(){ua()};a.mercKnight.iconID=180;a.mercKnight.unit=19;a.mercFootman6=function(){Na()};a.mercFootman6.iconID=182;a.mercFootman6.unit=0;a.mercFootman6.obj=
{};a.mercArcher6=function(){Na()};a.mercArcher6.iconID=185;a.mercArcher6.unit=4;a.mercArcher6.obj={};a.mercMaceman6=function(){Na()};a.mercMaceman6.iconID=186;a.mercMaceman6.unit=3;a.mercMaceman6.obj={};a.mercPikeman6=function(){Na()};a.mercPikeman6.iconID=183;a.mercPikeman6.unit=1;a.mercPikeman6.obj={};a.mercLongbowman6=function(){Na()};a.mercLongbowman6.iconID=184;a.mercLongbowman6.unit=6;a.mercLongbowman6.obj={};a.mercKnight6=function(){Na()};a.mercKnight6.iconID=180;a.mercKnight6.unit=19;a.mercKnight6.obj=
{};a.mercArcherAsian6=function(){Na()};a.mercArcherAsian6.iconID=53;a.mercArcherAsian6.unit=67;a.mercArcherAsian6.obj={};a.mercSamurai6=function(){Na()};a.mercSamurai6.iconID=122;a.mercSamurai6.unit=68;a.mercSamurai6.obj={};a.mercHourseSamurai6=function(){Na()};a.mercHourseSamurai6.iconID=121;a.mercHourseSamurai6.unit=70;a.mercHourseSamurai6.obj={};a.mercRonin6=function(){Na()};a.mercRonin6.iconID=54;a.mercRonin6.unit=66;a.mercRonin6.obj={};a.mercHorseArcher6=function(){Na()};a.mercHorseArcher6.iconID=
52;a.mercHorseArcher6.unit=69;a.mercHorseArcher6.obj={};a.mercChariot6=function(){Na()};a.mercChariot6.iconID=79;a.mercChariot6.unit=72;a.mercChariot6.obj={};a.mercArcherAsian=function(){ua()};a.mercArcherAsian.iconID=53;a.mercArcherAsian.unit=67;a.mercArcherAsian.obj={};a.mercSamurai=function(){ua()};a.mercSamurai.iconID=122;a.mercSamurai.unit=68;a.mercSamurai.obj={};a.mercHourseSamurai=function(){ua()};a.mercHourseSamurai.iconID=121;a.mercHourseSamurai.unit=70;a.mercHourseSamurai.obj={};a.mercRonin=
function(){ua()};a.mercRonin.iconID=54;a.mercRonin.unit=66;a.mercRonin.obj={};a.mercHorseArcher=function(){ua()};a.mercHorseArcher.iconID=52;a.mercHorseArcher.unit=69;a.mercHorseArcher.obj={};a.mercChariot=function(){ua()};a.mercChariot.iconID=79;a.mercChariot.unit=72;a.mercChariot.obj={};a.createPeon=function(){W(10)};a.createPeon.iconID=187;a.sameSpeed=function(){ca(ei,H)};a.sameSpeed.iconID=82;a.restoreSpeed=function(){ca(di,H)};a.restoreSpeed.iconID=88;a.createSpy=function(){W(2)};a.createSpy.iconID=
162;a.emergeAllUnits=function(){var a=H[0];ca(Uc,a,y[a].inventory.slice(0))};a.emergeAllUnits.iconID=261;a.techFeudalism=function(){C(12)};a.techFeudalism.iconID=233;a.techArchitecture=function(){C(13)};a.techArchitecture.iconID=226;a.techLearning=function(){C(14)};a.techLearning.iconID=129;a.createPeon1=function(){W(64)};a.createPeon1.iconID=55;a.createPeon2=function(){W(79)};a.createPeon2.iconID=132;a.createNinja=function(){W(65)};a.createNinja.iconID=51;a.techArmoredChariot=function(){C(51)};a.techArmoredChariot.iconID=
79;a.techBuddhism=function(){C(45)};a.techBuddhism.iconID=127;a.techGreatWall=function(){C(48)};a.techGreatWall.iconID=80;a.ridingHorses=function(){C(49)};a.ridingHorses.iconID=64;a.irrigation=function(){C(50)};a.irrigation.iconID=72;a.createHorseArcher2=function(){W(85)};a.createHorseArcher2.iconID=52;a.techMeditation=function(){C(52)};a.techMeditation.iconID=71;a.techKungFu=function(){C(53)};a.techKungFu.iconID=228;a.techTournaments=function(){C(54)};a.techTournaments.iconID=73;a.techPhilosophy=
function(){C(55)};a.techPhilosophy.iconID=68;a.techNinjas=function(){C(56)};a.techNinjas.iconID=56;a.techMastery=function(){C(57)};a.techMastery.iconID=69;a.techGoldMining=function(){C(1)};a.techGoldMining.iconID=58;a.techStoneMining=function(){C(2)};a.techStoneMining.iconID=57;a.createCrusaders=function(){ca(Fg,H[0],0)};a.createCrusaders.iconID=221;a.techFanaticism=function(){C(31)};a.techFanaticism.iconID=235;a.techCrusade=function(){C(32)};a.techCrusade.iconID=93;a.techEspionage=function(){C(30)};
a.techEspionage.iconID=215;a.techInquisition=function(){C(33)};a.techInquisition.iconID=97;a.techHealing=function(){C(34)};a.techHealing.iconID=219;a.healing=function(){L=qg};a.healing.iconID=219;a.healing.iconIDbook=201;a.teach=function(){L=vg};a.teach.iconID=23;a.teach.iconIDbook=217;a.techBless=function(){C(36)};a.techBless.iconID=159;a.bless=function(){L=He};a.bless.iconID=159;a.bless.iconIDbook=204;a.techMedicine=function(){C(35)};a.techMedicine.iconID=220;a.createMage=function(){W(5)};a.createMage.iconID=
156;a.techBat=function(){C(38)};a.techBat.iconID=168;a.techGolem=function(){C(41)};a.techGolem.iconID=119;a.techInvisibility=function(){C(37)};a.techInvisibility.iconID=217;a.techLightning=function(){C(40)};a.techLightning.iconID=143;a.techFreeze=function(){C(39)};a.techFreeze.iconID=130;a.techHeroism=function(){C(22)};a.techHeroism.iconID=136;a.techWarfare=function(){C(23)};a.techWarfare.iconID=108;a.techTactics=function(){C(24)};a.techTactics.iconID=257;a.techMercenaries=function(){C(25)};a.techMercenaries.iconID=
95;a.techHeroes=function(){C(26)};a.techHeroes.iconID=96;a.techFame=function(){C(27)};a.techFame.iconID=111;a.techSiegeTactics=function(){C(28)};a.techSiegeTactics.iconID=258;a.techBodyBuilding=function(){C(29)};a.techBodyBuilding.iconID=101;a.createPriest=function(){W(9)};a.createPriest.iconID=155;a.createCow=function(){W(27)};a.createCow.iconID=163;a.techCropRotation=function(){C(8)};a.techCropRotation.iconID=227;a.techDomestication=function(){C(7)};a.techDomestication.iconID=157;a.techMapMaking=
function(){C(16)};a.techMapMaking.iconID=89;a.techTradeRoutes=function(){C(17)};a.techTradeRoutes.iconID=102;a.techTradeTaxes=function(){C(18)};a.techTradeTaxes.iconID=110;a.techUsury=function(){C(19)};a.techUsury.iconID=105;a.techSupplyStorage=function(){C(20)};a.techSupplyStorage.iconID=62;a.techBribery=function(){C(21)};a.techBribery.iconID=109;a.bribe=function(){};a.bribe.iconID=128;a.createCaravan=function(){W(61)};a.createCaravan.iconID=169;a.createCaravan2=function(){W(90)};a.createCaravan2.iconID=
134;a.createFootman2=function(){W(80)};a.createFootman2.iconID=49;a.createArcher2=function(){W(81)};a.createArcher2.iconID=43;a.createSatrap=function(){W(83)};a.createSatrap.iconID=116;a.createPikeman2=function(){W(82)};a.createPikeman2.iconID=42;a.createHorseArcher2=function(){W(85)};a.createHorseArcher2.iconID=124;a.createCavalry=function(){W(84)};a.createCavalry.iconID=133;a.createEnichar=function(){W(91)};a.createEnichar.iconID=123;a.createJihad=function(){W(86)};a.createJihad.iconID=236;a.trade=
function(){};a.trade.iconID=161;a.unload=function(){L=te};a.unload.iconID=148;a.createMercenaries=function(){ka(y[H[0]].mlist)};a.createMercenaries.iconID=95;a.createHeroes=function(){ka(y[H[0]].hlist)};a.createHeroes.iconID=96;a.upgradeGuildTower=function(){C(42)};a.upgradeGuildTower.iconID=171;a.upgradeStoneTower=function(){C(43)};a.upgradeStoneTower.iconID=178;a.upgradeCannonTower=function(){C(44)};a.upgradeCannonTower.iconID=178;a.createCatapult=function(){W(37)};a.createCatapult.iconID=152;a.createHeavyCatapult=
function(){W(39)};a.createHeavyCatapult.iconID=153;a.createBallist=function(){W(38)};a.createBallist.iconID=154;a.techEngineering=function(){C(47)};a.techEngineering.iconID=92;a.techCannonTower=function(){C(46)};a.techCannonTower.iconID=178;a.techPlateArmor=function(){C(10)};a.techPlateArmor.iconID=131;a.techTemperIron=function(){C(4)};a.techTemperIron.iconID=266;a.techHalberd=function(){C(6)};a.techHalberd.iconID=113;a.techScaleArmor=function(){C(5)};a.techScaleArmor.iconID=251;a.techChainMail=function(){C(9)};
a.techChainMail.iconID=252;a.techLongbow=function(){C(0)};a.techLongbow.iconID=259;a.techWoodCutting=function(){C(3)};a.techWoodCutting.iconID=107;a.techCrossbow=function(){C(11)};a.techCrossbow.iconID=112;a.createFishingBoat=function(){W(74)};a.createFishingBoat.iconID=48;a.createXebec=function(){W(76)};a.createXebec.iconID=166;a.upgradeShip=function(){};a.upgradeShip.iconID=268;a.fishing=function(){};a.fishing.iconID=41;a.createHulk=function(){W(75)};a.createHulk.iconID=165;a.createGalleon=function(){W(73)};
a.createGalleon.iconID=164;a.techLandingTactics=function(){};a.techLandingTactics.iconID=98;a.techConcentration=function(){C(58)};a.techConcentration.iconID=75;a.techConfusion=function(){C(59)};a.techConfusion.iconID=76;a.techWhirlpool=function(){C(60)};a.techWhirlpool.iconID=78;a.techDragon=function(){C(61)};a.techDragon.iconID=115;a.techTurnToStone=function(){C(62)};a.techTurnToStone.iconID=77;a.techFlameBolt=function(){C(63)};a.techFlameBolt.iconID=25;a.techJewelry=function(){C(64)};a.techJewelry.iconID=
230;a.techBanking=function(){C(65)};a.techBanking.iconID=74;a.techChemistry=function(){C(66)};a.techChemistry.iconID=225;a.techSeaFood=function(){C(67)};a.techSeaFood.iconID=67;a.techGunPowder=function(){C(68)};a.techGunPowder.iconID=212;a.techRocketArrow=function(){C(69)};a.techRocketArrow.iconID=47;a.techBushido=function(){C(70)};a.techBushido.iconID=60;a.techLeadership=function(){C(71)};a.techLeadership.iconID=114;a.techHonor=function(){C(72)};a.techHonor.iconID=94;a.techSunTzu=function(){C(73)};
a.techSunTzu.iconID=66;a.createRonin=function(){W(66)};a.createRonin.iconID=54;a.createArcher1=function(){W(67)};a.createArcher1.iconID=53;a.createSamurai=function(){W(68)};a.createSamurai.iconID=122;a.createHorseArcher1=function(){W(69)};a.createHorseArcher1.iconID=52;a.createMonk=function(){W(128)};a.createMonk.iconID=45;a.createMage1=function(){W(129)};a.createMage1.iconID=50;a.createPriest1=function(){W(127)};a.createPriest1.iconID=44;a.createPriest2=function(){W(87)};a.createPriest2.iconID=125;
a.buyItems=function(){};a.buyItems.iconID=31;a.sellItems=function(){};a.sellItems.iconID=30;a.createHorseSamurai=function(){W(70)};a.createHorseSamurai.iconID=121;a.createChariot=function(){W(72)};a.createChariot.iconID=79;a.stopTech=function(){ca(ne,0,H);Ha(y[H[0]])};a.stopTech.iconID=160;a.repair=function(){L=Vc};a.repair.iconID=145;a.conquest=function(){};a.conquest.iconID=249;a.dcm=function(){L=Ad};a.dcm.iconID=260;a.buildBarrack=function(){I(14)};a.buildBarrack.iconID=205;a.buildBarrack1=function(){I(71)};
a.buildBarrack1.iconID=205;a.buildBarrack2=function(){I(102)};a.buildBarrack2.iconID=205;a.buildTower=function(){I(32)};a.buildTower.iconID=170;a.buildStorage=function(){I(18)};a.buildStorage.iconID=200;a.buildLumbermill=function(){I(15)};a.buildLumbermill.iconID=199;a.buildLumbermill2=function(){I(93)};a.buildLumbermill2.iconID=199;a.buildFields=function(){I(20)};a.buildFields.iconID=265;a.buildCastle=function(){I(12)};a.buildCastle.iconID=206;a.buildCastle1=function(){I(62)};a.buildCastle1.iconID=
206;a.buildCastle2=function(){I(63)};a.buildCastle2.iconID=206;a.buildAcademy=function(){I(17)};a.buildAcademy.iconID=204;a.buildCathedral=function(){I(11)};a.buildCathedral.iconID=191;a.buildCathedral2=function(){I(106)};a.buildCathedral2.iconID=189;a.buildMerchands=function(){I(24)};a.buildMerchands.iconID=198;a.buildMerchands2=function(){I(108)};a.buildMerchands2.iconID=198;a.buildChurch=function(){I(25)};a.buildChurch.iconID=197;a.buildMarket=function(){I(33)};a.buildMarket.iconID=194;a.buildMageTower=
function(){I(16)};a.buildMageTower.iconID=192;a.buildMageTower2=function(){I(107)};a.buildMageTower2.iconID=192;a.buildDummy=function(){I(36)};a.buildDummy.iconID=65;a.buildFarm=function(){I(23)};a.buildFarm.iconID=193;a.buildBlacksmith=function(){I(26)};a.buildBlacksmith.iconID=202;a.buildWorkshop=function(){I(29)};a.buildWorkshop.iconID=201;a.buildWorkshop2=function(){I(98)};a.buildWorkshop2.iconID=201;a.buildStable=function(){I(28)};a.buildStable.iconID=196;a.buildStable2=function(){I(103)};a.buildStable2.iconID=
196;a.buildTavern=function(){I(30)};a.buildTavern.iconID=208;a.buildHouse=function(){I(31)};a.buildHouse.iconID=195;a.buildHarbor=function(){I(41)};a.buildHarbor.iconID=188;a.buildOutpost=function(){I(34)};a.buildOutpost.iconID=158;a.buildWoodWall=function(){gg(13)};a.buildWoodWall.iconID=210;a.buildWoodGate=function(){};a.buildWoodGate.iconID=209;a.buildWoodGate.disabled=2;a.buildBridge=function(){I(35)};a.buildBridge.iconID=176;mf="freeze invisibility lightning turnToStone bless healing".split(" ");
a.freeze=function(){L=Qe};a.freeze.iconID=99;a.freeze.obj={name:A.freeze};a.freeze.iconIDbook=205;a.confusion=function(){L=Se};a.confusion.iconID=76;a.confusion.obj={name:"Confusion",spcost:[120,0,0,0]};a.confusion.iconIDbook=206;a.turnToStone=function(){L=pg};a.turnToStone.iconID=77;a.turnToStone.iconIDbook=213;a.turnToStone.obj={name:"Turn to Stone",spcost:[40,0,0,0]};a.whirlpool=function(){L=ii};a.whirlpool.iconID=78;a.whirlpool.iconIDbook=214;a.whirlpool.obj={name:"Whirlpool",spcost:[80,0,0,0]};
a.flameBolt=function(){L=Le};a.flameBolt.iconID=25;a.flameBolt.obj={name:"Flame Bolt",spcost:[120,0,0,0]};a.flameBolt.iconIDbook=216;a.createDragon=function(){L=ye};a.createDragon.iconID=115;a.createDragon.obj={name:"Spawn Dragon",spcost:[320,0,0,0]};a.createDragon.iconIDbook=215;a.lightning=function(){L=tg};a.lightning.iconID=263;a.lightning.obj={name:A.lightning,spcost:[80,0,0,0]};a.lightning.iconIDbook=200;a.createBat=function(){L=Ae};a.createBat.iconID=168;a.createBat.iconIDbook=203;a.createGolem=
function(){L=we};a.createGolem.iconID=119;a.createGolem.iconIDbook=209;a.autoInvisibility=function(){L=Je};a.autoInvisibility.iconID=217;a.autoInvisibility.obj={name:A.invisibility};a.invisibility=function(){L=Je};a.invisibility.iconID=217;a.invisibility.iconIDbook=208;a.impersonate=function(){L=rg};a.impersonate.iconID=32;a.impersonate.obj={name:"Impersonate"};a.revealSelf=function(){ca(mi,H[0],0)};a.revealSelf.iconID=33;a.revealSelf.obj={name:"Reveal your true self"};a.buildHouse1=function(){I(111)};
a.buildHouse1.iconID=195;a.buildHouse2=function(){I(92)};a.buildHouse2.iconID=195;a.buildLumbermill1=function(){I(112)};a.buildLumbermill1.iconID=199;a.buildStorage1=function(){I(113)};a.buildStorage1.iconID=200;a.buildStorage2=function(){I(94)};a.buildStorage2.iconID=200;a.buildFarm1=function(){I(114)};a.buildFarm1.iconID=193;a.buildFarm2=function(){I(95)};a.buildFarm2.iconID=193;a.buildHarbor1=function(){I(115)};a.buildHarbor1.iconID=188;a.buildHarbor2=function(){I(96)};a.buildHarbor2.iconID=188;
a.buildBlacksmith1=function(){I(116)};a.buildBlacksmith1.iconID=202;a.buildBlacksmith2=function(){I(97)};a.buildBlacksmith2.iconID=202;a.buildWorkshop1=function(){I(117)};a.buildWorkshop1.iconID=201;a.buildChurch1=function(){I(118)};a.buildChurch1.iconID=197;a.buildChurch2=function(){I(99)};a.buildChurch2.iconID=197;a.buildTavern1=function(){I(119)};a.buildTavern1.iconID=208;a.buildTavern2=function(){I(100)};a.buildTavern2.iconID=208;a.buildMarket1=function(){I(120)};a.buildMarket1.iconID=194;a.buildMarket2=
function(){I(101)};a.buildMarket2.iconID=194;a.buildStable1=function(){I(121)};a.buildStable1.iconID=196;a.buildOutpost1=function(){I(122)};a.buildOutpost1.iconID=158;a.buildOutpost2=function(){I(104)};a.buildOutpost2.iconID=158;a.buildCathedral1=function(){I(123)};a.buildCathedral1.iconID=190;a.buildMageTower1=function(){I(124)};a.buildMageTower1.iconID=192;a.createObjects=function(){Hd("magicworkshopmenu",X)};a.createObjects.iconID=20;a.createObjects.obj={};a.buildMagicWorkshop=function(){I(110)};
a.buildMagicWorkshop.iconID=46;a.buildMerchands1=function(){I(125)};a.buildMerchands1.iconID=198;a.buildAcademy1=function(){I(126)};a.buildAcademy1.iconID=204;a.buildAcademy2=function(){I(109)};a.buildAcademy2.iconID=204;a.buildRocketTower=function(){I(57)};a.buildRocketTower.iconID=47;a.murder=function(){I(57)};a.murder.iconID=28;a.convertJihad=function(){};a.convertJihad.iconID=236;a.convertJihad.obj={};a.menuCommonBuild2=function(){ka(b)};a.menuCommonBuild2.iconID=17;var b=[a.buildFarm2,a.buildBlacksmith2,
a.buildWorkshop2,a.buildStable2,a.buildTavern2,a.buildHouse2];b.menuName="a_build";a.menuCommonBuild2.xtra=b;a.menuSpecialBuild2=function(){ka(e)};a.menuSpecialBuild2.iconID=15;var e=[a.buildCastle2,a.buildAcademy2,a.buildCathedral2,a.buildMerchands2,a.buildChurch2,a.buildMarket2,a.buildMageTower2,a.buildMagicWorkshop];e.menuName="a_build";a.menuSpecialBuild2.xtra=e;a.menuOtherBuild2=function(){ka(c)};a.menuOtherBuild2.iconID=16;var c=[a.buildHarbor2,a.buildOutpost2,a.buildWoodWall,a.buildWoodGate,
a.buildBridge];c.menuName="e_build";a.menuOtherBuild2.xtra=c;a.menuBuilds2=function(){ka(d)};a.menuBuilds2.iconID=245;var d=[a.menuSpecialBuild2,a.menuCommonBuild2,a.menuOtherBuild2,a.buildBarrack2,a.buildTower,a.buildStorage2,a.buildLumbermill2,a.buildFields];d.menuName="a_build";a.menuBuilds2.xtra=d;a.createCarpet=function(){L=Ee};a.createCarpet.iconID=146;a.createCarpet.iconIDbook=202;a.createJinn=function(){L=Ce};a.createJinn.iconID=118;a.createJinn.iconIDbook=218;a.magicVision=function(){};a.magicVision.iconID=
223;a.magicVision.iconIDbook=210;a.fireRain=function(){L=Ue};a.fireRain.iconID=264;a.fireRain.iconIDbook=199;a.raiseDead=function(){L=Ne};a.raiseDead.iconID=87;a.raiseDead.iconIDbook=211;a.createMage2=function(){W(89)};a.createMage2.iconID=126;a.techCowPoaching=function(){C(74)};a.techCowPoaching.iconID=85;a.techHorseManShip=function(){C(75)};a.techHorseManShip.iconID=231;a.techScimitar=function(){C(76)};a.techScimitar.iconID=84;a.techJihad=function(){C(77)};a.techJihad.iconID=236;a.techCarpet=function(){C(78)};
a.techCarpet.iconID=146;a.techMagicWorkshop=function(){C(79)};a.techMagicWorkshop.iconID=86;a.techFireRain=function(){C(80)};a.techFireRain.iconID=264;a.techMagicVision=function(){C(81)};a.techMagicVision.iconID=224;a.techNecromancy=function(){C(82)};a.techNecromancy.iconID=87;a.techJinn=function(){C(83)};a.techJinn.iconID=118;a.techOreFloatation=function(){C(84)};a.techOreFloatation.iconID=106;a.techRiddingHorses=function(){C(85)};a.techRiddingHorses.iconID=232;a.techJanissary=function(){C(86)};
a.techJanissary.iconID=81;a.buildMagicItems=function(){};a.buildMagicItems.iconID=20;a.techSlavery=function(){C(87)};a.techSlavery.iconID=135;a.stopBuilding=function(){ca(Id,0,H)};a.stopBuilding.iconID=160;a.menuSpecialBuild1=function(){ka(h)};a.menuSpecialBuild1.iconID=15;var h=[a.buildCastle1,a.buildAcademy1,a.buildCathedral1,a.buildMerchands1,a.buildChurch1,a.buildMarket1,a.buildMageTower1,a.buildRocketTower,a.buildDummy];h.menuName="a_build";a.menuSpecialBuild1.xtra=h;a.menuCommonBuild1=function(){ka(g)};
a.menuCommonBuild1.iconID=17;var g=[a.buildFarm1,a.buildBlacksmith1,a.buildWorkshop1,a.buildStable1,a.buildTavern1,a.buildHouse1];g.menuName="a_build";a.menuCommonBuild1.xtra=g;a.menuSpecialBuild=function(){ka(k)};a.menuSpecialBuild.iconID=15;var k=[a.buildCastle,a.buildAcademy,a.buildCathedral,a.buildMerchands,a.buildChurch,a.buildMarket,a.buildMageTower,a.buildDummy];k.menuName="e_build";a.menuSpecialBuild.xtra=k;a.menuCommonBuild=function(){ka(p)};a.menuCommonBuild.iconID=17;var p=[a.buildFarm,
a.buildBlacksmith,a.buildWorkshop,a.buildStable,a.buildTavern,a.buildHouse];p.menuName="e_build";a.menuCommonBuild.xtra=p;a.menuOtherBuild=function(){ka(m)};a.menuOtherBuild.iconID=16;var m=[a.buildHarbor,a.buildOutpost,a.buildWoodWall,a.buildWoodGate,a.buildBridge];m.menuName="e_build";a.menuOtherBuild.xtra=m;a.menuOtherBuild1=function(){ka(n)};a.menuOtherBuild1.iconID=16;var n=[a.buildHarbor1,a.buildOutpost1,a.buildWoodWall,a.buildWoodGate,a.buildBridge];n.menuName="e_build";a.menuOtherBuild1.xtra=
n;a.menuBuilds=function(){ka(q)};var q=[a.menuSpecialBuild,a.menuCommonBuild,a.menuOtherBuild,a.buildBarrack,a.buildTower,a.buildStorage,a.buildLumbermill,a.buildFields];q.menuName="e_build";a.menuBuilds.iconID=245;a.menuBuilds.xtra=q;a.menuBuilds1=function(){ka(r)};a.menuBuilds1.iconID=245;var r=[a.menuSpecialBuild1,a.menuCommonBuild1,a.menuOtherBuild1,a.buildBarrack1,a.buildTower,a.buildStorage1,a.buildLumbermill1,a.buildFields];r.menuName="a_build";a.menuBuilds1.xtra=r;Wi=function(){a.fishing.obj=
{};a.impersonate.obj={};a.techGreatWall.obj=F[48];a.revealSelf.obj={};a.trade.obj={};a.unload.obj={};a.mercFootman6.obj={};a.murder.obj={};a.mercArcher6.obj={};a.mercMaceman6.obj={};a.mercPikeman6.obj={};a.mercLongbowman6.obj={};a.sameSpeed.obj={name:"Same speed"};a.restoreSpeed.obj={name:"Restore speed"};a.mercKnight6.obj={};a.attackGround.obj={};a.steady.obj={};a.bribe.obj={};a.createPriest1.obj=w[127];a.createPriest2.obj=w[87];a.createFootman2.obj=w[80];a.createArcher2.obj=w[81];a.createSatrap.obj=
w[83];a.createPikeman2.obj=w[82];a.createHorseArcher2.obj=w[85];a.createCavalry.obj=w[84];a.createEnichar.obj=w[91];a.createJihad.obj=w[86];a.createMonk.obj=w[128];a.healing.obj={name:A.heal,spcost:[20,0,0,0]};a.bless.obj={name:A.bless,spcost:[20,0,0,0]};a.stopTech.obj={};a.conquest.obj={};a.dcm.obj={name:A.dcm};a.repair.obj={name:A.repair};a.menuOtherBuild.obj={};a.menuOtherBuild1.obj={};a.menuOtherBuild2.obj={};a.sellItems.obj={};a.buyItems.obj={};a.menuBuilds.obj={name:A.menuBuild};a.menuCommonBuild.obj=
{};a.menuSpecialBuild.obj={};a.techMastery.obj=F[57];a.techNinjas.obj=F[56];a.teach.obj={name:"Teach",spcost:[20,0,0,0]};a.techPhilosophy.obj=F[55];a.techKungFu.obj=F[53];a.techTournaments.obj=F[54];a.techMeditation.obj=F[52];a.menuCommonBuild1.obj={};a.menuCommonBuild2.obj={};a.createMage1.obj=w[129];a.menuSpecialBuild1.obj={};a.menuSpecialBuild2.obj={};a.menuBuilds1.obj={name:A.menuBuild};a.menuBuilds2.obj={name:A.menuBuild};a.stopBuilding.obj={};a.freeze.obj={name:A.freeze,spcost:[200,0,0,0]};
a.invisibility.obj={name:A.invisibility,spcost:[40,0,0,0]};a.autoInvisibility.obj={name:A.invisibility};a.createHeroes.obj={};a.createMercenaries.obj={};a.upgradeShip.obj={};a.techMedicine.obj=F[35];a.techBless.obj=F[36];a.buildHouse1.obj=w[111];a.techHealing.obj=F[34];a.techInquisition.obj=F[33];a.techArmoredChariot.obj=F[51];a.techRocketArrow.obj=F[69];a.techJewelry.obj=F[64];a.techGunPowder.obj=F[68];a.techSeaFood.obj=F[67];a.techChemistry.obj=F[66];a.techBanking.obj=F[65];a.createMage.obj=w[5];
a.techBat.obj=F[38];a.techGolem.obj=F[41];a.techInvisibility.obj=F[37];a.techLightning.obj=F[40];a.techFreeze.obj=F[39];a.techHeroism.obj=F[22];a.createHorseSamurai.obj=w[70];a.createChariot.obj=w[72];a.createHorseArcher1.obj=w[69];a.createHorseArcher2.obj=w[85];a.createSamurai.obj=w[68];a.createArcher1.obj=w[67];a.techConfusion.obj=F[59];a.techConcentration.obj=F[58];a.techWhirlpool.obj=F[60];a.techDragon.obj=F[61];a.techTurnToStone.obj=F[62];a.techFlameBolt.obj=F[63];a.createRonin.obj=w[66];a.buildStorage.obj=
w[18];a.buildStorage1.obj=w[113];a.buildStorage2.obj=w[94];a.buildFields.obj=w[20];a.buildLumbermill.obj=w[15];a.buildLumbermill1.obj=w[112];a.buildLumbermill2.obj=w[93];a.buildTower.obj=w[32];a.buildBarrack1.obj=w[71];a.buildBarrack.obj=w[14];a.buildBarrack2.obj=w[102];a.buildDummy.obj=w[36];a.buildRocketTower.obj=w[57];a.buildMageTower.obj=w[16];a.buildMageTower1.obj=w[124];a.buildMageTower2.obj=w[107];a.buildMarket.obj=w[33];a.buildMarket1.obj=w[120];a.buildMarket2.obj=w[101];a.buildChurch.obj=
w[25];a.buildChurch1.obj=w[118];a.buildChurch2.obj=w[99];a.buildMerchands.obj=w[24];a.irrigation.obj=F[50];a.ridingHorses.obj=F[49];a.buildMerchands1.obj=w[125];a.buildMerchands2.obj=w[108];a.buildCathedral.obj=w[11];a.buildCathedral1.obj=w[123];a.buildCathedral2.obj=w[106];a.buildAcademy.obj=w[17];a.buildAcademy1.obj=w[126];a.buildAcademy2.obj=w[109];a.buildCastle.obj=w[12];a.magicVision.obj={name:"Magic Vision",spcost:[20,0,0,0]};a.fireRain.obj={name:"Fire Rain",spcost:[200,0,0,0]};a.raiseDead.obj=
{name:"Raise the Dead",spcost:[40,0,0,0]};a.createJinn.obj={name:"Spawn Jinn",spcost:[320,0,0,0]};a.createCarpet.obj={name:"Spawn Magic Carpet",spcost:[320,0,0,0]};a.buildCastle1.obj=w[62];a.buildCastle2.obj=w[63];a.buildHouse.obj=w[31];a.buildHouse2.obj=w[92];a.buildTavern.obj=w[30];a.buildTavern1.obj=w[119];a.buildTavern2.obj=w[100];a.buildStable.obj=w[28];a.buildStable1.obj=w[121];a.buildStable2.obj=w[103];a.buildFarm.obj=w[23];a.buildFarm1.obj=w[114];a.buildFarm2.obj=w[95];a.buildWorkshop.obj=
w[29];a.buildWorkshop1.obj=w[117];a.buildWorkshop2.obj=w[98];a.buildBlacksmith.obj=w[26];a.buildBlacksmith1.obj=w[116];a.buildBlacksmith2.obj=w[97];a.buildBridge.obj=w[35];a.buildHarbor.obj=w[41];a.buildHarbor1.obj=w[115];a.buildHarbor2.obj=w[96];a.createMage2.obj=w[89];a.buildMagicItems.obj={};a.techJanissary.obj=F[86];a.techRiddingHorses.obj=F[85];a.techOreFloatation.obj=F[84];a.techJinn.obj=F[83];a.techNecromancy.obj=F[82];a.techMagicVision.obj=F[81];a.techFireRain.obj=F[80];a.techMagicWorkshop.obj=
F[79];a.techCarpet.obj=F[78];a.techJihad.obj=F[77];a.techScimitar.obj=F[76];a.techHorseManShip.obj=F[75];a.techCowPoaching.obj=F[74];a.buildWoodGate.obj={};a.buildWoodWall.obj=w[13];a.buildOutpost.obj=w[34];a.buildOutpost1.obj=w[122];a.buildOutpost2.obj=w[104];a.createGolem.obj={name:"Spawn Stone Golem",spcost:[480,0,0,0]};a.techSunTzu.obj=F[73];a.techBushido.obj=F[70];a.techLeadership.obj=F[71];a.techHonor.obj=F[72];a.createBat.obj={name:"Spawn Bat",spcost:[40,0,0,0]};a.techGoldMining.obj=F[1];a.techStoneMining.obj=
F[2];a.emergeAllUnits.obj={};a.createOrk.obj=w[58];a.createDwarf.obj=w[59];a.createSkeleton.obj=w[60];a.createGhost.obj=w[40];a.createFootman.obj=w[0];a.createArcher.obj=w[4];a.techSlavery.obj=F[87];a.createMaceman.obj=w[3];a.createPikeman.obj=w[1];a.createLongbowman.obj=w[6];a.createKnight.obj=w[19];a.mercFootman.obj=f;a.mercArcher.obj=f;a.mercMaceman.obj=f;a.mercPikeman.obj=f;a.mercLongbowman.obj=f;a.mercKnight.obj=f;a.createPeon.obj=w[10];a.createSpy.obj=w[2];a.techFeudalism.obj=F[12];a.techArchitecture.obj=
F[13];a.techLearning.obj=F[14];a.createPeon1.obj=w[64];a.createPeon2.obj=w[79];a.createNinja.obj=w[65];a.techBuddhism.obj=F[45];a.createCrusaders.obj={};a.buildMagicWorkshop.obj=w[110];a.techFanaticism.obj=F[31];a.techCrusade.obj=F[32];a.techEspionage.obj=F[30];a.techChainMail.obj=F[9];a.techHalberd.obj=F[6];a.techLongbow.obj=F[0];a.techScaleArmor.obj=F[5];a.techTemperIron.obj=F[4];a.techPlateArmor.obj=F[10];a.techLandingTactics.obj={};a.createGalleon.obj=w[73];a.createHulk.obj=w[75];a.createXebec.obj=
w[76];a.createFishingBoat.obj=w[74];a.techCrossbow.obj=F[11];a.techWoodCutting.obj=F[3];a.techCannonTower.obj=F[46];a.techEngineering.obj=F[47];a.createBallist.obj=w[38];a.createHeavyCatapult.obj=w[39];a.createCatapult.obj=w[37];a.upgradeCannonTower.obj=F[44];a.upgradeStoneTower.obj=F[43];a.upgradeGuildTower.obj=F[42];a.createCaravan.obj=w[61];a.createCaravan2.obj=w[90];a.techBribery.obj=F[21];a.techSupplyStorage.obj=F[20];a.techUsury.obj=F[19];a.techCropRotation.obj=F[8];a.createCow.obj=w[27];a.techDomestication.obj=
F[7];a.techTradeTaxes.obj=F[18];a.techTradeRoutes.obj=F[17];a.techMapMaking.obj=F[16];a.createPriest.obj=w[9];a.techBodyBuilding.obj=F[29];a.techSiegeTactics.obj=F[28];a.techFame.obj=F[27];a.techHeroes.obj=F[26];a.techMercenaries.obj=F[25];a.techTactics.obj=F[24];a.techWarfare.obj=F[23];for(var b=Object.keys(a),c=0,d=b.length;c<d;c++){var e=a[b[c]];e.objName=b[c];e.obj&&(e.obj.nu=e)}}},df={resitem:{u:"item_use",d:"item_drop"},item_soul:{k:"item_kill",b:"item_berserk",d:"item_drop"},wall_wood:{s:"to_swall"},
e_tavern:{t:"trade1",g:"gamble",m:"createMercenaries",h:"createHeroes",l:"loan"},loan:{g:"loan_gold",s:"loan_stone",f:"loan_food",w:"loan_wood"},e_castle:{p:"createPeon",s:"createSpy",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning"},a_castle:{p:"createPeon1",n:"createNina",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning",b:"techBudhism",w:"techGreatwall"},r_castle:{p:"createPeon2",s:"createSpy",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",
l:"techLearning",y:"techSlavery"},e_barrack:{f:"createFootman",a:"createArcher",m:"createMaceman",p:"createPikeman",l:"createLongbowman",k:"createKnight"},a_barrack:{r:"createRonin",a:"createArcher2",s:"createSamurai",h:"createHorseArcher1",o:"createHorseSamurai",c:"createChariot"},r_barrack:{f:"createFootman2",a:"createArcher2",s:"createSatrap",p:"createSpearman",h:"createHorsearcher2",c:"createCavalry",j:"createJanissary",d:"createJihadWarrior"},e_magetower:{m:"createMage"},r_magetower:{m:"createMage2"},
a_magetower:{m:"createMage1"},e_peon:{b:"menuBuilds",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",i:"bribe"},r_peon:{b:"menuBuilds2",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",j:"become_jihadw",i:"bribe"},a_peon:{b:"menuBuilds1",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",t:"trade"},e_priest:{m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",b:"bless"},a_priest:{m:"move",
a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",r:"raiseexp"},e_mage:{m:"move",a:"attack",s:"stop",n:"stand",l:"lightning",b:"createBat",f:"freeze",t:"createGolem",i:"invisibility"},r_mage:{m:"move",a:"attack",s:"stop",n:"stand",c:"spell_spawncarpet",j:"spell_spawnjin",r:"spell_firerain",v:"spell_magicvision",d:"raisedead"},a_mage:{m:"move",a:"attack",s:"stop",n:"stand",h:"spell_hypnotize",t:"spell_turntostone",w:"spell_whirlpool",f:"spell_flamebolt",d:"spell_spawndragon"},footman:{a:"attack",
g:"guard",r:"patrol",p:"pick_item",e:"explore",s:"stop",n:"stand"},a_monk:{a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",s:"stop",n:"stand"},a_monk_priest:{a:"attack",g:"guard",r:"become_priest",p:"pick_item",e:"explore",s:"stop",n:"stand"},e_spy:{a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",n:"stand",s:"stop"},ninja:{a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",s:"stop",n:"stand",c:"cloak",u:"murder"},ninja_cloaked:{a:"attack",g:"guard",r:"patrol",p:"pick_item",
e:"explore",s:"stop",n:"stand",k:"uncloak",u:"murder"},catapult:{a:"attack",g:"guard",p:"patrol",e:"explore",s:"stop",n:"stand",r:"attack_ground",h:"hold_steady"},e_market:{c:"createCaravan"},r_market:{c:"createCaravan2"},a_market:{b:"market_items",s:"market_sell"},market_items:{},market_sell:{},e_workshop:{c:"createCatapult",h:"createHeavyCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"},r_workshop:{c:"createCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"},
a_workshop:{c:"createCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"},r_church:{p:"createPriest2"},e_church:{p:"createPriest"},a_church:{m:"createMonk",p:"createPriest1"},e_build:{c:"buildCastle",s:"buildStorage",b:"buildBarrack",k:"buildBlacksmith",f:"buildFarm",l:"buildLumber",p:"buildWorkshop",e:"buildCathedral",u:"buildChurch",n:"buildTavern",m:"buildMageTower",a:"buildStable",r:"buildHarbor",o:"buildOutpost",i:"buildFields",w:"buildWoodWall",d:"buildBridge",t:"buildTower",
h:"buildHouse",g:"buildGateWood",y:"buildDummy"},r_build:{c:"buildCastle2",k:"buildBlacksmith2",f:"buildFarm2",n:"buildTavern2",b:"buildBarrack2",p:"buildWorkshop2",s:"buildStorage2",a:"buildStable2",l:"buildLumber2",r:"buildHarbor2",o:"buildOutpost2",u:"buildChurch2",e:"buildMosque",i:"buildFields",m:"buildMageTower2",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse2",g:"buildGateWood"},r_magicworkshop:{i:"build_item"},a_build:{c:"buildCastle1",f:"buildFarm1",e:"buildShaolinn",n:"buildTavern1",
b:"buildBarrack1",p:"buildWorkshop1",s:"buildStorage1",k:"buildBlacksmith1",a:"buildStable1",l:"buildLumber1",r:"buildHarbor1",o:"buildOutpost1",u:"buildChurch1",i:"buildFields",m:"buildMageTower1",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse1",g:"buildGateWood"},e_lumber:{b:"techLongbow",w:"techWoodCutting",c:"techCrossbow"},r_lumber:{w:"techWoodCutting",c:"techCrossbow"},a_lumber:{w:"techWoodCutting",c:"techCrossbow"},e_blacksmith:{p:"techPlateArmor",t:"techTemperIron",s:"techScaleArmor",
h:"techHalberd",c:"techChainMail"},r_blacksmith:{t:"techTemperIron",a:"techScaleArmor",s:"techScimitar",c:"techChainMail",h:"techHalberd"},a_blacksmith:{t:"techTemperIron",a:"techScaleArmor",r:"techArmoredChariot",c:"techChainMail"},e_outpost:{e:"emergeAllUnits"},menu_stop:{s:"stop"},tower_wood:{a:"attack",s:"stop",g:"upgradeGuildTower"},tower_wood2:{a:"attack",s:"stop",g:"upgradeStoneTower",c:"upgradeCannonTower"},tower_stone:{a:"attack",s:"stop",c:"upgradeCannonTower"},tower_stone2:{a:"attack",
r:"attack_ground",s:"stop",h:"holdfire"},tower_stone3:{a:"attack",r:"attack_ground",s:"stop",f:"fireatwill"},ownership:{h:"view_heroes",s:"view_spys",i:"view_items",q:"view_quests"},gate_wood_00:{o:"gateclose",n:"gate_subai_on",s:"to_sgate"},gate_wood_01:{o:"gateclose",f:"gate_subai_off",s:"to_sgate"},gate_wood_10:{c:"gateopen",n:"gate_subai_on",s:"to_sgate"},gate_wood_11:{c:"gateopen",f:"gate_subai_off",s:"to_sgate"},gate_stone_00:{o:"gateclose",n:"gate_subai_on"},gate_stone_01:{o:"gateclose",f:"gate_subai_off"},
gate_stone_10:{c:"gateopen",n:"gate_subai_on"},gate_stone_11:{c:"gateopen",f:"gate_subai_off"},e_harbor:{f:"createFishingBoat",x:"createXebec",h:"createHulk",g:"createGalleon",t:"te_landingtactics"},r_harbor:{f:"createFishingBoat",h:"createHulk",x:"createXebec",t:"te_landingtactics"},a_harbor:{f:"createFishingBoat",h:"createHulk",x:"createXebec"},e_boat:{m:"move",e:"explore",s:"stop",n:"stand",f:"fishing"},e_galleon:{m:"move",e:"explore",u:"unload",a:"attack",r:"attack_ground",s:"stop",n:"stand",
h:"hold_steady",t:"trade_ship",l:"to_ship_level2"},e_galleon2:{m:"move",e:"explore",u:"unload",a:"attack",r:"attack_ground",s:"stop",n:"stand",h:"hold_steady",t:"trade_ship",l:"to_ship_level3"},e_galleon3:{m:"move",e:"explore",u:"unload",a:"attack",r:"attack_ground",s:"stop",n:"stand",h:"hold_steady",t:"trade_ship",l:"to_ship_level4"},e_galleon4:{m:"move",e:"explore",u:"unload",a:"attack",r:"attack_ground",s:"stop",n:"stand",h:"hold_steady",t:"trade_ship",l:"to_ship_level5"},e_galleon5:{m:"move",
e:"explore",u:"unload",a:"attack",r:"attack_ground",s:"stop",n:"stand",h:"hold_steady",t:"trade_ship",l:"to_ship_level6"},e_galleon6:{m:"move",e:"explore",u:"unload",a:"attack",r:"attack_ground",s:"stop",n:"stand",h:"hold_steady",t:"trade_ship"},e_carpet:{m:"move",u:"unload",a:"attack",e:"explore",s:"stop",n:"stand"},e_trader:{m:"move",t:"trade",e:"explore",s:"stop",n:"stand",u:"unload"},e_farm:{c:"createCow",f:"techCropRotation",d:"techDomestication"},r_farm:{c:"createCow",f:"techDomestication",
d:"techDomestication",p:"te_cowpoaching",r:"te_artofriding",h:"te_horsemanship"},a_farm:{f:"techDomestication",a:"te_artofriding",i:"te_irrigation"},e_storage:{g:"techGoldMining",s:"techStoneMining"},r_storage:{g:"techGoldMining",s:"techStoneMining"},a_storage:{g:"techGoldMining",s:"techStoneMining"},spy_add:{i:"impersonate",v:"reveal_self"},cathedral:{c:"createCrusaders"},magic_gateway:{o:"createOrk",d:"createDwarf",g:"createGhost",s:"createSkeleton"},crusade_anchor:{s:"select_crusaders"}};(function(){for(var a=
Object.keys(df),b=0;b<a.length;b++)for(var e=df[a[b]],c=Object.keys(e),d=0;d<c.length;d++)e[e[c[d]]]=c[d]})();var Eb={};B("selectUnits").onclick=function(){B("mapeditorinfoUnits").style.display="block";B("mapeditorinfoBuilds").style.display="none";B("mapeditorinfoItems").style.display="none";B("mapeditorinfoNature").style.display="none"};B("selectBuilds").onclick=function(){B("mapeditorinfoUnits").style.display="none";B("mapeditorinfoBuilds").style.display="block";B("mapeditorinfoItems").style.display=
"none";B("mapeditorinfoNature").style.display="none"};B("selectItems").onclick=function(){B("mapeditorinfoUnits").style.display="none";B("mapeditorinfoBuilds").style.display="none";B("mapeditorinfoItems").style.display="block";B("mapeditorinfoNature").style.display="none"};B("selectNature").onclick=function(){B("mapeditorinfoUnits").style.display="none";B("mapeditorinfoBuilds").style.display="none";B("mapeditorinfoItems").style.display="none";B("mapeditorinfoNature").style.display="block"};Eb.size=
5;Eb.func=function(){G=[{color:[~~(256*Math.random()),~~(256*Math.random()),~~(256*Math.random())],ia:0,name:"IA",race:0,team:0}];u.editor=1;if(Qc(0,Eb.func)){B("statButton").style.display="none";B("menu").style.display="none";B("resources").style.display="none";B("mapeditorinfotop").style.display="block";B("mapeditorinfo").style.display="block";var a=document.getElementById("mapeditorinfoUnits");a.style.display="block";if(!Eb.preload){Eb.preload=!0;var b={},e={},c=w,d={euro:La[0],arab:La[1],asia:La[2],
common:A.common};b[La[0]]=[];b[La[1]]=[];b[La[2]]=[];b[A.common]=[];e[La[0]]=[];e[La[1]]=[];e[La[2]]=[];e[A.common]=[];for(var h=0,g=c.length;h<g;h++){var k=c[h];!k.race||k.illegal||7==k.type||k.item||(k.build?e[d[k.race]].put(h):b[d[k.race]].put(h))}for(k=0;2>k;k++){c=Object.keys(b);var p={};h=0;for(g=c.length;h<g;p={ul$17:p.ul$17},h++){var m=document.createElement("h1");m.innerHTML=c[h];p.ul$17=document.createElement("ul");m.onclick=function(a){return function(){nh(a.ul$17)}}(p);p.ul$17.style.display=
"none";for(var n=b[c[h]],q=Object.keys(n),r={},v=0,x=q.length;v<x;r={tcreate:r.tcreate},v++)d=document.createElement("li"),d.innerHTML=w[n[q[v]]].name,r.tcreate=n[q[v]],d.onclick=function(a){return function(){var b=a.tcreate;w[b].wall?gg(b):I(b)}}(r),p.ul$17.appendChild(d);a.appendChild(m);a.appendChild(p.ul$17)}b=e;a=B("mapeditorinfoBuilds")}c=Object.keys(Kb);a=B("mapeditorinfoItems");ul=document.createElement("ul");b={};h=0;for(g=c.length;h<g;b={u$18:b.u$18},h++)d=document.createElement("li"),b.u$18=
Kb[c[h]],d.onclick=function(a){return function(){oh(a.u$18)}}(b),d.innerHTML=b.u$18.name,ul.appendChild(d);a.appendChild(ul);a=B("mapeditorinfoNature");m=document.createElement("h1");m.innerHTML=A.trees;ul=document.createElement("ul");m.onclick=function(){nh(ul)};ul.style.display="none";d=document.createElement("li");ul.appendChild(d);a.appendChild(m);a.appendChild(ul);d.onclick=function(){qj(Yg)};d.innerHTML=A.delete;d=document.createElement("li");ul.appendChild(d);d.onclick=function(){qj(Zg)};d.innerHTML=
A.create}}};var Hg,qj=function(a){Hg=!0;L=function(){};var b=da;b.img=k.blank;var e=32*Eb;b.wh=[e,e];Sa(b);b.active=!0;document.addEventListener("mousemove",Fb);document.addEventListener("mouseup",rj);document.addEventListener("mousedown",a)},Zg=function(a,b,e){if(b){a=2*Eb.size;for(var c=a*a,d=x,f=0;f<c;f++){var g=b+f%a,k=e+~~(f/a);qa(g,k)&&(0===R[g+k*d]?.8<Math.random()&&Sc([g+k*d,7,{d:3+~~(28*Math.random())}]):(g=y[R[g+k*d]],7==g.type&&g.die()))}}else document.removeEventListener("mousedown",Zg),
Fb.active=Zg},Yg=function(a,b,e){if(b){a=2*Eb.size;for(var c=a*a,d=x,f=0;f<c;f++){var g=b+f%a,k=e+~~(f/a);qa(g,k)&&(g=y[R[g+k*d]],7==g.type&&g.die())}}else document.removeEventListener("mousedown",Yg),Fb.active=Yg},Fb=function(a){var b=32*Eb.size;b=Lb(a.pageX-z.mx-.5*b/ba,a.pageY-.5*b/ba);var e=~~(.03125*b[1]);b=~~(.03125*b[0]);da.x=32*b;da.y=32*e;da.active=!0;Fb.last!==b+e*x&&Fb.active&&Fb.active(a,b,e);Fb.last=b+e*x},rj=function(){da.active=!0;da.x=-9999;da.y=-9999;Hg=!1;if(Fb.active){var a=32*
Eb.size;a=Lb(event.pageX-z.mx-.5*a/ba,event.pageY-.5*a/ba);var b=~~(.03125*a[1]);a=~~(.03125*a[0]);Fb.active(event,a,b);Fb.active=!1}document.removeEventListener("mousemove",Fb);document.removeEventListener("mouseup",rj)};Jd.onchange=function(a){ca(ng,parseInt(Jd.value)/100,H)};B("mapload").onchange=function(){var a=document.getElementById("mapload").files[0],b=new FileReader;b.onloadend=function(a){a=a.target.result;B("customMapcont").style.display="block";Ca=JSON.parse(a);Ca.record?(B("seeStats").style.display=
"inline-table",B("playrecord").style.display="inline-table"):(B("seeStats").style.display="none",B("playrecord").style.display="none");G=Ca.playersList;null===Ca.goldRes&&(Ca.goldRes=Infinity);null===Ca.stoneRes&&(Ca.stoneRes=Infinity);null===Ca.foodRes&&(Ca.foodRes=Infinity);null===Ca.woodRes&&(Ca.woodRes=Infinity);a=document.getElementById("custombody");a.innerHTML="";for(var b=0,d=G.length;b<d;b++){var e=G[b],f=e.color;a.innerHTML+="<tr><td style='background:rgb("+f[0]+","+f[1]+","+f[2]+')\' class="ucolor1"></td><td class="username1">'+
e.name+'</td><td class="race1">'+e.race+'</td><td class="team1">'+e.team+"</td></tr>"}};a&&b.readAsText(a)};var Ca,Uk=function(a){var b={Blue:189,Red:13506841,Green:3257600,Purple:11337925,Yellow:16768512,Cyan:46517,Orange:16751649,Gray:5921370},e=a.split(["[Player"]),c=a.split("GameDuration =")[1].split("[")[0].split(" min")[0].split(" ")[1],d=[];a=[];for(var f=1,g=e.length;f<g;f++){var k=e[f].split("\n"),p={};d[f-1]=p;for(var m=0,n=k.length;m<n;m++){var q=k[m];q=q.split(" = ");if(q[1]&&m){q[1]=
q[1].trim();"Color"==q[0]&&(q[1]=b[q[1]]);"Type"==r&&"Status"!==q[0]&&a.put("N");q[1]=encodeURIComponent(q[1]);a.put(q[1]);p[q[0]]=q[1];var r=q[0]}}}b=d[0].Name+"'s Game";var u=new XMLHttpRequest;u.open("POST","http://127.0.0.1/php/stats.php",!0);u.setRequestHeader("Content-type","application/x-www-form-urlencoded");u.onreadystatechange=function(){200===u.status&&4===u.readyState&&(location.hash="MatchX"+u.responseText)};a=a.join("<");u.send("arr="+a+"&time="+6E4*c+"&name="+b+"&players="+d.length)},
$g=function(a,b){for(var e=0,c=0,d=a.length;c<d;c++)e+=b[a[c]];return e},ah=function(a,b,e){var c=["",e];performance.now();for(var d=1,f=a.length-1;d<f;d++){var g=a[d],k=g.stats,p=k.resources,m=k.unitCountMax,n=24*(d-1)+2,q=g.color,r=g.IA;r=r?"IA":"Human";c[n]=(q[0]<<16)+(q[1]<<8)+q[2];c[n+1]=g.name;c[n+1]=g.name;c[n+2]=r;c[n+3]=g.status;c[n+4]=g.team;c[n+5]=La[g.race];c[n+6]=k.score;c[n+7]=p[0];c[n+8]=p[1];c[n+9]=p[2];c[n+10]=p[3];c[n+11]=k.dmgInflicted;c[n+12]=k.dmgTaken;c[n+13]=k.unitsKilled;c[n+
14]=k.unitsLosed;c[n+15]=k.buildsDestroyed;c[n+16]=k.buildsLosed;c[n+17]=$g([10,79,64],m);c[n+18]=$g([32,44],m);c[n+19]=$g([55,56],m);c[n+20]=0;c[n+21]=0;c[n+22]=0;c[n+23]=0}sj(c,b);b&&setTimeout(function(){"block"==B("ingameStats").style.display&&ah(a,b,e)},500)},sj=function(a,b){for(var e="<tr style='background:#000;'><td style='    padding-right: 150px;'>Name</td><td>Type</td><td>Status</td><td>Team</td><td>Race</td><td>Score</td><td>Gold</td><td>Wood</td><td>Food</td><td>Stone</td><td title='Damage Inflicted'>D.I</td><td title='Damage Taken'>D.T</td><td title='Units Killed'>U.K</td><td title='Units Losed'>U.L</td><td title='Buildings Destroyed'>B.D</td><td title='Buildings Losed'>B.L</td><td title='Maximum Peasants'>M.P</td><td title='Maximum Towers'>M.T</td><td title='Maximum Stone Towers'>M.S.T</td><td title='Gold Traded'>G.T</td><td title='Stone Traded'>S.T</td><td title='Gold Converted'>G.C</td><td title='Stone Converted'>S.C</td></tr>",
c=2,d=a.length;c<d;c++)if((c-2)%24)0!==(c-3)%24&&(f=~~((c-2)/24)%2?"style = 'background:rgba(0,0,0,0.45)'":"style = 'background:rgba(0,0,0,0.65)'"),e+="<td "+f+">"+Rb(decodeURIComponent(a[c]))+"</td>";else{c-2&&(e+="</tr>");f=parseInt(Rb(decodeURIComponent(a[c])));var f="style = 'background:rgba("+Math.floor(f/65536)+","+Math.floor(f/256)%256+","+f%256+",0.45)'";e+="<tr>"}e+="</tr>";b?(B("ingameStats").style.display="block",B("statsGame").innerHTML="<tbody>"+e+"</tbody>",b=B("statsGame").getElementsByTagName("td")):
(B("MatchX").style.display="block",B("returnmenu").style.display="block",B("statsTable").innerHTML="<tbody>"+e+"</tbody>",b=B("statsTable").getElementsByTagName("td"));a=[];c=0;for(d=b.length;c<d;c++)e=c%23,4<e&&23<c&&(a[e-5]||(a[e-5]=[]),a[e-5].put(b[c]));c=0;for(d=a.length;c<d;c++){b=a[c];b.sort(Cj);e=b.length;if(!b[1])break;b[0].innerHTML!=b[1].innerHTML&&(b[0].style.background="rgba(127,0,0,0.45)");b[e-1].innerHTML!=b[e-2].innerHTML&&(b[e-1].style.background="rgba(0,127,0,0.45)")}};B("statsLoad").onchange=
function(){var a=document.getElementById("statsLoad").files[0],b=new FileReader;b.onloadend=function(a){Uk(a.target.result)};a&&b.readAsText(a,"ascii")};var Bj=function(a){var b=new XMLHttpRequest;b.open("POST","http://127.0.0.1/php/loadstat.php",!0);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");tj(b,function(a){sj(a.responseText.split("<"))});M(a);b.send("id="+a)},tj=function(a,b){a.onreadystatechange=function(){4===a.readyState&&(200===a.status?b(a):alert("Error: "+a.status))}};
B("deleteUnit").onclick=function(){ca(Id,1,H.slice(0))};B("rotatebutton").onclick=function(){for(var a=H,b=0,e=a.length;b<e;b++){var c=y[a[b]];c.build||(c.d=(c.d+1)%8,ObjectsetupIMG(c,c.img))}};B("gameMenu").onclick=Gf;B("menueditor").onclick=Gf;B("quitButton1").onclick=function(){Hf("playingMenu");u.online&&Ng();G.length=0;H=[];Pa=void 0;clearInterval(ee);K=[];Kg=8;u={canceled:!0};G.length=0;y=[{terrain:1},{terrain:1},{terrain:1}];uc={};sc={};Mb={};eb.length=0;Va=z.kingdom=void 0;vi={euro:0,arab:0,
asia:0};Ga.stop();$b=document.getElementById("msgs");pf=document.getElementById("msginput");window.removeEventListener("mousemove",sb);window.removeEventListener("keydown",Hi);window.removeEventListener("keyup",Ii);window.removeEventListener("mousemove",Ji);window.removeEventListener("mousedown",Ki);window.removeEventListener("mouseup",Li);Bc();document.getElementById("playermenu").style.display="block";document.getElementById("playingMenu").style.display="none"};B("backToGame").onclick=Gf;B("backToGameS").onclick=
function(){Hf("ingameStats")};B("statButton").onclick=function(){ah(K,!0,u.now())};B("returnmenu1").onclick=Bc;B("returnmenu").onclick=Bc;B("refreshButton1").onclick=Lf;B("sendmsg").onclick=Ag;B("start1").onclick=Ug;B("start2").onclick=Qc;B("saveGame").onclick=function(){var a=document.createElement("a");document.body.appendChild(a);a.style="display: none";var b=u,e=y,c=[];c.length=e.length-3;for(var d=3,h=e.length;d<h;d++){var g=e[d],k=w[g.type],p={kingdom:g.kingdom,d:g.d,type:g.type,img:g.img,x32:g.x32,
y32:g.y32};g.name!==k.name&&(p.name=g.name);g.iconID!==k.iconID&&(p.iconID=g.iconID);g.attack!==k.attack&&(p.attack=g.attack);g.defence!==k.defence&&(p.defence=g.defence);g.level!==k.level&&(p.level=g.level);g.health!==k.health&&(p.health=g.health);g.maxHealth!==k.maxHealth&&(p.maxHealth=g.maxHealth);g.func&&(p.func=g.func);g.funcObj&&(p.funcObj=g.funcObj);g.workers&&g.workers.length&&(p.workers=g.workers);g.workingOn&&(p.workingOn=g.workingOn);g.inventory&&g.inventory.length&&(p.inventory=g.inventory);
g.dix&&(p.dix=g.dix);g.diy&&(p.diy=g.diy);g.timestamp&&(p.timestamp=g.timestamp);g.working&&(p.working=g.working);g.rnd&&(p.rnd=g.rnd);g.techID&&(p.techID=g.techID);g.techStart&&(p.techStart=g.techStart);g.activeTech&&(p.activeTech=g.activeTech);g.levelProgress&&(p.levelProgress=g.levelProgress);g.c&&(p.c=g.c);g.mimg&&(p.mimg=g.mimg);void 0!==g.built&&(p.built=g.built);void 0!==g.xf&&(p.xf=g.xf);void 0!==g.yf&&(p.yf=g.yf);void 0!==g.action&&(p.action=g.action);g.point&&(p.point=g.point);g.waitlist&&
(p.waitlist=g.waitlist);g.mv&&(p.mv=g.mv);g.work&&(p.work=g.work);g.death&&(p.death=g.death);g.freezed&&(p.freezed=g.freezed);g.sword&&(p.sword=g.sword);g.shield&&(p.shield=g.shield);g.book&&(p.book=g.book);c[d-3]=p}b.allunits=c;u.movtable=sc;u.movtable2=uc;u.playersList=G;u.terrain=Array.prototype.slice.call(bd);b=JSON.stringify(u);b=new Blob([b],{type:"application/json"});b=URL.createObjectURL(b);a.href=b;a.download="savegame.tzared";a.click();u.allunits=void 0};B("closeButton1").onclick=Ug;B("createGame1").onclick=
ij;B("copyButton").onclick=function(){document.getElementById("onlineID").select();document.execCommand("Copy")};B("startCustom").onclick=function(){u=Object.assign({},Ca);u.editor=!1;u.custom=!0;Ca=void 0;Qc(!1,!1,!0)};B("playrecord").onclick=function(){u=Object.assign({},Ca);u.custom=!0;u.demo=!0;u.cycle=0;u.editor=!1;Ca=void 0;Qc(!1,!1,!0)};B("seeStats").onclick=function(){ah(Ca.kingdoms,!1,25*Ca.cycle);location.hash="MatchX"};var kh={MatchHistory:function(){document.getElementById("returnmenu").style.display=
"block";var a=new XMLHttpRequest;a.open("GET","http://127.0.0.1/php/latest.php",!0);tj(a,function(a){a=a.responseText.split("|");for(var b=a.length-1,c="",d=0;d<b;d+=5)c+="<tr id='statList"+Rb(decodeURIComponent(a[d]))+"'><td>"+Rb(decodeURIComponent(a[d+1]))+"</td><td>"+Rb(decodeURIComponent(a[d+2]))+"</td><td>"+Rb(decodeURIComponent(a[d+3]))+"</td><td>"+parseInt(Rb(decodeURIComponent(a[d+4])))/6E4+" min</td></tr>";document.getElementById("matchtable").innerHTML="<tbody>"+c+"</tbody>";c={};for(d=
0;d<b;c={l:c.l},d+=5)c.l=Rb(decodeURIComponent(a[d])),B("statList"+c.l).onclick=function(a){return function(){location.hash="MatchX"+a.l}}(c)});a.send(null)},GameList:Lf,RandomMap:ac,Twitter:function(){document.getElementById("returnmenu").style.display="block"},Account:function(){dd.returnmenu.style.display="block";""==dd.Account.innerHTML&&(dd.Account.innerHTML='<iframe id="accountIframe"></iframe>',dd.accountIframe=document.getElementById("accountIframe"));dd.accountIframe.src="http://127.0.0.1/"+
z.langCodeUrl+"account/?iframe=1"},MapEditor:Eb.func,CustomMap:function(){document.getElementById("returnmenu").style.display="block"}};ih();(function(a,b,e,c){var d=document.createElement("div");d.className="confirmDiv";d.innerHTML="\n<h2>"+a+"</h2>\n<p>"+b+"</p>";a=document.createElement("button");a.innerHTML=A.yes;b=document.createElement("button");b.innerHTML=A.no;a.onclick=function(){e();d.parentNode.removeChild(d)};b.onclick=function(){d.parentNode.removeChild(d)};d.appendChild(a);d.appendChild(b);
c&&(d.id=c);document.body.appendChild(d)})("The graphics aren't in cache","Do you want to download them now?",Cf,"qdgraphics");var tc=[Gg,Ge,zc,xc,Ed,ve,Pe,Ie,ze,xe,Fe,Re,Ke,hi,Te,Be,De,Me,Gd,fe,Qd,Bh,ge,Vf,Ah,gi,re,li,ni,Xc,ug,oi,pi,qi,ri,re,$i,bi,si,sd,ci,eg,Zh,$h,lg,ai,wd,Yb,kg,yc,xc,zd,zc,rc,Bd,Wc,P,function(a){var b=a[1],e=y[a[2]];a=F[a[0]];K[e.kingdom].technology.hidden[a.id.id]=0;Xb(e,a,b);ka.actv[a.id.id]&&aa(!1)},ud,oe,Oa,Sh,kb,pe,ig,qd,Eg,zi,ki];(function(){for(var a=0,b=tc.length;a<b;a++)tc[a].url=
a})()})();
