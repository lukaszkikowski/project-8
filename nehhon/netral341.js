var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(w,M,ja){w!=Array.prototype&&w!=Object.prototype&&(w[M]=ja.value)};$jscomp.getGlobal=function(w){return"undefined"!=typeof window&&window===w?w:"undefined"!=typeof global&&null!=global?global:w};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var w=0;return function(M){return $jscomp.SYMBOL_PREFIX+(M||"")+w++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var w=$jscomp.global.Symbol.iterator;w||(w=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[w]&&$jscomp.defineProperty(Array.prototype,w,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(w){var M=0;return $jscomp.iteratorPrototype(function(){return M<w.length?{done:!1,value:w[M++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(w){$jscomp.initSymbolIterator();w={next:w};w[$jscomp.global.Symbol.iterator]=function(){return this};return w};$jscomp.iteratorFromArray=function(w,M){$jscomp.initSymbolIterator();w instanceof String&&(w+="");var ja=0,C={next:function(){if(ja<w.length){var S=ja++;return{value:M(S,w[S]),done:!1}}C.next=function(){return{done:!0,value:void 0}};return C.next()}};C[Symbol.iterator]=function(){return C};return C};
$jscomp.polyfill=function(w,M,ja,C){if(M){ja=$jscomp.global;w=w.split(".");for(C=0;C<w.length-1;C++){var S=w[C];S in ja||(ja[S]={});ja=ja[S]}w=w[w.length-1];C=ja[w];M=M(C);M!=C&&null!=M&&$jscomp.defineProperty(ja,w,{configurable:!0,writable:!0,value:M})}};$jscomp.polyfill("Array.prototype.keys",function(w){return w?w:function(){return $jscomp.iteratorFromArray(this,function(w){return w})}},"es6","es3");
$jscomp.polyfill("Object.getOwnPropertySymbols",function(w){return w?w:function(){return[]}},"es6","es5");$jscomp.findInternal=function(w,M,ja){w instanceof String&&(w=String(w));for(var C=w.length,S=0;S<C;S++){var xa=w[S];if(M.call(ja,xa,S,w))return{i:S,v:xa}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(w){return w?w:function(w,ja){return $jscomp.findInternal(this,w,ja).v}},"es6","es3");$jscomp.owns=function(w,M){return Object.prototype.hasOwnProperty.call(w,M)};
$jscomp.polyfill("Object.assign",function(w){return w?w:function(w,ja){for(var C=1;C<arguments.length;C++){var M=arguments[C];if(M)for(var xa in M)$jscomp.owns(M,xa)&&(w[xa]=M[xa])}return w}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(w){return w?w:function(){return $jscomp.iteratorFromArray(this,function(w,ja){return ja})}},"es8","es3");$jscomp.polyfill("Math.sign",function(w){return w?w:function(w){w=Number(w);return 0===w||isNaN(w)?w:0<w?1:-1}},"es6","es3");
$jscomp.polyfill("Number.isFinite",function(w){return w?w:function(w){return"number"!==typeof w?!1:!isNaN(w)&&Infinity!==w&&-Infinity!==w}},"es6","es3");$jscomp.polyfill("Number.isInteger",function(w){return w?w:function(w){return Number.isFinite(w)?w===Math.floor(w):!1}},"es6","es3");$jscomp.makeIterator=function(w){$jscomp.initSymbolIterator();var M=w[Symbol.iterator];return M?M.call(w):$jscomp.arrayIterator(w)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(w){function M(){this.batch_=null}function ja(w){return w instanceof S?w:new S(function(C,Ab){C(w)})}if(w&&!$jscomp.FORCE_POLYFILL_PROMISE)return w;M.prototype.asyncExecute=function(w){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(w);return this};M.prototype.asyncExecuteBatch_=function(){var w=this;this.asyncExecuteFunction(function(){w.executeBatch_()})};var C=$jscomp.global.setTimeout;M.prototype.asyncExecuteFunction=function(w){C(w,
0)};M.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var w=this.batch_;this.batch_=[];for(var C=0;C<w.length;++C){var S=w[C];delete w[C];try{S()}catch(Gb){this.asyncThrow_(Gb)}}}this.batch_=null};M.prototype.asyncThrow_=function(w){this.asyncExecuteFunction(function(){throw w;})};var S=function(w){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var C=this.createResolveAndReject_();try{w(C.resolve,C.reject)}catch(Qc){C.reject(Qc)}};S.prototype.createResolveAndReject_=
function(){function w(w){return function(Ab){S||(S=!0,w.call(C,Ab))}}var C=this,S=!1;return{resolve:w(this.resolveTo_),reject:w(this.reject_)}};S.prototype.resolveTo_=function(w){if(w===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(w instanceof S)this.settleSameAsPromise_(w);else{a:switch(typeof w){case "object":var C=null!=w;break a;case "function":C=!0;break a;default:C=!1}C?this.resolveToNonPromiseObj_(w):this.fulfill_(w)}};S.prototype.resolveToNonPromiseObj_=function(w){var C=
void 0;try{C=w.then}catch(Qc){this.reject_(Qc);return}"function"==typeof C?this.settleSameAsThenable_(C,w):this.fulfill_(w)};S.prototype.reject_=function(w){this.settle_(2,w)};S.prototype.fulfill_=function(w){this.settle_(1,w)};S.prototype.settle_=function(w,C){if(0!=this.state_)throw Error("Cannot settle("+w+", "+C|"): Promise already settled in state"+this.state_);this.state_=w;this.result_=C;this.executeOnSettledCallbacks_()};S.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var w=
this.onSettledCallbacks_,C=0;C<w.length;++C)w[C].call(),w[C]=null;this.onSettledCallbacks_=null}};var xa=new M;S.prototype.settleSameAsPromise_=function(w){var C=this.createResolveAndReject_();w.callWhenSettled_(C.resolve,C.reject)};S.prototype.settleSameAsThenable_=function(w,C){var S=this.createResolveAndReject_();try{w.call(C,S.resolve,S.reject)}catch(Gb){S.reject(Gb)}};S.prototype.then=function(w,C){function M(w,C){return"function"==typeof w?function(C){try{ja(w(C))}catch(te){Ab(te)}}:C}var ja,
Ab,xa=new S(function(w,C){ja=w;Ab=C});this.callWhenSettled_(M(w,ja),M(C,Ab));return xa};S.prototype.catch=function(w){return this.then(void 0,w)};S.prototype.callWhenSettled_=function(w,C){function S(){switch(M.state_){case 1:w(M.result_);break;case 2:C(M.result_);break;default:throw Error("Unexpected state: "+M.state_);}}var M=this;null==this.onSettledCallbacks_?xa.asyncExecute(S):this.onSettledCallbacks_.push(function(){xa.asyncExecute(S)})};S.resolve=ja;S.reject=function(w){return new S(function(C,
S){S(w)})};S.race=function(w){return new S(function(C,S){for(var M=$jscomp.makeIterator(w),xa=M.next();!xa.done;xa=M.next())ja(xa.value).callWhenSettled_(C,S)})};S.all=function(w){var C=$jscomp.makeIterator(w),M=C.next();return M.done?ja([]):new S(function(w,S){function xa(C){return function(S){Ab[C]=S;Gb--;0==Gb&&w(Ab)}}var Ab=[],Gb=0;do Ab.push(void 0),Gb++,ja(M.value).callWhenSettled_(xa(Ab.length-1),S),M=C.next();while(!M.done)})};return S},"es6","es3");
(function(){function w(f,c,e){this.context=f;this.urlList=c;this.onload=e;this.loadCount=0}function M(f,c,e){c=c.split(".")[0].toLowerCase();ue[c]=f;!e||e.music&&e.mid!=Da.id||(pa(c,e.x,e.y,e.k,e.music,e.date),e.date=0)}function ja(f,c){var e=H,d;for(d=2;60>=d;d+=2){f--;c--;for(var b=0;b<=d;){if(2<Y[f+b+e*c]&&1==A[Y[f+b+e*c]].res&&fa(f+b,c))return Y[f+b+e*c];if(2<Y[f+b+e*(c+d)]&&1==A[Y[f+b+e*(c+d)]].res&&fa(f+b,c+d))return Y[f+b+e*(c+d)];b++}for(b=0;b<d-1;){b++;if(2<Y[f+e*(c+b)]&&1==A[Y[f+e*(c+b)]].res&&
fa(f,c+b))return Y[f+e*(c+b)];if(2<Y[f+d+e*(c+b)]&&1==A[Y[f+d+e*(c+b)]].res&&fa(f+d,c+b))return Y[f+d+e*(c+b)]}}return!1}function C(f,c){if(!Rc(f)){var e=f.x32,d=f.y32,b=f.sight;f.build&&(b=f.attDist);var h=H,q=2*b+1,l=q*q,p=f.id,F={};f.callList||(f.callList=[]);for(var B=0;B<l;B++){var K=B%q-b,T=~~(B/q)-b;if(Math.sqrt(Math.pow(K,2)+Math.pow(T,2))<=b){K+=e;T+=d;var ha=K+T*h;fa(K,T)&&(uc[ha]?(K=A[uc[ha]],F[K.id]||c||(K.callList||G(K),K.callList.put(f.id),K.callList.put(f.x32+f.y32*h),F[K.id]=1)):uc[ha]=
p)}}}}function S(){for(var f=0,c=Oa.length;f<c;Oa[f++].className="");}function xa(){if(""==r("playingMenu").innerHTML){r("playingMenu").innerHTML='<div>\n<ul>\n<li id="backToGame">'+t.backToGame+'</li>\n<li style="display:none" id="saveGameCache">'+t.save+' (cache)</li>\n<li id="saveGame">'+t.downloadmap+'</li>\n<li id="fullscreenmenu">'+t.fullscreen2+'</li>\n<li id="quitButton1">'+t.quit+"</li>\n</ul>\n<div>\n<span>"+t.musicVolume+'</span><br/><input type="range" id="musicRange" value="'+localStorage.musicRange+
'"/><br/><br/>\n<form id="musicSelect">\n<input type="radio" name="mversion" value="originalMusic" checked /> Original<br/>\n<input type="radio" name="mversion" value="sharpRain" /> Original - <a href="https://www.youtube.com/user/rainheart666787/featured" target="_blank" rel="noopener noreferrer">Sharp Rain</a> Version<br/>\n<input type="radio" name="mversion" value="originalMusic1" /> Original - Alternative One<br/>\n<input type="radio" name="mversion" value="mute" /> Mute\n</form>\n<br />\n<span>'+
t.soundVolume+'</span><br/><input type="range" id="soundRange" value="'+localStorage.soundRange+'"/><br/>\n</div>\n</div>\n';r("quitButton1").onclick=Ab;r("saveGame").onclick=gi;r("saveGameCache").onclick=Hl;r("backToGame").onclick=function(){V("playingMenu");gb()};r("fullscreenmenu").onclick=hi;r("musicRange").oninput=function(){td.gain.value=parseInt(r("musicRange").value)/100;localStorage.musicRange=r("musicRange").value};r("soundRange").oninput=function(){ud.gain.value=parseInt(r("soundRange").value)/
100;localStorage.soundRange=r("soundRange").value};localStorage.favMusic&&(r("musicSelect").mversion.value=localStorage.favMusic);for(var f=r("musicSelect").getElementsByTagName("input"),c=0,e=f.length;c<e;c++)f[c].onchange=Da.reset}v.demo&&V("saveGame")||la("saveGame");r("playingMenu").style.display="block";vc()}function Ab(){location.href=""}function Fl(f){G("setup:",f);f.toSend=[];f.orderList=[];var c=Ea.roomName;c=c.substr(0,c.length-1);f.id==c&&(f.admin=!0);f.superID=ii(f.id);f.sendDirectly("channelMessage",
"nehhof",{});G(f.channels.channelMessage);f.channels.channelMessage.onopen=function(){$a.put(f);pa("attack");og(1);G("DATACHANNEL OPEN");setTimeout(function(){G(f);y.admin?(Sc(x.onlADD(0,0,parseInt(y.color.substr(1),16),f.superID,0),17,"..."),x.onlineKingdoms(),Tc()):f.admin&&(Sc(x.mnameadd(),17,y.name),x.shareName(f.superID))},500)};f.channels.channelMessage.onerror=function(f){G(f)}}function Qc(){r("buttons").innerHTML="";r("gameName").innerHTML=""}function Gb(){y.p2p?(gb(),y.p2p.emit("getRooms"),
r("returnmenu").style.display="block"):(Ea||Lb(),Lb.func=Gb)}function ei(){var f=location,c=f.hash.substr(1);""==c&&(r("returnmenu").style.display="none");if("MatchX"==c.substr(0,6))6<c.length&&Il(c.substr(6-c.length));else if("Room"==f.hash.substr(-4))pg?ji():ve=ji;else if(qg[c])if(pg)qg[c]();else ve=qg[c];else f.hash=""}function ng(f){f.style.display="none"==f.style.display?"block":"none"}function Gl(f){return n.locateFile?n.locateFile(f,Mb):Mb+f}function mg(f,c){f||Pa("Assertion failed: "+c)}function fi(f,
c,e){var d=c+e;for(e=c;f[e]&&!(e>=d);)++e;if(16<e-c&&f.subarray&&ki)return ki.decode(f.subarray(c,e));for(d="";c<e;){var b=f[c++];if(b&128){var h=f[c++]&63;if(192==(b&224))d+=String.fromCharCode((b&31)<<6|h);else{var q=f[c++]&63;b=224==(b&240)?(b&15)<<12|h<<6|q:(b&7)<<18|h<<12|q<<6|f[c++]&63;65536>b?d+=String.fromCharCode(b):(b-=65536,d+=String.fromCharCode(55296|b>>10,56320|b&1023))}}else d+=String.fromCharCode(b)}return d}function te(f){for(var c=0,e=0;e<f.length;++e){var d=f.charCodeAt(e);55296<=
d&&57343>=d&&(d=65536+((d&1023)<<10)|f.charCodeAt(++e)&1023);127>=d?++c:c=2047>=d?c+2:65535>=d?c+3:c+4}var b=c+1;c=li(b);e=mi;d=c;if(0<b){b=d+b-1;for(var h=0;h<f.length;++h){var q=f.charCodeAt(h);if(55296<=q&&57343>=q){var l=f.charCodeAt(++h);q=65536+((q&1023)<<10)|l&1023}if(127>=q){if(d>=b)break;e[d++]=q}else{if(2047>=q){if(d+1>=b)break;e[d++]=192|q>>6}else{if(65535>=q){if(d+2>=b)break;e[d++]=224|q>>12}else{if(d+3>=b)break;e[d++]=240|q>>18;e[d++]=128|q>>12&63}e[d++]=128|q>>6&63}e[d++]=128|q&63}}e[d]=
0}return c}function rg(f,c){0<f%c&&(f+=c-f%c);return f}function ni(){n.HEAP8=mi=new Int8Array(Wa);n.HEAP16=new Int16Array(Wa);n.HEAP32=hb=new Int32Array(Wa);n.HEAPU8=Uc=new Uint8Array(Wa);n.HEAPU16=new Uint16Array(Wa);n.HEAPU32=oi=new Uint32Array(Wa);n.HEAPF32=new Float32Array(Wa);n.HEAPF64=new Float64Array(Wa)}function vd(f){for(;0<f.length;){var c=f.shift();if("function"==typeof c)c();else{var e=c.func;"number"===typeof e?void 0===c.arg?n.dynCall_v(e):n.dynCall_vi(e,c.arg):e(void 0===c.arg?null:
c.arg)}}}function pi(f){return String.prototype.startsWith?f.startsWith("data:application/octet-stream;base64,"):0===f.indexOf("data:application/octet-stream;base64,")}function qi(){try{if(n.wasmBinary)return new Uint8Array(n.wasmBinary);if(n.readBinary)return n.readBinary(ec);throw"both async and sync fetching of the wasm failed";}catch(f){Pa(f)}}function Jl(){return n.wasmBinary||!wd&&!wc||"function"!==typeof fetch?new Promise(function(f,c){f(qi())}):fetch(ec,{credentials:"same-origin"}).then(function(f){if(!f.ok)throw"failed to load wasm binary file at '"+
ec+"'";return f.arrayBuffer()}).catch(function(){return qi()})}function Kl(f){function c(f,c){n.asm=f.exports;xc--;n.monitorRunDependencies&&n.monitorRunDependencies(xc);0==xc&&(null!==sg&&(clearInterval(sg),sg=null),xd&&(f=xd,xd=null,f()))}function e(f){c(f.instance)}function d(f){Jl().then(function(f){return WebAssembly.instantiate(f,b)}).then(f,function(f){Nb("failed to asynchronously prepare wasm: "+f);Pa(f)})}var b={env:f,global:{NaN:NaN,Infinity:Infinity},"global.Math":Math,asm2wasm:Ll};xc++;
n.monitorRunDependencies&&n.monitorRunDependencies(xc);if(n.instantiateWasm)try{return n.instantiateWasm(b,c)}catch(h){return Nb("Module.instantiateWasm callback failed with error: "+h),!1}n.wasmBinary||"function"!==typeof WebAssembly.instantiateStreaming||pi(ec)||"function"!==typeof fetch?d(e):WebAssembly.instantiateStreaming(fetch(ec,{credentials:"same-origin"}),b).then(e,function(f){Nb("wasm streaming compile failed: "+f);Nb("falling back to ArrayBuffer instantiation");d(e)});return{}}function ri(){return!!ri.uncaught_exception}
function si(f){try{return Ml(f)}catch(c){}}function yd(){var f=ab.last;if(!f)return Vc=0;var c=ab.infos[f],e=c.type;if(!e)return Vc=0,f|0;var d=Array.prototype.slice.call(arguments);n.___cxa_is_pointer_type(e);yd.buffer||(yd.buffer=Nl(4));hb[yd.buffer>>2]=f;f=yd.buffer;for(var b=0;b<d.length;b++)if(d[b]&&n.___cxa_can_catch(d[b],e,f))return f=hb[f>>2],c.adjusted.push(f),Vc=d[b],f|0;f=hb[f>>2];Vc=e;return f|0}function ti(){Pa()}function ui(f){f=rg(f,65536);var c=n.buffer.byteLength;try{return-1!==we.grow((f-
c)/65536)?n.buffer=we.buffer:null}catch(e){return null}}function Wc(f){this.name="ExitStatus";this.message="Program terminated with exit("+f+")";this.status=f}function tg(f){function c(){if(!n.calledRun&&(n.calledRun=!0,!ug)){xe||(xe=!0,vd(vg));vd(Ol);if(n.onRuntimeInitialized)n.onRuntimeInitialized();n._main&&vi&&n.callMain(f);if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)wi.unshift(n.postRun.shift());vd(wi)}}f=f||n.arguments;if(!(0<xc)){if(n.preRun)for("function"==
typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)xi.unshift(n.preRun.shift());vd(xi);0<xc||n.calledRun||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1);c()},1)):c())}}function Pa(f){if(n.onAbort)n.onAbort(f);void 0!==f?(wg(f),Nb(f),f=JSON.stringify(f)):f="";ug=!0;throw"abort("+f+"). Build with -s ASSERTIONS=1 for more info.";}function Pl(){for(var f=ba,c=0,e=f.length;c<e;c++){var d=A[f[c]];d.build||(d.d=(d.d+1)%8,ka(d,d.img))}}function yi(f){Ob=
!1;var c=ca;c.d=f.d;ka(c,f.img);c.active=!0;ib=z[52];ye=f;document.addEventListener("mousemove",xg);document.addEventListener("mousedown",zd)}function Ql(f,c){return f.innerHTML-c.innerHTML}var Ul=function(){(function(f){"object"===typeof exports&&"undefined"!==typeof module?module.exports=f():"function"===typeof define&&define.amd?define([],f):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).SimpleWebRTC=f()})(function(){return function g(c,
e,d){function b(h,l){if(!e[h]){if(!c[h]){var p="function"==typeof require&&require;if(!l&&p)return p(h,!0);if(q)return q(h,!0);l=Error("Cannot find module '"+h+"'");throw l.code="MODULE_NOT_FOUND",l;}l=e[h]={exports:{}};c[h][0].call(l.exports,function(d){var e=c[h][1][d];return b(e?e:d)},l,l.exports,g,c,e,d)}return e[h].exports}for(var q="function"==typeof require&&require,l=0;l<d.length;l++)b(d[l]);return b}({1:[function(c,e,d){function b(){}e.exports=function(c,d,e){function g(c,b){if(0>=g.count)throw Error("after called too many times");
--g.count;c?(h=!0,d(c),d=e):0!==g.count||h||d(null,b)}var h=!1;e=e||b;g.count=c;return 0===c?d():g}},{}],2:[function(c,e,d){e.exports=function(c,d,e){var b=c.byteLength;d=d||0;e=e||b;if(c.slice)return c.slice(d,e);0>d&&(d+=b);0>e&&(e+=b);e>b&&(e=b);if(d>=b||d>=e||0===b)return new ArrayBuffer(0);c=new Uint8Array(c);b=new Uint8Array(e-d);for(var g=0;d<e;d++,g++)b[g]=c[d];return b.buffer}},{}],3:[function(c,e,d){e.exports=function(c,d,e){var b,g=d;d={autoplay:!0,mirror:!1,muted:!1,audio:!1,disableContextMenu:!1};
if(e)for(b in e)d[b]=e[b];g?"audio"===g.tagName.toLowerCase()&&(d.audio=!0):g=document.createElement(d.audio?"audio":"video");d.disableContextMenu&&(g.oncontextmenu=function(c){c.preventDefault()});d.autoplay&&(g.autoplay="autoplay");d.muted&&(g.muted=!0);!d.audio&&d.mirror&&["","moz","webkit","o","ms"].forEach(function(c){g.style[c?c+"Transform":"transform"]="scaleX(-1)"});g.srcObject=c;return g}},{}],4:[function(c,e,d){function b(c){c=c||{};this.ms=c.min||100;this.max=c.max||1E4;this.factor=c.factor||
2;this.jitter=0<c.jitter&&1>=c.jitter?c.jitter:0;this.attempts=0}e.exports=b;b.prototype.duration=function(){var c=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var d=Math.random(),e=Math.floor(d*this.jitter*c);c=0==(Math.floor(10*d)&1)?c-e:c+e}return Math.min(c,this.max)|0};b.prototype.reset=function(){this.attempts=0};b.prototype.setMin=function(c){this.ms=c};b.prototype.setMax=function(c){this.max=c};b.prototype.setJitter=function(c){this.jitter=c}},{}],5:[function(c,e,d){(function(c){d.encode=
function(d){d=new Uint8Array(d);var e,b=d.length,g="";for(e=0;e<b;e+=3)g+=c[d[e]>>2],g+=c[(d[e]&3)<<4|d[e+1]>>4],g+=c[(d[e+1]&15)<<2|d[e+2]>>6],g+=c[d[e+2]&63];2===b%3?g=g.substring(0,g.length-1)+"=":1===b%3&&(g=g.substring(0,g.length-2)+"==");return g};d.decode=function(d){var e=.75*d.length,b=d.length,g=0;"="===d[d.length-1]&&(e--,"="===d[d.length-2]&&e--);var h=new ArrayBuffer(e),B=new Uint8Array(h);for(e=0;e<b;e+=4){var K=c.indexOf(d[e]);var T=c.indexOf(d[e+1]);var ha=c.indexOf(d[e+2]);var kc=
c.indexOf(d[e+3]);B[g++]=K<<2|T>>4;B[g++]=(T&15)<<4|ha>>2;B[g++]=(ha&3)<<6|kc&63}return h}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],6:[function(c,e,d){(function(c){function d(c){for(var d=0;d<c.length;d++){var e=c[d];if(e.buffer instanceof ArrayBuffer){var b=e.buffer;if(e.byteLength!==b.byteLength){var g=new Uint8Array(e.byteLength);g.set(new Uint8Array(b,e.byteOffset,e.byteLength));b=g.buffer}c[d]=b}}}function b(c,e){e=e||{};var b=new p;d(c);for(var g=0;g<c.length;g++)b.append(c[g]);
return e.type?b.getBlob(e.type):b.getBlob()}function g(c,e){d(c);return new Blob(c,e||{})}var p=c.BlobBuilder||c.WebKitBlobBuilder||c.MSBlobBuilder||c.MozBlobBuilder;try{var F=2===(new Blob(["hi"])).size}catch(T){F=!1}var B;if(B=F)try{B=2===(new Blob([new Uint8Array([1,2])])).size}catch(T){B=!1}var K=p&&p.prototype.append&&p.prototype.getBlob;c=F?B?c.Blob:g:K?b:void 0;e.exports=c}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},
{}],7:[function(c,e,d){var b=[].slice;e.exports=function(c,d){"string"==typeof d&&(d=c[d]);if("function"!=typeof d)throw Error("bind() requires a function");var e=b.call(arguments,2);return function(){return d.apply(c,e.concat(b.call(arguments)))}}},{}],8:[function(c,e,d){function b(c){if(c){for(var d in b.prototype)c[d]=b.prototype[d];return c}}e.exports=b;b.prototype.on=b.prototype.addEventListener=function(c,d){this._callbacks=this._callbacks||{};(this._callbacks[c]=this._callbacks[c]||[]).push(d);
return this};b.prototype.once=function(c,d){function e(){b.off(c,e);d.apply(this,arguments)}var b=this;this._callbacks=this._callbacks||{};e.fn=d;this.on(c,e);return this};b.prototype.off=b.prototype.removeListener=b.prototype.removeAllListeners=b.prototype.removeEventListener=function(c,d){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var e=this._callbacks[c];if(!e)return this;if(1==arguments.length)return delete this._callbacks[c],this;for(var b,g=0;g<
e.length;g++)if(b=e[g],b===d||b.fn===d){e.splice(g,1);break}return this};b.prototype.emit=function(c){this._callbacks=this._callbacks||{};var d=[].slice.call(arguments,1),e=this._callbacks[c];if(e){e=e.slice(0);for(var b=0,g=e.length;b<g;++b)e[b].apply(this,d)}return this};b.prototype.listeners=function(c){this._callbacks=this._callbacks||{};return this._callbacks[c]||[]};b.prototype.hasListeners=function(c){return!!this.listeners(c).length}},{}],9:[function(c,e,d){e.exports=function(c,d){var e=function(){};
e.prototype=d.prototype;c.prototype=new e;c.prototype.constructor=c}},{}],10:[function(c,e,d){function b(c){return b.enabled(c)?function(d){d instanceof Error&&(d=d.stack||d.message);var e=new Date,g=e-(b[c]||e);b[c]=e;d=c+" "+d+" +"+b.humanize(g);window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}e.exports=b;b.names=[];b.skips=[];b.enable=function(c){try{localStorage.debug=c}catch(F){}for(var d=(c||"").split(/[\s,]+/),e=d.length,g=0;g<e;g++)c=
d[g].replace("*",".*?"),"-"===c[0]?b.skips.push(new RegExp("^"+c.substr(1)+"$")):b.names.push(new RegExp("^"+c+"$"))};b.disable=function(){b.enable("")};b.humanize=function(c){return 36E5<=c?(c/36E5).toFixed(1)+"h":6E4<=c?(c/6E4).toFixed(1)+"m":1E3<=c?(c/1E3|0)+"s":c+"ms"};b.enabled=function(c){for(var d=0,e=b.skips.length;d<e;d++)if(b.skips[d].test(c))return!1;d=0;for(e=b.names.length;d<e;d++)if(b.names[d].test(c))return!0;return!1};try{window.localStorage&&b.enable(localStorage.debug)}catch(h){}},
{}],11:[function(c,e,d){e.exports=c("./lib/")},{"./lib/":12}],12:[function(c,e,d){e.exports=c("./socket");e.exports.parser=c("engine.io-parser")},{"./socket":13,"engine.io-parser":24}],13:[function(c,e,d){(function(d){function b(c,e){if(!(this instanceof b))return new b(c,e);e=e||{};c&&"object"==typeof c&&(e=c,c=null);c&&(c=K(c),e.host=c.host,e.secure="https"==c.protocol||"wss"==c.protocol,e.port=c.port,c.query&&(e.query=c.query));this.secure=null!=e.secure?e.secure:d.location&&"https:"==location.protocol;
e.host&&(c=e.host.split(":"),e.hostname=c.shift(),c.length?e.port=c.pop():e.port||(e.port=this.secure?"443":"80"));this.agent=e.agent||!1;this.hostname=e.hostname||(d.location?location.hostname:"localhost");this.port=e.port||(d.location&&location.port?location.port:this.secure?443:80);this.query=e.query||{};"string"==typeof this.query&&(this.query=ha.decode(this.query));this.upgrade=!1!==e.upgrade;this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!e.forceJSONP;this.jsonp=!1!==
e.jsonp;this.forceBase64=!!e.forceBase64;this.enablesXDR=!!e.enablesXDR;this.timestampParam=e.timestampParam||"t";this.timestampRequests=e.timestampRequests;this.transports=e.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.callbackBuffer=[];this.policyPort=e.policyPort||843;this.rememberUpgrade=e.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=e.onlyBinaryUpgrades;this.pfx=e.pfx||null;this.key=e.key||null;this.passphrase=e.passphrase||null;this.cert=
e.cert||null;this.ca=e.ca||null;this.ciphers=e.ciphers||null;this.rejectUnauthorized=e.rejectUnauthorized||null;this.open()}var g=c("./transports"),l=c("component-emitter"),p=c("debug")("engine.io-client:socket"),F=c("indexof"),B=c("engine.io-parser"),K=c("parseuri"),T=c("parsejson"),ha=c("parseqs");e.exports=b;b.priorWebsocketSuccess=!1;l(b.prototype);b.protocol=B.protocol;b.Socket=b;b.Transport=c("./transport");b.transports=c("./transports");b.parser=c("engine.io-parser");b.prototype.createTransport=
function(c){p('creating transport "%s"',c);var d=this.query,e={},b;for(b in d)d.hasOwnProperty(b)&&(e[b]=d[b]);e.EIO=B.protocol;e.transport=c;this.id&&(e.sid=this.id);return new g[c]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,
key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})};b.prototype.open=function(){if(this.rememberUpgrade&&b.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))var c="websocket";else{if(0==this.transports.length){var d=this;setTimeout(function(){d.emit("error","No transports available")},0);return}c=this.transports[0]}this.readyState="opening";try{c=this.createTransport(c)}catch(Pb){this.transports.shift();
this.open();return}c.open();this.setTransport(c)};b.prototype.setTransport=function(c){p("setting transport %s",c.name);var d=this;this.transport&&(p("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=c;c.on("drain",function(){d.onDrain()}).on("packet",function(c){d.onPacket(c)}).on("error",function(c){d.onError(c)}).on("close",function(){d.onClose("transport close")})};b.prototype.probe=function(c){function d(){if(ha.onlyBinaryUpgrades){var d=
!this.supportsBinary&&ha.transport.supportsBinary;K=K||d}K||(p('probe transport "%s" opened',c),B.send([{type:"ping",data:"probe"}]),B.once("packet",function(d){K||("pong"==d.type&&"probe"==d.data?(p('probe transport "%s" pong',c),ha.upgrading=!0,ha.emit("upgrading",B),B&&(b.priorWebsocketSuccess="websocket"==B.name,p('pausing current transport "%s"',ha.transport.name),ha.transport.pause(function(){K||"closed"==ha.readyState||(p("changing transport and sending upgrade packet"),F(),ha.setTransport(B),
B.send([{type:"upgrade"}]),ha.emit("upgrade",B),B=null,ha.upgrading=!1,ha.flush())}))):(p('probe transport "%s" failed',c),d=Error("probe error"),d.transport=B.name,ha.emit("upgradeError",d)))}))}function e(){K||(K=!0,F(),B.close(),B=null)}function g(d){var b=Error("probe error: "+d);b.transport=B.name;e();p('probe transport "%s" failed because of error: %s',c,d);ha.emit("upgradeError",b)}function h(){g("transport closed")}function l(){g("socket closed")}function q(c){B&&c.name!=B.name&&(p('"%s" works - aborting "%s"',
c.name,B.name),e())}function F(){B.removeListener("open",d);B.removeListener("error",g);B.removeListener("close",h);ha.removeListener("close",l);ha.removeListener("upgrading",q)}p('probing transport "%s"',c);var B=this.createTransport(c,{probe:1}),K=!1,ha=this;b.priorWebsocketSuccess=!1;B.once("open",d);B.once("error",g);B.once("close",h);this.once("close",l);this.once("upgrading",q);B.open()};b.prototype.onOpen=function(){p("socket open");this.readyState="open";b.priorWebsocketSuccess="websocket"==
this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){p("starting upgrade probes");for(var c=0,d=this.upgrades.length;c<d;c++)this.probe(this.upgrades[c])}};b.prototype.onPacket=function(c){if("opening"==this.readyState||"open"==this.readyState)switch(p('socket receive: type "%s", data "%s"',c.type,c.data),this.emit("packet",c),this.emit("heartbeat"),c.type){case "open":this.onHandshake(T(c.data));break;case "pong":this.setPing();break;
case "error":var d=Error("server error");d.code=c.data;this.emit("error",d);break;case "message":this.emit("data",c.data),this.emit("message",c.data)}else p('packet received with socket readyState "%s"',this.readyState)};b.prototype.onHandshake=function(c){this.emit("handshake",c);this.id=c.sid;this.transport.query.sid=c.sid;this.upgrades=this.filterUpgrades(c.upgrades);this.pingInterval=c.pingInterval;this.pingTimeout=c.pingTimeout;this.onOpen();"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",
this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};b.prototype.onHeartbeat=function(c){clearTimeout(this.pingTimeoutTimer);var d=this;d.pingTimeoutTimer=setTimeout(function(){if("closed"!=d.readyState)d.onClose("ping timeout")},c||d.pingInterval+d.pingTimeout)};b.prototype.setPing=function(){var c=this;clearTimeout(c.pingIntervalTimer);c.pingIntervalTimer=setTimeout(function(){p("writing ping packet - expecting pong within %sms",c.pingTimeout);c.ping();c.onHeartbeat(c.pingTimeout)},c.pingInterval)};
b.prototype.ping=function(){this.sendPacket("ping")};b.prototype.onDrain=function(){for(var c=0;c<this.prevBufferLen;c++)if(this.callbackBuffer[c])this.callbackBuffer[c]();this.writeBuffer.splice(0,this.prevBufferLen);this.callbackBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0==this.writeBuffer.length?this.emit("drain"):this.flush()};b.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(p("flushing %d packets in socket",
this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};b.prototype.write=b.prototype.send=function(c,d){this.sendPacket("message",c,d);return this};b.prototype.sendPacket=function(c,d,e){"closing"!=this.readyState&&"closed"!=this.readyState&&(c={type:c,data:d},this.emit("packetCreate",c),this.writeBuffer.push(c),this.callbackBuffer.push(e),this.flush())};b.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){var c=
function(){b.once("upgrade",d);b.once("upgradeError",d)},d=function(){b.removeListener("upgrade",d);b.removeListener("upgradeError",d);e()},e=function(){b.onClose("forced close");p("socket closing - telling transport to close");b.transport.close()};this.readyState="closing";var b=this;if(this.writeBuffer.length)this.once("drain",function(){this.upgrading?c():e()});else this.upgrading?c():e()}return this};b.prototype.onError=function(c){p("socket error %j",c);b.priorWebsocketSuccess=!1;this.emit("error",
c);this.onClose("transport error",c)};b.prototype.onClose=function(c,d){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){p('socket close with reason: "%s"',c);var e=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);setTimeout(function(){e.writeBuffer=[];e.callbackBuffer=[];e.prevBufferLen=0},0);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",
c,d)}};b.prototype.filterUpgrades=function(c){for(var d=[],e=0,b=c.length;e<b;e++)~F(this.transports,c[e])&&d.push(c[e]);return d}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":8,debug:21,"engine.io-parser":24,indexof:32,parsejson:40,parseqs:41,parseuri:23}],14:[function(c,e,d){function b(c){this.path=c.path;this.hostname=c.hostname;this.port=c.port;this.secure=c.secure;
this.query=c.query;this.timestampParam=c.timestampParam;this.timestampRequests=c.timestampRequests;this.readyState="";this.agent=c.agent||!1;this.socket=c.socket;this.enablesXDR=c.enablesXDR;this.pfx=c.pfx;this.key=c.key;this.passphrase=c.passphrase;this.cert=c.cert;this.ca=c.ca;this.ciphers=c.ciphers;this.rejectUnauthorized=c.rejectUnauthorized}var h=c("engine.io-parser");c=c("component-emitter");e.exports=b;c(b.prototype);b.timestamps=0;b.prototype.onError=function(c,d){c=Error(c);c.type="TransportError";
c.description=d;this.emit("error",c);return this};b.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this};b.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this};b.prototype.send=function(c){if("open"==this.readyState)this.write(c);else throw Error("Transport not open");};b.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};
b.prototype.onData=function(c){c=h.decodePacket(c,this.socket.binaryType);this.onPacket(c)};b.prototype.onPacket=function(c){this.emit("packet",c)};b.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":8,"engine.io-parser":24}],15:[function(c,e,d){(function(e){var b=c("xmlhttprequest"),g=c("./polling-xhr"),l=c("./polling-jsonp"),p=c("./websocket");d.polling=function(c){var d=!1,h=!1,p=!1!==c.jsonp;e.location&&(h="https:"==location.protocol,(d=location.port)||
(d=h?443:80),d=c.hostname!=location.hostname||d!=c.port,h=c.secure!=h);c.xdomain=d;c.xscheme=h;if("open"in new b(c)&&!c.forceJSONP)return new g(c);if(!p)throw Error("JSONP disabled");return new l(c)};d.websocket=p}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(c,e,d){(function(d){function b(){}function g(c){l.call(this,c);this.query=this.query||
{};K||(d.___eio||(d.___eio=[]),K=d.___eio);this.index=K.length;var e=this;K.push(function(c){e.onData(c)});this.query.j=this.index;d.document&&d.addEventListener&&d.addEventListener("beforeunload",function(){e.script&&(e.script.onerror=b)},!1)}var l=c("./polling"),p=c("component-inherit");e.exports=g;var F=/\n/g,B=/\\n/g,K;p(g,l);g.prototype.supportsBinary=!1;g.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),
this.iframe=this.form=null);l.prototype.doClose.call(this)};g.prototype.doPoll=function(){var c=this,d=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);d.async=!0;d.src=this.uri();d.onerror=function(d){c.onError("jsonp poll error",d)};var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(d,e);this.script=d;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var c=document.createElement("iframe");
document.body.appendChild(c);document.body.removeChild(c)},100)};g.prototype.doWrite=function(c,d){function e(){b();d()}function b(){if(g.iframe)try{g.form.removeChild(g.iframe)}catch(zg){g.onError("jsonp polling iframe removal error",zg)}try{q=document.createElement('<iframe src="javascript:0" name="'+g.iframeId+'">')}catch(zg){q=document.createElement("iframe"),q.name=g.iframeId,q.src="javascript:0"}q.id=g.iframeId;g.form.appendChild(q);g.iframe=q}var g=this;if(!this.form){var h=document.createElement("form"),
l=document.createElement("textarea"),p=this.iframeId="eio_iframe_"+this.index,q;h.className="socketio";h.style.position="absolute";h.style.top="-1000px";h.style.left="-1000px";h.target=p;h.method="POST";h.setAttribute("accept-charset","utf-8");l.name="d";h.appendChild(l);document.body.appendChild(h);this.form=h;this.area=l}this.form.action=this.uri();b();c=c.replace(B,"\\\n");this.area.value=c.replace(F,"\\n");try{this.form.submit()}catch(zg){}this.iframe.attachEvent?this.iframe.onreadystatechange=
function(){"complete"==g.iframe.readyState&&e()}:this.iframe.onload=e}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-inherit":9}],17:[function(c,e,d){(function(d){function b(){}function g(c){B.call(this,c);if(d.location){var e="https:"==location.protocol,b=location.port;b||(b=e?443:80);this.xd=c.hostname!=d.location.hostname||b!=c.port;this.xs=c.secure!=e}}function l(c){this.method=c.method||"GET";this.uri=
c.uri;this.xd=!!c.xd;this.xs=!!c.xs;this.async=!1!==c.async;this.data=void 0!=c.data?c.data:null;this.agent=c.agent;this.isBinary=c.isBinary;this.supportsBinary=c.supportsBinary;this.enablesXDR=c.enablesXDR;this.pfx=c.pfx;this.key=c.key;this.passphrase=c.passphrase;this.cert=c.cert;this.ca=c.ca;this.ciphers=c.ciphers;this.rejectUnauthorized=c.rejectUnauthorized;this.create()}function p(){for(var c in l.requests)l.requests.hasOwnProperty(c)&&l.requests[c].abort()}var F=c("xmlhttprequest"),B=c("./polling"),
K=c("component-emitter"),T=c("component-inherit"),ha=c("debug")("engine.io-client:polling-xhr");e.exports=g;e.exports.Request=l;T(g,B);g.prototype.supportsBinary=!0;g.prototype.request=function(c){c=c||{};c.uri=this.uri();c.xd=this.xd;c.xs=this.xs;c.agent=this.agent||!1;c.supportsBinary=this.supportsBinary;c.enablesXDR=this.enablesXDR;c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;return new l(c)};
g.prototype.doWrite=function(c,d){c=this.request({method:"POST",data:c,isBinary:"string"!==typeof c&&void 0!==c});var e=this;c.on("success",d);c.on("error",function(c){e.onError("xhr post error",c)});this.sendXhr=c};g.prototype.doPoll=function(){ha("xhr poll");var c=this.request(),d=this;c.on("data",function(c){d.onData(c)});c.on("error",function(c){d.onError("xhr poll error",c)});this.pollXhr=c};K(l.prototype);l.prototype.create=function(){var c={agent:this.agent,xdomain:this.xd,xscheme:this.xs,
enablesXDR:this.enablesXDR};c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new F(c),b=this;try{ha("xhr open %s: %s",this.method,this.uri);e.open(this.method,this.uri,this.async);this.supportsBinary&&(e.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(yg){}"withCredentials"in
e&&(e.withCredentials=!0);this.hasXDR()?(e.onload=function(){b.onLoad()},e.onerror=function(){b.onError(e.responseText)}):e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status||1223==e.status)b.onLoad();else setTimeout(function(){b.onError(e.status)},0)};ha("xhr data %s",this.data);e.send(this.data)}catch(yg){setTimeout(function(){b.onError(yg)},0);return}d.document&&(this.index=l.requestsCount++,l.requests[this.index]=this)};l.prototype.onSuccess=function(){this.emit("success");this.cleanup()};
l.prototype.onData=function(c){this.emit("data",c);this.onSuccess()};l.prototype.onError=function(c){this.emit("error",c);this.cleanup(!0)};l.prototype.cleanup=function(c){if("undefined"!=typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=this.xhr.onerror=b:this.xhr.onreadystatechange=b;if(c)try{this.xhr.abort()}catch(ze){}d.document&&delete l.requests[this.index];this.xhr=null}};l.prototype.onLoad=function(){try{try{var c=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(Pb){}var d=
"application/octet-stream"===c?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(Pb){this.onError(Pb)}if(null!=d)this.onData(d)};l.prototype.hasXDR=function(){return"undefined"!==typeof d.XDomainRequest&&!this.xs&&this.enablesXDR};l.prototype.abort=function(){this.cleanup()};d.document&&(l.requestsCount=0,l.requests={},d.attachEvent?d.attachEvent("onunload",p):d.addEventListener&&d.addEventListener("beforeunload",p,!1))}).call(this,"undefined"!==typeof global?global:"undefined"!==
typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-emitter":8,"component-inherit":9,debug:21,xmlhttprequest:20}],18:[function(c,e,d){function b(c){var d=c&&c.forceBase64;if(!F||d)this.supportsBinary=!1;h.call(this,c)}var h=c("../transport"),q=c("parseqs"),l=c("engine.io-parser");d=c("component-inherit");var p=c("debug")("engine.io-client:polling");e.exports=b;var F=null!=(new (c("xmlhttprequest"))({xdomain:!1})).responseType;d(b,h);b.prototype.name="polling";b.prototype.doOpen=
function(){this.poll()};b.prototype.pause=function(c){function d(){p("paused");e.readyState="paused";c()}var e=this;this.readyState="pausing";if(this.polling||!this.writable){var b=0;this.polling&&(p("we are currently polling - waiting to pause"),b++,this.once("pollComplete",function(){p("pre-pause polling complete");--b||d()}));this.writable||(p("we are currently writing - waiting to pause"),b++,this.once("drain",function(){p("pre-pause writing complete");--b||d()}))}else d()};b.prototype.poll=function(){p("polling");
this.polling=!0;this.doPoll();this.emit("poll")};b.prototype.onData=function(c){var d=this;p("polling got data %s",c);l.decodePayload(c,this.socket.binaryType,function(c,e,b){if("opening"==d.readyState)d.onOpen();if("close"==c.type)return d.onClose(),!1;d.onPacket(c)});"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():p('ignoring poll - transport state "%s"',this.readyState))};b.prototype.doClose=function(){function c(){p("writing close packet");
d.write([{type:"close"}])}var d=this;"open"==this.readyState?(p("transport open - closing"),c()):(p("transport not open - deferring close"),this.once("open",c))};b.prototype.write=function(c){var d=this;this.writable=!1;var e=function(){d.writable=!0;d.emit("drain")};d=this;l.encodePayload(c,this.supportsBinary,function(c){d.doWrite(c,e)})};b.prototype.uri=function(){var c=this.query||{},d=this.secure?"https":"http",e="";!1!==this.timestampRequests&&(c[this.timestampParam]=+new Date+"-"+h.timestamps++);
this.supportsBinary||c.sid||(c.b64=1);c=q.encode(c);this.port&&("https"==d&&443!=this.port||"http"==d&&80!=this.port)&&(e=":"+this.port);c.length&&(c="?"+c);return d+"://"+this.hostname+e+this.path+c}},{"../transport":14,"component-inherit":9,debug:21,"engine.io-parser":24,parseqs:41,xmlhttprequest:20}],19:[function(c,e,d){function b(c){c&&c.forceBase64&&(this.supportsBinary=!1);h.call(this,c)}var h=c("../transport"),q=c("engine.io-parser"),l=c("parseqs");d=c("component-inherit");var p=c("debug")("engine.io-client:websocket"),
F=c("ws");e.exports=b;d(b,h);b.prototype.name="websocket";b.prototype.supportsBinary=!0;b.prototype.doOpen=function(){if(this.check()){var c=this.uri(),d={agent:this.agent};d.pfx=this.pfx;d.key=this.key;d.passphrase=this.passphrase;d.cert=this.cert;d.ca=this.ca;d.ciphers=this.ciphers;d.rejectUnauthorized=this.rejectUnauthorized;this.ws=new F(c,void 0,d);void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.binaryType="arraybuffer";this.addEventListeners()}};b.prototype.addEventListeners=function(){var c=
this;this.ws.onopen=function(){c.onOpen()};this.ws.onclose=function(){c.onClose()};this.ws.onmessage=function(d){c.onData(d.data)};this.ws.onerror=function(d){c.onError("websocket error",d)}};"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(b.prototype.onData=function(c){var d=this;setTimeout(function(){h.prototype.onData.call(d,c)},0)});b.prototype.write=function(c){var d=this;this.writable=!1;for(var b=0,e=c.length;b<e;b++)q.encodePacket(c[b],this.supportsBinary,function(c){try{d.ws.send(c)}catch(ze){p("websocket closed before onclose event")}});
setTimeout(function(){d.writable=!0;d.emit("drain")},0)};b.prototype.onClose=function(){h.prototype.onClose.call(this)};b.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()};b.prototype.uri=function(){var c=this.query||{},d=this.secure?"wss":"ws",b="";this.port&&("wss"==d&&443!=this.port||"ws"==d&&80!=this.port)&&(b=":"+this.port);this.timestampRequests&&(c[this.timestampParam]=+new Date);this.supportsBinary||(c.b64=1);c=l.encode(c);c.length&&(c="?"+c);return d+"://"+this.hostname+
b+this.path+c};b.prototype.check=function(){return!!F&&!("__initialize"in F&&this.name===b.prototype.name)}},{"../transport":14,"component-inherit":9,debug:21,"engine.io-parser":24,parseqs:41,ws:66}],20:[function(c,b,d){var e=c("has-cors");b.exports=function(c){var d=c.xdomain,b=c.xscheme;c=c.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!d||e))return new XMLHttpRequest}catch(p){}try{if("undefined"!=typeof XDomainRequest&&!b&&c)return new XDomainRequest}catch(p){}if(!d)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(p){}}},
{"has-cors":31}],21:[function(c,b,d){function e(){try{var c=localStorage.debug}catch(q){}return c}d=b.exports=c("./debug");d.log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)};d.formatArgs=function(){var c=arguments,b=this.useColors;c[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+c[0]+(b?"%c ":" ")+"+"+d.humanize(this.diff);if(!b)return c;b="color: "+this.color;c=[c[0],b,"color: inherit"].concat(Array.prototype.slice.call(c,
1));var e=0,g=0;c[0].replace(/%[a-z%]/g,function(c){"%%"!==c&&(e++,"%c"===c&&(g=e))});c.splice(g,0,b);return c};d.save=function(c){try{null==c?localStorage.removeItem("debug"):localStorage.debug=c}catch(q){}};d.load=e;d.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)};d.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");
d.formatters.j=function(c){return JSON.stringify(c)};d.enable(e())},{"./debug":22}],22:[function(c,b,d){d=b.exports=function(c){function b(){}function g(){var c=+new Date;g.diff=c-(h||c);g.prev=h;h=g.curr=c;null==g.useColors&&(g.useColors=d.useColors());null==g.color&&g.useColors&&(g.color=d.colors[e++%d.colors.length]);var b=Array.prototype.slice.call(arguments);b[0]=d.coerce(b[0]);"string"!==typeof b[0]&&(b=["%o"].concat(b));var l=0;b[0]=b[0].replace(/%([a-z%])/g,function(c,e){if("%%"===c)return c;
l++;e=d.formatters[e];"function"===typeof e&&(c=e.call(g,b[l]),b.splice(l,1),l--);return c});"function"===typeof d.formatArgs&&(b=d.formatArgs.apply(g,b));(g.log||d.log||console.log.bind(console)).apply(g,b)}b.enabled=!1;g.enabled=!0;var q=d.enabled(c)?g:b;q.namespace=c;return q};d.coerce=function(c){return c instanceof Error?c.stack||c.message:c};d.disable=function(){d.enable("")};d.enable=function(c){d.save(c);for(var b=(c||"").split(/[\s,]+/),e=b.length,g=0;g<e;g++)b[g]&&(c=b[g].replace(/\*/g,
".*?"),"-"===c[0]?d.skips.push(new RegExp("^"+c.substr(1)+"$")):d.names.push(new RegExp("^"+c+"$")))};d.enabled=function(c){var b;var e=0;for(b=d.skips.length;e<b;e++)if(d.skips[e].test(c))return!1;e=0;for(b=d.names.length;e<b;e++)if(d.names[e].test(c))return!0;return!1};d.humanize=c("ms");d.names=[];d.skips=[];d.formatters={};var e=0,h},{ms:38}],23:[function(c,b,d){var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
h="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");b.exports=function(c){var d=c,b=c.indexOf("["),g=c.indexOf("]");-1!=b&&-1!=g&&(c=c.substring(0,b)+c.substring(b,g).replace(/:/g,";")+c.substring(g,c.length));c=e.exec(c||"");for(var q={},K=14;K--;)q[h[K]]=c[K]||"";-1!=b&&-1!=g&&(q.source=d,q.host=q.host.substring(1,q.host.length-1).replace(/;/g,":"),q.authority=q.authority.replace("[","").replace("]","").replace(/;/g,":"),q.ipv6uri=
!0);return q}},{}],24:[function(c,b,d){(function(b){function e(c,b,e){if(!b)return d.encodeBase64Packet(c,e);var g=new FileReader;g.onload=function(){c.data=g.result;d.encodePacket(c,b,!0,e)};return g.readAsArrayBuffer(c.data)}function g(c,d,b){var e=Array(c.length);b=K(c.length,b);for(var g=function(c,b,g){d(b,function(d,b){e[c]=b;g(d,e)})},h=0;h<c.length;h++)g(h,c[h],b)}var l=c("./keys"),p=c("has-binary"),F=c("arraybuffer.slice"),B=c("base64-arraybuffer"),K=c("after"),T=c("utf8"),ha=navigator.userAgent.match(/Android/i),
m=/PhantomJS/i.test(navigator.userAgent),k=ha||m;d.protocol=3;var n=d.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},r=l(n),v={type:"error",data:"parser error"},t=c("blob");d.encodePacket=function(c,g,h,l){"function"==typeof g&&(l=g,g=!1);"function"==typeof h&&(l=h,h=null);var p=void 0===c.data?void 0:c.data.buffer||c.data;if(b.ArrayBuffer&&p instanceof ArrayBuffer){if(g){h=c.data;g=new Uint8Array(h);h=new Uint8Array(1+h.byteLength);h[0]=n[c.type];for(c=0;c<g.length;c++)h[c+1]=
g[c];c=l(h.buffer)}else c=d.encodeBase64Packet(c,l);return c}if(t&&p instanceof b.Blob)return g?k?c=e(c,g,l):(g=new Uint8Array(1),g[0]=n[c.type],c=new t([g.buffer,c.data]),c=l(c)):c=d.encodeBase64Packet(c,l),c;if(p&&p.base64)return l("b"+d.packets[c.type]+c.data.data);g=n[c.type];void 0!==c.data&&(g+=h?T.encode(String(c.data)):String(c.data));return l(""+g)};d.encodeBase64Packet=function(c,e){var g="b"+d.packets[c.type];if(t&&c.data instanceof t){var h=new FileReader;h.onload=function(){var c=h.result.split(",")[1];
e(g+c)};return h.readAsDataURL(c.data)}try{var l=String.fromCharCode.apply(null,new Uint8Array(c.data))}catch(yn){c=new Uint8Array(c.data);l=Array(c.length);for(var p=0;p<c.length;p++)l[p]=c[p];l=String.fromCharCode.apply(null,l)}g+=b.btoa(l);return e(g)};d.decodePacket=function(c,b,e){if("string"==typeof c||void 0===c){if("b"==c.charAt(0))return d.decodeBase64Packet(c.substr(1),b);if(e)try{c=T.decode(c)}catch(xn){return v}e=c.charAt(0);return Number(e)==e&&r[e]?1<c.length?{type:r[e],data:c.substring(1)}:
{type:r[e]}:v}e=(new Uint8Array(c))[0];c=F(c,1);t&&"blob"===b&&(c=new t([c]));return{type:r[e],data:c}};d.decodeBase64Packet=function(c,d){var e=r[c.charAt(0)];if(!b.ArrayBuffer)return{type:e,data:{base64:!0,data:c.substr(1)}};c=B.decode(c.substr(1));"blob"===d&&t&&(c=new t([c]));return{type:e,data:c}};d.encodePayload=function(c,b,e){"function"==typeof b&&(e=b,b=null);var h=p(c);if(b&&h)return t&&!k?d.encodePayloadAsBlob(c,e):d.encodePayloadAsArrayBuffer(c,e);if(!c.length)return e("0:");g(c,function(c,
e){d.encodePacket(c,h?b:!1,!0,function(c){e(null,c.length+":"+c)})},function(c,d){return e(d.join(""))})};d.decodePayload=function(c,b,e){if("string"!=typeof c)return d.decodePayloadAsBinary(c,b,e);"function"===typeof b&&(e=b,b=null);if(""==c)return e(v,0,1);var g="";for(var h,l,p=0,q=c.length;p<q;p++)if(l=c.charAt(p),":"!=l)g+=l;else{if(""==g||g!=(h=Number(g)))return e(v,0,1);l=c.substr(p+1,h);if(g!=l.length)return e(v,0,1);if(l.length){g=d.decodePacket(l,b,!0);if(v.type==g.type&&v.data==g.data)return e(v,
0,1);if(!1===e(g,p+h,q))return}p+=h;g=""}if(""!=g)return e(v,0,1)};d.encodePayloadAsArrayBuffer=function(c,b){if(!c.length)return b(new ArrayBuffer(0));g(c,function(c,b){d.encodePacket(c,!0,!0,function(c){return b(null,c)})},function(c,d){c=d.reduce(function(c,d){d="string"===typeof d?d.length:d.byteLength;return c+d.toString().length+d+2},0);var e=new Uint8Array(c),g=0;d.forEach(function(c){var d="string"===typeof c,b=c;if(d){b=new Uint8Array(c.length);for(var h=0;h<c.length;h++)b[h]=c.charCodeAt(h);
b=b.buffer}d?e[g++]=0:e[g++]=1;c=b.byteLength.toString();for(h=0;h<c.length;h++)e[g++]=parseInt(c[h]);e[g++]=255;b=new Uint8Array(b);for(h=0;h<b.length;h++)e[g++]=b[h]});return b(e.buffer)})};d.encodePayloadAsBlob=function(c,b){g(c,function(c,b){d.encodePacket(c,!0,!0,function(c){var d=new Uint8Array(1);d[0]=1;if("string"===typeof c){for(var e=new Uint8Array(c.length),g=0;g<c.length;g++)e[g]=c.charCodeAt(g);c=e.buffer;d[0]=0}e=(c instanceof ArrayBuffer?c.byteLength:c.size).toString();var h=new Uint8Array(e.length+
1);for(g=0;g<e.length;g++)h[g]=parseInt(e[g]);h[e.length]=255;t&&(c=new t([d.buffer,h.buffer,c]),b(null,c))})},function(c,d){return b(new t(d))})};d.decodePayloadAsBinary=function(c,b,e){"function"===typeof b&&(e=b,b=null);for(var g=[],h=!1;0<c.byteLength;){for(var l=new Uint8Array(c),p=0===l[0],q="",B=1;255!=l[B];B++){if(310<q.length){h=!0;break}q+=l[B]}if(h)return e(v,0,1);c=F(c,2+q.length);q=parseInt(q);l=F(c,0,q);if(p)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(zn){for(p=new Uint8Array(l),
l="",B=0;B<p.length;B++)l+=String.fromCharCode(p[B])}g.push(l);c=F(c,q)}var K=g.length;g.forEach(function(c,g){e(d.decodePacket(c,b,!0),g,K)})}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./keys":25,after:1,"arraybuffer.slice":2,"base64-arraybuffer":5,blob:6,"has-binary":30,utf8:60}],25:[function(c,b,d){b.exports=Object.keys||function(c){var b=[],d=Object.prototype.hasOwnProperty,e;for(e in c)d.call(c,e)&&b.push(e);return b}},
{}],26:[function(c,b,d){function e(c){q.call(this);c=c||{};this.config={chunksize:16384,pacing:0};for(var b in c)this.config[b]=c[b];this.channel=this.file=null}function h(){q.call(this);this.receiveBuffer=[];this.received=0;this.metadata={};this.channel=null}var q=c("wildemitter");c=c("util");c.inherits(e,q);e.prototype.send=function(c,b){var d=this;this.file=c;this.channel=b;var e="number"!==typeof b.bufferedAmountLowThreshold,g=0,h=function(){var l=new window.FileReader;l.onload=function(){return function(l){d.channel.send(l.target.result);
d.emit("progress",g,c.size,l.target.result);c.size>g+l.target.result.byteLength?e?window.setTimeout(h,d.config.pacing):b.bufferedAmount<=b.bufferedAmountLowThreshold&&window.setTimeout(h,0):(d.emit("progress",c.size,c.size,null),d.emit("sentFile"));g+=d.config.chunksize}}(c);var p=c.slice(g,g+d.config.chunksize);l.readAsArrayBuffer(p)};e||(b.bufferedAmountLowThreshold=8*this.config.chunksize,b.addEventListener("bufferedamountlow",h));window.setTimeout(h,0)};c.inherits(h,q);h.prototype.receive=function(c,
b){var d=this;c&&(this.metadata=c);this.channel=b;b.binaryType="arraybuffer";this.channel.onmessage=function(c){d.received+=c.data.byteLength;d.receiveBuffer.push(c.data);d.emit("progress",d.received,d.metadata.size,c.data);d.received===d.metadata.size?(d.emit("receivedFile",new window.Blob(d.receiveBuffer),d.metadata),d.receiveBuffer=[]):d.received>d.metadata.size&&(console.error("received more than expected, discarding..."),d.receiveBuffer=[])}};b.exports={};b.exports.support="undefined"!==typeof window&&
window&&window.File&&window.FileReader&&window.Blob;b.exports.Sender=e;b.exports.Receiver=h},{util:63,wildemitter:65}],27:[function(c,b,d){var e={};b.exports=function(c,d){var b=2===arguments.length,g=b?d:c;if("undefined"===typeof window||"http:"===window.location.protocol){var h=Error("NavigatorUserMediaError");h.name="HTTPS_REQUIRED";return g(h)}if(window.navigator.userAgent.match("Chrome")){var q=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),K=33,T=!window.chrome.webstore;window.navigator.userAgent.match("Linux")&&
(K=35);sessionStorage.getScreenMediaJSExtensionId?chrome.runtime.sendMessage(sessionStorage.getScreenMediaJSExtensionId,{type:"getScreen",id:1},null,function(d){d&&""!==d.sourceId?(c=b&&c||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3}}},c.video.mandatory.chromeMediaSourceId=d.sourceId,window.navigator.mediaDevices.getUserMedia(c).then(function(c){g(null,c)}).catch(function(c){g(c)})):(d=Error("NavigatorUserMediaError"),
d.name="NotAllowedError",g(d))}):window.cefGetScreenMedia?window.cefGetScreenMedia(function(d){d?(c=b&&c||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},c.video.mandatory.chromeMediaSourceId=d,window.navigator.mediaDevices.getUserMedia(c).then(function(c){g(null,c)}).catch(function(c){g(c)})):(d=Error("cefGetScreenMediaError"),d.name="CEF_GETSCREENMEDIA_CANCELED",
g(d))}):T||26<=q&&q<=K?(c=b&&c||{video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3,chromeMediaSource:"screen"}}},window.navigator.mediaDevices.getUserMedia(c).then(function(c){g(null,c)}).catch(function(c){g(c)})):(q=window.setTimeout(function(){h=Error("NavigatorUserMediaError");h.name="EXTENSION_UNAVAILABLE";return g(h)},1E3),e[q]=[g,b?c:null],window.postMessage({type:"getScreen",id:q},"*"))}else window.navigator.userAgent.match("Firefox")&&
(33<=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10)?(c=b&&c||{video:{mozMediaSource:"window",mediaSource:"window"}},window.navigator.mediaDevices.getUserMedia(c).then(function(c){g(null,c);var d=c.currentTime,b=window.setInterval(function(){c||window.clearInterval(b);if(c.currentTime==d&&(window.clearInterval(b),c.onended))c.onended();d=c.currentTime},500)}).catch(function(c){g(c)})):(h=Error("NavigatorUserMediaError"),h.name="EXTENSION_UNAVAILABLE"))};"undefined"!==typeof window&&
window.addEventListener("message",function(c){if(c.origin==window.location.origin)if("gotScreen"==c.data.type&&e[c.data.id]){var d=e[c.data.id],b=d[1],g=d[0];delete e[c.data.id];""===c.data.sourceId?(c=Error("NavigatorUserMediaError"),c.name="NotAllowedError",g(c)):(b=b||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},b.video.mandatory.chromeMediaSourceId=
c.data.sourceId,window.navigator.mediaDevices.getUserMedia(b).then(function(c){g(null,c)}).catch(function(c){g(c)}))}else"getScreenPending"==c.data.type&&window.clearTimeout(c.data.id)})},{}],28:[function(c,b,d){b.exports=function(){return this}()},{}],29:[function(c,b,d){var e=c("wildemitter"),h;"undefined"!==typeof window&&(h=window.AudioContext||window.webkitAudioContext);var q=null;b.exports=function(c,d){var b=new e;if(!h)return b;d=d||{};var g=d.smoothing||.1,l=d.interval||50,p=d.threshold,
ha=d.play;d=d.history||10;var m=!0;q||(q=new h);var k=q.createAnalyser();k.fftSize=512;k.smoothingTimeConstant=g;var n=new Float32Array(k.frequencyBinCount);c.jquery&&(c=c[0]);if(c instanceof HTMLAudioElement||c instanceof HTMLVideoElement){var r=q.createMediaElementSource(c);"undefined"===typeof ha&&(ha=!0)}else r=q.createMediaStreamSource(c);p=p||-50;r.connect(k);ha&&k.connect(q.destination);b.speaking=!1;b.setThreshold=function(c){p=c};b.setInterval=function(c){l=c};b.stop=function(){m=!1;b.emit("volume_change",
-100,p);b.speaking&&(b.speaking=!1,b.emit("stopped_speaking"));k.disconnect();r.disconnect()};b.speakingHistory=[];for(c=0;c<d;c++)b.speakingHistory.push(0);var t=function(){setTimeout(function(){if(m){var c=-Infinity;k.getFloatFrequencyData(n);for(var d=4,e=n.length;d<e;d++)n[d]>c&&0>n[d]&&(c=n[d]);b.emit("volume_change",c,p);d=0;if(c>p&&!b.speaking){for(e=b.speakingHistory.length-3;e<b.speakingHistory.length;e++)d+=b.speakingHistory[e];2<=d&&(b.speaking=!0,b.emit("speaking"))}else if(c<p&&b.speaking){for(e=
0;e<b.speakingHistory.length;e++)d+=b.speakingHistory[e];0==d&&(b.speaking=!1,b.emit("stopped_speaking"))}b.speakingHistory.shift();b.speakingHistory.push(0+(c>p));t()}},l)};t();return b}},{wildemitter:65}],30:[function(c,b,d){(function(d){var e=c("isarray");b.exports=function(c){function b(c){if(!c)return!1;if(d.Buffer&&d.Buffer.isBuffer(c)||d.ArrayBuffer&&c instanceof ArrayBuffer||d.Blob&&c instanceof Blob||d.File&&c instanceof File)return!0;if(e(c))for(var g=0;g<c.length;g++){if(b(c[g]))return!0}else if(c&&
"object"==typeof c)for(g in c.toJSON&&(c=c.toJSON()),c)if(Object.prototype.hasOwnProperty.call(c,g)&&b(c[g]))return!0;return!1}return b(c)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{isarray:33}],31:[function(c,b,d){c=c("global");try{b.exports="XMLHttpRequest"in c&&"withCredentials"in new c.XMLHttpRequest}catch(g){b.exports=!1}},{global:28}],32:[function(c,b,d){var e=[].indexOf;b.exports=function(c,b){if(e)return c.indexOf(b);
for(var d=0;d<c.length;++d)if(c[d]===b)return d;return-1}},{}],33:[function(c,b,d){b.exports=Array.isArray||function(c){return"[object Array]"==Object.prototype.toString.call(c)}},{}],34:[function(c,b,d){(function(c){function b(c){if(b[c]!==p)return b[c];if("bug-string-char-index"==c)var d=!1;else if("json"==c)d=b("json-stringify")&&b("json-parse");else{var g;if("json-stringify"==c){d=B.stringify;var h="function"==typeof d&&K;if(h){(g=function(){return 1}).toJSON=g;try{h="0"===d(0)&&"0"===d(new Number)&&
'""'==d(new String)&&d(e)===p&&d(p)===p&&d()===p&&"1"===d(g)&&"[1]"==d([g])&&"[null]"==d([p])&&"null"==d(null)&&"[null,null,null]"==d([p,e,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==d({a:[g,!0,!1,null,"\x00\b\n\f\r\t"]})&&"1"===d(null,g)&&"[\n 1,\n 2\n]"==d([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==d(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==d(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==d(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==d(new Date(-1))}catch(Ae){h=
!1}}d=h}if("json-parse"==c){d=B.parse;if("function"==typeof d)try{if(0===d("0")&&!d(!1)){g=d('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var l=5==g.a.length&&1===g.a[0];if(l){try{l=!d('"\t"')}catch(Ae){}if(l)try{l=1!==d("01")}catch(Ae){}if(l)try{l=1!==d("1.")}catch(Ae){}}}}catch(Ae){l=!1}d=l}}return b[c]=!!d}var e={}.toString,g,p,F="object"==typeof JSON&&JSON,B="object"==typeof d&&d&&!d.nodeType&&d;B&&F?(B.stringify=F.stringify,B.parse=F.parse):B=c.JSON=F||{};var K=new Date(-0xc782b5b800cec);
try{K=-109252==K.getUTCFullYear()&&0===K.getUTCMonth()&&1===K.getUTCDate()&&10==K.getUTCHours()&&37==K.getUTCMinutes()&&6==K.getUTCSeconds()&&708==K.getUTCMilliseconds()}catch(An){}if(!b("json")){var T=b("bug-string-char-index");if(!K)var ha=Math.floor,m=[0,31,59,90,120,151,181,212,243,273,304,334],k=function(c,d){return m[d]+365*(c-1970)+ha((c-1969+(d=+(1<d)))/4)-ha((c-1901+d)/100)+ha((c-1601+d)/400)};(g={}.hasOwnProperty)||(g=function(c){var d={};if((d.__proto__=null,d.__proto__={toString:1},d).toString!=
e)g=function(c){var d=this.__proto__;c=c in(this.__proto__=null,this);this.__proto__=d;return c};else{var b=d.constructor;g=function(c){var d=(this.constructor||b).prototype;return c in this&&!(c in d&&this[c]===d[c])}}d=null;return g.call(this,c)});var n={"boolean":1,number:1,string:1,undefined:1};var r=function(c,d){var b=0,h,l;(h=function(){this.valueOf=0}).prototype.valueOf=0;var p=new h;for(l in p)g.call(p,l)&&b++;h=p=null;b?r=2==b?function(c,d){var b={},h="[object Function]"==e.call(c),l;for(l in c)h&&
"prototype"==l||g.call(b,l)||!(b[l]=1)||!g.call(c,l)||d(l)}:function(c,d){var b="[object Function]"==e.call(c),h,l;for(h in c)b&&"prototype"==h||!g.call(c,h)||(l="constructor"===h)||d(h);(l||g.call(c,h="constructor"))&&d(h)}:(p="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),r=function(c,d){var b="[object Function]"==e.call(c),h,l;if(l=!b&&"function"!=typeof c.constructor)l=typeof c.hasOwnProperty,l="object"==l?!!c.hasOwnProperty:!n[l];l=
l?c.hasOwnProperty:g;for(h in c)b&&"prototype"==h||!l.call(c,h)||d(h);for(b=p.length;h=p[--b];l.call(c,h)&&d(h));});return r(c,d)};if(!b("json-stringify")){var t={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},v=function(c,d){return("000000"+(d||0)).slice(-c)},w=function(c){var d='"',b=0,e=c.length,g=10<e&&T,h;for(g&&(h=c.split(""));b<e;b++){var l=c.charCodeAt(b);switch(l){case 8:case 9:case 10:case 12:case 13:case 34:case 92:d+=t[l];break;default:d=32>l?d+("\\u00"+v(2,l.toString(16))):
d+(g?h[b]:T?c.charAt(b):c[b])}}return d+'"'},z=function(c,d,b,h,l,q,B){var F;try{var K=d[c]}catch(Cn){}if("object"==typeof K&&K){var T=e.call(K);if("[object Date]"!=T||g.call(K,"toJSON"))"function"==typeof K.toJSON&&("[object Number]"!=T&&"[object String]"!=T&&"[object Array]"!=T||g.call(K,"toJSON"))&&(K=K.toJSON(c));else if(K>-1/0&&K<1/0){if(k){var m=ha(K/864E5);for(T=ha(m/365.2425)+1970-1;k(T+1,0)<=m;T++);for(F=ha((m-k(T,0))/30.42);k(T,F+1)<=m;F++);m=1+m-k(T,F);var kc=(K%864E5+864E5)%864E5;var n=
ha(kc/36E5)%24;var ze=ha(kc/6E4)%60;var t=ha(kc/1E3)%60;kc%=1E3}else T=K.getUTCFullYear(),F=K.getUTCMonth(),m=K.getUTCDate(),n=K.getUTCHours(),ze=K.getUTCMinutes(),t=K.getUTCSeconds(),kc=K.getUTCMilliseconds();K=(0>=T||1E4<=T?(0>T?"-":"+")+v(6,0>T?-T:T):v(4,T))+"-"+v(2,F+1)+"-"+v(2,m)+"T"+v(2,n)+":"+v(2,ze)+":"+v(2,t)+"."+v(3,kc)+"Z"}else K=null}b&&(K=b.call(d,c,K));if(null===K)return"null";T=e.call(K);if("[object Boolean]"==T)return""+K;if("[object Number]"==T)return K>-1/0&&K<1/0?""+K:"null";if("[object String]"==
T)return w(""+K);if("object"==typeof K){for(c=B.length;c--;)if(B[c]===K)throw TypeError();B.push(K);var Pb=[];d=q;q+=l;if("[object Array]"==T){F=0;for(c=K.length;F<c;F++)T=z(F,K,b,h,l,q,B),Pb.push(T===p?"null":T);c=Pb.length?l?"[\n"+q+Pb.join(",\n"+q)+"\n"+d+"]":"["+Pb.join(",")+"]":"[]"}else r(h||K,function(c){var d=z(c,K,b,h,l,q,B);d!==p&&Pb.push(w(c)+":"+(l?" ":"")+d)}),c=Pb.length?l?"{\n"+q+Pb.join(",\n"+q)+"\n"+d+"}":"{"+Pb.join(",")+"}":"{}";B.pop();return c}};B.stringify=function(c,d,b){var g;
if("function"==typeof d||"object"==typeof d&&d)if("[object Function]"==(g=e.call(d)))var h=d;else if("[object Array]"==g){var l={};for(var p=0,q=d.length,B;p<q;B=d[p++],(g=e.call(B),"[object String]"==g||"[object Number]"==g)&&(l[B]=1));}if(b)if("[object Number]"==(g=e.call(b))){if(0<(b-=b%1)){var F="";for(10<b&&(b=10);F.length<b;F+=" ");}}else"[object String]"==g&&(F=10>=b.length?b:b.slice(0,10));return z("",(B={},B[""]=c,B),h,l,F,"",[])}}if(!b("json-parse")){var A=String.fromCharCode,y={92:"\\",
34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},x,C,H=function(){x=C=null;throw SyntaxError();},G=function(){for(var c=C,d=c.length,b,e,g,h,l;x<d;)switch(l=c.charCodeAt(x),l){case 9:case 10:case 13:case 32:x++;break;case 123:case 125:case 91:case 93:case 58:case 44:return b=T?c.charAt(x):c[x],x++,b;case 34:b="@";for(x++;x<d;)if(l=c.charCodeAt(x),32>l)H();else if(92==l)switch(l=c.charCodeAt(++x),l){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:b+=y[l];x++;break;case 117:e=
++x;for(g=x+4;x<g;x++)l=c.charCodeAt(x),48<=l&&57>=l||97<=l&&102>=l||65<=l&&70>=l||H();b+=A("0x"+c.slice(e,x));break;default:H()}else{if(34==l)break;l=c.charCodeAt(x);for(e=x;32<=l&&92!=l&&34!=l;)l=c.charCodeAt(++x);b+=c.slice(e,x)}if(34==c.charCodeAt(x))return x++,b;H();default:e=x;45==l&&(h=!0,l=c.charCodeAt(++x));if(48<=l&&57>=l){for(48==l&&(l=c.charCodeAt(x+1),48<=l&&57>=l)&&H();x<d&&(l=c.charCodeAt(x),48<=l&&57>=l);x++);if(46==c.charCodeAt(x)){for(g=++x;g<d&&(l=c.charCodeAt(g),48<=l&&57>=l);g++);
g==x&&H();x=g}l=c.charCodeAt(x);if(101==l||69==l){l=c.charCodeAt(++x);43!=l&&45!=l||x++;for(g=x;g<d&&(l=c.charCodeAt(g),48<=l&&57>=l);g++);g==x&&H();x=g}return+c.slice(e,x)}h&&H();if("true"==c.slice(x,x+4))return x+=4,!0;if("false"==c.slice(x,x+5))return x+=5,!1;if("null"==c.slice(x,x+4))return x+=4,null;H()}return"$"},D=function(c){var d,b;"$"==c&&H();if("string"==typeof c){if("@"==(T?c.charAt(0):c[0]))return c.slice(1);if("["==c){for(d=[];;b||(b=!0)){c=G();if("]"==c)break;b&&(","==c?(c=G(),"]"==
c&&H()):H());","==c&&H();d.push(D(c))}return d}if("{"==c){for(d={};;b||(b=!0)){c=G();if("}"==c)break;b&&(","==c?(c=G(),"}"==c&&H()):H());","!=c&&"string"==typeof c&&"@"==(T?c.charAt(0):c[0])&&":"==G()||H();d[c.slice(1)]=D(G())}return d}H()}return c},J=function(c,d,b){b=E(c,d,b);b===p?delete c[d]:c[d]=b},E=function(c,d,b){var g=c[d],h;if("object"==typeof g&&g)if("[object Array]"==e.call(g))for(h=g.length;h--;)J(g,h,b);else r(g,function(c){J(g,c,b)});return b.call(c,d,g)};B.parse=function(c,d){var b;
x=0;C=""+c;c=D(G());"$"!=G()&&H();x=C=null;return d&&"[object Function]"==e.call(d)?E((b={},b[""]=c,b),"",d):c}}}})(this)},{}],35:[function(c,b,d){function e(c){var d=!0;c.getTracks().forEach(function(c){d="ended"===c.readyState&&d});return d}function h(){if("undefined"===typeof window||!window.navigator.mozGetUserMedia)return!1;var c=window.navigator.userAgent.match(/Firefox\/(\d+)\./);return 50>(c&&1<=c.length&&parseInt(c[1],10))}function q(c){F.call(this);var d=this.config={detectSpeakingEvents:!1,
audioFallback:!1,media:{audio:!0,video:!0},harkOptions:null,logger:B},b;for(b in c)c.hasOwnProperty(b)&&(this.config[b]=c[b]);this.logger=d.logger;this._log=this.logger.log.bind(this.logger,"LocalMedia:");this._logerror=this.logger.error.bind(this.logger,"LocalMedia:");this.localStreams=[];this.localScreens=[];navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||this._logerror("Your browser does not support local media capture.");this._audioMonitors=[];this.on("localStreamStopped",this._stopAudioMonitor.bind(this));
this.on("localScreenStopped",this._stopAudioMonitor.bind(this))}d=c("util");var l=c("hark"),p=c("getscreenmedia"),F=c("wildemitter"),B=c("mockconsole");d.inherits(q,F);q.prototype.start=function(c,d){var b=this,g=c||this.config.media;this.emit("localStreamRequested",g);navigator.mediaDevices.getUserMedia(g).then(function(c){g.audio&&b.config.detectSpeakingEvents&&b._setupAudioMonitor(c,b.config.harkOptions);b.localStreams.push(c);c.getTracks().forEach(function(d){d.addEventListener("ended",function(){e(c)&&
b._removeStream(c)})});b.emit("localStream",c);if(d)return d(null,c)}).catch(function(c){if(b.config.audioFallback&&"NotFoundError"===c.name&&!1!==g.video)g.video=!1,b.start(g,d);else if(b.emit("localStreamRequestFailed",g),d)return d(c,null)})};q.prototype.stop=function(c){this.stopStream(c);this.stopScreenShare(c)};q.prototype.stopStream=function(c){var d=this;c?-1<this.localStreams.indexOf(c)&&(c.getTracks().forEach(function(c){c.stop()}),h()&&this._removeStream(c)):this.localStreams.forEach(function(c){c.getTracks().forEach(function(c){c.stop()});
h()&&d._removeStream(c)})};q.prototype.startScreenShare=function(c,d){var b=this;this.emit("localScreenRequested");"function"!==typeof c||d||(d=c,c=null);p(c,function(c,e){c?b.emit("localScreenRequestFailed"):(b.localScreens.push(e),e.getTracks().forEach(function(c){c.addEventListener("ended",function(){var c=!0;e.getTracks().forEach(function(d){c="ended"===d.readyState&&c});c&&b._removeStream(e)})}),b.emit("localScreen",e));if(d)return d(c,e)})};q.prototype.stopScreenShare=function(c){var d=this;
c?-1<this.localScreens.indexOf(c)&&(c.getTracks().forEach(function(c){c.stop()}),h()&&this._removeStream(c)):this.localScreens.forEach(function(c){c.getTracks().forEach(function(c){c.stop()});h()&&d._removeStream(c)})};q.prototype.mute=function(){this._audioEnabled(!1);this.emit("audioOff")};q.prototype.unmute=function(){this._audioEnabled(!0);this.emit("audioOn")};q.prototype.pauseVideo=function(){this._videoEnabled(!1);this.emit("videoOff")};q.prototype.resumeVideo=function(){this._videoEnabled(!0);
this.emit("videoOn")};q.prototype.pause=function(){this.mute();this.pauseVideo()};q.prototype.resume=function(){this.unmute();this.resumeVideo()};q.prototype._audioEnabled=function(c){this.localStreams.forEach(function(d){d.getAudioTracks().forEach(function(d){d.enabled=!!c})})};q.prototype._videoEnabled=function(c){this.localStreams.forEach(function(d){d.getVideoTracks().forEach(function(d){d.enabled=!!c})})};q.prototype.isAudioEnabled=function(){var c=!0;this.localStreams.forEach(function(d){d.getAudioTracks().forEach(function(d){c=
c&&d.enabled})});return c};q.prototype.isVideoEnabled=function(){var c=!0;this.localStreams.forEach(function(d){d.getVideoTracks().forEach(function(d){c=c&&d.enabled})});return c};q.prototype._removeStream=function(c){var d=this.localStreams.indexOf(c);-1<d?(this.localStreams.splice(d,1),this.emit("localStreamStopped",c)):(d=this.localScreens.indexOf(c),-1<d&&(this.localScreens.splice(d,1),this.emit("localScreenStopped",c)))};q.prototype._setupAudioMonitor=function(c,d){this._log("Setup audio");d=
l(c,d);var b=this,e;d.on("speaking",function(){b.emit("speaking")});d.on("stopped_speaking",function(){e&&clearTimeout(e);e=setTimeout(function(){b.emit("stoppedSpeaking")},1E3)});d.on("volume_change",function(c,d){b.emit("volumeChange",c,d)});this._audioMonitors.push({audio:d,stream:c})};q.prototype._stopAudioMonitor=function(c){var d=-1;this._audioMonitors.forEach(function(b,e){b.stream===c&&(d=e)});-1<d&&(this._audioMonitors[d].audio.stop(),this._audioMonitors.splice(d,1))};b.exports=q},{getscreenmedia:27,
hark:29,mockconsole:37,util:63,wildemitter:65}],36:[function(c,b,d){(function(c){function e(c,d){c.set(d[0],d[1]);return c}function g(c,d){c.add(d);return c}function l(c,d){for(var b=-1,e=c?c.length:0;++b<e&&!1!==d(c[b],b,c););return c}function p(c,d,b,e){var g=-1,h=c?c.length:0;for(e&&h&&(b=c[++g]);++g<h;)b=d(b,c[g],g,c);return b}function F(c){var d=!1;if(null!=c&&"function"!=typeof c.toString)try{d=!!(c+"")}catch(En){}return d}function B(c){var d=-1,b=Array(c.size);c.forEach(function(c,e){b[++d]=
[e,c]});return b}function K(c,d){return function(b){return c(d(b))}}function T(c){var d=-1,b=Array(c.size);c.forEach(function(c){b[++d]=c});return b}function m(c){var d=-1,b=c?c.length:0;for(this.clear();++d<b;){var e=c[d];this.set(e[0],e[1])}}function k(c){var d=-1,b=c?c.length:0;for(this.clear();++d<b;){var e=c[d];this.set(e[0],e[1])}}function n(c){var d=-1,b=c?c.length:0;for(this.clear();++d<b;){var e=c[d];this.set(e[0],e[1])}}function r(c){this.__data__=new k(c)}function v(c,d,b){var e=c[d];ca.call(c,
d)&&(e===b||e!==e&&b!==b)&&(void 0!==b||d in c)||(c[d]=b)}function t(c,d){for(var b=c.length;b--;){var e=c[b][0];if(e===d||e!==e&&d!==d)return b}return-1}function x(c,d){return c&&C(d,S(d),c)}function w(c,d,b,e,g,h,p){var q;e&&(q=h?e(c,g,h,p):e(c));if(void 0!==q)return q;if(!I(c))return c;if(g=ea(c)){if(q=E(c),!d)return H(c,q)}else{var B=va(c),K="[object Function]"==B||"[object GeneratorFunction]"==B;if(Ea(c))return A(c,d);if("[object Object]"==B||"[object Arguments]"==B||K&&!h){if(F(c))return h?
c:{};q=N(K?{}:c);if(!d)return G(c,x(q,c))}else{if(!L[B])return h?c:{};q=O(c,B,w,d)}}p||(p=new r);if(h=p.get(c))return h;p.set(c,q);if(!g)var T=b?z(c,S,za):S(c);l(T||c,function(g,h){T&&(h=g,g=c[h]);v(q,h,w(g,d,b,e,h,c,p))});return q}function z(c,d,b){d=d(c);if(!ea(c)){c=b(c);b=-1;for(var e=c.length,g=d.length;++b<e;)d[g+b]=c[b]}return d}function A(c,d){if(d)return c.slice();d=new c.constructor(c.length);c.copy(d);return d}function y(c){var d=new c.constructor(c.byteLength);(new Q(d)).set(new Q(c));
return d}function H(c,d){var b=-1,e=c.length;for(d||(d=Array(e));++b<e;)d[b]=c[b];return d}function C(c,d,b,e){b||(b={});for(var g=-1,h=d.length;++g<h;){var l=d[g],p=e?e(b[l],c[l],l,b,c):void 0;v(b,l,void 0===p?c[l]:p)}return b}function G(c,d){return C(c,za(c),d)}function D(c,d){c=c.__data__;var b=typeof d;return("string"==b||"number"==b||"symbol"==b||"boolean"==b?"__proto__"!==d:null===d)?c["string"==typeof d?"string":"hash"]:c.map}function J(c,d){c=null==c?void 0:c[d];d=!I(c)||la&&la in c?!1:(R(c)||
F(c)?da:W).test(yc(c));return d?c:void 0}function E(c){var d=c.length,b=c.constructor(d);d&&"string"==typeof c[0]&&ca.call(c,"index")&&(b.index=c.index,b.input=c.input);return b}function N(c){"function"!=typeof c.constructor||zi(c)?c={}:(c=ja(c),c=I(c)?pa(c):{});return c}function O(c,d,b,h){var l=c.constructor;switch(d){case "[object ArrayBuffer]":return y(c);case "[object Boolean]":case "[object Date]":return new l(+c);case "[object DataView]":return d=h?y(c.buffer):c.buffer,new c.constructor(d,
c.byteOffset,c.byteLength);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return d=h?y(c.buffer):c.buffer,new c.constructor(d,c.byteOffset,c.length);case "[object Map]":return d=h?b(B(c),!0):B(c),p(d,e,new c.constructor);case "[object Number]":case "[object String]":return new l(c);case "[object RegExp]":return d=
new c.constructor(c.source,U.exec(c)),d.lastIndex=c.lastIndex,d;case "[object Set]":return d=h?b(T(c),!0):T(c),p(d,g,new c.constructor);case "[object Symbol]":return Ia?Object(Ia.call(c)):{}}}function zi(c){var d=c&&c.constructor;return c===("function"==typeof d&&d.prototype||fa)}function yc(c){if(null!=c){try{return ba.call(c)}catch(Dn){}return c+""}return""}function Ai(c){var d;if(d=null!=c)d=c.length,d="number"==typeof d&&-1<d&&0==d%1&&9007199254740991>=d;return d&&!R(c)}function R(c){c=I(c)?ka.call(c):
"";return"[object Function]"==c||"[object GeneratorFunction]"==c}function I(c){var d=typeof c;return!!c&&("object"==d||"function"==d)}function S(c){if(Ai(c)){var d;(d=ea(c))||(d=!!c&&"object"==typeof c&&Ai(c)&&ca.call(c,"callee")&&(!oa.call(c,"callee")||"[object Arguments]"==ka.call(c)));if(d){d=c.length;for(var b=String,e=-1,g=Array(d);++e<d;)g[e]=b(e);d=g}else d=[];b=d.length;e=!!b;for(var h in c){if(!(g=!ca.call(c,h))&&(g=e)&&!(g="length"==h)){g=h;var l=b;l=null==l?9007199254740991:l;g=!!l&&("number"==
typeof g||X.test(g))&&-1<g&&0==g%1&&g<l}g||d.push(h)}c=d}else if(zi(c)){h=[];for(d in Object(c))ca.call(c,d)&&"constructor"!=d&&h.push(d);c=h}else c=Z(c);return c}function M(){return[]}function Y(){return!1}var U=/\w*$/,W=/^\[object .+?Constructor\]$/,X=/^(?:0|[1-9]\d*)$/,L={};L["[object Arguments]"]=L["[object Array]"]=L["[object ArrayBuffer]"]=L["[object DataView]"]=L["[object Boolean]"]=L["[object Date]"]=L["[object Float32Array]"]=L["[object Float64Array]"]=L["[object Int8Array]"]=L["[object Int16Array]"]=
L["[object Int32Array]"]=L["[object Map]"]=L["[object Number]"]=L["[object Object]"]=L["[object RegExp]"]=L["[object Set]"]=L["[object String]"]=L["[object Symbol]"]=L["[object Uint8Array]"]=L["[object Uint8ClampedArray]"]=L["[object Uint16Array]"]=L["[object Uint32Array]"]=!0;L["[object Error]"]=L["[object Function]"]=L["[object WeakMap]"]=!1;var V="object"==typeof self&&self&&self.Object===Object&&self;c="object"==typeof c&&c&&c.Object===Object&&c||V||Function("return this")();var P=(V="object"==
typeof d&&d&&!d.nodeType&&d)&&"object"==typeof b&&b&&!b.nodeType&&b;V=P&&P.exports===V;P=Array.prototype;var aa=Function.prototype,fa=Object.prototype,ia=c["__core-js_shared__"],la=function(){var c=/[^.]+$/.exec(ia&&ia.keys&&ia.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),ba=aa.toString,ca=fa.hasOwnProperty,ka=fa.toString,da=RegExp("^"+ba.call(ca).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");aa=V?c.Buffer:void 0;V=c.Symbol;
var Q=c.Uint8Array,ja=K(Object.getPrototypeOf,Object),pa=Object.create,oa=fa.propertyIsEnumerable,sa=P.splice;P=Object.getOwnPropertySymbols;aa=aa?aa.isBuffer:void 0;var Z=K(Object.keys,Object),ra=J(c,"DataView"),ua=J(c,"Map"),ma=J(c,"Promise"),wa=J(c,"Set");c=J(c,"WeakMap");var xa=J(Object,"create"),Fa=yc(ra),Ba=yc(ua),Aa=yc(ma),Ka=yc(wa),Da=yc(c),Ia=(V=V?V.prototype:void 0)?V.valueOf:void 0;m.prototype.clear=function(){this.__data__=xa?xa(null):{}};m.prototype["delete"]=function(c){return this.has(c)&&
delete this.__data__[c]};m.prototype.get=function(c){var d=this.__data__;return xa?(c=d[c],"__lodash_hash_undefined__"===c?void 0:c):ca.call(d,c)?d[c]:void 0};m.prototype.has=function(c){var d=this.__data__;return xa?void 0!==d[c]:ca.call(d,c)};m.prototype.set=function(c,d){this.__data__[c]=xa&&void 0===d?"__lodash_hash_undefined__":d;return this};k.prototype.clear=function(){this.__data__=[]};k.prototype["delete"]=function(c){var d=this.__data__;c=t(d,c);if(0>c)return!1;c==d.length-1?d.pop():sa.call(d,
c,1);return!0};k.prototype.get=function(c){var d=this.__data__;c=t(d,c);return 0>c?void 0:d[c][1]};k.prototype.has=function(c){return-1<t(this.__data__,c)};k.prototype.set=function(c,d){var b=this.__data__,e=t(b,c);0>e?b.push([c,d]):b[e][1]=d;return this};n.prototype.clear=function(){this.__data__={hash:new m,map:new (ua||k),string:new m}};n.prototype["delete"]=function(c){return D(this,c)["delete"](c)};n.prototype.get=function(c){return D(this,c).get(c)};n.prototype.has=function(c){return D(this,
c).has(c)};n.prototype.set=function(c,d){D(this,c).set(c,d);return this};r.prototype.clear=function(){this.__data__=new k};r.prototype["delete"]=function(c){return this.__data__["delete"](c)};r.prototype.get=function(c){return this.__data__.get(c)};r.prototype.has=function(c){return this.__data__.has(c)};r.prototype.set=function(c,d){var b=this.__data__;if(b instanceof k){b=b.__data__;if(!ua||199>b.length)return b.push([c,d]),this;b=this.__data__=new n(b)}b.set(c,d);return this};var za=P?K(P,Object):
M,va=function(c){return ka.call(c)};if(ra&&"[object DataView]"!=va(new ra(new ArrayBuffer(1)))||ua&&"[object Map]"!=va(new ua)||ma&&"[object Promise]"!=va(ma.resolve())||wa&&"[object Set]"!=va(new wa)||c&&"[object WeakMap]"!=va(new c))va=function(c){var d=ka.call(c);if(c=(c="[object Object]"==d?c.constructor:void 0)?yc(c):void 0)switch(c){case Fa:return"[object DataView]";case Ba:return"[object Map]";case Aa:return"[object Promise]";case Ka:return"[object Set]";case Da:return"[object WeakMap]"}return d};
var ea=Array.isArray,Ea=aa||Y;b.exports=function(c){return w(c,!0,!0)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],37:[function(c,b,d){c="assert count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd time timeEnd trace warn".split(" ");d=c.length;for(var e=function(){},h={};d--;)h[c[d]]=e;b.exports=h},{}],38:[function(c,b,d){function e(c){if(c=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(c)){var d=
parseFloat(c[1]);switch((c[2]||"ms").toLowerCase()){case "years":case "year":case "y":return d*q;case "days":case "day":case "d":return 864E5*d;case "hours":case "hour":case "h":return 36E5*d;case "minutes":case "minute":case "m":return 6E4*d;case "seconds":case "second":case "s":return 1E3*d;case "ms":return d}}}function h(c,d,b){if(!(c<d))return c<1.5*d?Math.floor(c/d)+" "+b:Math.ceil(c/d)+" "+b+"s"}var q=315576E5;b.exports=function(c,d){d=d||{};return"string"==typeof c?e(c):d.long?h(c,864E5,"day")||
h(c,36E5,"hour")||h(c,6E4,"minute")||h(c,1E3,"second")||c+" ms":864E5<=c?Math.round(c/864E5)+"d":36E5<=c?Math.round(c/36E5)+"h":6E4<=c?Math.round(c/6E4)+"m":1E3<=c?Math.round(c/1E3)+"s":c+"ms"}},{}],39:[function(c,b,d){var e=Object.prototype.hasOwnProperty;d.keys=Object.keys||function(c){var d=[],b;for(b in c)e.call(c,b)&&d.push(b);return d};d.values=function(c){var d=[],b;for(b in c)e.call(c,b)&&d.push(c[b]);return d};d.merge=function(c,d){for(var b in d)e.call(d,b)&&(c[b]=d[b]);return c};d.length=
function(c){return d.keys(c).length};d.isEmpty=function(c){return 0==d.length(c)}},{}],40:[function(c,b,d){(function(c){var d=/^[\],:{}\s]*$/,e=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,g=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,p=/(?:^|:|,)(?:\s*\[)+/g,F=/^\s+/,B=/\s+$/;b.exports=function(b){if("string"!=typeof b||!b)return null;b=b.replace(F,"").replace(B,"");if(c.JSON&&JSON.parse)return JSON.parse(b);if(d.test(b.replace(e,"@").replace(g,"]").replace(p,"")))return(new Function("return "+
b))()}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],41:[function(c,b,d){d.encode=function(c){var d="",b;for(b in c)c.hasOwnProperty(b)&&(d.length&&(d+="&"),d+=encodeURIComponent(b)+"="+encodeURIComponent(c[b]));return d};d.decode=function(c){var d={};c=c.split("&");for(var b=0,e=c.length;b<e;b++){var g=c[b].split("=");d[decodeURIComponent(g[0])]=decodeURIComponent(g[1])}return d}},{}],42:[function(c,b,d){var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
h="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");b.exports=function(c){c=e.exec(c||"");for(var d={},b=14;b--;)d[h[b]]=c[b]||"";return d}},{}],43:[function(c,b,d){function e(){throw Error("setTimeout has not been defined");}function h(){throw Error("clearTimeout has not been defined");}function q(c){if(T===setTimeout)return setTimeout(c,0);if((T===e||!T)&&setTimeout)return T=setTimeout,setTimeout(c,0);try{return T(c,0)}catch(Sl){try{return T.call(null,
c,0)}catch(Tl){return T.call(this,c,0)}}}function l(c){if(m===clearTimeout)return clearTimeout(c);if((m===h||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(c);try{return m(c)}catch(Sl){try{return m.call(null,c)}catch(Tl){return m.call(this,c)}}}function p(){n&&r&&(n=!1,r.length?k=r.concat(k):t=-1,k.length&&F())}function F(){if(!n){var c=q(p);n=!0;for(var d=k.length;d;){r=k;for(k=[];++t<d;)r&&r[t].run();t=-1;d=k.length}r=null;n=!1;l(c)}}function B(c,d){this.fun=c;this.array=d}function K(){}c=
b.exports={};try{var T="function"===typeof setTimeout?setTimeout:e}catch(Rl){T=e}try{var m="function"===typeof clearTimeout?clearTimeout:h}catch(Rl){m=h}var k=[],n=!1,r,t=-1;c.nextTick=function(c){var d=Array(arguments.length-1);if(1<arguments.length)for(var b=1;b<arguments.length;b++)d[b-1]=arguments[b];k.push(new B(c,d));1!==k.length||n||q(F)};B.prototype.run=function(){this.fun.apply(null,this.array)};c.title="browser";c.browser=!0;c.env={};c.argv=[];c.version="";c.versions={};c.on=K;c.addListener=
K;c.once=K;c.off=K;c.removeListener=K;c.removeAllListeners=K;c.emit=K;c.prependListener=K;c.prependOnceListener=K;c.listeners=function(c){return[]};c.binding=function(c){throw Error("process.binding is not supported");};c.cwd=function(){return"/"};c.chdir=function(c){throw Error("process.chdir is not supported");};c.umask=function(){return 0}},{}],44:[function(c,b,d){function e(c,d){var b=this,e;q.call(this);c=c||{};c.iceServers=c.iceServers||[];this.enableChromeNativeSimulcast=!1;d&&d.optional&&
window.chrome&&null===navigator.appVersion.match(/Chromium\//)&&d.optional.forEach(function(c){c.enableChromeNativeSimulcast&&(b.enableChromeNativeSimulcast=!0)});this.enableMultiStreamHacks=!1;d&&d.optional&&window.chrome&&d.optional.forEach(function(c){c.enableMultiStreamHacks&&(b.enableMultiStreamHacks=!0)});this.restrictBandwidth=0;d&&d.optional&&d.optional.forEach(function(c){c.andyetRestrictBandwidth&&(b.restrictBandwidth=c.andyetRestrictBandwidth)});this.batchIceCandidates=0;d&&d.optional&&
d.optional.forEach(function(c){c.andyetBatchIce&&(b.batchIceCandidates=c.andyetBatchIce)});this.batchedIceCandidates=[];d&&d.optional&&window.chrome&&d.optional.forEach(function(c){c.andyetFasterICE&&(b.eliminateDuplicateCandidates=c.andyetFasterICE)});d&&d.optional&&d.optional.forEach(function(c){c.andyetDontSignalCandidates&&(b.dontSignalCandidates=c.andyetDontSignalCandidates)});this.assumeSetLocalSuccess=!1;d&&d.optional&&d.optional.forEach(function(c){c.andyetAssumeSetLocalSuccess&&(b.assumeSetLocalSuccess=
c.andyetAssumeSetLocalSuccess)});window.navigator.mozGetUserMedia&&d&&d.optional&&(this.wtFirefox=0,d.optional.forEach(function(c){c.andyetFirefoxMakesMeSad&&(b.wtFirefox=c.andyetFirefoxMakesMeSad,0<b.wtFirefox&&(b.firefoxcandidatebuffer=[]))}));this.pc=new RTCPeerConnection(c,d);this.getLocalStreams="function"===typeof this.pc.getLocalStreams?this.pc.getLocalStreams.bind(this.pc):function(){return[]};this.getSenders="function"===typeof this.pc.getSenders?this.pc.getSenders.bind(this.pc):function(){return[]};
this.getRemoteStreams="function"===typeof this.pc.getRemoteStreams?this.pc.getRemoteStreams.bind(this.pc):function(){return[]};this.getReceivers="function"===typeof this.pc.getReceivers?this.pc.getReceivers.bind(this.pc):function(){return[]};this.addStream=this.pc.addStream.bind(this.pc);this.removeStream=function(c){"function"===typeof b.pc.removeStream?b.pc.removeStream.apply(b.pc,arguments):"function"===typeof b.pc.removeTrack&&c.getTracks().forEach(function(c){b.pc.removeTrack(c)})};"function"===
typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc));this.pc.onremovestream=this.emit.bind(this,"removeStream");this.pc.onremovetrack=this.emit.bind(this,"removeTrack");this.pc.onaddstream=this.emit.bind(this,"addStream");this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded");this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange");this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange");this.pc.onicecandidate=this._onIce.bind(this);
this.pc.ondatachannel=this._onDataChannel.bind(this);this.localDescription={contents:[]};this.remoteDescription={contents:[]};this.config={debug:!1,sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1};this.iceCredentials={local:{},remote:{}};for(e in c)this.config[e]=c[e];if(this.config.debug)this.on("*",function(){(c.logger||console).log("PeerConnection event:",arguments)});this.hadRemoteIPv6Candidate=this.hadLocalIPv6Candidate=this.hadRemoteRelayCandidate=this.hadLocalRelayCandidate=this.hadRemoteStunCandidate=
this.hadLocalStunCandidate=!1;this._remoteDataChannels=[];this._localDataChannels=[];this._candidateBuffer=[]}d=c("util");var h=c("sdp-jingle-json"),q=c("wildemitter"),l=c("lodash.clonedeep");d.inherits(e,q);Object.defineProperty(e.prototype,"signalingState",{get:function(){return this.pc.signalingState}});Object.defineProperty(e.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}});e.prototype._role=function(){return this.isInitiator?"initiator":"responder"};e.prototype.addStream=
function(c){this.localStream=c;this.pc.addStream(c)};e.prototype._checkLocalCandidate=function(c){c=h.toCandidateJSON(c);"srflx"==c.type?this.hadLocalStunCandidate=!0:"relay"==c.type&&(this.hadLocalRelayCandidate=!0);-1!=c.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)};e.prototype._checkRemoteCandidate=function(c){c=h.toCandidateJSON(c);"srflx"==c.type?this.hadRemoteStunCandidate=!0:"relay"==c.type&&(this.hadRemoteRelayCandidate=!0);-1!=c.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)};e.prototype.processIce=
function(c,d){d=d||function(){};var b=this;if("closed"===this.pc.signalingState)return d();if(c.contents||c.jingle&&c.jingle.contents){var e=this.remoteDescription.contents.map(function(c){return c.name});(c.contents||c.jingle.contents).forEach(function(c){var g=c.transport||{},l=g.candidates||[],q=e.indexOf(c.name),p=c.name,B=b.remoteDescription.contents.find(function(d){return d.name===c.name}),F=function(){l.forEach(function(c){c=h.toCandidateSDP(c);b.pc.addIceCandidate(new RTCIceCandidate({candidate:c,
sdpMLineIndex:q,sdpMid:p}),function(){},function(c){b.emit("error",c)});b._checkRemoteCandidate(c)});d()};b.iceCredentials.remote[c.name]&&g.ufrag&&b.iceCredentials.remote[c.name].ufrag!==g.ufrag?B?(B.transport.ufrag=g.ufrag,B.transport.pwd=g.pwd,g={type:"offer",jingle:b.remoteDescription},g.sdp=h.toSessionSDP(g.jingle,{sid:b.config.sdpSessionID,role:b._role(),direction:"incoming"}),b.pc.setRemoteDescription(new RTCSessionDescription(g),function(){F()},function(c){b.emit("error",c)})):b.emit("error",
"ice restart failed to find matching content"):F()})}else{c.candidate&&0!==c.candidate.candidate.indexOf("a=")&&(c.candidate.candidate="a="+c.candidate.candidate);if(this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(c.candidate),d();b.pc.addIceCandidate(new RTCIceCandidate(c.candidate),function(){},function(c){b.emit("error",c)});b._checkRemoteCandidate(c.candidate.candidate);d()}};e.prototype.offer=
function(c,d){var b=this,e=2===arguments.length,g=e&&c?c:{offerToReceiveAudio:1,offerToReceiveVideo:1};d=(d=e?d:c)||function(){};if("closed"===this.pc.signalingState)return d("Already closed");this.pc.createOffer(function(c){var e={type:"offer",sdp:c.sdp};b.assumeSetLocalSuccess&&(b.emit("offer",e),d(null,e));b._candidateBuffer=[];b.pc.setLocalDescription(c,function(){if(b.config.useJingle){var g=h.toSessionJSON(c.sdp,{role:b._role(),direction:"outgoing"});g.sid=b.config.sid;b.localDescription=g;
g.contents.forEach(function(c){var d=c.transport||{};d.ufrag&&(b.iceCredentials.local[c.name]={ufrag:d.ufrag,pwd:d.pwd})});e.jingle=g}e.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&b._checkLocalCandidate(c)});b.assumeSetLocalSuccess||(b.emit("offer",e),d(null,e))},function(c){b.emit("error",c);d(c)})},function(c){b.emit("error",c);d(c)},g)};e.prototype.handleOffer=function(c,d){d=d||function(){};var b=this;c.type="offer";if(c.jingle){this.enableChromeNativeSimulcast&&c.jingle.contents.forEach(function(c){"video"===
c.name&&(c.application.googConferenceFlag=!0)});this.enableMultiStreamHacks&&c.jingle.contents.forEach(function(c){if("video"===c.name){var d=c.application.sources||[];if(0===d.length||"3735928559"!==d[0].ssrc)d.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),c.application.sources=d}});if(0<b.restrictBandwidth&&2<=c.jingle.contents.length&&"video"===c.jingle.contents[1].name){var e=c.jingle.contents[1];e.application&&e.application.bandwidth&&
e.application.bandwidth.bandwidth||(c.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:b.restrictBandwidth.toString()},c.sdp=h.toSessionSDP(c.jingle,{sid:b.config.sdpSessionID,role:b._role(),direction:"outgoing"}))}c.jingle.contents.forEach(function(c){var d=c.transport||{};d.ufrag&&(b.iceCredentials.remote[c.name]={ufrag:d.ufrag,pwd:d.pwd})});c.sdp=h.toSessionSDP(c.jingle,{sid:b.config.sdpSessionID,role:b._role(),direction:"incoming"});b.remoteDescription=c.jingle}c.sdp.split("\r\n").forEach(function(c){0===
c.indexOf("a=candidate:")&&b._checkRemoteCandidate(c)});b.pc.setRemoteDescription(new RTCSessionDescription(c),function(){d()},d)};e.prototype.answerAudioOnly=function(c){this._answer({mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},c)};e.prototype.answerBroadcastOnly=function(c){this._answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},c)};e.prototype.answer=function(c,d){var b=2===arguments.length;this._answer(b&&c?c:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},
b?d:c)};e.prototype.handleAnswer=function(c,d){d=d||function(){};var b=this;c.jingle&&(c.sdp=h.toSessionSDP(c.jingle,{sid:b.config.sdpSessionID,role:b._role(),direction:"incoming"}),b.remoteDescription=c.jingle,c.jingle.contents.forEach(function(c){var d=c.transport||{};d.ufrag&&(b.iceCredentials.remote[c.name]={ufrag:d.ufrag,pwd:d.pwd})}));c.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&b._checkRemoteCandidate(c)});b.pc.setRemoteDescription(new RTCSessionDescription(c),function(){b.wtFirefox&&
window.setTimeout(function(){b.firefoxcandidatebuffer.forEach(function(c){b.pc.addIceCandidate(new RTCIceCandidate(c),function(){},function(c){b.emit("error",c)});b._checkRemoteCandidate(c.candidate)});b.firefoxcandidatebuffer=null},b.wtFirefox);d(null)},d)};e.prototype.close=function(){this.pc.close();this._localDataChannels=[];this._remoteDataChannels=[];this.emit("close")};e.prototype._answer=function(c,d){d=d||function(){};var b=this;if(!this.pc.remoteDescription)throw Error("remoteDescription not set");
if("closed"===this.pc.signalingState)return d("Already closed");b.pc.createAnswer(function(c){var e=[];if(b.enableChromeNativeSimulcast&&(c.jingle=h.toSessionJSON(c.sdp,{role:b._role(),direction:"outgoing"}),2<=c.jingle.contents.length&&"video"===c.jingle.contents[1].name)){var g=c.jingle.contents[1].application.sourceGroups||[],q=!1;g.forEach(function(c){"SIM"==c.semantics&&(q=!0)});if(!q&&c.jingle.contents[1].application.sources.length){var p=JSON.parse(JSON.stringify(c.jingle.contents[1].application.sources[0]));
p.ssrc=""+Math.floor(4294967295*Math.random());c.jingle.contents[1].application.sources.push(p);e.push(c.jingle.contents[1].application.sources[0].ssrc);e.push(p.ssrc);g.push({semantics:"SIM",sources:e});e=JSON.parse(JSON.stringify(p));e.ssrc=""+Math.floor(4294967295*Math.random());c.jingle.contents[1].application.sources.push(e);g.push({semantics:"FID",sources:[p.ssrc,e.ssrc]});c.jingle.contents[1].application.sourceGroups=g;c.sdp=h.toSessionSDP(c.jingle,{sid:b.config.sdpSessionID,role:b._role(),
direction:"outgoing"})}}var F={type:"answer",sdp:c.sdp};b.assumeSetLocalSuccess&&(g=l(F),b.emit("answer",g),d(null,g));b._candidateBuffer=[];b.pc.setLocalDescription(c,function(){if(b.config.useJingle){var e=h.toSessionJSON(c.sdp,{role:b._role(),direction:"outgoing"});e.sid=b.config.sid;b.localDescription=e;F.jingle=e}b.enableChromeNativeSimulcast&&(F.jingle||(F.jingle=h.toSessionJSON(c.sdp,{role:b._role(),direction:"outgoing"})),F.jingle.contents[1].application.sources.forEach(function(c,d){c.parameters=
c.parameters.map(function(c){"msid"===c.key&&(c.value+="-"+Math.floor(d/2));return c})}),F.sdp=h.toSessionSDP(F.jingle,{sid:b.sdpSessionID,role:b._role(),direction:"outgoing"}));F.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&b._checkLocalCandidate(c)});b.assumeSetLocalSuccess||(e=l(F),b.emit("answer",e),d(null,e))},function(c){b.emit("error",c);d(c)})},function(c){b.emit("error",c);d(c)},c)};e.prototype._onIce=function(c){var d=this;if(c.candidate){if(!this.dontSignalCandidates){c=
c.candidate;var b={candidate:{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex}};this._checkLocalCandidate(c.candidate);var e=h.toCandidateJSON(c.candidate);if(this.eliminateDuplicateCandidates&&"relay"===e.type){var g=this._candidateBuffer.filter(function(c){return"relay"===c.type}).map(function(c){return c.foundation+":"+c.component});var l=g.indexOf(e.foundation+":"+e.component);if(-1<l&&e.priority>>24>=g[l].priority>>24)return}if("max-bundle"===this.config.bundlePolicy&&(g=
this._candidateBuffer.filter(function(c){return e.type===c.type}).map(function(c){return c.address+":"+c.port}),l=g.indexOf(e.address+":"+e.port),-1<l))return;if("require"!==this.config.rtcpMuxPolicy||"2"!==e.component){this._candidateBuffer.push(e);if(d.config.useJingle&&(c.sdpMid||(c.sdpMid=d.pc.remoteDescription&&"offer"===d.pc.remoteDescription.type?d.remoteDescription.contents[c.sdpMLineIndex].name:d.localDescription.contents[c.sdpMLineIndex].name),d.iceCredentials.local[c.sdpMid]||h.toSessionJSON(d.pc.localDescription.sdp,
{role:d._role(),direction:"outgoing"}).contents.forEach(function(c){var b=c.transport||{};b.ufrag&&(d.iceCredentials.local[c.name]={ufrag:b.ufrag,pwd:b.pwd})}),b.jingle={contents:[{name:c.sdpMid,creator:d._role(),transport:{transportType:"iceUdp",ufrag:d.iceCredentials.local[c.sdpMid].ufrag,pwd:d.iceCredentials.local[c.sdpMid].pwd,candidates:[e]}}]},0<d.batchIceCandidates)){0===d.batchedIceCandidates.length&&window.setTimeout(function(){var c={};d.batchedIceCandidates.forEach(function(d){d=d.contents[0];
c[d.name]||(c[d.name]=d);c[d.name].transport.candidates.push(d.transport.candidates[0])});var b={jingle:{contents:[]}};Object.keys(c).forEach(function(d){b.jingle.contents.push(c[d])});d.batchedIceCandidates=[];d.emit("ice",b)},d.batchIceCandidates);d.batchedIceCandidates.push(b.jingle);return}this.emit("ice",b)}}}else this.emit("endOfCandidates")};e.prototype._onDataChannel=function(c){c=c.channel;this._remoteDataChannels.push(c);this.emit("addChannel",c)};e.prototype.createDataChannel=function(c,
d){c=this.pc.createDataChannel(c,d);this._localDataChannels.push(c);return c};e.prototype.getStats=function(){if("function"===typeof arguments[0]){var c=arguments[0];this.pc.getStats().then(function(d){c(null,d)},function(d){c(d)})}else return this.pc.getStats.apply(this.pc,arguments)};b.exports=e},{"lodash.clonedeep":36,"sdp-jingle-json":45,util:63,wildemitter:65}],45:[function(c,b,d){var e=c("./lib/tosdp"),h=c("./lib/tojson");d.toIncomingSDPOffer=function(c){return e.toSessionSDP(c,{role:"responder",
direction:"incoming"})};d.toOutgoingSDPOffer=function(c){return e.toSessionSDP(c,{role:"initiator",direction:"outgoing"})};d.toIncomingSDPAnswer=function(c){return e.toSessionSDP(c,{role:"initiator",direction:"incoming"})};d.toOutgoingSDPAnswer=function(c){return e.toSessionSDP(c,{role:"responder",direction:"outgoing"})};d.toIncomingMediaSDPOffer=function(c){return e.toMediaSDP(c,{role:"responder",direction:"incoming"})};d.toOutgoingMediaSDPOffer=function(c){return e.toMediaSDP(c,{role:"initiator",
direction:"outgoing"})};d.toIncomingMediaSDPAnswer=function(c){return e.toMediaSDP(c,{role:"initiator",direction:"incoming"})};d.toOutgoingMediaSDPAnswer=function(c){return e.toMediaSDP(c,{role:"responder",direction:"outgoing"})};d.toCandidateSDP=e.toCandidateSDP;d.toMediaSDP=e.toMediaSDP;d.toSessionSDP=e.toSessionSDP;d.toIncomingJSONOffer=function(c,d){return h.toSessionJSON(c,{role:"responder",direction:"incoming",creators:d})};d.toOutgoingJSONOffer=function(c,d){return h.toSessionJSON(c,{role:"initiator",
direction:"outgoing",creators:d})};d.toIncomingJSONAnswer=function(c,d){return h.toSessionJSON(c,{role:"initiator",direction:"incoming",creators:d})};d.toOutgoingJSONAnswer=function(c,d){return h.toSessionJSON(c,{role:"responder",direction:"outgoing",creators:d})};d.toIncomingMediaJSONOffer=function(c,d){return h.toMediaJSON(c,{role:"responder",direction:"incoming",creator:d})};d.toOutgoingMediaJSONOffer=function(c,d){return h.toMediaJSON(c,{role:"initiator",direction:"outgoing",creator:d})};d.toIncomingMediaJSONAnswer=
function(c,d){return h.toMediaJSON(c,{role:"initiator",direction:"incoming",creator:d})};d.toOutgoingMediaJSONAnswer=function(c,d){return h.toMediaJSON(c,{role:"responder",direction:"outgoing",creator:d})};d.toCandidateJSON=h.toCandidateJSON;d.toMediaJSON=h.toMediaJSON;d.toSessionJSON=h.toSessionJSON},{"./lib/tojson":48,"./lib/tosdp":49}],46:[function(c,b,d){d.lines=function(c){return c.split("\r\n").filter(function(c){return 0<c.length})};d.findLine=function(c,d,b){for(var e=c.length,g=0;g<d.length;g++)if(d[g].substr(0,
e)===c)return d[g];if(!b)return!1;for(d=0;d<b.length;d++)if(b[d].substr(0,e)===c)return b[d];return!1};d.findLines=function(c,d,b){for(var e=[],g=c.length,h=0;h<d.length;h++)d[h].substr(0,g)===c&&e.push(d[h]);if(e.length||!b)return e;for(d=0;d<b.length;d++)b[d].substr(0,g)===c&&e.push(b[d]);return e};d.mline=function(c){c=c.substr(2).split(" ");for(var d={media:c[0],port:c[1],proto:c[2],formats:[]},b=3;b<c.length;b++)c[b]&&d.formats.push(c[b]);return d};d.rtpmap=function(c){c=c.substr(9).split(" ");
var d={id:c.shift()};c=c[0].split("/");d.name=c[0];d.clockrate=c[1];d.channels=3==c.length?c[2]:"1";return d};d.sctpmap=function(c){c=c.substr(10).split(" ");return{number:c.shift(),protocol:c.shift(),streams:c.shift()}};d.fmtp=function(c){for(var d,b=c.substr(c.indexOf(" ")+1).split(";"),e=[],g=0;g<b.length;g++)d=b[g].split("="),c=d[0].trim(),d=d[1],c&&d?e.push({key:c,value:d}):c&&e.push({key:"",value:c});return e};d.crypto=function(c){c=c.substr(9).split(" ");return{tag:c[0],cipherSuite:c[1],keyParams:c[2],
sessionParams:c.slice(3).join(" ")}};d.fingerprint=function(c){c=c.substr(14).split(" ");return{hash:c[0],value:c[1]}};d.extmap=function(c){c=c.substr(9).split(" ");var d={},b=c.shift(),e=b.indexOf("/");0<=e?(d.id=b.substr(0,e),d.senders=b.substr(e+1)):(d.id=b,d.senders="sendrecv");d.uri=c.shift()||"";return d};d.rtcpfb=function(c){c=c.substr(10).split(" ");var d={};d.id=c.shift();d.type=c.shift();"trr-int"===d.type?d.value=c.shift():d.subtype=c.shift()||"";d.parameters=c;return d};d.candidate=function(c){c=
0===c.indexOf("a=candidate:")?c.substring(12).split(" "):c.substring(10).split(" ");for(var d={foundation:c[0],component:c[1],protocol:c[2].toLowerCase(),priority:c[3],ip:c[4],port:c[5],type:c[7],generation:"0"},b=8;b<c.length;b+=2)"raddr"===c[b]?d.relAddr=c[b+1]:"rport"===c[b]?d.relPort=c[b+1]:"generation"===c[b]?d.generation=c[b+1]:"tcptype"===c[b]&&(d.tcpType=c[b+1]);d.network="1";return d};d.sourceGroups=function(c){for(var d=[],b=0;b<c.length;b++){var e=c[b].substr(13).split(" ");d.push({semantics:e.shift(),
sources:e})}return d};d.sources=function(c){for(var d=[],b={},e=0;e<c.length;e++){var g=c[e].substr(7).split(" "),F=g.shift();if(!b[F]){var B={ssrc:F,parameters:[]};d.push(B);b[F]=B}g=g.join(" ").split(":");B=g.shift();g=g.join(":")||null;b[F].parameters.push({key:B,value:g})}return d};d.groups=function(c){for(var d=[],b,e=0;e<c.length;e++)b=c[e].substr(8).split(" "),d.push({semantics:b.shift(),contents:b});return d};d.bandwidth=function(c){c=c.substr(2).split(":");var d={};d.type=c.shift();d.bandwidth=
c.shift();return d};d.msid=function(c){c=c.substr(7);var d=c.split(" ");return{msid:c,mslabel:d[0],label:d[1]}}},{}],47:[function(c,b,d){b.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",
responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],48:[function(c,b,d){var e=c("./senders"),h=c("./parsers"),q=Math.random();d._setIdCounter=function(c){q=c};d.toSessionJSON=function(c,b){var e,g=b.creators||[],l=b.role||"initiator";b=b.direction||"outgoing";
var q=c.split("\r\nm=");for(e=1;e<q.length;e++)q[e]="m="+q[e],e!==q.length-1&&(q[e]+="\r\n");var p=q.shift()+"\r\n",m=h.lines(p);c={};var k=[];for(e=0;e<q.length;e++)k.push(d.toMediaJSON(q[e],p,{role:l,direction:b,creator:g[e]||"initiator"}));c.contents=k;g=h.findLines("a=group:",m);g.length&&(c.groups=h.groups(g));return c};d.toMediaJSON=function(c,b,g){var l=g.creator||"initiator",q=g.role||"initiator",p=g.direction||"outgoing",F=h.lines(c);c=h.lines(b);b=h.mline(F[0]);l={creator:l,name:b.media,
application:{applicationType:"rtp",media:b.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==b.media&&(l.application={applicationType:"datachannel"},l.transport.sctp=[]);var m=l.application,k=l.transport;if(b=h.findLine("a=mid:",F))l.name=b.substr(6);h.findLine("a=sendrecv",F,c)?l.senders="both":h.findLine("a=sendonly",F,c)?l.senders=e[q][p].sendonly:h.findLine("a=recvonly",F,c)?l.senders=e[q][p].recvonly:
h.findLine("a=inactive",F,c)&&(l.senders="none");if("rtp"==m.applicationType){if(b=h.findLine("b=",F))m.bandwidth=h.bandwidth(b);if(b=h.findLine("a=ssrc:",F))m.ssrc=b.substr(7).split(" ")[0];h.findLines("a=rtpmap:",F).forEach(function(c){var d=h.rtpmap(c);d.parameters=[];d.feedback=[];h.findLines("a=fmtp:"+d.id,F).forEach(function(c){d.parameters=h.fmtp(c)});h.findLines("a=rtcp-fb:"+d.id,F).forEach(function(c){d.feedback.push(h.rtcpfb(c))});m.payloads.push(d)});h.findLines("a=crypto:",F,c).forEach(function(c){m.encryption.push(h.crypto(c))});
h.findLine("a=rtcp-mux",F)&&(m.mux=!0);h.findLines("a=rtcp-fb:*",F).forEach(function(c){m.feedback.push(h.rtcpfb(c))});h.findLines("a=extmap:",F).forEach(function(c){c=h.extmap(c);c.senders=e[q][p][c.senders];m.headerExtensions.push(c)});b=h.findLines("a=ssrc-group:",F);m.sourceGroups=h.sourceGroups(b||[]);b=h.findLines("a=ssrc:",F);var n=m.sources=h.sources(b||[]);if(b=h.findLine("a=msid:",F)){var r=h.msid(b);["msid","mslabel","label"].forEach(function(c){for(var d=0;d<n.length;d++){for(var b=!1,
e=0;e<n[d].parameters.length;e++)n[d].parameters[e].key===c&&(b=!0);b||n[d].parameters.push({key:c,value:r[c]})}})}h.findLine("a=x-google-flag:conference",F,c)&&(m.googConferenceFlag=!0)}b=h.findLines("a=fingerprint:",F,c);var t=h.findLine("a=setup:",F,c);b.forEach(function(c){c=h.fingerprint(c);t&&(c.setup=t.substr(8));k.fingerprints.push(c)});b=h.findLine("a=ice-ufrag:",F,c);g=h.findLine("a=ice-pwd:",F,c);b&&g&&(k.ufrag=b.substr(12),k.pwd=g.substr(10),k.candidates=[],h.findLines("a=candidate:",
F,c).forEach(function(c){k.candidates.push(d.toCandidateJSON(c))}));"datachannel"==m.applicationType&&h.findLines("a=sctpmap:",F).forEach(function(c){c=h.sctpmap(c);k.sctp.push(c)});return l};d.toCandidateJSON=function(c){c=h.candidate(c.split("\r\n")[0]);c.id=(q++).toString(36).substr(0,12);return c}},{"./parsers":46,"./senders":47}],49:[function(c,b,d){var e=c("./senders");d.toSessionSDP=function(c,b){var e=b.sid||c.sid||Date.now(),g=b.time||Date.now(),h=["v=0","o=- "+e+" "+g+" IN IP4 0.0.0.0",
"s=-","t=0 0"];e=c.contents||[];var q=!1;e.forEach(function(c){c.application.sources&&c.application.sources.length&&(q=!0)});q&&h.push("a=msid-semantic: WMS *");(c.groups||[]).forEach(function(c){h.push("a=group:"+c.semantics+" "+c.contents.join(" "))});e.forEach(function(c){h.push(d.toMediaSDP(c,b))});return h.join("\r\n")+"\r\n"};d.toMediaSDP=function(c,b){var g=[],h=b.role||"initiator",q=b.direction||"outgoing",B=c.application;b=c.transport;var K=B.payloads||[],m=b&&b.fingerprints||[],k=[];"datachannel"==
B.applicationType?(k.push("application"),k.push("1"),k.push("DTLS/SCTP"),b.sctp&&b.sctp.forEach(function(c){k.push(c.number)})):(k.push(B.media),k.push("1"),0<m.length?k.push("UDP/TLS/RTP/SAVPF"):B.encryption&&0<B.encryption.length?k.push("RTP/SAVPF"):k.push("RTP/AVPF"),K.forEach(function(c){k.push(c.id)}));g.push("m="+k.join(" "));g.push("c=IN IP4 0.0.0.0");B.bandwidth&&B.bandwidth.type&&B.bandwidth.bandwidth&&g.push("b="+B.bandwidth.type+":"+B.bandwidth.bandwidth);"rtp"==B.applicationType&&g.push("a=rtcp:1 IN IP4 0.0.0.0");
b&&(b.ufrag&&g.push("a=ice-ufrag:"+b.ufrag),b.pwd&&g.push("a=ice-pwd:"+b.pwd),m.forEach(function(c){g.push("a=fingerprint:"+c.hash+" "+c.value);c.setup&&g.push("a=setup:"+c.setup)}),b.sctp&&b.sctp.forEach(function(c){g.push("a=sctpmap:"+c.number+" "+c.protocol+" "+c.streams)}));"rtp"==B.applicationType&&g.push("a="+(e[h][q][c.senders]||"sendrecv"));g.push("a=mid:"+c.name);B.sources&&B.sources.length&&(B.sources[0].parameters||[]).forEach(function(c){"msid"===c.key&&g.push("a=msid:"+c.value)});B.mux&&
g.push("a=rtcp-mux");(B.encryption||[]).forEach(function(c){g.push("a=crypto:"+c.tag+" "+c.cipherSuite+" "+c.keyParams+(c.sessionParams?" "+c.sessionParams:""))});B.googConferenceFlag&&g.push("a=x-google-flag:conference");K.forEach(function(c){var d="a=rtpmap:"+c.id+" "+c.name+"/"+c.clockrate;c.channels&&"1"!=c.channels&&(d+="/"+c.channels);g.push(d);if(c.parameters&&c.parameters.length){d=["a=fmtp:"+c.id];var b=[];c.parameters.forEach(function(c){b.push((c.key?c.key+"=":"")+c.value)});d.push(b.join(";"));
g.push(d.join(" "))}c.feedback&&c.feedback.forEach(function(d){"trr-int"===d.type?g.push("a=rtcp-fb:"+c.id+" trr-int "+(d.value?d.value:"0")):g.push("a=rtcp-fb:"+c.id+" "+d.type+(d.subtype?" "+d.subtype:""))})});B.feedback&&B.feedback.forEach(function(c){"trr-int"===c.type?g.push("a=rtcp-fb:* trr-int "+(c.value?c.value:"0")):g.push("a=rtcp-fb:* "+c.type+(c.subtype?" "+c.subtype:""))});(B.headerExtensions||[]).forEach(function(c){g.push("a=extmap:"+c.id+(c.senders?"/"+e[h][q][c.senders]:"")+" "+c.uri)});
(B.sourceGroups||[]).forEach(function(c){g.push("a=ssrc-group:"+c.semantics+" "+c.sources.join(" "))});(B.sources||[]).forEach(function(c){for(var d=0;d<c.parameters.length;d++){var b=c.parameters[d];g.push("a=ssrc:"+(c.ssrc||B.ssrc)+" "+b.key+(b.value?":"+b.value:""))}});(b.candidates||[]).forEach(function(c){g.push(d.toCandidateSDP(c))});return g.join("\r\n")};d.toCandidateSDP=function(c){var d=[];d.push(c.foundation);d.push(c.component);d.push(c.protocol.toUpperCase());d.push(c.priority);d.push(c.ip);
d.push(c.port);var b=c.type;d.push("typ");d.push(b);("srflx"===b||"prflx"===b||"relay"===b)&&c.relAddr&&c.relPort&&(d.push("raddr"),d.push(c.relAddr),d.push("rport"),d.push(c.relPort));c.tcpType&&"TCP"==c.protocol.toUpperCase()&&(d.push("tcptype"),d.push(c.tcpType));d.push("generation");d.push(c.generation||"0");return"a=candidate:"+d.join(" ")}},{"./senders":47}],50:[function(c,b,d){b.exports=c("./lib/")},{"./lib/":51}],51:[function(c,b,d){function e(c,d){"object"==typeof c&&(d=c,c=void 0);d=d||
{};c=h(c);var b=c.source,e=c.id;d.forceNew||d["force new connection"]||!1===d.multiplex?(p("ignoring socket cache for %s",b),d=l(b,d)):(F[e]||(p("new io instance for %s",b),F[e]=l(b,d)),d=F[e]);return d.socket(c.path)}var h=c("./url"),q=c("socket.io-parser"),l=c("./manager"),p=c("debug")("socket.io-client");b.exports=d=e;var F=d.managers={};d.protocol=q.protocol;d.connect=e;d.Manager=c("./manager");d.Socket=c("./socket")},{"./manager":52,"./socket":54,"./url":55,debug:10,"socket.io-parser":57}],52:[function(c,
b,d){function e(c,d){if(!(this instanceof e))return new e(c,d);c&&"object"==typeof c&&(d=c,c=void 0);d=d||{};d.path=d.path||"/socket.io";this.nsps={};this.subs=[];this.opts=d;this.reconnection(!1!==d.reconnection);this.reconnectionAttempts(d.reconnectionAttempts||Infinity);this.reconnectionDelay(d.reconnectionDelay||1E3);this.reconnectionDelayMax(d.reconnectionDelayMax||5E3);this.randomizationFactor(d.randomizationFactor||.5);this.backoff=new k({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),
jitter:this.randomizationFactor()});this.timeout(null==d.timeout?2E4:d.timeout);this.readyState="closed";this.uri=c;this.connected=[];this.encoding=!1;this.packetBuffer=[];this.encoder=new l.Encoder;this.decoder=new l.Decoder;(this.autoConnect=!1!==d.autoConnect)&&this.open()}c("./url");var h=c("engine.io-client"),q=c("./socket");d=c("component-emitter");var l=c("socket.io-parser"),p=c("./on"),F=c("component-bind");c("object-component");var B=c("debug")("socket.io-client:manager"),m=c("indexof"),
k=c("backo2");b.exports=e;e.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var c in this.nsps)this.nsps[c].emit.apply(this.nsps[c],arguments)};e.prototype.updateSocketIds=function(){for(var c in this.nsps)this.nsps[c].id=this.engine.id};d(e.prototype);e.prototype.reconnection=function(c){if(!arguments.length)return this._reconnection;this._reconnection=!!c;return this};e.prototype.reconnectionAttempts=function(c){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=
c;return this};e.prototype.reconnectionDelay=function(c){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=c;this.backoff&&this.backoff.setMin(c);return this};e.prototype.randomizationFactor=function(c){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=c;this.backoff&&this.backoff.setJitter(c);return this};e.prototype.reconnectionDelayMax=function(c){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=c;this.backoff&&
this.backoff.setMax(c);return this};e.prototype.timeout=function(c){if(!arguments.length)return this._timeout;this._timeout=c;return this};e.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};e.prototype.open=e.prototype.connect=function(c){B("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;B("opening %s",this.uri);var d=this.engine=h(this.uri,this.opts),b=this;this.readyState="opening";this.skipReconnect=
!1;var e=p(d,"open",function(){b.onopen();c&&c()}),g=p(d,"error",function(d){B("connect_error");b.cleanup();b.readyState="closed";b.emitAll("connect_error",d);if(c){var e=Error("Connection error");e.data=d;c(e)}else b.maybeReconnectOnOpen()});if(!1!==this._timeout){var l=this._timeout;B("connect attempt will timeout after %d",l);var q=setTimeout(function(){B("connect attempt timed out after %d",l);e.destroy();d.close();d.emit("error","timeout");b.emitAll("connect_timeout",l)},l);this.subs.push({destroy:function(){clearTimeout(q)}})}this.subs.push(e);
this.subs.push(g);return this};e.prototype.onopen=function(){B("open");this.cleanup();this.readyState="open";this.emit("open");var c=this.engine;this.subs.push(p(c,"data",F(this,"ondata")));this.subs.push(p(this.decoder,"decoded",F(this,"ondecoded")));this.subs.push(p(c,"error",F(this,"onerror")));this.subs.push(p(c,"close",F(this,"onclose")))};e.prototype.ondata=function(c){this.decoder.add(c)};e.prototype.ondecoded=function(c){this.emit("packet",c)};e.prototype.onerror=function(c){B("error",c);
this.emitAll("error",c)};e.prototype.socket=function(c){var d=this.nsps[c];if(!d){d=new q(this,c);this.nsps[c]=d;var b=this;d.on("connect",function(){d.id=b.engine.id;~m(b.connected,d)||b.connected.push(d)})}return d};e.prototype.destroy=function(c){c=m(this.connected,c);~c&&this.connected.splice(c,1);this.connected.length||this.close()};e.prototype.packet=function(c){B("writing packet %j",c);var d=this;d.encoding?d.packetBuffer.push(c):(d.encoding=!0,this.encoder.encode(c,function(c){for(var b=0;b<
c.length;b++)d.engine.write(c[b]);d.encoding=!1;d.processPacketQueue()}))};e.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var c=this.packetBuffer.shift();this.packet(c)}};e.prototype.cleanup=function(){for(var c;c=this.subs.shift();)c.destroy();this.packetBuffer=[];this.encoding=!1;this.decoder.destroy()};e.prototype.close=e.prototype.disconnect=function(){this.skipReconnect=!0;this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};
e.prototype.onclose=function(c){B("close");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",c);this._reconnection&&!this.skipReconnect&&this.reconnect()};e.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var c=this;if(this.backoff.attempts>=this._reconnectionAttempts)B("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var d=this.backoff.duration();B("will wait %dms before reconnect attempt",
d);this.reconnecting=!0;var b=setTimeout(function(){c.skipReconnect||(B("attempting reconnect"),c.emitAll("reconnect_attempt",c.backoff.attempts),c.emitAll("reconnecting",c.backoff.attempts),c.skipReconnect||c.open(function(d){d?(B("reconnect attempt error"),c.reconnecting=!1,c.reconnect(),c.emitAll("reconnect_error",d.data)):(B("reconnect success"),c.onreconnect())}))},d);this.subs.push({destroy:function(){clearTimeout(b)}})}};e.prototype.onreconnect=function(){var c=this.backoff.attempts;this.reconnecting=
!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",c)}},{"./on":53,"./socket":54,"./url":55,backo2:4,"component-bind":7,"component-emitter":8,debug:10,"engine.io-client":11,indexof:32,"object-component":39,"socket.io-parser":57}],53:[function(c,b,d){b.exports=function(c,d,b){c.on(d,b);return{destroy:function(){c.removeListener(d,b)}}}},{}],54:[function(c,b,d){function e(c,d){this.io=c;this.nsp=d;this.json=this;this.ids=0;this.acks={};this.io.autoConnect&&this.open();this.receiveBuffer=
[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0}var h=c("socket.io-parser");d=c("component-emitter");var q=c("to-array"),l=c("./on"),p=c("component-bind"),F=c("debug")("socket.io-client:socket"),B=c("has-binary");b.exports=e;var m={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},k=d.prototype.emit;d(e.prototype);e.prototype.subEvents=function(){if(!this.subs){var c=this.io;this.subs=
[l(c,"open",p(this,"onopen")),l(c,"packet",p(this,"onpacket")),l(c,"close",p(this,"onclose"))]}};e.prototype.open=e.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==this.io.readyState)this.onopen();return this};e.prototype.send=function(){var c=q(arguments);c.unshift("message");this.emit.apply(this,c);return this};e.prototype.emit=function(c){if(m.hasOwnProperty(c))return k.apply(this,arguments),this;var d=q(arguments),b=h.EVENT;B(d)&&(b=h.BINARY_EVENT);
b={type:b,data:d};"function"==typeof d[d.length-1]&&(F("emitting packet with ack id %d",this.ids),this.acks[this.ids]=d.pop(),b.id=this.ids++);this.connected?this.packet(b):this.sendBuffer.push(b);return this};e.prototype.packet=function(c){c.nsp=this.nsp;this.io.packet(c)};e.prototype.onopen=function(){F("transport is open - connecting");"/"!=this.nsp&&this.packet({type:h.CONNECT})};e.prototype.onclose=function(c){F("close (%s)",c);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",
c)};e.prototype.onpacket=function(c){if(c.nsp==this.nsp)switch(c.type){case h.CONNECT:this.onconnect();break;case h.EVENT:this.onevent(c);break;case h.BINARY_EVENT:this.onevent(c);break;case h.ACK:this.onack(c);break;case h.BINARY_ACK:this.onack(c);break;case h.DISCONNECT:this.ondisconnect();break;case h.ERROR:this.emit("error",c.data)}};e.prototype.onevent=function(c){var d=c.data||[];F("emitting event %j",d);null!=c.id&&(F("attaching ack callback to event"),d.push(this.ack(c.id)));this.connected?
k.apply(this,d):this.receiveBuffer.push(d)};e.prototype.ack=function(c){var d=this,b=!1;return function(){if(!b){b=!0;var e=q(arguments);F("sending ack %j",e);var g=B(e)?h.BINARY_ACK:h.ACK;d.packet({type:g,id:c,data:e})}}};e.prototype.onack=function(c){F("calling ack %s with %j",c.id,c.data);this.acks[c.id].apply(this,c.data);delete this.acks[c.id]};e.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};e.prototype.emitBuffered=function(){var c;
for(c=0;c<this.receiveBuffer.length;c++)k.apply(this,this.receiveBuffer[c]);this.receiveBuffer=[];for(c=0;c<this.sendBuffer.length;c++)this.packet(this.sendBuffer[c]);this.sendBuffer=[]};e.prototype.ondisconnect=function(){F("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};e.prototype.destroy=function(){if(this.subs){for(var c=0;c<this.subs.length;c++)this.subs[c].destroy();this.subs=null}this.io.destroy(this)};e.prototype.close=e.prototype.disconnect=function(){this.connected&&
(F("performing disconnect (%s)",this.nsp),this.packet({type:h.DISCONNECT}));this.destroy();if(this.connected)this.onclose("io client disconnect");return this}},{"./on":53,"component-bind":7,"component-emitter":8,debug:10,"has-binary":30,"socket.io-parser":57,"to-array":59}],55:[function(c,b,d){(function(d){var e=c("parseuri"),g=c("debug")("socket.io-client:url");b.exports=function(c,b){var h=c;b=b||d.location;null==c&&(c=b.protocol+"//"+b.host);"string"==typeof c&&("/"==c.charAt(0)&&(c="/"==c.charAt(1)?
b.protocol+c:b.hostname+c),/^(https?|wss?):\/\//.test(c)||(g("protocol-less url %s",c),c="undefined"!=typeof b?b.protocol+"//"+c:"https://"+c),g("parse %s",c),h=e(c));h.port||(/^(http|ws)$/.test(h.protocol)?h.port="80":/^(http|ws)s$/.test(h.protocol)&&(h.port="443"));h.path=h.path||"/";h.id=h.protocol+"://"+h.host+":"+h.port;h.href=h.protocol+"://"+h.host+(b&&b.port==h.port?"":":"+h.port);return h}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?
window:{})},{debug:10,parseuri:42}],56:[function(c,b,d){(function(b){var e=c("isarray"),g=c("./is-buffer");d.deconstructPacket=function(c){function d(c){if(!c)return c;if(g(c)){var h={_placeholder:!0,num:b.length};b.push(c);return h}if(e(c)){h=Array(c.length);for(var l=0;l<c.length;l++)h[l]=d(c[l]);return h}if("object"==typeof c&&!(c instanceof Date)){h={};for(l in c)h[l]=d(c[l]);return h}return c}var b=[];c.data=d(c.data);c.attachments=b.length;return{packet:c,buffers:b}};d.reconstructPacket=function(c,
d){function b(c){if(c&&c._placeholder)return d[c.num];if(e(c))for(var g=0;g<c.length;g++)c[g]=b(c[g]);else if(c&&"object"==typeof c)for(g in c)c[g]=b(c[g]);return c}c.data=b(c.data);c.attachments=void 0;return c};d.removeBlobs=function(c,d){function h(c,p,F){if(!c)return c;if(b.Blob&&c instanceof Blob||b.File&&c instanceof File){l++;var B=new FileReader;B.onload=function(){F?F[p]=this.result:q=this.result;--l||d(q)};B.readAsArrayBuffer(c)}else if(e(c))for(B=0;B<c.length;B++)h(c[B],B,c);else if(c&&
"object"==typeof c&&!g(c))for(B in c)h(c[B],B,c)}var l=0,q=c;h(q);l||d(q)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./is-buffer":58,isarray:33}],57:[function(c,b,d){function e(){}function h(c){var b=!1;var e=""+c.type;if(d.BINARY_EVENT==c.type||d.BINARY_ACK==c.type)e+=c.attachments,e+="-";c.nsp&&"/"!=c.nsp&&(b=!0,e+=c.nsp);null!=c.id&&(b&&(e+=",",b=!1),e+=c.id);null!=c.data&&(b&&(e+=","),e+=B.stringify(c.data));F("encoded %j as %s",
c,e);return e}function q(c,d){m.removeBlobs(c,function(c){var b=m.deconstructPacket(c);c=h(b.packet);b=b.buffers;b.unshift(c);d(b)})}function l(){this.reconstructor=null}function p(c){this.reconPack=c;this.buffers=[]}var F=c("debug")("socket.io-parser"),B=c("json3");c("isarray");b=c("component-emitter");var m=c("./binary"),k=c("./is-buffer");d.protocol=4;d.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" ");d.CONNECT=0;d.DISCONNECT=1;d.EVENT=2;d.ACK=3;d.ERROR=4;d.BINARY_EVENT=
5;d.BINARY_ACK=6;d.Encoder=e;d.Decoder=l;e.prototype.encode=function(c,b){F("encoding packet %j",c);d.BINARY_EVENT==c.type||d.BINARY_ACK==c.type?q(c,b):(c=h(c),b([c]))};b(l.prototype);l.prototype.add=function(c){if("string"==typeof c){a:{var b={},e=0;b.type=Number(c.charAt(0));if(null==d.types[b.type])c={type:d.ERROR,data:"parser error"};else{if(d.BINARY_EVENT==b.type||d.BINARY_ACK==b.type){for(var g="";"-"!=c.charAt(++e)&&(g+=c.charAt(e),e!=c.length););if(g!=Number(g)||"-"!=c.charAt(e))throw Error("Illegal attachments");
b.attachments=Number(g)}if("/"==c.charAt(e+1))for(b.nsp="";++e;){g=c.charAt(e);if(","==g)break;b.nsp+=g;if(e==c.length)break}else b.nsp="/";g=c.charAt(e+1);if(""!==g&&Number(g)==g){for(b.id="";++e;){g=c.charAt(e);if(null==g||Number(g)!=g){--e;break}b.id+=c.charAt(e);if(e==c.length)break}b.id=Number(b.id)}if(c.charAt(++e))try{b.data=B.parse(c.substr(e))}catch(yg){c={type:d.ERROR,data:"parser error"};break a}F("decoded %s as %j",c,b);c=b}}d.BINARY_EVENT==c.type||d.BINARY_ACK==c.type?(this.reconstructor=
new p(c),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",c)):this.emit("decoded",c)}else if(k(c)||c.base64)if(this.reconstructor){if(c=this.reconstructor.takeBinaryData(c))this.reconstructor=null,this.emit("decoded",c)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+c);};l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};p.prototype.takeBinaryData=function(c){this.buffers.push(c);
return this.buffers.length==this.reconPack.attachments?(c=m.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),c):null};p.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},{"./binary":56,"./is-buffer":58,"component-emitter":8,debug:10,isarray:33,json3:34}],58:[function(c,b,d){(function(c){b.exports=function(d){return c.Buffer&&c.Buffer.isBuffer(d)||c.ArrayBuffer&&d instanceof ArrayBuffer}}).call(this,"undefined"!==typeof global?global:"undefined"!==
typeof self?self:"undefined"!==typeof window?window:{})},{}],59:[function(c,b,d){b.exports=function(c,d){for(var b=[],e=(d=d||0)||0;e<c.length;e++)b[e-d]=c[e];return b}},{}],60:[function(c,b,d){(function(c){(function(e){function g(c){for(var d=[],b=0,e=c.length,g,h;b<e;)g=c.charCodeAt(b++),55296<=g&&56319>=g&&b<e?(h=c.charCodeAt(b++),56320==(h&64512)?d.push(((g&1023)<<10)+(h&1023)+65536):(d.push(g),b--)):d.push(g);return d}function h(c){if(55296<=c&&57343>=c)throw Error("Lone surrogate U+"+c.toString(16).toUpperCase()+
" is not a scalar value");}function p(){if(v>=t)throw Error("Invalid byte index");var c=r[v]&255;v++;if(128==(c&192))return c&63;throw Error("Invalid continuation byte");}function F(){if(v>t)throw Error("Invalid byte index");if(v==t)return!1;var c=r[v]&255;v++;if(0==(c&128))return c;if(192==(c&224)){var d=p();c=(c&31)<<6|d;if(128<=c)return c;throw Error("Invalid continuation byte");}if(224==(c&240)){d=p();var b=p();c=(c&15)<<12|d<<6|b;if(2048<=c)return h(c),c;throw Error("Invalid continuation byte");
}if(240==(c&248)){d=p();b=p();var e=p();c=(c&15)<<18|d<<12|b<<6|e;if(65536<=c&&1114111>=c)return c}throw Error("Invalid UTF-8 detected");}var B="object"==typeof d&&d,m="object"==typeof b&&b&&b.exports==B&&b,k="object"==typeof c&&c;if(k.global===k||k.window===k)e=k;var n=String.fromCharCode,r,t,v;k={version:"2.0.0",encode:function(c){c=g(c);for(var d=c.length,b=-1,e,l="";++b<d;){e=c[b];if(0==(e&4294967168))e=n(e);else{var q="";0==(e&4294965248)?q=n(e>>6&31|192):0==(e&4294901760)?(h(e),q=n(e>>12&15|
224),q+=n(e>>6&63|128)):0==(e&4292870144)&&(q=n(e>>18&7|240),q+=n(e>>12&63|128),q+=n(e>>6&63|128));e=q+=n(e&63|128)}l+=e}return l},decode:function(c){r=g(c);t=r.length;v=0;c=[];for(var d;!1!==(d=F());)c.push(d);d=c.length;for(var b=-1,e,h="";++b<d;)e=c[b],65535<e&&(e-=65536,h+=n(e>>>10&1023|55296),e=56320|e&1023),h+=n(e);return h}};if(B&&!B.nodeType)if(m)m.exports=k;else{e={}.hasOwnProperty;for(var x in k)e.call(k,x)&&(B[x]=k[x])}else e.utf8=k})(this)}).call(this,"undefined"!==typeof global?global:
"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],61:[function(c,b,d){b.exports="function"===typeof Object.create?function(c,d){c.super_=d;c.prototype=Object.create(d.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}})}:function(c,d){c.super_=d;var b=function(){};b.prototype=d.prototype;c.prototype=new b;c.prototype.constructor=c}},{}],62:[function(c,b,d){b.exports=function(c){return c&&"object"===typeof c&&"function"===typeof c.copy&&"function"===
typeof c.fill&&"function"===typeof c.readUInt8}},{}],63:[function(c,b,d){(function(b,e){function g(c,b){var e={seen:[],stylize:p};3<=arguments.length&&(e.depth=arguments[2]);4<=arguments.length&&(e.colors=arguments[3]);x(b)?e.showHidden=b:b&&d._extend(e,b);A(e.showHidden)&&(e.showHidden=!1);A(e.depth)&&(e.depth=2);A(e.colors)&&(e.colors=!1);A(e.customInspect)&&(e.customInspect=!0);e.colors&&(e.stylize=h);return B(e,c,e.depth)}function h(c,d){return(d=g.styles[d])?"\u001b["+g.colors[d][0]+"m"+c+"\u001b["+
g.colors[d][1]+"m":c}function p(c,d){return c}function F(c){var d={};c.forEach(function(c,b){d[c]=!0});return d}function B(c,b,e){if(c.customInspect&&b&&D(b.inspect)&&b.inspect!==d.inspect&&(!b.constructor||b.constructor.prototype!==b)){var g=b.inspect(e,c);z(g)||(g=B(c,g,e));return g}if(g=m(c,b))return g;var h=Object.keys(b),l=F(h);c.showHidden&&(h=Object.getOwnPropertyNames(b));if(G(b)&&(0<=h.indexOf("message")||0<=h.indexOf("description")))return k(b);if(0===h.length){if(D(b))return c.stylize("[Function"+
(b.name?": "+b.name:"")+"]","special");if(y(b))return c.stylize(RegExp.prototype.toString.call(b),"regexp");if(H(b))return c.stylize(Date.prototype.toString.call(b),"date");if(G(b))return k(b)}g="";var q=!1,p=["{","}"];v(b)&&(q=!0,p=["[","]"]);D(b)&&(g=" [Function"+(b.name?": "+b.name:"")+"]");y(b)&&(g=" "+RegExp.prototype.toString.call(b));H(b)&&(g=" "+Date.prototype.toUTCString.call(b));G(b)&&(g=" "+k(b));if(0===h.length&&(!q||0==b.length))return p[0]+g+p[1];if(0>e)return y(b)?c.stylize(RegExp.prototype.toString.call(b),
"regexp"):c.stylize("[Object]","special");c.seen.push(b);h=q?n(c,b,e,l,h):h.map(function(d){return r(c,b,e,l,d,q)});c.seen.pop();return t(h,g,p)}function m(c,d){if(A(d))return c.stylize("undefined","undefined");if(z(d))return d="'"+JSON.stringify(d).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",c.stylize(d,"string");if(w(d))return c.stylize(""+d,"number");if(x(d))return c.stylize(""+d,"boolean");if(null===d)return c.stylize("null","null")}function k(c){return"["+Error.prototype.toString.call(c)+
"]"}function n(c,d,b,e,g){for(var h=[],l=0,q=d.length;l<q;++l)Object.prototype.hasOwnProperty.call(d,String(l))?h.push(r(c,d,b,e,String(l),!0)):h.push("");g.forEach(function(g){g.match(/^\d+$/)||h.push(r(c,d,b,e,g,!0))});return h}function r(c,d,b,e,g,h){var l,q;d=Object.getOwnPropertyDescriptor(d,g)||{value:d[g]};d.get?q=d.set?c.stylize("[Getter/Setter]","special"):c.stylize("[Getter]","special"):d.set&&(q=c.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(e,g)||(l="["+g+"]");q||
(0>c.seen.indexOf(d.value)?(q=null===b?B(c,d.value,null):B(c,d.value,b-1),-1<q.indexOf("\n")&&(q=h?q.split("\n").map(function(c){return"  "+c}).join("\n").substr(2):"\n"+q.split("\n").map(function(c){return"   "+c}).join("\n"))):q=c.stylize("[Circular]","special"));if(A(l)){if(h&&g.match(/^\d+$/))return q;l=JSON.stringify(""+g);l.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(l=l.substr(1,l.length-2),l=c.stylize(l,"name")):(l=l.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),l=c.stylize(l,
"string"))}return l+": "+q}function t(c,d,b){var e=0;return 60<c.reduce(function(c,d){e++;0<=d.indexOf("\n")&&e++;return c+d.replace(/\u001b\[\d\d?m/g,"").length+1},0)?b[0]+(""===d?"":d+"\n ")+" "+c.join(",\n  ")+" "+b[1]:b[0]+d+" "+c.join(", ")+" "+b[1]}function v(c){return Array.isArray(c)}function x(c){return"boolean"===typeof c}function w(c){return"number"===typeof c}function z(c){return"string"===typeof c}function A(c){return void 0===c}function y(c){return C(c)&&"[object RegExp]"===Object.prototype.toString.call(c)}
function C(c){return"object"===typeof c&&null!==c}function H(c){return C(c)&&"[object Date]"===Object.prototype.toString.call(c)}function G(c){return C(c)&&("[object Error]"===Object.prototype.toString.call(c)||c instanceof Error)}function D(c){return"function"===typeof c}function J(c){return 10>c?"0"+c.toString(10):c.toString(10)}function E(){var c=new Date,d=[J(c.getHours()),J(c.getMinutes()),J(c.getSeconds())].join(":");return[c.getDate(),R[c.getMonth()],d].join(" ")}var L=/%[sdj%]/g;d.format=
function(c){if(!z(c)){for(var d=[],b=0;b<arguments.length;b++)d.push(g(arguments[b]));return d.join(" ")}b=1;var e=arguments,h=e.length;d=String(c).replace(L,function(c){if("%%"===c)return"%";if(b>=h)return c;switch(c){case "%s":return String(e[b++]);case "%d":return Number(e[b++]);case "%j":try{return JSON.stringify(e[b++])}catch(Bn){return"[Circular]"}default:return c}});for(var l=e[b];b<h;l=e[++b])d=null!==l&&C(l)?d+(" "+g(l)):d+(" "+l);return d};d.deprecate=function(c,g){if(A(e.process))return function(){return d.deprecate(c,
g).apply(this,arguments)};if(!0===b.noDeprecation)return c;var h=!1;return function(){if(!h){if(b.throwDeprecation)throw Error(g);b.traceDeprecation?console.trace(g):console.error(g);h=!0}return c.apply(this,arguments)}};var N={},I;d.debuglog=function(c){A(I)&&(I=b.env.NODE_DEBUG||"");c=c.toUpperCase();if(!N[c])if((new RegExp("\\b"+c+"\\b","i")).test(I)){var e=b.pid;N[c]=function(){var b=d.format.apply(d,arguments);console.error("%s %d: %s",c,e,b)}}else N[c]=function(){};return N[c]};d.inspect=g;
g.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};g.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};d.isArray=v;d.isBoolean=x;d.isNull=function(c){return null===c};d.isNullOrUndefined=function(c){return null==c};d.isNumber=w;d.isString=z;d.isSymbol=function(c){return"symbol"===
typeof c};d.isUndefined=A;d.isRegExp=y;d.isObject=C;d.isDate=H;d.isError=G;d.isFunction=D;d.isPrimitive=function(c){return null===c||"boolean"===typeof c||"number"===typeof c||"string"===typeof c||"symbol"===typeof c||"undefined"===typeof c};d.isBuffer=c("./support/isBuffer");var R="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");d.log=function(){console.log("%s - %s",E(),d.format.apply(d,arguments))};d.inherits=c("inherits");d._extend=function(c,d){if(!d||!C(d))return c;for(var b=Object.keys(d),
e=b.length;e--;)c[b[e]]=d[b[e]];return c}}).call(this,c("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":62,_process:43,inherits:61}],64:[function(c,b,d){if(window.mozRTCPeerConnection||navigator.mozGetUserMedia){var e="moz";var h=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)}else if(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)e="webkit",h=navigator.userAgent.match(/Chrom(e|ium)/)&&
parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10);c=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;d=window.mozRTCIceCandidate||window.RTCIceCandidate;var q=window.mozRTCSessionDescription||window.RTCSessionDescription,l=window.webkitMediaStream||window.MediaStream,p="https:"===window.location.protocol&&("webkit"===e&&26<=h||"moz"===e&&33<=h),F=window.AudioContext||window.webkitAudioContext,B=document.createElement("video");B=B&&B.canPlayType&&
"probably"===B.canPlayType('video/webm; codecs="vp8", vorbis');var m=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;b.exports={prefix:e,browserVersion:h,support:!!c&&!!m,supportRTCPeerConnection:!!c,supportVp8:B,supportGetUserMedia:!!m,supportDataChannel:!!(c&&c.prototype&&c.prototype.createDataChannel),supportWebAudio:!(!F||!F.prototype.createMediaStreamSource),supportMediaStream:!(!l||!l.prototype.removeTrack),supportScreenSharing:!!p,AudioContext:F,
PeerConnection:c,SessionDescription:q,IceCandidate:d,MediaStream:l,getUserMedia:m}},{}],65:[function(c,b,d){function e(){}b.exports=e;e.mixin=function(c){c=c.prototype||c;c.isWildEmitter=!0;c.on=function(c,d,b){this.callbacks=this.callbacks||{};var e=3===arguments.length,g=e?arguments[2]:arguments[1];g._groupName=e?arguments[1]:void 0;(this.callbacks[c]=this.callbacks[c]||[]).push(g);return this};c.once=function(c,d,b){function e(){g.off(c,e);l.apply(this,arguments)}var g=this,h=3===arguments.length,
l=h?arguments[2]:arguments[1];this.on(c,h?arguments[1]:void 0,e);return this};c.releaseGroup=function(c){this.callbacks=this.callbacks||{};var d,b;for(d in this.callbacks){var e=this.callbacks[d];var g=0;for(b=e.length;g<b;g++)e[g]._groupName===c&&(e.splice(g,1),g--,b--)}return this};c.off=function(c,d){this.callbacks=this.callbacks||{};var b=this.callbacks[c];if(!b)return this;if(1===arguments.length)return delete this.callbacks[c],this;var e=b.indexOf(d);b.splice(e,1);0===b.length&&delete this.callbacks[c];
return this};c.emit=function(c){this.callbacks=this.callbacks||{};var d=[].slice.call(arguments,1),b=this.callbacks[c],e=this.getWildcardCallbacks(c),g;if(b){var h=b.slice();b=0;for(g=h.length;b<g&&h[b];++b)h[b].apply(this,d)}if(e)for(h=e.slice(),b=0,g=h.length;b<g&&h[b];++b)h[b].apply(this,[c].concat(d));return this};c.getWildcardCallbacks=function(c){this.callbacks=this.callbacks||{};var d,b=[];for(d in this.callbacks){var e=d.split("*");if("*"===d||2===e.length&&c.slice(0,e[0].length)===e[0])b=
b.concat(this.callbacks[d])}return b}};e.mixin(e)},{}],66:[function(c,b,d){function e(c,d,b){return d?new h(c,d):new h(c)}c=window;var h=c.WebSocket||c.MozWebSocket;b.exports=h?e:null;h&&(e.prototype=h.prototype)},{}],67:[function(c,b,d){function e(c){var d=!0;c.getTracks().forEach(function(c){d="ended"===c.readyState&&d});return d}function h(c){var d=this;p.call(this);this.id=c.id;this.parent=c.parent;this.type=c.type||"video";this.oneway=c.oneway||!1;this.sharemyscreen=c.sharemyscreen||!1;this.browserPrefix=
c.prefix;this.stream=c.stream;this.enableDataChannels=void 0===c.enableDataChannels?this.parent.config.enableDataChannels:c.enableDataChannels;this.receiveMedia=c.receiveMedia||this.parent.config.receiveMedia;this.channels={};this.sid=c.sid||Date.now().toString();this.pc=new l(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints);this.pc.on("ice",this.onIceCandidate.bind(this));this.pc.on("endOfCandidates",function(c){d.send("endOfCandidates",c)});this.pc.on("offer",
function(c){d.parent.config.nick&&(c.nick=d.parent.config.nick);d.send("offer",c)});this.pc.on("answer",function(c){d.parent.config.nick&&(c.nick=d.parent.config.nick);d.send("answer",c)});this.pc.on("addStream",this.handleRemoteStreamAdded.bind(this));this.pc.on("addChannel",this.handleDataChannelAdded.bind(this));this.pc.on("removeStream",this.handleStreamRemoved.bind(this));this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded"));this.pc.on("iceConnectionStateChange",this.emit.bind(this,
"iceConnectionStateChange"));this.pc.on("iceConnectionStateChange",function(){switch(d.pc.iceConnectionState){case "failed":"offer"===d.pc.pc.localDescription.type&&(d.parent.emit("iceFailed",d),d.send("connectivityError"))}});this.pc.on("signalingStateChange",this.emit.bind(this,"signalingStateChange"));this.logger=this.parent.logger;"screen"===c.type?this.parent.localScreens&&this.parent.localScreens[0]&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),this.pc.addStream(this.parent.localScreens[0]),
this.broadcaster=c.broadcaster):this.parent.localStreams.forEach(function(c){d.pc.addStream(c)});this.on("channelOpen",function(c){"https://simplewebrtc.com/protocol/filetransfer#inband-v1"===c.protocol&&(c.onmessage=function(b){b=JSON.parse(b.data);var e=new F.Receiver;e.receive(b,c);d.emit("fileTransfer",b,e);e.on("receivedFile",function(c,d){e.channel.close()})})});this.on("*",function(){d.parent.emit.apply(d.parent,arguments)})}d=c("util");var q=c("webrtcsupport"),l=c("rtcpeerconnection"),p=c("wildemitter"),
F=c("filetransfer");d.inherits(h,p);h.prototype.handleMessage=function(c){var d=this;this.logger.log("getting",c.type,c);c.prefix&&(this.browserPrefix=c.prefix);"offer"===c.type?(this.nick||(this.nick=c.payload.nick),delete c.payload.nick,this.pc.handleOffer(c.payload,function(c){c||d.pc.answer(function(c,d){})})):"answer"===c.type?(this.nick||(this.nick=c.payload.nick),delete c.payload.nick,this.pc.handleAnswer(c.payload)):"candidate"===c.type?this.pc.processIce(c.payload):"connectivityError"===
c.type?this.parent.emit("connectivityError",d):"mute"===c.type?this.parent.emit("mute",{id:c.from,name:c.payload.name}):"unmute"===c.type&&this.parent.emit("unmute",{id:c.from,name:c.payload.name})};h.prototype.send=function(c,d){d={to:this.id,sid:this.sid,broadcaster:this.broadcaster,roomType:this.type,type:c,payload:d,prefix:q.prefix};this.logger.log("sending",c,d);this.parent.emit("message",d)};h.prototype.sendDirectly=function(c,d,b){this.logger.log("sending via datachannel",c,d,{type:d,payload:b});
c=this.getDataChannel(c);if("open"!=c.readyState)return!1;c.send(b);return!0};h.prototype._observeDataChannel=function(c){var d=this;c.binaryType="arraybuffer";c.onclose=this.emit.bind(this,"channelClose",c);c.onerror=this.emit.bind(this,"channelError",c);c.onmessage=function(b){var e=new Uint32Array(b.data);d.emit("channelMessage",d,c.label,e,c,b)};c.onopen=this.emit.bind(this,"channelOpen",c)};h.prototype.getDataChannel=function(c,d){if(!q.supportDataChannel)return this.emit("error",Error("createDataChannel not supported"));
var b=this.channels[c];d||(d={});if(b)return b;b=this.channels[c]=this.pc.createDataChannel(c,d);b.binaryType="arraybuffer";this._observeDataChannel(b);return b};h.prototype.onIceCandidate=function(c){if(!this.closed)if(c){var d=this.parent.config.peerConnectionConfig;"moz"===q.prefix&&d&&d.iceTransports&&c.candidate&&c.candidate.candidate&&0>c.candidate.candidate.indexOf(d.iceTransports)?this.logger.log("Ignoring ice candidate not matching pcConfig iceTransports type: ",d.iceTransports):this.send("candidate",
c)}else this.logger.log("End of candidates.")};h.prototype.start=function(){this.enableDataChannels&&this.getDataChannel("simplewebrtc");this.pc.offer(this.receiveMedia,function(c,d){})};h.prototype.icerestart=function(){var c=this.receiveMedia;c.mandatory.IceRestart=!0;this.pc.offer(c,function(c,d){})};h.prototype.end=function(){this.closed||(this.pc.close(),this.handleStreamRemoved())};h.prototype.handleRemoteStreamAdded=function(c){var d=this;this.stream?this.logger.warn("Already have a remote stream"):
(this.stream=c.stream,this.stream.getTracks().forEach(function(c){c.addEventListener("ended",function(){e(d.stream)&&d.end()})}),this.parent.emit("peerStreamAdded",this))};h.prototype.handleStreamRemoved=function(){var c=this.parent.peers.indexOf(this);-1<c&&(this.parent.peers.splice(c,1),this.closed=!0,this.parent.emit("peerStreamRemoved",this))};h.prototype.handleDataChannelAdded=function(c){this.channels[c.label]=c;this._observeDataChannel(c)};h.prototype.sendFile=function(c){var d=new F.Sender,
b=this.getDataChannel("filetransfer"+(new Date).getTime(),{protocol:"https://simplewebrtc.com/protocol/filetransfer#inband-v1"});b.onopen=function(){b.send(JSON.stringify({size:c.size,name:c.name}));d.send(c,b)};b.onclose=function(){console.log("sender received transfer");d.emit("complete")};return d};b.exports=h},{filetransfer:26,rtcpeerconnection:44,util:63,webrtcsupport:64,wildemitter:65}],68:[function(c,b,d){function e(c){var d=this,b=c||{},e=this.config={url:"https://sandbox.simplewebrtc.com:443/",
socketio:{},connection:null,debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!1,peerVolumeWhenSpeaking:.25,media:{video:!0,audio:!0},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},localVideo:{autoplay:!0,mirror:!0,muted:!0}},g;var k=c.debug?c.logger||console:c.logger||F;this.logger=k;for(g in b)b.hasOwnProperty(g)&&(this.config[g]=b[g]);this.capabilities=l;q.call(this);var B=null===this.config.connection?this.connection=
new m(this.config):this.connection=this.config.connection;B.on("connect",function(){d.emit("connectionReady",B.getSessionid());d.sessionReady=!0;d.testReadiness()});B.on("message",function(c){var b=d.webrtc.getPeers(c.from,c.roomType);if("offer"===c.type){b.length&&b.forEach(function(d){d.sid==c.sid&&(e=d)});if(!e){var e=d.webrtc.createPeer({id:c.from,sid:c.sid,type:c.roomType,enableDataChannels:d.config.enableDataChannels&&"screen"!==c.roomType,sharemyscreen:"screen"===c.roomType&&!c.broadcaster,
broadcaster:"screen"!==c.roomType||c.broadcaster?null:d.connection.getSessionid()});d.emit("createdPeer",e)}e.handleMessage(c)}else b.length&&b.forEach(function(d){c.sid?d.sid===c.sid&&d.handleMessage(c):d.handleMessage(c)})});B.on("remove",function(c){c.id!==d.connection.getSessionid()&&d.webrtc.removePeers(c.id,c.type)});c.logger=this.logger;c.debug=!1;this.webrtc=new h(c);"mute unmute pauseVideo resumeVideo pause resume sendToAll sendDirectlyToAll getPeers".split(" ").forEach(function(c){d[c]=
d.webrtc[c].bind(d.webrtc)});this.webrtc.on("*",function(){d.emit.apply(d,arguments)});if(e.debug)this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:"));this.webrtc.on("localStream",function(){d.testReadiness()});this.webrtc.on("message",function(c){d.connection.emit("message",c)});this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this));this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this));this.config.adjustPeerVolume&&(this.webrtc.on("speaking",
this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1)));B.on("stunservers",function(c){d.webrtc.config.peerConnectionConfig.iceServers=c;d.emit("stunservers",c)});B.on("turnservers",function(c){d.webrtc.config.peerConnectionConfig.iceServers=d.webrtc.config.peerConnectionConfig.iceServers.concat(c);d.emit("turnservers",c)});this.webrtc.on("iceFailed",function(c){});this.webrtc.on("connectivityError",function(c){});this.webrtc.on("audioOn",
function(){d.webrtc.sendToAll("unmute",{name:"audio"})});this.webrtc.on("audioOff",function(){d.webrtc.sendToAll("mute",{name:"audio"})});this.webrtc.on("videoOn",function(){d.webrtc.sendToAll("unmute",{name:"video"})});this.webrtc.on("videoOff",function(){d.webrtc.sendToAll("mute",{name:"video"})});this.webrtc.on("localScreen",function(c){var b=document.createElement("video"),e=d.getRemoteVideoContainer();b.oncontextmenu=function(){return!1};b.id="localScreen";p(c,b);e&&e.appendChild(b);d.emit("localScreenAdded",
b);d.connection.emit("shareScreen");d.webrtc.peers.forEach(function(c){"video"===c.type&&(c=d.webrtc.createPeer({id:c.id,type:"screen",sharemyscreen:!0,enableDataChannels:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},broadcaster:d.connection.getSessionid()}),d.emit("createdPeer",c),c.start())})});this.webrtc.on("localScreenStopped",function(c){d.getLocalScreen()&&d.stopScreenShare()});this.webrtc.on("channelMessage",function(c,b,e){"volume"==e.type&&d.emit("remoteVolumeChange",c,e.volume)});
this.config.autoRequestMedia&&this.startLocalVideo()}var h=c("./webrtc"),q=c("wildemitter"),l=c("webrtcsupport"),p=c("attachmediastream"),F=c("mockconsole"),m=c("./socketioconnection");e.prototype=Object.create(q.prototype,{constructor:{value:e}});e.prototype.leaveRoom=function(){if(this.roomName){for(this.connection.emit("leave");this.webrtc.peers.length;)this.webrtc.peers[0].end();this.getLocalScreen()&&this.stopScreenShare();this.emit("leftRoom",this.roomName);this.roomName=void 0}};e.prototype.disconnect=
function(){this.connection.disconnect();delete this.connection};e.prototype.handlePeerStreamAdded=function(c){var d=this,b=this.getRemoteVideoContainer(),e=p(c.stream);c.videoEl=e;e.id=this.getDomId(c);b&&b.appendChild(e);this.emit("videoAdded",e,c);window.setTimeout(function(){d.webrtc.isAudioEnabled()||c.send("mute",{name:"audio"});d.webrtc.isVideoEnabled()||c.send("mute",{name:"video"})},250)};e.prototype.handlePeerStreamRemoved=function(c){var d=this.getRemoteVideoContainer(),b=c.videoEl;this.config.autoRemoveVideos&&
d&&b&&d.removeChild(b);b&&this.emit("videoRemoved",b,c)};e.prototype.getDomId=function(c){return[c.id,c.type,c.broadcaster?"broadcasting":"incoming"].join("_")};e.prototype.setVolumeForAll=function(c){this.webrtc.peers.forEach(function(d){d.videoEl&&(d.videoEl.volume=c)})};e.prototype.joinRoom=function(c,d){var b=this;this.roomName=c;this.connection.emit("join",c,function(e,g){console.log("join CB",e);if(e)b.emit("error",e);else{if(!g.xtra){gb();Qb();Xc(t.errorLoading,"#ff0000");return}y.room=g.xtra;
var h,l;for(h in g.clients){var q=g.clients[h];for(l in q)if(q[l]){var p=b.webrtc.createPeer({id:h,type:l,enableDataChannels:b.config.enableDataChannels&&"screen"!==l,receiveMedia:{offerToReceiveAudio:"screen"!==l&&b.config.receiveMedia.offerToReceiveAudio?1:0,offerToReceiveVideo:b.config.receiveMedia.offerToReceiveVideo}});b.emit("createdPeer",p);p.start()}}}d&&d(e,g);b.emit("joinedRoom",c)})};e.prototype.getEl=function(c){return"string"===typeof c?document.getElementById(c):c};e.prototype.startLocalVideo=
function(){var c=this;this.webrtc.start(this.config.media,function(d,b){d?c.emit("localMediaError",d):p(b,c.getLocalVideoContainer(),c.config.localVideo)})};e.prototype.stopLocalVideo=function(){this.webrtc.stop()};e.prototype.getLocalVideoContainer=function(){var c=this.getEl(this.config.localVideoEl);if(c&&"VIDEO"===c.tagName)return c.oncontextmenu=function(){return!1},c;if(c){var d=document.createElement("video");d.oncontextmenu=function(){return!1};c.appendChild(d);return d}};e.prototype.getRemoteVideoContainer=
function(){return this.getEl(this.config.remoteVideosEl)};e.prototype.shareScreen=function(c){this.webrtc.startScreenShare(c)};e.prototype.getLocalScreen=function(){return this.webrtc.localScreens&&this.webrtc.localScreens[0]};e.prototype.stopScreenShare=function(){this.connection.emit("unshareScreen");var c=document.getElementById("localScreen"),d=this.getRemoteVideoContainer();this.config.autoRemoveVideos&&d&&c&&d.removeChild(c);c&&this.emit("videoRemoved",c);this.getLocalScreen()&&this.webrtc.stopScreenShare();
this.webrtc.peers.forEach(function(c){c.broadcaster&&c.end()})};e.prototype.testReadiness=function(){this.sessionReady&&(this.config.media.video||this.config.media.audio?0<this.webrtc.localStreams.length&&this.emit("readyToCall",this.connection.getSessionid()):this.emit("readyToCall",this.connection.getSessionid()))};e.prototype.createRoom=function(c,d){this.roomName=c;this.connection.emit("create",y.room,d)};e.prototype.sendFile=function(){if(!l.dataChannel)return this.emit("error",Error("DataChannelNotSupported"))};
b.exports=e},{"./socketioconnection":69,"./webrtc":70,attachmediastream:3,mockconsole:37,webrtcsupport:64,wildemitter:65}],69:[function(c,b,d){function e(c){this.connection=h.connect(c.url,c.socketio)}var h=c("socket.io-client");e.prototype.on=function(c,d){this.connection.on(c,d)};e.prototype.emit=function(){this.connection.emit.apply(this.connection,arguments)};e.prototype.getSessionid=function(){return this.connection.id};e.prototype.disconnect=function(){return this.connection.disconnect()};b.exports=
e},{"socket.io-client":50}],70:[function(c,b,d){function e(c){var d=this,b=c||{};this.config={debug:!1,peerConnectionConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[]},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},enableDataChannels:!0};var e;c=c.debug?c.logger||console:c.logger||q;this.logger=c;for(e in b)b.hasOwnProperty(e)&&(this.config[e]=b[e]);h.support||this.logger.error("Your browser doesn't seem to support WebRTC");this.peers=[];
l.call(this,this.config);this.on("speaking",function(){d.hardMuted||d.peers.forEach(function(c){c.enableDataChannels&&(c=c.getDataChannel("hark"),"open"==c.readyState&&c.send(JSON.stringify({type:"speaking"})))})});this.on("stoppedSpeaking",function(){d.hardMuted||d.peers.forEach(function(c){c.enableDataChannels&&(c=c.getDataChannel("hark"),"open"==c.readyState&&c.send(JSON.stringify({type:"stoppedSpeaking"})))})});this.on("volumeChange",function(c,b){d.hardMuted||d.peers.forEach(function(d){d.enableDataChannels&&
(d=d.getDataChannel("hark"),"open"==d.readyState&&d.send(JSON.stringify({type:"volume",volume:c})))})});if(this.config.debug)this.on("*",function(c,b,e){(d.config.logger===q?console:d.logger).log("event:",c,b,e)})}d=c("util");var h=c("webrtcsupport"),q=c("mockconsole"),l=c("localmedia"),p=c("./peer");d.inherits(e,l);e.prototype.createPeer=function(c){c.parent=this;c=new p(c);this.peers.push(c);return c};e.prototype.removePeers=function(c,d){this.getPeers(c,d).forEach(function(c){c.end()})};e.prototype.getPeers=
function(c,d){return this.peers.filter(function(b){return(!c||b.id===c)&&(!d||b.type===d)})};e.prototype.sendToAll=function(c,d){this.peers.forEach(function(b){b.send(c,d)})};e.prototype.sendDirectlyToAll=function(c,d,b){this.peers.forEach(function(e){e.enableDataChannels&&e.sendDirectly(c,d,b)})};b.exports=e},{"./peer":67,localmedia:35,mockconsole:37,util:63,webrtcsupport:64}]},{},[68])(68)})},H,Ba,t={},y={name:localStorage.name,color:localStorage.color||"#ff0000"},Bb=function(){};console.log("%c nehhon %c POWER ",
"background: #00ffd4; color: #000; font-size:20px","background: #000; color: #00ffd4; font-size:20px");console.log("%c webmaster@nehhon.com ","background: #00ffd4; color: #000; font-size:20px");console.log("%c @nehhon ","background: #000; color: #00ffd4; font-size:20px");var r=function(f){return document.getElementById(f)},Ca=function(f,c,b){void 0===localStorage[f]&&(localStorage[f]=c);b&&(r(b).value=localStorage[f])};void 0===localStorage.fullscreen&&(localStorage.fullscreen=!0);Ca("favMusic","originalMusic");
Ca("musicRange",36);Ca("soundRange",100);Ca("goldRes",400);Ca("foodRes",400);Ca("stoneRes",400);Ca("woodRes",400);Ca("nplayed",0);Ca("infinity","true");Ca("mapx",256);Ca("terrainType","grass");Ca("water","0");Ca("items","10");Ca("peons","3");Ca("gateways","1");Ca("freePop","1");console.log=Bb;console.error=Bb;console.warn=Bb;console.info=Bb;"tza.red"!==location.hostname&&(location.href="https://tza.red");window.onbeforeunload=function(){return"Are you sure you want to quit?"};var Vl=function(f){f.parentNode.removeChild(f)},
Xc=function(f,c){var b=r("notifybar"),d=document.createElement("div");d.innerHTML=f;c&&(d.style.background=c);b.appendChild(d);setTimeout(Vl,11E3,d)};document.body.style.setProperty("--baksp","linear-gradient(60deg, rgba(55, 0, 56, 0.6) 0%, rgba(var(--lred),var(--lgreen),var(--lblue), 0.5) 100%), url(/nehhon/bak2.jpg) fixed repeat");document.body.style.setProperty("--bak2sp","url(/nehhon/bak.jpg) fixed repeat");var Wl=location;(function(){var f=!!window.opr||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),
c="undefined"!==typeof InstallTrigger,b=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),d=!!document.documentMode,g=!d&&!!window.StyleMedia,h=!!window.chrome&&!!window.chrome.webstore,q;f?q="Opera":c?q="Firefox":b?q="Safari":d?q="IE":g?q="Edge":h&&(q="Chrome");y.navLang=localStorage.language||navigator.language||navigator.userLanguage;"IE"!=q&&"Edge"!=q&&"Safari"!=q||Xc("Your browser is not supported","#ff0000");f=y.navLang.substr(0,2);c={es:["Tzared","Juego de estrategia en tiempo real para navegadores web, juega solo o con amigos",
"tzared,jugar,multijugador,juego,online,navegador web,tzar"],it:["Tzared","Gioco di strategia in tempo reale per browser web, giocare da soli o con gli amici","tzared,giocare,multigiocatore,gioco,online,navigatore,tzar,web"],pl:["Tzared","Gra strategiczna w czasie rzeczywistym dla przegl\u0105darek internetowych, bawi\u0107 si\u0119 samotnie lub z przyjaci\u00f3\u0142mi","tzared,gra,multiplayer,online,tzar,przegl\u0105darka internetowa"],ru:["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u043b\u044f \u0432\u0435\u0431-\u0431\u0440\u0430\u0443\u0437\u0435\u0440\u043e\u0432, \u0438\u0433\u0440\u0430\u0442\u044c \u0432 \u043e\u0434\u0438\u043d\u043e\u0447\u043a\u0443 \u0438\u043b\u0438 \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438",
"\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u044c\u0442\u0438\u043f\u043b\u0435\u0435\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u0435\u0440,\u043e\u0433\u043d\u0451\u043c \u0438 \u043c\u0435\u0447\u043e\u043c"],pt:["Tzared","Jogo de estrat\u00e9gia em tempo real para navegadores da web, jogar sozinho ou com amigos","tzared,jogar,multiplayer,jogo,online,navegador web,tzar"],bg:["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0447\u0435\u0441\u043a\u0430 \u0438\u0433\u0440\u0430 \u0432 \u0440\u0435\u0430\u043b\u043d\u043e \u0432\u0440\u0435\u043c\u0435 \u0437\u0430 \u0443\u0435\u0431 \u0431\u0440\u0430\u0443\u0437\u044a\u0440\u0438, \u0438\u0433\u0440\u0430\u0439\u0442\u0435 \u0441\u0430\u043c\u0438 \u0438\u043b\u0438 \u0441 \u043f\u0440\u0438\u044f\u0442\u0435\u043b\u0438",
"\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u0442\u0438\u043f\u043b\u0435\u0439\u044a\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u044a\u0440"],de:["Tzared","Echtzeit-Strategiespiel f\u00fcr Webbrowser, alleine oder mit Freunden spielen","tzared,multiplayer,spiel,online,Webbrowser,tzar"],en:["Tzared","Real-time strategy game for web browsers, play alone or with friends","tzared,play,multiplayer,game,online,browser,tzar,web"]};c[f]||(f=
"en");document.getElementsByTagName("html")[0].lang=f;c=c[location.search.split("lang=")[1]||"en"];document.title=c[0];y.title=c[0];document.getElementsByTagName("meta").description=c[1];document.getElementsByTagName("meta").keywords=c[2];y.version="v34.1";y.versionDate=Date.now()-1552675985E3;localStorage.version!==y.version&&(localStorage.version=y.version,Xc("Updated to "+y.version));r("info").innerHTML="Work in progress - Beta "+y.version+" - Updated "+~~(y.versionDate/864E5)+" days ago";y.lang=
"en es it pt ru pl bg de".split(" ").indexOf(f);0>y.lang&&(y.lang=0);y.langstr=f;y.team=0;y.race=0;y.navigator=q;y.mx=151;y.onlineID=null;y.temperature=0;y.cdn="/nehhon/"})();window.onload=function(){document.getElementById("loadingpage").style="visibility: hidden;\n  opacity: 0;\n  transition: visibility .5s, opacity .5s linear;";setTimeout(function(){document.body.removeChild(document.getElementById("loadingpage"))},1E3)};t={open:"Open",loading:"Loading...",systemAlert:"System Message",notEnough:"Not enough %s",
ok:"OK",yes:"Yes",no:"No",secure:"Are you sure?",gold:"Gold",stone:"Stone",wood:"Wood",food:"Food",mana:"Manna",warning:"Warning",play:"PLAY",grass:"Grass",snow:"Snow",close:"CLOSE",gameClosed:"The game was canceled by the server.",loadgraphics:"Downloading graphics...",waitImages:"Downloading graphics",wait:"Wait",audioproblem:"Your browser is not compatible with Web Audio",defeated:"DEFEATED",victorious:"VICTORIOUS",options:"OPTIONS",refresh:"Refresh",back:"BACK",paused:"PAUSED",chatMsg:"CHAT MESSAGE",
disconnect:"Disconnect",playerDisconnected:"%s has disconnected!",connectionError:"Connection error",noP2P:"Engine not loaded",startingResources:"Starting Resources",mapSize:"Map Size",menu:"MENU",quit:"QUIT",downloadAll:"Download all",continue:"Continue",backToGame:"BACK TO GAME",initializing:"Initializing...",requires:"Requires",stop:"Stop",pickItems:"Pick items",move:"Move",stand:"Stand ground",explore:"Explore",patrol:"Patrol",guard:"Guard",errorLoading:"Error loading game.",waitingPlayers:"Waiting for players to connect",
musicVolume:"Music Volume",soundVolume:"Sound Volume",common:"Common",popLimit:"Population limit reached",houseLimit:"Not enough houses",lightning:"Lightning",freeze:"Freeze",bless:"Bless",heal:"Heal",invisibility:"Invisibility",dcm:"Dig, chop or mine",repair:"Repair building",menuBuild:"See what you can build",units:"Units",infinite:"Infinite",gameFull:"Sorry, the game is full.",terrainOption:"Terrain",playerDefeated:"%s has been defeated!",savegame:"SAVE GAME",loadRecord:"Recording",stats:"Stats",
builds:"Builds",items:"Items",nature:"Nature",trees:"Trees",delete:"Delete",create:"Create",username:"Player Name",gameOptions:"GAME OPTIONS",nplayers:"Number of Players",gameName:"Enter Game Name",gamesFound:"Games Found",strSearch:"SEARCH| Search for existing games",strCreate:"CREATE| Create a game",randomMap:"RANDOM MAP",strcusMap:"CUSTOM MAP",strSettings:"SETTINGS",mapMaking:"Map Making",terrain:"Terrain",save:"SAVE",accept:"ACCEPT",team:"Team",color:"Colour",offlinePlay:"For playing offline",
AI:"AI Assist",kingdom:"Kingdom",attack:"Attack",defence:"Defence",health:"Health",maxHealth:"Max health",playing:"Playing",waiting:"Waiting",joining:"Joining...",random:"Random",cancel:"CANCEL",rules:"Rules",events:"Events",actions:"Actions",objAction:"Object action",destroyObj:"Destroy object",defined:"Defined",undefined:"Undefined",destroy:"Destroy",capture:"Capture",moving:"Moving",add:"Add",objOrder:"Order",objZone:"Object in zone",zone:"Zone",editMap:"Edit",mapName:"Map name",water:"Water",
description:"Map Description",author:"Author",fullscreen:"Automatic full screen",fullscreen2:"Full screen",versionError:"Incorrect game version.",language:"Language",english:"English",spanish:"Espa\u00f1ol",italian:"Italiano",portuguese:"Portugu\u00eas",russian:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439",polish:"Polski",bulgarian:"\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438",german:"Deutsch",up:"Up",down:"Down",kick:"Kick",kicked:"You were kicked off by the server.",nospace:"Not enought space",
peons:"Peasants",gateways:"Magic Gateways",computer:"Computer",addAI:"Add AI",race:"Race",date:"Date",freePop:"Free population",about:"About",loadTerrain:"Loading Terrain...",downloadmap:"Download savegame",timePlayed:"Played time"};var Bi=Bb,Di=function(f){f--;var c=new XMLHttpRequest;c.open("GET","/nehhon/"+y.langstr+".json",!0);c.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");c.onreadystatechange=function(){if(4==c.readyState&&200==c.status){var f=JSON.parse(c.response);
Bi=function(){for(var c=z,d=0;d<c.length;d++){var b=c[d].name;f[b]&&(c[d].name=f[b])}for(d=0;d<D.length;d++)c=D[d],f[c.name[0]]&&f[c.name[1]]&&(c.name[0]=f[c.name[0]],c.name[1]=f[c.name[1]]);f=null};for(var d=[],g=0;0>g;g++)"undefined"!=typeof b[g]&&null!=b[g].tech&&(d.push(b[g].tech.name),Object.freeze(b[g].tech));for(g=0;g<d.length;g++)d[g][0]=f[d[g][0]],d[g][1]=f[d[g][1]];d=Object.keys(t);for(g=0;g<d.length;g++){var h=d[g];void 0!=f[t[h]]&&(t[h]=f[t[h]])}Object.freeze(t);for(g=0;g<Ra.length;g++)Ra[g]=
f[Ra[g]];for(g=0;g<0*Ag.length;g++)Ag[g]=f[Ag[g]];Object.freeze(Ra);Ci()}};c.send()},Ci=function(){for(var f=["refreshButton",t.refresh,"optionsButton",t.options,"startButton",t.play,"backButton",t.back,"closeButton",t.close,"quitButton",t.quit,"continueButton",t.continue],c=0,b=f.length;c<b;c+=2)for(var d=document.getElementsByClassName(f[c]),g=0,h=d.length;g<h;g++)d[g].innerHTML=f[c+1];f=["alertok",t.ok,"gamesFound",t.gamesFound,"strSearch",t.strSearch.split("| ")[1],"strCreate",t.strCreate.split("| ")[1],
"strRandomMap",t.randomMap,"strcusMap",t.strcusMap,"strMapEditor",t.mapMaking,"h2rndMap",t.randomMap,"strSettings",t.strSettings,"about",t.about];c=0;for(b=f.length;c<b;c+=2)r(f[c]).innerHTML=f[c+1]};0<y.lang?(Di(y.lang),Di.translated=!0):Ci();var G=console.log,Xl=r("alerttitle"),Yl=r("alerttext"),Zl=r("alert"),zc=function(f,c,b){Zl.style.display="block";Xl.innerHTML=c||t.warning;Yl.innerHTML=f;b?r("alertok").style.display="none":r("alertok").style.display="block";r("basic").style.filter="blur(94px)"},
$l=[1E3,0,2E3,0],Fi=function(f,c,b){var d=new XMLHttpRequest;d.open("GET",f,!0);d.responseType="arraybuffer";d.onload=function(){c.length?Ei(d.response,0):Ei(d.response,86507520);ia.check()};d.onprogress=b;d.send(1)},Ei=function(f,c){var b=performance.now();f=new Uint16Array(f);var d=f.length,g=f[d-4]+65536*f[d-3],h=f[d-2]+65536*f[d-1];d-=2;for(var q=-1,l=ia.common,p=c;g<d;g++){var m=f[g];if(65533<m){65535==m?(m=f[g+1],g+=1):(m=f[g+1]+65536*f[g+2],g+=2);for(var k=0;k<m&&!(l[p++]=q,p-c>=h);k++);}else{m=
f[2*m]+65536*f[2*m+1];l[p++]=m;if(p-c>=h)break;q=m}}G("nh17:",performance.now()-b)},fc=function(){var f=["icons.png","images.json","graphics.nh17","terrainDataGrass.json","grass.nh17"];f=f.concat(Be);var c=f.length;fc.max=c;for(var b=0;b<c;b++)am(y.cdn+f[b]);this.innerHTML="0%";this.disabled=!0;fc.button=this};fc.loaded=0;var am=function(f){var c=new XMLHttpRequest;c.open("GET",f,!0);c.responseType="arraybuffer";c.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");c.onload=
function(){fc.loaded++;fc.button.innerHTML=~~(100*fc.loaded/fc.max+.5)+"%"};c.send("")},ia={size:512,load:0,xtra:[],common:1,xtraRes:[]},m,La=function(f){f.target.loadedSize||(La.total+=f.total,f.target.lastLoaded=0,f.target.loadedSize=!0);La.progress+=f.loaded-f.target.lastLoaded;f.target.lastLoaded=f.loaded;r("loadingtext").innerHTML=t.loadgraphics+~~(100*La.progress/La.total)+"%"};ia.check=function(){ia.load++;if(ia.load===ia.images){var f=k.createTexture();k.activeTexture(k.TEXTURE0);var c=ia.info;
k.bindTexture(k.TEXTURE_2D,f);k.texImage2D(k.TEXTURE_2D,0,k.RGBA32F,512,512,0,k.RGBA,k.FLOAT,c);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.REPEAT);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.REPEAT);k.bindTexture(k.TEXTURE_2D,null);k.activeTexture(k.TEXTURE0);k.bindTexture(k.TEXTURE_2D,f);k.uniform1i(k.getUniformLocation(da,"u_image1"),0);k.activeTexture(k.TEXTURE1);f=
k.createTexture();k.bindTexture(k.TEXTURE_2D_ARRAY,f);k.texParameteri(k.TEXTURE_2D_ARRAY,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D_ARRAY,k.TEXTURE_MIN_FILTER,k.NEAREST);c=performance.now();k.texImage3D(k.TEXTURE_2D_ARRAY,0,k.RGBA,ia.size,ia.size,ia.common.length/(ia.size*ia.size),0,k.RGBA,k.UNSIGNED_BYTE,new Uint8Array(ia.common.buffer));G("3dtex",performance.now()-c);ia.common=void 0;k.activeTexture(k.TEXTURE1);k.bindTexture(k.TEXTURE_2D_ARRAY,f);k.uniform1i(k.getUniformLocation(da,
"img_common"),1);k.useProgram(oa);k.activeTexture(k.TEXTURE0);k.bindTexture(k.TEXTURE_2D_ARRAY,f);k.uniform1i(k.getUniformLocation(oa,"img_common"),0);k.activeTexture(k.TEXTURE2);bm();Hb.check()}};var cm=function(f){ia.common=new Uint32Array(86507520+Ce[v.terrainType].size);r("loadingtext").innerHTML=t.waitImages;ia.images=Object.keys(f).length;ia.load=0;La.progress=0;La.total=0;Date.now();if(ra.icons)ia.check();else{var c=new XMLHttpRequest;c.open("GET",f.icons,!0);c.responseType="arraybuffer";c.onreadystatechange=
function(){if(4===c.readyState&&200===c.status){var f=new Uint8Array(c.response);f=new Blob([f],{type:"image/png"});var d=new Image;d.src=URL.createObjectURL(f);ra.icons=d;ia.check();Date.now()}};c.onprogress=La;c.send(1)}if(m)ia.check();else{var b=new XMLHttpRequest;b.open("GET",f.imageJSON,!0);b.onreadystatechange=function(){4==this.readyState&&200==this.status&&(ia.check(),m=JSON.parse(b.response),h&&Bg())};b.onprogress=La;b.send(1)}Fi(f.common,"common",La);f=y.cdn;ia.images+=2;r("terrainSelect")&&
(localStorage.terrain=r("terrainSelect").value);var d=Ce[v.terrainType],g=new XMLHttpRequest,h=!1;g.open("GET",f+d.json,!0);g.onreadystatechange=function(){if(4==this.readyState&&200==this.status){ia.xtraRes[0]=JSON.parse(g.response);Ad=ia.xtraRes[0];var c=Ad.specialColor;new Float32Array(Sa(c[0]/255,c[1]/255,c[2]/255,.9));ia.check();h=!0;c="rgb("+c[0]+","+c[1]+","+c[2]+")";r("msgs1").style.color=c;r("playersinfo").style.color=c;r("topinfo").style.color=c;m&&Bg()}};g.onprogress=La;g.send(!0);Fi(f+
d.main,0,!1)},Ce={grass:{json:"terrainDataGrass.json",main:"grass.nh17",size:9437184},snow:{json:"terrainDataSnow.json",main:"snow.nh17",size:4980736},last:""};(function(){"serviceWorker"in navigator?(console.log("CLIENT: service worker registration in progress."),navigator.serviceWorker.register("/sworker.js").then(function(f){console.log("CLIENT: service worker registration complete.")},function(f){G(f);console.log("CLIENT: service worker registration failure.")}),navigator.serviceWorker.oncontrollerchange=
function(){console.log("page controlled by:",navigator.serviceWorker.controller);location.reload(!0)}):console.log("CLIENT: service worker is not supported.")})();var Cb,Yc,De,Yb,Ee,Cg,Bd,Gi,Cd,Hi,Ii,N,Fe,Dd,Xa,Dg,Da,pa,ue={},Be="ts1.mp3 ts2.mp3 ts3.mp3 ts4.mp3 ts5.mp3 ts6.mp3 ts7.mp3 ts8.mp3 ts9.mp3 ts10.mp3 sr1.mp3 sr2.mp3 sr3.mp3 sr4.mp3 sr5.mp3 sr6.mp3 sr7.mp3 sr8.mp3 sr9.mp3 sr10.mp3 o1.mp3 o2.mp3 o3.mp3 o4.mp3 o5.mp3 o6.mp3 o7.mp3 o8.mp3 o9.mp3 o10.mp3 INTRO.mp3 OUTRO.mp3 WIN1.mp3 WIN2.mp3 ATTACK.WAV BALLISTA.WAV BLDGDONE.WAV CHAT%20LOCATION.WAV TECHDONE.WAV UNITDONE.WAV CHAT.WAV E_CASTLE1.WAV E_CATHEDRAL1.WAV E_CATHEDRAL2.WAV E_FARM1.WAV E_CHURCH1.WAV E_FARM2.WAV E_HARBOR1.WAV E_LUMBER1.WAV E_MAGETOWER1.WAV E_MAGETOWER2.WAV E_MAGETOWER3.WAV E_MARKET1.WAV E_SHIPYARD1.WAV E_STABLES1.WAV E_STORAGE1.WAV E_OUTPOST1.WAV E_STORAGE2.WAV E_TAVERN1.WAV E_WARACADEMY1.WAV E_WORKSHOP1.WAV EVILCASTLE.WAV GATE1.WAV GATE2.WAV GATE3.WAV GATE4.WAV GATE5.WAV GATE6.WAV GATEWAY.WAV HOUSE1.WAV HOUSE2.WAV HOUSE3.WAV HOUSE4.WAV HOUSE5.WAV MERCHANT.WAV MINE1.WAV MONASTERY1.WAV MONASTERY2.WAV R_CATHEDRAL1.WAV R_CHURCH1.WAV SHAOLIN2.WAV SHAOLIN.WAV CHOP%201.WAV CHOP%202.WAV CHOP%203.WAV CHOP%204.WAV CHOP%205.WAV CHOP%206.WAV CHOP%207.WAV CHOP%208.WAV CHOP%209.WAV CHOP%2010.WAV CHOP%2011.WAV DIG%201.WAV DIG%202.WAV DIG%203.WAV MINE%201.WAV MINE%202.WAV MINE%203.WAV HIT%201.WAV HIT%202.WAV HIT%203.WAV HIT%204.WAV HIT%205.WAV HIT%206.WAV HIT%207.WAV GHOST1.WAV GHOST2.WAV GOLEM1.WAV GOLEM2.WAV H%20SWORD%201.WAV H%20SWORD%202.WAV H%20SWORD%203.WAV H%20SWORD%204.WAV H%20SWORD%205.WAV H%20SWORD%206.WAV H%20SWORD%207.WAV H%20SWORD%207.WAV H%20SWORD%208.WAV H%20SWORD%209.WAV H%20SWORD%2010.WAV H%20SWORD%2011.WAV H%20SWORD%2012.WAV HAND1.WAV HAND2.WAV HAND3.WAV HAND4.WAV MAGE%20ATTACK.WAV MESSIAH.WAV ORC%20SWORD%201.WAV ORC%20SWORD%202.WAV ORC%20SWORD%203.WAV ORC%20SWORD%204.WAV ORC%20SWORD%205.WAV ORC%20SWORD%206.WAV ORC%20SWORD%20V1.WAV ORC%20SWORD%20V2.WAV ORC%20SWORD%20V3.WAV SHIP%20CANNON%201.WAV SHIP%20CANNON%202.WAV SHIP%20CANNON%203.WAV SHIP%20CANNON%204.WAV SHIP%20CANNON%205.WAV SHIP%20CANNON%206.WAV SHIP%20CANNON%207.WAV SIEGE.WAV SWORD%201.WAV SWORD%202.WAV SWORD%203.WAV SWORD%204.WAV SWORD%205.WAV SWORD%206.WAV SWORD%207.WAV SWORD%208.WAV SWORD%209.WAV SWORD%2010.WAV SWORD%2011.WAV SWORD%2012.WAV SWORD%2013.WAV SWORD%2014.WAV SWORD%2015.WAV SWORD%2016.WAV V%20SWORD%201.WAV V%20SWORD%202.WAV V%20SWORD%203.WAV V%20SWORD%204.WAV V%20SWORD%205.WAV V%20SWORD%206.WAV V%20SWORD%207.WAV ADRAGON2.WAV ADRAGON3.WAV ARROW%201.WAV ARROW%202.WAV ARROW%203.WAV ARROW%204.WAV ARROW%205.WAV ARROW%206.WAV ARROW%20V1.WAV ARROW%20V2.WAV ARROW%20V3.WAV ARROW%20V4.WAV BEAR1.WAV BEAR2.WAV BEAR3.WAV BEAR4.WAV BEAR5.WAV MWORKSHOP.WAV DESTROY%20BUILDING.WAV DESTROY%20MINE.WAV LIGHTING2.WAV LIGHTING.WAV METEOR.WAV SMALL%20EXPLOSION.WAV WATER%20BLOP.WAV SPY%20KILL%201.WAV SPY%20KILL%203.WAV SPY%20KILL%202.WAV PRIEST%20ATTACK.WAV LIGHTNING.WAV INVISIBLE.WAV HEAL.WAV FREEZE.WAV FLAME%20BALL.WAV CURSE.WAV CRUSADE.WAV CONFUSION.WAV BLESS.WAV WHIRLPOOL.WAV TURN%20TO%20STONE.WAV TEACH.WAV SUMMON10.WAV SUMMON9.WAV SUMMON8.WAV SUMMON7.WAV SUMMON6.WAV SUMMON5.WAV SUMMON4.WAV SUMMON3.WAV SUMMON2.WAV SUMMON1.WAV REVEAL.WAV RESSURECT.WAV COWDIE1.WAV COWDIE2.WAV COWDIE1.WAV COWDIE3.WAV COWDIE4.WAV DIE%201.WAV DIE%202.WAV DIE%203.WAV DIE%204.WAV DIE%205.WAV DIE%206.WAV DIE%207.WAV DIE%208.WAV DIE%209.WAV DIE%2010.WAV DRAGON%20DIE%201.WAV DRAGON%20DIE%202.WAV GHOST1.WAV GHOST2.WAV GOLEM.WAV H%20DIE%201.WAV H%20DIE%202.WAV H%20DIE%203.WAV H%20DIE%204.WAV H%20DIE%205.WAV H%20DIE%206.WAV H%20DIE%207.WAV H%20DIE%208.WAV H%20DIE%209.WAV H%20DIE%2010.WAV MAGE.WAV ORC%20DIE%201.WAV ORC%20DIE%202.WAV SHIP%20SINK.WAV SIEGE%20DIE%201.WAV SIEGE%20DIE%202.WAV SIEGE%20DIE%203.WAV SIEGE%20DIE%204.WAV SKELETON%20DIE%201.WAV SKELETON%20DIE%202.WAV SKELETON%20DIE%203.WAV SKELETON%20DIE%204.WAV MESSIAH_ATTACK.WAV C%20DIE%201.WAV C%20DIE%202.WAV C%20DIE%203.WAV C%20DIE%204.WAV C%20DIE%205.WAV CAMELDIE1.WAV CAMELDIE2.WAV CAMELDIE3.WAV BAT%20ATTACK.WAV BAT%20CMD.WAV BAT%20DIE.WAV".split(" "),
Ji,td,ud,Eg=function(){if(!Cb){w.prototype.loadBuffer=function(c,f){var b=new XMLHttpRequest;b.open("GET",d+c,!0);b.responseType="arraybuffer";b.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");var e=this;b.onreadystatechange=function(){4===b.readyState&&200===b.status&&e.context.decodeAudioData(b.response).then(function(d){d&&M(d,c,f)})};b.send()};for(var f=0,c=Be.length;f<c;f++){var b=Be[f];ue[b.split(".")[0].toLowerCase()]=b}G("");Yc="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206 arrow%20v1 arrow%20v2 arrow%20v3 arrow%20v4".split(" ");
De="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206".split(" ");Yb="sword%201 sword%202 sword%203 sword%204 sword%205 sword%206 sword%207 sword%208 sword%209 sword%2010 sword%2011 sword%2012 sword%2013 sword%2014 sword%2015 sword%2016 v%20sword%201 v%20sword%202 v%20sword%203 v%20sword%204 v%20sword%205 v%20sword%206 v%20sword%207".split(" ");Ee=["siege"];Cg=["hand1","hand2","hand3","hand4"];Bd="h%20sword%201 h%20sword%202 h%20sword%203 h%20sword%204 h%20sword%205 h%20sword%206 h%20sword%207 h%20sword%208 h%20sword%209 h%20sword%2010 h%20sword%2011 h%20sword%2012".split(" ");
Gi=["ork%20sword%20v1","ork%20sword%20v2","ork%20sword%20v3"];Cd="ship%20cannon%201 ship%20cannon%202 ship%20cannon%203 ship%20cannon%204 ship%20cannon%205 ship%20cannon%206 ship%20cannon%207".split(" ");Hi=["ghost%201","ghost%202"];Ii=["mage%20attack"];N=["destroy%20building"];Fe=["siege%20die%201","siege%20die%202","siege%20die%203","siege%20die%204"];Dd="h%20die%201 h%20die%202 h%20die%203 h%20die%204 h%20die%205 h%20die%206 h%20die%207 h%20die%208 h%20die%209 h%20die%2010".split(" ");Xa="die%201 die%202 die%203 die%204 die%205 die%206 die%207 die%208 die%209 die%2010".split(" ");
Dg=["e_barrack1"];var d=y.cdn;"undefined"!==typeof AudioContext&&(window.AudioContext=window.AudioContext||window.webkitAudioContext,Cb=new AudioContext,td=Cb.createGain(),ud=Cb.createGain(),Ji=new w(Cb,void 0,M),G("Sound: OK"),td.gain.value=parseInt(localStorage.musicRange)/100,ud.gain.value=parseInt(localStorage.soundRange)/100);Da=function(){if(!v.editor){Da.id++;r("musicSelect")&&(localStorage.favMusic=r("musicSelect").mversion.value);var c=Da.list[localStorage.favMusic];c&&pa(c[~~(c.length*Math.random())],
0,0,void 0,1,0,Da.id)}};Da.reset=function(){Da.stop();Da()};Da.stop=function(){Da.active&&(Da.active.stop(),clearTimeout(Da.intv))};Da.id=0;Da.list={originalMusic1:"o1 o2 o3 o4 o5 o6 o7 o8 o9 o10 outro".split(" "),originalMusic:"ts1 ts2 ts3 ts4 ts5 ts6 ts7 ts8 ts9 ts10".split(" "),sharpRain:"sr1 sr2 sr3 sr4 sr5 sr6 sr7 sr8 sr9 sr10".split(" ")};pa=function(c,f,d,b,e,m,k){"string"!==typeof c&&(c=Be[c].split(".")[0].toLowerCase());var g=c;if((c=ue[c])&&"loading"!==c&&!v.canceled){var h=-Ta+(window.innerWidth-
y.mx)/2,l=-ya+window.innerHeight/2;if(c.duration){if(v.started)if(64<v.now()-c.lastPlayed||!c.lastPlayed)c.lastPlayed=v.now();else return;if(!(!e&&"attack"!=g&&m&&600<Date.now()-m)){if(f){f=-h+32*f;d=-l+32*d;l=P;if(f*f+d*d>Math.pow(2E3,2))return!1;f/=80;d/=80;l/=8}else l=d=f=0;void 0!==b&&b!==y.kingdom||v.mute||(b=Cb.createBufferSource(),b.buffer=c,e?(b.connect(td),td.connect(Cb.destination),Da.active=b,Da.intv=setTimeout(Da,~~(1E3*c.duration)+1E3)):(c=Cb.createPanner(),c.panningModel="HRTF",c.setPosition(f,
d,l),b.connect(c),c.connect(ud),ud.connect(Cb.destination)),b.start(0))}}else ue[g]="loading",e={x:f,y:d,k:b,music:e,date:Date.now(),mid:k},Ji.loadBuffer(c,e)}}}},Ed=function(f,c,b,d){f.img===d.url&&(pa(c+~~(Math.random()*b+1),f.x32,f.y32),setTimeout(Ed,ta(d),f,c,b,d))};"use strict";var dm=function(f){for(var c=[],b=0,d=[f.icons],g=0,h=d.length;g<h;g++)for(var q=d[g],l=0,p=q.length;l<p;l++)if(q[l]){var m=q[l];m.doneBy||(m.doneBy=[]);m.doneBy.put(f);c[b++]=m;m.xtra&&(d.put(m.xtra),h++)}f.habilities=
c},em=function(f,c){return c.balanceTotal-f.balanceTotal},Fg=function(f,c){var b=f.slice(0),d={};d[c]=Infinity;for(var g=b.length,h=0;h<g;h++){var q=d;for(var l=0;l<g;l++)if(b[l]&&b[l][c]<q[c]){q=b[l];var p=l}q==d&&(q=void 0);f[h]=q;b[p]=d}return f},Ge=function(f,c){if(!f.url.attack||f.attackOnly&&!f.attackOnly[c.type])return 0;var b=25*~~(ta(f.url.attack)/25);f=f.attack*((Fd[f.type][c.type]||0)+1);f-=c.defence;1>f&&(f=1);return~~(c.health/f)*b},rb=function(f){this.kingdom=f.k;this.aggressive=this.perfection=
1;this.cantBuild={};this.houseLoading=0;this.mineGroup={};f.IAD=rb.arr.length;rb.arr.put(this)};rb.prototype.valorateLost=function(f){this.script&&this.script.put({order:f.nu,obj:f,priority:1})};var Gg=function(f,c,b,d,g){var e=b.obj.cost;d[0]+=e[0];d[1]+=e[1];d[2]+=e[2];d[3]+=e[3];f[f.length]={order:b,priority:c.priority,name:b.obj.name,obj:b.obj,pTime:c.obj.time,required:1,doner:g};f.changed=!0},Hg=function(f,c,b,d){var e=[f],h=[],q={},l=d.target;h.put(f);for(var p=0;p<e.length;p++){var m=e[p];
m.availables&&(m.availables=void 0);if((f=m.order)&&!q[m.order.id]){q[m.order.id]=1;var k=f.requireObj;if(k)for(var n=0,r=k.length;n<r;n++)if(f=k[n],f.tech)c[f.nu.id]||Gg(e,m,f.nu,l);else{var t=b[f.type];t.length||Gg(e,m,f.nu,l)}if(k=f.doneBy)for(n=0,r=k.length;n<r;n++)f=k[n],t=b[f.type],t.length||f.race!=d.racestr||Gg(e,m,f.nu,l,1);p&&!m.doner&&h.put(m)}}return h},Ig={food:2,wood:1,gold:0,stone:3},hc=function(f,c){f=f.order;var b=f.obj,d=hc.tech;b.build?d=hc.build:b.tech||(d=hc.unit);return d(f,
c)};hc.unit=function(f,c){f=f.doneBy;if(c.pop<c.popMax)for(var b=0,d=f.length;b<d;b++)for(var g=c[f[b].type],h=0,q=g.length;h<q;h++){var l=g[h];if(l.free)return[l]}return!1};hc.tech=function(f,c){f=f.doneBy;for(var b=0,d=f.length;b<d;b++)for(var g=c[f[b].type],h=0,q=g.length;h<q;h++){var l=g[h];if(l.free)return[l]}return!1};hc.build=function(f,c,b){f=f.doneBy;b=0;for(var d=f.length;b<d;b++)for(var e=c[f[b].type],h=0,q=e.length;h<q;h++){var l=e[h];if(l.free)return[l]}return!1};hc.sPeasant=function(f){for(var c=
[10,79,64],b=[],d=0,g=0,h=c.length;g<h;g++)for(var q=f[c[g]],l=0,p=q.length;l<p;l++)q[l].free&&(b[d++]=q[l]);return b};var Zb=function(f,c,b){if(f){f=f.order;var d=f.obj,e=Zb.unit;d.tech?e=Zb.tech:d.build&&(e=Zb.build);return e(f,c,b)}};Zb.build=function(f,c,b){var d=rb.arr[c.IAD];if(4<=d.cantBuild[f.obj.type]&&c.stats.buildsLosed==d.buildsLosed)return!1;for(var e=[],h=f.doneBy,q=ua[c.k],l=0,p=h.length;l<p;l++)for(var m=q[h[l].type],k=0,n=m.length;k<n;k++){var r=A[m[k]];if(!r.func&&!r.in||b){e.put(r.id);
break}}if(!e.length)return!1;b=H;r=f.obj;f=c.origin[0];e=c.origin[1];h=e-1;q=f-1;l=rb.arr[c.IAD].reserved;if(p=l.added[r.type]){k=r.space;m=r.rbase();var t=p%b,v=~~(p/b),x=k[k.length-1];n=(k.length-1)/x*x;for(k=0;k<n&&!m(t+k%x+(~~(k/x)+v)*b);k++);if(k==n)for(l.added[r.type]=!1,k=0;k<n;k++)l[t+k%x+(~~(k/x)+v)*b]=0;else p=-1}else p=-1;0>p&&(p=He(f,e,80,h,q,c,r,900));if(0>p)return d.cantBuild[r.type]||(d.cantBuild[r.type]=0),d.cantBuild[r.type]++,d.buildsLosed=c.stats.buildsLosed,!1;d.cantBuild[r.type]&&
(d.cantBuild[r.type]=0);G(999999999,44444);return!0};var He=function(f,c,b,d,g,h,q,l){var e=rb.arr[h.IAD].reserved,m=H,k=q.space;q=q.validator.check;if(!q)return-1;for(var n=-1,r=b/2*(b/2),t=1,v=f,x=c;0>n&&f-v<b/2;){--v;--x;for(var w=2*t+1,z=2*t+1,A=0,y=w*z;A<y;A++){var C=A%w,G=~~(A/w);if(!C||!G||C==w-1||G==z-1){C+=v;G+=x;var D=(C-f)*(C-f)+(G-c)*(G-c);if(D<r&&q(C,G,k,d,g,D<l,h.k,e)){n=C+G*m;break}}}t++}return n};Zb.tech=function(f,c,b){f=f.doneBy;c=ua[c.k];b=[];for(var d=0,e=f.length;d<e;d++)for(var h=
c[f[d].type],q=0,l=h.length;q<l;q++){var p=A[h[q]];p.working||p.techStart||!p.built||b.put(p.id)}if(!b.length)return!1;G(999999999,44444);return!0};Zb.unit=function(f,c,b){f=f.doneBy;c=ua[c.k];b=[];for(var d=0,e=f.length;d<e;d++)for(var h=c[f[d].type],q=0,l=h.length;q<l;q++){var p=A[h[q]];p.working||p.techStart||!1===p.built||b.put(p.id)}if(!b.length)return!1;G(999999999,44444);return!0};rb.prototype.leaveMeAloneIKnowWhatToDo=function(){performance.now();var f=J[this.kingdom],c=f.resources,b=ua[this.kingdom],
d=H;if(f.origin){var g=f.origin[0],h=f.origin[1],q=f.race+"-"+c[0]+""+c[1]+""+c[2]+""+c[3];if(rb.precooked[q])qa=rb.precooked[q].slice(0);else{for(var l=h-1,p=g-1,m=g-40,k=h-40,n=0,r=-1,t=6400,x=0;x<t;x++){var w=x%80+m,y=~~(x/80)+k;1600>(g-w)*(g-w)+(h-y)*(h-y)&&(!(w>=p&&w<=p+2)||y>=l&&y<=l+2)&&0===Y[w+y*d]&&fa(w,y)&&n++}var C=[];performance.now();for(var E=0,L=0,N=z.length;L<N;L++){var I=z[L];if(!I.build&&!I.item&&!I.boat&&I.url.attack&&I.race==f.racestr&&8!=I.type&&void 0==I.res){C.put(I);I.balanceSum=
0;I.bestBalance=-1;I.balanceDefence={};for(var R=Infinity,O=I.attDist,S=0;S<N;S++){var M=z[S];if(!M.build&&!M.item&&!M.boat&&M.race==f.racestr&&M.url.attack&&8!=M.type&&void 0==I.res&&(E=Ge(M,I))){var V=Ge(I,M);V&&(E-=V,E+=2E3*O,E<R&&(R=E,I.bestBalance=M),I.balanceSum+=E)}}I.balanceTotal=I.balanceSum}}C.sort(em);I=C[0];for(var U=1E3,X={},P=[],aa=0,ca=U;!X[I.type];)X[I.type]=1,P[aa++]=I,P[aa++]=U,M=I.bestBalance,U=~~(U*Ge(M,I)/Ge(I,M)+.5),ca+=U,I=M;P.nu=ca-U;G(P);for(var ia=f.target,ka=D,la=ka.length,
ba=[],Q=0;Q<la;Q++){var da=ka[Q],ja;if(!(ja=!da.type||da.upgrade||da.type==W||void 0!==Ig[da.value]&&f.resources[da.value]>=ia[da.value])){a:{for(var pa=da.nu.doneBy,oa=0,sa=pa.length;oa<sa;oa++)if(pa[oa].race==f.racestr){var ra=!0;break a}ra=!1}ja=!ra}ja||ba.put({order:da.nu,obj:da,original:1,priority:1E-10})}var ma=[];x=0;t=P.length;for(var wa=P.nu;x<t;x+=2){var va=~~(.5+P[x+1]/wa*250)-b[P[x].type].length,Z=P[x],xa=Z.type;Z=Z.nu;for(var ea=0;ea<va;ea++)ba.put({order:Z,priority:1-ea/va,obj:Z.obj,
original:1})}var Ba=0,Ia=0,za=f.target,Aa={};Ia++;za[0]=0;za[1]=0;za[2]=0;za[3]=0;x=Ba=ma.length=0;for(t=ba.length;x<t;x++){var Ka=ba[x].priority,Da=Hg(ba[x],f.technology.investigated,b,f);ea=0;for(var Ea=Da.length;ea<Ea;ea++){Z=Da[ea];Z.original||(Z.priority=Ka);var Ha=1;void 0!==Z.priority&&(Ha=Z.priority);var Ja=Z.obj;Ja.increase&&void 0!==Ig[Ja.value]&&(Ha=Ja.increase*Ha/c[Ig[Ja.value]]);Ha/=Ja.time;Z.priority=Ha;if(!(0>=Z.priority)){var Ma=Z.order.id;!Aa[Ma]||Z.original?(Aa[Ma]=Ba,ma[Ba++]=Z):
ma[Aa[Ma]].priority+=Z.priority}}}var Oa=!1;Fg(ma,"priority");var Ra={},Ta={},ya={},qa=[],$a=z.length;for(x=0;x<$a;ya[x++]=0);for(x=0;x<ma.length;x++){var Fa=ma[x];Z=Fa.order;var Ca=Fa.obj;if(Fa.original||Fa.required)Fa.obj.tech||ya[Fa.obj.type]++,qa.put(Fa);var Ya=Z.doneBy,Xa=Ca.time;ea=0;for(t=Ya.length;ea<t;ea++){var ta=Ya[ea],jb=ta.time;if(ta.race===f.racestr){if(Ca){for(var qb=ta,fb=b[ta.type],gb=rb.process,ub=Xa,Ab=fb.length,Wa=!1,hb=Infinity,ib=0;ib<Ab;ib++){var Qa=A[fb[ib]],Na=0;Qa.build&&
(Qa.working||Qa.techStart||!Qa.built)&&(Qa.built?(Na=(Qa.c-v.cycle)*Ac.speed,Na/=1E3):(Na=Qa.time*(Qa.maxHealth-Qa.health)/Qa.maxHealth,Qa.workers&&Qa.workers.length&&(Na/=Qa.workers.length)));Qa.build||!Qa.func&&!Qa.in||(Na=Infinity);Qa.nato!=gb?(Qa.nato=gb,Qa.natoTime=0):Na+=Qa.natoTime;Na<hb&&(hb=Na,Wa=Qa)}Wa&&hb<=qb.time?(Wa.natoTime+=ub,Oa=Wa):Oa=!1}if(!Oa){Ra[ta.type]||(Ra[ta.type]=[],Ta[ta.type]=[]);var Ua=Ra[ta.type],nb=Ta[ta.type];ya[ta.type]||(ya[ta.type]=0);var vb=!1,La=0;for(Ea=Ua.length+
1;La<Ea;La++){if(void 0==Ua[La]){var tb={order:ta.nu,priority:0,obj:ta};ma.put(tb);qa.put(tb);Ua[La]=0;nb[La]=tb;ya[ta.type]++;vb=!0}if(Ua[La]+Xa<=jb||vb){Ua[La]+=Xa;nb[La].priority+=Fa.priority;break}}}}}}Fg(qa,"priority");var pb=0;x=0;for(t=qa.length;x<t;x++)if(Fa=qa[x].obj,Fa.build){var Va=Fa.space[Fa.space.length-1]+2,xb=(Fa.space.length-1)/Va+2;pb+=Va*xb}G(pb,n);if(pb>n){var Gb=n/pb*.7;x=0;for(t=z.length;x<t;x++)z[x].build&&(Fa=ya[x])&&((Fa=~~(Fa*Gb))||(Fa=1),ya[x]=Fa)}x=0;for(t=qa.length;x<
t;x++)Fa=qa[x].obj,Fa.build&&(ya[Fa.type]?ya[Fa.type]--:qa[x]=0);for(var Pa=qa,ab=new Uint32Array(14),bb=new Uint32Array(7),db=new Uint32Array(7),eb=new Uint32Array(7),Fb=6.25,wb=f.resources,Hb=[bb,eb,ab,db],na=0,Sa=0,Db=0;3>Db;Db++){var sb=wb[0],mb=wb[1],yb=wb[2],zb=wb[3];Infinity==sb&&Infinity==mb&&Infinity==yb&&Infinity==zb&&(Fb=-1);var Lb=0,Mb=0,Nb=0,Qb=0;na=0;for(Sa=Pa.length;na<Sa;na++)if(Pa[na]){var Bb=Pa[na].obj.cost;Lb+=Bb[0];Mb+=Bb[1];Nb+=Bb[2];Qb+=Bb[3]}if(Db){for(na=0;na<ab.length;ab[na++]=
0);for(na=0;na<bb.length;bb[na++]=0);for(na=0;na<db.length;db[na++]=0);for(na=0;na<eb.length;eb[na++]=0);}var Cb=[],Tb={},Vb={},cb={pop:0,popMax:2E3},Eb=[[]];na=0;for(Sa=b.length;na<Sa;na++){Ga=b[na];var Wb=[];cb[na]=Wb;for(var ob=0,Kb=Ga.length;ob<Kb;ob++)Wb[ob]={free:1,type:na}}for(var Za=0;9E3>Za;){var cc=10*Ie(bb)/7,dc=10*Ie(eb)/7,Xb=10*Ie(ab)/14,ec=10*Ie(db)/7;sb+=10*bb[Za%bb.length];mb+=10*eb[Za%eb.length];yb+=10*ab[Za%ab.length];zb+=10*db[Za%db.length];var Ob=Eb[Za];if(Ob)for(na=0,Sa=Ob.length;na<
Sa;na++){var $b=Ob[na],ic=$b.list;ob=0;for(Kb=ic.length;ob<Kb;ob++){var Ga=ic[ob];Ga.used||(Ga.used=!0,Cb.put(Ga.action));Ga.free=1}var fc=$b.action&&($b.action.original||$b.action.required)?!0:!1;if($b.obj.tech){Tb[$b.obj.nu.id]=1;var Yb=$b.obj;"popLimit"==Yb.value&&(cb.popMax+=Yb.increase)}else $b.obj.build||cb.pop++,cb[$b.obj.type].put({free:1,type:$b.obj.type,action:$b.action,used:fc})}na=0;for(Sa=Pa.length;na<Sa;na++)if(Ga=Pa[na]){var Zb=Ga.obj;if(Zb.peon||!(Xb<Fb)){var kb=Zb.cost;if(!(kb[0]>
sb||kb[1]>mb||kb[2]>yb||kb[3]>zb)&&1===Hg(Ga,Tb,cb,f).length&&(ic=hc(Ga,cb))){var Rb=Ga.obj.time+Za;Eb[Rb]||(Eb[Rb]=[]);if(Ga.obj.tech){if(Vb[Ga.order.id])continue;Vb[Ga.order.id]=1}Pa[na]=void 0;(Ga.original||Ga.required)&&Cb.put(Ga);for(var ac=0;ac<ic.length;ic[ac++].free=0);Eb[Rb].put({list:ic,obj:Ga.obj,action:Ga});sb-=kb[0];mb-=kb[1];yb-=kb[2];zb-=kb[3]}}}ic=hc.sPeasant(cb);na=0;for(Sa=ic.length;na<Sa;na++){var Ib=Ki(cc,dc,Xb,ec,sb,mb,yb,zb,Lb,Mb,Nb,Qb);if(0>Ib)break;2===Ib&&(mb-=200);Hb[Ib][Za%
Hb[Ib].length]++;Ga=ic[na];Ga.free=0;Ga.used||(Ga.used=!0,Cb.put(Ga.action))}Za++}Pa=Cb;Fg(Pa,"priority")}for(var lb=qa=Pa,Jb={},jc=0;jc<lb.length;jc++)lb[jc]&&!lb[jc].obj.tech&&(Jb[lb[jc].obj.name]||(Jb[lb[jc].obj.name]=0),Jb[lb[jc].obj.name]++,"Blacksmith"==lb[jc].obj.name&&G(lb[jc]));G(Jb);rb.precooked[q]=qa}this.script=qa;var Sb={},bc={added:Sb};this.reserved=bc;x=0;for(t=qa.length;x<t;x++)if((Z=qa[x])&&(Ca=Z.obj)&&Ca.build&&void 0==Sb[Ca.type]&&(r=He(g,h,80,l,p,f,Ca,900),-1<r)){w=r%d;y=~~(r/
d);xa=Ca.type;Sb[Ca.type]=r;var Ub=Ca.space;Va=Ub[Ub.length-1];xb=(Ub.length-1)/Va;var gc=Va*xb;for(ea=0;ea<gc;ea++)bc[w+ea%Va+(~~(ea/Va)+y)*d]=xa}}};var Ie=function(f){for(var c=0,b=f.length,d=0;d<b;c+=f[d++]);return c},Ki=function(f,c,b,d,g,h,q,l,p,m,k,n){if(Infinity==g&&Infinity==h&&Infinity==q&&Infinity==l)return-1;if(6.25>b)return 200>h?1:2;g=p+n+k+m;h=f+c+b+d;f/=p/g*h;c/=m/g*h;b/=k/g*h;d/=n/g*h;return f<c&&f<b&&f<d?0:c<b&&c<d?1:b<d?2:3},Li=function(){for(var f=0,c=rb.arr,b=c.length;f<b;c[f++].maintenance());
Ha({func:Li},rb.time,1);rb.process++},Mi=function(f,c,b){for(var d=f.length,e=Infinity,h=0,q=0;q<d;q++){var l=A[f[q]],p=Math.pow(c-l.x32,2)+Math.pow(b-l.y32,2);p<e&&(e=p,h=l.id)}return h};rb.prototype.maintenance=function(){var f=this.script;if(f){var c=J[this.kingdom];if(c.origin){v.blocked=!0;var e=c.technology.investigated,d=ua[c.k],g=H,h={};if(c.values.pop+c.unitLoading+5>c.values.popMax&&c.values.popMax<=c.values.popLimit){for(var q=jb[c.race].house.nu,l=0,p=0,m=c.building,k=m.length;p<k;p++){var n=
A[m[p]];n.population&&(l+=n.population)}c.values.pop+c.unitLoading+5>c.values.popMax+l&&Zb({order:q,priority:1,obj:q.obj},c,!0)}m=c.resources;q=m[0];l=m[1];var r=m[2],t=m[3],x=[];if(Infinity!=q||Infinity!=l||Infinity!=r||Infinity!=t){n=0==c.race?b.createPeon.obj:1==c.race?b.createPeon2.obj:b.createPeon1.obj;var w=0,y=0,D=0,E=0;p=0;for(k=f.length;p<k;p++)if(f[p]){var I=f[p].obj.cost;w+=I[0];y+=I[1];D+=I[2];E+=I[3]}var L=I=0,N=0,R=0,M=d[n.type];p=0;for(k=M.length;p<k;p++)if(n=A[M[p]],40==n.func)21==
A[n.funcObj.u].type?I+=10/7:R+=10/7;else if(43==n.func)N+=10/14;else if(42==n.func)L+=10/7;else{if(19==n.func&&n.stock){var O=n.stock[1];0==O?I+=10/7:1==O?L+=10/7:2==O?N+=10/14:R+=10/7}(19!=n.func||n.action)&&n.func||x.put(n)}}p=0;for(k=f.length;p<k;p++)!(n=f[p])||!n.order||h[n.order.id]||6.25>N&&!n.obj.peon||(M=Hg(n,e,d,c).length,O=n.obj.cost,O[0]>m[0]||O[1]>m[1]||O[2]>m[2]||O[3]>m[3]||1===M&&(Zb(n,c)?f[p]=0:h[n.order.id]=1));if(x.length)for(f=-Infinity,p=0,m=c.building,k=m.length;p<k;p++){n=A[m[p]];
if(n.population)break;n=n.time*(1-n.health/n.maxHealth);n>f&&(f=n)}p=0;for(k=x.length;p<k;p++)if(n=x[p],m=Ki(I,L,N,R,q,l,r,t,w,y,D,E),0==m)(m=Mi(ua[0][21],n.x32,n.y32))&&Ni(m,n,this,c);else if(1==m)Oi(n);else if(2==m){a:{n=d[20];m=n.length;for(f=0;f<m;f++)if(e=A[n[f]],!e.workers.length&&14E3<25*(v.cycle-e.lastUse)){e.lastUse=v.cycle+100;n=e;break a}n=void 0}if(n)G(999999999,44444);else{h=ua[c.k];n=H;M=bb[2];m=[];m.length=M.length;f=0;for(e=M.length;f<e;m[f]=h[M[f++]]);h=Infinity;M=z[20].space;O=-1;
f=0;for(e=m.length;f<e;f++)for(var S=m[f],U=0,V=S.length;U<V;U++){var P=A[S[U]],X=P.x32-10,Y=P.y32-10,W=P.space[P.space.length-1],aa=P.x32+.5*W;P=P.y32+.5*(P.space.length-1)/W;for(W=0;400>W;W++){var Z=W%20,ca=~~(W/20);Z+=X;ca+=Y;var da=(Z+1-aa)*(Z+1-aa)+(ca+1-P)*(ca+1-P);da<h&&Jg(Z,ca,M)[1]&&(O=Z+ca*n,h=da)}}-1<O&&(G(999999999,44444),l-=200)}}else 3==m&&(m=Mi(ua[0][22],n.x32,n.y32))&&Ni(m,n,this,c);d=!1;D=Infinity;L=c.diplomacy;w=c.origin[0];y=c.origin[1];c=ua[c.k];p=1;for(k=J.length;p<k;p++)L[p]&&
!J[p].death&&J[p].origin&&(n=J[p],E=n.origin[0]-w,I=n.origin[1]-y,E=E*E+I*I,E<D&&(D=E,d=n));if(d){E=[];p=I=0;for(k=c.length;p<k;p++)for(L=c[p],D=0,N=L.length;D<N;D++)n=A[L[D]],void 0!=n.func||n.standardFunc!=C||n.death||n.build||(E[I++]=n.id);if(60<E.length){c=d.origin[0];L=d.origin[1];m=[40,0,-40,0,0,40,0,-40];D=Infinity;p=0;for(k=m.length;p<k;p+=2)if(E=m[p],I=m[p+1],E+=w+10*Math.sign(E),I+=y+10*Math.sign(I),(E-c)*(E-c)+(L-I)*(L-I)<D&&fa(E,I)){D=(E-c)*(E-c)+(L-I)*(L-I);var ba=E+I*g}k=ba%g;ba=~~(ba/
g);w=-1;y=Infinity;c=ua[d.k];p=0;for(length=c.length;p<length;p++)for(d=c[p],D=0,E=d.length;D<E;D++)n=A[d[D]],I=(n.x32-k)*(n.x32-k)+(n.y32-ba)*(n.y32-ba),I<y&&(y=I,w=n.x32+n.y32*g);-1<w&&G(999999999,44444)}}v.blocked=!1}}};var Ni=function(f,c,b,d){c=jb[c.race].storage;var e=A[f];!A[b.mineGroup[f]]&&d.paypalTest(c.cost)?(-1<He(e.x32+2,e.y32+2,20,0,0,d,c,0)&&G(999999999,44444),b.mineGroup[f]=d.building[d.building.length-1]):G(999999999,44444)},Oi=function(f){for(var c=J[f.kingdom],b=ua[c.k],d=bb[1],
g=0,h=d.length;g<h;g++)for(var q=b[d[g]],l=0,p=q.length;l<p;l++){var m=A[q[l]];if(!m.castle){if(!1===m.built){G(999999999,44444);return}if(Pi(m.x32,m.y32,.075)){G(999999999,44444);return}}}q=c.building;g=0;for(h=q.length;g<h;g++)if(m=A[q[g]],1===m.storage){G(999999999,44444);return}b=jb[f.race].lumbermill;d=c.origin[0];q=c.origin[1];g=1;h=c.resources;l=b.cost;if(l[0]<h[0]&&l[1]<h[1]&&l[2]<h[2]&&l[3]<h[3])for(;80>g;){--d;--q;p=2*g+1;m=2*g+1;l=0;for(h=p*m;l<h;l++){var k=l%p,n=~~(l/p);if(!k||!n||k==
p-1||n==m-1)if(k+=d,n+=q,-1<Pi(k,n,.15,!0)&&-1<He(k,n,8,0,0,c,b,0)){G(999999999,44444);return}}g++}c=ua[0][7];g=c.length;h=Infinity;for(b=l=0;b<g;b++)d=A[c[b]],q=Math.pow(f.x32-d.x32,2)+Math.pow(f.y32-d.y32,2),q<h&&(h=q,l=d.id);l&&G(999999999,44444)},Pi=function(f,c,b,d){var e=H,h=f,q=c;f-=5;c-=5;for(var l=0,p=-1,m=Infinity,k=0;100>k;k++){var n=k%10,r=~~(k/10);n+=f;r+=c;if(fa(n,r)){var t=A[Y[n+r*e]];if(d&&1==t.storage)return-1;7===t.type&&(l++,n=Math.pow(n-h,2)+Math.pow(r-q,2),n<m&&(m=n,p=t.id))}}if(l/
100>=b)return p},Ri=function(f,c){var b=H,d=f[0];f=f[1];var g=f%b;b=~~(f/b);for(var h=0,q=c.length;h<q;h++){var l=A[c[h]];6400<(l.x32-g)*(l.x32-g)+(l.y32-b)*(l.y32-b)?Q(-d,l,Gd,l.url.move):Q(-f,l,Gd,l.url.move)}Kg(!1,c);Ha({func:Qi,data:{list:c,xy:-f}},3E4,1)},Qi=function(f){var c=f.list;f=f.xy;for(var b=0,d=c.length;b<d;b++){var g=A[c[b]];g.death||Q(f,g,Gd,g.url.move)}},Si=function(f){var c=f.x32+f.y32*H,b=J[f.kingdom].diplomacy;!f.invisible&&uc[c]&&(c=A[uc[c]],!c.freezed&&b[c.kingdom]&&kb(f.id,
[c.id],0,Zc))},Rc=function(f){var c=Lg(f.id);return c?(kb(c,[f.id],0,Zc),!0):!1},Lg=function(f,c){f=A[f];return x.radar(f.x32,f.y32,f.sight,f.id)},fm=function(f){f.setupINTV(Ti,0,1E3)},Ti=function(f){var c=f.free;c||(c=Ui);var b=H,d=f.x32,g=f.y32,h=[];h.length=J.length;for(var q=h.length,l=0;l<q;h[l++]=0);l=0;for(var p=c.length;l<p;l+=2){var m=c[l]+d,k=c[l+1]+g;fa(m,k)&&(m=A[Y[m+k*b]],m.nocapture||m.build||h[m.kingdom]++)}b=c=0;for(l=1;l<q;l++)h[l]>c&&(b=l,c=h[l]);c&&f.kingdom!=b&&f.changeKingdom(b);
Db(f,1E3)},Mg,gm=[1,1],Vi=function(){return Date.now()-Hd+25*x.gcycle()},Rb=function(f){if(!(f&&v.online||Rb.bySystem&&f))if(0===v.paused){v.paused=1;void 0!=Mg&&clearInterval(Mg);var c=v.now();v.pausedTime+=Date.now();f||(Rb.bySystem=1);v.now=function(){return c}}else v.pausedTime-=Date.now(),v.paused=0,Rb.bySystem=0,f&&(r("alert").style.display="none"),Mg=setInterval(Ac,Ac.speed),v.now=Vi};Rb.bySystem=0;Rb.fast=!0;var ac=function(f,c){var b=0,d=0,g=0;1>f?(f*=-1,g=~~(f/Ba),d=f%Ba):b=f;f=0;for(var h=
c.length;f<h;f++){var q=A[c[f]];q.mimg=q.url.move;x.specialMoveAdapter(q.id,b,0,0,d,g)}};ac.cursor=7;ac.allowPos=1;var Db=function(f,c,b){c=~~(c/25)+v.cycle;f.c=c;f.timestamp=v.now()},Ng=function(f){var c=A[f[0]];if(!c.death){var b=f[1],d=f[2],g=f[3];c.cow&&"milk"==b&&c.workers&&c.workers.length||(c[b]+=J[c.kingdom].values[d],d=c[b+"Max"],c[b]>d&&2!==c.blocked&&(c[b]=d));"mana"==b&&(d=c.manaTask)&&d[2]<=c[b]&&(c.blockedAction(1),Q(d[1],c,Ib[d[0]],c.url.move),c.manaTask=void 0);X(c.id,1);Ha({func:Ng,
data:f},g,1)}},Ha=function(f,c,b){f.func.url||G(f.func);f.func=f.func.url;b&&(c=~~(c/25)+v.cycle);b=Wi[c];b||(b=[],Wi[c]=b);b.put(f)},Wi={},Xi=function(f){var c=H,b=!1;f.waiting&&(f.stock&&0!==f.stock[0]?(f.mimg=f.url[f.stock[4].url],f.stock[3]===lb&&(f.mimg=f.url.milk)):f.mimg=f.url.move);var d=f.y32,g=f.x32;Og(1,f,"zone");var h=x.unitAction(f.id),q=h&&Ib[h]||!1;Na(f,32*d);var l=f.rbase();h=l.write;var p=g+d*c;Si(f);if(f.id===l(p)){var m=f.size;if(2>m)h(p,f.radix);else for(var k=m*m,n=-c,r=0;r<k;r++){var t=
r%m;0===t&&(n+=c);h(p+t+n,0)}}if(f.stop)return h(p,f.id),f.stay(),f.stop=void 0,0;if(f.kx||f.ky){var v=f.kx||0,w=f.ky||0;k=!1;if(0!==l(v+g+(w+d)*c))return f.aspettare()}else{q&&q.rev&&(k=q.rev(f))&&(G("break"),f.action=k[0],q=Ib[f.action],f.xf=k[1],f.yf=!0);if(0<(k=x.unitObjetive(f.id))){var y=A[k];if(!y||y.death&&(!q||!q.available))return h(p,f.id),f.stay();r=!0;n=!1;if(q&&q.available){n=q.available(f,y);if(!1===n)return f.aspettare();if("kill"===n)return h(p,f.id),f.stay();if(55===n)return h(p,
f.id);r=n[2]}else y.death||(n=Jb(y,f,50,f.radix));x.unitObjetive(f.id)!==k&&(y=A[x.unitObjetive(f.id)]);if(!y||y.death||y.in)return h(p,f.id),f.stay();if(!r&&(z+C*c===p||q))return f.aspettare();var z=n[0],C=n[1];if(q&&q.distance){var D=q.distance;D=0>D?f.attDist:J[f.kingdom].values[D];n=Pg(y,g,d);Id(g,d,n%H,~~(n/H),D)&&(b=2)}f==y&&(b=2)}else{z=x.unitXF(f.id);C=x.unitYF(f.id);k=l(z+C*c);if(2<k&&(!q||q&&q.rev)){k=A[k];n=Jb(k,f,50,f.radix);if(!1===n)return h(p,f.id),f.stay();z=n[0];C=n[1]}q&&q.distance&&
(D=q.distance,D=0>D?f.attDist:J[f.kingdom].values[D],Id(g,d,z,C,D)&&(b=2))}k=z+C*c;n=z;r=C;if(!b){w=x.inspector71017(g,d,n,r,f.radix,f.zLevel);void 0!==w?(v=-g+w%c,w=-d+~~(w/c)):w=v=1;if(1<Math.abs(v)||1<Math.abs(w))return f.aspettare();if(l(g+v+(d+w)*c)!==f.radix||!fa(g+v,d+w)){v=[g+1,d,g-1,d,g+1,d+1,g+1,d-1,g,d-1,g-1,d+1,g,d+1,g-1,d-1];w=H;t=Infinity;for(var I,E=0;E<v.length;E+=2)0===l(v[E]+v[E+1]*w)&&fa(v[E],v[E+1])&&t>=(v[E]-n)*(v[E]-n)+(v[E+1]-r)*(v[E+1]-r)&&(t=(v[E]-n)*(v[E]-n)+(v[E+1]-r)*(v[E+
1]-r),I=E);n=[v[I],v[I+1]];v=n[0]-g;w=n[1]-d;v=0<v?1:0>v?-1:0;w=0<w?1:0>w?-1:0;if(l(g+v+(d+w)*c)!==f.radix||!fa(g+v,d+w))return f.aspettare()}}}if(p==k||b)if(h(g+d*c,f.id),f.x32=g,f.y32=d,q){if(q.distance&&2!==b)return f.aspettare();f.stay(1);y||(y=z+C*c);q(y,f,D)}else f.stay();else{if(0===v&&0===w)return f.aspettare();f.setupDir(v,w);b=f.spd;ka(f,f.mimg,-1,f.spd/f.__proto__.spd);f.dix=v*b;f.diy=w*b;d+=w;g+=v;f.x32=g;f.y32=d;Db(f,~~(32E3/b));Sb(f,v*b,w*b,0);p=g+d*c;if(2>m)h(p,f.id);else for(k=m*m,
n=-c,r=0;r<k;r++)t=r%m,0===t&&(n+=c),h(p+t+n,f.id)}},Yi=function(f){f/=1E3;var c=~~(f/60)%60,b=~~(f/3600);f=~~(f%60);1===(f+"").length&&(f="0"+f);0!=b?(b+=":",10>c&&(c="0"+c)):b="";return b+c+":"+f},Hd=0,Zi=0,Ac=function(){if(!v.editor){v.cycle=x.gcycle();v.now();Hd&&(Zi+=Date.now()-Hd-Ac.speed);Hd=Date.now();var f=Date.now();x.movtablexe();v.cycle=x.gcycle();0===v.cycle%40&&$i();Qg+=Date.now()-f;0===v.cycle%40&&(r("topinfo").innerHTML="<span>CPU:"+(Qg/10).toFixed(2)+"%</span> <span>"+~~(Rg/Sg+.5)+
"FPS</span> <span>"+Yi(v.now())+"</span>",Rg=Sg=Qg=0);Zi>=Ac.speed&&Ac()}};Ac.speed=25;var Qg=0,Sg=0,Rg=0,Sa=function(f,c,b,d){return[f,c,b,d,f,c,b,d,f,c,b,d,f,c,b,d]};new Float32Array(Sa(1,0,0,.75));new Float32Array(Sa(1,1,1,.5));new Float32Array(Sa(0,1,0,.75));var hm=new Float32Array(Sa(0,1,0,.9));new Float32Array(Sa(.3515625,.29296875,.21875,.9));var im=new Float32Array(Sa(0,1,1,.9));new Float32Array(Sa(1,1,1,.5));var jm=new Float32Array(Sa(.3,.3,.3,.9)),km=new Float32Array(Sa(.7,.2,.2,.9));im.noAlpha=
1;jm.noAlpha=1;km.noAlpha=1;var L=function(f){f=z[f];if(1===ba.length)G(999999999,44444);else for(var c=0,b=4*Bc.shift+1;c<b;c++){var d=ba,g=Infinity;var h=-1;for(var q=0,l=d.length;q<l;q++){var p=A[d[q]];if(!p.techStart&&!1!==p.built){var m=p.icons.indexOf(f.nu);m=(p.work&&p.work[m]||0)+(v.online&&p.usedCycle==v.cycle&&p.usedTimes||0);m<g&&(!Je||m)&&(g=m,h=p.id)}}0<h&&(h=A[h],h.usedCycle!=v.cycle&&(h.usedTimes=0,h.usedCycle=v.cycle),h.usedTimes++,G(999999999,44444))}},aj=function(f,c){var b=f[0],
d=f[1],g=f[2];f=z[b];c=A[c];var h=c.icons.indexOf(f.nu);if(!(0>h||void 0!==c.techID)){performance.now();if(0==g)for(g=0;g<d;g++){var q=J[c.kingdom],l=q.mod[b].cost||f.cost;if(q.paypal(l))break;c.waitlist||(c.waitlist=[]);c.waitlist.push(b,-h-1);c.work||(c.work={});c.work[h]||(c.work[h]=0);c.work[h]++;c.working=1;q.unitLoading++;2==c.waitlist.length&&(l=1E3*f.time,c.setupINTV(Jd,0,l))}else{if(!c.work||!c.waitlist.length)return;var p=c.waitlist;q=J[c.kingdom];for(g=0;g<d;g++){l=q.mod[b].cost||f.cost;
q.setupResources(l,-1);l=p.lastIndexOf(b);if(0>l)break;p.splice(l,2);c.work[h]--;if(0==p.length){c.c=-1;c.working=0;break}q.unitLoading--;0===l&&(l=1E3*z[p[0]].time,c.setupINTV(Jd,0,l))}}X(c.id)}},bj=0,Jd=function(f){if(f.death||f.waitlist&&!f.waitlist.length)return!1;var c=f.kingdom;c=J[c];var b=c.values.pop>=c.values.popMax?t.houseLimit:t.popLimit;if(c.values.pop>=c.values.popMax||c.values.pop>=c.values.popLimit)return r("msgs1").getElementsByTagName("li"),3E4<Date.now()-bj&&c.k==y.kingdom&&bc(b,
0,5),bj=Date.now(),c.onFreePop.put(f.id),!0;c.unitLoading--;c=f.waitlist[0];b=z[c];f.work[-f.waitlist[1]-1]--;f.waitlist.splice(0,2);0<f.waitlist.length?f.setupINTV(Jd,0,1E3*b.time):f.working=0;Ke(c,f);X(f.id);return!0},Ia=function(){0==Je&&G(999999999,44444)},za=function(){0==Je&&G(999999999,44444)},cj=function(f,c){var b=f[0];f=f[1];c=A[c];var d=J[c.kingdom],g=J[c.kingdom];if(g.values.pop>=g.values.popMax&&c.kingdom===y.kingdom)return bc(t.popLimit,0,5);if(f)var h=g.values.fameTech;g=4;var q=9*
f;q||(q=1);if(f)var l=c.mlist,p=c.mlistID;else l=c.hlist,p=c.hlistID;var m=p.indexOf(b);if(!(0>m)){b=l[m].unit;var k=z[b].cost,n=h,r=1.6,v=0;1===q&&(n=0,r=3.6,v=620);if(d.paypal([v+~~(r*k[0]*q+.5)+120*n,~~(r*k[1]*q+.5),~~(r*k[2]*q+.5),~~(r*k[3]*q+.5)]))return 0;l.splice(m,1);p.splice(m,1);for(d=0;d<q;d++)p=Ke(b,c),h?p.level=g:f||(g=16,p.level=g,l=lm[p.race],p.name=l[p.id%l.length],l=p,p=l.level,l.attack+=p,l.defence+=~~(.5*p))}},Ke=function(f,c,b,d){var e=H,h=c.kingdom;c.rnd||Tg(c);var q=-1,l=-1;
if(c.point&&!c.disallowPoint){var p=c.point[0],m=c.point[1];q=dj(c,p,m,z[f].radix,z[f].rbase())[0]}else q=dj(c,q,l,z[f].radix,z[f].rbase())[1],q=q[ej(c,q.length)];l=~~(q/e);f=new $c(f,h,q%e,l,0,!1,d);popinfo(h);b||pa("unitdone",0,0,f.kingdom);if(c.point){var k;c=f||A[ba[0]];b=J[c.kingdom];"peon"==(f?c.clss:Kd)&&(k=!0);if(v.editor)k=[mm,n];else{var n=p+m*H;p=Y[n];m=0;if(c){if(2<p||(p=Le[n])&&2<p){var r=A[p];r.invisible||(k&&r.storage&&c.stock?m=Me:k&&void 0!=r.res?m=Ne:k&&r.health<r.maxHealth&&!b.diplomacy[r.kingdom]&&
r.build&&!r.dummy||r.dummy&&!r.built?m=Ld:b.diplomacy[r.kingdom]||r.dummy&&b.values.experience||r.confused?m=kb:1===r.invType&&!c.build&&!c.boat&&0<r.invMax&&Ug(c,r)&&(m=Md))}else p=Ya[n],2<p&&!c.build&&!c.boat&&(r=A[p],r.item?m=Nd:r.field&&k?m=Oe:1===r.invType&&!c.build&&!c.boat&&0<r.invMax&&Ug(c,r)&&(m=Md));0===m&&(m=Tb[c.kingdom],m[n]&&k?(p=m[n],m=Ld):(r||(p=-n),m=ac,ac.cursor=2));k=[m,p]}else k=[m,n]}n=k[1];if(k[0])k[0](n,[f.id])}return f},fj=0,gj=0,Ob,ib,ye,R=function(f){f=z[f];Ob=!1;var c=ca;
ka(c,f.img);c.active=!0;ib=f;ye=!1;G(Ob);document.addEventListener("mousemove",xg);document.addEventListener("mousedown",zd)},zd=function(f){var c=ib.validator,b=ib.space,d=sb[ib.img];0==f.button&&151<f.pageX?(f=Ub(f.pageX-y.mx-.5*d[8]/P,f.pageY-.5*d[9]/P),d=~~(.03125*f[1]),f=~~(.03125*f[0]),ib.wall?Vb(f,d):c(f,d,b,y.kingdom)[1]&&(Ob=!0,ca.active=!0,ca.x=-9999,ca.y=-9999,document.removeEventListener("mousedown",zd),G(999999999,44444),Bc.shift&&(ye?yi(ye):R(ib.type)))):(ca.active=!0,ca.x=-9999,ca.y=
-9999,Ob=!0,document.removeEventListener("mousedown",zd))},xg=function(f){var c=ib.validator,b=ib.space,d=sb[ib.img];if(Ob)document.removeEventListener("mousemove",xg);else{var g=f.pageX,h=f.pageY;if(g!=fj||h!=gj)ca.active=!0,fj=g,gj=h,g=Ub(f.pageX-y.mx-.5*d[8]/P,f.pageY-.5*d[9]/P),h=~~(.03125*g[1]),g=~~(.03125*g[0]),f=32*g,d=32*h,c=!c(g,h,b,hj.k)[1],c!=ij&&(ij=c),ca.x=f,ca.y=d}},Vg=function(f,c){var b=f[0],d=b%Ba,g=~~(b/Ba),h=v.editor?y.kingdom:A[c[0]].kingdom;b=f[1];var q=z[b],l=q.cost,p=J[h];if(!q.validator(d,
g,q.space,h)[1]||!v.editor&&p.paypal(l))return!1;f=new $c(b,h,d,g,0,!v.editor,f[2]);if(!0===f.invalid||v.editor)return!1;f.waitlist=[];if(20===b)f.built=1,d=A[c[0]],Q(f.id,d,Cc,d.url.move);else for(f.health=1,ka(f,f.bimg),f=f.id,b=0,g=c.length;b<g;b++)d=A[c[b]],d.buildList?(d.buildList.put(f),d.func!==Pe.url&&(h=Qe(d.buildList,d.x32,d.y32))&&Q(h,d,Dc,d.url.move)):(d.buildList=[f],d.func!==Pe.url&&Q(f,d,Dc,d.url.move))},ij=null,Vb=function(f,c){Vb.x=f;Vb.y=c;Ob=!0;ca.active=!0;ca.x=-9999;ca.y=-9999;
document.removeEventListener("mousedown",zd);Vb.click=!1;Vb.painted={};gc.lastFrame=Aa.frameCount-1;gc(f,c);document.addEventListener("mousemove",Wg);document.addEventListener("mouseup",jj)},gc=function(f,c){if(Vb.click)document.removeEventListener("mousemove",Wg);else if(Aa.frameCount>gc.lastFrame){Xg=!1;gc.lastFrame=Aa.frameCount;var b=Vb.x,d=Vb.y,g=0,h=Math.abs(b-f)+1,q=Math.abs(d-c)+1;b=f<b?f:b;d=c<d?c:d;var l=gc.anims;f=0;for(c=l.length;f<c;f++)tb(l[f].bufferID);for(f=l.length=0;f<h;f++)for(c=
0;c<q;c++)if(!f||!c||f===h-1||c===q-1){var p=f&&f<h-1?m.wood_horz:c&&c<q-1?m.wood_vert:ib.img;var k=f+b;var n=c+d;k={x32:k,y32:n,img:p,d:0};l[g++]=k}}};gc.anims=[];var jj=function(b){b=gc.anims;for(var c=0,f=b.length;c<f;c++){var d=b[c];G(999999999,44444);tb(d.bufferID)}b.length=0;Vb.click=!0;document.removeEventListener("mouseup",jj)},Wg=function(b){var c=sb[ib.img];b=Ub(b.pageX-y.mx-.5*c[8]/P,b.pageY-.5*c[9]/P);c=~~(.03125*b[1]);b=~~(.03125*b[0]);gc(b,c)},kj=function(b,c){b=0;for(var f=c.length;b<
f;b++){var d=A[c[b]];d.xf?d.stop=1:d.stay()}},Yg=function(b,c){b=A[c[0]];b.techStart=0;b.c=void 0;x.unitWorking(this.id,!1);c=b.techID;b.techID=void 0;if(c){var f=J[b.kingdom].technology.hidden;-1<c&&(f[c]=0);J[b.kingdom].setupResources(D[b.activeTech].cost,-1)}else if(b.lcost)J[b.kingdom].setupResources(b.lcost,-1);else return;X(b.id)},E=function(b){G(999999999,44444)},lj=function(b,c){var f=D[b],d=f.nu.id,g=A[c];f.upgrade&&(d=-1);if(void 0!==g.techID||g.waitlist&&g.waitlist.length||J[g.kingdom].paypal(f.cost))return!1;
g.activeTech=b;g.techID=d;g.setupINTV(f.type,b,1E3*f.time);g.techStart=g.c-v.cycle;b=J[A[c].kingdom].technology.hidden;-1<d&&(b[d]=1);X(c)},W=function(b,c){c=D[c];cb(b,c,c.nu.id)},Re=function(b,c){c=D[c];var f=c.nu.id,d=z[c.obj],g=J[b.kingdom].mod[d.type];Zg(b);b.img=d.img;b.attack=g.attack||d.attack;b.health=b.health/b.maxHealth*d.health;b.maxHealth=d.health;b.__proto__=d;cb(b,c,f)},Se=function(b,c){c=D[c];var f=c.nu.id;if(c.actvintv)for(var d=c.actvintv,g=0,h=d.length;g<h;g++){var q=d[g];J[b.kingdom].technology.disabled[q.id]=
0;for(var l=q.builds,p=ua[b.kingdom],m=0,k=l.length;m<k;m++)for(var n=p[l[m]],r=0,t=n.length;r<t;r++)q(A[n[r]])}cb(b,c,f)},Ja=function(b,c){c=D[c];var f=c.nu.id;J[b.kingdom].values[c.value]+=c.increase;"popMax"==c.value&&popinfo(b.kingdom);cb(b,c,f)},mj=function(b,c){c=D[c];var f=c.nu.id,d=c.group,g=J[b.kingdom],h=ua[g.k];g=g.mod;for(var q=0,l=d.length;q<l;q++)for(var p=g[d[q].type],m=h[d[q].type],k=0,n=c.values,r=n.length;k<r;k+=2){var t=n[k],v=n[k+1];p[t]||(p[t]=d[q][t]||0);for(var x=0,w=m.length;x<
w;x++)A[m[x]][t]+=v;p[t]+=v}cb(b,c,f)},Ua=function(b,c){c=D[c];var f=c.nu.id,d=c.group,g=J[b.kingdom],h=g.mod;g=ua[g.k];for(var q=0,l=d.length;q<l;q++){var p=h[d[q].type];p[c.value]||(p[c.value]=d[q][c.value]||0);p[c.value]+=c.increase;p=g[d[q].type];for(var m=0,k=p.length;m<k;m++)A[p[m]][c.value]+=c.increase}cb(b,c,f)},$g=function(b,c){c=D[c];for(var f=c.nu.id,d=J[b.kingdom].mod,g=c.mulp,h=0,q=c.group.length;h<q;h++){var l=c.group[h],p=d[l.type].cost||l.cost;d[l.type].cost=g?[~~(p[0]*g),~~(p[1]*
g),~~(p[2]*g),~~(p[3]*g)]:[p[0]-c.decrease[0],p[1]-c.decrease[1],p[2]-c.decrease[2],p[3]-c.decrease[3]]}cb(b,c,f)},ah=function(b,c){c=D[c];for(var f=c.nu.id,d=J[b.kingdom].mod,g=0,h=c.decrease,q=h.length;g<q;g+=2){var l=h[g],p=h[g+1],m=d[l.type].cost||l.cost;d[l.type].cost=[m[0]-p[0],m[1]-p[1],m[2]-p[2],m[3]-p[3]]}cb(b,c,f)},cb=function(b,c,e){b.techStart=void 0;b.activeTech=void 0;b.techID=void 0;b.func=void 0;var f=J[b.kingdom].technology,g=f.disabled;f.investigated[e]=1;x.investigateTech(f.k,e+
z.length);pa("techdone",0,0,b.kingdom);if(c=c.next)for(e=0,f=c.length;e<f;e++)g[c[e].id]--;b.standardFunc&&b.standardFunc(b);X(b.id)};"use strict";var bb,nm={icon:"food",img:"item_meat",url:"meat"},om={icon:"milk",img:"milk",url:"milk"},pm={icon:"gold",img:"item_gold",url:"gold"},qm={icon:"stone",img:"item_stone",url:"stone"},nj={icon:"wood",img:"item_tree",url:"tree"},rm={icon:"food",img:"item_food",url:"food"},Od=function(b,c,e,d){b=ua[b];var f=bb[c];c=[];c.length=f.length;for(var h=0,q=f.length;h<
q;c[h]=b[f[h++]]);b=Infinity;f=-1;for(h=0;h<c.length;h++){q=c[h];for(var l=q.length,p=0;p<l;p++){var m=A[q[p]];if(!1!==m.built){var k=m.x32,n=m.y32,r=m.space;m=r[r.length-1];r=(r.length-1)/m;m*=.5;r*=.5;k+=m;n+=r;m=.5*(m+r);k=Math.sqrt((k-e)*(k-e)+(n-d)*(n-d))-m;b>=k&&(b=k,f=q[p])}}}return f},ej=function(b,c){b=b.rnd;var f=b[0],d=b[1],g=b[2];f+=g;d-=g;f=36969*(f&65535)+(f>>16)&4294967295;d=18E3*(d&65535)+(d>>16)&4294967295;b[0]=f;b[1]=d;b[2]++;return~~((((f<<16)+d&4294967295)/4294967295+.5)*c)},Pd=
function(b){b!=oj&&(oj=b,document.body.className="ncursor"+b)},oj=-1,Nd=function(b,c){for(var f=0,d=c.length;f<d;f++){var g=A[c[f]];Q(b,g,Qd,g.url.move)}};Nd.spLevel=function(b){var c=0;2<Ya[b]&&(c=Ya[b]);return c};var Qd=function(b,c){c.stay55();if(c.inventory&&c.invMax===c.inventory.length||!b.item)return 1;Ya[b.x32+b.y32*H]=b.radix;Na(b,NaN);if(c.peon&&b.contain){var f=b.contain[1],d=b.contain[0];c.stock&&pj(c);var g=qj(c.x32,c.y32)||!1,h=b.contain[2];b.die(1);c.stock=[d,f,g,Qd.url,h];b=Od(c.kingdom,
f,c.x32,c.y32);Q(b,c,Eb,c.url[h.url]);X(c.id);return 1}c.addItem(b);X(c.id)},pj=function(b){var c=rj(b.x32,b.y32),f=~~(c/H);c%=H;c=new $c(52,b.kingdom,c,f,0);ka(c,m[b.stock[4].img]);c.contain=[b.stock[0],2,b.stock[4]]},sj=function(b,c){b=0;for(var f=c.length;b<f;b++){var d=A[c[b]];d.xf?d.stop=2:(d.stop=2,d.stay(),d.stop=void 0)}},Ue=function(b,c){var f=H;b=A[b];for(var d=0,g=c.length;d<g;d++){var h=A[c[d]];if(h.in){var q=h.rbase(),l=h.x32+h.y32*f;if(0!==q(l)||!b.build){l=b.build?Te(h,h.x32,h.y32):
Te(h,b.x32,b.y32);if(!1===l)continue;h.x32=l%H;h.y32=~~(l/H)}h.item&&(b.attack-=h.attack||0,b.defence-=h.defence||0);h.url.idle&&ka(h,h.url.idle,1);q.write(l,h.id);h.in=0;b.inventory.quit(h.id);q=1;h.z32&&(q=h.z32);Na(h,32*h.y32*q)}}X(b.id,1)},Md=function(b,c){b=A[b];if(1===b.invType)for(var f=0,d=c.length;f<d;f++){var g=A[c[f]];g==b||g.in||Q(b.id,g,bh,g.url.move)}},bh=function(b,c){var f=b.inventory;if(f.length<b.invMax){var d=c.x32,g=c.y32;c.stay55();c.rbase().write(d+g*H,c.radix);f.put(c.id);Na(c,
NaN);c.in=b.id;Rd(c.id);X(b.id)}else c.stay55()},Ld=function(b,c){for(var f=c.length,d=0;d<f;d++){var g=A[c[d]];g.buildList=!1;Q(b,g,Dc,g.url.move)}},Dc=function(b,c){if(b.dummy&&b.dummy.built)return c.stay55();if(b.health<b.maxHealth)c.dix=0,c.diy=0,c.mv=!0,c.setupDirBuild(b),ka(c,c.url.build,1),c.setupINTV(Pe,b.id,ta(c.img)),Ed(c,"hit%20",7,c.img);else{if(c.buildList&&(b=Qe(c.buildList,c.x32,c.y32)))return Q(b,c,Dc,c.url.move),0;c.stay55()}},Ve=function(b,c){return c[b]&&13==A[c[b]].type||13==A[Y[b]].type?
!0:!1},Pe=function(b,c){c=A[c];var f=b.x32,d=b.y32,g=c.x32+c.y32*H;if(c.death)return b.stay();var h=c.maxHealth,q=h/c.__proto__.time*J[b.kingdom].values.buildSpeed;c.health+=q;var l=c.health;if(0==c.built){if(1===c.health-q){for(var p=c.validator(c.x32,c.y32,c.space,c.kingdom)[0],k=c.id,n=c.validator.dimension,r=n.write,t=0,v=p.length;t<v;t++)if(2<n(p[t])){Db(b,ta(b.img));c.health-=q;return}q=Tb[c.kingdom];t=0;for(v=p.length;t<v;t++)r(p[t],k),q[p[t]]=void 0;ua[c.kingdom][c.type].put(c.id);Wb(c)}p=
~~(4*l/h);p>c.d&&(c.d=p,ka(c,c.img))}if(l>=h){l=c.health=h;X(c.id);if(!1===c.built){c.d=0;p=c.url;q=Tb[c.kingdom];13===c.type&&(Ve(g-1,q)&&Ve(g+1,q)?(p=m.wood_horz,c.child=void 0):Ve(g+H,q)&&Ve(g-H,q)&&(p=m.wood_vert,c.child=void 0));c.built=1;c.img=p;if(c.valid2)for(p=c.validator(c.x32,c.y32,c.space,c.kingdom)[2],r=c.validator.dimension.write,t=0,v=p.length;t<v;r(p[t++],0));g=c;p=J[g.kingdom];if(g.population)for(k=g.population,p.values.popMax+=k,popinfo(g.kingdom),r=0;r<k;r++)p.checkPopArray();if(g.onbuild)for(g=
g.onbuild,k=p.technology,p=k.disabled,k=k.actived,r=0;r<g.length;r++)t=g[r].id,k[t]||(k[t]=0),k[t]++,k[t]-1||p[t]--;pa("bldgdone",0,0,c.kingdom);J[c.kingdom].building.quit(c.id);X(c.id);c.standardFunc&&c.standardFunc(c)}c.action=void 0;(g=b.buildList)&&g.quit(c.id);if(!g||b.buildList&&0===b.buildList.length)b.buildList=tj(b),g=b.buildList;if(f=Qe(g,f,d))return Q(f,b,Dc,b.url.move),0;b.buildList.length=0;b.stay();b.stock&&b.stock[0]&&ka(b,b.url[b.stock[4].url])}else X(c.id),Db(b,ta(b.img));ba[0]==
c&&(mb.innerHTML=l+"/"+h,ma.value=l)},Oe=function(b,c){if(2<b)for(var f=0,d=c.length;f<d;f++){var g=A[c[f]];Q(b,g,Cc,g.url.move)}},Ne=function(b,c){var f=b;b=A[b];if(b.field)for(d=0,b=c.length;d<b;d++)g=A[c[d]],Q(f,g,Cc,g.url.move);else if(0===b.res||3===b.res){var d=0;for(b=c.length;d<b;d++){var g=A[c[d]];Q(f,g,We,g.url.move)}}else if(1===b.res)for(d=0,b=c.length;d<b;d++)g=A[c[d]],Q(f,g,Ec,g.url.move);else if(2===b.res)for(d=0,b=c.length;d<b;d++)g=A[c[d]],Q(f,g,lb,g.url.move)},uj=function(b,c){var f=
z[b],d=c.length;b=J[A[c[0]].kingdom].mod[b];for(var g=0;g<d;g++){var h=A[c[g]];h.stay();Zg(h);h.img=f.img;h.attack=b.attack||f.attack;h.health=h.health/h.maxHealth*f.health;h.maxHealth=f.health;h.defence=b.defence||f.defence;h.__proto__=f;X(h.id)}},kb=function(b,c,e,d){e=d||ad;if(!(3>b||(b=A[b],void 0!=b.res&&!b.cow||b.magicGateway))){d=0;for(var f=c.length;d<f;d++){var h=A[c[d]];h==b||h.attackOnly&&!h.attackOnly[b.type]||h.bat&&b.build||b.stoned||(h.build?e(b,h):Q(b.id,h,e,h.url.move))}}},Ec=function(b,
c){if(0<b.health){var f=c.x32,d=c.y32;c.mv=!0;c.setupDir(b.x32-f,b.y32-d);ka(c,c.url.cut,1);c.dix=0;c.diy=0;Ed(c,"chop%20",11,c.img);c.setupINTV(vj,b.id,7E3);b.addWorker(c)}else c.stay55()},vj=function(b,c){var f=H;c=A[c];var d=J[b.kingdom].values.wood;c.workers.quit(b.id);var g=Od(b.kingdom,1,b.x32,b.y32),h=A[g];c.health-=d;b.mv=!1;X(c.id);if(1>c.health){d+=c.health;Y[c.x32+c.y32*f]=0;f=ja(h.x32,h.y32);h=c.health=0;for(var q=c.workers.slice(0),l=q.length;h<l;h++){var p=A[q[h]];f?Q(f,p,Ec,b.url.move):
p.stay()}b.stock=[d,1,f,Ec.url,nj];b.mv=!1;Q(g,b,Eb,b.url.tree);X(b.id,1);c.workers.length=0;c.die()}else b.stock=[d,1,c.id,Ec.url,nj],Q(g,b,Eb,b.url.tree),X(b.id,1);if(0>g)return b.stay()},Cc=function(b,c){c.mv=!0;c.setupDir(b.x32-c.x32,b.y32-c.y32);ka(c,c.url.dig,1);Ed(c,"dig%20",3,c.img);c.setupINTV(wj,b.id,14E3);b.addWorker(c)},wj=function(b,c){c=A[c];var f=J[b.kingdom].values.food,d=b.x32,g=b.y32;c.lastUse=v.cycle;d=Od(b.kingdom,2,d,g);b.mv=!1;b.stock=[f,2,c.id,Cc.url,rm];Q(d,b,Eb,b.url.food);
X(b.id,1);if(0>d)return b.stay()},lb=function(b,c){c.mv=!0;c.setupDir(b.x32-c.x32,b.y32-c.y32);ka(c,c.url.milk1,1);c.stock=[0,2,b.id,lb.url,om];c.setupINTV(ch,b.id,1E3);b.addWorker(c);b.d=(8-c.d)%8;b.stay()},ch=function(b,c){c=A[c];c.milk-=3;var f=b.x32,d=b.y32;b.stock[0]+=3;X(b.id,1);if(0>=c.milk||c.death){if(50<b.stock[0]&&(b.stock[0]=50),b.mv=!1,c=Od(b.kingdom,2,f,d),Q(c,b,Eb,b.url.milk),0>c)return b.stay()}else Db(b,1E3)},Gd=function(b,c){c.stay55()},Zc=function(b,c){ad(b,c)},ad=function(b,c){if(1!==
b.death&&b!=c){if(b.dummy&&!J[c.kingdom].values.experience)return c.stay55();c.invisible&&bd(c.id);if(!0!==c.build){c.mv=1;var f=b.x32-c.x32,d=b.y32-c.y32;b.space&&(d=Pg(b,c.x32,c.y32),f=d%H-c.x32,d=~~(d/H)-c.y32);c.setupDir(f,d,c.d2attack);c.url.attack&&ka(c,c.url.attack,1)}c.setupINTV(Xe,b.id,c.attackTime||ta(c.img),b);b.addWorker(c)}else c.stay55()};ad.distance=-1;Zc.distance=-1;var dh=function(b,c){var f=J[b.kingdom];if(f.values.experience&&(!c||0!=f.diplomacy[c.kingdom]||c.dummy)){if(0==b.level||
null==b.level)b.level=0,b.levelProgress=0;b.levelProgress++;b.levelProgress>=~~(b.level/f.values.experience)&&b.level<f.values.maxLevel&&(b.level++,b.health+=f.values.healthJump,b.maxHealth+=f.values.healthJump,b.levelProgress=0,b.attack+=b.level,b.defence+=b.level%2,X(b.id,1))}},xj=function(b,c){b=.5-Math.atan2(c,b)/(2*Math.PI);1==b&&(b=0);return b},Xe=function(b,c){c=A[c];var f=b.attDist,d=c.x32-b.x32,g=c.y32-b.y32,h=c.x32,q=c.y32,l=!b.build;if(b.attackSound){var p=b.attackSound;pa(p[~~(p.length*
Math.random())],b.x32,b.y32)}l&&!c.build&&b.setupDir(d,g,b.d2attack);ka(b,b.img,1);if(c.death||b.level&&8<=b.level&&c.dummy||c.dummy&&b.level&&b.level>=J[b.kingdom].values.maxLevel)return b.stay();if(1<f&&!b.dragon){l=!0;var m=sb[b.attimg]}else l=!1;if(c.build||Id(c.x32,c.y32,b.x32,b.y32,f)){c.onattack(b);f=b.attack*((Fd[b.type][c.type]||0)+1);if(l){c.space&&(d=Pg(c,b.x32,b.y32),h=d%H,q=~~(d/H),d=h-b.x32,g=q-b.y32);l=0;if(b.arrow||b.ball){p=yj;var k=xj(-d,-g);var n=d;var r=g;var t=411/Math.sqrt(n*
n+r*r);n*=t;r*=t;var x=Math.sqrt(1024*d*d+g*g*1024)/Math.sqrt(n*n+r*r);b.ball&&(m[1]=m[0]/x)}else{var w=2;p=Ye;l=n=v.gravity;k=Math.PI/180*60;t=Math.cos(k);k=b.attackDeg;k*=Math.PI/180;r=Math.sin(k);x=Math.cos(k);k=32*Math.sqrt(d*d+g*g);n=x*Math.sqrt(n*k/(r*x*2));x=k/n;r=-Math.sin(Math.atan2(-d,-g));k=xj(-d,-g);n*=r;l=Math.abs(l*t*r);r=(32*g-l*x*x*.5)/x}x=Math.round(1E3*x);t={x32:b.x32+.5,y32:b.y32+.5,img:m.url,mv:b.ball,d:0,rotation:2*-k*Math.PI-3*Math.PI/2,xf:h,yf:q,obj:c.id,attack:f,range:w};Sb(t,
n,r,l);Ha({func:p,data:t},x,1)}t||c.damage(f,b);if(c.dummy){if(50<=b.dummyDamage||!b.dummyDamage)b.dummyDamage=0;b.dummyDamage+=f;50<=b.dummyDamage&&dh(b,c)}c.death?(b.action=null,c.build||b.build||dh(b,c),Rc(b)||b.stay()):Db(b,b.attackTime||ta(b.img))}else b.build&&(Rc(b)||b.stay()),b.mv=!1,0!==b.state&&Q(c.id,b,ad,b.url.move)},We=function(b,c){0<b.health?(c.dix=0,c.diy=0,c.mv=1,c.setupDirBuild(b),ka(c,c.url.kirka,1),Ed(c,"mine%20",3,c.img),c.setupINTV(zj,b.id,7E3),b.addWorker(c)):c.stay()},zj=function(b,
c){c=A[c];var f=c.res,d=J[b.kingdom].values[0==f?"gold":"stone"],g=b.x32,h=b.y32;c.health-=d/J[b.kingdom].values.miningPerf;X(c.id);1>c.health&&(d=c.health+d,c.health=0,c.d=3,c.die());b.mv=!1;g=Od(b.kingdom,f,g,h);0==f?(b.stock=[d,f,c.id,We.url,pm],Q(g,b,Eb,b.url.gold)):(b.stock=[d,f,c.id,We.url,qm],Q(g,b,Eb,b.url.stone));X(b.id,1);if(0>g)return b.stay()},Q=function(b,c,e,d){var f=0,h=0;0>=b&&(b*=-1,f=b%H,h=~~(b/H),b=0);x.specialMoveAdapter(c.id,b,e.url,d,f,h);c.mimg=d},$e=function(b,c){if(A[c[0]].boat&&
(b=-b,b=-Te(z[76],b%H,~~(b/H)),!b))return!1;Ze(c,b,Aj)};$e.allowPos=1;var Aj=function(b,c){G(b);Ue(c.id,c.inventory.slice(0));c.stay55()},Pg=function(b,c,e){var d=b.space||gm,f=d.length-1,h=d[f],q=b.x32;b=b.y32-1;for(var l=Infinity,p=0,m=0;m<f;m++){var k=m%h;k||b++;var n=(q+k-c)*(q+k-c)+(b-e)*(b-e);n<l&&d[m]&&(p=q+k+b*H,l=n)}return p},Te=function(b,c,e){var d=H,f=b.radix,h=b.rbase();for(b=2;60>=b;b+=2){c--;e--;for(var q=0;q<=b;){var l=c+q+d*e;if(h(l)===f)return l;l=c+q+d*(e+b);if(h(l)===f)return l;
q++}for(q=0;q<b-1;){q++;l=c+d*(e+q);if(h(l)===f)return l;l=c+b+d*(e+q);if(h(l)===f)return l}}return!1},rj=function(b,c){var f=H,d,g=cd;for(d=2;60>=d;d+=2){b--;c--;for(var h=0;h<=d;){var q=b+h+f*c;if(0===g(q)&&0===Y[q])return q;q=b+h+f*(c+d);if(0===g(q)&&0===Y[q])return q;h++}for(h=0;h<d-1;){h++;q=b+f*(c+h);if(0===g(q)&&0===Y[q])return q;q=b+d+f*(c+h);if(0===g(q)&&0===Y[q])return q}}return!1},Jb=function(b,c,e,d){var f=c.x32,h=c.y32,q=H,l=f+h*q,p=b.x32,m=b.y32,k=b.space;if(k){var n=k[k.length-1];k=
(k.length-1)/n;b=b.free}else k=n=1,b=Ui;c=c.rbase();for(var r,t=Infinity,v=-1,x=!1,w=0;w<e&&-1==v;){if(0==w&&b){for(var y=[],z=0,A=b.length;z<A;z+=2){var C=b[z]+p;r=b[z+1]+m;if(fa(C,r)&&(c(C+r*q)===d||C+r*q==l))a:{var D=y;C+=r*q;r=f;for(var E=h,G=H,I=Math.pow(C%G-r,2)+Math.pow(~~(C/G)-E,2),J=0,L=D.length;J<L;J++)if(Math.pow(D[J]%G-r,2)+Math.pow(~~(D[J]/G)-E,2)>I){D.splice(J,0,C);break a}D.put(C)}}y[0]&&(v=y[0]);if(-1<v){x=!0;break}if(1==e)break}w++;--p;--m;y=n+2*w;D=k+2*w;z=0;for(A=y*D;z<A;z++)r=
z%y,E=~~(z/y),r&&E&&r!=y-1&&E!=D-1||(r+=p,E+=m,C=r+E*q,c(C)==d&&fa(r,E)&&(r=(r-f)*(r-f)+(E-h)*(E-h),t>r&&(t=r,v=C)))}return-1<v?[v%q,~~(v/q),x]:!1},dj=function(b,c,e,d,g){performance.now();var f=H,q=b.x32,l=b.y32,p=b.space,m=[],k=0;if(p){var n=p[p.length-1];p=(p.length-1)/n;var r=b.free}else p=n=1;b=-1==c?-Infinity:Infinity;for(var t=-1,v=0,x=0;0==m.length;){if(r&&0==x){for(var w=0,y=r.length;w<y;w+=2){var z=r[w]+q,A=r[w+1]+l;fa(z,A)&&g(z+A*f)===d&&(m[k++]=z+A*f,v=(z-c)*(z-c)+(A-e)*(A-e),b>v&&(b=
v,t=z+A*f))}if(m.length)break}x++;--q;--l;for(w=0;w<n+2*x;w++)g(q+l*f+w)==d&&fa(q+w,l)&&(m[k++]=q+w+l*f,v=(q+w-c)*(q+w-c)+(l-e)*(l-e),b>v&&(b=v,t=q+w+l*f)),g(q+(l+p+2*x-1)*f+w)==d&&fa(q+w,l+p+2*x-1)&&(m[k++]=q+(l+p+2*x-1)*f+w,v=(q+w-c)*(q+w-c)+(l+p+2*x-1-e)*(l+p+2*x-1-e),b>v&&(b=v,t=q+(l+p+2*x-1)*f+w));for(w=1;w<p+2*x-1;w++)g(q+(l+w)*f)==d&&fa(q,l+w)&&(m[k++]=q+(l+w)*f,v=(q-c)*(q-c)+(l+w-e)*(l+w-e),b>v&&(b=v,t=q+(l+w)*f)),g(q+n+2*x-1+(l+w)*f)==d&&fa(q+n+2*x-1,l+w)&&(m[k++]=q+n+2*x-1+(l+w)*f,b>v&&
(b=v,t=q+n+2*x-1+(l+w)*f))}return[t,m]},Ui=[-1,0,-1,-1,0,-1,1,-1,1,0,1,1,0,1,-1,1],Qe=function(b,c,e){for(var d=Infinity,f=!1,h=0,q=b.length;h<q;h++){var l=b[h],p=A[b[h]];if(0!=p.built||p.death)h--,q--,b.quit(l);else{var m=p.x32;p=p.y32;p=(m-c)*(m-c)+(p-e)*(p-e);d>=p&&(d=p,f=l)}}return f},Bj=function(b,c){b=0;for(var f=c.length;b<f;b++){var d=A[c[b]];d.spd=d.__proto__.spd}},Kg=function(b,c){b=Infinity;for(var f=0,d=c.length;f<d;f++){var g=A[c[f]];g.spd<b&&(b=g.spd)}eh(b,c)},qj=function(b,c){for(var f=
H,d,g=Infinity,h=0,q=0;121>q;q++){var l=q%11-5,p=~~(q/11)-5,m=l*l+p*p;l+=b;p+=c;m<g&&(d=Ya[l+f*p],0<d&&0==Y[l+f*p]&&(d=A[d],d.contain&&(g=m,h=d.id)))}return h},Me=function(b,c){Ze(c,b,Eb)},Eb=function(b,c){b=J[c.kingdom];var f=c.stock;b.resources[f[1]]+=f[0];b.stats.resources[f[1]]+=f[0];af(c.kingdom);c.func=1;var d=Ib[f[3]],g=A[f[2]];if(d==lb){var h=c.x32;for(var q=c.y32,l=H,p,m=Infinity,k=!1,n=0;961>n;n++){var r=n%31-15,t=~~(n/31)-15,x=r*r+t*t;r+=h;t+=q;x<m&&(p=Ya[r+l*t],0<p&&0===Y[r+l*t]&&(p=A[p],
p.contain&&"meat"==p.contain[2].url&&(m=x,k=p)))}if(h=k)d=Qd,g=h}else"meat"==f[4].url&&!1===f[2]&&(h=fh(c.x32,c.y32,!0))&&(d=lb,g=h,f[2]=1);c.stock=void 0;if(!1===f[2])return c.stay();if(h=100<Math.pow(g.x32-c.x32,2)+Math.pow(g.y32-c.y32,2))a:{h=bb[1];q=ua[c.kingdom];l=0;for(m=h.length;l<m;l++)if(k=h[l],1==z[k].storage&&q[k].length){h=!0;break a}h=!1}h&&void 0!==b.IAD&&1==f[1]?(v.blocked=!0,Oi(c),v.blocked=!1):(Q(g.id,c,d,c.url.move),X(c.id,1))};Ne.cursor=6;kb.cursor=1;Ld.cursor=9;Nd.cursor=5;Md.cursor=
7;$e.cursor=7;Oe.cursor=6;Me.cursor=6;var tj=function(b){var c=H,f=b.kingdom,d=b.x32,g=b.y32;d-=16;g-=16;for(var h={},q=[],l=0,p=Tb[f],m=0;1024>m;m++){b=m%32+d;var k=~~(m/32)+g;fa(b,k)&&(b=p[b+k*c],void 0!==b&&(b=A[b],b.kingdom!=f||!1!==b.built||h[b.id]||(q[l++]=b.id,h[b.id]=1)))}return q};Ec.available=function(b,c){var f=J[b.kingdom].values.wood;if(c.death||1>c.health-f&&c.workers.length){c=ja(c.x32,c.y32);if(!c)return"kill";b.xf=c;c=A[c]}return Jb(c,b,1,b.radix)};Cc.available=function(b,c){if(c.death)return"kill";
b=c.x32+1;c=c.y32+1;return 0===Y[b+c*H]?[b,c,1]:!1};Dc.available=function(b,c){var f=b.x32,d=b.y32;if(!c.death&&c.health<c.maxHealth){var g=Jb(c,b,1,b.radix);if(g[2])return g}b.buildList?(g=b.buildList,g.quit(c.id)):(b.buildList=tj(b),g=b.buildList);c=Qe(g,f,d);if(!c)return"kill";b.xf=c;c=A[c];return Jb(c,b,1,b.radix)};Gd.rev=function(b){return 0===b.distance%3&&(b=Lg(b.id,1))?[Zc.url,b]:!1};Zc.available=function(b,c){if(0===b.distance%3){var f=Lg(b.id);f&&(b.xf=f,c=A[f])}return Jb(c,b,5,b.radix)};
Qd.available=function(b,c){if(c.death||c.in)if(c.contain)if(c=qj(c.x32,c.y32))b.xf=c,c=A[c];else return(c=fh(b.x32,b.y32,!0))?(b.stay(),Q(c.id,b,lb,b.url.move),55):"kill";else return"kill";b=c.x32;c=c.y32;return 0===Y[b+c*H]?[b,c,1]:!1};lb.available=function(b,c){if(c.workers.length||10>c.milk||c.death){c=fh(b.x32,b.y32);if(!c)return!1;b.xf=c.id}return c.xf?!1:Jb(c,b,5,b.radix)};bh.available=function(b,c){if(c.death)return"kill";var f=1;c.boat&&(f=2);return(b=Jb(c,b,f,b.radix))?(b[2]=1,b):!1};var fh=
function(b,c,e){for(var d=H,f,h=Infinity,q=!1,l=0;441>l;l++){f=l%21-10;var p=~~(l/21)-10,m=f*f+p*p;f+=b;p+=c;m<h&&(f=Y[f+d*p],0<f&&(f=A[f],f.cow&&(!f.workers.length&&f.milk>=50/1.5||e)&&(h=m,q=f)))}return q},Ze=function(b,c,e){for(var d=0,f=b.length;d<f;d++){var h=A[b[d]];Q(c,h,e,h.url.move)}},cf=function(b,c){Ma(c,b,bf)};cf.noObj=1;var bf=function(b,c){Sd(c,-b,77,bf)},ef=function(b,c){Ma(c,b,df)};ef.noObj=1;var df=function(b,c){Sd(c,-b,130,df)},gf=function(b,c){Ma(c,b,ff)};gf.noObj=1;var ff=function(b,
c){Sd(c,-b,78,ff)},jf=function(b,c){Ma(c,b,hf)};jf.noObj=1;jf.cursor=10;var hf=function(b,c){Sd(c,-b,132,hf)},lf=function(b,c){Ma(c,b,kf)};lf.cursor=10;lf.noObj=1;var kf=function(b,c){Sd(c,-b,131,kf)},Sd=function(b,c,e,d){var f=H,h=J[b.kingdom],q=z[e],l=z[e].cost,p=b.mana>b.manaMax;if(nb(b)||b.checkMana(l[4],c,d,l)){p||h.paypal(l);d=e;c*=-1;p=c%f;var m=~~(c/f),k=p,n=m,r=q.rbase(),t=~~(b.mana/l[4])+1;1<t&&(h.resources[0]-=l[0]*(t-1),b.mana-=l[4]*(t-1));for(h=0;h<t;h++)0!==r(c)&&(e=Te(q,p,m),k=e%f,
n=~~(e/f)),pa("summon"+~~(10*Math.random()+1),k,n),e=new $c(d,b.kingdom,k,n,0),e.setupChild(lc.spawn);b.setupDir(-b.x32+e.x32,-b.y32+e.y32);b.setupSpellIMG()}else h.paypal(l);X(b.id)},Id=function(b,c,e,d,g){return~~Math.sqrt((b-e)*(b-e)+(c-d)*(c-d))<=g},gh=function(b,c){Ma(c,b,mf)};gh.cursor=0;var mf=function(b,c){b.build||b.terrain||b.nofreeze||!nb(c)&&!c.checkMana(50,b.id,mf)||(b.freezed=1,b.stoned=1,Na(b,32*b.y32),b.stay(),ka(b,b.img,0),b.setupChild(lc.turnStone),Rd(b.id),c.setupDir(-c.x32+b.x32,
-c.y32+b.y32),c.setupSpellIMG(),pa("turn%20to%20stone",c.x32,c.y32),Ha({func:Cj,data:b.id},24E4,1))},Cj=function(b){b=A[b];b.freezed=0;Wb(b);b.stoned=0},hh=function(b,c){Ma(c,b,Td)},Td=function(b,c){b.health<b.maxHealth&&!b.build?(c.setupDir(b.x32-c.x32,b.y32-c.y32),G("heal",ta(c.img)),c.setupSpellIMG(!0),c.setupINTV(Dj,b.id,0),b.addWorker(c)):c.stay()},Fj=function(){Ma(list,obj,Ej)},Ej=function(){},Dj=function(b,c){c=A[c];var f=J[b.kingdom].values.healingRange;pa("heal",b.x32,b.y32);if(!Id(c.x32,
c.y32,b.x32,b.y32,f))return Q(c.id,b,Td,b.url.move);if(nb(b)||b.checkMana(4,c.id,Td)){b.setupDir(c.x32-b.x32,c.y32-b.y32);c.health+=6;c.setupChild(lc.heal);if(c.health>=c.maxHealth)return c.health=c.maxHealth,X(c.id,1),X(b.id,1),b.stay();X(c.id,1);X(b.id,1);Db(b,ta(b.url.spell))}},of=function(b,c){Ma(c,b,nf)};of.cursor=10;var Gj=function(f,c){f=A[f];c=A[c];if(f.inventory.quit(c.id)){c=b[c.spell];f.icons==f.__proto__.icons&&(f.icons=f.icons.slice(0));f.icons.put(c);var e=f.icons;e.olegal||(e.olegal=
{});e.olegal[c.id]=1;X(f.id)}},pf=function(b,c){var f=c[1];c=A[c[0]];A[b].nopotion||A[b].build||(Q(b,c,Hj,c.url.move),c.actionItem=f)};pf.item=1;var Hj=function(b,c){var f=A[c.actionItem];c.actionItem=void 0;f.attack&&(b.attack+=f.attack);f.defence&&(b.defence+=f.defence);f.mana&&(b.mana||(b.mana=0,b.manaMax=0,b.update?b.update.push("mana","manaSpeed",1E3):b.update=["mana","manaSpeed",1E3],Ha({func:Ng,data:[b.id,"mana","manaSpeed",1E3]},1E3,1)),b.manaMax+=f.mana,b.mana+=f.mana);f.level&&(b.level||
(b.level=0),b.level+=f.level);pa("bless",b.x32,b.y32);c.inventory.quit(f.id);c.stay55();X(c.id);X(b.id)};pf.cursor=10;hh.cursor=10;cf.cursor=10;ef.cursor=10;gf.cursor=10;var jh=function(b,c){Ma(c,b,ih)};jh.cursor=1;var ih=function(b,c){if(b.isSpy&&b==c)c.stay55();else if(nb(c)||c.checkMana(90,b.id,ih))c.setupDir(-c.x32+b.x32,-c.y32+b.y32),ka(c,c.url.attack,1),Ha({func:Ij,data:[b,c]},ta(c.img)-25,1)},Ij=function(f){var c=f[1];f=f[0];f.die(1);var e=f.rbase().write;e(c.x32+c.y32*H,c.radix);c.x32=f.x32;
c.y32=f.y32;c.d=f.d;c.name=c.name;c.attack=f.attack;c.defence=f.defence;c.update=c.update;c.mana=0;c.manaMax=c.manaMax;e(c.x32+c.y32*H,c.id);Na(c,32*c.y32);c.__proto__=f.__proto__;ka(c,c.url.idle);e=f.icons.slice(0);e.quit(b.menuBuilds);e.quit(b.menuBuilds1);e.quit(b.menuBuilds2);e.put(b.impersonate);e.put(b.revealSelf);c.icons=e;c.spy||(c.spy=c.kingdom);c.kingdom!==f.kingdom&&c.changeKingdom(f.kingdom);c.setupChild(lc.impersonate);X(c.id)},Jj=function(b){b=A[b];if(b.spy){var c=z[2];b.attack=c.attack;
b.defence=c.defence;b.__proto__=c;b.icons=c.icons;b.kingdom!==b.spy?b.changeKingdom(b.spy):b.stay();ka(b,b.url.idle);X(b.id);b.spy=void 0}};of.allowPos=1;var nf=function(b,c){if(b.id){var f=b.id,d=b.x32;b=b.y32}else f=-b,d=b%H,b=~~(b/H);if(nb(c)||c.checkMana(60,f,nf)){c.setupDir(-c.x32+d,-c.y32+b);c.setupSpellIMG();f=8;d-=.5*f;b-=.5*f;var g=[];f+=1;var h=f*f;pa("bless",c.x32,c.y32);for(c=0;c<h;c++)for(var q=1;3>q;q++){var l=A[(0,qf[q])(c%f+d+(~~(c/f)+b)*H)];l.build||l.terrain||(l.setupChild(lc.bless),
l.blessed||(l.blessed=1,l.attack+=5,X(l.id,1),g.put(l)))}Ha({func:Kj,data:g},3E4,1)}},Ma=function(b,c,e){if(b[1]&&A[b[1]].item){var d=b[1];b.length--;Ze(b,c,e);A[b[0]].actionItem=d}else Ze(b,c,e)},nb=function(b){var c=b.actionItem;if(!c)return!1;c=A[c];c.attack&&(c.attack--,0===c.attack&&(b.inventory.quit(c.id),X(b.id)));return!0},Kj=function(b){for(var c=0,f=b.length;c<f;c++){var d=b[c];d.blessed=void 0;d.attack-=5;X(d.id,1)}},kh=function(b,c){Ma(c,b,rf)};kh.cursor=10;var rf=function(b,c){b.freezed||
!nb(c)&&!c.checkMana(50,b.id,rf)?c.stay55():(c.setupDir(-c.x32+b.x32,-c.y32+b.y32),b!==c&&c.setupSpellIMG(),pa("invisible",b.x32,b.y32),b.invisible||(b.invisible=1,b.stay()),X(b.id),Ha({func:bd,data:b.id},5E4,1))},bd=function(b){b=A[b];b.death||(b.invisible=void 0,Wb(b),Si(b))},lh=function(b,c){Ma(c,b,sf)};lh.cursor=0;var sf=function(b,c){if(nb(c)||c.checkMana(50,b.id,sf))c.setupDir(-c.x32+b.x32,-c.y32+b.y32),c.setupSpellIMG(),pa("lightning",c.x32,c.y32),b.damage(50,c)},uf=function(b,c){Ma(c,b,tf)};
uf.cursor=0;uf.noObj=1;var tf=function(b,c){var f=H;if(b.id){var d=b.id,g=b.x32;b=b.y32}else d=-b,g=b%f,b=~~(b/f);if(nb(c)||c.checkMana(50,d,tf)){c.setupDir(-c.x32+g,-c.y32+b);c.setupSpellIMG();pa("flame%20ball",g,b);var h=g-c.x32,q=b-c.y32,l=Math.sqrt(h*h+q*q);h/=l;q/=l;var p=c.x32+.5,m=c.y32+.5;d=[];g=[];var k=0;for(b=0;b<l;b++){var n=p+h*b;var r=m+q*b;g.put(n);g.put(r);n=~~n;r=~~r;d[k++]=n+r*f;d[k++]=~~(n+q)+~~(r+h)*f;d[k++]=~~(n-q)+~~(r-h)*f}for(b=0;b<0*d.length;b++)h=d[b]%f,q=~~(d[b]/f),l=Object.assign({},
Ud.food),l.x32=h,l.y32=q,l.z32=2,Vd.new(l,5E3);Ha({func:mh,data:{list:d,anim:g,i:2,a:c}},1E3,1)}},nh=function(b,c){Ma(c,b,Wd)};nh.cursor=10;var Wd=function(b,c){c.setupDir(-c.x32+b.x32,-c.y32+b.y32);c.setupSpellIMG(!0);c.setupINTV(sm,b.id,0);b.addWorker(c)},sm=function(b,c){c=A[c];if(!Id(c.x32,c.y32,b.x32,b.y32,J[b.kingdom].values.teachDistance))return Q(c.id,b,Wd,b.url.move);if(c.level>=b.level)return b.stay();if(nb(b)||b.checkMana(10,c.id,Wd))pa("teach",b.x32,b.y32),b.setupDir(c.x32-b.x32,c.y32-
b.y32),c.setupChild(lc.curse,!1,hm),dh(c,!1),X(c.id,1),X(b.id,1),Db(b,ta(b.url.spell))},wf=function(b,c){Ma(c,b,vf)};wf.cursor=0;wf.noObj=1;var vf=function(b,c){var f=H;if(b.id){var d=b.id,g=b.x32;b=b.y32}else d=-b,g=b%f,b=~~(b/f);if(nb(c)||c.checkMana(70,d,vf)){c.setupDir(-c.x32+g,-c.y32+b);c.setupSpellIMG();d=g;var h=b;g-=8;b-=8;for(var q=0;256>q;q++){var l=g+q%16,p=~~(q/16)+b,m=l+p*f;fa(l,p)&&64>=Math.pow(l-d,2)+Math.pow(p-h,2)&&oh[m]&&0===Y[xy]&&(G(l,p),new $c(60,c.kingdom,l,p,0))}}},mh=function(b){var c=
b.list,f=b.anim,d=b.i,g=b.a,h={x32:f[2*d],y32:f[2*d+1],d:0,img:m.flame_trail,mv:1,z32:2,alpha:!0};Vd.new(h,ta(h.img));for(h=0;3>h;h++){var q=A[Y[c[h+3*d]]];q.health&&q.damage(96,g)}b.i++;b.i<.5*f.length&&Ha({func:mh,data:b},50,1)},yf=function(b,c){Ma(c,b,xf)};yf.cursor=0;yf.noObj=1;var xf=function(b,c){if(b.id){var f=b.id,d=b.x32;b=b.y32}else f=-b,d=b%H,b=~~(b/H);if(nb(c)||c.checkMana(60,f,xf))c.setupDir(-c.x32+d,-c.y32+b),c.setupSpellIMG(),pa("freeze",d,b),Ha({func:Lj,data:[d,b]},1E3,1)},Af=function(b,
c){Ma(c,b,zf)};Af.cursor=0;Af.noObj=1;var zf=function(b,c){if(b.id){var f=b.id,d=b.x32;b=b.y32}else f=-b,d=b%H,b=~~(b/H);if(nb(c)||c.checkMana(70,f,zf)){c.setupDir(-c.x32+d,-c.y32+b);c.setupSpellIMG();pa("confusion",d,b);c=4;d-=.5*c;b-=.5*c;f=H;var g=[];c+=1;for(var h=c*c,q=0;q<h;q++)for(var l=1;3>l;l++){var p=A[(0,qf[l])(q%c+d+(~~(q/c)+b)*f)];p.build||p.terrain||p.stoned||(p.confused=1,p.invisible&&bd(p),p.stay(),g.put(p),Rd(p.id))}h&&1===ba.length&&X(ba[0]);g.length&&Ha({func:Mj,data:g},2E4,1)}},
Mj=function(b){for(var c=0,f=b.length;c<f;c++){var d=b[c];d.confused=void 0;d.death||(ka(d,d.img,1),Wb(d),d.stay(),db==d&&(db=void 0,ba[0]=d.id,X(d.id)))}},Lj=function(b){var c=6,f=b[0]-.5*c,d=b[1]-.5*c,g=H,h=[];c+=1;var q=c*c;b={img:m.freeze_expl,d:0,mv:1,x32:b[0],y32:b[1]};Vd.new(b,ta(b.img));for(var l=0;l<q;l++)for(var p=1;3>p;p++)b=A[(0,qf[p])(l%c+f+(~~(l/c)+d)*g)],b.build||b.terrain||b.nofreeze||b.stoned||(b.freezed=1,Na(b,32*b.y32),b.stay(),ka(b,b.img,0),b.invisible&&bd(b),b.health-=40,1>b.health&&
(b.health=1),h.put(b),Rd(b.id));q&&1===ba.length&&X(ba[0]);Ha({func:Nj,data:h},2E4,1)},Nj=function(b){for(var c=0,f=b.length;c<f;c++){var d=b[c];d.freezed=void 0;d.death||(ka(d,d.img,1),Wb(d),db==d&&(db=void 0,ba[0]=d.id,X(d.id)))}},Cf=function(b,c){Ma(c,b,Bf)};Cf.cursor=0;Cf.noObj=1;var Bf=function(b,c){if(b.id){var f=b.id,d=b.x32;b=b.y32}else f=-b,d=b%H,b=~~(b/H);if(nb(c)||c.checkMana(100,f,Bf))c.setupDir(-c.x32+d,-c.y32+b),c.setupSpellIMG(),ph(d,b,3,20,4500,c.id)},ph=function(b,c,e,d,g,h){for(var f=
m.fire_rain,l=v.gravity,p=Date.now(),k=ph.rnd,n=Math.PI,r=performance.now(),t=0;t<d;t++){var x=2*k()*n,w=e*k(),y=b+w*Math.cos(x);x=c+w*Math.sin(x);w=~~(t/d*g);fa(y,x)&&Ha({func:Oj,data:{x32:y,y32:x-6,dix:0,diy:140,img:f,mv:1,d:0,timestamp:p,finnish:Infinity,aceleration:l,attack:40,xf:y,yf:x,range:2,kingdom:0,obj:h,crashTime:(Math.sqrt(19600+384*l)-140)/l*1E3}},w,1)}G(performance.now()-r)},Oj=function(b){Ha({func:Ye,data:b},b.crashTime,1)};ph.rnd=function(){var b=4096,c=2048;return function(){c=36969*
(c&65535)+(c>>16)&4294967295;b=18E3*(b&65535)+(b>>16)&4294967295;return((c<<16)+b&4294967295)/4294967296+.5}}();var tb=function(b){Xd(-1E4,0,0,b);tm.put(b)},Zg=function(b){if(b=b.childLoc)for(var c=0,f=b.length;c<f;c++)tb(b[c])},yj=function(b){A[b.obj].damage(b.attack,A[b.obj]);tb(b.bufferID)},Pj=function(b){b=A[b];void 0!=b.bufferID&&tb(b.bufferID);oh[b.x32+b.y32*H]=void 0},Ye=function(b){var c=H,f=b.xf,d=b.yf,g=b.attack;b.mv=1;b.func=void 0;b.x32=f;b.y32=d;Sb(b,0,0,0);Na(b,2);f=~~f;d=~~d;var h=
f+d*c,q=Y[h];ob[h]?(b.img=m.expl_small_water,pa("water%blop",b.x32,b.y32)):(b.img=m.expl_small_hole,pa("small%20explosion",b.x32,b.y32));ka(b,b.img,1);Vd.new(b,Qj(sb[b.img]));if(ob[h]){if(q=Ya[h],2<q){var l=A[q];l.damage(g,A[b.obj])}}else{2<q&&(l=A[q],l.damage(g,A[b.obj]));h=b.range;q=2*h+1;for(var p=0,k=q*q;p<k;p++){l=p%q-h;var n=~~(p/q)-h,r=~~Math.sqrt(l*l+n*n);r<h&&(l+=f,n+=d,l=Y[l+n*c],2<l&&(l=A[l],l.damage(g*(1-r/h),A[b.obj])))}}},um=function(b){if(0<ba.length){var c=A[ba[0]],f=0,d=0,g=0,h=0;
void 0!==c.dix&&(b=.001*(b-c.timestamp),h=c.dix,g=c.diy,f=h*b,d=g*b);if(c.space){var q=c.space;b=q[q.length-1];q=(q.length-1)/b}else q=b=1;f+=32*(c.x32+.5*b-Math.sign(h))+.5*-tzar.width+.5;d+=32*(c.y32+.5*q-Math.sign(g))+.5*-tzar.height+.5;Ta=~~-f;ya=~~-d;dd(-Ta,-ya)}},Rj=function(){};Td.distance="healingRange";bf.distance="createGolemRange";nf.distance="blessDistance";xf.distance="freezeDistance";zf.distance="confusionDistance";rf.distance="invisibilityDistance";sf.distance="lightningDistance";ff.distance=
"createBatDistance";df.distance="createDragonDistance";kf.distance="createCarpetDistance";hf.distance="createJinnDistance";mf.distance="turnToStoneDistance";tf.distance="flameBoltDistance";Bf.distance="fireRainDistance";vf.distance="freezeDistance";Wd.distance="teachDistance";var J=[];var Fc=function(b,c,e,d,g,h,q){this.name=b;this.k=J.length;h||(h=[0,0,0,0]);this.color=c;this.status="";this.stats={dmgInflicted:0,dmgTaken:0,resources:[0,0,0,0],score:0,unitsKilled:0,unitsLosed:0,buildsLosed:0,buildsDestroyed:0,
unitCount:new Uint32Array(z.length),unitCountMax:new Uint32Array(z.length),unitCountDeath:new Uint32Array(z.length),goldTraded:0,goldConverted:0,stoneTraded:0};this.team=q;this.resources=h||[5E4,5E4,5E4,5E4];this.values={gold:10,wood:10,food:10,stone:10,buildSpeed:1,experience:0,healthJump:0,maxLevel:4,pop:0,popMax:v.freePop||1,popLimit:200,healingRange:1,blessDistance:9,createGolemRange:5,freezeDistance:13,invisibilityDistance:9,createBatDistance:16,lightningDistance:12,createDragonDistance:4,turnToStoneDistance:21,
flameBoltDistance:19,fameTech:0,confusionDistance:13,manaSpeed:2,milkSpeed:2,cowSpeed:2,stealCow:0,miningPerf:1,fireRainDistance:15,createCarpetDistance:3,createJinnDistance:3,teachDistance:2};this.race=d;this.racestr=Sj[d];this.IA=g||0;this.building=[];this.diplomacy=e;this.control={};this.control[this.k]=1;this.onFreePop=[];b=[];b.length0function=vm;this.unitLoading=0;this.target=[0,0,0,0];this.crusade={number:0,list:b};this.technology={hidden:{},disabled:{},actived:{},investigated:{}};this.mod=
b=[];wm[this.racestr]++;c=0;for(e=z.length;c<e;b[c++]={});J[J.length]=this;c=this.k;b=[];Tb[c]={};ua[c]=b;for(c=0;c<z.length;c++)b[c]=[]};Fc.prototype.setupResources=function(b,c){var f=this.resources;c||(c=1);f[0]-=b[0]*c;f[1]-=b[1]*c;f[2]-=b[2]*c;f[3]-=b[3]*c;x.setupResources(-b[0]*c,-b[1]*c,-b[2]*c,-b[3]*c,f.k);af(this.k)};var ua=[];var Tb=[];Fc.prototype.check=function(){if(this.values.pop)return!0;for(var b=xm,c=ua[this.k],e=0,d=z.length;e<d;e++)if(!b[e]&&0<c[e].length)return!0;this.die()};Fc.prototype.checkPopArray=
function(){if(this.onFreePop.length)for(;!Jd(this.onFreePop.shift())&&this.onFreePop.length;);};Fc.prototype.die=function(){this.death||(this.death=1,this.status="defeated",qh(),bc(rh(t.playerDefeated,this.name),0,5))};Fc.prototype.paypal=function(b){var c=this.resources,f=!1,d=this.k;c[0]<b[0]&&(Df(d,t.gold),f=!0);c[1]<b[1]&&(Df(d,t.wood),f=!0);c[2]<b[2]&&(Df(d,t.food),f=!0);c[3]<b[3]&&(Df(d,t.stone),f=!0);if(f)return f;c[0]-=b[0];c[1]-=b[1];c[2]-=b[2];c[3]-=b[3];x.setupResources(b[0],b[1],b[2],
b[3],d.k);af(this.k)};Fc.prototype.paypalTest=function(b){var c=this.resources;return b[0]>c[0]||b[1]>c[1]||b[2]>c[2]||b[3]>c[3]?!1:!0};var Df=function(b,c){b==y.kingdom&&bc(rh(t.notEnough,c),0,5)},af=function(b,c,e,d){b==Math.pow(2,31)-1&&(b="***");c==Math.pow(2,31)-1&&(c="***");e==Math.pow(2,31)-1&&(e="***");d==Math.pow(2,31)-1&&(d="***");Tj.innerHTML=b;Uj.innerHTML=c;Vj.innerHTML=e;Wj.innerHTML=d},xm={13:1,20:1,21:1,22:1,27:1,32:1,35:1,36:1,43:1,44:1,55:1,56:1,57:1},hj;var Xj=[];(function(){var b=
"",c=new Image;c.src="data:image/gif;base64,R0lGODlhIQB2AfcAAAAAABAIAAgAABEhACE6ABkbChAQAAgIABAQCO/vlN7epf/6hZSQUv76n721a//rY/XmhnNjECklEP7oecW1Y+7ZeP/rhvvrljEpCCgiB+/Wa97OjP/WSu3YhyEZAIhzLf/WWOnHWv7baL2lVt3Db/vsvUo3BGtSCGhVIdq1SnhjKdy4V62USuvIaPzad/felO/XlzopAGtaMe3Kd/zbiOjMhv/9+JxzGWNKECEZCP/JSuu5Sc6lSMynV4tzPdSyaK2UWjEhADopCNacKWNKGVdCGf/IVuu4VruUSPzJZ7qYU0IqABkQAGdFB2tKEFI6D5tzKMqVN9unSNyrVlRDI/nLd7JwACkZAOaUEDEhCMSMMZRrKYlkJ/u3SJt0M8yYRquDQO66Zu3MlrWcc5haAItSAf+lGUIqCGNCEJdjGXpTGJxrIfisOGtKGcSNOtacQruHOfu6VsiYVOm6dPvLh/rZqTohAHdHB3NKEFo6D0kxEJRjIc6MMalzKYRaIZxrKXlTIuCcP6x5M+umR1I6GX5aKdacSuqqVdedUollNK2HVUopAFQxBXtKEGtCEMmBJ7h2J3NKGdeNNMOCMWNBGZRjKf2rR86MOtaUQpdpMt6cSrqFQkk0GnVWL9OjZolVGeeQLJ5jIKdqJ4xaIeCTObd6NembRt6UQsWEPGlHIf+tUsuMQ9aUSppyRzEZAGU1BkopCHNCEDohCFIxECkZCPeXM3tKGdKDMIRSIZxjKlo6Gc6EOoxaKahwNt6USjUkE/zLmUIgACEQAIZLEtZ2H5ZUF2Y6ELlpIN9/KGtBGUUpEHVKIRkQCNaMRntCEHNCGZdZI86MUjoZAFQoBs5qIF0xECUZEE8hAHQ0CIQ9C5RHD65TFb5cGXY6EDEZCHtCGYRKIVIxGSkQAEohCEIfCVIpEKJEEUUpGWgnBzoZCEIzKzEQABkIAHMpCIw0CyEQCFsZAlEZBikQCDQZECEHAD4PATEQCGshEDEIAPNGKRkAABAAABkICBAICAgICP///yH5BAEAAP8ALAAAAAAhAHYBAAj/AP8JHEiwIEEBBhMqXPiP3QGEAwVAZKgQYoBwLAIMpIUCwESKE5lI/CeA0woU+wTSIvHk40IBD/9x+vHrnYB9+358EbdPwDsavfi5NMiEChcA/5i0QIKrzTsANeQoC+DzAhJvKYcK3AeoAheqAlbo0XNGlpIKR5axEyChwwo/U7UK+EWiAxRdgH5RGnWpD6ArwpCUWlaES40WX0pRompQwIcXLbR8ObKi1BdUcXatMsZuFCUuUtxKidLr11ABT5Ag+tIHjK5MYb5UilPqlK0rVwKkmiJFyyVBpgsyCRCAEpIvyubJC4CkCq9Rh3JhqiRSAJQvcPgIUgaTIIofMvL8/5hCKwfEHmEiDcq0CtosdklHjeoDaSpSgQKoWGjRowMYWh4JlEgYm4wyhR+buaKLAEwoQ4gfs9CikUBM/OBWCytEAuBESIThhyZbVGILOU+QJEAOhFBCyy/44QDDDFKsgJwwqRA0oBejiBJJMmecYSIAOSxjjzf4jeLCFNi9ocxugAyk3hSVhIILGmd4U6KJ77yTAzu/cMIOZXBQ4gcsRXyRhB4CPXEJHT2U4kUyeggzS0QCABAAHD0koUIP/HkjzwH/+ODCFz7qUQoNM3zBVB5X+GjQLGBQtkIHSTxDXAB5wGFBGEUUcUsVF8SWSzJZyJLQTZUc0cIMK7ghhAAZ/P9DySAWuBCHKYdcMMMUgkQSZxGnyiPFF27wIAUX9hgQQBu4DOKCrVLQUMURboySBxNonurFCmn4UYoWfsiT0l6TDBLHIWGEgeQfaAQhREXhrADHLLrgIsgswgiURySiuCEFK4dg4oYoz5yhlUDiRCEFJfZk0UYeNgkkizGfiCJKKajAkYstswTQpEKzVsIOO+Rk4Y1IAglzRh7OQFOKIKF8wmgWClHVhyRFBOARLbRMxI4wsDgSSh99jJKMLKfNxY4abgiii851fiQAO64Yc4woebiCckE5qFCFEnB8IcUWv2zdmDDDSCMRg40RIkgILVAmxRPvTJjQPuwA4FG+pzL/w8UkYGCXzC8BJkSVnSBloYssnMxSsgEHU2RQFjoH4I0wkUuuEAB4Z655RZ8rVAIgzIQeehx0RMKE6Z9XkcQspbNOESZ0xAG77BQFAoztseOukO6WlNO77waZUocls+RAvEKHHJ/88gk1X4sxtEBvUBh1sGGM8tYTNIgNtXzC/T9kVA99IOA/f0cJtYxPPB82gHLHP03QYAU93fOBzDE5bGLKK90byB1I4Q3zdS8PjGhCCaxgQOjdwQZWMAMtzIAFmlmPBmzIAiX+8YohlKEM81teGXg2kDLYgAZkCOBAmlCLWtxHhf/4IAxnSMMa2vCGOMyhDnfIwx768B82QEMN/2dgg3fN0BNhsAERZtgKRMDABsaYISvCAIMSPINIAczEEeRQhxK8woLWe8UOLrGCElzAFukIIB+O8IgpXGAOr0hHH6yXiyQkRgwwSMIdvGGx5anBCFNYhSjmMIcj3MAbgIDE8jQRBkQIYg3j2YEUZBELLRAPCUk4hBy4kAs5wEFh8nDEG6KAuyZkcgpwaEQvFCGIK3jjDIx4xA5wd4QjBPITjviDMITBjiysCAMvDF0f4iCFUkBDDx6QhTVmIY/CyY4eSZACKi5BjgA0QgtbkEUDZReFHexAHOKoRAPC0IZXLm8ZIBCHzvTgiVKlwhrLO4cx9oEUAGSAFnKYAhf6of9CABxAEDtIhCxMAMMA7OEMPSiGGmDIiDF0AAnQgOEBQFEDRgSzeyYoBqZ+yNGOevSjIA2pSAVygic0gXVLkFwT3BGPeIQOHYx4wkUL0gRzcCMe2KiH5tCBDnfo7R/kUIg79hcPdLhUcuiwqUvrwQiDtJQatQiEOdxBAKQO9RgR6GlCpsENZOgAGdxoRzAo8tSoTpUA7RhIPYo6VB3ooAuSaCpFuOpVsLZDrsFohzt4So0u6MAIICjGWBligra+Na7uYEQw3OGOf5iAG2z46wOksA10UAQdff1rYBlbD3MU4x/40EYtACuCB1SWIo+NrBEmy9MMcIMa7sAHPh6hAxD/GIEDoOAGNggrWtKaFh3C2AYoGCvbY7CBDaAgRjF2S9ha1Pa2oMgGPhhRC9hqY6/aSC4xZMHchZgAG9g4bnKLEQ/hgsIc1KCGOeqhjW6wFJwUwYY7skuM7b5iG1A9BlSJgQ5yoMMY2CiA5kyAjm24Nx5LcAc12BAIZBx3G8HARgbEEVTJYWMc4/gvNmiBDmKAQge1YEMXkGEOciDucxgex4QZUY/6dsEIx60FMnA3DmwwIwCMYIQ5zEGMOOiADSGuMOsC8F1s5HjHo+1CLUABCuIFYLc7tikpunAL4Q4Deozdhja2wQ1zwOMRw7gy8eABj20Uoxxchgc5lKGM5cGj/7NnCEA3wgqAJaQUeu2gypPRUY9pbMN6AchCBhAQjAybo3tkzkA83lEAIXcvB9gQRwGkMdJKW/rSBlHGDFhHAxZRJAdV2PTnfhCGbSbkHZqgQRg0hwgXaMLTDBEGL1ywK4qsIgxJyISpDSKMZEBCD0VIxEIooQxvbCMZuy6IN6YSgGQPJAuY24ezB+IndsDCCFFUSB6mAIt3sAOLmnsGJXRBhSIAQhB9EIUXEkGIZETI0Zr7hS5IMYELXKABF6hAC5JwhC+0wZes08UXBpEEC1igAQ2oVRICAYdKKAPeklvGwI0wgYM3YAJJiMMb4MALPUw7Ictwg7lEgHFTTCEJYf9wQy9SUZOA/yEQcQDBD/KRD3f4AA598MMTaPEO1inDW4OwRCvu4Y56qAMQe2iDMnIgD9Z5IxJ9MIUlOsGJeajj6J/QxS+Y8XGD0IISezhFF7rwB3VQAQqTiESEEADuz3ljFkDvgghEYIRBKGbpzADj52ThsJfL3QVGOAIXnpAFZuRddjl4Ai5IYQkjiICYfvA4M3ouO1n8IhKCGIQRkmCJLwBi6c32nTcI0Qdz1V0QRaBc1xkiC13AwQinJwQz2o67TCjDGKUwRR+MUQ0JWO8Qn3+HhNjxiVNA7xBfqIaQx5EHTKyCeGCYAiXSSJB08IIUgsBdKwyBC9oLRBm5sLv/7MCQiDYrJBWtyASm189+9tvBDq4QBwyfMApW9CEZ7EhJ98Cwik3EYRKrYFHdkwhV8AW4kASiYAqRMDLWIwc0gAu2cAi4oAm84DmjVgV5IIHNMApnMFOy4zWbAAiH8AyowAj0MCfQowRzEAmHUAi84AhXQFCycyUCUgWZgAu5gAbGcAWuIDtEcAjAIhDJcAg/wAuVoAbV4ArsIIOh8wRy4AJBIBBnsAoX8AOb4AXGEAz7YCqs4wMQgAhX8A9nUAoXQANToARqwAhUIzsmsAoJEAZjsQs00AAFWAnGsEu4kwdxkAATcASkEAYNoGqCEAvBIADZYjqUoAaHAAEYlyuq/2aAsCAAjsI6eTAKbnAIKFcFVRAGhvAHeSAMYYg7JuAIorAKU4AIYcAKXyAKO+iBnyMOjKAGfyAKvVAKm5ALjhAMAPAxuLMP0jANxjAMgiAI0OAIsPAzy+MRrjANwwAN0MB74uCKoaM3+jANxVAMdrAW0mg6nPMK9KA3zgQ9HgGOdmM94LiN7ZeO6riO7HhpvdALgJAKNdI9QFAKq7AKqggGhQBrvvMDM2AKvsAK94gKm5AJ50A8PwADdBAGAMkKqECQmyAInOA7JFACM3AIhzAIlXBurLAJBTmRsvMDJVADh7ADEPACiZAKuXePnYA7P2ADdRAGgzAHNqAA35AKnP+QCJ1ABbjDRSUQBhipATZwBLkAADc2ALgDBh1AA3FzBKkQAhuwCalQjrKDCPl2BILgD9TQC60QDa0gYL6TCj/QAodwDgDACZsADK3ADAiwPKmQCVQQO5nQCe/Qb9XglsFEBb9QBz8gCLYAQ79ABXy5ChukQr/QCTDgCaUQDoBJBWLgCZkAkgH0C4nwmJnAmIbZCmIgB51AldDzC62gCOqQAZ65PL/wCwdAHDN0Ke3Ymq75mrAZm7ApmbhDmwSRCqdQmOFgfp9DCKigC5kGCKUADsogAnCFmQwRB3GgBxeDC6aWBctwBtzwAA1gCZFAEV0wAQ1wDNWQDJRnEAeQBZD/YAkuUJ28aRCWUHGWgAzCoHeZJgi7kJ4NcAsKUQsNIAKmIAmiAJwMkQOUwC+3cAQQkAwGkQsL0AWQMArQoCGSkwM8MwvVMAu+QhCzoAbdMA16oE3uwzq4EAeqcJ7W06ElIALQAKLLE4E0cAvpUJq+MwtWMw4BsDoq9A4ZyqIU8XV/UAqScJ9GwIsDMQopQAKBMAkv0waHyDX+VApJUAITEAi8gJwDoQzHcAQlQAeDwAVTYaL/ACBMcABwMAinIApQShCyAAldkACJEAAHACQJoQx/gAzKcABuUApaOhDGIAnHAADdoA0kVBCzIAmWwAbcAADLkAx1+n1/wAS/wAeg/0ANBaEMcKAKpoAJnZAFAKAHhzoQyaAzlPAFpkAKkGBBunEJojALT2GUR6oQlKM3utALl0CnysMMB7AM5sMzY7oQv2A+DqML72B+zMCPxMMJB7B6slmsxnqsyNqO+0AfvoMOxcANxIAMknALx9AHoHgEgzAIxxA6jNAIj0AKRxCI0hIGkjAM7JAG5UmHpvA5mNMIXeAGaeAIS3AF4tAEWfMIoGAEFjcDbyA5IoEbxMEOTMAEAssEwuAEofAIjyAJSfAsUyA5+ReF//AJgjAJdwaKrrAIefAKd3AHogAH/fo5dyAGJWAJ1BAD/yAM4mAHMWAHgLFLBksRFisQV0ADSf8wCKGwCLgzCW/AB4GABsPxD3aQbq/wCnbwOVwABsYyAzRgK4MQBIUDGOIgo/8AB1uABqJAgwQhDksjBWFQBS5QBVGAOaIACYvwBGcQA4wgCF57CHFACqJwZwkBAMGwDccACX2xD0EgCpJgBC5gAWVYBdIyGsVAD/LHEPtwDdjwCX2wFsWQBpCgsNN6CZOQBp8QC9JwBVTLEAHADoygM0zgCuswDdfAU9LQE5wTDD34OewQAK6gfzPEN8k6u7Rbu7Z7u7ibu5rTB+LAhSr0LNPAN4VgqbuoBJ+FOyKwAq9gCAYXBqUwAxVAAz8wDdhwvKxTDCFgAUlwb67TAmEwA47/kA2LKzsNsABJAHtx0AWB0AMkQAl5EwvOwDoJB3tG0AWDQApTAAaYQxw/FTrl6wIZ1wWgQAqIsARrozcWWBAAbARxMAiSgAibsL/nKDthgK2kgAmIYAwSoY11gjtTsAluoAmlQBX0cAYqEBO+AwdKoASMIBH0Cgap4AqhiDtKoAiuQBUHgAcqsAAO0AEMQDxMIA514hEBIAwU8ASfcAUJ/DlXUAFPYLfXsBYBdAbbUAWmEAoC2D2u8AoAPAmfIMXdIwClUAWaAA0trEKycAhVAAmOgDkBZAe4EAY/8AmRqEJnAAdzIAiOcMMqxAhfMAqzQDl2nMRqaqO4kxtLrLuK/7zIjBxSsLAIROIEgMkCUqAOUDANAbQFH8ACK+ACbfAJAqEGLLBQvpMBbbACK9AFXOAov7ADR+s7A5ACPAACg2ALRiQNtHANy+MNn5AMsMAEJ2UQetAGbcAIsAAFn0MLJsAOdiBXBgEASAAIPdAK5ODMC+EIjjANWSACSDEWZSEQX0ACYcADK2AIMkIR2VAEKwA0D8AEe9EXfyEMAGAMSRACIdArM7wQAXAEI8AFM9AGXnAZmbEZ7JC8UoAEUfAJqWo4gGABSqABI6AHmyAbtGEbuNEHe4AHdWYQd2DCjKAJLoAEIr0CUiAFhFAERQgd0kEd7CAPApBsDDABLSAA5P/gLCtAGVPwB0TgA+mxHu3xHuxwDbsGAJsQAl2gN8swCFMgKVJgDHpAIAaCIMagIAshDVzQBVpwAFywADCCylOQCZSgB53gISAiIiTCEOGgN1CgBUUbBVGgDFygBt7wDlwQBjiiIzwyiQnxCgLACK7gCrvIBYSwCUXwBHP9JFEyJVWitQzRD81w0mYyFkygJmziJnAiJ5rzCrLwDD4hKIQyD4aCKIqCC4yi1wvxCvQkDrSQKZvSKZ8SKl8wKqXCOgbgDbNSK7eSK7vSK7/CED4ABipQEMziLNAiLdRiLdiyEMxwBF1gouRiLuiiLl/ALu6yENOQCG0ACwmxL/3yLwFJMzAFkzmguBATUzEXkzEb0zE+yjoqwzIuAzMycwXuyTo/EzRDUzRHk8gVQTVWgzVao98vgTZqIxGbuzx4g8CyC2h1YsiN/DkBAQA7";
var e=document.createElement("canvas"),d=e.getContext("2d");c.onload=function(){e.width=33;e.height=34;for(var f=0;11>f;f++)d.drawImage(c,0,34*f,33,34,0,0,33,34),Xj[f]=e.toDataURL("image/png"),b+=".ncursor"+f+"{cursor:url('"+Xj[f]+"'), default}",d.clearRect(0,0,33,34);document.getElementsByTagName("style")[0].innerHTML=b};Pd(2)})();var mc,nc,ed,oc,Gc,ma,Yd,mb,Oa,sh,Yj,Zj,ra,Zd,Tj,Uj,Vj,Wj,ak,pc,fd=function(){r("mgitem").style.backgroundPositionY=-48*x.mwicon()+"px";r("mgamount").innerHTML=x.amount()},
Ef=function(){if(!Ef.setup){Ef.setup=!0;r("content").innerHTML='\n<ul id="msgs1"></ul>\n<div id="clicks" style="display:none;margin-top:0;margin-left:151px"></div>\n\n<div id="playersinfo"></div>\n<div id="resources" style="display:block">\n<div id="gold"></div>\n<div id="wood"></div>\n<div id="food"></div>\n<div id="stone"></div>\n<div id="pop"></div>\n<div id="temperature"></div>\n</div>\n<div id="enterwindow" class="displaynone">\n<h2 id="sendMessageH2">'+t.chatMsg+'</h2>\n<input id="msginputGame" />\n</div>\n\n<div id="statButton"></div>\n<div id="topinfo"></div>\n<div id="bottominfo"></div>\n<div id="mapeditorinfo">\n<div id="sButtons"><button id="selectUnits">'+
t.units+'</button><button id="selectBuilds">'+t.builds+'</button><button id="selectItems">'+t.items+'</button><button id="selectNature">'+t.nature+'</button></div>\n<div id="mapeditorinfoUnits"></div>\n<div id="mapeditorinfoBuilds" style="display:none"></div>\n<div id="mapeditorinfoItems" style="display:none"></div>\n<div id="mapeditorinfoNature" style="display:none"></div>\n</div>\n<div id="mapeditorinfotop">\n<button id="menueditor">'+t.menu+'</button>\n<button id="deleteUnit" style="color:#f00;font-weight:bold;font-size:19px">x</button>\n<button id="rotatebutton"></button>\n<button id="mapProps">'+
t.options+'</button>\n<button id="mapRules">'+t.rules+'</button>\n<span>Brush size: </span><input type="number" min="1" max="256" value="6" id="brushSize"/>\n<span>Active kingdom</span>\n<select id="selectKingdom">\n</select>\n</div>\n<div id="minimap" style="position:absolute;top:31px;left:4px;z-index:99"></div>\n<div id="menu" style="display:block">\n<button id="gameMenu">'+t.menu+'</button>\n<div style="width:151px;height:calc(100% - 741px);top:645px;background:url(/nehhon/menurepeat.gif) repeat" id="kingdomcolor"></div>\n<div id="daynighticon"></div>\n<div id="icons20">\n<div id="attackmenu" style="display:none"></div>\n<div id="defencemenu" style="display:none"></div>\n<div id="levelmenu" style="display:none"></div>\n<div id="manamenu" style="display:none"></div>\n<div id="manamenu1" style="display:none"></div>\n</div>\n<div id="progressvalue"></div>\n<div id="kingdom"></div>\n<div id="unitname" contenteditable="true"></div>\n<progress id="progressone" style="display:none"></progress>\n<progress id="progressmana" style="display:none" max="100"></progress>\n<input id="unitSpeed" min="1" max="100" type="range"/>\n<canvas width="48" height="48" id="selectedobject"></canvas>\n<div id="navigation">\n<button id="aleft"></button>\n<button id="stock"></button>\n<button id="aright"></button>\n</div>\n<div id="orders">\n<button id="order1"><progress class="loadingunit" style="display:none"></progress></button>\n<button id="order2"></button>\n<button id="order3"></button>\n<button id="order4"></button>\n<button id="order5"></button>\n<button id="order6"></button>\n<button id="order7"></button>\n<button id="order8"></button>\n</div>\n<div id="magicworkshopmenu" style="display:none">\n<button id="mgbook"></button>\n<button id="mgpotion"></button>\n<button id="mgsword"></button>\n<button id="mgamount"></button>\n<button id="mgitem"></button>\n<button id="mgdecline"></button>\n<button id="mgaccept"></button>\n<div id="mgbak"></div>\n</div>\n</div>\n\n\n        ';
pc=r("msgs1");ra={page:0,length:8,leftButton:r("aleft"),rightButton:r("aright"),stock:r("stock")};ra.leftButton.onclick=function(){x.changePage(-1)};mc=r("minimap");Zd=r("unitSpeed");Tj=r("gold");Uj=r("wood");Vj=r("food");Wj=r("stone");ak=r("daynighticon");ra.rightButton.onclick=function(){x.changePage(1)};ra.displayed=[];nc=r("attackmenu");ed=r("defencemenu");oc=r("levelmenu");Gc=r("kingdom");ma=r("progressone");Yd=r("unitname");mb=r("progressvalue");r("selectedobject");r("mgbook").onclick=function(){x.mwSelect(0);
fd()};r("mgpotion").onclick=function(){x.mwSelect(1);fd()};r("mgsword").onclick=function(){x.mwSelect(2);fd()};r("mgdecline").onclick=function(){r("magicworkshopmenu").style.display="none"};r("mgitem").onmousedown=function(c){var b=1;c.button&&(b*=-1);x.mwMore(b);fd()};r("mgaccept").onclick=function(){r("magicworkshopmenu").style.display="none";x.createItems()};r("mgamount").onmousedown=function(c){var b=1;c.button&&(b=-1);Bc.shift&&(b*=5);x.mwamount(b);fd()};Oa=[r("order1"),r("order2"),r("order3"),
r("order4"),r("order5"),r("order6"),r("order7"),r("order8")];sh=r("bottominfo");for(var b=0,c=Oa.length;b<c;b++)Oa[b].addEventListener("mousedown",ym),Oa[b].addEventListener("mouseup",zm),Oa[b].ordid=b,Oa[b].addEventListener("mouseenter",Am),Oa[b].addEventListener("mouseout",Bm);r("stock").addEventListener("click",function(c){x.checkStock()});mc.addEventListener("mousedown",function(c){0==c.button?(document.addEventListener("mouseup",function h(c){document.removeEventListener("mouseup",h);document.removeEventListener("mousemove",
Ff)}),$d=!0,Ff(c),document.addEventListener("mousemove",Ff)):2==c.button&&G(999999999,44444)});Yj=[manamenu,manamenu1];Zj={mana:{background:"0px -120px",progress:progressmana},food:{background:"0px -240px"},milk:{background:"0px -280px"},gold:{background:"0px -260px"},stone:{background:"0px -320px"},wood:{background:"0px -340px"}};r("selectUnits").onclick=function(){r("mapeditorinfoUnits").style.display="block";r("mapeditorinfoBuilds").style.display="none";r("mapeditorinfoItems").style.display="none";
r("mapeditorinfoNature").style.display="none"};r("selectBuilds").onclick=function(){r("mapeditorinfoUnits").style.display="none";r("mapeditorinfoBuilds").style.display="block";r("mapeditorinfoItems").style.display="none";r("mapeditorinfoNature").style.display="none"};r("selectItems").onclick=function(){r("mapeditorinfoUnits").style.display="none";r("mapeditorinfoBuilds").style.display="none";r("mapeditorinfoItems").style.display="block";r("mapeditorinfoNature").style.display="none"};r("selectNature").onclick=
function(){r("mapeditorinfoUnits").style.display="none";r("mapeditorinfoBuilds").style.display="none";r("mapeditorinfoItems").style.display="none";r("mapeditorinfoNature").style.display="block"};r("selectKingdom").onchange=function(){y.kingdom=parseInt(this.value);var c=J[y.kingdom].color;this.style.background="rgba("+c[0]+","+c[1]+","+c[2]+",.8)"};r("mapProps").onclick=function(){r("mapPropsWindow").style.display="block";vc();if(""==r("mapPropsWindow").innerHTML){var c=document.createElement("div");
r("mapPropsWindow").appendChild(c);var b=document.createElement("table");c.appendChild(b);b=document.createElement("div");b.innerHTML=t.mapName;var f=document.createElement("input");f.value=v.name||t.strcusMap;f.id="mapName";f.type="text";c.appendChild(b);c.appendChild(f);b=document.createElement("div");b.innerHTML=t.description;f=document.createElement("textarea");f.type="text";f.value=v.description||"";f.id="mapDescription";c.appendChild(b);c.appendChild(f);b=document.createElement("div");b.innerHTML=
t.author;f=document.createElement("input");f.id="mapAuthor";f.value=v.author||"";f.type="text";c.appendChild(b);c.appendChild(f);c.appendChild(document.createElement("p"));b=document.createElement("button");b.onclick=bk;b.innerHTML=t.close;c.appendChild(b)}th()};r("mapRules").onclick=function(){r("mapRulesWindow").style.display="block";vc();if(""==r("mapRulesWindow").innerHTML){var c=document.createElement("div");c.innerHTML='\n<div id="mapEvent">\n<h4>'+t.events+'</h4>\n<select id="eventOptions" style="display:none">\n<option value="objAction">'+
t.objAction+'</option>\n<option value="objZone">'+t.objZone+'</option>\n</select>\n<div id="eventScreen">\n</div>\n<div id="eventLayout">\n</div>\n<button id="addEvent">+</button>\n</div>\n<div id="mapActions">\n<h4>'+t.actions+'</h4>\n<select id="actionOptions" style="display:none">\n<option value="objOrder">'+t.objOrder+'</option>\n</select>\n<div id="actionScreen">\n</div>\n<div id="actionLayout">\n</div>\n<button id="addAction">+</button>\n</div>\n<h4>'+t.rules+"</h4>\n";var b=document.createElement("div");
b.id="rulist";c.appendChild(b);b=document.createElement("button");b.onclick=Cm;b.innerHTML="+";c.appendChild(b);b.id="addRule";c.appendChild(document.createElement("p"));b=document.createElement("button");b.onclick=bk;b.innerHTML=t.close;c.appendChild(b);r("mapRulesWindow").appendChild(c);r("addEvent").onclick=Dm;r("addAction").onclick=Em;r("eventOptions").onchange=function(){var c=ck[this.value];sa.div=c.id;la(sa.div);sa.active.name=this.value;c.func&&c.func();c=r("eventScreen").getElementsByTagName("button");
for(var b=!1,d=0,f=c.length;d<f;d++){var e=c[d];if(e.sdiv)if("none"==e.style.display)e.sdiv.style.display="none";else{if(!b)e.onclick();b=!0}}Gf(pb.active,"eventLayout")};r("actionOptions").onchange=function(){ub.active.name=this.value;Gf(pb.active,"actionLayout")};c=document.createElement("div");c.id="edobjAction";var f=document.createElement("select");f.innerHTML='\n<option value="attack">'+t.attack+'</option>\n<option value="destroy">'+t.destroy+'</option>\n<option value="moving">'+t.moving+'</option>\n<option value="capture">'+
t.capture+"</option>\n";f.value="attack";f.id="selectionEvents";f.onchange=Fm;var h=document.createElement("section"),q=document.createElement("section"),l=document.createElement("section"),p=document.createElement("section"),m=document.createElement("section");b=document.createElement("button");b.innerHTML=t.add;b.onclick=gd;var k=document.createElement("div");k.className="unitList";k.id="zoneList";l.appendChild(b);l.appendChild(k);k=document.createElement("div");k.className="unitList";k.id="unitListDiv";
k.spType=sa;b=document.createElement("button");b.innerHTML=t.add;b.onclick=function(){vb(this)};b.button=k;b.style.margin="10px";h.appendChild(b);b=document.createElement("button");b.innerHTML=t.defined;b.onclick=Va;b.sdiv=h;c.appendChild(b);b.onclick();b=document.createElement("button");b.innerHTML=t.undefined;b.onclick=Va;b.sdiv=q;c.appendChild(b);h.appendChild(k);c.appendChild(h);c.appendChild(q);c.appendChild(document.createElement("p"));c.appendChild(f);c.appendChild(document.createElement("p"));
k=document.createElement("div");k.className="unitList";k.id="unitListDiv2";k.spType=sa;b=document.createElement("button");b.innerHTML=t.add;b.onclick=function(){vb(this)};b.button=k;b.style.margin="10px";p.appendChild(b);b=document.createElement("button");b.innerHTML=t.defined;b.onclick=Va;b.sdiv=p;b.id="byButton1";c.appendChild(b);b=document.createElement("button");b.innerHTML=t.undefined;b.onclick=Va;b.id="byButton2";b.sdiv=m;c.appendChild(b);p.appendChild(k);b=document.createElement("button");
b.innerHTML=t.zone;b.onclick=Va;b.sdiv=l;b.id="eventZone";b.style.display="none";c.appendChild(b);c.appendChild(l);c.appendChild(p);c.appendChild(m);r("eventScreen").appendChild(c);V("mapEvent");V("mapActions");c=document.createElement("div");c.id="edobjOrder";f=document.createElement("select");f.innerHTML='\n<option value="move">'+t.move+'</option>\n<option value="attack">'+t.attack+"</option>\n";f.value="move";f.id="selectionActions";f.onchange=Gm;h=document.createElement("section");q=document.createElement("section");
p=document.createElement("section");m=document.createElement("section");k=document.createElement("div");k.className="unitList";k.id="unitListDivAction";k.spType=ub;b=document.createElement("button");b.innerHTML=t.add;b.onclick=function(){vb(this)};b.button=k;b.style.margin="10px";h.appendChild(b);b=document.createElement("button");b.innerHTML=t.defined;b.onclick=Va;b.sdiv=h;c.appendChild(b);b=document.createElement("button");b.innerHTML=t.undefined;b.onclick=Va;b.sdiv=q;c.appendChild(b);h.appendChild(k);
c.appendChild(h);c.appendChild(q);b.onclick();c.appendChild(document.createElement("p"));c.appendChild(f);c.appendChild(document.createElement("p"));k=document.createElement("div");k.className="unitList";k.id="unitListDivAction2";k.spType=ub;b=document.createElement("button");b.innerHTML=t.add;b.onclick=function(){vb(this)};b.button=k;b.style.margin="10px";p.appendChild(b);b=document.createElement("button");b.innerHTML=t.defined;b.onclick=Va;b.sdiv=p;b.id="toButton1";c.appendChild(b);b=document.createElement("button");
b.innerHTML=t.undefined;b.onclick=Va;b.id="toButton2";b.sdiv=m;c.appendChild(b);p.appendChild(k);c.appendChild(p);c.appendChild(m);b.onclick();r("actionScreen").appendChild(c);V("mapEvent");V("mapActions")}};Zd.onchange=function(c){parseInt(Zd.value);G(999999999,44444)};r("deleteUnit").onclick=function(){ba.slice(0);G(999999999,44444)};r("rotatebutton").onclick=Pl;r("gameMenu").onclick=xa;r("menueditor").onclick=xa;r("statButton").onclick=function(){}}};Ef.setup=!1;var Am=function(){x.mouseEnter(this.ordid)},
Bm=function(){ra.stockActive&&ae(ba[0],1,1);sh.innerHTML=""},zm=function(b){Je=b.button;x.executeOrder(this.ordid,b.button);this.style.transform="translate(0px,0px)"},ym=function(){this.style.transform="translate(2px,2px)"},uh=function(b,c){r(b).style.display="block";uh.actived=b;c.actual="potion";c.id=0;c.amount=100;c.func()};uh.actived="";var dk={potion:{bak:1,max:4,ord:["level","mana","attack","defence"]},sword:{bak:5,max:3,ord:["attack","attackBow","defence"]},book:{bak:8,max:18,ord:"fireRain lightning healing createCarpet createBat bless freeze confusion invisibility createGolem magicVision raiseDead turnToStone whirlpool createDragon flameBolt teach createJinn".split(" ")}},
fk=function(b,c){c=A[c];var f=b[2],d=[f,0,0,0];hj.paypal(d)||(f=~~(250*f),"book"==b[0]&&(f*=2),c.setupINTV(ek,b,f),c.lcost=d,c.techStart=c.c-v.cycle,X(c.id)&&(r("magicworkshopmenu").style.display="none"))},Hm={defence:6,mana:0,level:2,health:1,attack:5},Im={attack:"sword",attackBow:"bow",defence:"shield"},Jm={attack:.5,mana:1,defence:.5,level:.2},ek=function(f,c){f=A[inf[1]];var e=c[0],d=dk[e].ord[c[1]];c=c[2];f.lcost=void 0;"sword"==e&&(e=Im[d]);"attackBow"==d&&(d="attack");e=Object.assign({},Ud[e]);
if(e.potion)e.d=Hm[d],e[d]=~~(c*Jm[d]);else if(e.book){var g=b[d],h=g.obj;e.spell=d;e.attack=~~(c/h.spcost[0]);e.name=h.name;e.iconID=g.iconIDbook}else e[d]=~~(.25*c),250<e[d]&&(e[d]=250);G(e);Ke(52,f,!0,e);f.techStart=void 0;X(f.id)},Je,$d,gk=function(){history.pushState("",document.title,window.location.pathname)},Qb=function(){v.online=0;location.hash="";r("MatchX").style.display="none";r("index").style.display="block";r("returnmenu").style.display="none";r("game").style.display="none";r("gameFinish").style.display=
"none";setTimeout(gk,200)},eb=[.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.27,.3,1,.5,.5,.5,1,.62,.62,.62,1,.74,.74,.74,1,.88,.88,.88,1,.94,.94,.94,1,1,1,1,1,1.06,1.06,1.06,1,1.12,1.12,1.12,1,1.08,1.08,1.08,1,1.04,1.04,1.04,1,1,1,1,1,.95,.95,.95,1,.88,.8,.7,1,.84,.72,.6,1,.7,.62,.5,1,.6,.55,.45,1,.5,.44,.42,1,.4,.37,.35,1],$i=function(){var b=(.025*v.cycle/v.daylength*24+v.initialhour)%24,c=~~b;b-=c;ak.style.backgroundPosition="0 -"+36*c+"px";var e=new Float32Array([eb[4*c],eb[4*
c+1],eb[4*c+2],eb[4*c+3]]);c=(c+1)%24;e[0]+=(-e[0]+eb[4*c])*b;e[1]+=(-e[1]+eb[4*c+1])*b;e[2]+=(-e[2]+eb[4*c+2])*b;e[3]+=(-e[3]+eb[4*c+3])*b;k.useProgram(oa);k.uniform4fv(hk,e);k.useProgram(da);k.uniform4fv(ik,e)},Ta=0,ya=0,Hc=0,Ic=0,dd=function(b,c){var f=tzar.width,d=tzar.height,g=y.mx/32;b/=32;c/=32;var h=P*f*.03125,q=P*d*.03125,l=.03125*f,p=.03125*d,m=b+.5*(l-h),k=c+.5*(p-q);0>m?b=.5*-(l-h):m+h-g*P>H&&(b=H-h-.5*(l-h)+g*P);0>k?c=.5*-(p-q):k+q>Ba&&(c=Ba-q-.5*(p-q));h-y.mx>H&&(P=H/(.03125*f),G(P));
q>Ba&&(P=Ba/(.03125*d),G(P));Ta=32*-b;ya=32*-c},Ff=function(b){var c=b.pageX-parseInt(mc.style.left);b=b.pageY-parseInt(mc.style.top);var f=tzar.height*Kb/(32*Ba);c=~~(.5+(c-tzar.width*qc/(32*H)*.5)*H/qc);b=~~(.5+(b-.5*f)*Ba/Kb);dd(32*c,32*b);0==$d&&document.removeEventListener("mousemove",Ff)},Bc={control:0,shift:0,esc:0},hd={37:function(b){Hc=b},40:function(b){Ic=-b},39:function(b){Hc=-b},38:function(b){Ic=b},32:function(b){Rj=b?um:function(){}},16:function(b){Bc.shift=b;x.shiftONOFF(b)},17:function(b){Bc.control=
b},27:function(b){Bc.esc=b},13:function(b){b&&!v.editor&&("displaynone"==r("enterwindow").className?(r("enterwindow").className="displayblock",r("msginputGame").focus(),hd.blocked=13):(vh(),r("enterwindow").className="displaynone",hd.blocked=null))},19:function(b){b||v.online||Rb(1)},48:function(b){b&&Bc.control&&(P=1,jk({deltaY:0}))},219:function(b){b&&kk(-1)},221:function(b){b&&kk(1)},blocked:null};document.oncontextmenu=function(){return!1};var lk=function(b,c){if(c.length){b=b||v.editor?c.length:
1;for(var f=0;f<b;f++)A[c[f]].die()}},va=function(b,c){b.sound&&!c&&(c=b.sound,pa(c[~~(c.length*Math.random())]));oc.style.display="none";Zd.style.display="none";Gc.style.display="block";ma.style.display="block";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";ed.style.display="none";Yd.innerHTML=b.name;be(b);Gc.innerHTML=J[b.kingdom].name;b.attack?(nc.style.display="block",nc.innerHTML=b.attack):nc.style.display="none";c=b.health;var f=b.maxHealth;Infinity==
c?(ma.value=100,ma.max=100,mb.innerHTML=c):ma.value=c;Infinity==f&&Infinity!=c?(ma.max=100,ma.value=1):Infinity!==f&&(ma.max=f);b.inventory&&b.inventory.length&&(manamenu1.style.display="block",manamenu1.style.backgroundPosition="0px -80px",manamenu1.innerHTML=b.inventory.length);mb.innerHTML=~~c+"/"+f;if(Ug(b,y))if(b.point&&(c=b.point,Fb.x32=c[0],Fb.y32=c[1],Na(Fb,96*(Ba-1)),Fb.show=1),!1===b.built)be(b);else if(b.techStart)be(b),manamenu.style.display="block",manamenu.style.backgroundPosition="0px -200px",
manamenu.innerHTML=100-~~(100*(b.c-v.cycle)/b.techStart)+"%",va.intv&&clearInterval(va.intv),va.intv=setInterval(function(){ba[0]==b.id?manamenu.innerHTML=100-~~(100*(b.c-v.cycle)/b.techStart)+"%":clearInterval(va.intv)},400);else if(S(),b.working){f=b.work;var d=ra.page*ra.length;c=0;for(var g=ra.length;c<g;c++){var h=f[c+d];Oa[c].innerHTML=h?h:""}manamenu.style.display="block";manamenu.style.backgroundPosition="0px -200px";var q=1E3*z[b.waitlist[0]].time;c=~~(100*(v.now()-b.timestamp)/q);100<c&&
(c=100);manamenu.innerHTML=c+"%";va.intv&&clearInterval(va.intv);va.intv=setInterval(function(){if(ba[0]==b.id&&b.working){var c=~~(100*(v.now()-b.timestamp)/q);100<c&&(c=100);manamenu.innerHTML=c+"%"}else clearInterval(va.intv)},400)}else for(c=0,f=ra.length;c<f;Oa[c++].innerHTML="");};va.intv=!1;var id=function(){V("magicworkshopmenu");nc.style.display="none";ed.style.display="none";oc.style.display="none";ma.style.display="none";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display=
"none";Yd.innerHTML="";nc.innerHTML="";ed.innerHTML="";manamenu.innerHTML="";oc.innerHTML="";Gc.innerHTML="";mb.innerHTML="";ma.value="";mb.maxLength="";Zd.style.display="none";for(var b=0;b<Oa.length;Oa[b++].innerHTML="");wh();mk()},db,Kd,Hf={},ba=[];ba.change=1;var xh;var Xg=!1;var Ub=function(b,c){var f=P,d=tzar.width,g=tzar.height;b=b*f-Ta+.5*(d-f*d);c=c*f-ya+.5*(g-f*g);return[b,c]},rc=function(b){if(b){var c=b.pageX;b=b.pageY;rc.lastX=c;rc.lastY=b}else c=rc.lastX,b=rc.lastY;c=Ub(c-y.mx,b);b=
c[1];c=c[0];0==Xg?(window.removeEventListener("mousemove",rc),xh=!1):xh=!0;yh=c;zh=b},nk=function(b,c){for(var f=c.length,d=0;d<f;d++){var g=A[c[d]];g.build&&(Y[b[0]+b[1]*H]==g.id?(g.point=void 0,ba[0]==g.id&&(Fb.x32=2*H,Na(Fb,128*H),Fb.show=0)):(g.point=b,Fb.x32=b[0],Fb.y32=b[1],ba[0]==g.id&&(Na(Fb,96*(Ba-1)),Fb.show=1)))}};document.onkeydown=function(b){return b.ctrlKey&&b.shiftKey?!1:{116:1,115:1,123:1}[b.keyCode]?!1:!0};var Km=function(b){G(b.keyCode);if(hd[b.keyCode])hd[b.keyCode](1);x.runKey(b.keyCode,
!0)},Lm=function(b){if(hd[b.keyCode])hd[b.keyCode](0);x.runKey(b.keyCode,!1)},Mm=function(b){var c=window.innerWidth,f=window.innerHeight,d=b.pageX,g=b.pageY;x.mouseMove(b.pageX,b.pageY);if(screen.height-10<=f){if(1.2==Math.abs(Hc)||0==Hc)Hc=1.2*((10>d)-(d>c-10));if(1.2==Math.abs(Ic)||0==Ic)Ic=1.2*((10>g)-(g>f-10))}},Nm=function(b){Ub(b.pageX-y.mx,b.pageY);x.mouseDown(b.pageX,b.pageY,b.button);if(!ce&&b.pageX>y.menumx&&0==b.button){window.addEventListener("mousemove",rc);b=Ub(b.pageX-y.mx,b.pageY);
var c=b[1];ok=b=b[0];pk=c;yh=b;zh=c;Xg=!0}},ok,pk,yh,zh,Om=function(b){ce||(x.mouseUp(b.pageX,b.pageY,b.button),gd.actived&&gd(),vb.actived&&vb(),$d&&($d=!1))},mm=function(){x.selection(ok,pk,yh,zh)},ae=function(b,c){b={attack:x.gAttack(b),defence:x.gDefence(b),level:x.glevel(b),health:x.ghealth(b),maxHealth:x.gmaxHealth(b),mana:x.gMana(b),item:x.gItem(b),build:x.gBuild(b),kingdom:x.gKingdom(b),c:x.gCval(b),manaMax:x.gManaMax(b),utype:x.giType(b),inventoryLength:x.gInventory(b),control:x.gControl(b),
iconID:x.gIconID(b),type:x.gType(b),helper:x.gHelper(b)};b.name=z[b.type]&&z[b.type].name||"";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";b.sound&&!c&&(c=b.sound,pa(c[~~(c.length*Math.random())]));b.inventoryLength&&b.control?(r("stock").className="",manamenu1.style.display="block",manamenu1.style.backgroundPosition="0px -80px",manamenu1.innerHTML=b.inventoryLength):r("stock").className="blocked";b.build&&b.c&&(c=Math.floor(25*(b.c-v.cycle)/1E3),
manamenu.style.display="block",manamenu.style.backgroundPosition="0px -200px",manamenu.innerHTML=c+"s");Gc.style.display="block";Yd.innerHTML=b.name;b.attack||0==b.utype?(nc.innerHTML=b.attack,la("attackmenu")):V("attackmenu");0==b.utype||2==b.utype&&b.defence?(ed.innerHTML=b.defence,la("defencemenu")):V("defencemenu");b.manaMax&&(manamenu.style.display="block",manamenu.innerHTML=b.mana,27===b.type?(manamenu.style.backgroundPosition="0px -280px",la("manamenu1"),manamenu1.style.backgroundPosition=
"0px -240px",manamenu1.innerHTML=b.helper):(progressmana.value=~~(100*b.mana/b.manaMax),la("progressmana"),manamenu.style.backgroundPosition="0px -120px"));if(b.stock){c=b.stock;var f=Yj[i/3];f.style.display="block";f.style.backgroundPosition=Zj[c[4].icon].background;f.innerHTML=c[0]}oc.innerHTML=b.level;oc.style.display="block";0===b.level&&(b.item||b.build)&&(oc.style.display="none");Gc.innerHTML=Jc(Za(x.empName(b.kingdom),17));ma.style.display="block";qk(b);be(b.iconID)},Jc=function(b){for(var c,
f="",d=0;c=b[d++];)f+=String.fromCharCode(c);return f},qk=function(b){var c=b.health;b=b.maxHealth;Infinity==c?(ma.value=100,ma.max=100,mb.innerHTML=c):(ma.value=c,Infinity==b?(ma.max=100,ma.value=1):ma.max=b,mb.innerHTML=~~c+"/"+b)},rk=function(b,c){var f=A[b[0]],d=0,g=0,h=f.clss,q=b.length,l={},p=[];p.cut={};for(var m={},k=0;k<q;k++){f=A[b[k]];d+=f.maxHealth;g+=f.health;Kd=h!=f.clss?-1:!0;if(f.work)for(var n=f.work,r=Object.keys(n),v=0,x=r.length;v<x;v++){var w=r[v];m[w]||(m[w]=0);m[w]+=n[w]}r=
f.icons;n=r.length;if(void 0===f.techID&&!1!==f.built)for(v=0;v<n;v++)x=r[v].id,r[v].obj.tech||(void 0===l[x]?l[x]=1:l[x]++,l[x]===q&&(r.cut&&(x=r.cut,w=r[v].objName,x[w]&&(p.cut[w]=x[w],p.cut[x[w]]=w)),p.put(r[v])))}!0===Kd&&(Kd=f.clss);g=Infinity==g?100:~~(g/d*100);mb.innerHTML=g+"/100(%)";Ah();Yd.innerHTML="";nc.style.display="none";ed.style.display="none";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";oc.style.display="none";Gc.innerHTML=q+" "+t.units;
ma.style.display="block";ma.value=g;ma.max=100;if(!c)for(k=0,b=ra.page*ra.length,n=ra.length;k<n;k++)c=m[k+b],Oa[k].innerHTML=c?c:""},sk=function(){};new Float32Array(8);var Bh,Ch,Dh,Eh,P=1,Pm=function(b){tb(b.bufferID)},Vd={table:{},dates:[],new:function(b,c,e){c=Math.floor(c)+v.now();var d=this.table;e||(e=Pm);d[c]||(d[c]=[]);b.animFunc=e;d[c].put(b);this.dates.add(c);this.needOrder=!0}},ta=function(b){b=sb[b];return 0>b[1]?m.delay[b[0]-b[1]-1]:~~(b[0]/b[1]*1E3)};new Float32Array(12);var Tg=function(b){var c=
b.id+v.arje+b.x32+b.y32;b.rnd=[4294967295+c,4294967295-c,0]},Fh=function(b){b.mlist&&tk(b,!0);b.hlist&&tk(b,!1)},tk=function(b,c){if(c){var f=b.mlist;var d=b.mlistID;var g=jd.mercenaries}else f=b.hlist,d=b.hlistID,g=jd.heroes;f.unshift(g[ej(b,g.length)]);c?d.unshift(b.mercID++):d.unshift(b.heroID++);8<f.length&&(f.length=8,d.length=8);Db(b,5E4)},uk=function(f){f=A[f];if(!J[f.kingdom].paypal($l)){var c=J[f.kingdom],e=c.technology.disabled;if(!e[b.createCrusaders.id]){var d=16+4*c.crusade.number;c.crusade.number++;
32<d&&(d=32);c=c.crusade.list;c.length=d;for(var g=0;g<d;g++)(c[g]=Ke(8,f,1)).deleteFromList=c;pa("crusade",f.x32,f.y32);e[b.createCrusaders.id]=1;X(f.id)}}},vm=function(f){J[f.kingdom].technology.disabled[b.createCrusaders.id]=0},k,kd,uc={},Ya,Y,Le,de=function(b,c){return new Float32Array(n.buffer,b,c)},Za=function(b,c){return new Uint16Array(n.buffer,b,c)},cd=function(b){return Ya[b]},Kc=function(b){return Y[b]},Gh=function(b){return Le[b]};cd.write=function(b,c){Ya[b]=c};Kc.write=function(b,c){Y[b]=
c};Gh.write=function(b,c){Le[b]=c};var qf=[cd,Kc,Gh],wh=function(){for(var b=ra.displayed.length=0,c=ra.length;b<c;b++){var e=Oa[b];e.className="blocked";e.style.backgroundPosition="48px 96px";e.innerHTML=""}ra.rightButton.className="blocked";ra.leftButton.className="blocked";ra.stock.className="blocked";ra.rightBlocked=1},vk=function(b,c,e){};vk.actv={};var ik,da,oa,wk,hk,xk,If,Hh,Ih,Jf,ee,fe,ge,ld,Jh,Kh,Lc,yk,he=function(b,c){var f=4*zk,d=k.createBuffer();d.size=c;d.len=f;k.bindBuffer(k.ARRAY_BUFFER,
d);k.enableVertexAttribArray(b);k.vertexAttribPointer(b,c,k.FLOAT,!1,0,0);k.bufferData(k.ARRAY_BUFFER,f*c,k.STATIC_DRAW);k.vertexAttribDivisor(b,1);return d};he.jump=4E3;var Kf=function(b,c){var f=k.createBuffer(),d=c+1E4;c*=4;d*=4;k.bindBuffer(k.COPY_READ_BUFFER,b);k.bindBuffer(k.ARRAY_BUFFER,f);k.bufferData(k.ARRAY_BUFFER,c*b.size,k.STATIC_DRAW);k.copyBufferSubData(k.COPY_READ_BUFFER,k.ARRAY_BUFFER,0,0,c*b.size);k.bindBuffer(k.COPY_READ_BUFFER,f);k.bindBuffer(k.ARRAY_BUFFER,b);k.bufferData(k.ARRAY_BUFFER,
d*b.size,k.STATIC_DRAW);k.copyBufferSubData(k.COPY_READ_BUFFER,k.ARRAY_BUFFER,0,0,c*b.size);k.bindBuffer(k.COPY_READ_BUFFER,null);k.deleteBuffer(f)},Aa=function(){if(!v.canceled){performance.now();requestAnimationFrame(Aa);var b=Aa.fp1000,c=Aa.delta,e=Aa.now,d=Aa.realnow,g=Aa.delta,h=e;Aa.frameCount++;e=Date.now()-Hd+25*v.cycle;Aa.now=e;c=(c+(e-h))/1E3;Aa.delta=c;h=d;d=Date.now();Aa.realnow=d;g=(g+(d-h))/1E3;Aa.realdelta=g;Sg+=c;Rg++;Aa.fp1000=b+c;if(0!=Hc||0!=Ic)Ta+=Hc*g*640*P,ya+=Ic*g*640*P,dd(-Ta,
-ya),rc();k.useProgram(da);Rj(e);sk();k.uniform1f(xk,e);k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT);b=e;c=window.innerWidth;e=window.innerHeight;k.useProgram(oa);k.bindVertexArray(Jh);k.uniform1f(Hh,~~((.01*b+.5)%5));k.drawArrays(k.TRIANGLES,0,6);k.viewport(y.marx,e-Kb-y.mary,qc,Kb);k.uniform1i(Jf,1);k.uniform2fv(ge,[0,0]);k.uniform1f(ld,qc/32/H);k.drawArrays(k.TRIANGLES,0,6);k.uniform1i(Jf,0);k.uniform2f(Ih,c,e);k.uniform2fv(ge,[Ta,ya]);k.uniform1f(ld,1/P);k.viewport(y.mx,0,c,e);k.useProgram(da);
k.bindVertexArray(Kh);Lh(x.getBufferID());b=tzar.width;c=tzar.height;k.viewport(y.marx,c-Kb-y.mary,qc,Kb);k.uniform2f(If,32*H,32*Ba);k.uniform2fv(fe,[0,0]);k.uniform1i(ee,1);k.uniform1f(kd,1);Lh(x.getBufferID());k.uniform1i(ee,2);Lh(1);k.uniform1i(ee,0);k.uniform2f(If,b,c);k.uniform2fv(fe,[Ta,ya]);k.uniform1f(kd,1/P);k.viewport(y.mx,0,b,c);ca.active&&(Xd(ca.x,ca.y,96*H,ca.bufferID),ca.active=!1);Mc.update&&Mc(1)}},Lh=function(b){b&&(k.enable(k.BLEND),k.blendEquation(k.FUNC_ADD),k.blendFunc(k.SRC_ALPHA,
k.ONE_MINUS_SRC_ALPHA),k.drawArraysInstanced(k.TRIANGLES,0,6,b),k.disable(k.BLEND))},ie=!1,jk=function(b){if(!ce&&(b.clientX>y.menumx||$d||!b.clientX)){b=.07*Math.sign(b.deltaY)*P;var c=(P+b)*tzar.height*.03125;(P+b)*tzar.width*.03125-(P+b)*y.mx/32>H||c>Ba||(P+=b,.08>P&&(P=.08),xh&&rc(),dd(-Ta,-ya),k.useProgram(oa),k.uniform1f(ld,1/P),k.useProgram(da),k.uniform1f(kd,1/P),x.setupZoom(P),Ak())}},Ak=function(){var b=tzar.width,c=tzar.height,e=-ya+.5*(c-P*c),d=P*(b-y.mx);c*=P;qb[0]=-Ta+.5*(b-P*b);qb[1]=
e;qb[2]=-999999999;qb[3]=0;qb[4]=0;Xd();qb[0]=d;qb[1]=c;qb[2]=0;qb[3]=0;qb[4]=0;Bk()},Ck,Dk;sk=function(){var b=[Ta,ya];if(Ta!=Ck||ya!=Dk)Ck=Ta,Dk=ya,x.setupTranslation(-Ta,-ya),k.useProgram(oa),k.uniform2fv(ge,b),k.useProgram(da),k.uniform2fv(fe,b),Ak()};var md,Lf=function(){var b=window.innerWidth,c=window.innerHeight;k.canvas.width=b;k.canvas.height=c;x.canvasSize(b,c);k.useProgram(oa);k.uniform2f(Ih,b,c);k.useProgram(da);Lc.width=b;Lc.height=c;k.activeTexture(k.TEXTURE2);md||(md=k.createTexture());
k.bindTexture(k.TEXTURE_2D,md);k.texImage2D(k.TEXTURE_2D,0,k.RGBA,b,c,0,k.RGBA,k.UNSIGNED_BYTE,null);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);k.bindFramebuffer(k.FRAMEBUFFER,Lc);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,md,0);k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT);
k.bindFramebuffer(k.FRAMEBUFFER,null);k.uniform1f(kd,1);k.uniform1i(k.getUniformLocation(da,"lightmap"),2);k.useProgram(oa);k.uniform1i(k.getUniformLocation(oa,"lightmap"),2);k.uniform1f(ld,1);k.useProgram(da);k.uniform2f(If,b,c);k.viewport(y.mx,0,b,c);Lf.changed=1;dd(-Ta,-ya)};"use strict";var fa=function(b,c){return b<H&&0<=b&&0<=c&&c<Ba?!0:!1};Array.prototype.put=function(b){this[this.length]=b};var lc,je,Ud,nd=function(b,c,e,d){d&&0==nd.cols[d]&&(nd.list.push(d,b),nd.cols[d]=1)};nd.cols={};nd.list=
[];var I=function(b){for(var c=Object.keys(b),f=0;f<0*c.length;f++)b[b[c[f]]]=c[f];return b};window.onerror=nd;var v={},sb=[],Ek=function(b,c){for(var f=b.splen,d=f,g=c[0]||0,h=c[1]||0,q=c[2]||0,l=c[3]||0,p=c.deltaY||0,m=0,k=c.length;m<k;m++)b[f]=c[m],4<m?(5===(m-4)%6&&(f+=2),3===(m-4)%6&&(b[f]+=p),f++,g&&0==(f-d)%(8*g+4)&&m+1!=k&&(b[f++]=g,b[f++]=h,b[f++]=q,b[f++]=l)):f++;for(b.splen=f;0!==b.splen%4;)b.splen++},Mh=0,Fk=function(b,c){for(var f=Object.keys(b),d=0,g=f.length;d<g;d++){var h=b[f[d]];
if(Array.isArray(h))h==b.terrain_tree&&G(c.splen/4),x.setupIMGinfo(Mh,c.splen/4),h.asd=c.splen,Ek(c,h);else{for(var q=Object.keys(h),l=0,m=q.length;l<m;l++){var k=h[q[l]];h[q[l]]=c.splen/4;Ek(c,k)}x.setupIMGinfo(Mh,h.idle,h.move,h.attack,h.spell,h.dig,h.build,h.cut,h.die,h.food,h.gold,h.kirka,h.meat,h.milk,h.stone,h.milk1,h.tree,h.tree,h.jump)}h.urlID=Mh++}},O=function(b,c,e,d){var f=0,h=e.length-1,q=e[h];d=Tb[d];var l=[],m=0,k=!0;fa(b,c)&&fa(b+q-1,c+h/q-1)||(k=!1);for(var n=H,r=0;r<h;r++){f==q&&
(f=0,c++);if(e[r]){var t=b+f+n*c;d[t]&&(k=!1);if(0<Y[t]||ob[t])k=!1;l[m++]=t}f++}return[l,k]};O.check=function(b,c,e,d,g,h,q,l){var f=e.length-1;e=e[f];var m=f/e;f=H;q=Tb[q];e+=2;--b;--c;m=e*(m+2);for(var k=0;k<m;k++){var n=b+k%e,r=c+~~(k/e),t=n+r*f;if(0<Y[t]||ob[t]||h&&(n>=g&&n<=g+2||r>=d&&r<=d+2)||!fa(n,r)||q[t]||A[Ya[t]].field||l[t])return!1}return!0};var Gk=function(b,c,e){var d=0,f=e.length-1,h=e[f],q=[],l=[],m=0,k=!0;fa(b,c)&&fa(b+h-1,c+f/h-1)||(k=!1);for(var n=0,r=0;r<f;r++){d==h&&(d=0,c++);
var t=b+d+H*c;e[r]?(2<Y[t]&&(k=!1),q[m++]=t):(l[n++]=t,2<Y[t]&&(k=!1));d++}return[q,k,l]},Jg=function(b,c,e){var d=0,f=e.length-1,h=e[f],q=[],l=0,m=!0;fa(b,c)&&fa(b+h-1,c+f/h-1)||(m=!1);for(var k=0;k<f;k++){d==h&&(d=0,c++);var n=b+d+c*H;if(e[k]&&2<Y[n]&&1==A[Y[n]].build||0<Ya[n])m=!1;q[l++]=n;d++}return[q,m]},Mf=function(b,c,e){var d=!1,f=0,h=[],q=0,l=e.length-1,m=e[l],k=0,n=!0;fa(b,c)&&fa(b+m-1,c+l/m-1)||(n=!1);for(var r=0;r<l;r++){k==m&&(k=0,c++);if(e[r]){var t=b+k+H*c,v=Y[t];2<v&&(n=!1);0<v?f++:
d=!0;h[q++]=t}k++}f>.5*(l-1)&&d||(n=!1);return[h,n]},ke=function(b,c,e){e=!0;fa(b,c)||(e=!1);1!==Ya[b+c*H]&&(e=!1);return[[b+c*H],e]},U=function(b,c,e){e=!0;fa(b,c)||(e=!1);0<Y[b+c*H]&&(e=!1);return[[b+c*H],e]},Nf=function(b,c,e){e=!0;fa(b,c)||(e=!1);0<Le[b+c*H]&&(e=!1);return[[b+c*H],e]},wb=function(b,c,e){e=!0;fa(b,c)||(e=!1);if(0<Ya[b+c*H]||2==Y[b+c*H]||1==Y[b+c*H])e=!1;return[[b+c*H],e]};O.dimension=Kc;ke.dimension=cd;Gk.dimension=Kc;Jg.dimension=cd;U.dimension=Kc;Nf.dimension=Gh;wb.dimension=
cd;Mf.dimension=Kc;var Qm=function(b){for(var c=Object.keys(b),f=0,d=c.length;f<d;f++)b[c[f]].deltaY=168960},ca,D,qa,jb,Bg=function(){ca={img:0,x32:-1E3,y32:-1E3,rgb:[0,0,0,.5],d:0,active:!1};var f=8,c=9;if(!ie){Rm();var e=[b.move,b.attack,b.guard,b.patrol,b.pickUp,b.explore,b.stop,b.stand,b.sameSpeed,b.restoreSpeed];je={magic_creatures:[58,40,59,5,78,77,60,130,131,132,89,129]};for(var d=Object.keys(je),g=0,h=d.length;g<h;g++){var q=je[d[g]],l={};q.obj=l;for(var p=0,k=q.length;p<k;l[q[p++]]=1);}jd.mercenaries=
[b.mercArcher,b.mercFootman,b.mercMaceman,b.mercLongbowman,b.mercPikeman,b.mercKnight,b.mercArcherAsian,b.mercSamurai,b.mercHourseSamurai,b.mercRonin,b.mercHorseArcher,b.mercChariot,b.mercFootmanArab,b.mercArcherArab,b.mercMacemanArab,b.mercPikemanArab,b.mercCavalry,b.mercEnichar,b.mercJihad];jd.heroes=[b.mercArcher6,b.mercFootman6,b.mercMaceman6,b.mercLongbowman6,b.mercPikeman6,b.mercKnight6,b.mercArcherAsian6,b.mercSamurai6,b.mercHourseSamurai6,b.mercRonin6,b.mercHorseArcher6,b.mercChariot6,b.mercFootmanArab6,
b.mercArcherArab6,b.mercMacemanArab6,b.mercPikemanArab6,b.mercCavalry6,b.mercEnichar6,b.mercJihad6];d=jd.mercenaries;g=0;for(h=d.length;g<h;d[g++].merc=9);d=jd.heroes;g=0;for(h=d.length;g<h;d[g++].hero=1);l=m;l.expl_small_hole[1]=-1308;l.arrow1[4]=-20;l.arrow1[5]=-20;l.wood_build[0]=1;l.build2x2[0]=1;l.build3x3[0]=1;l.build4x4[0]=1;l.build5x5[0]=1;l.build6x6[0]=1;l.wood_build[1]=0;l.build2x2[1]=0;l.build3x3[1]=0;l.build4x4[1]=0;l.build5x5[1]=0;l.build6x6[1]=0;l.items1[2]=1;l.build_harbor[2]=1;l.bridge_horz_build[2]=
1;l.bridge_vert_build[2]=1;l.fields[0]=1;l.fields[1]=0;l.sexplosion[0]=13;l.sexplosion[1]=25;l.flame_trail[0]=16;l.flame_trail[1]=25;l.res_gold[1]=0;l.res_gold_s[1]=0;l.res_stone[1]=0;l.res_stone_s[1]=0;l.res_gold[0]=1;l.res_gold_s[0]=1;l.res_stone[0]=1;l.res_stone_s[0]=1;g=l.blank[1]=0;for(d=l.asian_charriot.idle.length;g<d;g+=6)l.asian_charriot.idle[4+g]-=17;g=0;for(d=l.asian_charriot.attack.length;g<d;g+=6)l.asian_charriot.attack[4+g]-=17;g=0;for(d=l.asian_charriot.move.length;g<d;g+=6)l.asian_charriot.move[4+
g]-=17;g=0;for(d=l.asian_charriot.die.length;g<d;g+=6)l.asian_charriot.die[4+g]-=17;g=0;for(d=l.flame_trail.length;g<d;g+=6)l.flame_trail[4+g]-=32,l.flame_trail[5+g]-=32;g=0;for(d=l.sexplosion.length;g<d;g+=6)l.sexplosion[4+g]-=48,l.sexplosion[5+g]-=48;l.items1[1]=0;l.books[1]=0;l.potions[1]=0;l.troll.attack[1]=14;l.ork.attack[1]=14;l.dwarf.attack[1]=14;l.asian_mage.move[1]=14;l.arab_priest.attack=l.arab_priest.spell;l.asian_mage.spell=l.asian_mage.castspell;l.asian_mage.attack=l.asian_mage.castspell;
l.asian_mage.spell[1]=13;l.arab_horse_archer.move=l.arab_horse.archer;l.arab_jwarrior.attack[1]=14;l.arab_peasant.attack=l.arab_peasant.attack1;l.arab_peasant.tree=l.arab_peasant.wood;l.asian_peasant.attack=l.asian_peasant.attack1;l.asian_peasant.cut=l.asian_peasant.chop;l.asian_peasant.tree=l.asian_peasant.wood;l.asian_peasant.dig[1]=10;l.asian_peasant.dig[0]=11;l.asian_archer.die[1]=14;l.asian_ronin.attack=l.asian_ronin.attack1;g=0;for(d=l.asian_peasant.dig.length;g<d;g+=6)l.asian_peasant.dig[4+
g]-=16,l.asian_peasant.dig[5+g]-=16;g=0;for(d=l.turn_to_stone.length;g<d;g+=6)l.turn_to_stone[4+g]-=56,l.turn_to_stone[5+g]-=64;l.arab_tcguild_c[4]=31;l.arab_tcguild_c[5]=85;l.dragon.idle=l.dragon.move;l.asian_samurai.attack=l.asian_samurai.attack1;l.asian_horsamurai.idle=l.asian_horsamurai.idle1;l.asian_horsarcher.idle=l.asian_horsarcher.idle2;l.asian_priest.attack=l.asian_priest.attack1;l.asian_priest.spell=l.asian_priest.pray;l.asian_monk.attack[1]=12;l.euro_mage.attack=l.euro_mage.spell;l.euro_ghost.idle=
l.euro_ghost.move;l.euro_priest.attack=l.euro_priest.spell;l.arab_mage.spell=l.arab_mage.attack;l.cursor[1]=15;l.star[1]=15;l.asian_ninja.attack=l.asian_ninja.attack1;l.asian_ninja.attack[1]=8;l.select[4]+=3;l.select[5]+=3;l.arab_houses_c[f]=96;l.asia_houses_c[f]=96;l.asia_houses_c[4]-=9;l.asia_houses_c[5]-=15;l.wood_build[2]=1;l.res_gold[2]=1;l.res_gold_s[2]=1;l.res_stone[2]=1;l.res_stone_s[2]=1;l.bridge_horz1[4]=-9;l.bridge_horz1[5]=132;l.bridge_horz1[4]=-9;l.bridge_horz1[5]=132;l.euro_stable_c[4]+=
18;l.euro_stable_c[5]-=10;l.euro_lumbermill_s[4]-=19;l.euro_lumbermill_s[5]-=17;l.wood_tower_c[4]=0;l.wood_tower_c[5]*=1;l.bat.idle=l.bat.move;l.galleon.idle[1]=7;l.galleon.die[1]=8;l.expl_small_water[1]=11;g=0;for(d=l.curse.length;g<d;g+=6)l.curse[5+g]-=48;g=0;for(d=l.impersonate.length;g<d;g+=6)l.impersonate[5+g]-=48;g=0;for(d=l.bless.length;g<d;g+=6)l.bless[5+g]-=48;g=0;for(d=l.euro_barracks_c.length;g<d;g+=6)l.euro_barracks_c[4+g]+=50;g=0;for(d=l.healing.length;g<d;g+=6)l.healing[5+g]-=48;g=0;
for(d=l.expl_small_hole.length;g<d;g+=6)l.expl_small_hole[4+g]-=4,l.expl_small_hole[5+g]-=34;Date.now();g=[b.createKnight,b.createHorseArcher1,b.createHorseArcher2,b.createHorseSamurai,b.createChariot,b.createEnichar,b.createCavalry];h=de(x.atlasLoc(),1048576);h.splen=0;Fk(m,h);ia.info=h;ia.originalLength=sb.length;Ud={sword:{name:"Sword",iconID:16,img:m.items1,d:0,dMax:7,attack:1,type:52,sword:1},bow:{name:"Bow",iconID:4,img:m.items1,d:15,dMax:4,attack:1,type:52,sword:1},shield:{name:"Shield",iconID:1,
img:m.items1,d:8,dMax:6,defence:1,type:52,shield:1},potion:{name:"Potion",iconID:11,img:m.potions,d:0,dMax:7,type:52,potion:1},book:{name:"Book",iconID:9,img:m.books,d:0,dMax:4,type:52,book:1},gold:{name:"Gold",iconID:20,img:m.item_gold,d:0,dMax:0,type:52},stone:{name:"Stone",iconID:22,img:m.item_stone,d:0,dMax:0,type:52},food:{name:"Food",iconID:14,img:m.item_food,d:0,dMax:0,type:52},wood:{name:"Wood",iconID:15,img:m.item_tree,d:0,dMax:0,type:52},iron:{name:"Iron",iconID:21,img:m.item_iron,d:0,dMax:0,
type:52}};h=[b.move,b.attack,b.stop,b.stand,b.pickUp,b.explore,b.healing,b.bless];d=[b.attack,b.guard,b.patrol,b.explore,b.stop,b.stand,b.attackGround,b.steady,b.move];p=[b.buildAcademy,b.buildWorkshop,b.buildWorkshop1,b.buildAcademy1,b.buildWorkshop2,b.buildAcademy2];k=[b.buildMerchands1,b.buildMerchands2,b.buildMerchands];jb={euro:{},asia:{},arab:{},common:{}};z=[{name:"Footman",attack:6,defence:3,health:65,maxHealth:65,img:m.euro_footman.idle,attackSound:Yb,invType:0,invMax:8,validator:U,human:12,
iconID:36,time:12,sight:5,url:m.euro_footman,icons:e,cost:[0,0,50,0],attDist:1,spd:50,dieSound:Xa,clss:"footman",size:1,standardFunc:C,radix:0,zLevel:1,strID:"e_footman",race:"euro"},{name:"Pikeman",radix:0,attackSound:Yb,attack:8,defence:4,health:75,maxHealth:75,img:m.euro_pikeman.idle,invType:0,dieSound:Xa,invMax:8,validator:U,human:1,iconID:39,time:18,sight:5,url:m.euro_pikeman,icons:e,cost:[40,0,60,0],attDist:1,spd:50,standardFunc:C,clss:"e_pikeman",zLevel:1,size:1,strID:"e_pikeman",nu:b.createPikeman,
race:"euro"},{name:"Spy",radix:0,attack:20,defence:0,mana:100,manaMax:100,health:50,maxHealth:50,img:m.euro_spy.idle,attackSound:["spy%20kill%201","spy%20kill%202","spy%20kill%203"],invType:0,invMax:8,validator:U,human:1,dieSound:Xa,iconID:41,time:30,sight:12,url:m.euro_spy,icons:[b.move,b.attack,b.guard,b.patrol,b.pickUp,b.explore,b.stop,b.stand,b.impersonate,b.revealSelf],zLevel:1,cost:[120,0,0,0],attDist:1,spd:50,clss:"spy",standardFunc:C,size:1,update:["mana","manaSpeed",1E3],isSpy:1,strID:"spy",
nu:b.createSpy,race:"common"},{name:"Maceman",radix:0,attack:8,defence:0,health:120,maxHealth:120,img:m.euro_maceman.idle,attackSound:Yb,invType:0,invMax:8,validator:U,human:1,iconID:37,time:14,dieSound:Xa,sight:5,zLevel:1,url:m.euro_maceman,icons:e,cost:[0,0,120,0],attDist:1,spd:50,clss:"maceman",standardFunc:C,size:1,strID:"e_maceman",nu:b.createMaceman,race:"euro"},{radix:0,name:"Archer",attack:5,defence:0,health:50,maxHealth:50,img:m.euro_archer1.idle,invType:0,invMax:8,validator:U,human:1,sight:10,
dieSound:Xa,arrow:!0,iconID:38,zLevel:1,time:12,url:m.euro_archer1,icons:e,cost:[0,20,40,0],attDist:7,spd:50,clss:"archer",standardFunc:C,attimg:m.arrow1,attackSound:Yc,size:1,strID:"e_archer",nu:b.createArcher,race:"euro"},{radix:0,name:"Wizard",attackSound:Ii,dieSound:["mage"],attack:5,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:m.euro_mage.idle,zLevel:1,invType:0,invMax:8,validator:U,human:1,iconID:42,time:30,sight:15,url:m.euro_mage,icons:[b.stop,b.pickUp,b.explore,b.lightning,b.createBat,
b.freeze,b.createGolem,b.invisibility,b.stand,b.attack,b.move],cost:[150,0,0,0],attDist:10,attimg:m.flame_bolt,ball:1,spd:50,clss:"mage",standardFunc:C,size:1,update:["mana","manaSpeed",1E3],strID:"e_mage",nu:b.createMage,race:"euro"},{radix:0,name:"Longbowman",attack:6,defence:2,health:50,maxHealth:50,img:m.euro_longbowman.idle,zLevel:1,invType:0,invMax:8,dieSound:Xa,attackSound:Yc,arrow:!0,validator:U,race:"euro",human:1,iconID:35,time:18,sight:18,url:m.euro_longbowman,icons:e,cost:[50,0,90,0],
attDist:12,spd:50,standardFunc:C,clss:"longbowman",size:1,d2attack:2,strID:"e_longbowman",attimg:m.arrow1,nu:b.createLongbowman},{radix:0,clss:"tree",name:"Tree",health:100,maxHealth:100,img:m.terrain_tree,invType:0,invMax:8,zLevel:1,mMapcolor:[11,131,11],validator:U,child:[{img:m.terrain_tree_s,rgb:[0,0,0,.5],alpha:1,x:0,y:0}],iconID:23,url:m.terrain_tree,dimgInfinity:m.terrain_tree,dimgRND:3,icons:[],res:1,race:"common",build:!0,size:1,zolotoy:1,strID:"tree"},{radix:0,name:"Crusader",zLevel:1,dieSound:Dd,
attackSound:Bd,attack:14,defence:8,health:180,maxHealth:180,img:m.crus.idle,invType:0,invMax:8,validator:U,human:1,race:"euro",iconID:100,time:19,sight:5,url:m.crus,icons:e,cost:[0,0,0,0],attDist:1,spd:85,standardFunc:C,clss:"crusader",size:1,strID:"crusader"},{radix:0,name:"Priest",attack:20,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:m.euro_priest.idle,invType:0,zLevel:1,invMax:8,validator:U,human:1,iconID:40,time:30,ball:1,sight:21,dieSound:Xa,url:m.euro_priest,icons:h,attackOnly:je.magic_creatures.obj,
cost:[150,0,0,0],attDist:18,race:"euro",spd:50,standardFunc:C,clss:"priest",size:1,update:["mana","manaSpeed",1E3],strID:"e_priest",nu:b.createPriest,attimg:m.flame_bolt},{radix:0,name:"Peasant",attackSound:Cg,attack:5,defence:0,health:50,maxHealth:50,img:m.euro_peasant.idle,invType:0,invMax:8,dieSound:Xa,zLevel:1,validator:U,human:1,race:"euro",iconID:33,time:8,sight:5,url:m.euro_peasant,icons:[b.move,b.menuBuilds,b.repair,b.conquest,b.dcm,b.pickUp,b.explore,b.stop,b.stand,b.attack,b.bribe,b.sameSpeed,
b.restoreSpeed],cost:[0,0,50,0],attDist:1,spd:50,clss:"peon",size:1,peon:1,strID:"e_peon",nu:b.createPeon,nocapture:1},{radix:0,clss:"cathedral",name:"Cathedral",dieSound:N,sound:["e_cathedral1","e_cathedral2"],resistance:700,health:5E3,maxHealth:5E3,img:m.euro_cathedral,invType:0,invMax:8,race:"euro",zLevel:1,validator:O,bimg:m.build5x5,dimg:m.des_5x5,iconID:60,icons:[b.createCrusaders,b.techFanaticism,b.techEspionage,b.techInquisition,b.techHealing,b.techBless,b.techCrusade,b.techMedicine],time:90,
sight:8,child:[{img:m.euro_cathedral_c,x:0,y:0},{img:m.euro_cathedral_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,5]),url:m.euro_cathedral,build:!0,cost:[2E3,0,0,2E3],onbuild:[b.buildChurch],size:1,strID:"cathedral"},{radix:0,name:"Castle",clss:"castle",dieSound:N,sound:["e_castle1"],resistance:700,health:8E3,maxHealth:8E3,img:m.euro_castle,invType:1,invMax:50,race:"euro",zLevel:1,validator:O,bimg:m.build6x6,dimg:m.des_6x6,iconID:59,
time:120,sight:12,child:[{img:m.euro_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:m.euro_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[b.createPeon,b.createSpy,b.emergeAllUnits,b.techFeudalism,b.techArchitecture,b.techLearning],space:new Uint8Array([0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,0,1,1,7]),menu:va,url:m.euro_castle,build:!0,cost:[0,1500,0,1500],storage:4,castle:!0,population:20,size:1,strID:"e_castle"},{radix:0,name:"Wooden Wall",clss:"wall_wood",resistance:700,
health:2E3,maxHealth:2E3,img:m.wood_tower,time:6,sight:1,zLevel:1,dieSound:N,validator:O,bimg:m.wood_build,dimgInfinity:m.wood_debris,iconID:49,icons:[],mx:0,race:"common",my:0,hframe:71,menu:va,url:m.wood_tower,space:new Uint8Array([1,1]),wall:1,build:!0,cost:[0,20,0,0],size:1,strID:"woodwall",child:[{img:m.wood_tower_c,x:0,y:0}]},{radix:0,name:"Barracks",clss:"barracks",strID:"e_barrack",sound:Dg,generator:1,resistance:500,health:1400,maxHealth:1400,img:m.euro_barrack,invType:1,invMax:0,dieSound:N,
time:60,sight:6,zLevel:1,race:"euro",validator:O,bimg:m.build5x5,dimg:m.des_5x5,child:[{img:m.euro_barracks_c,mv:!0},{img:m.euro_barrack_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:57,icons:[b.createFootman,b.createArcher,b.createMaceman,b.createPikeman,b.createLongbowman,b.createKnight],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:m.euro_barrack,build:!0,cost:[0,0,200,200],size:1},{radix:0,strID:"e_lumber",name:"Lumber Mill",sound:["e_lumber1"],clss:"lumber_mill",
resistance:500,health:800,maxHealth:800,img:m.euro_lumbermill,invType:1,invMax:0,time:30,race:"euro",sight:4,dieSound:N,zLevel:1,validator:O,bimg:m.build2x2,dimg:m.des_2x2,iconID:64,child:[{img:m.euro_lumbermill_c,x:0,y:0},{alpha:!0,img:m.euro_lumbermill_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[b.techLongbow,b.techWoodCutting,b.techCrossbow],space:new Uint8Array([1,1,1,1,2]),hframe:98,url:m.euro_lumbermill,build:!0,cost:[0,100,0,0],storage:1,size:1},{radix:0,name:"Mage Tower",strID:"e_magetower",sound:["e_magetower1",
"e_magetower2","e_magetower3"],clss:"magictower",resistance:700,health:5E3,maxHealth:5E3,img:m.euro_magetower,invType:1,invMax:0,time:90,race:"euro",dieSound:N,sight:8,validator:O,bimg:m.build5x5,dimg:m.des_5x5,zLevel:1,child:[{img:m.euro_magetower_c,x:0,y:0},{img:m.euro_magetower_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:71,icons:[b.createMage,b.techBat,b.techInvisibility,b.techLightning,b.techFreeze,b.techGolem],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:m.euro_magetower,build:!0,
cost:[2E3,0,0,2E3],size:1},{radix:0,strID:"e_waracademy",name:"Warriors Guild",sound:["e_waracademy1"],clss:"academy",resistance:700,health:5E3,maxHealth:5E3,img:m.euro_waracademy,invType:1,invMax:0,race:"euro",time:90,sight:8,dieSound:N,zLevel:1,validator:O,bimg:m.build6x6,dimg:m.des_6x6,iconID:56,child:[{img:m.euro_waracademy_c,x:0,y:0,mv:!0},{img:m.euro_waracademy_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],icons:[b.techHeroism,b.techWarfare,b.techMercenaries,b.techSiegeTactics,b.techBodyBuilding,b.techLeadership,
b.techTactics,b.techHeroes,b.techHonor,b.techFame],space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,0,5]),url:m.euro_waracademy,build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,name:"Storage",strID:"e_storage",sound:["e_storage1","e_storage2"],clss:"storage",resistance:80,health:800,maxHealth:800,img:m.euro_storage,invType:1,invMax:0,time:30,dieSound:N,zLevel:1,sight:5,validator:O,bimg:m.build4x4,dimg:m.des_4x4,iconID:69,race:"euro",icons:[b.techGoldMining,b.techStoneMining],space:new Uint8Array([1,
1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,4]),url:m.euro_storage,storage:0,build:!0,cost:[0,200,0,0],size:1,child:[{img:m.euro_storage_c,x:0,y:0},{img:m.euro_storage_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Knight",strID:"e_knight",dieSound:Dd,clss:"knight",attackSound:Bd,attack:12,defence:6,health:120,maxHealth:120,img:m.euro_knight.idle,invType:0,zLevel:1,race:"euro",invMax:8,validator:U,human:1,iconID:43,d2attack:2,time:22,sight:5,url:m.euro_knight,icons:e,cost:[120,0,70,0],attDist:1,spd:85,nu:b.createKnight,
standardFunc:C,size:1},{radix:0,name:"Field",clss:"field",strID:"field",instantBuild:1,resistance:80,health:100,maxHealth:100,img:m.fields,invMax:0,validator:Jg,zLevel:0,iconID:104,race:"common",icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:m.fields,build:!0,field:1,res:2,cost:[0,200,0,0],rndDirection:9,time:0,sight:1,z32:.5,size:1},{radix:0,name:"Golden rocks",mMapcolor:[148,148,0],strID:"gold",sound:["mine1"],clss:"golden_rocks",resistance:0,health:8E3,maxHealth:8E3,img:m.res_gold,invMax:0,
validator:O,iconID:20,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:m.res_gold,build:!0,zLevel:1,race:"common",res:0,cost:[0,0,0,0],time:0,sight:2,dieSound:["destroy%20mine"],size:1,zolotoy:1,child:[{img:m.res_gold_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:m.res_gold},{radix:0,name:"Rocks",strID:"stone",mMapcolor:[132,132,132],sound:["mine1"],clss:"rocks",dieSound:["destroy%20mine"],resistance:0,health:8E3,maxHealth:8E3,img:m.res_stone,invMax:0,validator:O,zLevel:1,
iconID:22,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:m.res_stone,build:!0,res:3,cost:[0,0,0,0],race:"common",time:0,sight:2,size:1,zolotoy:1,child:[{img:m.res_stone_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:m.res_stone},{radix:0,name:"Farm",strID:"e_farm",sound:["e_farm1","e_farm2"],clss:"farm",resistance:0,health:800,maxHealth:800,img:m.euro_farm,invType:1,invMax:0,zLevel:1,validator:O,bimg:m.build4x4,dimg:m.des_4x4,iconID:61,dieSound:N,race:"euro",icons:[b.createCow,
b.techCropRotation,b.techDomestication],space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),menu:va,url:m.euro_farm,build:!0,cost:[0,200,0,0],time:30,sight:5,storage:2,size:1,child:[{img:m.euro_farm_c,x:0,y:0}]},{radix:0,name:"Merchants Guild",strID:"e_merchant",sound:["merchant"],clss:"merchants_guild",resistance:0,health:5E3,maxHealth:5E3,img:m.euro_tcguild,invType:1,invMax:0,validator:O,bimg:m.build6x6,zLevel:1,dimg:m.des_6x6,race:"euro",iconID:62,dieSound:N,icons:[b.techMapMaking,b.techTradeRoutes,
b.techUsury,b.techSupplyStorage,b.techBribery,b.techTradeTaxes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),menu:va,url:m.euro_tcguild,build:!0,time:90,sight:8,cost:[2E3,0,0,2E3],onbuild:[b.buildMarket],size:1,child:[{img:m.euro_tcguild_c,x:0,y:0},{img:m.euro_tcguild_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Church",clss:"church",strID:"e_church",sound:["e_church1"],resistance:0,health:800,maxHealth:800,img:m.euro_church,invType:1,invMax:0,dieSound:N,validator:O,
bimg:m.build3x3,race:"euro",zLevel:1,dimg:m.des_3x3,iconID:139,icons:[b.createPriest],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),menu:va,url:m.euro_church,build:!0,cost:[0,0,200,200],time:40,sight:6,size:1,child:[{img:m.euro_church_c,x:0,y:0},{img:m.euro_church_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Blacksmith",clss:"blacksmith",strID:"e_blacksmith",resistance:0,health:800,maxHealth:800,img:m.euro_blacksmith,invType:1,invMax:0,time:40,zLevel:1,sight:5,dieSound:N,validator:O,bimg:m.build4x4,
race:"euro",dimg:m.des_4x4,child:[{img:m.euro_blacksmith_c,x:0,y:0}],iconID:58,icons:[b.techPlateArmor,b.techTemperIron,b.techScaleArmor,b.techHalberd,b.techChainMail],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),menu:va,url:m.euro_blacksmith,build:!0,cost:[0,0,200,200],onbuild:p,size:1},{radix:0,name:"Cow",clss:"cow",nu:b.createCow,race:"common",strID:"cow",attack:0,defence:3,health:50,maxHealth:50,img:m.cow.idle,invType:0,invMax:8,zLevel:1,validator:U,iconID:99,time:20,dieSound:["cowdie1",
"cowdie2","cowdie3","cowdie4"],url:m.cow,icons:[b.move,b.stop],sight:3,cost:[0,0,300,0],attDist:0,spd:32,res:2,food:300,milk:50,milkMax:50,foodMax:600,size:1,cow:1,update:["milk","milkSpeed",1E3,"food","cowSpeed",1E3]},{radix:0,name:"Stable",sound:["e_stables1"],clss:"stable",strID:"e_stable",onlyRequired:1,resistance:0,health:800,maxHealth:800,invType:1,invMax:0,race:"euro",zLevel:1,validator:O,bimg:m.build4x4,dimg:m.des_4x4,iconID:68,dieSound:N,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,
1,1,4]),url:m.euro_stables,build:!0,cost:[0,200,0,0],onbuild:g,size:1,time:40,sight:5,img:m.euro_stables,nu:b.createCow,child:[{img:m.euro_stable_c,x:0,y:0}]},{radix:0,name:"Workshop",sound:["e_workshop1"],clss:"workshop",strID:"e_workshop",zLevel:1,resistance:0,health:800,maxHealth:800,img:m.euro_workshop,invType:1,invMax:0,dieSound:N,validator:O,bimg:m.build4x4,race:"euro",dimg:m.des_4x4,iconID:75,icons:[b.createCatapult,b.createHeavyCatapult,b.createBallist,b.techEngineering,b.techCannonTower],
space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,4]),url:m.euro_workshop,build:!0,cost:[0,200,200,0],size:1,time:40,sight:5,child:[{img:m.euro_workshop_c,x:0,y:0}]},{radix:0,name:"Tavern",sound:["e_tavern1"],clss:"tavern",strID:"e_tavern",dieSound:N,resistance:0,health:1E3,maxHealth:1E3,img:m.euro_tavern,invType:1,invMax:0,validator:O,race:"euro",bimg:m.build4x4,dimg:m.des_4x4,zLevel:1,iconID:70,icons:[b.createMercenaries,b.createHeroes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,
4]),url:m.euro_tavern,build:1,cost:[0,200,200,0],onbuild:k,actvintv:[b.iniMercenaries,b.iniHeroes],size:1,time:40,sight:5,child:[{img:m.euro_tavern_c,x:0,y:0}]},{name:"House",sound:["house1","house2","house3","house4","house5"],clss:"house",strID:"e_house",resistance:0,health:500,maxHealth:500,img:m.euro_houses,invType:1,invMax:0,validator:O,bimg:m.build3x3,dimg:m.des_3x3,race:"euro",iconID:73,zLevel:1,dieSound:N,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:m.euro_houses,build:!0,cost:[0,
75,0,0],population:10,size:1,time:20,sight:4,child:[{img:m.euro_houses_c,x:0,y:0}]},{name:"Watch Tower",attackSound:De,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),clss:"watch_tower",strID:"watch_tower",attack:7,health:400,maxHealth:400,img:m.euro_tower_wood_2,state:0,invType:1,race:"common",invMax:0,zLevel:1,dieSound:N,level:0,validator:O,child:[{img:m.euro_tower_wood_2_c,x:0,y:0},{alpha:!0,img:m.euro_tower_wood_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attimg:m.arrow1,attDist:8,bimg:m.build2x2,dimg:m.des_2x2,
iconID:53,icons:[b.attack,b.stop,b.upgradeGuildTower],space:new Uint8Array([1,1,1,1,2]),url:m.euro_tower_wood_2,build:!0,cost:[0,300,0,0],size:1,arrow:!0,time:10,sight:15,standardFunc:C},{name:"Market",sound:["e_market1"],clss:"market",strID:"e_market",resistance:0,health:1400,maxHealth:1400,img:m.euro_market,invType:1,invMax:0,dieSound:N,zLevel:1,validator:O,bimg:m.build4x4,dimg:m.des_4x4,iconID:65,race:"euro",icons:[b.createCaravan],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,4]),url:m.euro_market,
build:!0,cost:[0,200,200,0],size:1,time:60,sight:8,child:[{img:m.euro_market_c,x:0,y:0}]},{name:"Outpost",sound:["e_outpost1"],clss:"outpost",strID:"e_outpost",zLevel:1,resistance:0,health:2E3,maxHealth:2E3,img:m.euro_outpost,invType:1,dieSound:N,invMax:50,validator:O,race:"euro",bimg:m.build4x4,dimg:m.des_4x4,iconID:66,icons:[b.emergeAllUnits],space:new Uint8Array([0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,4]),url:m.euro_outpost,build:!0,cost:[0,200,0,400],size:1,child:[{img:m.euro_outpost_c,x:0,y:0},{img:m.euro_outpost_s,
x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:60,sight:8},{name:"Bridge",clss:"bridge",strID:"bridge",resistance:0,health:1E4,maxHealth:1E4,img:m.bridge_horz,invMax:0,valid2:!0,validator:Gk,bimg:m.bridge_horz_build,race:"common",zLevel:1,dieSound:N,child:[{alpha:!0,img:m.bridge_horz_s,x:0,y:0,rgb:[0,0,0,.5]},{img:m.bridge_horz1,x:0,y:0,z:6}],time:22,sight:1,dimg:m.bridge_horz_demol,iconID:44,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,11]),url:m.bridge_horz,build:!0,cost:[0,200,0,400],size:1},{name:"Dummy",clss:"dummy",strID:"dummy",resistance:0,health:5E3,maxHealth:5E3,img:m.dummy1,invMax:0,validator:U,bimg:m.dummy1_b,iconID:165,icons:[],mx:0,zLevel:1,my:16,hframe:65,race:"common",url:m.dummy1,dimg:m.dummy1_d,build:!0,cost:[0,300,0,0],dummy:!0,child:[{img:m.dummy1_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:10,sight:1},{name:"Catapult",strID:"catapult",dieSound:Fe,
clss:"catapult",attackSound:Ee,defence:0,attack:10,health:110,maxHealth:110,img:m.catapult.idle,invMax:0,radix:0,validator:U,iconID:30,time:30,sight:20,race:"common",url:m.catapult,level:0,zLevel:1,icons:d,cost:[0,600,0,0],nofreeze:1,arrow:!1,attDist:17,spd:40,standardFunc:C,size:1,attimg:m.cat_stone,space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:b.createCatapult},{name:"Ballista",radix:0,strID:"ballista",attackSound:Ee,dieSound:Fe,clss:"ballista",defence:0,attack:60,health:75,maxHealth:75,img:m.ballista.idle,
invMax:0,validator:U,iconID:31,time:30,sight:16,nofreeze:1,race:"common",zLevel:1,url:m.ballista,icons:d,cost:[0,800,0,0],attDist:13,spd:40,standardFunc:C,size:1,attimg:m.arrow_ballista1,space:new Uint8Array([1,1,1,1,2]),attackDeg:30,nu:b.createBallist},{name:"Heavy Catapult",strID:"heavy_catapult",attackSound:Ee,defence:0,attack:25,health:250,maxHealth:250,img:m.h_catapult.idle,invMax:0,radix:0,validator:U,iconID:45,time:60,dieSound:Fe,sight:26,race:"common",url:m.h_catapult,zLevel:1,icons:d,standardFunc:C,
cost:[0,1200,0,0],attDist:22,spd:40,nofreeze:1,clss:"heavy_catapult",size:1,attimg:m.cb_metal,space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:b.createHeavyCatapult},{radix:0,name:"Ghost",strID:"ghost",defence:0,attack:8,health:60,maxHealth:60,img:m.euro_ghost.idle,invType:0,invMax:8,dieSound:["ghost1","ghost2"],validator:U,iconID:178,zLevel:1,race:"common",time:15,attackSound:Hi,sight:5,standardFunc:C,url:m.euro_ghost,icons:e,w:1,cost:[40,0,0,0],attDist:1,spd:80,clss:"ghost",size:1,nu:b.createGhost},
{name:"Harbor",strID:"e_harbor",resistance:80,health:800,maxHealth:800,img:m.euro_harbor,invType:1,invMax:0,validator:Mf,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:m.build_harbor,dimg:m.des_harbor,zLevel:1,race:"euro",dieSound:N,iconID:63,icons:[b.createFishingBoat,b.createXebec,b.createHulk,b.createGalleon,b.techLandingTactics],clss:"harbor",url:m.euro_harbor,storage:4,build:!0,cost:[0,200,200,0],child:[{img:m.euro_harbor_c,x:0,y:0},{img:m.euro_harbor_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],
time:60,sight:8},{radix:0,name:"Messiah",strID:"messiah",attack:50,defence:10,mana:1E3,manaMax:1E3,health:1E3,maxHealth:1E3,img:m.messiah.idle,invType:0,invMax:0,race:"common",validator:U,human:1,iconID:169,zLevel:1,attackSound:["messiah_attack"],dieSound:["messiah"],time:300,sight:26,url:m.messiah,standardFunc:C,icons:e,cost:[2E3,0,0,0],attDist:10,spd:50,clss:"messiah",size:1,update:["mana","manaSpeed",1E3]},{name:"Magic Gateway",sound:["gateway"],strID:"gateway",magicGateway:1,resistance:0,health:Infinity,
maxHealth:Infinity,img:m.teleport,invMax:0,validator:O,bimg:m.build4x4,zLevel:1,dieSound:N,race:"common",iconID:180,clss:"magic_gateway",icons:[b.createOrk,b.createDwarf,b.createGhost,b.createSkeleton],space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,5]),url:m.teleport,build:!0,cost:[0,0,0,0],size:1,time:10,sight:10,zolotoy:1,child:[{img:m.teleport_c,x:0,y:0},{alpha:!0,img:m.teleport_s,x:0,y:0,rgb:[0,0,0,.5]}],standardFunc:fm},{name:"Guard Tower",strID:"guard_tower",race:"common",
clss:"guard_tower",attackSound:De,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:12,health:1E3,maxHealth:1E3,img:m.euro_tower_wood,state:0,invType:1,invMax:0,dieSound:N,zLevel:1,validator:O,child:[{img:m.euro_tower_wood_c,x:0,y:0},{alpha:!0,img:m.euro_tower_wood_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:12,bimg:m.build2x2,dimg:m.des_2x2,iconID:52,icons:[b.attack,b.stop,b.upgradeStoneTower,b.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:m.euro_tower_wood,build:!0,cost:[0,600,0,
0],size:1,arrow:!0,attimg:m.arrow1,time:35,sight:16,standardFunc:C},{name:"Sword",attack:0,defence:0,health:25,maxHealth:25,img:m.items1,state:0,invMax:0,validator:wb,iconID:16,url:m.items1,icons:[],cost:[0,0,0,0],size:1,zLevel:0,z32:.5,radix:0,race:"common",item:1},{name:"Bow",attack:0,defence:0,health:25,maxHealth:25,img:m.items1,state:0,invMax:0,validator:wb,iconID:4,url:m.items1,icons:[],cost:[0,0,0,0],size:1,z32:.5,zLevel:0,radix:0,race:"common",item:1},{name:"Shield",attack:0,defence:0,health:25,
maxHealth:25,img:m.items1,state:0,invMax:0,validator:wb,iconID:1,url:m.items1,icons:[],cost:[0,0,0,0],zLevel:0,race:"common",radix:0,size:1,z32:.5,item:1},{name:"Potion",attack:0,defence:0,health:25,maxHealth:25,img:m.potions,state:0,invMax:0,validator:wb,iconID:11,url:m.potions,icons:[],radix:0,race:"common",zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Book",attack:0,defence:0,health:25,maxHealth:25,img:m.book1,state:0,invMax:0,validator:wb,iconID:9,zLevel:0,race:"common",radix:0,url:m.books,
icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Gold",health:1,maxHealth:1,img:m.item_gold,invMax:0,validator:wb,iconID:20,radix:0,race:"common",zLevel:0,url:m.item_gold,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Stone",health:1,maxHealth:1,img:m.item_stone,invMax:0,validator:wb,iconID:22,race:"common",radix:0,url:m.item_stone,zLevel:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Food",health:15,maxHealth:15,img:m.item_food,invMax:0,mMapcolor:[0,255,255],validator:wb,iconID:14,
url:m.item_food,radix:0,race:"common",icons:[],zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{ignore:1,name:"Wood",health:1,maxHealth:1,img:m.item_wood,invMax:0,validator:wb,iconID:15,url:m.item_wood,icons:[],race:"common",radix:0,zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Iron",health:1,maxHealth:1,img:m.item_iron,invMax:0,validator:wb,iconID:21,zLevel:0,race:"common",url:m.item_iron,radix:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Keep Tower",strID:"keep_tower",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),
attack:16,health:2E3,maxHealth:2E3,img:m.euro_tower_stone,state:0,invType:1,zLevel:1,attackSound:De,invMax:0,dieSound:N,validator:O,clss:"keep_tower",race:"common",child:[{alpha:!0,img:m.euro_tower_stone_s,x:0,y:0,rgb:[0,0,0,.5]},{img:m.euro_tower_stone_c,x:0,y:0}],attDist:14,bimg:m.build2x2,dimg:m.des_2x2,standardFunc:C,iconID:54,icons:[b.attack,b.stop,b.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:m.euro_tower_stone,build:!0,cost:[0,600,0,0],size:1,arrow:!0,attimg:m.arrow_big1,time:40,
sight:18},{name:"Cannon Tower",clss:"tower_stone2",strID:"tower_stone2",attackSound:Cd,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:40,health:2500,maxHealth:2500,img:m.euro_tower_stone_2,state:0,invType:1,invMax:0,dieSound:N,race:"common",validator:O,zLevel:1,child:[{img:m.euro_tower_stone_2_c,x:0,y:0},{alpha:!0,img:m.euro_tower_stone_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:10,bimg:m.build2x2,dimg:m.des_2x2,iconID:54,icons:[b.attack,b.stop],space:new Uint8Array([1,1,1,1,2]),url:m.euro_tower_stone_2,
build:!0,cost:[0,600,0,0],standardFunc:C,size:1,arrow:!1,attimg:m.hot_cannon,time:45,sight:18,attackDeg:30},{name:"Rocket Tower",strID:"tower_rocket",race:"asia",clss:"tower_rocket",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),zLevel:1,attack:30,health:1400,maxHealth:1400,img:m.rocket_tower,state:0,invType:1,invMax:0,dieSound:N,validator:O,child:[{img:m.rocket_tower_c},{alpha:!0,img:m.rocket_tower_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:20,bimg:m.build2x2,dimg:m.des_2x2,iconID:186,icons:[],space:new Uint8Array([1,
1,1,1,2]),url:m.rocket_tower,build:!0,cost:[0,600,0,0],standardFunc:C,size:1,arrow:!0,attimg:m.arrow_big1,time:60,sight:26},{radix:0,name:"Ork",race:"common",strID:"ork",dieSound:["orc%20die%201","orc%20die%202"],attackSound:Gi,attack:18,defence:2,health:75,maxHealth:75,img:m.ork.idle,invType:0,invMax:8,validator:U,zLevel:1,iconID:143,time:12,sight:5,url:m.ork,standardFunc:C,icons:e,cost:[60,0,0,0],attDist:1,spd:50,clss:"ork",size:1,nu:b.createOrk},{radix:0,name:"Dwarf",race:"common",attack:7,defence:7,
health:120,maxHealth:120,img:m.dwarf.idle,invType:0,strID:"dwarf",invMax:8,zLevel:1,dieSound:Xa,validator:U,iconID:185,time:12,sight:3,url:m.dwarf,standardFunc:C,icons:e,cost:[80,0,0,0],attDist:1,spd:50,clss:"dwarf",size:1,nu:b.createDwarf},{radix:0,name:"Skeleton",strID:"skeleton",race:"common",dieSound:["skeleton%20die%201","skeleton%20die%202","skeleton%20die%203","skeleton%20die%204"],attack:4,defence:0,health:40,maxHealth:40,img:m.skeleton.idle,invType:0,zLevel:1,attackSound:Yb,invMax:8,nofreeze:1,
validator:U,iconID:167,time:12,sight:3,url:m.skeleton,standardFunc:C,icons:e,cost:[0,0,30,0],attDist:1,spd:50,clss:"skeleton",size:1,nu:b.createSkeleton},{radix:0,name:"Caravan",race:"euro",strID:"e_caravan",attack:0,defence:0,health:350,maxHealth:350,img:m.caravan.idle,invType:1,invMax:8,validator:U,iconID:34,zLevel:1,time:50,sight:7,url:m.caravan,icons:[b.move,b.trade,b.explore,b.stop,b.stand,b.unload],cost:[0,200,400,0],attDist:1,spd:75,clss:"caravan",size:1,nu:b.createCaravan},{name:"Castle",
health:8E3,maxHealth:8E3,img:m.asia_castle,invType:1,strID:"a_castle",zLevel:1,race:"asia",invMax:50,validator:O,bimg:m.build6x6,dimg:m.des_6x6,iconID:164,time:120,sight:12,dieSound:N,clss:"castle",child:[{img:m.asia_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:m.asia_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[b.createPeon1,b.createNinja,b.emergeAllUnits,b.techFeudalism,b.techArchitecture,b.techLearning,b.techBuddhism,b.techGreatWall],space:new Uint8Array([0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,0,0,8]),menu:va,url:m.asia_castle,build:!0,cost:[0,1500,0,1500],storage:4,castle:!0,population:20,size:1},{name:"Castle",dieSound:N,clss:"castle",strID:"r_castle",race:"arab",health:8E3,maxHealth:8E3,img:m.arab_castle,invType:1,invMax:50,validator:O,bimg:m.build6x6,dimg:m.des_6x6,zLevel:1,iconID:97,time:120,sight:12,child:[{img:m.arab_castle_c}],icons:[b.createPeon2,b.createSpy,b.emergeAllUnits,b.techFeudalism,b.techArchitecture,
b.techLearning,b.techSlavery],space:new Uint8Array([0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,0,0,0,1,0,0,0,,8]),menu:va,url:m.arab_castle,build:!0,cost:[0,1500,0,1500],storage:4,castle:!0,population:20,size:1},{radix:0,name:"Peasant",attack:5,defence:0,health:50,maxHealth:50,img:m.asian_peasant.idle,invType:0,invMax:8,attackSound:Cg,race:"asia",validator:U,human:1,strID:"a_peon",iconID:132,dieSound:Xa,zLevel:1,time:8,peon:1,
sight:5,url:m.asian_peasant,icons:[b.move,b.menuBuilds1,b.repair,b.conquest,b.dcm,b.pickUp,b.explore,b.stop,b.stand,b.attack,b.sameSpeed,b.restoreSpeed],cost:[0,0,40,0],attDist:1,spd:50,clss:"peon",nocapture:1,size:1},{radix:0,name:"Ninja",race:"asia",attack:12,defence:5,mana:100,manaMax:100,health:90,maxHealth:90,img:m.asian_ninja.idle,invType:0,invMax:8,attackSound:Yb,validator:U,human:1,iconID:133,strID:"ninja",dieSound:Xa,zLevel:1,time:20,standardFunc:C,sight:10,url:m.asian_ninja,icons:[b.guard,
b.patrol,b.pickUp,b.explore,b.stop,b.stand,b.invisibility,b.murder,b.move,b.attack,b.sameSpeed,b.restoreSpeed],cost:[120,0,0,0],attDist:1,spd:85,clss:"ninja",size:1,update:["mana","manaSpeed",1E3]},{radix:0,name:"Ronin",attack:7,defence:0,health:45,maxHealth:45,img:m.asian_ronin.idle,invType:0,invMax:8,race:"asia",validator:U,human:1,standardFunc:C,iconID:141,strID:"ronin",dieSound:Xa,zLevel:1,time:8,sight:5,url:m.asian_ronin,icons:e,cost:[0,0,40,0],attDist:1,spd:50,attackSound:Yb,clss:"a_footman",
size:1},{radix:0,name:"Archer",attack:5,defence:0,health:50,maxHealth:50,img:m.asian_archer.idle,invType:0,invMax:8,race:"asia",validator:U,human:1,strID:"a_archer",dieSound:Xa,zLevel:1,attimg:m.arrow1,iconID:136,arrow:1,attackSound:Yc,time:12,sight:10,url:m.asian_archer,icons:e,cost:[0,20,40,0],standardFunc:C,spd:50,clss:"archer",size:1,attDist:6},{radix:0,name:"Samurai",attack:10,defence:4,health:90,maxHealth:90,img:m.asian_samurai.idle,invType:0,race:"asia",strID:"samurai",invMax:8,attackSound:Yb,
validator:U,human:1,iconID:142,time:20,standardFunc:C,zLevel:1,dieSound:Xa,sight:6,url:m.asian_samurai,icons:e,cost:[50,0,150,0],attDist:1,spd:50,clss:"a_maceman",size:1},{radix:0,name:"Horse Archer",attack:7,defence:0,health:75,maxHealth:75,img:m.asian_horsarcher.idle,invType:0,race:"asia",invMax:8,validator:U,human:1,attackSound:Yc,iconID:183,strID:"a_horse_archer",dieSound:Dd,time:20,standardFunc:C,sight:12,url:m.asian_horsarcher,zLevel:1,icons:e,arrow:1,attimg:m.arrow1,cost:[40,0,120,0],spd:85,
clss:"horse_archer",size:1,attDist:7},{radix:0,name:"Horse Samurai",attack:14,defence:4,health:160,maxHealth:160,img:m.asian_horsamurai.idle,invType:0,invMax:8,validator:U,human:1,iconID:135,race:"asia",standardFunc:C,attackSound:Bd,time:22,zLevel:1,strID:"horse_samurai",dieSound:Dd,sight:5,url:m.asian_horsamurai,icons:e,cost:[75,0,120,0],attDist:1,spd:85,clss:"horse_samurai",size:1},{name:"Barracks",resistance:500,health:1400,maxHealth:1400,img:m.asia_barracks,invType:1,sound:Dg,invMax:0,time:60,
dieSound:N,radix:0,sight:6,race:"asia",strID:"a_barrack",validator:O,zLevel:1,bimg:m.build5x5,dimg:m.des_5x5,child:[{img:m.asia_barracks_c,x:0,y:0,mv:!0},{img:m.asia_barracks_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:146,icons:[b.createRonin,b.createArcher1,b.createSamurai,b.createHorseArcher1,b.createHorseSamurai,b.createChariot],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:m.asia_barracks,build:!0,cost:[0,200,0,200],size:1,clss:"barracks"},{name:"Chariot",attack:4,
defence:3,health:180,maxHealth:180,img:m.asian_charriot.idle,invType:0,radix:0,race:"asia",invMax:8,strID:"chariot",dieSound:["c%20die%201","c%20die%202","c%20die%203","c%20die%204","c%20die%205"],attackSound:Bd,validator:U,human:1,zLevel:1,iconID:175,standardFunc:C,time:8,sight:5,url:m.asian_charriot,icons:e,cost:[0,200,150,0],attDist:1,spd:85,clss:"chariot",size:1},{radix:1,name:"Galleon",attackSound:Cd,attack:35,attDist:12,race:"common",defence:0,health:1200,attackTime:2E3,maxHealth:1200,strID:"galleon",
nu:b.createGalleon,img:m.galleon.idle,invType:1,invMax:24,dieSound:["ship%20sink"],zLevel:0,validator:ke,iconID:32,time:50,boat:!0,attimg:m.cb_metal,attackDeg:20,sight:16,url:m.galleon,icons:[b.move,b.explore,b.unload,b.attack,b.attackGround,b.stop,b.stand,b.stop,b.stand,b.attack,b.steady,b.upgradeShip],cost:[0,1200,800,0],spd:50,nofreeze:1,clss:"galleon",standardFunc:C,size:1,peon:1},{radix:1,name:"Fishing Boat",attackSound:Cd,attack:0,attDist:8,race:"common",defence:0,health:50,boat:!0,nu:b.createFishingBoat,
maxHealth:50,img:m.boat.idle,invType:1,invMax:0,strID:"fishing_boat",dieSound:["ship%20sink"],zLevel:0,validator:ke,iconID:184,nofreeze:1,time:50,sight:16,url:m.boat,icons:[b.move,b.explore,b.stop,b.stand,b.fishing],cost:[0,200,100,0],spd:65,clss:"fishing_boat",size:1},{radix:1,name:"Hulk",attackSound:Cd,attack:18,attDist:10,race:"common",defence:0,health:700,maxHealth:700,strID:"hulk",img:m.hulk.idle,invType:1,attackTime:2E3,boat:!0,nu:b.createHulk,attackDeg:20,invMax:16,dieSound:["ship%20sink"],
zLevel:0,validator:ke,iconID:128,time:30,sight:14,attimg:m.cb_metal,url:m.hulk,icons:[b.move,b.explore,b.unload,b.attack,b.attackGround,b.stop,b.stand,b.stop,b.stand,b.attack,b.steady,b.upgradeShip],cost:[0,500,300,0],spd:65,nofreeze:1,clss:"hulk",standardFunc:C,size:1},{radix:1,name:"Pinque",attackSound:Yc,attack:10,race:"common",attDist:8,defence:0,health:300,boat:!0,maxHealth:300,img:m.xebec.idle,attimg:m.arrow1,arrow:!0,strID:"pinque",invType:1,invMax:8,dieSound:["ship%20sink"],zLevel:0,validator:ke,
iconID:129,time:20,nofreeze:1,sight:12,url:m.xebec,icons:[b.move,b.explore,b.unload,b.attack,b.attackGround,b.stop,b.stand,b.stop,b.stand,b.attack,b.steady,b.upgradeShip],cost:[0,300,200,0],spd:80,clss:"xebec",size:1,standardFunc:C,nu:b.createXebec},{radix:0,name:"Stone Golem",strID:"troll",defence:3,attack:25,health:400,maxHealth:400,img:m.troll.idle,invType:0,invMax:0,dieSound:["golem"],validator:U,iconID:144,race:"common",zLevel:1,nofreeze:1,attackSound:["golem1","golem2"],sight:10,standardFunc:C,
url:m.troll,icons:e,w:1,cost:[120,0,0,0,600],attDist:1,spd:56,clss:"troll",size:1},{radix:0,name:"Bat",strID:"bat",defence:0,attack:3,health:20,maxHealth:20,img:m.bat.move,invType:0,invMax:0,race:"common",bat:1,dieSound:["bat%20die"],validator:Nf,iconID:105,zLevel:2,attackSound:["bat%20attack"],sight:10,standardFunc:C,url:m.bat,icons:e,w:1,cost:[0,0,0,0,25],attDist:1,spd:128,clss:"bat",size:1,z32:1.5},{race:"arab",invType:0,invMax:8,iconID:138,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_peasant,
img:m.arab_peasant.idle,spd:50,validator:U,human:1,icons:[b.move,b.menuBuilds2,b.repair,b.conquest,b.dcm,b.pickUp,b.explore,b.stop,b.stand,b.attack,b.convertJihad,b.bribe,b.sameSpeed,b.restoreSpeed],name:"Peasant",clss:"peon",cost:[0,0,50,0],attDist:1,time:8,nocapture:1,peon:1,sight:5,health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:172,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_footman,img:m.arab_footman.idle,standardFunc:C,spd:50,validator:U,human:1,attDist:1,
icons:e,name:"Footman",clss:"footman",cost:[0,0,50,0],time:12,sight:5,health:50,attack:6,defence:1},{race:"arab",invType:0,invMax:8,iconID:170,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_archer,img:m.arab_archer.idle,spd:50,validator:U,standardFunc:C,human:1,attimg:m.arrow1,arrow:1,icons:e,name:"Archer",clss:"archer",cost:[0,20,40,0],time:12,sight:10,attDist:6,health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:173,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,
url:m.arab_spearman,img:m.arab_spearman.idle,spd:50,validator:U,standardFunc:C,human:1,icons:e,name:"Spearman",clss:"pikeman",attDist:1,cost:[40,0,60,0],time:14,sight:5,health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:174,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,standardFunc:C,url:m.arab_satrap,img:m.arab_satrap.idle,spd:50,validator:U,human:1,icons:e,name:"Satrap",attDist:1,clss:"maceman",cost:[0,0,120,0],time:14,sight:5,health:120,attack:8,defence:0},{race:"arab",invType:0,
invMax:8,iconID:171,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_cavalry,standardFunc:C,img:m.arab_cavalry.idle,spd:85,validator:U,human:1,attDist:1,icons:e,name:"Cavalry",clss:"heavy_cavalry",cost:[60,0,100,0],time:14,sight:5,health:90,attack:10,defence:4},{race:"arab",invType:0,invMax:8,iconID:168,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_horse_archer,img:m.arab_horse_archer.idle,spd:85,validator:U,human:1,standardFunc:C,icons:e,name:"Horse Archer",clss:"horse_archer",
cost:[50,0,100,0],time:14,attimg:m.arrow1,arrow:1,sight:12,attDist:7,health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:179,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_jwarrior,img:m.arab_jwarrior.idle,spd:50,validator:U,human:1,standardFunc:C,icons:e,name:"Jihad warrior",attDist:1,clss:"jihad_warrior",cost:[0,0,100,0],time:8,sight:5,health:75,attack:10,defence:2},{race:"arab",invType:0,invMax:8,iconID:176,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_priest,
img:m.arab_priest.idle,standardFunc:C,spd:50,mana:100,validator:U,human:1,icons:h,name:"Priest",clss:"priest",cost:[150,0,0,0],time:30,sight:21,attDist:18,health:60,attack:20,update:["mana","manaSpeed",1E3],manaMax:100,defence:0,attimg:m.flame_bolt,ball:1,attackOnly:je.magic_creatures.obj},{race:"arab",invType:0,invMax:0,iconID:105,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:0,img:0,testing:1,illegal:1,spd:50,validator:U,human:1,icons:[],name:"Spy",clss:"spy",cost:150,time:30,sight:12,
health:50,attack:20,defence:0},{race:"arab",invType:0,invMax:8,iconID:188,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,attimg:m.flame_bolt,url:m.arab_mage,img:m.arab_mage.idle,spd:50,validator:U,human:1,icons:[b.stop,b.pickUp,b.explore,b.createCarpet,b.createJinn,b.fireRain,b.magicVision,b.raiseDead,b.attack,b.stand,b.move],standardFunc:C,name:"Mage",clss:"mage",ball:1,mana:100,manaMax:100,update:["mana","manaSpeed",1E3],cost:[150,0,0,0],time:30,sight:15,attDist:10,health:60,attack:8,defence:0},
{race:"arab",invType:1,invMax:8,iconID:126,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_caravan,img:m.arab_caravan.idle,spd:75,validator:U,human:1,icons:[],name:"Caravan",clss:"trader",cost:[0,0,500,0],time:30,sight:5,health:150},{race:"arab",invType:0,invMax:8,iconID:177,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_enichar,img:m.arab_enichar.idle,spd:85,validator:U,human:1,standardFunc:C,icons:e,name:"Enichar",attDist:1,clss:"enichar",cost:[80,0,120,0],time:25,sight:5,
health:130,attack:18,defence:4},{race:"arab",invType:1,invMax:0,iconID:82,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,population:10,url:m.arab_houses,validator:O,build:1,icons:[],child:[{img:m.arab_houses_c}],name:"House",clss:"house",cost:[0,75,0,0],time:20,sight:4,resistance:50,health:500},{race:"arab",invType:1,invMax:0,iconID:85,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:m.arab_lumbermill,
validator:O,build:1,icons:[b.techWoodCutting,b.techCrossbow],child:[{img:m.arab_lumbermill_c}],name:"Lumber Mill",clss:"lumber",cost:[0,100,0,0],storage:1,time:30,sight:4,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:96,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_storage,validator:O,build:1,storage:0,icons:[b.techGoldMining,b.techStoneMining],child:[{img:m.arab_storage_c},{alpha:!0,img:m.arab_storage_s,
rgb:[0,0,0,.5]}],name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:80,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_farm,validator:O,build:1,icons:[b.createCow,b.techCropRotation,b.techDomestication,b.techCowPoaching,b.ridingHorses,b.techHorseManShip],child:[{img:m.arab_farm_c}],name:"Farm",storage:2,clss:"farm",cost:[0,200,0,0],time:30,sight:5,
resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:81,zLevel:1,dieSound:N,validator:Mf,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:m.build_harbor,dimg:m.des_harbor,radix:0,url:m.arab_harbour,build:1,icons:[b.createFishingBoat,b.createXebec,b.createHulk,b.techLandingTactics],child:[{img:m.arab_harbour_c},{alpha:!0,img:m.arab_harbour_s,rgb:[0,0,0,.5]}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,
iconID:79,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:m.arab_blacksmith,validator:O,build:1,icons:[b.techTemperIron,b.techScaleArmor,b.techScimitar,b.techChainMail,b.techHalberd],child:[{img:m.arab_blacksmith_c},{alpha:!0,img:m.arab_blacksmith_s,rgb:[0,0,0,.5]}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,150,0],onbuild:p,time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:95,zLevel:1,dieSound:N,space:new Uint8Array([1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_workshop,validator:O,build:1,icons:[b.createCatapult,b.createBallist,b.techEngineering,b.techCannonTower],child:[{img:m.arab_workshop_c},{alpha:!0,img:m.arab_workshop_s,rgb:[0,0,0,.5]}],name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:140,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,dimg:m.des_3x3,
radix:0,url:m.arab_church,validator:O,build:1,icons:[b.createPriest2],child:[{img:m.arab_church_c},{alpha:!0,img:m.arab_church_s,rgb:[0,0,0,.5]}],name:"Church",clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"arab",invType:1,invMax:0,iconID:92,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_tavern,validator:O,build:1,icons:[b.createMercenaries,b.createHeroes],child:[{img:m.arab_tavern_c}],
name:"Tavern",clss:"tavern",cost:[0,200,200,0],onbuild:k,actvintv:[b.iniMercenaries,b.iniHeroes],time:40,sight:5,resistance:150,health:1E3},{race:"arab",invType:1,invMax:0,iconID:87,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_market,validator:O,build:1,icons:[b.createCaravan2],child:[{img:m.arab_market_c}],name:"Market",clss:"market",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,
invMax:0,iconID:98,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.arab_barracks,validator:O,build:1,icons:[b.createFootman2,b.createArcher2,b.createSatrap,b.createPikeman2,b.createHorseArcher2,b.createCavalry,b.createEnichar,b.createJihad],child:[{img:m.arab_barracks_c},{alpha:!0,img:m.arab_barracks_s,rgb:[0,0,0,.5]}],name:"Barracks",clss:"barrack",cost:[0,0,200,200],time:60,sight:6,resistance:500,health:1400},
{race:"arab",invType:1,invMax:0,iconID:91,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_stables,validator:O,build:1,icons:[],child:[{img:m.arab_stables_c}],name:"Stable",clss:"stable",cost:[0,200,200,0],time:40,onbuild:g,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:50,iconID:89,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_outpost,
validator:O,build:1,icons:[b.emergeAllUnits],child:[{img:m.arab_outpost_c,mv:1},{alpha:!0,img:m.arab_outpost_s,rgb:[0,0,0,.5]}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},{race:"arab",invType:1,invMax:0,iconID:105,zLevel:1,dieSound:N,bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:0,img:0,validator:O,build:1,icons:[],child:[{img:3213123}],name:"NULL",testing:1,clss:"castle",cost:[0,1500,0,1500],time:120,sight:12,resistance:1E3,health:8E3},{race:"arab",invType:1,
invMax:0,iconID:88,zLevel:1,dieSound:N,space:new Uint8Array([0,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,0,6]),bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.arab_mosque,validator:O,build:1,icons:[b.techFanaticism,b.techEspionage,b.techHealing,b.techBless,b.techJihad],child:[{img:m.arab_mosque_c},{alpha:!0,img:m.arab_mosque_s,rgb:[0,0,0,.5]}],name:"Mosque",onbuild:[b.buildChurch2],clss:"mosque",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,
invMax:0,iconID:86,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_magetower,validator:O,build:1,icons:[b.createMage2,b.techCarpet,b.techMagicWorkshop,b.techFireRain,b.techMagicVision,b.techNecromancy,b.techJinn],child:[{img:m.arab_magetower_c},{alpha:!0,img:m.arab_magetower_s,rgb:[0,0,0,.5]}],name:"Mage Guild",clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,
iconID:93,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,5]),bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.arab_tc_guild,validator:O,build:1,icons:[b.techUsury,b.techTradeRoutes,b.techSupplyStorage,b.techBribery,b.techOreFloatation],child:[{img:m.arab_tcguild_c},{alpha:!0,img:m.arab_tc_guild_s,rgb:[0,0,0,.5]}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,0,2E3],time:90,onbuild:[b.buildMarket2],sight:8,resistance:700,health:5E3},{race:"arab",invType:1,
invMax:0,iconID:94,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.arab_waracademy,validator:O,build:1,icons:[b.techHeroism,b.techWarfare,b.techMercenaries,b.techRiddingHorses,b.techBodyBuilding,b.techLeadership,b.techHeroes,b.techJanissary,b.techHonor,b.techFame],child:[{img:m.arab_waracademy_c},{alpha:!0,img:m.arab_waracademy_s,rgb:[0,0,0,.5]}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,
sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:158,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:m.arab_magicworkshop,validator:O,build:1,icons:[b.createObjects],child:[{img:m.arab_magicworkshop_c},{alpha:!0,img:m.arab_magicworkshop_s,rgb:[0,0,0,.5]}],name:"Magic Workshop",disallowPoint:!0,clss:"magicworkshop",cost:[0,0,0,300],time:20,sight:5,resistance:200,health:1200},{race:"asia",invType:1,invMax:0,iconID:161,
zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,0,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:m.asia_houses,validator:O,build:1,icons:[],child:[{img:m.asia_houses_c}],name:"House",clss:"house",cost:[0,75,0,0],population:10,time:20,sight:4,resistance:50,health:500},{race:"asia",invType:1,invMax:0,iconID:149,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,storage:1,url:m.asia_lumbermill,validator:O,build:1,icons:[b.techWoodCutting,
b.techCrossbow],child:[{img:m.asia_lumbermill_c},{img:m.asia_lumbermill_s,rgb:[0,0,0,.5],alpha:!0}],name:"Lumber Mill",clss:"lumber",cost:[0,100,0,0],time:30,sight:4,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:154,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.asia_storage,storage:0,validator:O,build:1,icons:[b.techGoldMining,b.techStoneMining],child:[{img:m.asia_storage_s,rgb:[0,0,0,.5],alpha:!0},{img:m.asia_storage_c}],
name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:147,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,storage:2,url:m.asia_farm,validator:O,build:1,icons:[b.techCropRotation,b.ridingHorses,b.irrigation],child:[{img:m.asia_farm_c}],name:"Farm",clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:148,
zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,1,1,1,1,1,3]),validator:Mf,bimg:m.build_harbor,dimg:m.des_harbor,radix:0,url:m.asia_harbor,build:1,icons:[b.createFishingBoat,b.createXebec,b.createHulk,b.techLandingTactics],child:[{img:m.asia_harbor_c},{img:m.asia_harbor_s,rgb:[0,0,0,.5],alpha:!0}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:145,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,0,0,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.asia_blacksmith,validator:O,build:1,icons:[b.techTemperIron,b.techScaleArmor,b.techArmoredChariot,b.techChainMail],child:[{img:m.asia_blacksmith_c},{img:m.asia_blacksmith_s,rgb:[0,0,0,.5],alpha:!0}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,150,0],time:40,sight:5,onbuild:p,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:157,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),
bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.asia_workshop,validator:O,build:1,icons:[b.createCatapult,b.createBallist,b.techEngineering,b.techCannonTower],child:[{img:m.asia_workshop_c,x:0,y:0},{img:m.asia_workshop_s,rgb:[0,0,0,.5],alpha:!0}],name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:162,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,0,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,1,0,0,1,1,0,5]),bimg:m.build5x5,dimg:m.des_5x5,
radix:0,url:m.asian_monastery,validator:O,build:1,icons:[b.createMonk,b.createPriest1],child:[{img:m.asian_monastery_c},{img:m.asian_monastery_s,rgb:[0,0,0,.5],alpha:!0}],name:"Monastery",clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"asia",invType:1,invMax:0,iconID:155,zLevel:1,dieSound:N,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.asia_tavern,validator:O,build:1,icons:[b.createMercenaries,b.createHeroes],
child:[{img:m.asia_tavern_c},{img:m.asia_tavern_s,rgb:[0,0,0,.5],alpha:!0}],onbuild:k,name:"Tavern",clss:"tavern",actvintv:[b.iniMercenaries,b.iniHeroes],cost:[0,200,200,0],time:40,sight:5,resistance:150,health:1E3},{race:"asia",invType:1,invMax:0,iconID:150,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.asia_market,validator:O,build:1,icons:[],child:[{img:m.asia_market_c}],name:"Market",clss:"market",cost:[0,200,200,0],time:60,
sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:153,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.asia_stables,validator:O,build:1,icons:[],child:[{img:m.asia_stables_c,mv:!0},{img:m.asia_stables_s,rgb:[0,0,0,.5],alpha:!0}],name:"Stable",clss:"stable",onbuild:g,cost:[0,200,200,0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:151,zLevel:1,dieSound:N,space:new Uint8Array([1,
1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:m.asia_outpost,validator:O,build:1,icons:[b.emergeAllUnits],child:[{img:m.asia_outpost_c,mv:1},{img:m.asia_outpost_s,rgb:[0,0,0,.5],alpha:!0}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},{race:"asia",invType:1,invMax:0,iconID:163,zLevel:1,dieSound:N,space:new Uint8Array([0,0,1,1,0,0,0,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,0,6]),bimg:m.build6x6,dimg:m.des_6x6,radix:0,url:m.asia_shao_lin,
validator:O,build:1,icons:[b.techMeditation,b.techKungFu,b.techHealing,b.techPhilosophy,b.techNinjas,b.techMastery,b.techTournaments,b.techMedicine],child:[{img:m.asia_shao_lin_c},{img:m.asia_shao_lin_s,rgb:[0,0,0,.5],alpha:!0}],name:"Shao Linn",onbuild:[b.buildChurch1],clss:"shaolinn",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:152,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:m.build5x5,
dimg:m.des_5x5,radix:0,url:m.asia_wizardguild,validator:O,build:1,icons:[b.createMage1,b.techConcentration,b.techWhirlpool,b.techFlameBolt,b.techTurnToStone,b.techConfusion,b.techDragon],child:[{img:m.asia_wizardguild_c},{img:m.asia_wizardguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Mage Guild",clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:159,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,
1,0,5]),bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.asia_tcguild,validator:O,build:1,icons:[b.techTradeRoutes,b.techUsury,b.techJewelry,b.techSupplyStorage,b.techBanking,b.techChemistry,b.techSeaFood,b.techGunPowder,b.techRocketArrow],child:[{img:m.asia_tcguild_c,mv:!0},{img:m.asia_tcguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,0,2E3],time:90,onbuild:[b.buildMarket1],sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:156,zLevel:1,dieSound:N,
space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.asia_warguild,validator:O,build:1,icons:[b.techBushido,b.techHeroism,b.techWarfare,b.techMercenaries,b.techLeadership,b.techTactics,b.techHeroes,b.techHonor,b.techSunTzu],child:[{img:m.asia_warguild_c,mv:!0},{img:m.asia_warguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:0,invMax:0,
iconID:166,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.asian_priest,img:m.asian_priest.idle,spd:50,validator:U,human:1,icons:[b.attack,b.stop,b.stand,b.pickUp,b.explore,b.healing,b.teach,b.move],name:"Priest",clss:"priest",cost:[170,0,0,0],time:30,sight:21,health:120,standardFunc:C,attDist:1,attack:10,defence:10,mana:100,update:["mana","manaSpeed",1E3],manaMax:100},{race:"asia",invType:0,invMax:0,iconID:187,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.asian_monk,img:m.asian_monk.idle,
spd:50,validator:U,human:1,icons:e,name:"Monk",standardFunc:C,clss:"monk",cost:[0,0,200,0],time:20,sight:5,health:90,attack:6,defence:6,attDist:1},{race:"asia",invType:0,invMax:0,iconID:134,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.asian_mage,img:m.asian_mage.idle,spd:50,attimg:m.flame_bolt,validator:U,standardFunc:C,human:1,icons:[b.stop,b.pickUp,b.explore,b.confusion,b.turnToStone,b.whirlpool,b.flameBolt,b.createDragon,b.attack,b.stand,b.move],name:"Mage",clss:"mage",cost:[150,0,
0,0],ball:1,time:30,sight:15,mana:100,attDist:10,health:60,attack:8,defence:0,update:["mana","manaSpeed",1E3],manaMax:100},{radix:0,name:"Dragon",strID:"dragon",defence:0,attack:25,health:300,maxHealth:300,img:m.dragon.idle,invType:0,invMax:0,dieSound:[],sSizex:2,sSizey:2,dragon:1,iconID:160,race:"common",zLevel:2,nofreeze:1,attackSound:[],sight:12,standardFunc:C,url:m.dragon,icons:e,cost:[80,0,0,0,800],attDist:2,spd:128,clss:"drg",size:1,z32:1.5,validator:Nf},{radix:0,name:"Carpet",strID:"carpet",
defence:0,attack:0,health:90,maxHealth:90,img:m.carpet.idle,invType:1,invMax:8,dieSound:[],iconID:131,race:"common",zLevel:2,nofreeze:1,attackSound:[],sight:8,url:m.carpet,icons:[b.move,b.unload,b.explore,b.stop,b.stand],cost:[80,0,0,0,500],attDist:2,spd:120,clss:"carpet",size:1,z32:1.5,validator:Nf},{radix:0,name:"Jinn",strID:"jinn",defence:5,attack:20,health:300,maxHealth:300,img:m.arab_jinn.idle,invType:0,invMax:0,dieSound:[],validator:U,iconID:182,race:"common",zLevel:1,nofreeze:1,attackSound:[],
sight:8,standardFunc:C,url:m.arab_jinn,icons:e,w:1,cost:[80,0,0,0,300],attDist:1,spd:85,clss:"jinn",size:1}];G(z[105].space);Fd={};Nh={arr:[]};qa={euro:[],asia:[],arab:[],common:[]};Hk=[];bb=[[],[],[],[],[],[]];q=0;for(k=z.length;q<k;q++){f=z[q];z[q].type=q;var n=f.space;f.name.split(" ").join("");f.population&&Hk.put(f);Fd[q]={};void 0!==f.storage&&(-1<f.storage?(0===f.storage&&bb[3].put(q),bb[f.storage].put(q)):(bb[0].put(q),bb[1].put(q),bb[2].put(q),bb[3].put(q)));jb[f.race][f.name.toLowerCase().split(" ").join("")]=
f;f.icons.menuName=f.strID;Nh[f.name]=q;Nh.arr.put(q);f.img||(f.img=f.url);f.maxHealth=f.health;f.race&&qa[f.race].put(f);g=0;d=f.icons;for(h=d.length;g<h;g++)(p=d[g])&&p.obj&&(p.orderOrigin=f);if(n){g=[];f.free=g;f=n[n.length-1];c=(n.length-1)/f;var w=f+2;h=c+2;d=new Uint8Array(w*h);for(p=0;p<c;p++)for(var y=0;y<f;y++)d[(p+1)*w+y+1]=n[y+p*f];p=0;for(h*=w;p<h;p++)!d[p]&&(d[p+1]||d[p-1]||d[p+1+w]||d[p+1-w]||d[p-1+w]||d[p-1-w]||d[p+w]||d[p-w])&&(g.put(p%w-1),g.put(~~(p/w)-1))}}qa.euro=qa.euro.concat(qa.common);
qa.asia=qa.asia.concat(qa.common);qa.arab=qa.arab.concat(qa.common);qa[0]=qa.euro;qa[1]=qa.arab;qa[2]=qa.asian;h=jb.euro;d=jb.asia;p=jb.arab;k=jb.common;jb[0]=jb.euro;jb[1]=jb.arab;jb[2]=jb.asia;ie||(e.cut=I({a:"attack",g:"guard",r:"patrol",p:"pickUp",e:"explore",s:"stop",n:"stand"}),h.tavern.icons.cut=I({t:"trade1",g:"gamble",m:"createMercenaries",h:"createHeroes",l:"loan"}),h.castle.icons.cut=I({p:"createPeon",s:"createSpy",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning"}),
d.castle.icons.cut=I({p:"createPeon1",n:"createNina",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning",b:"techBudhism",w:"techGreatwall"}),p.castle.icons.cut=I({p:"createPeon2",s:"createSpy",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning",y:"techSlavery"}),h.barracks.icons.cut=I({f:"createFootman",a:"createArcher",m:"createMaceman",p:"createPikeman",l:"createLongbowman",k:"createKnight"}),d.barracks.icons.cut=I({r:"createRonin",a:"createArcher1",
s:"createSamurai",h:"createHorseArcher1",o:"createHorseSamurai",c:"createChariot"}),p.barracks.icons.cut=I({f:"createFootman2",a:"createArcher2",s:"createSatrap",p:"createPikeman2",h:"createHorseArcher2",c:"createCavalry",j:"createEnichar",d:"createJihad"}),h.magetower.icons.cut=I({m:"createMage"}),d.mageguild.icons.cut=I({m:"createMage1"}),p.mageguild.icons.cut=I({m:"createMage2"}),h.peasant.icons.cut=I({b:"menuBuilds",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",
i:"bribe"}),p.peasant.icons.cut=I({b:"menuBuilds2",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",j:"become_jihadw",i:"bribe"}),d.peasant.icons.cut=I({b:"menuBuilds1",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",t:"trade"}),h.priest.icons.cut=I({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",b:"bless"}),p.priest.icons.cut=I({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",b:"bless"}),d.priest.icons.cut=
I({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",r:"raiseexp"}),h.wizard.icons.cut=I({m:"move",a:"attack",s:"stop",n:"stand",l:"lightning",b:"createBat",f:"freeze",t:"createGolem",i:"invisibility"}),p.mage.icons.cut=I({m:"move",a:"attack",s:"stop",n:"stand",c:"spell_spawncarpet",j:"spell_spawnjin",r:"spell_firerain",v:"spell_magicvision",d:"raisedead"}),d.mage.icons.cut=I({m:"move",a:"attack",s:"stop",n:"stand",h:"spell_hypnotize",t:"spell_turntostone",w:"spell_whirlpool",f:"spell_flamebolt",
d:"spell_spawndragon"}),k.spy.icons.cut=I({a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",n:"stand",s:"stop"}),d.monk.icons.cut=I({a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",s:"stop",n:"stand"}),d.ninja.icons.cut=I({a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",s:"stop",n:"stand",c:"cloak",u:"murder"}),k.catapult.icons.cut=I({a:"attack",g:"guard",p:"patrol",e:"explore",s:"stop",n:"stand",r:"attack_ground",h:"hold_steady"}),h.market.icons.cut=I({c:"createCaravan"}),
p.market.icons.cut=I({c:"createCaravan2"}),d.market.icons.cut=I({b:"market_items",s:"market_sell"}),h.workshop.icons.cut=I({c:"createCatapult",h:"createHeavyCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),p.workshop.icons.cut=I({c:"createCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),d.workshop.icons.cut=I({c:"createCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),h.church.icons.cut=I({p:"createPriest"}),p.church.icons.cut=I({p:"createPriest2"}),
d.monastery.icons.cut=I({m:"createMonk",p:"createPriest1"}),p.magicworkshop.icons.cut=I({i:"build_item"}),g=I({c:"buildCastle",s:"buildStorage",b:"buildBarrack",k:"buildBlacksmith",f:"buildFarm",l:"buildLumbermill",p:"buildWorkshop",e:"buildCathedral",u:"buildChurch",n:"buildTavern",m:"buildMageTower",a:"buildStable",r:"buildHarbor",o:"buildOutpost",i:"buildFields",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse",g:"buildGateWood",y:"buildDummy"}),q=I({c:"buildCastle2",k:"buildBlacksmith2",
f:"buildFarm2",n:"buildTavern2",b:"buildBarrack2",p:"buildWorkshop2",s:"buildStorage2",a:"buildStable2",l:"buildLumbermill2",r:"buildHarbor2",o:"buildOutpost2",u:"buildChurch2",e:"buildMosque",i:"buildFields",m:"buildMageTower2",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse2",g:"buildGateWood"}),f=I({c:"buildCastle1",f:"buildFarm1",e:"buildShaolinn",n:"buildTavern1",b:"buildBarrack1",p:"buildWorkshop1",s:"buildStorage1",k:"buildBlacksmith1",a:"buildStable1",l:"buildLumbermill1",r:"buildHarbor1",
o:"buildOutpost1",u:"buildChurch1",i:"buildFields",m:"buildMageTower1",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse1",g:"buildGateWood"}),Of.cut=f,Pf.cut=f,Qf.cut=g,Rf.cut=g,Sf.cut=g,Tf.cut=f,Uf.cut=g,Vf.cut=f,Wf.cut=q,Xf.cut=q,Yf.cut=q,Zf.cut=q,h.lumbermill.icons.cut=I({b:"techLongbow",w:"techWoodCutting",c:"techCrossbow"}),p.lumbermill.icons.cut=I({w:"techWoodCutting",c:"techCrossbow"}),d.lumbermill.icons.cut=I({w:"techWoodCutting",c:"techCrossbow"}),h.blacksmith.icons.cut=I({p:"techPlateArmor",
t:"techTemperIron",s:"techScaleArmor",h:"techHalberd",c:"techChainMail"}),p.blacksmith.icons.cut=I({t:"techTemperIron",a:"techScaleArmor",s:"techScimitar",c:"techChainMail",h:"techHalberd"}),d.blacksmith.icons.cut=I({t:"techTemperIron",a:"techScaleArmor",r:"techArmoredChariot",c:"techChainMail"}),h.outpost.icons.cut=I({e:"emergeAllUnits"}),p.outpost.icons.cut=I({e:"emergeAllUnits"}),d.outpost.icons.cut=I({e:"emergeAllUnits"}),k.watchtower.icons.cut=I({a:"attack",s:"stop",g:"upgradeGuildTower"}),k.guardtower.icons.cut=
I({a:"attack",s:"stop",g:"upgradeStoneTower",c:"upgradeCannonTower"}),k.keeptower.icons.cut=I({a:"attack",s:"stop",c:"upgradeCannonTower"}),k.cannontower.icons.cut=I({a:"attack",r:"attack_ground",s:"stop",h:"holdfire"}),d.rockettower.icons.cut=I({a:"attack",r:"attack_ground",s:"stop",f:"fireatwill"}),h.harbor.icons.cut=I({f:"createFishingBoat",x:"createXebec",h:"createHulk",g:"createGalleon",t:"te_landingtactics"}),p.harbor.icons.cut=I({f:"createFishingBoat",h:"createHulk",x:"createXebec",t:"te_landingtactics"}),
d.harbor.icons.cut=I({f:"createFishingBoat",h:"createHulk",x:"createXebec"}),h.farm.icons.cut=I({c:"createCow",f:"techCropRotation",d:"techDomestication"}),p.farm.icons.cut=I({c:"createCow",f:"techDomestication",d:"techDomestication",p:"techCowPoaching",r:"ridingHorses",h:"techHorseManShip"}),d.farm.icons.cut=I({f:"techDomestication",a:"ridingHorses",i:"irrigation"}),h.storage.icons.cut=I({g:"techGoldMining",s:"techStoneMining"}),p.storage.icons.cut=I({g:"techGoldMining",s:"techStoneMining"}),d.storage.icons.cut=
I({g:"techGoldMining",s:"techStoneMining"}),h.cathedral.icons.cut=I({c:"createCrusaders"}),k.magicgateway.icons.cut=I({o:"createOrk",d:"createDwarf",g:"createGhost",s:"createSkeleton"}));g=[h.knight,d.horsesamurai,p.cavalry,p.enichar,h.crusader,d.chariot,d.horsearcher,p.horsearcher];q=[d.horsesamurai,h.crusader,p.enichar];f=[h.knight,p.cavalry,d.chariot,d.horsearcher,p.horsearcher];e=[h.longbowman,p.archer,d.archer,h.archer];n=[k.catapult,k.ballista,k.heavycatapult];c=[k.galleon,k.hulk,k.pinque,k.fishingboat];
w=[k.galleon,k.hulk,k.pinque];y=[p.satrap,h.maceman];var A=[h.longbowman,p.archer,d.archer,h.archer,d.horsearcher,p.horsearcher,k.pinque,k.watchtower,k.keeptower,k.guardtower],E=[k.stonegolem,k.ork,k.dwarf,k.skeleton,k.ghost,k.dragon,k.jinn,k.bat,h.wizard,p.mage,d.mage],H=[h.peasant,d.peasant,p.peasant,h.footman,p.footman,d.ronin,h.pikeman,p.spearman,p.satrap,h.maceman,p.cavalry,p.jihadwarrior,k.spy,p.enichar,d.horsesamurai,d.monk,d.chariot,d.ninja,k.stonegolem,k.ork,k.dwarf,k.jinn,k.skeleton,k.ghost,
h.knight,h.crusader],J=[k.watchtower,k.keeptower,k.guardtower,k.cannontower],L=[k.cannontower,d.rockettower],M=[h.cathedral,h.castle,k.woodenwall,h.barracks,h.lumbermill,h.magetower,h.warriorsguild,h.storage,h.farm,h.merchantsguild,h.church,h.blacksmith,h.stable,h.workshop,h.tavern,h.house,k.watchtower,h.market,h.outpost,k.bridge,h.harbor,k.guardtower,k.keeptower,k.cannontower,d.rockettower,d.castle,p.castle,d.barracks,p.house,p.lumbermill,p.storage,p.farm,p.harbor,p.blacksmith,p.workshop,p.church,
p.tavern,p.market,p.barracks,p.stable,p.outpost,p.mosque,p.mageguild,p.merchantsguild,p.warriorsguild,p.magicworkshop,d.house,d.lumbermill,d.storage,d.farm,d.harbor,d.blacksmith,d.workshop,d.monastery,d.tavern,d.market,d.stable,d.outpost,d.shaolinn,d.mageguild,d.merchantsguild,d.warriorsguild],S=[h.cathedral,h.castle,k.woodenwall,h.barracks,h.lumbermill,h.magetower,h.warriorsguild,h.storage,h.farm,h.merchantsguild,h.church,h.blacksmith,h.stable,h.workshop,h.tavern,h.house,k.watchtower,h.market,h.outpost,
k.bridge,h.harbor,d.castle,p.castle,d.barracks,p.house,p.lumbermill,p.storage,p.farm,p.harbor,p.blacksmith,p.workshop,p.church,p.tavern,p.market,p.barracks,p.stable,p.outpost,p.mosque,p.mageguild,p.merchantsguild,p.warriorsguild,p.magicworkshop,d.house,d.lumbermill,d.storage,d.farm,d.harbor,d.blacksmith,d.workshop,d.monastery,d.tavern,d.market,d.stable,d.outpost,d.shaolinn,d.mageguild,d.merchantsguild,d.warriorsguild],P=[k.catapult,k.heavycatapult],X=[h.pikeman,p.spearman],Z=[d.monk,d.priest],Y=[k.woodenwall],
aa=[h.peasant,d.peasant,p.peasant],ba=[h.wizard,p.mage,d.mage],da=[h.footman,p.footman,d.ronin],fa=[h.priest,p.priest,d.priest];lc={bless:{img:m.bless,d:0,mv:1},star:{img:m.star,d:0,mv:1},heal:{img:m.healing,d:0,mv:1},impersonate:{img:m.impersonate,d:0,mv:1},select:{img:m.select,d:0,mv:0,select:1,z32:.8},spawn:{img:m.spawn,d:0,mv:1},curse:{img:m.curse,d:0,mv:1},turnStone:{img:m.turn_to_stone,d:0,mv:1}};var Q=function(c,b,d){for(var f=c.length,e=0,g=b.length;e<g;e++)for(var h=0;h<f;h++)Fd[c[h].type][b[e].type]=
d};Q(L,w,4);Q(w,w,3);Q(w,S,3);Q(w,J,3);Q(w,Y,5);Q(w,n,2);Q(P,S,4);Q(P,c,4);Q(P,J,6);Q(P,n,4);Q(P,Y,9);Q([d.samurai],q,.5);Q([d.samurai],f,.3);Q([d.ronin],aa,1);Q(X,g,6);Q(da,X,1.5);Q(da,e,1.5);Q(da,[p.jihadwarrior],1);Q([p.satrap],aa,2);Q(y,n,1.5);Q(A,[k.dragon],.75);Q(A,[k.bat],1);Q(A,[h.pikeman],-.75);Q(A,y,1);Q(A,[d.chariot],-.3);Q(A,Z,.5);Q(ba,fa,4);Q(fa,ba,3);Q(fa,E,3);Q(H,[k.bat],-.2);Q(H,[k.dragon],-.5);Q([k.stonegolem],M,1);Q([k.dwarf],M,4);Q(E,[d.priest],-.5);f=wa;e=Object.keys(f);for(g=
0;g<z.length;g++)for(n=z[g],q=0;q<e.length;q++)n[e[q]]=f[e[q]];window.Utype={archer:[h.archer,h.longbowman,d.archer,d.horsearcher,p.archer,p.horsearcher],sword:[h.footman,h.maceman,h.knight,h.crusader,h.pikeman,p.jihadwarrior,p.cavalry,p.footman,p.enichar,h.peasant,p.peasant,p.satrap,p.spearman,k.spy,d.chariot,d.monk,d.samurai,d.ronin,d.horsesamurai,d.ninja,d.peasant,k.skeleton,k.ghost,k.ork,k.dwarf],allunits:[h.footman,h.maceman,h.knight,h.crusader,h.pikeman,p.jihadwarrior,p.cavalry,p.footman,p.enichar,
h.peasant,p.peasant,p.satrap,p.spearman,k.spy,d.chariot,d.monk,d.samurai,d.ronin,d.horsesamurai,d.ninja,d.peasant,h.archer,h.longbowman,d.archer,d.horsearcher,p.archer,p.horsearcher,h.wizard,p.mage,d.mage,h.priest,p.priest,d.priest,k.skeleton,k.ghost,k.ork,k.dwarf],allbuildings:[],priest:[h.priest,p.priest,d.priest],catapults:[k.ballista,k.catapult,k.heavycatapult],kungfu:[d.peasant,d.ninja,d.monk,d.priest],peasants:[h.peasant,p.peasant,d.peasant]};D=[{name:["Longbow","Allows the production of longbowmen"],
next:[b.createLongbowman],cost:[400,0,0,0],time:45,type:W},{name:["Gold Mining","Increases gold production"],increase:2,value:"gold",cost:[400,0,0,0],time:20,type:Ja},{name:["Stone Mining","Increases stone production"],increase:2,value:"stone",cost:[400,0,0,0],time:20,type:Ja},{name:["Wood Cutting","Increases wood production"],increase:2,value:"wood",cost:[400,0,0,0],time:20,type:Ja},{name:["Temper Iron","Increases hand-to-hand units' attack power"],increase:2,value:"attack",cost:[400,0,0,0],time:30,
group:Utype.sword,next:[b.techHalberd],type:Ua},{name:["Scale Armor","Increases unit's defense"],increase:1,value:"defence",cost:[400,0,0,0],time:30,group:Utype.allunits,next:[b.techChainMail],type:Ua},{name:["Halberd","Allows the production of spear units"],next:[b.createPikeman,b.createPikeman2],cost:[400,0,0,0],time:30,type:W},{name:["Domestication","Allows the production of cows"],next:[b.createCow],cost:[300,0,0,0],time:20,type:W},{name:["Crop Rotation","Increases the production of fields"],
increase:2,value:"food",cost:[400,0,0,0],time:20,type:Ja,next:[b.irrigation]},{name:["Chain Mail","Increases unit's defense"],increase:2,value:"defence",cost:[400,0,0,0],time:30,group:Utype.allunits,type:Ua},{name:["Plate Armor","Allows the production of knights"],next:[b.createKnight],cost:[400,0,0,0],time:60,type:W},{name:["Crossbow","Increases arrow units' attack power"],increase:2,value:"attack",cost:[400,0,0,0],time:30,group:Utype.archer,type:Ua},{name:["Feudalism","Makes peasants cheaper"],
cost:[300,0,0,0],time:30,decrease:[d.peasant,[0,0,8,0],h.peasant,[0,0,10,0],p.peasant,[0,0,10,0]],type:ah,next:[b.techSlavery]},{name:["Architecture","Peasants build faster, and allows stone wall, gate and towers"],increase:.5,value:"buildSpeed",cost:[300,0,0,0],time:30,type:Ja,next:[b.upgradeStoneTower,b.techGreatWall,b.buildBridge]},{name:["Learning","Allows units to gather experience"],increase:1,value:"experience",cost:[400,0,0,0],time:30,type:Ja,next:[b.buildAcademy,b.buildAcademy1,b.buildAcademy2]},
{name:["Convert Resources",""],cost:[400,0,0,0],time:30},{name:["Map Making","Allows the production of galleons"],cost:[800,0,0,0],time:30,type:W,next:[b.createGalleon]},{name:["Trade Routes","Allows trading"],cost:[400,0,0,0],time:30,type:W,next:[b.techTradeTaxes]},{name:["Trade Taxes","Increases trade profit"],cost:[400,0,0,0],time:30},{name:["Usury","Allows the obtaining of loans in taverns"],cost:[300,0,0,0],time:30,type:Se,next:[b.techBanking]},{name:["Supply Storage","Increases the population limit"],
cost:[500,0,0,0],time:30,increase:50,type:Ja,value:"popLimit",next:[b.techSeaFood]},{name:["Bribery","Allows the bribing of enemy units"],cost:[600,0,0,0],time:60,type:W,next:[b.bribe]},{name:["Heroism","Allows unlimited experience"],cost:[500,0,0,0],time:30,increase:Infinity,value:"maxLevel",type:Ja,next:[b.techLeadership]},{name:["Warfare","Gain experience faster"],cost:[400,0,0,0],time:30,type:Ja,increase:1,value:"experience",next:[b.techTactics]},{name:["Tactics","Gain experience faster"],cost:[800,
0,0,0],time:30,type:W,next:[b.buildDummy,b.techSunTzu]},{name:["Mercenaries","Allows the recruitment of units in taverns"],cost:[600,0,0,0],time:30,type:Se,next:[b.techHeroes,b.createMercenaries],actvintv:[b.iniMercenaries]},{name:["Heroes' Quest","Allows the recruitment of heroes in taverns"],cost:[800,0,0,0],time:30,type:Se,next:[b.techFame,b.createHeroes],actvintv:[b.iniHeroes]},{name:["Fame","Recruit better units from taverns"],cost:[500,0,0,0],time:30,value:"fameTech",increase:1,type:Ja},{name:["Siege Tactics",
"Allows the production of heavy catapults"],cost:[1200,0,0,0],time:60,type:W,next:[b.createHeavyCatapult]},{name:["Body Building","Increases unit's hit points at every new level"],cost:[800,0,0,0],time:60,value:"healthJump",increase:5,type:Ja},{name:["Espionage","Allows the production of a spy"],cost:[400,0,0,0],time:30,type:W,next:[b.createSpy]},{name:["Fanaticism","Increases the building's resistance"],cost:[400,0,0,0],time:30,type:Ua,group:Utype.allbuildings,increase:5,value:"resistance",next:[b.techCrusade,
b.techJihad]},{name:["Crusade","Allows the preaching of a crusade"],cost:[1200,0,0,0],time:180,type:W,next:[b.createCrusaders]},{name:["Inquisition","Increases priest attack"],cost:[400,0,0,0],time:30,type:Ua,group:Utype.priest,increase:5,value:"attack"},{name:["Healing","Allows healing of units"],cost:[400,0,0,0],time:30,next:[b.techMedicine,b.healing],type:W},{name:["Medicine","Allows remote healing of units"],cost:[500,0,0,0],time:30,value:"healingRange",increase:5,type:Ja},{name:["Bless","Temporarily increases unit attack skill"],
cost:[400,0,0,0],time:30,type:W,next:[b.bless]},{name:["Invisibility","Invisibility spell"],cost:[500,0,0,0],time:30,type:W,next:[b.invisibility]},{name:["Bat","Researches bat summoning"],cost:[400,0,0,0],time:240,type:W,next:[b.createBat]},{name:["Freeze","Freeze spell"],cost:[800,0,0,0],time:30,type:W,next:[b.freeze]},{name:["Lightning","Lightning spell"],cost:[400,0,0,0],time:30,type:W,next:[b.lightning]},{name:["Stone Golem","Researches stone golem summoning"],cost:[800,0,0,0],time:120,type:W,
next:[b.createGolem]},{name:"Upgrade to Guard Tower",cost:[0,600,0,0],time:20,type:Re,obj:44,upgrade:1},{name:"Upgrade to Stone Tower",cost:[0,0,0,500],time:30,type:Re,obj:55,upgrade:1},{name:"Upgrade to Cannon Tower",cost:[0,0,0,500],time:30,type:Re,obj:56,upgrade:1},{name:["Buddhism"],cost:[400,0,0,0],time:30,type:W,next:[b.buildCathedral1]},{name:["Cannon Tower","Allows the building of cannon towers"],next:[b.upgradeCannonTower],cost:[400,0,0,0],time:30,type:W},{name:["Engineering","Increases siege weapon's attack"],
increase:5,value:"attack",cost:[400,0,0,0],time:30,group:Utype.catapults,type:Ua},{name:["Great Wall","Makes stone walls, towers and gates stronger"],cost:[600,0,0,0],time:30,type:W},{name:["Art of Riding","Allows the production of horse archers"],cost:[500,0,0,0],time:30,type:W,next:[b.createHorseArcher1,b.createHorseArcher2,b.techHorseManShip]},{name:["Irrigation","Increases field production"],increase:4,value:"food",cost:[400,0,0,0],time:30,type:Ja},{name:["Armored Chariot","Allows the production of armored chariots"],
cost:[500,0,0,0],time:60,type:W,next:[b.createChariot]},{name:["Meditation","Makes monks cheaper"],cost:[300,0,0,0],time:30,decrease:[0,0,50,0],type:$g,next:[b.techPhilosophy],group:[d.monk]},{name:["Kung-Fu","Increases the attack of all kung-fu units"],cost:[400,0,0,0],time:30,type:Ua,increase:1,value:"attack",group:Utype.kungfu,next:[b.techMastery,b.techNinjas,b.techTournaments]},{name:["Tournaments","Allows sharing of experience between kung-fu units"],cost:[800,0,0,0],time:30,type:W,next:[]},
{name:["Philosophy","Allows the production of more experienced monks"],cost:[400,0,0,0],time:30,type:Ua,increase:2,value:"level",group:[d.monk,d.priest],next:[b.createPriest1]},{name:["Ninjas","Allows the production of ninjas"],cost:[500,0,0,0],time:30,type:W,next:[b.createNinja]},{name:["Mastery","Allows priests to teach kung-fu units"],cost:[500,0,0,0],time:30,type:W,next:[b.teach]},{name:["Concentration","Allows faster manna restoration"],cost:[600,0,0,0],time:80,type:W,next:[b.techConfusion]},
{name:["Confusion","Researches the Confusion spell"],cost:[400,0,0,0],time:30,type:W,next:[b.confusion]},{name:["Whirlpool","Researches the Whirlpool spell"],cost:[300,0,0,0],time:30,type:W,next:[b.whirlpool]},{name:["Dragon","Researches Dragon summoning"],cost:[800,0,0,0],time:300,type:W,next:[b.createDragon]},{name:["Turn to Stone","Researches the Turn to Stone spell"],cost:[300,0,0,0],time:30,type:W,next:[b.turnToStone]},{name:["Flame Bolt","Researches the Flame Bolt spell"],cost:[400,0,0,0],time:30,
type:W,next:[b.techDragon,b.flameBolt]},{name:["Jewelry","Allows trading of items"],cost:[400,0,0,0],time:30,type:W,next:[b.sellItems,b.buyItems]},{name:["Banking","Increases trade profit"],cost:[600,0,0,0],time:30,type:W},{name:["Chemistry","Increases arrow units' attack power"],cost:[500,0,0,0],time:30,type:Ua,group:Utype.archer,increase:1,value:"attack",next:[b.techGunPowder]},{name:["Sea Food","Increases the population limit"],cost:[500,0,0,0],time:30,increase:50,type:Ja,value:"popLimit"},{name:["Gun Powder",
"Increases cannon tower's attack power"],cost:[500,0,0,0],time:30,type:Ua,increase:10,value:"attack",group:[k.cannontower],next:[b.techRocketArrow]},{name:["Rocket Arrow","Allows the building of rocket tower"],cost:[800,0,0,0],time:30,type:W,next:[b.buildRocketTower]},{name:["Bushido","Allows the production of horse samurai"],cost:[800,0,0,0],time:120,type:W,next:[b.createHorseSamurai]},{name:["Leadership","Units around a hero gain experience"],cost:[600,0,0,0],time:30,type:W,next:[b.techHonor]},
{name:["Honor","Hero vs. hero attack bonus"],cost:[500,0,0,0],time:30,type:W},{name:["Sun Tzu's Book","Increases the speed of learning"],cost:[800,0,0,0],time:30,type:Ja,increase:1,value:"experience"},{name:["Cow Poaching","Allows peasants to steal cows"],cost:[200,0,0,0],time:30,type:Ja,increase:1,value:"stealCows"},{name:["Horsemanship","Makes mounted units cheaper"],cost:[500,0,0,0],time:30,type:$g,mulp:.75,group:[d.horsearcher,p.cavalry,p.horsearcher]},{name:["Scimitar","Increases sword attack power and allows the production of satraps"],
cost:[400,0,0,0],time:30,type:Ua,increase:1,value:"attack",group:Utype.sword,next:[b.createSatrap]},{name:["Jihad","Allows the production of Jihad Warriors"],cost:[1200,0,0,0],time:30,type:W,next:[b.createJihad,b.convertJihad]},{name:["Magic Carpet","Researches Magic Carpet summoning"],cost:[300,0,0,0],time:30,type:W,next:[b.createCarpet,b.techJinn]},{name:["Magic Workshop","Allows the building of a magic workshop"],cost:[1200,0,0,0],time:180,type:W,next:[b.buildMagicWorkshop]},{name:["Rain of Fire",
""],cost:[800,0,0,0],time:60,type:W,next:[b.fireRain]},{name:["Magic Vision","Researches the Magic Vision spell"],cost:[400,0,0,0],time:30,type:W,next:[b.magicVision]},{name:["Necromancy","Researches the Raise the Dead spell"],cost:[400,0,0,0],time:30,type:W,next:[b.raiseDead]},{name:["Jinn","Researches Jinn summoning"],cost:[600,0,0,0],time:300,type:W,next:[b.createJinn]},{name:["Ore Enrichment","Increases mine production"],cost:[800,0,0,0],time:30,type:Ja,increase:1,value:"miningPerf"},{name:["Riding Horses",
"Increases the mounted units' attack and defense power"],cost:[500,0,0,0],time:30,type:mj,values:["attack",2,"defence",1],group:[d.horsearcher,p.cavalry,p.horsearcher],next:[b.techJanissary]},{name:["Janissary","Allows the production of Janissaries"],cost:[1200,0,0,0],time:120,type:W,next:[b.createEnichar]},{name:["Slavery","Makes peasants cheaper"],cost:[200,0,0,0],time:30,decrease:[d.peasant,[0,0,7,0],h.peasant,[0,0,8,0],p.peasant,[0,0,8,0]],type:ah}];Bi();x.IMGdata(m.blank.urlID,m.select.urlID,
m.wood_build.urlID,m.build2x2.urlID,m.build3x3.urlID,m.build4x4.urlID,m.build5x5.urlID,m.build6x6.urlID,m.wood_horz.urlID,m.wood_vert.urlID,m.wood_tower.urlID,m.cursor.urlID,m.fire_rain.urlID,m.expl_small_hole.urlID,m.expl_small_water.urlID,m.gath_point.urlID,m.flame_trail.urlID);b.buildMarket.disabled=1;if(Oh){f=8;c=9;g=0;for(h=ia.xtraRes.length;g<h;g++){l=ia.xtraRes[g].coords;Qm(l);l.terrain_water[f]=512;l.terrain_water[c]=512;l.terrain_water[6]+=32;l.terrain_water[7]+=32;k=4;for(d=l.terrain_tree.length;k<
d;k+=6)l.terrain_tree[k]-=32,l.terrain_tree[k+1]-=96;k=5;for(d=l.terrain_tree_s.length;k<d;k+=6)l.terrain_tree_s[k]-=32;l.terrain_tree[0]=1;l.terrain_tree[1]=0;l.terrain_tree_s[0]=1;l.terrain_tree_s[1]=0}Fk(l,ia.info);g=z[7];g.img=l.terrain_tree;g.dimgInfinity=l.terrain_tree;g.url=l.terrain_tree;g.child[0].img=l.terrain_tree_s;Object.assign(m,l)}l="";Ik();g=0;for(h=D.length;g<h;g++)q=D[g],q.tech=!0,q.id=g;q=0;for(k=z.length;q<k;q++){f=z[q];h=0;e=[];if(f.onbuild){d=f.onbuild;g=0;for(h=d.length;g<h;g++)n=
d[g],e.push(n.id),n.obj.race==f.race&&(n.disabled=1,n.requireObj||(n.requireObj=[]),n.requireObj.put(f)),p=0,p=n.obj.tech?n.obj.id+z.length:n.obj.type,Nc[g]=p;x.Uint16Array(h)}f.space?(d=f.space.slice(0,f.space.length-1).join(","),Sm(f.space),n=x.boolArray(f.space.length-1)):(n=0,d="1");c=0;p=[];if(f.icons){g=0;for(h=f.icons.length;g<h;g++)n=f.icons[g],Nc[c++]=n.id,p.push(n.id);c&&x.Uint16Array(c)}n=0;h=[];if(f.child){for(g=0;g<f.child.length;g++)h.push(f.child[g].img.urlID),Nc[n++]=f.child[g].img.urlID;
x.Uint32Array(n)}g=f.res;n=f.storage;void 0==g&&(g=55);void 0==n&&(n=55);e.length&&(l+="uint NEXTZQ"+q+"[]={"+e.join(",")+"};\n");f.icons&&f.icons.cut&&(g=Tm(f.icons.cut),l+="uint SCUT"+q+"[]={"+g.join(",")+"};\n");p.length&&(l+="uint ORDERZQ"+q+"[]={"+p.join(",")+"};\n");h.length&&(l+="uint CHILDSZQ"+q+"[]={"+h.join(",")+"};\n");l+="bool SPACEZQ"+q+"[]={"+d+"};\n"}l="";g=0;for(h=D.length;g<h;g++){q=D[g];k=0;e=[];if(q.next)for(d=q.next,p=0,k=d.length;p<k;p++)f=d[p],f.disabled?(f.disabled++,f.requireObj.put(q)):
(f.requireObj=[q],f.disabled=1),e.push(f.id);d=g+z.length;e.length&&(l+="u16 NEXTZQ"+d+"[]={"+e.join(",")+"};\n")}g=0;d=z;for(h=d.length;g<h;dm(d[g++]));}if(v.editor){if(V("statButton"),V("menu"),V("resources"),la("mapeditorinfotop"),la("mapeditorinfo"),q=r("mapeditorinfoUnits"),q.style.display="block",$f(),!Ph.preload){Ph.preload=!0;l={};e={};d=z;p={euro:Ra[0],arab:Ra[1],asia:Ra[2],common:t.common};l[Ra[0]]=[];l[Ra[1]]=[];l[Ra[2]]=[];l[t.common]=[];e[Ra[0]]=[];e[Ra[1]]=[];e[Ra[2]]=[];e[t.common]=
[];g=0;for(h=d.length;g<h;g++)f=d[g],!f.race||f.illegal||7==f.type||f.item||(f.build?e[p[f.race]].put(g):l[p[f.race]].put(g));for(p=0;2>p;p++){d=Object.keys(l);n={};g=0;for(h=d.length;g<h;n={ul$17:n.ul$17},g++){c=document.createElement("h1");c.innerHTML=d[g];n.ul$17=document.createElement("ul");c.onclick=function(c){return function(){ng(c.ul$17)}}(n);n.ul$17.style.display="none";w=l[d[g]];y=Object.keys(w);A={};k=0;for(E=y.length;k<E;A={tcreate:A.tcreate},k++)f=document.createElement("li"),f.innerHTML=
z[w[y[k]]].name,A.tcreate=w[y[k]],f.onclick=function(c){return function(){var b=c.tcreate;if(z[b].wall){b=z[b];Ob=!1;var d=ca;ib=b;ka(d,b.img);document.addEventListener("mousemove",Wg);document.addEventListener("mousedown",pushbuildWall)}else R(b)}}(A),n.ul$17.appendChild(f);q.appendChild(c);q.appendChild(n.ul$17)}l=e;q=r("mapeditorinfoBuilds")}d=Object.keys(Ud);q=r("mapeditorinfoItems");var ea=document.createElement("ul");l={};g=0;for(h=d.length;g<h;l={u$18:l.u$18},g++)f=document.createElement("li"),
l.u$18=Ud[d[g]],f.onclick=function(c){return function(){yi(c.u$18)}}(l),f.innerHTML=l.u$18.name,ea.appendChild(f);q.appendChild(ea);q=r("mapeditorinfoNature");c=document.createElement("h1");c.innerHTML=t.trees;ea=document.createElement("ul");c.onclick=function(){ng(ea)};ea.style.display="none";f=document.createElement("li");ea.appendChild(f);q.appendChild(c);q.appendChild(ea);f.onclick=function(){Qh(Um)};f.innerHTML=t.delete;f=document.createElement("li");ea.appendChild(f);f.onclick=function(){Qh(Vm)};
f.innerHTML=t.create;c=document.createElement("h1");c.innerHTML=t.terrain;var ja=document.createElement("ul");c.onclick=function(){ng(ja)};ja.style.display="none";q.appendChild(c);q.appendChild(ja);h=Ad.texturesRandomMap;l={};g=0;for(h=h.length;g<h;l={l:l.l},g++)f=document.createElement("li"),ja.appendChild(f),f.innerHTML=g,l.l=g,f.onclick=function(c){return function(){Qh(Rh);Rh.active=c.l}}(l)}}else la("menu"),la("statButton"),la("resources"),V("mapeditorinfo"),V("mapeditorinfotop");Jk()},z,Fd,Nh,
Fb,Hk,zk,$c=function(b,c,e,d,g,h,k){x.newUnit(b,c,e,d,g,h)},tm=[];new Float32Array(4);new Float32Array(3);var Xd=function(){k.bindBuffer(k.ARRAY_BUFFER,Ch);k.bufferSubData(k.ARRAY_BUFFER,12*qb[4],ag)},Lk=function(){k.bindBuffer(k.ARRAY_BUFFER,Dh);k.bufferSubData(k.ARRAY_BUFFER,16*qb[4],Kk)},Mk=function(){k.bindBuffer(k.ARRAY_BUFFER,Bh);k.bufferSubData(k.ARRAY_BUFFER,12*qb[4],ag)},Bk=function(){k.bindBuffer(k.ARRAY_BUFFER,Eh);k.bufferSubData(k.ARRAY_BUFFER,12*qb[4],ag)},Wb=function(b){if(b.child&&
(!1!==b.built||!b.build)){var c=0;for(b=b.child.length;c<b;c++);}},Sb=function(b,c,e,d){Lk(c,e,d,v.now(),b.bufferID);if(b.tempChild){var f=0;b=b.tempChild;for(var h=b.length;f<h;Sb(b[f++],c,e,d));}},Na=function(b,c,e){void 0==e&&(e=32);b.z32&&(c*=b.z32);Xd(b.x32*e,b.y32*e,c,b.bufferID);if(b.tempChild){c=b.tempChild;e=0;for(var d=c.length;e<d;e++){var f=c[e];f.x32=b.x32;f.y32=b.y32;Na(f,32*b.y32)}}},wa={checkMana:function(b,c,e,d){if(!this.mana)return!1;if(0>this.mana-b)return this.manaTask=[e.url,
c,b],this.stay55(),b>this.manaMax&&d&&(this.blockedCost=d,c=this.setupChild(lc.curse,1),this.blocked=2,this.blockedimg=c,this.manaTarget=b),!1;this.mana-=b;return!0}},Ug=function(b,c){return v.editor?!0:b.freezed||b.confused?!1:J[b.spy||b.kingdom].control[c.spy||c.kingdom]};wa.changeKingdom=function(b){ua[this.kingdom][this.type].quit(this.id);if(Hf[this.id]){Hf[this.id]=0;ba.quit(this.id);0==ba.length&&(id(),Kd=-1);var c=this.id;c=A[c];c.tempChild.quit(c.selectAnim);tb(c.selectAnim.bufferID);c.selectAnim=
void 0}this.kingdom=b;Wb(this);this.childBuild&&(this.childBuild=0);if(!this.build||this.arrow)v.editor||this.stay();ua[b][this.type].put(this.id)};wa.aspettare=function(){this.rbase().write(this.x32+this.y32*H,this.id);this.waiting=!0;ka(this,this.url.idle);Sb(this,0,0,0);Db(this,~~(32E3/this.spd))};wa.addItem=function(b){var c=this.inventory;c&&(c[c.length]=b.id,b.in=this.id,b.sword||b.shield)&&(b.attack&&(this.attack+=b.attack),b.defence&&(this.defence+=b.defence))};wa.showInventory=function(){wh();
for(var b=this.inventory,c=0;8>c;c++){var e=b[c];if(!e)break;var d=Oa[c];d.style.backgroundPosition="0px "+48*e.iconID+"px";d.className=""}};wa.deleteItem=function(b){this.inventory.quit(b.id);this.attack-=b.attack;this.defence-=b.defence};wa.useItem=function(b){48==b.type&&(this.health+=b.lives,this.health>this.maxHealth&&(this.maxHealth=this.health),this.inventory.quit(b.id))};wa.onattack=function(b){!this.attack||this.freezed||this.death||this.item||this.func!=Rc.url&&this.func||kb(b.id,[this.id],
1)};wa.setupINTV=function(b,c,e,d){x.setupINTVadapter(this.id,b.url,c,e)};wa.damage=function(b,c){if(!(this.zolotoy||this.death||this.stoned)){this.defence&&(b-=this.defence);1>b&&(b=1);this.health-=b;c=J[c.kingdom].stats;c.dmgInflicted+=b;var f=J[this.kingdom].stats;f.dmgTaken+=b;1>this.health?(this.build?(f.buildsLosed++,c.buildsKilled++):(f.unitsLosed++,c.unitsKilled++),this.die()):X(this.id,1)}};var X=function(b,c){if(Hf[b]||!1===b){b=ba.length;if(1===b)if(b=A[ba[0]],ra.stockActive==b&&b.inventory.length){if(ae(b.id,
1,1),b=b.inventory,b.length)for(c=0,b=b.length;c<b;c++);}else b.build?va(b,1):ae(b.id,c);else 1<b?rk(ba,c):qk(db);return!0}};wa.setupSpellIMG=function(b){this.invisible&&bd(this.id);this.url.spell?(ka(this,this.url.spell,1),b||Ha({func:Nk,data:this.id},ta(this.img),1)):this.stay()};var Nk=function(b){b=A[b];b.death||b.stay()};wa.setupChild=function(b,c,e){e={x32:this.x32,y32:this.y32,d:b.d,img:b.img,mv:b.mv,parent:this.id,z32:b.z32};if((this.dix||this.diy)&&!this.waiting){var d=.001*(v.now()-this.timestamp);
e.x32+=this.dix*d/32-Math.sign(this.dix);e.y32+=this.diy*d/32-Math.sign(this.diy)}if(b.select){if(this.space)b=this.space[this.space.length-1],f=(this.space.length-1)/b;else{b=this.sSizex||1;var f=this.sSizey||1}this.z32&&(e.z32=this.z32);e.wh=[32*b-3,32*f-3];this.selectAnim=e}d&&Sb(e,this.dix,this.diy,0);this.tempChild||(this.tempChild=[]);this.tempChild.put(e);c||Vd.new(e,ta(e.img),Ok);return e};var Ok=function(b){A[b.parent].tempChild.quit(b);tb(b.bufferID)};wa.distance=0;var ka=function(b,c,e,
d){b.img=c;sb[c]||G(c);(c=sb[c])||G(b);var f=c[0],h=c[1];0<=h&&(h*=.001);d&&(h*=d);c=c.id+4*b.d*c[2];d=-1;1===e?d=v.now():0>e&&(d=1);Mk(c,d,f,h,b.bufferID)};wa.setupDir=function(b,c,e){b=Math.sign(b);c=Math.sign(c);b=3*(c-1)+(b+1);2==b?this.d=1:-6==b?this.d=5:0==b?this.d=7:-4==b?this.d=3:-1==b?this.d=2:1==b?this.d=0:-5==b?this.d=4:-3==b&&(this.d=6);e&&(this.d=(this.d+e)%8)};wa.setupDirBuild=function(b){var c=H,f=this.x32+this.y32*c;if(1==b.health&&0==b.built)d=Tb[b.kingdom],b=b.id,d[f+c]==b?this.d=
0:d[f-c]==b?this.d=4:d[f+1]==b?this.d=2:d[f-1]==b?this.d=6:d[f+c+1]==b?this.d=1:d[f-c+1]==b?this.d=3:d[f+c-1]==b?this.d=7:d[f-c-1]==b&&(this.d=5);else{b=b.id;var d=Kc;d(f+c)==b?this.d=0:d(f-c)==b?this.d=4:d(f+1)==b?this.d=2:d(f-1)==b?this.d=6:d(f+c+1)==b?this.d=1:d(f-c+1)==b?this.d=3:d(f+c-1)==b?this.d=7:d(f-c-1)==b&&(this.d=5)}};wa.spdMod=0;var eh=function(b,c){for(var f=c.length,d=0;d<f;d++){var g=A[c[d]];g.build||(g.spd=b)}};wa.changeFunc=function(b,c){var f=this.func;this.func=b;if(Sh){if(void 0!==
this.workingOn)var d=A[this.workingOn];(f=Ib[f])&&f.rule&&Og(-1,this,f.rule,d);(b=Ib[b])&&b.rule&&Og(1,this,b.rule,c)}};var Tm=function(f){for(var c=[],e=Object.keys(f),d=0;d<e.length;d++){var g=b[f[e[d]]];g&&c.push(e[d].charCodeAt(0),g.id)}return c};wa.stay=function(b){this.mv=1;this.time=void 0;this.diy=this.dix=0;this.c=void 0;x.unitWorking(this.id,!1);this.xf=null;Sb(this,0,0,0);x.unitMovement(this.id,!1);if(!b){b=this.action==ad.url||this.func==Xe.url;this.changeFunc(void 0);this.stock&&0!==
this.stock[0]?ka(this,this.img,NaN):ka(this,this.__proto__.img,1);this.buildList&&(this.buildList=void 0);this.deleteWorker();if(this.standardFunc&&2!==this.stop&&void 0==this.spy)return this.standardFunc(this);b&&Rc(this)}};wa.stay55=function(){this.changeFunc(void 0);this.stock&&0!==this.stock[0]?ka(this,this.img,NaN):ka(this,this.__proto__.img,1);this.deleteWorker();this.standardFunc&&2!==this.stop&&void 0==this.spy&&this.standardFunc(this)};wa.addWorker=function(b){this.workers.put(b.id);b.workingOn=
this.id};wa.deleteWorker=function(){this.workingOn&&(A[this.workingOn].workers.quit(this.id),this.workingOn=0);this.actionItem&&(this.actionItem=void 0);this.blockedAction()};wa.blockedAction=function(b){var c=this.blocked;if(Pk[c])Pk[c](this,b)};var Pk={2:function(b,c){b.blocked=void 0;Wb(b);Ok(b.blockedimg);b.blockedimg=void 0;b.manaTarget=void 0;c||(J[b.kingdom].setupResources(b.blockedCost,-1),b.blockedCost=void 0)}},Qj=function(b){return m.delay[-b[1]+b[0]-1]},Rd=function(b){var c=ba.length;
ba.quit(b);if(c!=ba.length){var f=A[b];f.selectAnim=void 0;c=0;for(f=f.tempChild;c<f.length;c++){var d=f[c];tb(d.bufferID);var g=f.length;f.quit(d);g!=f.length&&c--}Hf[b]=void 0;0==ba.length?id():1==ba.length?A[b].build?va(A[b],1):ae(b):rk(ba)}db&&db.id===b&&(id(),db.selectAnim&&(tb(db.selectAnim.bufferID),db.selectAnim=void 0),db=void 0)};wa.rbase=function(){return qf[this.zLevel]};var oh;wa.die=function(b){if(!this.death&&!this.magicGateway){var c=H,f=this.id,d=this.kingdom,g=J[d];this.waitlist&&
(g.unitLoading-=.5*this.waitlist.length);if(this.dieSound&&!v.editor){var h=this.dieSound;pa(h[~~(h.length*Math.random())],this.x32,this.y32)}Rd(this.id);(this.freezed||this.invisible)&&Wb(this);var k=this.x32,l=this.y32;this.death=1;1==this.zLevel&&(oh[k+l*c]=1);x.unitWorking(this.id,!1);this.c=void 0;var p=this.url.die||this.dimg;!1===this.built&&g.building.quit(this.id);void 0!=g.IAD&&g.k&&!this.item&&rb.arr[g.IAD].valorateLost(this);if(this.food&&!v.editor){var n=100,r=this.food/n,t=~~r,w=~~((r-
t)*n);for(h=0;h<r;h++){h==t&&w&&(n=w);var y=rj(k,l),z=~~(y/c);y%=c;y=new $c(52,d,y,z,0);ka(y,m.item_meat);y.contain=[n,2,nm]}}g.stats.unitCountDeath[this.type]++;h=this.x32;c=this.y32;b||v.editor?tb(this.bufferID):p?(this.mv=!0,ka(this,p,1),b=sb[this.img],p=b[1],p=0>p?Qj(b):1E3*b[0]/p,Ha({func:Pj,data:this.id},p-25,1),Sb(this,0,0,0),void 0!==this.dix&&(b=.001*(v.now()-this.timestamp),this.x32+=this.dix*b/32-Math.sign(this.dix),this.y32+=this.diy*b/32-Math.sign(this.diy))):this.dimgInfinity?(this.dimgRND&&
(this.d=this.id%this.dimgRND),ka(this,this.dimgInfinity)):tb(this.bufferID);Zg(this);this.techStart&&Yg(0,[this.id]);Na(this,32*this.y32-36);this.x32=h;this.y32=c;this.build||this.item||this.cow||g.values.pop--;this.population&&this.built&&(g.values.popMax-=this.population);l=this.validator(k,l,this.space,this.kingdom);b=l[0];if(this.onbuild&&!v.editor)for(k=this.onbuild,p=g.technology,h=p.disabled,p=p.actived,c=0;c<k.length;c++)d=k[c].id,p[d]--,0===p[d]&&h[d]++;k=this.validator.dimension;c=k.write;
h=0;for(p=b.length;h<p;h++)d=b[h],ob[d]?c(d,ob[d]):c(d,0);if(1==this.health&&!this.built)for(d=Tb[this.kingdom],h=0,p=b.length;h<p;d[b[h++]]=void 0);if(l[2])for(b=l[2],h=0,p=b.length;h<p;h++)d=b[h],ob[d]?(2<k(d)&&A[k(d)].die(1),c(d,ob[d])):(2<k(d)&&A[k(d)].die(),c(d,0));ua[this.kingdom][this.type].quit(this.id);if(this.callList){b=this.x32;p=this.y32;c=this.sight;h=H;d=2*c+1;k=d*d;n=this.id;for(l=0;l<k;l++)r=l%d-c,t=~~(l/d)-c,Math.sqrt(Math.pow(r,2)+Math.pow(t,2))<=c&&(r+=b,t+=p,r+=t*h,uc[r]==n&&
(uc[r]=void 0));b=this.callList;this.callList=void 0;l=0;for(k=b.length;l<k;l+=2)p=A[b[l]],p.x32+p.y32*h==b[l+1]&&p.callList&&C(p,!0);b.length=0}if(this.workers){h=0;k=this.workers.slice(0);for(p=k.length;h<p;h++)l=A[k[h]],l.workingOn===f&&(l.workingOn=0,l.func!==ch.url&&l.stay());this.workers.length=0}this.deleteFromList&&(k=this.deleteFromList,k.quit(this),k.length||k.length0function(this));this.time=void 0;this.changeFunc(void 0);this.diy=this.dix=0;this.inventory&&0<this.inventory.length&&Ue(this.id,
this.inventory.slice(0));this.stock&&pj(this);v.editor||(g.check(),popinfo(this.kingdom),g.checkPopArray());this.deleteWorker()}};Array.prototype.quit=function(b){b=this.indexOf(b);return-1<b?(this.splice(b,1),!0):!1};Array.prototype.add=function(b){0>this.indexOf(b)&&(this[this.length]=b)};var Ra=["European","Arab","Asian"],Ag=[t.gold,t.wood,t.food,t.stone,t.mana],lm={euro:"Lancelot Arthur Guivain Merlin Blackthorn Morin Golstuck Karambol Kelerick Rockmore Bridport Casevil Stirm Tonis Pelegrim Peresohn Pirk Pharn Gork".split(" "),
arab:"Ibn Fadlan;Mohammad;Al Ferissa;Harun Al Rashid;Sindbad;Mellemad;Moarrac;Sakhavan;Bellefars;Mokhac;Norahz;Kerhetin;Maham;Dushesh;Direkh".split(";"),asia:"Ishida Toranaga Ichinzen Haiako Mozuki Hitachi Tosheba Harachiko Marasuma Korodzum Ishinghen Genghis Musa Echibo Ichikahr Yotokan Maraga".split(" "),common:"Fistantilus Skenderbeg Raislin Tenis Morok Sokob Baras Haram Billihz Ynte Orgh Savael Birgos Savator Gandeh Gordor Fessh Gilmi Phergas".split(" ")},rh=function(b,c,e){e&&(b=b.replace("%d",
e));return b.replace("%s",c)},jd={},le,bg,Tc=function(b){v.infinity=void 0;if(""!=r("mapconfiguration").innerHTML){b="mapx mapwidth goldRes goldValue woodRes woodValue foodRes foodValue stoneRes stoneValue infinity infiniteValue water waterValue terrainType terrainSelect items itemsValue peons peonValue gateways gatewaysValue freePop freePopValue".split(" ");for(var c=0,f=b.length;c<f;c+=2){var d=r(b[c+1]).value;"infinity"==b[c]?(d=r(b[c+1]).checked,v[b[c]]=d):parseInt(d)?v[b[c]]=parseInt(d):v[b[c]]=
d;localStorage[b[c]]=d}}else"true"==localStorage.infinity&&(v.infinity=!0),v.goldRes=parseInt(localStorage.goldRes),v.foodRes=parseInt(localStorage.foodRes),v.woodRes=parseInt(localStorage.woodRes),v.stoneRes=parseInt(localStorage.stoneRes),v.mapx=parseInt(localStorage.mapx),v.water=parseInt(localStorage.water),v.terrainType=localStorage.terrainType,v.items=parseInt(localStorage.items),v.peons=parseInt(localStorage.peons),v.gateways=parseInt(localStorage.gateways),v.freePop=parseInt(localStorage.freePop);
v.daylength=2880;v.initialhour=12;v.infinity&&(v.goldRes=Math.pow(2,31)-1,v.foodRes=Math.pow(2,31)-1,v.woodRes=Math.pow(2,31)-1,v.stoneRes=Math.pow(2,31)-1);v.mapy=v.mapx;v.gravity=580.9/9.8*9.8;v.name="";v.arje=~~(555555*Math.random()+1);b=v;b.goldRes=parseInt(b.goldRes);b.foodRes=parseInt(b.foodRes);b.woodRes=parseInt(b.woodRes);b.stoneRes=parseInt(b.stoneRes);b.goldRes||(b.goldRes=Infinity);b.foodRes||(b.foodRes=Infinity);b.woodRes||(b.woodRes=Infinity);b.stoneRes||(b.stoneRes=Infinity);b.mapx=
parseInt(b.mapx);(!b.mapx||32>b.mapx)&&(b.mapx=32);1024<b.mapx&&(b.mapx=1024);b.items=parseInt(b.items)||0;0>b.items&&(b.items=0);b.peons=parseInt(b.peons)||0;0>b.peons&&(b.peons=0);b.gateways=parseInt(b.gateways)||0;0>b.gateways&&(b.gateways=0);b.water=parseInt(b.water)||0;0>b.water&&(b.water=0);b.freePop=parseInt(b.freePop)||0;b.terrainType=Ka(b.terrainType);b.description=Ka(b.description);b.author=Ka(b.author);b.name=Ka(b.name);x.setupGame(v.peons,v.freePop,v.goldRes,v.woodRes,v.foodRes,v.stoneRes,
v.water,v.terrainType,v.items,v.gateways,v.mapx,v.arje);return v},Jk=function(){pc.innerHTML="";r("notifybottom").style.display="none";r("loadingtext").innerHTML=t.loading;y.kingdom||(y.kingdom=1);v.online&&(Wm(t.initializing),v.editor=0);G(x.mapWidth(),"asd");x.mapWidth()?(v.mapx=x.mapWidth(),v.mapy=v.mapx):Tc();v.pausedTime=0;v.canceled=0;bg=performance.now();sc=r("msgs1");v.online||(location.hash="");V("playermenu");V("index");v.cycle?v.deltaTime=25*v.cycle:(v.players=J.length-1,v.date=Date.now(),
v.cycle=0,v.kingdoms=J,v.deltaTime=0);v.loadDate=Date.now();v.online||gk();v.now=Vi;v.paused=0;v.pausedTime=0;v.zMax=96*v.mapy;Rb();performance.now();v.allow14=!0;H=v.mapx;Ba=v.mapy;v.temperature=25;var b=v.temperature;0==y.temperature&&(b+="&deg;C");r("temperature").innerHTML=b;P=1;r("loadingtext").innerHTML="Loading terrain";G("arje",v.arje);x.preldd()?(b=x.trradd(),le=new Int8Array(n.buffer,b,void 0),G(le)):(x.configRandomMap(),b=x.randomTerrain(H,v.water),le=new Int8Array(n.buffer,b,H*Ba));la("content");
r("loadingtext").innerHTML="Loading textures";k.getError()==k.CONTEXT_LOST_WEBGL&&(k=r("tzar").getContext("webgl2",{antialias:!1,alpha:!1}),G("restored"));if(!ie){var c=k.createShader(k.VERTEX_SHADER);k.shaderSource(c,"#version 300 es\nprecision mediump float;\n\nin vec3 a_position;\nin vec3 a_texCoord;\nin vec4 a_physic;\nin vec3 a_margins;\nin uint a_step;\n\nuniform float kingdoms;\nuniform float zoom;\nuniform mediump int miniMap;\nuniform float now;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform sampler2D u_image1;\nuniform sampler2D delay;\nuniform sampler2D colorArray;\n\nuniform float zMax;\nout highp vec2 vTextureCoord;\nout vec4 v_kcolor;\nout float height;\nflat out int rColor;\n\nvec4 superArray(in highp int position) {\n     return(texelFetch(u_image1, ivec2(\t\t(position%512)\t\t,\tposition/512\t), 0));\n}\n\nvoid main() {\n\n\n\n    highp float  x;\n    float t;\n\thighp int pos;\n    int jump=0;\n    pos=int(a_texCoord.x);\n   // pos=260840u/4u;\n\n\n\nvec4 imgInfo=superArray(pos);\n\nint frames=int(imgInfo[0]);\nfloat fps=imgInfo[1];\nfloat dirs=imgInfo[2];\nfloat recolor=imgInfo[3];\n\nrColor=int(recolor);\n\n\nif(fps!=0.0&&miniMap==0){\nif(a_texCoord.y>=0.0){\nt=(now-a_texCoord.y);\nif(fps>0.0){\njump=int(floor(t * fps*0.001));         \n}else{\n\n\nint index=int(-fps);\n\nfloat spt= mod(t,texelFetch(delay, ivec2(frames-1+index, 0), 0).r);\n\nfor(jump=0;jump<frames;jump++)\nif(texelFetch(delay, ivec2(jump+index, 0), 0).r>spt){ \nbreak;\n }\n\n\n\n\n}\n\njump=(jump%frames)*2;\npos=(pos+jump);\n}\n}\n\npos+=1;\n   \n    vec4 coord = superArray(pos);\n    vec2 mxy=coord.xy;\n    vec2 txtcord = coord.zw/512.0;\n\n    \n    vec2 sizes = superArray(pos+1).xy;\n\n    if(a_step==1u||a_step==3u){\n    mxy.x+=sizes.x;\n    txtcord.x+=sizes.x/512.0;\n    }\n\n    if(a_step==2u||a_step==3u){\n    mxy.y+=sizes.y;\n    txtcord.y+=sizes.y/512.0;\n    }\n\n\n\n\theight = sizes.y/512.0;\n\n\tfloat z=a_position.z;\n\n\n    \nif(a_margins.x!=0.0&&(a_step==1u||a_step==3u)){\nmxy.x+=a_margins.x-sizes.x;\n}\n\n\nif(a_margins.y!=0.0&&(a_step==2u||a_step==3u)){\nmxy.y+=a_margins.y-sizes.y;\n}\n\n\n\tif(z<0.0){\n\tz*=-1.0;\nif(miniMap<2) mxy*=0.0;\n\t}\n\n\n\n\n\n\nif(a_margins.z!=0.0){\n\tfloat s = sin(a_margins.z);\n\tfloat c = cos(a_margins.z);\n\tmat2 m = mat2(c, -s, s, c);\n\tmxy.xy*=m;\n}\n\n\n\n    t = (now - a_physic.w) * 0.001;\n    mxy.x+=a_physic.x * t;\n\n\tfloat physicY=a_physic.y * t + a_physic.z * .5 * t * t;\n\n    mxy.y+=physicY;\n\n\nif(miniMap!=0){\n\tz=0.0;\n}else{\n\tz=(1.0 - (physicY+z)/ zMax)*.9;\n}\n\n\n   gl_Position = vec4((((a_position.xy+mxy) + u_translation) / u_resolution * 2.0 - 1.0) * vec2(zoom, -zoom), (z), 1.0);\n   vTextureCoord=txtcord;\n\nvec4 outColor=texelFetch(colorArray, ivec2(a_texCoord.z, 0), 0);\n\nif(a_texCoord.z>=kingdoms) outColor.a+=1.0;\n\n\n   v_kcolor=outColor;\n\n\n}\n");
k.compileShader(c);b=k.createShader(k.FRAGMENT_SHADER);k.shaderSource(b,"#version 300 es\nprecision mediump float;\n\n\n\nuniform sampler2D lightmap;\nuniform vec2 u_resolution;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\nuniform mediump int miniMap;\nin vec4 v_kcolor;\nin highp vec2 vTextureCoord;\nin float height;\nflat in int rColor;\nout vec4 COLOR;\n\nvoid main() {\n\n\nif(miniMap==0){\n\n\n\n\nvec2 txtFinal=vTextureCoord;\n\nif(txtFinal.x>=1.0){\ntxtFinal.y+=height*floor(txtFinal.x);\n}\n\n\nvec4 color=texture(img_common, vec3(txtFinal, int(txtFinal.y)));\n \n\nif(color.a<0.5) discard;\n\n\nif(rColor==1 &&color.r==color.g&&color.r==color.b){\ncolor.rgb*=v_kcolor.rgb;\n}\n\nif(v_kcolor.a>1.0)\n{\ncolor*=v_kcolor-vec4(0.0,0.0,0.0,1.0);\n}\n\n\n\n\nvec4 light=vec4(1.0);\nlight = texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+vec4(1.0,1.0,1.0,0.0)*u_ambient;\n\nCOLOR=color*light;\n}else{\n\nif(v_kcolor.a>1.0)\nCOLOR=v_kcolor-vec4(0.0,0.0,0.0,1.0);\nelse\nCOLOR=v_kcolor;\n}\n\n}");
k.compileShader(b);da=k.createProgram();k.attachShader(da,c);k.attachShader(da,b);k.linkProgram(da);k.useProgram(da);(c=k.getShaderInfoLog(c))&&console.log("Shader compiler log: "+c);(c=k.getShaderInfoLog(b))&&console.log("Shader compiler log: "+c);c=k.createShader(k.VERTEX_SHADER);k.shaderSource(c,"#version 300 es\nprecision mediump float;\n\nin vec3 a_position;\n\n\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform mediump int miniMap;\nuniform float zoom;\n\n\nvoid main() {\n\nfloat depth;\nif(miniMap==1){\ndepth=.03;\n}else{\ndepth=1.0;\n}\n\n   gl_Position = vec4(a_position.x, a_position.y, depth, 1.0);\n   \n\n}");
k.compileShader(c);b=k.createShader(k.FRAGMENT_SHADER);k.shaderSource(b,"#version 300 es\nprecision mediump float;\n\nuniform float u_fps;\nuniform mediump int miniMap;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\nuniform vec2 borderCoords;\nuniform vec2 waterBorder;\nuniform vec2 u_translation;\nuniform vec2 u_resolution;\nuniform vec2 minimapMargin;\nuniform mediump isampler2D img_data;\nuniform sampler2D lightmap;\nout vec4 COLOR;\nuniform float zoom;\nuniform float mx;\nuniform float mapSize;\nuniform float terrainInfo[32];\nvec4 sptexture3D(in vec2 coords,in float height1) {\n \n\n \nif(coords.x>=1.0){\ncoords.y+=height1*floor(coords.x);\n}\n\n\n\n    return(\ttexture(img_common, vec3(coords,int(coords.y)))\t);\n}\n\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main() {\nvec4 color;\n\nvec2 xy =  vec2(gl_FragCoord.x,u_resolution.y-gl_FragCoord.y)/zoom;\n\nif(miniMap==1){\nxy+=minimapMargin/zoom;\n}else{\nxy+=-u_translation+vec2(mx,0.0)/zoom+0.5*(u_resolution-u_resolution/zoom);\n}\n\nvec2 xy32=xy/32.0;\n\nvec2 floorxy32=floor(xy32);\n\nvec2 xyr=xy32-floorxy32;\n\n\nvec2 xyb;\n\n\nfloat dx=0.0;\nfloat dy=0.0;\n\nif(xyr.x>0.5){dx=1.0;}\nif(xyr.y>0.5){dy=1.0;}\n\nvec2 oxy32=xy32;\n\n\nif(dx==1.0){\nxyb=vec2(borderCoords.x+floor(rand(floorxy32)*24.0)*64.0/512.0,borderCoords.y)+(xyr)*(32.0/512.0)+vec2(-16.0,8.0)/512.0;\nif(sptexture3D(xyb,64.0/512.0).r>0.5){\nxy32.x+=dx;\n}\n}\n\nif(dy==1.0){\nxyb=vec2(borderCoords.x+floor(rand(1.5*floorxy32-3.0)*24.0)*64.0/512.0,borderCoords.y)+(xyr)*(32.0/512.0)+vec2(8,-16.0)/512.0;\nif(sptexture3D(xyb,64.0/512.0).r>0.5){\nxy32.y+=dy;\n}\n}\n\n\nint type = texture(img_data,xy32/(mapSize)).r;\nint ntype = texture(img_data,oxy32/(mapSize)).r;\n\nif(type<0&&type!=ntype){\n\nif(ntype<0){\ntype=ntype;\n}else if(ntype==3){\ntype=ntype;\n}else{\ntype=1;\n}\n}\n\n\n\nfloat h;\nfloat w;\nvec2 xytxt;\nif(type<0){\n\ntype=-type-2;\nxytxt=waterBorder+vec2(float(type*8*32),0.0)/512.0;\nw=32.0;\nh=32.0;\ntype*=-1;\n}else{\nxytxt=vec2(terrainInfo[type*4],terrainInfo[type*4+1]);\nw=terrainInfo[type*4+2];\nh=terrainInfo[type*4+3];\n\nif(type==3) xytxt+=vec2(u_fps,0.0);\n}\n\n\nvec2 xyt=vec2(xytxt)+vec2(mod(xy.x,w),mod(xy.y,h))/512.0;\n\n\nif(type==3){ h=576.0; }\ncolor=sptexture3D(xyt,h/512.0);\n\nmediump vec4 light=vec4(1.0);\nif(miniMap==0) light = (texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+1.0)*u_ambient;\n\n\n\nCOLOR=color*light;\n\n\n\n}");
k.compileShader(b);oa=k.createProgram();k.attachShader(oa,c);k.attachShader(oa,b);k.linkProgram(oa);(c=k.getShaderInfoLog(c))&&console.log("Shader1 compiler log T: "+c);(c=k.getShaderInfoLog(b))&&console.log("Shader compiler log T: "+c)}b=k.getAttribLocation(da,"a_position");c=k.getAttribLocation(da,"a_texCoord");var e=k.getAttribLocation(da,"a_step"),d=k.getAttribLocation(da,"a_physic"),g=k.getAttribLocation(da,"a_margins"),h=m,q=Ad.dir,l=[];l.length=4*q.length;for(var p=0,w=q.length;p<w;p++){var B=
h[q[p]],z=B[7]+168960,A=B[8],C=B[9];l[4*p]=B[6]/512;l[4*p+1]=z/512;l[4*p+2]=A;l[4*p+3]=C}p=1/512;k.useProgram(oa);w=k.getUniformLocation(oa,"minimapMargin");ge=k.getUniformLocation(oa,"u_translation");Ih=k.getUniformLocation(oa,"u_resolution");Hh=k.getUniformLocation(oa,"u_fps");hk=k.getUniformLocation(oa,"u_ambient");ld=k.getUniformLocation(oa,"zoom");q=k.getUniformLocation(oa,"mx");B=k.getUniformLocation(oa,"mapSize");z=k.getUniformLocation(oa,"borderCoords");A=k.getUniformLocation(oa,"waterBorder");
Jf=k.getUniformLocation(oa,"miniMap");C=k.getUniformLocation(oa,"terrainInfo");k.uniform2fv(z,[ia.info[h.terrain_border.asd+6]*p,p*ia.info[h.terrain_border.asd+7]]);k.uniform2fv(A,[ia.info[h.waterborder+6]*p,p*ia.info[h.waterborder+7]]);k.uniform1i(Jf,0);k.uniform2fv(ge,[0,0]);k.uniform1f(Hh,-1);k.uniform1f(ld,1);k.uniform1f(q,-y.mx);k.uniform1f(B,H);k.uniform1fv(C,l);v.editor?k.uniform2fv(w,[0,-60]):k.uniform2fv(w,[-4,-31]);h=k.getAttribLocation(oa,"a_position");Jh=k.createVertexArray();k.bindVertexArray(Jh);
l=k.createBuffer();k.bindBuffer(k.ARRAY_BUFFER,l);k.bufferData(k.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,-1,1,1,-1,1]),k.STATIC_DRAW);k.enableVertexAttribArray(h);k.vertexAttribPointer(h,2,k.FLOAT,!1,0,0);k.bindVertexArray(null);k.useProgram(da);k.bindBuffer(k.ARRAY_BUFFER,null);Kh=k.createVertexArray();k.bindVertexArray(Kh);yk=k.createBuffer();k.bindBuffer(k.ARRAY_BUFFER,yk);k.enableVertexAttribArray(e);k.vertexAttribIPointer(e,1,k.UNSIGNED_BYTE,0,0);k.bufferData(k.ARRAY_BUFFER,new Uint8Array([0,
1,2,1,2,3]),k.STATIC_DRAW);k.vertexAttribDivisor(e,0);zk=Math.floor(H*Ba/2);Bh=he(c,3);Ch=he(b,3);Dh=he(d,4);Eh=he(g,3);k.bindVertexArray(null);If=k.getUniformLocation(da,"u_resolution");ik=k.getUniformLocation(da,"u_ambient");fe=k.getUniformLocation(da,"u_translation");kd=k.getUniformLocation(da,"zoom");xk=k.getUniformLocation(da,"now");ee=k.getUniformLocation(da,"miniMap");b=k.getUniformLocation(da,"zMax");k.uniform1f(b,v.zMax);k.uniform1i(ee,0);k.useProgram(da);b=de(x.sharedDelayID(),1323);v.daylength||
(v.daylength=2880);v.initialhour||(v.initialhour=12);p=0;for(w=eb.length;p<w;p++).55>eb[p]&&(eb[p]=.55);$i();k.uniform1f(kd,1);k.uniform2fv(fe,[0,0]);Lc=k.createFramebuffer();Lf.changed=0;window.addEventListener("resize",Lf,!1);Lf();k.blendEquation(k.FUNC_ADD);k.blendFunc(k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA);k.disable(k.DITHER);k.disable(k.BLEND);performance.now();Mc(1);ie||(k.uniform1f(k.getUniformLocation(da,"kingdoms"),x.nkingdom()),c=x.getColorTexture(),e=4*(x.nkingdom()+7),c=new Uint8Array(n.buffer,
c,e),k.activeTexture(k.TEXTURE4),e=k.createTexture(),k.bindTexture(k.TEXTURE_2D,e),k.texImage2D(k.TEXTURE_2D,0,k.RGBA,c.length/4,1,0,k.RGBA,k.UNSIGNED_BYTE,c),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.REPEAT),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.REPEAT),k.bindTexture(k.TEXTURE_2D,null),k.bindTexture(k.TEXTURE_2D,e),k.uniform1i(k.getUniformLocation(da,"colorArray"),
4),k.activeTexture(k.TEXTURE3),e=k.createTexture(),k.bindTexture(k.TEXTURE_2D,e),k.texImage2D(k.TEXTURE_2D,0,k.R16F,b.length,1,0,k.RED,k.FLOAT,b),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.REPEAT),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.REPEAT),k.bindTexture(k.TEXTURE_2D,null),k.bindTexture(k.TEXTURE_2D,e),k.uniform1i(k.getUniformLocation(da,"delay"),3),k.activeTexture(k.TEXTURE2),
wk=k.createTexture(),k.bindTexture(k.TEXTURE_2D,wk),k.texImage2D(k.TEXTURE_2D,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,new Uint8Array([255,255,255,255])),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.REPEAT),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.REPEAT),k.clearColor(0,0,0,1));k.bindFramebuffer(k.FRAMEBUFFER,Lc);Lc.width=1;Lc.height=1;k.framebufferTexture2D(k.FRAMEBUFFER,
k.COLOR_ATTACHMENT0,k.TEXTURE_2D,md,0);k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT);k.bindFramebuffer(k.FRAMEBUFFER,null);new Float32Array(8);x.setupGL();k.enable(k.DEPTH_TEST);k.depthFunc(k.LEQUAL);Aa.fp1000=1E3;Aa.delta=0;Aa.now=0;Aa.frameCount=0;k.bindTexture(k.TEXTURE_2D,md);ie=ia.setup=!0;x.preldd()||x.randomMap();G(Ta,ya);Hb.check()},Hb=function(){for(var b=["loading","playermenu","index"],c=b.length,e=0;e<c;r(b[e++]).style.display="none");qh();id();Qk();window.addEventListener("keydown",
Km);window.addEventListener("keyup",Lm);window.addEventListener("mousemove",Mm);window.addEventListener("wheel",jk,!1);window.addEventListener("mousedown",Nm);window.addEventListener("mouseup",Om);bg=performance.now()-bg;G("FULL: ",bg);Oh=!1;v.online?(G("readyyyy"),x.plready()):me();v.allow14=!1};Hb.check=function(){Hb.load++;Hb.load===Hb.target&&Hb()};Hb.target=2;var ne=function(){for(var b=$a.length,c=$a,e="",d=0;d<b;d++){var g=c[d];ne.obj[g.id]||g.id==y.onlineID||(e+="<br>"+g.nhinfo.name)}return e};
ne.obj={};var Rk=function(){return y.gl?!1:(zc("You can't run WEBGL 2<br>More info <a href='http://webglreport.com/?v=2'>here</a>","Error"),Qb(),!0)},hi=function(){var b=document.documentElement;b.requestFullscreen?b.requestFullscreen():b.msRequestFullscreen?b.msRequestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullscreen&&b.webkitRequestFullscreen()},Oh=!1,od=function(){if(!Rk())if(Ef(),Eg(),Hb.load=0,"true"==localStorage.fullscreen&&hi(),v.editor?(y.marx=0,y.mary=
60,y.menumy=60,Kb=qc=171,y.mx=171,y.menumx=171):(y.mx=151,Kb=qc=128,y.menumx=151,y.menumy=0,y.marx=4,y.mary=31),mc.style.width=qc+"px",mc.style.height=Kb+"px",mc.style.left=y.marx+"px",mc.style.top=y.mary+"px",la("loading"),""==r("loading").innerHTML&&(r("loading").innerHTML='<p id="loadingtext"></p>\n<div>\n<div class="svgtzared"></div>\n<div id=\'logo\' class="svgnehhon"></div>\n<span id="netral">NEHHON NETRAL-H ENGINE</span>\n</div>'),origin=!1,x.mapWidth()||Tc(),v.terrainType="grass",Ce.last!==
v.terrainType){ia.started=!0;var b=y.cdn;cm({icons:b+"icons.png",imageJSON:b+"images.json",common:b+"graphics.nh17"});Ce.last=v.terrainType;Oh=!0}else Hb.check(),Bg()},Sh,qh=function(){var b=r("playersinfo");b.innerHTML="";if(!v.editor)for(var c=1,e=J.length;c<e;c++){var d=J[c],g=d.death?d.name.strike():d.name;b.innerHTML+=g+"<span id='score"+c+"'></span><div class='playercolor' style='background:rgb("+d.color[0]+","+d.color[1]+","+d.color[2]+")'></div><span class='ping'>"+(void 0!=J[c].ping&&" "+
J[c].ping+"ms"||"")+"</span><br>"}},Qk=function(){var b=window.innerWidth-y.mx,c=window.innerHeight,e=x.empXY(),d=e%H,g=~~(e/H);e?(b=32*d-.5*b,c=32*g-.5*c):c=b=0;dd(~~b,~~c)},be,Ah,mk,bm=function(){var b=r("selectedobject").getContext("webgl",{antialias:!1,depth:!1}),c=b.createShader(b.VERTEX_SHADER);b.shaderSource(c,"void main() {\ngl_Position = vec4(0 ,0, 0, 1);\ngl_PointSize=48.0;\n}");b.compileShader(c);var e=b.createShader(b.FRAGMENT_SHADER);b.shaderSource(e,"precision mediump float;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nuniform float txtCoord;\nvoid main() {\ngl_FragColor = texture2D(u_image, (vec2(\tmod(txtCoord,21.0) ,floor(txtCoord/21.0) ) + gl_PointCoord)*(0.046875));\nif(gl_FragColor.r==gl_FragColor.g&&gl_FragColor.r==gl_FragColor.b) gl_FragColor*=u_color;\n}");
b.compileShader(e);var d=b.createProgram();b.attachShader(d,c);b.attachShader(d,e);b.linkProgram(d);b.useProgram(d);c=b.createTexture();b.bindTexture(b.TEXTURE_2D,c);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texImage2D(b.TEXTURE_2D,0,b.RGB,b.RGB,b.UNSIGNED_BYTE,ra.icons);var g=b.getUniformLocation(d,"u_color"),
h=b.getUniformLocation(d,"txtCoord");be=function(c){b.uniform4f(g,1,1,1,1);b.uniform1f(h,c);b.drawArrays(b.POINTS,0,1)};Ah=function(){b.uniform4f(g,1,1,1,1);b.uniform1f(h,189);b.drawArrays(b.POINTS,0,1)};mk=function(){b.uniform1f(h,0);b.uniform4f(g,0,0,0,0);b.drawArrays(b.POINTS,0,1)}},qc=128,Kb=128,A=[{terrain:1},{terrain:1},{terrain:1}],ob={};window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(b){window.setTimeout(b,
1E3/60)}}();var $a=[];window.addEventListener("offline",function(b){Xc("Offline","#ff0000")});window.addEventListener("online",function(b){Xc("Online","#00ff00")});var pd={};(function(){for(var b=["returnmenu","index","Account","accountIframe"],c=0,e=b.length;c<e;pd[b[c]]=r(b[c++]));})();var Xm=function(){location.replace("#"+this.gameID+"Room")},Sk=function(b){$a=[];G("connecting to",b,t.loading);r("game").style.display="block";r("gameName").innerHTML=t.loading;r("returnmenu").style.display="none";
r("index").style.display="none";sc.innerHTML="";cc=[];y.p2p?(Ea.joinRoom(b,og),Eg()):(Ea||Lb(),Lb.func=function(){Sk(b)})},Ym={6400900:".",28462225:"a",29052100:"b",29648025:"c",3025E4:"d",30858025:"e",31472100:"f",32092225:"g",32718400:"h",33350625:"i",33988900:"j",34633225:"k",35283600:"l",35940025:"m",36602500:"n",37271025:"o",37945600:"p",38626225:"q",39312900:"r",40005625:"s",40704400:"t",41409225:"u",42120100:"v",42837025:"w",4356E4:"x",44289025:"y",45024100:"z"},Zm=function(b){V("game");qd.length=
0;v.online=0;ea=v.id=void 0;Ea.leaveRoom();$a.length=0;Qb();x.closeRoom();b.constructor==String&&zc(b)},wm={euro:0,arab:0,asia:0},cc,Tk=function(b,c,e){cc=b;rd()},Uk=function(b){for(var c=0,e=$a.length;c<e;c++){var d=$a[c];if(d.id==b)return d}},Ea,Wk=function(b){if(!r("usernameForm")){vc();var c=localStorage.name||"Guest",e=localStorage.color||"#"+Math.floor(16777215*Math.random()).toString(16),d=document.createElement("div");d.id="usernameForm";d.innerHTML="\n            <div>\n            <h2>"+
t.username+'</h2>\n            <div>\n<input type="color" id=\'usernameColor\' value="'+e+'" /><input id=\'usernameVal\' type="text" value="'+Vk(c)+'" />\n</div>\n<br />\n</div>';c=document.createElement("button");c.innerHTML=t.continue;c.onclick=function(){y.name=Ka(r("usernameVal").value);y.color=r("usernameColor").value;localStorage.color=y.color;localStorage.name=y.name;document.body.removeChild(r("usernameForm"));b();gb()};d.children[0].appendChild(c);document.body.appendChild(d)}},ii=function(b){for(var c=
0,e=0;e<b.length;e++)c+=b.charCodeAt(e)*e+(c&e);G(c,"id");return c%4294967295},Lb=function(){Rk()||(y.name?(Ul(),Ea=new SimpleWebRTC({localVideoEl:"",remoteVideosEl:"",autoRequestMedia:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},url:"https://solar.tza.red/"}),Ea.on("channelMessage",function(b,c,e){c=x.tempointeradd(e.length);c=new Uint32Array(n.buffer,c,e.length);for(var d=0;d<e.length;d++)c[d]=e[d];x.onldata(b.superID)}),Ea.on("error",function(b){"full"==b&&(Qb(),Xc(t.gameFull,
"#ff0000"))}),Ea.on("connectionReady",function(b){var c=Ea.connection.connection;y.p2p=c;y.superID=ii(c.id);x.setupOnlID(y.superID);c.username=y.name;c.color=y.color;c.on("getRooms",function(c){var b=c.date,e=Object.keys(c),f=r("gameList");if(1<e.length){f.innerHTML="";for(var k=0,l=e.length;k<l;k++){var m=e[k],n=c[m];if("date"!=m){var v=n.len;if(v){var w=document.createElement("tr"),x="";x=n.playing?x+("<td><div class='redCircle'></div>"+t.playing+"</td>"):x+("<td><div class='redCircle' style=\"background:rgba(0,255,0,.8); box-shadow:0px 0px 20px rgba(0,255,0,.8)\"></div>"+
t.waiting+"</td></td>");x+="<td>"+Ka(n.description)+"</td><td>"+~~((b-n.date)/6E4)+" min ago</td><td>"+Ka(v)+"/"+Ka(n.max)+"</td>";w.innerHTML=x;w.gameID=m;n.playing||(w.onclick=Xm);f.appendChild(w)}}}}else f.innerHTML="<tr><td>No games found</td></tr>"});y.onlineID=b;Lb.func&&Lb.func()}),Ea.on("createdPeer",function(b){v.started||Fl(b)})):Wk(Lb))},$m=function(){Eg();gb();la("game");V("returnmenu");V("index");r("gameName").innerHTML=t.loading;sc.innerHTML="";$a=[];Qc();y.admin=1;y.room={description:r("gameFormName").value,
max:parseInt(r("gameMax").value),public:!0};2>y.room.max&&(y.room.max=2);14<y.room.max&&(y.room.max=14);localStorage.gameDescription=y.room.description;Ea.createRoom(y.onlineID+"b",og);v.online=1;document.body.removeChild(r("gameForm"));cc=[y.onlineID];Tc();x.setupOnlTable(y.room.max+1);Sc(x.onlADD(0,0,parseInt(y.color.substr(1),16),y.superID,0),17,y.name);rd()},Xk=function(){Ea||Lb();if(y.onlineID){vc();var b=localStorage.gameDescription||y.name+"'s room",c=document.createElement("div");c.id="gameForm";
c.innerHTML="\n<div>\n            <h2>"+t.gameOptions+"</h2>\n            "+t.gameName+': <input id=\'gameFormName\' type="text" value="'+b+'" maxlength="29" /><br />\n'+t.nplayers+': <input id="gameMax" type="number" value="6" max="14" min="2"/><br />\n            </div>';b=document.createElement("button");b.innerHTML=t.continue;b.onclick=$m;c.children[0].appendChild(b);document.body.appendChild(c)}else setTimeout(function(){location.hash=""},200),Lb.func=Xk},Yk=function(b){for(var c="kingdom d type img x32 y32 name iconID attack defence level health maxHealth func funcObj workers workingOn inventory dix diy timestamp working rnd techID techStart activeTech levelProgress c mimg built xf yf action point waitlist mv work death freezed confused sword shield book spy stock".split(" "),
e=[],d=b.length,f=0;f<d;f++){var h=b[f],k=Object.keys(h),l={};e.put(l);for(var m=0,n=k.length;m<n;m++)l[c[k[m]]]=h[k[m]]}return e},Hl=function(){compressMap.download=!1;gi();compressMap.download=!0},gi=function(){var b=x.savegame(),c=new Uint8Array(n.buffer,b,Nc[0]),e=Nc[1];G(c,b);b=new Blob([new Uint32Array([e]),c],{type:"application/octet-binary"});b=URL.createObjectURL(b);c=document.createElement("a");document.body.appendChild(c);c.style="display: none";c.href=b;c.download="savegame.tzared";c.click()},
an=function(){$a.length&&(Tc(),x.strOnl(),y.p2p.emit("gameStarted"))},oe=function(b,c,e){if(e){if(ne.obj[e.id])return;ne.obj[e.id]=1;b=ne();""==b?zc(b,t.loading,1):zc(b,t.waitingPlayers,1)}y.admin&&(oe.i++,G(oe.i,qd.length,e),oe.i==qd.length-v.bots&&setTimeout(function(){G(999999999,44444)},100))};oe.i=0;var me=function(){gb();r("alert").style.display="none";v.started=1;v.date=Date.now();Rb();Da();x.startMovement();Aa()};me.fast=!0;var Zk=function(b,c,e){od()},ce=!1,gb=function(){ce=!1;r("basic").style.filter=
""},vc=function(){ce=!0;r("basic").style.filter="blur(94px)"};var $k=function(){la("game");qd.length=0;v.id=void 0;v.online=0;ea=void 0;v.compressed=void 0;v.arje=void 0;Ea.leaveRoom();$a.length=0;Qb();y.admin=0;x.closeRoom()};var al=function(b,c,e){e&&(fb.arr=new Uint8Array(parseInt(b)),fb.i=0,r("showGameInfo").innerHTML="<table><tr><td>Downloading custom map</td><td id='cmappr'></td></tr></table>")},fb=function(b,c,e){e&&(fb.arr.set(b,fb.i),fb.i+=b.length,r("cmappr").innerHTML=~~(100*fb.i/fb.arr.length+
.5)+"%",fb.i==fb.arr.length&&bl(fb.arr))};fb.step=1E4;var bl=function(b){var c=cl(b);c.custom=!0;ea=c;ea.online=!0;ea.started=!1;ea.editor=!1;y.admin&&(ea.compressed=b);G("newmap",c);cg(c);rd()},dl=function(b){b=parseInt(b);if(2>b||!b)b=2;14<b&&(b=14);b!==y.room.max&&(y.p2p.emit("maxPlayers",b-(cc.length-$a.length-1)),G(999999999,44444))},el=function(b){y.room.max=b;rd()},bn=function(){G(999999999,44444);r("optionbutton").style.display="inline-table";V("deleteCusMap")},og=function(b){if((y.admin||
b)&&!v.id)if(b=Ea.roomName,b+="Room",G("login"),gb(),0!==Ea.getPeers().length||y.admin){var c=y.room||NaN;G(c);v.id=b;v.online=1;Qc();y.admin&&(r("onlineTopInfo").innerHTML=' <button id="addAI" style="padding: 6px;">'+t.addAI+'</button><span style="float:right">'+t.nplayers+'<input id="nplayersO" min="2" type="number" max="14" value="'+y.room.max+'" /></span>',r("nplayersO").onchange=function(){var c=this.value;c<cc.length&&(c=cc.length);G(cc.length,c);cc.length!=c||$a.length||c++;dl(c);this.value=
y.room.max},r("addAI").onclick=function(){x.onlCount()<y.room.max&&(Sc(x.onlADD(0,0,16777216*Math.random(),0,1),17,"AI"),y.p2p.emit("maxPlayers",y.room.max-x.nAIs()),x.sndNfo())});r("copyButton")&&(r("copyButton").onclick=function(){r("onlineID").select();document.execCommand("Copy")},r("onlineID").value=location.origin+"/#"+v.id);r("gameName").innerHTML=Ka(c.description)||"Online Game";V("returnmenu");y.admin?(location.replace("#"+v.id),r("buttons").innerHTML='<button id="startbutton">'+t.play+'</button><button id="optionbutton">'+
t.options+'</button><button id="closebutton">'+t.close+'</button><br><input id="maploadOnline" type="file" /> <label style="display:none" for= "maploadOnline">'+t.strcusMap+'</label> <button id="deleteCusMap">'+t.randomMap+"</button>",r("startbutton").onclick=an,r("optionbutton").onclick=fl,r("closebutton").onclick=$k,r("maploadOnline").accept=".tzared",r("maploadOnline").onchange=cn,V("deleteCusMap"),r("deleteCusMap").onclick=bn):(r("buttons").innerHTML='<button id="quitbutton">'+t.disconnect+"</button>",
r("quitbutton").onclick=Zm);Ea.connection.on("remove",dn)}else location.hash="",Qb()},dn=function(b){if(b=Uk(b.id)){var c=Jc(Za(x.empName(x.pidkingdom(b.superID)),17));bc(rh(t.playerDisconnected,c),0,5);$a.quit(b);x.deletePlayer(b.superID)}},xb=function(){0===xb.active&&(G(999999999,44444),xb.date=Date.now(),xb.received=0,xb.max=-Infinity,xb.active=1)};xb.active=0;var gl=function(b,c,e){e&&G(999999999,44444)};gl.fast=!0;var Th={},Uh=function(b){G(b);if(y.superID==b)return zc(t.kicked),$k();(b=Uk(b))&&
b.end()},hl=document.getElementsByClassName("ucolor"),il=document.getElementsByClassName("username"),jl=document.getElementsByClassName("race"),Vh=document.getElementsByClassName("team"),yb=function(b){if(y.admin){yb.div&&(document.body.removeChild(yb.div),yb.div=void 0);var c=b.pageX;b=b.pageY;var e=this.i2,d=document.createElement("div");d.style.top=b+"px";d.style.left=c+"px";d.className="onlPlayer";yb.div=d;G(this.peer,this.i2);if(this.peer.name)c=document.createElement("button"),c.onclick=function(){x.userKick(e);
y.p2p.emit("maxPlayers",x.onlCount());document.body.removeChild(d);yb.div=void 0},c.innerHTML=t.kick,d.appendChild(c);else{var f=this.peer;c=document.createElement("button");c.onclick=function(){x.updown(e,-1);document.body.removeChild(d);yb.div=void 0};c.innerHTML=t.up;d.appendChild(c);c=document.createElement("button");c.onclick=function(){x.updown(e,1);document.body.removeChild(d);yb.div=void 0};c.innerHTML=t.down;d.appendChild(c);y.onlineID!=f&&(c=document.createElement("button"),c.onclick=function(){G(22222,
f);x.userKick(e);y.p2p.emit("maxPlayers",x.onlCount());document.body.removeChild(d);yb.div=void 0},c.innerHTML=t.kick,d.appendChild(c))}c=document.createElement("button");c.onclick=function(){document.body.removeChild(d);yb.div=void 0};c.innerHTML=t.close;d.appendChild(c);document.body.appendChild(d)}},rd=function(){var b=r("multiplayertable"),c='<tr style="text-transform:uppercase"><td></td><td>'+t.username+"</td><td>"+t.race+"</td><td>"+t.team+"</td></tr>",e=cc,d=x.nkingdom()-1||14;G("LENGTH",d);
e&&d<e.length&&(d=e.length);for(e=0;e<d;e++)c+='<tr><td class="ucolor"></td><td class="username">'+t.open+'</td><td class="race"></td><td class="team"></td></tr>';6>d&&(c+='<tr style="height: '+(260-46*d)+'px"></tr>');b.innerHTML=c;r("multiplayertable").getElementsByTagName("tr");x.onlineKingdoms();r("msgs").style.height=b.clientHeight-87+"px"},cg=function(b,c,e,d,g,h,k,l,m,n,v){var f="<table><tbody>";b==Math.pow(2,31)-1&&(b="***");e==Math.pow(2,31)-1&&(e="***");c==Math.pow(2,31)-1&&(c="***");d==
Math.pow(2,31)-1&&(d="***");b=[t.gold,b,t.mapSize,m,t.items,k,t.wood,e,t.terrainOption,h,t.peons,n,t.food,c,t.water,g,t.gateways,l,t.stone,d,t.freePop,v];c=b.length;for(e=0;e<c;e+=2)e%6||(e&&(f+="</tr>"),f+="<tr>"),f+="<td>"+b[e]+":</td><td>"+b[e+1]+"</td>";f+="</tbody></table>";return r("showGameInfo").innerHTML=f},qd=[],ve=Bb,ji=function(){var b=location.hash.substr(1);y.admin||Sk(b.substr(0,b.length-4))};window.onhashchange=ei;var sc=r("msgs"),Wh=r("msginput");Wh.addEventListener("keyup",function(b){13==
b.keyCode&&vh()});var bc=function(b,c,e,d){pa("chat");e&&(c=x.gstarted()?pc:sc,c.innerHTML=5!==e?c.innerHTML+("<li><span>"+Jc(Za(e,17))+" \u2014</span> "+Jc(Za(b,d))+"</li>"):c.innerHTML+("<li>"+b+"</li>"),c.scrollTop=c.scrollHeight,x.gstarted()&&dg())};bc.fast=!0;var dg=function(){11==sc.children.length&&pc.removeChild(pc.children[0]);1==sc.children.length&&(dg.intv=setInterval(en,16E3))},en=function(){pc.removeChild(pc.children[0]);0==sc.children.length&&clearInterval(dg.intv)},Ka=function(b){return String(b).replace(/</g,
"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},Vk=function(b){return String(b).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},vh=function(){if(v.started){var b=pc,c=r("msginputGame").value;r("msginputGame").value=""}else b=sc,c=Wh.value,Wh.value="";""!=c&&(c=Ka(c),b.innerHTML+="<li><span>"+y.name+" \u2014</span> "+c+"</li>",Sc(x.tempstradd(),1024,c),x.liveChat(c.length),b.scrollTop=b.scrollHeight,v.started&&dg())},kl=[Zk,ac,Ne,kb,Oe,Ld,Vg,bc,aj,Md,Nd,uk,Ue,lk,kj,Yg,cj,oe,
gl,function(b,c,e){e&&(e.ping=~~(.5*(Date.now()-xb.date)+.5),Th[e.id]?Th[e.id].put(e.ping):Th[e.id]=[e.ping],e.ping>xb.max&&(xb.max=e.ping),xb.received++,xb.received==$a.length&&(xb.active=0,v.started&&(J[e.kingdom].ping=e.ping,qh())))},nk,me,lj,hh,of,jh,Jj,Me,$e,cf,yf,kh,lh,gf,sj,pf,eh,Bj,Kg,ef,gh,Af,uf,Fj,Cf,lf,jf,wf,nh,fk,Gj,uj,cg,function(b,c,e){if(!v.started&&e){G("peerInfo",b);b.name=Ka(b.name);b.team=parseInt(b.team);0>b.team&&(b.team=0);b.team%=6;b.race=parseInt(b.race);if(0>b.race||2<b.race)b.race=
0;c=b.version;e&&e.admin&&c!=y.version&&(Qb(),Ea.leaveRoom(),zc(t.versionError+"<p> Admin version: "+parseFloat(c.substr(1))+"<br> Your version: "+parseFloat(y.version.substr(1))));e.nhinfo=b;e.username=b.name;rd()}},Tk,fb,Uh,el,Ri,al],ll=function(b,c,e){return e&&e.admin},pe=function(b,c,e){return(e&&e.admin||!e)&&!v.started},aa=function(b,c,e){b=c.length;e=J[e.kingdom].control;for(var d=0;d<b;d++)if(!e[A[c[d]].kingdom])return!1;return!0},eg=function(b,c,e){b=J[e.kingdom].control;c=A[c];return b[c.kingdom]?
!0:!1},Xh=function(b,c,e){c=J[e.kingdom].control;b=A[b];return c[b.kingdom]?!0:!1};Zk.secureNH=pe;ac.secureNH=aa;Ne.secureNH=aa;kb.secureNH=aa;Oe.secureNH=aa;Ld.secureNH=aa;Vg.secureNH=aa;aj.secureNH=aa;Md.secureNH=aa;Nd.secureNH=aa;uk.secureNH=Xh;Ue.secureNH=aa;lk.secureNH=aa;kj.secureNH=aa;Yg.secureNH=aa;cj.secureNH=eg;nk.secureNH=aa;me.secureNH=function(b,c,e){return e&&e.admin||!e};lj.secureNH=eg;hh.secureNH=aa;of.secureNH=aa;jh.secureNH=aa;Jj.secureNH=Xh;Me.secureNH=aa;$e.secureNH=aa;cf.secureNH=
aa;yf.secureNH=aa;kh.secureNH=aa;lh.secureNH=aa;gf.secureNH=aa;sj.secureNH=aa;pf.secureNH=Xh;eh.secureNH=aa;Bj.secureNH=aa;Kg.secureNH=aa;ef.secureNH=aa;gh.secureNH=aa;Af.secureNH=aa;uf.secureNH=aa;Fj.secureNH=aa;Cf.secureNH=aa;lf.secureNH=aa;jf.secureNH=aa;wf.secureNH=aa;nh.secureNH=aa;fk.secureNH=eg;Gj.secureNH=eg;uj.secureNH=aa;cg.secureNH=pe;Tk.secureNH=pe;Uh.secureNH=pe;el.secureNH=pe;al.secureNH=ll;fb.secureNH=ll;Ri.secureNH=function(b,c,e){return!e};(function(){for(var b=0,c=kl.length;b<c;b++)kl[b].location=
b})();var ml=document.getElementsByClassName("ucolor1"),fn=document.getElementsByClassName("username1"),gn=document.getElementsByClassName("race1"),hn=document.getElementsByClassName("team1"),nl=function(b){var c=1;2==b.button&&(c=-1);this.innerHTML=x.changeTeam(this.iteam,c)},ol=function(b){b=1;2==event.button&&(b=-1);this.innerHTML=Ra[x.changeRace(this.iteam,b)]},pl=function(){G(this.value);this.parentElement.style.background=this.value;x.changeColor(this.iteam,parseInt(this.value.substr(1),16))},
jn=function(){x.randomKingdoms(1)},kn=function(){x.randomKingdoms(-1)},Sj={0:"euro",1:"arab",2:"asia"},ql=function(b,c,e,d,g,h,k){var f="#"+d.toString(16);b=Jc(Za(b,17));var m=r("multiplayertable").getElementsByTagName("tr"),q=h==y.superID,n=g+1;d=parseInt(f.substr(1),16);d=[d>>16&255,d>>8&255,d&255];hl[g].style.background="rgb("+d[0]+","+d[1]+","+d[2]+")";il[g].innerHTML=b;k&&(il[g].style.color="#fff900");q||k&&y.admin?(Vh[g].innerHTML="",b=document.createElement("button"),b.onmousedown=nl,b.iteam=
n,b.innerHTML=c,Vh[g].appendChild(b),k&&(b.style.color="#fff900"),b=document.createElement("button"),b.onmousedown=ol,b.iteam=n,b.innerHTML=Ra[e],jl[g].appendChild(b),k&&(b.style.color="#fff900"),c=document.createElement("input"),c.type="color",c.iteam=n,c.value=f,hl[g].appendChild(c),c.onchange=pl):(Vh[g].innerHTML=c,jl[g].innerHTML=Ra[e]);y.admin&&!q&&(m[g+1].onclick=yb,m[g+1].peer=h,m[g+1].i2=g+1)},rl=function(){y.name?(la("returnmenu"),x.randomKingdoms()):Wk(rl)},Wm=function(b,c,e){"granted"!=
Notification.permission&&Notification.requestPermission(function(c){});var d=new Notification(b,{icon:"/nehhon/807.png",body:c,requireInteraction:!1});e||(e=5550);setTimeout(function(){d.close()},e)},Ad,sl=function(b){for(var c="",e=0,d=b.length;e<d;e++)c+=Ym[b[e]];return c};Wl[sl([32718400,37271025,40005625,40704400,36602500,28462225,35940025,30858025])]!==sl([40704400,45024100,28462225,6400900,39312900,30858025,3025E4])&&(G("edge chrome firefox - compt"),Jk=Bb);var Mc=function(b){if(b){Mc.update=
!1;b=le;for(var c=[],e={},d=0,f=H*Ba;d<f;d++);d=0;for(f=c.length;d<f;d++){var h=c[d];b[h]=e[d];ob[h]=2;Ya[h]=2;Y[h]=2}k.useProgram(oa);k.activeTexture(k.TEXTURE1);c=k.createTexture();k.bindTexture(k.TEXTURE_2D,c);k.pixelStorei(k.UNPACK_ALIGNMENT,1);k.texImage2D(k.TEXTURE_2D,0,k.R8I,H,Ba,0,k.RED_INTEGER,k.BYTE,b);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.REPEAT);k.texParameteri(k.TEXTURE_2D,
k.TEXTURE_WRAP_T,k.REPEAT);k.bindTexture(k.TEXTURE_2D,null);k.bindTexture(k.TEXTURE_2D,c);k.uniform1i(k.getUniformLocation(oa,"img_data"),1);k.useProgram(da);k.activeTexture(k.TEXTURE2)}else Mc.update=!0};Mc.update=!1;var b,Ik,Of,Pf,Qf,Rf,Sf,Tf,Uf,Vf,Wf,Xf,Yf,Zf,Rm=function(){var f={};b={move:function(){ac.cursor=7}};b.move.iconID=262;b.move.obj={name:t.move};b.attack=function(){};b.attack.iconID=250;b.attack.obj={name:t.attack};b.guard=function(){Pd(4)};b.guard.iconID=237;b.guard.obj={name:t.guard};
b.patrol=function(){Pd(8)};b.patrol.iconID=238;b.patrol.obj={name:t.patrol};b.pickUp=function(){};b.pickUp.iconID=240;b.pickUp.obj={name:t.pickItems};b.explore=function(){Pd(7)};b.explore.iconID=40;b.explore.obj={name:t.explore};b.stop=function(){G(999999999,44444)};b.stop.iconID=160;b.stop.obj={name:t.stop};b.stand=function(){G(999999999,44444)};b.stand.iconID=27;b.stand.obj={name:t.stand};b.attackGround=function(){};b.attackGround.iconID=100;b.steady=function(){};b.steady.iconID=21;b.createOrk=
function(){L(58)};b.createOrk.iconID=120;b.createDwarf=function(){L(59)};b.createDwarf.iconID=117;b.createSkeleton=function(){L(60)};b.createSkeleton.iconID=87;b.createGhost=function(){L(40)};b.createGhost.iconID=222;b.createFootman=function(){L(0)};b.createFootman.iconID=182;b.createArcher=function(){L(4)};b.createArcher.iconID=185;b.createMaceman=function(){L(3)};b.createMaceman.iconID=186;b.createPikeman=function(){L(1)};b.createPikeman.iconID=183;b.createLongbowman=function(){L(6)};b.createLongbowman.iconID=
184;b.createKnight=function(){L(19)};b.createKnight.iconID=180;b.iniMercenaries=function(c){c.mlist=[];c.mlistID=[];c.mercID=0;Tg(c);c.setupINTV(Fh,0,2E3)};b.iniMercenaries.builds=[30];b.iniHeroes=function(c){c.hlist=[];c.hlistID=[];c.heroID=0;Tg(c);c.setupINTV(Fh,0,2E3)};b.iniHeroes.builds=[30];b.mercFootmanArab=function(){Ia()};b.mercFootmanArab.iconID=49;b.mercFootmanArab.unit=80;b.mercFootmanArab.obj={};b.mercArcherArab=function(){Ia()};b.mercArcherArab.iconID=52;b.mercArcherArab.unit=85;b.mercArcherArab.obj=
{};b.mercMacemanArab=function(){Ia()};b.mercMacemanArab.iconID=116;b.mercMacemanArab.obj={};b.mercMacemanArab.unit=83;b.mercPikemanArab=function(){Ia()};b.mercPikemanArab.iconID=52;b.mercPikemanArab.unit=82;b.mercPikemanArab.obj={};b.mercCavalry=function(){Ia()};b.mercCavalry.iconID=133;b.mercCavalry.unit=84;b.mercCavalry.obj={};b.mercEnichar=function(){Ia()};b.mercEnichar.iconID=123;b.mercEnichar.unit=91;b.mercEnichar.obj={};b.mercJihad=function(){Ia()};b.mercJihad.iconID=236;b.mercJihad.unit=86;
b.mercJihad.obj={};b.mercFootmanArab6=function(){za()};b.mercFootmanArab6.iconID=49;b.mercFootmanArab6.unit=80;b.mercFootmanArab6.obj={};b.mercArcherArab6=function(){za()};b.mercArcherArab6.iconID=52;b.mercArcherArab6.unit=85;b.mercArcherArab6.obj={};b.mercMacemanArab6=function(){za()};b.mercMacemanArab6.iconID=116;b.mercMacemanArab6.unit=83;b.mercMacemanArab6.obj={};b.mercPikemanArab6=function(){za()};b.mercPikemanArab6.iconID=52;b.mercPikemanArab6.unit=82;b.mercPikemanArab6.obj={};b.mercCavalry6=
function(){za()};b.mercCavalry6.iconID=133;b.mercCavalry6.unit=84;b.mercCavalry6.obj={};b.mercEnichar6=function(){za()};b.mercEnichar6.iconID=123;b.mercEnichar6.unit=91;b.mercEnichar6.obj={};b.mercJihad6=function(){za()};b.mercJihad6.iconID=236;b.mercJihad6.unit=86;b.mercJihad6.obj={};b.mercFootman=function(){Ia()};b.mercFootman.iconID=182;b.mercFootman.unit=0;b.mercArcher=function(){Ia()};b.mercArcher.iconID=185;b.mercArcher.unit=4;b.mercMaceman=function(){Ia()};b.mercMaceman.iconID=186;b.mercMaceman.unit=
3;b.mercPikeman=function(){Ia()};b.mercPikeman.iconID=183;b.mercPikeman.unit=1;b.mercLongbowman=function(){Ia()};b.mercLongbowman.iconID=184;b.mercLongbowman.unit=6;b.mercKnight=function(){Ia()};b.mercKnight.iconID=180;b.mercKnight.unit=19;b.mercFootman6=function(){za()};b.mercFootman6.iconID=182;b.mercFootman6.unit=0;b.mercFootman6.obj={};b.mercArcher6=function(){za()};b.mercArcher6.iconID=185;b.mercArcher6.unit=4;b.mercArcher6.obj={};b.mercMaceman6=function(){za()};b.mercMaceman6.iconID=186;b.mercMaceman6.unit=
3;b.mercMaceman6.obj={};b.mercPikeman6=function(){za()};b.mercPikeman6.iconID=183;b.mercPikeman6.unit=1;b.mercPikeman6.obj={};b.mercLongbowman6=function(){za()};b.mercLongbowman6.iconID=184;b.mercLongbowman6.unit=6;b.mercLongbowman6.obj={};b.mercKnight6=function(){za()};b.mercKnight6.iconID=180;b.mercKnight6.unit=19;b.mercKnight6.obj={};b.mercArcherAsian6=function(){za()};b.mercArcherAsian6.iconID=53;b.mercArcherAsian6.unit=67;b.mercArcherAsian6.obj={};b.mercSamurai6=function(){za()};b.mercSamurai6.iconID=
122;b.mercSamurai6.unit=68;b.mercSamurai6.obj={};b.mercHourseSamurai6=function(){za()};b.mercHourseSamurai6.iconID=121;b.mercHourseSamurai6.unit=70;b.mercHourseSamurai6.obj={};b.mercRonin6=function(){za()};b.mercRonin6.iconID=54;b.mercRonin6.unit=66;b.mercRonin6.obj={};b.mercHorseArcher6=function(){za()};b.mercHorseArcher6.iconID=52;b.mercHorseArcher6.unit=69;b.mercHorseArcher6.obj={};b.mercChariot6=function(){za()};b.mercChariot6.iconID=79;b.mercChariot6.unit=72;b.mercChariot6.obj={};b.mercArcherAsian=
function(){Ia()};b.mercArcherAsian.iconID=53;b.mercArcherAsian.unit=67;b.mercArcherAsian.obj={};b.mercSamurai=function(){Ia()};b.mercSamurai.iconID=122;b.mercSamurai.unit=68;b.mercSamurai.obj={};b.mercHourseSamurai=function(){Ia()};b.mercHourseSamurai.iconID=121;b.mercHourseSamurai.unit=70;b.mercHourseSamurai.obj={};b.mercRonin=function(){Ia()};b.mercRonin.iconID=54;b.mercRonin.unit=66;b.mercRonin.obj={};b.mercHorseArcher=function(){Ia()};b.mercHorseArcher.iconID=52;b.mercHorseArcher.unit=69;b.mercHorseArcher.obj=
{};b.mercChariot=function(){Ia()};b.mercChariot.iconID=79;b.mercChariot.unit=72;b.mercChariot.obj={};b.createPeon=function(){L(10)};b.createPeon.iconID=187;b.sameSpeed=function(){G(999999999,44444)};b.sameSpeed.iconID=82;b.restoreSpeed=function(){G(999999999,44444)};b.restoreSpeed.iconID=88;b.createSpy=function(){L(2)};b.createSpy.iconID=162;b.emergeAllUnits=function(){A[ba[0]].inventory.slice(0);G(999999999,44444)};b.emergeAllUnits.iconID=261;b.techFeudalism=function(){E(12)};b.techFeudalism.iconID=
233;b.techArchitecture=function(){E(13)};b.techArchitecture.iconID=226;b.techLearning=function(){E(14)};b.techLearning.iconID=129;b.createPeon1=function(){L(64)};b.createPeon1.iconID=55;b.createPeon2=function(){L(79)};b.createPeon2.iconID=132;b.createNinja=function(){L(65)};b.createNinja.iconID=51;b.techArmoredChariot=function(){E(51)};b.techArmoredChariot.iconID=79;b.techBuddhism=function(){E(45)};b.techBuddhism.iconID=127;b.techGreatWall=function(){E(48)};b.techGreatWall.iconID=80;b.ridingHorses=
function(){E(49)};b.ridingHorses.iconID=64;b.irrigation=function(){E(50)};b.irrigation.iconID=72;b.createHorseArcher2=function(){L(85)};b.createHorseArcher2.iconID=52;b.techMeditation=function(){E(52)};b.techMeditation.iconID=71;b.techKungFu=function(){E(53)};b.techKungFu.iconID=228;b.techTournaments=function(){E(54)};b.techTournaments.iconID=73;b.techPhilosophy=function(){E(55)};b.techPhilosophy.iconID=68;b.techNinjas=function(){E(56)};b.techNinjas.iconID=56;b.techMastery=function(){E(57)};b.techMastery.iconID=
69;b.techGoldMining=function(){E(1)};b.techGoldMining.iconID=58;b.techStoneMining=function(){E(2)};b.techStoneMining.iconID=57;b.createCrusaders=function(){G(999999999,44444)};b.createCrusaders.iconID=221;b.techFanaticism=function(){E(31)};b.techFanaticism.iconID=235;b.techCrusade=function(){E(32)};b.techCrusade.iconID=93;b.techEspionage=function(){E(30)};b.techEspionage.iconID=215;b.techInquisition=function(){E(33)};b.techInquisition.iconID=97;b.techHealing=function(){E(34)};b.techHealing.iconID=
219;b.healing=function(){};b.healing.iconID=219;b.healing.iconIDbook=201;b.teach=function(){};b.teach.iconID=23;b.teach.iconIDbook=217;b.techBless=function(){E(36)};b.techBless.iconID=159;b.bless=function(){};b.bless.iconID=159;b.bless.iconIDbook=204;b.techMedicine=function(){E(35)};b.techMedicine.iconID=220;b.createMage=function(){L(5)};b.createMage.iconID=156;b.techBat=function(){E(38)};b.techBat.iconID=168;b.techGolem=function(){E(41)};b.techGolem.iconID=119;b.techInvisibility=function(){E(37)};
b.techInvisibility.iconID=217;b.techLightning=function(){E(40)};b.techLightning.iconID=143;b.techFreeze=function(){E(39)};b.techFreeze.iconID=130;b.techHeroism=function(){E(22)};b.techHeroism.iconID=136;b.techWarfare=function(){E(23)};b.techWarfare.iconID=108;b.techTactics=function(){E(24)};b.techTactics.iconID=257;b.techMercenaries=function(){E(25)};b.techMercenaries.iconID=95;b.techHeroes=function(){E(26)};b.techHeroes.iconID=96;b.techFame=function(){E(27)};b.techFame.iconID=111;b.techSiegeTactics=
function(){E(28)};b.techSiegeTactics.iconID=258;b.techBodyBuilding=function(){E(29)};b.techBodyBuilding.iconID=101;b.createPriest=function(){L(9)};b.createPriest.iconID=155;b.createCow=function(){L(27)};b.createCow.iconID=163;b.techCropRotation=function(){E(8)};b.techCropRotation.iconID=227;b.techDomestication=function(){E(7)};b.techDomestication.iconID=157;b.techMapMaking=function(){E(16)};b.techMapMaking.iconID=89;b.techTradeRoutes=function(){E(17)};b.techTradeRoutes.iconID=102;b.techTradeTaxes=
function(){E(18)};b.techTradeTaxes.iconID=110;b.techUsury=function(){E(19)};b.techUsury.iconID=105;b.techSupplyStorage=function(){E(20)};b.techSupplyStorage.iconID=62;b.techBribery=function(){E(21)};b.techBribery.iconID=109;b.bribe=function(){};b.bribe.iconID=128;b.createCaravan=function(){L(61)};b.createCaravan.iconID=169;b.createCaravan2=function(){L(90)};b.createCaravan2.iconID=134;b.createFootman2=function(){L(80)};b.createFootman2.iconID=49;b.createArcher2=function(){L(81)};b.createArcher2.iconID=
43;b.createSatrap=function(){L(83)};b.createSatrap.iconID=116;b.createPikeman2=function(){L(82)};b.createPikeman2.iconID=42;b.createHorseArcher2=function(){L(85)};b.createHorseArcher2.iconID=124;b.createCavalry=function(){L(84)};b.createCavalry.iconID=133;b.createEnichar=function(){L(91)};b.createEnichar.iconID=123;b.createJihad=function(){L(86)};b.createJihad.iconID=236;b.trade=function(){};b.trade.iconID=161;b.unload=function(){};b.unload.iconID=148;b.createMercenaries=function(){};b.createMercenaries.iconID=
95;b.createHeroes=function(){};b.createHeroes.iconID=96;b.upgradeGuildTower=function(){E(42)};b.upgradeGuildTower.iconID=171;b.upgradeStoneTower=function(){E(43)};b.upgradeStoneTower.iconID=178;b.upgradeCannonTower=function(){E(44)};b.upgradeCannonTower.iconID=178;b.createCatapult=function(){L(37)};b.createCatapult.iconID=152;b.createHeavyCatapult=function(){L(39)};b.createHeavyCatapult.iconID=153;b.createBallist=function(){L(38)};b.createBallist.iconID=154;b.techEngineering=function(){E(47)};b.techEngineering.iconID=
92;b.techCannonTower=function(){E(46)};b.techCannonTower.iconID=178;b.techPlateArmor=function(){E(10)};b.techPlateArmor.iconID=131;b.techTemperIron=function(){E(4)};b.techTemperIron.iconID=266;b.techHalberd=function(){E(6)};b.techHalberd.iconID=113;b.techScaleArmor=function(){E(5)};b.techScaleArmor.iconID=251;b.techChainMail=function(){E(9)};b.techChainMail.iconID=252;b.techLongbow=function(){E(0)};b.techLongbow.iconID=259;b.techWoodCutting=function(){E(3)};b.techWoodCutting.iconID=107;b.techCrossbow=
function(){E(11)};b.techCrossbow.iconID=112;b.createFishingBoat=function(){L(74)};b.createFishingBoat.iconID=48;b.createXebec=function(){L(76)};b.createXebec.iconID=166;b.upgradeShip=function(){};b.upgradeShip.iconID=268;b.fishing=function(){};b.fishing.iconID=41;b.createHulk=function(){L(75)};b.createHulk.iconID=165;b.createGalleon=function(){L(73)};b.createGalleon.iconID=164;b.techLandingTactics=function(){};b.techLandingTactics.iconID=98;b.techConcentration=function(){E(58)};b.techConcentration.iconID=
75;b.techConfusion=function(){E(59)};b.techConfusion.iconID=76;b.techWhirlpool=function(){E(60)};b.techWhirlpool.iconID=78;b.techDragon=function(){E(61)};b.techDragon.iconID=115;b.techTurnToStone=function(){E(62)};b.techTurnToStone.iconID=77;b.techFlameBolt=function(){E(63)};b.techFlameBolt.iconID=25;b.techJewelry=function(){E(64)};b.techJewelry.iconID=230;b.techBanking=function(){E(65)};b.techBanking.iconID=74;b.techChemistry=function(){E(66)};b.techChemistry.iconID=225;b.techSeaFood=function(){E(67)};
b.techSeaFood.iconID=67;b.techGunPowder=function(){E(68)};b.techGunPowder.iconID=212;b.techRocketArrow=function(){E(69)};b.techRocketArrow.iconID=47;b.techBushido=function(){E(70)};b.techBushido.iconID=60;b.techLeadership=function(){E(71)};b.techLeadership.iconID=114;b.techHonor=function(){E(72)};b.techHonor.iconID=94;b.techSunTzu=function(){E(73)};b.techSunTzu.iconID=66;b.createRonin=function(){L(66)};b.createRonin.iconID=54;b.createArcher1=function(){L(67)};b.createArcher1.iconID=53;b.createSamurai=
function(){L(68)};b.createSamurai.iconID=122;b.createHorseArcher1=function(){L(69)};b.createHorseArcher1.iconID=52;b.createMonk=function(){L(128)};b.createMonk.iconID=45;b.createMage1=function(){L(129)};b.createMage1.iconID=50;b.createPriest1=function(){L(127)};b.createPriest1.iconID=44;b.createPriest2=function(){L(87)};b.createPriest2.iconID=125;b.buyItems=function(){};b.buyItems.iconID=31;b.sellItems=function(){};b.sellItems.iconID=30;b.createHorseSamurai=function(){L(70)};b.createHorseSamurai.iconID=
121;b.createChariot=function(){L(72)};b.createChariot.iconID=79;b.stopTech=function(){G(999999999,44444)};b.stopTech.iconID=160;b.repair=function(){};b.repair.iconID=145;b.conquest=function(){};b.conquest.iconID=249;b.dcm=function(){};b.dcm.iconID=260;b.buildBarrack=function(){R(14)};b.buildBarrack.iconID=205;b.buildBarrack1=function(){R(71)};b.buildBarrack1.iconID=205;b.buildBarrack2=function(){R(102)};b.buildBarrack2.iconID=205;b.buildTower=function(){R(32)};b.buildTower.iconID=170;b.buildStorage=
function(){R(18)};b.buildStorage.iconID=200;b.buildLumbermill=function(){R(15)};b.buildLumbermill.iconID=199;b.buildLumbermill2=function(){R(93)};b.buildLumbermill2.iconID=199;b.buildFields=function(){R(20)};b.buildFields.iconID=265;b.buildCastle=function(){R(12)};b.buildCastle.iconID=206;b.buildCastle1=function(){R(62)};b.buildCastle1.iconID=206;b.buildCastle2=function(){R(63)};b.buildCastle2.iconID=206;b.buildAcademy=function(){R(17)};b.buildAcademy.iconID=204;b.buildCathedral=function(){R(11)};
b.buildCathedral.iconID=191;b.buildCathedral2=function(){R(106)};b.buildCathedral2.iconID=189;b.buildMerchands=function(){R(24)};b.buildMerchands.iconID=198;b.buildMerchands2=function(){R(108)};b.buildMerchands2.iconID=198;b.buildChurch=function(){R(25)};b.buildChurch.iconID=197;b.buildMarket=function(){R(33)};b.buildMarket.iconID=194;b.buildMageTower=function(){R(16)};b.buildMageTower.iconID=192;b.buildMageTower2=function(){R(107)};b.buildMageTower2.iconID=192;b.buildDummy=function(){R(36)};b.buildDummy.iconID=
65;b.buildFarm=function(){R(23)};b.buildFarm.iconID=193;b.buildBlacksmith=function(){R(26)};b.buildBlacksmith.iconID=202;b.buildWorkshop=function(){R(29)};b.buildWorkshop.iconID=201;b.buildWorkshop2=function(){R(98)};b.buildWorkshop2.iconID=201;b.buildStable=function(){R(28)};b.buildStable.iconID=196;b.buildStable2=function(){R(103)};b.buildStable2.iconID=196;b.buildTavern=function(){R(30)};b.buildTavern.iconID=208;b.buildHouse=function(){R(31)};b.buildHouse.iconID=195;b.buildHarbor=function(){R(41)};
b.buildHarbor.iconID=188;b.buildOutpost=function(){R(34)};b.buildOutpost.iconID=158;b.buildWoodWall=function(){R(13)};b.buildWoodWall.iconID=210;b.buildWoodGate=function(){};b.buildWoodGate.iconID=209;b.buildWoodGate.disabled=2;b.buildBridge=function(){R(35)};b.buildBridge.iconID=176;b.freeze=function(){};b.freeze.iconID=99;b.freeze.obj={name:t.freeze};b.freeze.iconIDbook=205;b.confusion=function(){};b.confusion.iconID=76;b.confusion.obj={name:"Confusion",spcost:[120,0,0,0]};b.confusion.iconIDbook=
206;b.turnToStone=function(){};b.turnToStone.iconID=77;b.turnToStone.iconIDbook=213;b.turnToStone.obj={name:"Turn to Stone",spcost:[40,0,0,0]};b.whirlpool=function(){};b.whirlpool.iconID=78;b.whirlpool.iconIDbook=214;b.whirlpool.obj={name:"Whirlpool",spcost:[80,0,0,0]};b.flameBolt=function(){};b.flameBolt.iconID=25;b.flameBolt.obj={name:"Flame Bolt",spcost:[120,0,0,0]};b.flameBolt.iconIDbook=216;b.createDragon=function(){};b.createDragon.iconID=115;b.createDragon.obj={name:"Spawn Dragon",spcost:[320,
0,0,0]};b.createDragon.iconIDbook=215;b.lightning=function(){};b.lightning.iconID=263;b.lightning.obj={name:t.lightning,spcost:[80,0,0,0]};b.lightning.iconIDbook=200;b.createBat=function(){};b.createBat.iconID=168;b.createBat.iconIDbook=203;b.createGolem=function(){};b.createGolem.iconID=119;b.createGolem.iconIDbook=209;b.autoInvisibility=function(){};b.autoInvisibility.iconID=217;b.autoInvisibility.obj={name:t.invisibility};b.invisibility=function(){};b.invisibility.iconID=217;b.invisibility.iconIDbook=
208;b.impersonate=function(){};b.impersonate.iconID=32;b.impersonate.obj={name:"Impersonate"};b.revealSelf=function(){G(999999999,44444)};b.revealSelf.iconID=33;b.revealSelf.obj={name:"Reveal your true self"};b.buildHouse1=function(){R(111)};b.buildHouse1.iconID=195;b.buildHouse2=function(){R(92)};b.buildHouse2.iconID=195;b.buildLumbermill1=function(){R(112)};b.buildLumbermill1.iconID=199;b.buildStorage1=function(){R(113)};b.buildStorage1.iconID=200;b.buildStorage2=function(){R(94)};b.buildStorage2.iconID=
200;b.buildFarm1=function(){R(114)};b.buildFarm1.iconID=193;b.buildFarm2=function(){R(95)};b.buildFarm2.iconID=193;b.buildHarbor1=function(){R(115)};b.buildHarbor1.iconID=188;b.buildHarbor2=function(){R(96)};b.buildHarbor2.iconID=188;b.buildBlacksmith1=function(){R(116)};b.buildBlacksmith1.iconID=202;b.buildBlacksmith2=function(){R(97)};b.buildBlacksmith2.iconID=202;b.buildWorkshop1=function(){R(117)};b.buildWorkshop1.iconID=201;b.buildChurch1=function(){R(118)};b.buildChurch1.iconID=197;b.buildChurch2=
function(){R(99)};b.buildChurch2.iconID=197;b.buildTavern1=function(){R(119)};b.buildTavern1.iconID=208;b.buildTavern2=function(){R(100)};b.buildTavern2.iconID=208;b.buildMarket1=function(){R(120)};b.buildMarket1.iconID=194;b.buildMarket2=function(){R(101)};b.buildMarket2.iconID=194;b.buildStable1=function(){R(121)};b.buildStable1.iconID=196;b.buildOutpost1=function(){R(122)};b.buildOutpost1.iconID=158;b.buildOutpost2=function(){R(104)};b.buildOutpost2.iconID=158;b.buildCathedral1=function(){R(123)};
b.buildCathedral1.iconID=190;b.buildMageTower1=function(){R(124)};b.buildMageTower1.iconID=192;b.createObjects=function(){uh("magicworkshopmenu",dk)};b.createObjects.iconID=20;b.createObjects.obj={};b.buildMagicWorkshop=function(){R(110)};b.buildMagicWorkshop.iconID=46;b.buildMerchands1=function(){R(125)};b.buildMerchands1.iconID=198;b.buildAcademy1=function(){R(126)};b.buildAcademy1.iconID=204;b.buildAcademy2=function(){R(109)};b.buildAcademy2.iconID=204;b.buildRocketTower=function(){R(57)};b.buildRocketTower.iconID=
47;b.murder=function(){};b.murder.iconID=28;b.convertJihad=function(){G(999999999,44444)};b.convertJihad.iconID=236;b.convertJihad.obj={};b.menuCommonBuild2=function(){};b.menuCommonBuild2.iconID=17;Wf=[b.buildFarm2,b.buildBlacksmith2,b.buildWorkshop2,b.buildStable2,b.buildTavern2,b.buildHouse2];Wf.menuName="a_build";b.menuCommonBuild2.xtra=Wf;b.menuSpecialBuild2=function(){};b.menuSpecialBuild2.iconID=15;Xf=[b.buildCastle2,b.buildAcademy2,b.buildCathedral2,b.buildMerchands2,b.buildChurch2,b.buildMarket2,
b.buildMageTower2,b.buildMagicWorkshop];Xf.menuName="a_build";b.menuSpecialBuild2.xtra=Xf;b.menuOtherBuild2=function(){};b.menuOtherBuild2.iconID=16;Yf=[b.buildHarbor2,b.buildOutpost2,b.buildWoodWall,b.buildWoodGate,b.buildBridge];Yf.menuName="e_build";b.menuOtherBuild2.xtra=Yf;b.menuBuilds2=function(){};b.menuBuilds2.iconID=245;Zf=[b.menuSpecialBuild2,b.menuCommonBuild2,b.menuOtherBuild2,b.buildBarrack2,b.buildTower,b.buildStorage2,b.buildLumbermill2,b.buildFields];Zf.menuName="a_build";b.menuBuilds2.xtra=
Zf;b.origin=Qk;b.origin.iconID=255;b.createCarpet=function(){};b.createCarpet.iconID=146;b.createCarpet.iconIDbook=202;b.createJinn=function(){};b.createJinn.iconID=118;b.createJinn.iconIDbook=218;b.magicVision=function(){};b.magicVision.iconID=223;b.magicVision.iconIDbook=210;b.fireRain=function(){};b.fireRain.iconID=264;b.fireRain.iconIDbook=199;b.raiseDead=function(){};b.raiseDead.iconID=87;b.raiseDead.iconIDbook=211;b.createMage2=function(){L(89)};b.createMage2.iconID=126;b.techCowPoaching=function(){E(74)};
b.techCowPoaching.iconID=85;b.techHorseManShip=function(){E(75)};b.techHorseManShip.iconID=231;b.techScimitar=function(){E(76)};b.techScimitar.iconID=84;b.techJihad=function(){E(77)};b.techJihad.iconID=236;b.techCarpet=function(){E(78)};b.techCarpet.iconID=146;b.techMagicWorkshop=function(){E(79)};b.techMagicWorkshop.iconID=86;b.techFireRain=function(){E(80)};b.techFireRain.iconID=264;b.techMagicVision=function(){E(81)};b.techMagicVision.iconID=224;b.techNecromancy=function(){E(82)};b.techNecromancy.iconID=
87;b.techJinn=function(){E(83)};b.techJinn.iconID=118;b.techOreFloatation=function(){E(84)};b.techOreFloatation.iconID=106;b.techRiddingHorses=function(){E(85)};b.techRiddingHorses.iconID=232;b.techJanissary=function(){E(86)};b.techJanissary.iconID=81;b.buildMagicItems=function(){};b.buildMagicItems.iconID=20;b.techSlavery=function(){E(87)};b.techSlavery.iconID=135;b.stopBuilding=function(){G(999999999,44444)};b.stopBuilding.iconID=160;b.menuSpecialBuild1=function(){};b.menuSpecialBuild1.iconID=15;
Of=[b.buildCastle1,b.buildAcademy1,b.buildCathedral1,b.buildMerchands1,b.buildChurch1,b.buildMarket1,b.buildMageTower1,b.buildRocketTower,b.buildDummy];Of.menuName="a_build";b.menuSpecialBuild1.xtra=Of;b.menuCommonBuild1=function(){};b.menuCommonBuild1.iconID=17;Pf=[b.buildFarm1,b.buildBlacksmith1,b.buildWorkshop1,b.buildStable1,b.buildTavern1,b.buildHouse1];Pf.menuName="a_build";b.menuCommonBuild1.xtra=Pf;b.menuSpecialBuild=function(){};b.menuSpecialBuild.iconID=15;Qf=[b.buildCastle,b.buildAcademy,
b.buildCathedral,b.buildMerchands,b.buildChurch,b.buildMarket,b.buildMageTower,b.buildDummy];Qf.menuName="e_build";b.menuSpecialBuild.xtra=Qf;b.menuCommonBuild=function(){};b.menuCommonBuild.iconID=17;Rf=[b.buildFarm,b.buildBlacksmith,b.buildWorkshop,b.buildStable,b.buildTavern,b.buildHouse];Rf.menuName="e_build";b.menuCommonBuild.xtra=Rf;b.menuOtherBuild=function(){};b.menuOtherBuild.iconID=16;Sf=[b.buildHarbor,b.buildOutpost,b.buildWoodWall,b.buildWoodGate,b.buildBridge];Sf.menuName="e_build";b.menuOtherBuild.xtra=
Sf;b.menuOtherBuild1=function(){};b.menuOtherBuild1.iconID=16;Tf=[b.buildHarbor1,b.buildOutpost1,b.buildWoodWall,b.buildWoodGate,b.buildBridge];Tf.menuName="e_build";b.menuOtherBuild1.xtra=Tf;b.menuBuilds=function(){};Uf=[b.menuSpecialBuild,b.menuCommonBuild,b.menuOtherBuild,b.buildBarrack,b.buildTower,b.buildStorage,b.buildLumbermill,b.buildFields];Uf.menuName="e_build";b.menuBuilds.iconID=245;b.menuBuilds.xtra=Uf;b.menuBuilds1=function(){};b.menuBuilds1.iconID=245;Vf=[b.menuSpecialBuild1,b.menuCommonBuild1,
b.menuOtherBuild1,b.buildBarrack1,b.buildTower,b.buildStorage1,b.buildLumbermill1,b.buildFields];Vf.menuName="a_build";b.menuBuilds1.xtra=Vf;Ik=function(){b.fishing.obj={};b.impersonate.obj={};b.techGreatWall.obj=D[48];b.revealSelf.obj={};b.trade.obj={};b.unload.obj={};b.mercFootman6.obj={};b.murder.obj={};b.mercArcher6.obj={};b.mercMaceman6.obj={};b.mercPikeman6.obj={};b.mercLongbowman6.obj={};b.sameSpeed.obj={name:"Same speed"};b.restoreSpeed.obj={name:"Restore speed"};b.mercKnight6.obj={};b.attackGround.obj=
{};b.steady.obj={};b.bribe.obj={};b.createPriest1.obj=z[127];b.createPriest2.obj=z[87];b.createFootman2.obj=z[80];b.createArcher2.obj=z[81];b.createSatrap.obj=z[83];b.createPikeman2.obj=z[82];b.createHorseArcher2.obj=z[85];b.createCavalry.obj=z[84];b.createEnichar.obj=z[91];b.createJihad.obj=z[86];b.createMonk.obj=z[128];b.healing.obj={name:t.heal,spcost:[20,0,0,0]};b.bless.obj={name:t.bless,spcost:[20,0,0,0]};b.stopTech.obj={};b.conquest.obj={};b.dcm.obj={name:t.dcm};b.repair.obj={name:t.repair};
b.menuOtherBuild.obj={};b.menuOtherBuild1.obj={};b.menuOtherBuild2.obj={};b.sellItems.obj={};b.buyItems.obj={};b.menuBuilds.obj={name:t.menuBuild};b.menuCommonBuild.obj={};b.menuSpecialBuild.obj={};b.techMastery.obj=D[57];b.techNinjas.obj=D[56];b.teach.obj={name:"Teach",spcost:[20,0,0,0]};b.techPhilosophy.obj=D[55];b.techKungFu.obj=D[53];b.techTournaments.obj=D[54];b.techMeditation.obj=D[52];b.menuCommonBuild1.obj={};b.menuCommonBuild2.obj={};b.createMage1.obj=z[129];b.menuSpecialBuild1.obj={};b.menuSpecialBuild2.obj=
{};b.menuBuilds1.obj={name:t.menuBuild};b.menuBuilds2.obj={name:t.menuBuild};b.stopBuilding.obj={};b.freeze.obj={name:t.freeze,spcost:[200,0,0,0]};b.invisibility.obj={name:t.invisibility,spcost:[40,0,0,0]};b.autoInvisibility.obj={name:t.invisibility};b.createHeroes.obj={};b.createMercenaries.obj={};b.upgradeShip.obj={};b.techMedicine.obj=D[35];b.techBless.obj=D[36];b.buildHouse1.obj=z[111];b.techHealing.obj=D[34];b.techInquisition.obj=D[33];b.techArmoredChariot.obj=D[51];b.techRocketArrow.obj=D[69];
b.techJewelry.obj=D[64];b.techGunPowder.obj=D[68];b.techSeaFood.obj=D[67];b.techChemistry.obj=D[66];b.techBanking.obj=D[65];b.createMage.obj=z[5];b.techBat.obj=D[38];b.techGolem.obj=D[41];b.techInvisibility.obj=D[37];b.techLightning.obj=D[40];b.techFreeze.obj=D[39];b.techHeroism.obj=D[22];b.createHorseSamurai.obj=z[70];b.createChariot.obj=z[72];b.createHorseArcher1.obj=z[69];b.createHorseArcher2.obj=z[85];b.createSamurai.obj=z[68];b.createArcher1.obj=z[67];b.techConfusion.obj=D[59];b.techConcentration.obj=
D[58];b.techWhirlpool.obj=D[60];b.techDragon.obj=D[61];b.techTurnToStone.obj=D[62];b.techFlameBolt.obj=D[63];b.createRonin.obj=z[66];b.buildStorage.obj=z[18];b.buildStorage1.obj=z[113];b.buildStorage2.obj=z[94];b.buildFields.obj=z[20];b.buildLumbermill.obj=z[15];b.buildLumbermill1.obj=z[112];b.buildLumbermill2.obj=z[93];b.buildTower.obj=z[32];b.buildBarrack1.obj=z[71];b.buildBarrack.obj=z[14];b.buildBarrack2.obj=z[102];b.buildDummy.obj=z[36];b.buildRocketTower.obj=z[57];b.buildMageTower.obj=z[16];
b.buildMageTower1.obj=z[124];b.buildMageTower2.obj=z[107];b.buildMarket.obj=z[33];b.buildMarket1.obj=z[120];b.buildMarket2.obj=z[101];b.buildChurch.obj=z[25];b.buildChurch1.obj=z[118];b.buildChurch2.obj=z[99];b.buildMerchands.obj=z[24];b.irrigation.obj=D[50];b.ridingHorses.obj=D[49];b.buildMerchands1.obj=z[125];b.buildMerchands2.obj=z[108];b.buildCathedral.obj=z[11];b.buildCathedral1.obj=z[123];b.buildCathedral2.obj=z[106];b.buildAcademy.obj=z[17];b.buildAcademy1.obj=z[126];b.buildAcademy2.obj=z[109];
b.buildCastle.obj=z[12];b.magicVision.obj={name:"Magic Vision",spcost:[20,0,0,0]};b.fireRain.obj={name:"Fire Rain",spcost:[200,0,0,0]};b.raiseDead.obj={name:"Raise the Dead",spcost:[40,0,0,0]};b.createJinn.obj={name:"Spawn Jinn",spcost:[320,0,0,0]};b.createCarpet.obj={name:"Spawn Magic Carpet",spcost:[320,0,0,0]};b.buildCastle1.obj=z[62];b.buildCastle2.obj=z[63];b.buildHouse.obj=z[31];b.buildHouse2.obj=z[92];b.buildTavern.obj=z[30];b.buildTavern1.obj=z[119];b.buildTavern2.obj=z[100];b.buildStable.obj=
z[28];b.buildStable1.obj=z[121];b.buildStable2.obj=z[103];b.buildFarm.obj=z[23];b.buildFarm1.obj=z[114];b.buildFarm2.obj=z[95];b.buildWorkshop.obj=z[29];b.buildWorkshop1.obj=z[117];b.buildWorkshop2.obj=z[98];b.buildBlacksmith.obj=z[26];b.buildBlacksmith1.obj=z[116];b.buildBlacksmith2.obj=z[97];b.buildBridge.obj=z[35];b.buildHarbor.obj=z[41];b.buildHarbor1.obj=z[115];b.buildHarbor2.obj=z[96];b.createMage2.obj=z[89];b.buildMagicItems.obj={};b.techJanissary.obj=D[86];b.techRiddingHorses.obj=D[85];b.techOreFloatation.obj=
D[84];b.techJinn.obj=D[83];b.techNecromancy.obj=D[82];b.techMagicVision.obj=D[81];b.techFireRain.obj=D[80];b.techMagicWorkshop.obj=D[79];b.techCarpet.obj=D[78];b.techJihad.obj=D[77];b.techScimitar.obj=D[76];b.techHorseManShip.obj=D[75];b.techCowPoaching.obj=D[74];b.buildWoodGate.obj={};b.buildWoodWall.obj=z[13];b.buildOutpost.obj=z[34];b.buildOutpost1.obj=z[122];b.buildOutpost2.obj=z[104];b.createGolem.obj={name:"Spawn Stone Golem",spcost:[480,0,0,0]};b.techSunTzu.obj=D[73];b.techBushido.obj=D[70];
b.techLeadership.obj=D[71];b.techHonor.obj=D[72];b.createBat.obj={name:"Spawn Bat",spcost:[40,0,0,0]};b.techGoldMining.obj=D[1];b.techStoneMining.obj=D[2];b.emergeAllUnits.obj={};b.origin.obj={name:"Origin"};b.createOrk.obj=z[58];b.createDwarf.obj=z[59];b.createSkeleton.obj=z[60];b.createGhost.obj=z[40];b.createFootman.obj=z[0];b.createArcher.obj=z[4];b.techSlavery.obj=D[87];b.createMaceman.obj=z[3];b.createPikeman.obj=z[1];b.createLongbowman.obj=z[6];b.createKnight.obj=z[19];b.mercFootman.obj=f;
b.mercArcher.obj=f;b.mercMaceman.obj=f;b.mercPikeman.obj=f;b.mercLongbowman.obj=f;b.mercKnight.obj=f;b.createPeon.obj=z[10];b.createSpy.obj=z[2];b.techFeudalism.obj=D[12];b.techArchitecture.obj=D[13];b.techLearning.obj=D[14];b.createPeon1.obj=z[64];b.createPeon2.obj=z[79];b.createNinja.obj=z[65];b.techBuddhism.obj=D[45];b.createCrusaders.obj={name:"Preach a crusade",cost:[1E3,0,2E3,0]};b.buildMagicWorkshop.obj=z[110];b.techFanaticism.obj=D[31];b.techCrusade.obj=D[32];b.techEspionage.obj=D[30];b.techChainMail.obj=
D[9];b.techHalberd.obj=D[6];b.techLongbow.obj=D[0];b.techScaleArmor.obj=D[5];b.techTemperIron.obj=D[4];b.techPlateArmor.obj=D[10];b.techLandingTactics.obj={};b.createGalleon.obj=z[73];b.createHulk.obj=z[75];b.createXebec.obj=z[76];b.createFishingBoat.obj=z[74];b.techCrossbow.obj=D[11];b.techWoodCutting.obj=D[3];b.techCannonTower.obj=D[46];b.techEngineering.obj=D[47];b.createBallist.obj=z[38];b.createHeavyCatapult.obj=z[39];b.createCatapult.obj=z[37];b.upgradeCannonTower.obj=D[44];b.upgradeStoneTower.obj=
D[43];b.upgradeGuildTower.obj=D[42];b.createCaravan.obj=z[61];b.createCaravan2.obj=z[90];b.techBribery.obj=D[21];b.techSupplyStorage.obj=D[20];b.techUsury.obj=D[19];b.techCropRotation.obj=D[8];b.createCow.obj=z[27];b.techDomestication.obj=D[7];b.techTradeTaxes.obj=D[18];b.techTradeRoutes.obj=D[17];b.techMapMaking.obj=D[16];b.createPriest.obj=z[9];b.techBodyBuilding.obj=D[29];b.techSiegeTactics.obj=D[28];b.techFame.obj=D[27];b.techHeroes.obj=D[26];b.techMercenaries.obj=D[25];b.techTactics.obj=D[24];
b.techWarfare.obj=D[23];for(var c=Object.keys(b),e=0,d=c.length;e<d;e++){var g=b[c[e]];g.id=e;g.objName=c[e];g.obj&&(g.obj.nu=g)}}},fg=function(b,c){var e=c.length,d=b.length,f=0;a:for(;f<e;f++){for(var h=0;h<d;h++)if(c[f+h]!==b[h])continue a;return f}return!1},tl=function(b){for(var c=b.length,e=new Uint16Array(b.length),d=0;d<c;d++)e[d]=b.charCodeAt(d);return e},dc=function(b,c){return fg(tl(b),c)+b.length},gg=function(b,c){b+=String.fromCharCode(0);return fg(tl(b),c)},Yh=function(b,c,e){var d=
"";for(c+=b;b<c&&e[b];b++)d+=String.fromCharCode(e[b]);return d},qe=function(b){b=new Uint8Array(b);var c=fg([50,109,122,116],b)+6,e=b[c]+256*b[c+1],d=b[c+2]+(b[c+3]<<8)+(b[c+4]<<16);G("mapx:",e,"units",d);G("header",b[dc(".header",b)],"description",b[dc(".description",b)],"kingdominfo",b[dc(".kingdominfo",b)],"diplomacy",b[dc(".diplomacy",b)],"forbidden.upgrades",b[dc(".forbidden.upgrades",b)],"tiles",b[dc(".tiles",b)]);G(b);c=2*e;e={mapx:e,mapy:e,arje:!1};var f="utype xx56 xx2 xx562 type xx3 xxtra x32 y32 kingdom race id d health maxHealth attack defence xx8 level xx9 resistance xx11 mana xx12".split(" "),
h="utype xx56 xx2 xx562 type xx3 xxtra x32 y32 kingdom race id d health maxHealth attack defence xx8 level xx9 resistance xx11 mana xx12 xx13 xx14 xx15 xx16 xx17 xx18 xx19 xx20 xx21 resource".split(" "),k=c/2,l=20480+2*k*k,m={};k=0;for(var n=b.length;k<n;k++){var r=b[k];m[r]||(m[r]=[]);m[r].push(k)}m=[];var t={56:!0,58:!0,88:!0,72:!0};k=l+1;for(n=b.length;k<n;k++)if(r=b[k],t[r]&&t[b[k+4]]){l={};r=72!==r?f:h;for(var v=k-2,w=0,x=r.length;w<x;w++){var y=r[w];"kingdom"==y||"race"==y?(l[y]=b[v],v++):(l[y]=
b[v]+256*b[v+1],v+=2)}k+=2*x-3;m.push(l)}e.allunits=m;e.allunits.length>d&&(e.allunits.length=d);d=e.allunits;c/=2;m=[];f=0;t=[];r=l=b[dc(".forbidden.upgrades",b)]+1;k=l*=512;for(h=b.length;k<h;k+=2){w=b[k];v=~~(k/512);for(n=8;n<c&&b[n+k]===(w+n/4)%256;n+=4);20<n&&(k=512*v,1==m.length&&(k=512*(v-(2-(v-r)%2))),n=b.slice(l,k),l-k&&(m[f++]=[l,k],t.push(n)),k+=512,2==m.length&&(k-=512),l=k)}m[f++]=[l,b.length];t={64:[m[0]],96:[m[0]],128:[m[0]],192:[m[1],m[0],m[2],m[3]],256:[m[1],m[0],m[2],m[3]],384:[m[1],
m[0],m[2],m[3],m[4],m[5],m[6]],512:[m[1],m[0],m[2],m[3],m[4],m[5],m[6],m[7],m[8],m[9]]}[c];G(m);m=new Uint8Array(c*c);l=new Uint8Array(c*c);n=f=0;for(r=t.length;n<r;n++)if(h=t[n],f<c*c)for(k=h[0],h=h[1];k<h;k+=2)m[f]=ln[b[k]]||0,l[f]=b[k+1],10<l[f]&&d.push({type:7,d:l[f]%31,x32:f%c,y32:~~(f/c)}),f++;e.terrain=m;d=(c="grass",gg("grass",b))||(c="summer",gg("summer",b))||(c="desert",gg("desert",b))||(c="snow",gg("snow",b));if("summer"==c||c)if("summer"==c||"desert"==c)c="grass";f=Yh(512*(b[dc(".description",
b)]-1),512,b);e.description=f;e.author=Yh(d-64,64,b);e.name=Yh(d-128,64,b);e.terrainType=c;e.kingdoms=qe.getKingdoms(b,e);qe.getDiplomacy(b,e.kingdoms);G(e);return e};qe.getKingdoms=function(b,c){for(var e=fg([192,4],b)+50;!b[e];)e++;var d="name tzar active resGold resStone resFood resWood x6 race x8 x9 x10 x11 x12 x13 x14 AI x16 x17 x18 x19 x20".split(" "),f=d.length,h=[],k,l=[[0,0,189],[206,25,25],[49,181,0],[173,0,197],[255,222,0],[0,181,181],[255,156,33],[90,90,90]];G("kingdoms:",e);c.tr={0:0,
9:0,10:0};for(var m=0;8>m;m++){for(var n={color:l[m]},r=!0,t=0;t<f;t++){var v=d[t];if("name"==v||"tzar"==v){for(n[v]="";!b[e];)e++;for(k=e+32;b[e];)n[v]+=String.fromCharCode(b[e]),e++;e=k}else n[v]=b[e]+(b[e+1]<<8)+(b[e+2]<<16)+(b[e+3]<<24),"race"==v&&(n[v]=b[e],n.racestr=Sj[b[e]-1]),2!=t||b[e]||(r=!1),e+=4}r&&(h.push(n),c.tr[m+1]=h.length);1<h.length&&(n.IA=1);n.resources=[n.resGold,n.resWood,n.resFood,n.resStone];n.race--}G(h);return h};qe.getDiplomacy=function(b,c){for(var e=512*(b[dc(".diplomacy",
b)]-1),d=c.length,f=0;f<d;f++){var h=[0];if(c[f]){c[f].diplomacy=h;for(var k=1;9>k;k++){if(c[k-1]){var l=b[e];l=60>l&&k-1!=f?1:0;h.push(l)}e+=4}}else e+=32}};var ln={0:3,32:0,144:1,240:2,64:2},n="undefined"!==typeof n?n:{},re={},tc;for(tc in n)n.hasOwnProperty(tc)&&(re[tc]=n[tc]);n.arguments=[];n.thisProgram="./this.program";n.quit=function(b,c){throw c;};n.preRun=[];n.postRun=[];var wd=!1,wc=!1,hg=!1,ul=!1;wd="object"===typeof window;wc="function"===typeof importScripts;hg="object"===typeof process&&
"function"===typeof require&&!wd&&!wc;ul=!wd&&!hg&&!wc;var Mb="";if(hg){Mb=__dirname+"/";var Zh,$h;n.read=function(b,c){Zh||(Zh=require("fs"));$h||($h=require("path"));b=$h.normalize(b);b=Zh.readFileSync(b);return c?b:b.toString()};n.readBinary=function(b){b=n.read(b,!0);b.buffer||(b=new Uint8Array(b));mg(b.buffer);return b};1<process.argv.length&&(n.thisProgram=process.argv[1].replace(/\\/g,"/"));n.arguments=process.argv.slice(2);"undefined"!==typeof module&&(module.exports=n);process.on("uncaughtException",
function(b){if(!(b instanceof Wc))throw b;});process.on("unhandledRejection",Pa);n.quit=function(b){process.exit(b)};n.inspect=function(){return"[Emscripten Module object]"}}else if(ul)"undefined"!=typeof read&&(n.read=function(b){return read(b)}),n.readBinary=function(b){if("function"===typeof readbuffer)return new Uint8Array(readbuffer(b));b=read(b,"binary");mg("object"===typeof b);return b},"undefined"!=typeof scriptArgs?n.arguments=scriptArgs:"undefined"!=typeof arguments&&(n.arguments=arguments),
"function"===typeof quit&&(n.quit=function(b){quit(b)});else if(wd||wc)wc?Mb=self.location.href:document.currentScript&&(Mb=document.currentScript.src),Mb=0!==Mb.indexOf("blob:")?Mb.substr(0,Mb.lastIndexOf("/")+1):"",n.read=function(b){var c=new XMLHttpRequest;c.open("GET",b,!1);c.send(null);return c.responseText},wc&&(n.readBinary=function(b){var c=new XMLHttpRequest;c.open("GET",b,!1);c.responseType="arraybuffer";c.send(null);return new Uint8Array(c.response)}),n.readAsync=function(b,c,e){var d=
new XMLHttpRequest;d.open("GET",b,!0);d.responseType="arraybuffer";d.onload=function(){200==d.status||0==d.status&&d.response?c(d.response):e()};d.onerror=e;d.send(null)},n.setWindowTitle=function(b){document.title=b};var wg=n.print||("undefined"!==typeof console?console.log.bind(console):"undefined"!==typeof print?print:null),Nb=n.printErr||("undefined"!==typeof printErr?printErr:"undefined"!==typeof console&&console.warn.bind(console)||wg);for(tc in re)re.hasOwnProperty(tc)&&(n[tc]=re[tc]);re=void 0;
var Ll={"f64-rem":function(b,c){return b%c},"debugger":function(){debugger}},Vc=0;"object"!==typeof WebAssembly&&Nb("no native wasm support detected");var ug=!1,ki="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");var mi,Uc,hb,oi,Oc=n.TOTAL_MEMORY||83886080;5242880>Oc&&Nb("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+Oc+"! (TOTAL_STACK=5242880)");if(n.buffer)var Wa=n.buffer;else{if("object"===typeof WebAssembly&&
"function"===typeof WebAssembly.Memory){var we=new WebAssembly.Memory({initial:Oc/65536});Wa=we.buffer}else Wa=new ArrayBuffer(Oc);n.buffer=Wa}ni();hb[1358368]=10676608;var xi=[],vg=[],Ol=[],wi=[],xe=!1,xc=0,sg=null,xd=null;n.preloadedImages={};n.preloadedAudios={};var ec="a.out.wasm";pi(ec)||(ec=Gl(ec));n.asm=function(b,c,e){c.memory=we;c.table=new WebAssembly.Table({initial:153,maximum:153,element:"anyfunc"});c.__memory_base=1024;c.__table_base=0;return Kl(c)};var Xb=[function(b){Pd(b)},function(){r("magicworkshopmenu").style.display=
"block";fd()},function(b,c,e){a:{for(var d=0,f=$a.length;d<f;d++){var h=$a[d];if(h.superID==e){e=h;break a}}e=void 0}b=new Uint32Array(n.buffer,b,c);e&&e.sendDirectly("channelMessage","nehhof",b)},function(b,c,e,d,g,h,k){ql(b,c,e,d,g,h,k)},function(b,c,e,d,g,h){ql(b,c,e,d,g,h)},function(){rd()},function(b,c,e){bc(b,0,c,e)},function(b){Uh(b)},function(){la("returnmenu");r("oneplayertbody").innerHTML='<tr><td></td><td id="addremove"><button id="addPlayer">+</button><button id="removePlayer">-</button></td><td></td><td></td></tr>';
for(var b=0,c=x.nkingdom()-1;b<c;b++)r("oneplayertbody").innerHTML+='<tr><td class="ucolor1"></td><td class="username1"></td><td class="race1"><button></button></td><td class="team1"><button></button></td></tr>';r("addPlayer").onclick=jn;r("removePlayer").onclick=kn},function(b,c,e,d,g){for(d="#"+d.toString(16);7>d.length;)d+="0";ml[g].style.background=d;fn[g].innerHTML=Jc(Za(b,20));b=hn[g].getElementsByTagName("button")[0];b.iteam=g+1;b.onmousedown=nl;b.innerHTML=c;c=gn[g].getElementsByTagName("button")[0];
c.iteam=g+1;c.onmousedown=ol;c.innerHTML=Ra[e];e=document.createElement("input");e.type="color";e.iteam=g+1;e.value=d;ml[g].appendChild(e);e.onchange=pl},function(){wh()},function(b,c,e,d,g){b=Oa[b];b.style.backgroundPosition=48*g+"px "+48*c+"px";e&&(b.className="");0<d&&(b.innerHTML=d)},function(b,c){b&&(ra.leftButton.className="");8*(b+1)<c&&(ra.rightButton.className="")},function(){Xd()},function(){Mk()},function(){Lk()},function(b,c){ae(b,c)},function(b,c,e){ma.value=c;ma.max=e;mb.innerHTML=c+
"/"+e;ma.style.display="block";r("kingdom").innerHTML=b+" "+t.units;Ah()},function(){id()},function(b,c,e,d){af(b,c,e,d)},function(){Bk()},function(b,c){r("pop").innerHTML=b+"/"+c},function(b,c,e,d,g,h,k,l,m,n,r){cg(b,c,e,d,g,h,k,l,m,n,r)},function(){me()},function(){od()},function(b,c,e){(b=z[b].attackSound)&&b.length&&pa(b[~~(b.length*Math.random())],c,e)},function(b){G(b);Kf(Bh,b);Kf(Ch,b);Kf(Dh,b);Kf(Eh,b)},function(b,c,e){pa(b,c,e)},function(){zc(55)},function(b,c,e,d,g,h){vl(b,c,e,d,g,h)},function(){id()},
function(b,c,e,d,g){var f="<span>";b&&(f+=b+"<img class='resource' src='/nehhon/gold.gif' /> ");c&&(f+=c+"<img class='resource' src='/nehhon/wood.gif' /> ");e&&(f+=e+"<img class='resource' src='/nehhon/food.gif' /> ");d&&(f+=d+"<img class='resource' src='/nehhon/stone.gif' /> ");f+="</span>";g&&(f+="<span class='shotcut'>"+String.fromCharCode(g).toUpperCase()+"</span>");sh.innerHTML=f}];vg.push({func:function(){mn()}});var ab={last:0,caught:[],infos:{},deAdjust:function(b){if(!b||ab.infos[b])return b;
for(var c in ab.infos)for(var e=+c,d=ab.infos[e].adjusted,f=d.length,h=0;h<f;h++)if(d[h]===b)return e;return b},addRef:function(b){b&&ab.infos[b].refcount++},decRef:function(b){if(b){var c=ab.infos[b];mg(0<c.refcount);c.refcount--;0!==c.refcount||c.rethrown||(c.destructor&&n.dynCall_vi(c.destructor,b),delete ab.infos[b],si(b))}},clearRef:function(b){b&&(ab.infos[b].refcount=0)}},Z={buffers:[null,[],[]],printChar:function(b,c){var e=Z.buffers[b];0===c||10===c?((1===b?wg:Nb)(fi(e,0)),e.length=0):e.push(c)},
varargs:0,get:function(b){Z.varargs+=4;return hb[Z.varargs-4>>2]},getStr:function(){var b=Z.get();return b?fi(Uc,b,void 0):""},get64:function(){var b=Z.get();Z.get();return b},getZero:function(){Z.get()}};ti=hg?function(){var b=process.hrtime();return 1E3*b[0]+b[1]/1E6}:"undefined"!==typeof dateNow?dateNow:"object"===typeof self&&self.performance&&"function"===typeof self.performance.now?function(){return self.performance.now()}:"object"===typeof performance&&"function"===typeof performance.now?function(){return performance.now()}:
Date.now;var wl=n.asm({},{abort:Pa,setTempRet0:function(b){Vc=b},getTempRet0:function(){return Vc},__ZSt18uncaught_exceptionv:ri,___cxa_find_matching_catch:yd,___cxa_free_exception:si,___gxx_personality_v0:function(){},___resumeException:function(b){ab.last||(ab.last=b);throw b;},___setErrNo:function(b){n.___errno_location&&(hb[n.___errno_location()>>2]=b);return b},___syscall140:function(b,c){Z.varargs=c;try{var e=Z.getStreamFromFD();Z.get();var d=Z.get(),f=Z.get(),h=Z.get();FS.llseek(e,d,h);hb[f>>
2]=e.position;e.getdents&&0===d&&0===h&&(e.getdents=null);return 0}catch(q){return"undefined"!==typeof FS&&q instanceof FS.ErrnoError||Pa(q),-q.errno}},___syscall146:function(b,c){Z.varargs=c;try{var e=Z.get(),d=Z.get(),f=Z.get();for(c=b=0;c<f;c++){for(var h=hb[d+8*c>>2],k=hb[d+(8*c+4)>>2],l=0;l<k;l++)Z.printChar(e,Uc[h+l]);b+=k}return b}catch(p){return"undefined"!==typeof FS&&p instanceof FS.ErrnoError||Pa(p),-p.errno}},___syscall54:function(b,c){Z.varargs=c;return 0},___syscall6:function(b,c){Z.varargs=
c;try{var e=Z.getStreamFromFD();FS.close(e);return 0}catch(d){return"undefined"!==typeof FS&&d instanceof FS.ErrnoError||Pa(d),-d.errno}},_emscripten_asm_const_i:function(b){return Xb[b]()},_emscripten_asm_const_ii:function(b,c){return Xb[b](c)},_emscripten_asm_const_iii:function(b,c,e){return Xb[b](c,e)},_emscripten_asm_const_iiii:function(b,c,e,d){return Xb[b](c,e,d)},_emscripten_asm_const_iiiii:function(b,c,e,d,g){return Xb[b](c,e,d,g)},_emscripten_asm_const_iiiiii:function(b,c,e,d,g,h){return Xb[b](c,
e,d,g,h)},_emscripten_asm_const_iiiiiii:function(b,c,e,d,g,h,k){return Xb[b](c,e,d,g,h,k)},_emscripten_asm_const_iiiiiiii:function(b,c,e,d,g,h,k,l){return Xb[b](c,e,d,g,h,k,l)},_emscripten_asm_const_iiiiiiiiiiii:function(b,c,e,d,g,h,k,l,m,n,r,t){return Xb[b](c,e,d,g,h,k,l,m,n,r,t)},_emscripten_get_heap_size:function(){return Oc},_emscripten_get_now:ti,_emscripten_memcpy_big:function(b,c,e){Uc.set(Uc.subarray(c,c+e),b)},_emscripten_resize_heap:function(b){if(2147418112<b)return!1;for(var c=Math.max(Oc,
16777216);c<b;)c=536870912>=c?rg(2*c,65536):Math.min(rg((3*c+2147483648)/4,65536),2147418112);var e=ui(c);if(!e||e.byteLength!=c)return!1;n.buffer=Wa=e;ni();Oc=c;oi[1358368]=b;return!0},abortOnCannotGrowMemory:function(b){Pa("OOM")},emscripten_realloc_buffer:ui,flush_NO_FILESYSTEM:function(){var b=n._fflush;b&&b(0);b=Z.buffers;b[1].length&&Z.printChar(1,10);b[2].length&&Z.printChar(2,10)},tempDoublePtr:5433712,DYNAMICTOP_PTR:5433472},Wa);n.asm=wl;var mn=n.__GLOBAL__sub_I_nh_cpp=function(){return n.asm.__GLOBAL__sub_I_nh_cpp.apply(null,
arguments)};n.__Z10Uint8Arrayj=function(){return n.asm.__Z10Uint8Arrayj.apply(null,arguments)};n.__Z10canvasSizejj=function(){return n.asm.__Z10canvasSizejj.apply(null,arguments)};n.__Z10changePagei=function(){return n.asm.__Z10changePagei.apply(null,arguments)};n.__Z10changeRaceji=function(){return n.asm.__Z10changeRaceji.apply(null,arguments)};n.__Z10changeTeamji=function(){return n.asm.__Z10changeTeamji.apply(null,arguments)};n.__Z10checkStockv=function(){return n.asm.__Z10checkStockv.apply(null,
arguments)};n.__Z10gInventoryj=function(){return n.asm.__Z10gInventoryj.apply(null,arguments)};n.__Z10gmaxHealthj=function(){return n.asm.__Z10gmaxHealthj.apply(null,arguments)};n.__Z10mouseEnterj=function(){return n.asm.__Z10mouseEnterj.apply(null,arguments)};n.__Z10movtablexev=function(){return n.asm.__Z10movtablexev.apply(null,arguments)};n.__Z10nameSharedPjS_j=function(){return n.asm.__Z10nameSharedPjS_j.apply(null,arguments)};n.__Z10pidkingdomj=function(){return n.asm.__Z10pidkingdomj.apply(null,
arguments)};n.__Z10searchUnitth=function(){return n.asm.__Z10searchUnitth.apply(null,arguments)};n.__Z10setupOnlIDj=function(){return n.asm.__Z10setupOnlIDj.apply(null,arguments)};n.__Z10shiftONOFFb=function(){return n.asm.__Z10shiftONOFFb.apply(null,arguments)};n.__Z10tempstraddv=function(){return n.asm.__Z10tempstraddv.apply(null,arguments)};n.__Z10unitActionj=function(){return n.asm.__Z10unitActionj.apply(null,arguments)};n.__Z10userConfigj=function(){return n.asm.__Z10userConfigj.apply(null,arguments)};
n.__Z11Uint16Arrayj=function(){return n.asm.__Z11Uint16Arrayj.apply(null,arguments)};n.__Z11Uint32Arrayt=function(){return n.asm.__Z11Uint32Arrayt.apply(null,arguments)};n.__Z11changeColorjj=function(){return n.asm.__Z11changeColorjj.apply(null,arguments)};n.__Z11createItemsv=function(){return n.asm.__Z11createItemsv.apply(null,arguments)};n.__Z11getBufferIDv=function(){return n.asm.__Z11getBufferIDv.apply(null,arguments)};n.__Z11movtableADDjjjj=function(){return n.asm.__Z11movtableADDjjjj.apply(null,
arguments)};n.__Z11setupRandomi=function(){return n.asm.__Z11setupRandomi.apply(null,arguments)};n.__Z11synchroHashv=function(){return n.asm.__Z11synchroHashv.apply(null,arguments)};n.__Z12bufferMarginfffj=function(){return n.asm.__Z12bufferMarginfffj.apply(null,arguments)};n.__Z12deletePlayerj=function(){return n.asm.__Z12deletePlayerj.apply(null,arguments)};n.__Z12executeOrderjj=function(){return n.asm.__Z12executeOrderjj.apply(null,arguments)};n.__Z12setupIMGinfojjjjjjjjjjjjjjjjjjj=function(){return n.asm.__Z12setupIMGinfojjjjjjjjjjjjjjjjjjj.apply(null,
arguments)};n.__Z12setupKingdomjjjjhbjjj=function(){return n.asm.__Z12setupKingdomjjjjhbjjj.apply(null,arguments)};n.__Z12unitObjetivej=function(){return n.asm.__Z12unitObjetivej.apply(null,arguments)};n.__Z13randomTerrainii=function(){return n.asm.__Z13randomTerrainii.apply(null,arguments)};n.__Z13readSavegame0j=function(){return n.asm.__Z13readSavegame0j.apply(null,arguments)};n.__Z13setupOnlTablej=function(){return n.asm.__Z13setupOnlTablej.apply(null,arguments)};n.__Z13sharedDelayIDv=function(){return n.asm.__Z13sharedDelayIDv.apply(null,
arguments)};n.__Z13sharedFloatIDv=function(){return n.asm.__Z13sharedFloatIDv.apply(null,arguments)};n.__Z13startMovementv=function(){return n.asm.__Z13startMovementv.apply(null,arguments)};n.__Z13tempointeraddj=function(){return n.asm.__Z13tempointeraddj.apply(null,arguments)};n.__Z14customMapTablev=function(){return n.asm.__Z14customMapTablev.apply(null,arguments)};n.__Z14finishSavegamev=function(){return n.asm.__Z14finishSavegamev.apply(null,arguments)};n.__Z14onlineKingdomsv=function(){return n.asm.__Z14onlineKingdomsv.apply(null,
arguments)};n.__Z14randomKingdomsi=function(){return n.asm.__Z14randomKingdomsi.apply(null,arguments)};n.__Z14setupResourcesjjjjt=function(){return n.asm.__Z14setupResourcesjjjjt.apply(null,arguments)};n.__Z15configRandomMapv=function(){return n.asm.__Z15configRandomMapv.apply(null,arguments)};n.__Z15getColorTexturev=function(){return n.asm.__Z15getColorTexturev.apply(null,arguments)};n.__Z15setupOnlineGamePjS_j=function(){return n.asm.__Z15setupOnlineGamePjS_j.apply(null,arguments)};n.__Z16setupTranslationjj=
function(){return n.asm.__Z16setupTranslationjj.apply(null,arguments)};n.__Z3rndi=function(){return n.asm.__Z3rndi.apply(null,arguments)};n.__Z4nAIsv=function(){return n.asm.__Z4nAIsv.apply(null,arguments)};n.__Z4testjj=function(){return n.asm.__Z4testjj.apply(null,arguments)};n.__Z5empXYv=function(){return n.asm.__Z5empXYv.apply(null,arguments)};n.__Z5gCvalj=function(){return n.asm.__Z5gCvalj.apply(null,arguments)};n.__Z5gItemj=function(){return n.asm.__Z5gItemj.apply(null,arguments)};n.__Z5gManaj=
function(){return n.asm.__Z5gManaj.apply(null,arguments)};n.__Z5gTypej=function(){return n.asm.__Z5gTypej.apply(null,arguments)};n.__Z5test2jj=function(){return n.asm.__Z5test2jj.apply(null,arguments)};n.__Z5test3jj=function(){return n.asm.__Z5test3jj.apply(null,arguments)};n.__Z6amountv=function(){return n.asm.__Z6amountv.apply(null,arguments)};n.__Z6dbgspdj=function(){return n.asm.__Z6dbgspdj.apply(null,arguments)};n.__Z6gBuildj=function(){return n.asm.__Z6gBuildj.apply(null,arguments)};n.__Z6gcyclev=
function(){return n.asm.__Z6gcyclev.apply(null,arguments)};n.__Z6giTypej=function(){return n.asm.__Z6giTypej.apply(null,arguments)};n.__Z6glevelj=function(){return n.asm.__Z6glevelj.apply(null,arguments)};n.__Z6mapLocv=function(){return n.asm.__Z6mapLocv.apply(null,arguments)};n.__Z6mwMorei=function(){return n.asm.__Z6mwMorei.apply(null,arguments)};n.__Z6mwiconv=function(){return n.asm.__Z6mwiconv.apply(null,arguments)};n.__Z6onlADDjjjjb=function(){return n.asm.__Z6onlADDjjjjb.apply(null,arguments)};
n.__Z6prelddv=function(){return n.asm.__Z6prelddv.apply(null,arguments)};n.__Z6runKeyjb=function(){return n.asm.__Z6runKeyjb.apply(null,arguments)};n.__Z6sndNfov=function(){return n.asm.__Z6sndNfov.apply(null,arguments)};n.__Z6strOnlv=function(){return n.asm.__Z6strOnlv.apply(null,arguments)};n.__Z6trraddv=function(){return n.asm.__Z6trraddv.apply(null,arguments)};n.__Z6unitXFj=function(){return n.asm.__Z6unitXFj.apply(null,arguments)};n.__Z6unitYFj=function(){return n.asm.__Z6unitYFj.apply(null,
arguments)};n.__Z6updownji=function(){return n.asm.__Z6updownji.apply(null,arguments)};n.__Z7IMGdatattttttttttttttttt=function(){return n.asm.__Z7IMGdatattttttttttttttttt.apply(null,arguments)};n.__Z7empNamej=function(){return n.asm.__Z7empNamej.apply(null,arguments)};n.__Z7gAttackj=function(){return n.asm.__Z7gAttackj.apply(null,arguments)};n.__Z7gHelperj=function(){return n.asm.__Z7gHelperj.apply(null,arguments)};n.__Z7gIconIDj=function(){return n.asm.__Z7gIconIDj.apply(null,arguments)};n.__Z7getPagev=
function(){return n.asm.__Z7getPagev.apply(null,arguments)};n.__Z7ghealthj=function(){return n.asm.__Z7ghealthj.apply(null,arguments)};n.__Z7mouseUpiij=function(){return n.asm.__Z7mouseUpiij.apply(null,arguments)};n.__Z7onldataj=function(){return n.asm.__Z7onldataj.apply(null,arguments)};n.__Z7plreadyv=function(){return n.asm.__Z7plreadyv.apply(null,arguments)};n.__Z7readSVGmmb=function(){return n.asm.__Z7readSVGmmb.apply(null,arguments)};n.__Z7setupGLv=function(){return n.asm.__Z7setupGLv.apply(null,
arguments)};n.__Z8atlasLocv=function(){return n.asm.__Z8atlasLocv.apply(null,arguments)};n.__Z8gControlj=function(){return n.asm.__Z8gControlj.apply(null,arguments)};n.__Z8gDefencej=function(){return n.asm.__Z8gDefencej.apply(null,arguments)};n.__Z8gKingdomj=function(){return n.asm.__Z8gKingdomj.apply(null,arguments)};n.__Z8gManaMaxj=function(){return n.asm.__Z8gManaMaxj.apply(null,arguments)};n.__Z8gstartedv=function(){return n.asm.__Z8gstartedv.apply(null,arguments)};n.__Z8liveChatj=function(){return n.asm.__Z8liveChatj.apply(null,
arguments)};n.__Z8mapWidthv=function(){return n.asm.__Z8mapWidthv.apply(null,arguments)};n.__Z8mnameaddv=function(){return n.asm.__Z8mnameaddv.apply(null,arguments)};n.__Z8mwSelectj=function(){return n.asm.__Z8mwSelectj.apply(null,arguments)};n.__Z8mwamounti=function(){return n.asm.__Z8mwamounti.apply(null,arguments)};n.__Z8nkingdomv=function(){return n.asm.__Z8nkingdomv.apply(null,arguments)};n.__Z8onlCountv=function(){return n.asm.__Z8onlCountv.apply(null,arguments)};n.__Z8savegamev=function(){return n.asm.__Z8savegamev.apply(null,
arguments)};n.__Z8shapointv=function(){return n.asm.__Z8shapointv.apply(null,arguments)};n.__Z8userKickj=function(){return n.asm.__Z8userKickj.apply(null,arguments)};n.__Z9boolArrayt=function(){return n.asm.__Z9boolArrayt.apply(null,arguments)};n.__Z9closeRoomv=function(){return n.asm.__Z9closeRoomv.apply(null,arguments)};n.__Z9createMapi=function(){return n.asm.__Z9createMapi.apply(null,arguments)};n.__Z9mouseDowniij=function(){return n.asm.__Z9mouseDowniij.apply(null,arguments)};n.__Z9mouseMoveii=
function(){return n.asm.__Z9mouseMoveii.apply(null,arguments)};n.__Z9onLimits2ii=function(){return n.asm.__Z9onLimits2ii.apply(null,arguments)};n.__Z9randomMapv=function(){return n.asm.__Z9randomMapv.apply(null,arguments)};n.__Z9selectionv=function(){return n.asm.__Z9selectionv.apply(null,arguments)};n.__Z9setupGamejjjjjjjjjjjj=function(){return n.asm.__Z9setupGamejjjjjjjjjjjj.apply(null,arguments)};n.__Z9setupInfojjjjjjjjjjcchhhhhhbbPjhbPbS_hthS_hth=function(){return n.asm.__Z9setupInfojjjjjjjjjjcchhhhhhbbPjhbPbS_hthS_hth.apply(null,
arguments)};n.__Z9setupOdinj=function(){return n.asm.__Z9setupOdinj.apply(null,arguments)};n.__Z9setupZoomf=function(){return n.asm.__Z9setupZoomf.apply(null,arguments)};n.__Z9shareNamej=function(){return n.asm.__Z9shareNamej.apply(null,arguments)};n.___errno_location=function(){return n.asm.___errno_location.apply(null,arguments)};n._emscripten_replace_memory=function(){return n.asm._emscripten_replace_memory.apply(null,arguments)};var Ml=n._free=function(){return n.asm._free.apply(null,arguments)};
n._llvm_bswap_i32=function(){return n.asm._llvm_bswap_i32.apply(null,arguments)};n._main=function(){return n.asm._main.apply(null,arguments)};var Nl=n._malloc=function(){return n.asm._malloc.apply(null,arguments)};n._memcpy=function(){return n.asm._memcpy.apply(null,arguments)};n._memset=function(){return n.asm._memset.apply(null,arguments)};n._sbrk=function(){return n.asm._sbrk.apply(null,arguments)};n.establishStackSpace=function(){return n.asm.establishStackSpace.apply(null,arguments)};var li=
n.stackAlloc=function(){return n.asm.stackAlloc.apply(null,arguments)};n.stackRestore=function(){return n.asm.stackRestore.apply(null,arguments)};n.stackSave=function(){return n.asm.stackSave.apply(null,arguments)};n.dynCall_ii=function(){return n.asm.dynCall_ii.apply(null,arguments)};n.dynCall_iii=function(){return n.asm.dynCall_iii.apply(null,arguments)};n.dynCall_iiii=function(){return n.asm.dynCall_iiii.apply(null,arguments)};n.dynCall_iiiii=function(){return n.asm.dynCall_iiiii.apply(null,arguments)};
n.dynCall_v=function(){return n.asm.dynCall_v.apply(null,arguments)};n.dynCall_vi=function(){return n.asm.dynCall_vi.apply(null,arguments)};n.dynCall_vii=function(){return n.asm.dynCall_vii.apply(null,arguments)};n.dynCall_viii=function(){return n.asm.dynCall_viii.apply(null,arguments)};n.asm=wl;Wc.prototype=Error();Wc.prototype.constructor=Wc;xd=function c(){n.calledRun||tg();n.calledRun||(xd=c)};n.callMain=function(b){b=b||[];xe||(xe=!0,vd(vg));var c=b.length+1,d=li(4*(c+1));hb[d>>2]=te(n.thisProgram);
for(var g=1;g<c;g++)hb[(d>>2)+g]=te(b[g-1]);hb[(d>>2)+c]=0;try{var h=n._main(c,d,0);if(!n.noExitRuntime||0!==h){if(!n.noExitRuntime&&(ug=!0,n.onExit))n.onExit(h);n.quit(h,new Wc(h))}}catch(q){q instanceof Wc||("SimulateInfiniteLoop"==q?n.noExitRuntime=!0:((b=q)&&"object"===typeof q&&q.stack&&(b=[q,q.stack]),Nb("exception thrown: "+b),n.quit(1,q)))}finally{}};n.run=tg;n.abort=Pa;if(n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);0<n.preInit.length;)n.preInit.pop()();var vi=!0;n.noInitialRun&&
(vi=!1);n.noExitRuntime=!0;tg();var pg=!1,x={};ve=Bb;var Nc,ag,Kk,qb,ai=function(){pg=!0;for(var b=n.asm,e=Object.keys(b),d=e.length,g="inspector71017 newUnit radar createMap falseunit synchroHash rnd setupRandom randomTerrain unitMovement test setupInfo setupKingdom shapoint Uint16Array setupTech setupRequirements boolArray AIobjetive test2 searchUnit killUnit investigateTech AIprocess setupResources unitWorking movtablexe test3 unitParameter setupGL bufferColor getBufferID setupIMGinfo atlasLoc randomMap selection gAttack gDefence glevel ghealth gmaxHealth gMana gItem gBuild gKingdom executeOrder shiftONOFF gType IMGdata Uint32Array getColorTexture canvasSize setupZoom setupTranslation mouseDown mouseUp sharedFloatID setupGame mouseMove gCval gManaMax giType setupOdin empXY nkingdom empName changePage gInventory gControl checkStock runKey sharedDelayID amount mwicon mwSelect mwMore mwamount createItems gIconID mouseEnter gHelper startMovement savegame finishSavegame readSavegame0 readSVG customMapTable mapWidth gcycle dbgspd randomKingdoms changeTeam changeRace userConfig onlineKingdoms setupOnlTable onlADD changeColor sndNfo tempointeradd onldata shareName mnameadd configRandomMap strOnl plready setupOnlID preldd nAIs closeRoom onlCount userKick pidkingdom deletePlayer updown tempstradd liveChat gstarted trradd".split(" "),
h=0,m=g.length;h<m;h++)for(var l=g[h],p=0;p<d;p++){var r=e[p];if(-1<r.indexOf(l)){x[g[h]]=b[r];break}}b=x.shapoint();Nc=new Int32Array(n.buffer,b,1024);qb=de(x.sharedFloatID(),5);ag=de(x.sharedFloatID(),3);Kk=de(x.sharedFloatID(),4);Sc(x.userConfig(parseInt(y.color.substr(1),16)),17,y.name||"Guest");k=document.getElementById("tzar").getContext("webgl2");y.gl=!!k;ai.waiting&&od();ve()},Sc=function(b,e,d){b=Za(b,e);for(var c=0;c<e;c++)b[c]=d.charCodeAt(c)},Sm=function(b){for(var c=0,d=b.length;c<d;Nc[c]=
b[c++]);};ai.waiting=!1;n.postRun[0]=ai;var ig=window.indexedDB.open("nehhon"),Pc,bi;ig.onsuccess=function(b){Pc=ig.result;bi&&bi()};ig.onupgradeneeded=function(b){Pc=ig.result;Pc.createObjectStore("maps",{keyPath:"id",autoIncrement:!0});Pc.createObjectStore("mapsBlobs",{keyPath:"id2",autoIncrement:!0})};var xl=function(){Pc?Pc.transaction(["maps"],"readwrite").objectStore("maps").getAll().onsuccess=nn:bi=xl},nn=function(b){b=b.target.result;var c=b.length;if(c){var d=r("mapcache");d.innerHTML='<tr style="font-size:23px"><td>'+
t.mapName+"</td><td>"+t.date+"</td><td>"+t.timePlayed+"</td></tr>";for(--c;-1<c;c--){var g=b[c],h=document.createElement("tr");h.cid=g.id;var k=new Date(g.date),l=k.getHours(),m="0"+k.getMinutes();k.getSeconds();var n=k.getDate(),v=k.getMonth()+1;k=k.getFullYear();l=l+":"+m.substr(-2)+" &nbsp; &nbsp;"+n+"/"+v+"/"+k;h.onclick=ci;h.innerHTML="<td>"+(g.name||"savegame")+"</td><td>"+l+"</td><td>"+Yi(g.played)+"</td>";d.appendChild(h)}G(b)}},ci=function(){var b=this.cid;Pc.transaction(["mapsBlobs"],"readwrite").objectStore("mapsBlobs").get(b).onsuccess=
ci.step2};ci.step2=function(b){b=b.target.result;var c=new FileReader;c.onload=function(b){b=new Uint8Array(b.target.result);b=cl(b,".tzared");la("customMapcont");r("editCustom").style.display="inline-table";r("closeCustom").style.display="inline-table";ea=b;ea.kingdomStart?(r("seeStats").style.display="inline-table",r("playrecord").style.display="inline-table"):(r("seeStats").style.display="none",r("playrecord").style.display="none");null===ea.goldRes&&(ea.goldRes=Infinity);null===ea.stoneRes&&(ea.stoneRes=
Infinity);null===ea.foodRes&&(ea.foodRes=Infinity);null===ea.woodRes&&(ea.woodRes=Infinity);vl();V("maploadlabel");V("mapcache")};c.readAsArrayBuffer(b)};var Og=function(b,e,d,g){if(Sh&&!v.editor){var c=Sh.events.defined[e.id];if(c&&c[d])if(c=c[d],"zone"==d)for(b=0,g=c.length;b<g;b+=5){d=c[b];var k=c[b+2],l=c[b+3],m=c[b+4];e.x32>=c[b+1]&&e.x32<=l&&e.y32>=k&&e.y32<=m?(e.inZone||(e.inZone={}),e.inZone[d.id]||jg([c[b]],1),e.inZone[d.id]=1):e.inZone&&e.inZone[d.id]&&(e.inZone[d.id]=0,jg([c[b]],-1))}else{if(!g)return jg(c,
b);G(g.name);e=c.defined;e[g.id]&&jg(e[g.id],b)}}},jg=function(b,e){for(var c=b.length,g=0;g<c;g++){var h=b[g],k=h.rule,l=h.activeEvents;h.activeEvents+=e;0===l?k.activeEvents++:0===h.activeEvents&&k.activeEvents--;if(1==e&&k.activeEvents==k.events.length)for(h=0,k=k.actions,l=k.length;h<l;h++){var m=k[h];G("action:",m.type);if(yl[m.type])yl[m.type](m.to[0],m.list)}}},yl={attack:kb,move:ac},Ph={start:function(){},func:function(){G(v.arje);if(void 0==v.arje){gb();r("editorRandom").checked?v.arje=555555*
Math.random()+1:v.arje=!1;v.mapx=parseInt(r("editorSize").value);v.mapy=v.mapx;v.goldRes=Infinity;v.foodRes=Infinity;v.woodRes=Infinity;v.stoneRes=Infinity;v.gravity=580.9/9.8*9.8;v.terrainType="grass";qd=[];for(var b=0,e=parseInt(r("editorPlayers").value);b<e;b++){for(var d="#"+(~~(16777216*Math.random())).toString(16);7>d.length;)d+="0";qd[b]={color:d,IA:!1,name:"Tzar "+(b+1),race:0,team:0}}document.body.removeChild(r("mapForm"))}v.editor=1;od()}},$f=function(){var b=r("selectKingdom");b.innerHTML=
"";for(var e=1,d=J.length;e<d;e++){var g=J[e];1===e&&(b.style.background="rgba("+g.color[0]+","+g.color[1]+","+g.color[2]+",1)");b.innerHTML+='<option value="'+e+'" style="background:rgba('+g.color[0]+","+g.color[1]+","+g.color[2]+',1)">'+g.name+"</option>"}},V=function(b){r(b).style.display="none"},la=function(b){r(b).style.display="block"},Qh=function(b){var c=ca;c.img=m.blank;var d=32*sd();c.wh=[d,d];c.active=!0;document.addEventListener("mousemove",zb);document.addEventListener("mousedown",zl);
zb.active=b},zl=function(b){if(2==b.buttons||b.pageX<y.menumx||b.pageY<y.menumy)return Al();zb(b)},kk=function(b){if(v.editor){var c=parseInt(r("brushSize").value)+b;c>r("brushSize").max?r("brushSize").value=r("brushSize").max:1>c?r("brushSize").value=1:(r("brushSize").value=c,ca.wh&&(ca.wh[0]+=32*b,ca.wh[1]+=32*b,ca.active=!0))}},sd=function(){return parseInt(r("brushSize").value)},Rh=function(b,e,d){b=sd();for(var c=b*b,h=H,k=le,l=Rh.active,m=Ad.type,n=0;n<c;n++){var r=e+n%b,t=d+~~(n/b);fa(r,t)&&
(r+=t*h,k[r]=l,m[l]&&(2<Y[r]&&A[Y[r]].die(),2<Ya[r]&&A[Ya[r]].die()))}Mc()},Vm=function(b,e,d){b=sd();for(var c=b*b,h=H,k=0;k<c;k++){var l=e+k%b,m=d+~~(k/b);fa(l,m)&&(0===Y[l+m*h]?.2>Math.random()&&Vg([l+m*h,7,{d:3+~~(28*Math.random())}]):(l=A[Y[l+m*h]],7==l.type&&l.die()))}},Um=function(b,e,d){b=sd();for(var c=b*b,h=H,k=0;k<c;k++){var l=e+k%b,m=d+~~(k/b);fa(l,m)&&(l=A[Y[l+m*h]],7==l.type&&l.die())}},zb=function(b){var c=32*sd();c=Ub(b.pageX-y.mx-.5*c/P,b.pageY-.5*c/P);var d=~~(.03125*c[1]);c=~~(.03125*
c[0]);ca.x=32*c;ca.y=32*d;ca.active=!0;if(0!==b.buttons){if(2==b.buttons)return Al();zb.last!==c+d*H&&zb.active&&zb.active(b,c,d);zb.last=c+d*H}},Al=function(){ca.active=!0;ca.x=-9999;ca.y=-9999;if(zb.active){var b=32*sd();Ub(event.pageX-y.mx-.5*b/P,event.pageY-.5*b/P);zb.active=!1}ca.wh=void 0;document.removeEventListener("mousedown",zl);document.removeEventListener("mousemove",zb)},bk=function(){G(this);this.parentElement.parentElement.style.display="none";gb()},ck={objAction:{id:"edobjAction",
msg:t.objAction,func:function(){sa.active.type="attack";la("selectionEvents");V("eventZone");la("unitListDiv2");r("byButton2").style.display="inline-block";r("byButton1").style.display="inline-block";sa.active.zone=void 0}},objZone:{id:"edobjAction",msg:t.objZone,func:function(){sa.active.type="zone";sa.active.to.length=0;V("selectionEvents");r("eventZone").style.display="inline-block";V("byButton2");V("byButton1");V("unitListDiv2");Bl()}}},gd=function(b){if(b)V("mapRulesWindow"),gb(),gd.actived=
!0;else if(gd.actived){la("mapRulesWindow");vc();b=~~((void 0)[0]/32);var c=~~((void 0)[1]/32),d=~~((void 0)[9]/32),g=~~((void 0)[10]/32);if(b<d)var h=b,k=d;else h=d,k=b;if(c<g)var l=c,m=g;else l=g,m=c;sa.active.zone||(sa.active.zone=[]);sa.active.zone.put([h,l,k,m]);G(b,c,d,g);Bl();gd.actived=!1}},Bl=function(){var b=r("zoneList");b.innerHTML="";var e=sa.active.zone;if(e)for(var d=e.length,g=0;g<d;g++){var h=e[g],k=document.createElement("div"),l=document.createElement("button");l.innerHTML="x";
l.obj=h;l.pObj=e;l.spObj=!0;l.onclick=di;k.innerHTML=h[0]+"x "+h[1]+"y -> "+h[2]+"x "+h[3]+"y";k.appendChild(l);b.appendChild(k)}},Cl={moving:1},Fm=function(){Cl[this.value]?(V("byButton2"),V("byButton1"),V("unitListDiv2")):(la("unitListDiv2"),r("byButton2").style.display="inline-block",r("byButton1").style.display="inline-block");sa.active.type=this.value},Gm=function(){Cl[this.value]?(V("toButton2"),V("toButton1"),V("unitListDivAction2")):(la("unitListDivAction2"),r("toButton2").style.display="inline-block",
r("toButton1").style.display="inline-block");ub.active.type=this.value},vb=function(b){if(b)V("mapRulesWindow"),gb(),vb.actived=b.button;else if(vb.actived){la("mapRulesWindow");vc();b=vb.actived.spType.active;b="unitListDiv2"==vb.actived.id||"unitListDivAction2"==vb.actived.id?b.to:b.list;for(var c={},d=0,g=b.length;d<g;d++)c[b[d]]=1;d=0;for(g=ba.length;d<g;d++)c[ba[d]]||b.put(ba[d]);se(vb.actived,b);vb.actived=!1}},se=function(b,e){b.innerHTML="";for(var c=0,g=e.length;c<g;c++){var h=document.createElement("div");
h.innerHTML=A[e[c]].name;var k=document.createElement("button");k.onclick=di;k.innerHTML="x";k.pObj=e;k.spObj=!0;k.obj=e[c];h.appendChild(k);b.appendChild(h)}},Va=function(){Va.active&&(Va.active.className="");Va.active=this;this.className="spSelect";for(var b=this.parentElement.getElementsByTagName("section"),e=0,d=b.length;e<d;e++)b[e].style.display="none";this.sdiv.style.display="block"},pb=function(){var b=this.editorRule;b.deleted||(la("mapEvent"),la("mapActions"),V("eventOptions"),pb.active&&
(pb.div.className=""),this.className="spSelect",pb.active=b,pb.div=this,Gf(b,"eventLayout"),Gf(b,"actionLayout"),sa.div&&V(sa.div),sa.div1=void 0)},sa=function(){var b=this.editorRule;b.deleted||(la("eventOptions"),sa.div1&&(sa.div1.className=""),this.className="spSelect",sa.active=b,r("selectionEvents").value=b.type,sa.div1=this,r("eventOptions").value=b.name,sa.div=ck[b.name].id,la(sa.div),se(r("unitListDiv"),b.list),se(r("unitListDiv2"),b.to))},ub=function(){var b=this.editorRule;b.deleted||(la("actionOptions"),
ub.div1&&(ub.div1.className=""),this.className="spSelect",ub.active=b,r("selectionActions").value=b.type,ub.div1=this,r("actionOptions").value=b.name,ub.div="ed"+b.name,la(ub.div),se(r("unitListDivAction"),b.list),se(r("unitListDivAction2"),b.to))},Gf=function(b,e){r(e).innerHTML="";if("eventLayout"==e){b=b.events;var c=sa,g=pb.active.events}else b=b.actions,c=ub,g=pb.active.actions;for(var h=0,k=b.length;h<k;h++){var l=document.createElement("div");kg(l,b[h],c,g);r(e).appendChild(l)}},Dm=function(){var b=
pb.active,e={name:"objAction",list:[],to:[],type:"attack"};b.events.put(e);var d=document.createElement("div");kg(d,e,sa,b.events);r("eventLayout").appendChild(d);if(sa.div1)sa.div1.onclick()},Em=function(){var b=pb.active,e={name:"objOrder",list:[],to:[],type:"move"};b.actions.put(e);var d=document.createElement("div");kg(d,e,ub,b.actions);r("actionLayout").appendChild(d);if(ub.div1)ub.div1.onclick()},kg=function(b,e,d,g){b.innerHTML=e.events?e.name:t[e.name];b.onclick=d;b.editorRule=e;d=document.createElement("button");
d.innerHTML="x";d.obj=e;d.pObj=g;d.onclick=di;b.appendChild(d)},Cm=function(){v.rules||(v.rules=[]);var b={name:"Rule"+v.rules.length,events:[],actions:[]};v.rules.put(b);var e=document.createElement("div");kg(e,b,pb,v.rules);r("rulist").appendChild(e)},di=function(){this.pObj.quit(this.obj);this.obj.deleted=!0;this.parentElement.parentElement.removeChild(this.parentElement);if(!this.spObj)if(this.pObj!==v.rules)pb.div.onclick();else V("mapEvent"),V("mapActions")},th=function(){var b=r("mapPropsWindow").getElementsByTagName("table")[0];
b.innerHTML="";b.innerHTML+="<tr><td>"+t.color+"</td><td>"+t.username+"</td><td>"+t.gold+"</td><td>"+t.wood+"</td><td>"+t.food+"</td><td>"+t.stone+"</td><td>"+t.AI+"</td><td>"+t.team+"</td></tr>";for(var e=1,d=J.length;e<d;e++){var g=J[e],h=g.color,k=g.resources;h="#"+(16777216+(h[0]<<16)+(h[1]<<8)+h[2]).toString(16).slice(1);b.innerHTML+='<tr><td><input style="background:'+h+'" type="color" value="'+h+'" /></td><td><input type="text" value="'+g.name+'"></td>\n\n<td><input type="text" class="res" value="'+
(parseInt(k[0])||"\u221e")+'"></td>\n<td><input type="text" class="res" value="'+(parseInt(k[1])||"\u221e")+'"></td>\n<td><input type="text" class="res" value="'+(parseInt(k[2])||"\u221e")+'"></td>\n<td><input type="text" class="res" value="'+(parseInt(k[3])||"\u221e")+'"></td>\n<td><label class="container">\n  <input type="checkbox">\n  <span class="checkmark"></span>\n</label></td><td><input type="number" min="0" value="'+g.team+'"></td></tr>'}b.innerHTML+="<tr><td><button id='editorAdd'>+</button><button id='editorDelete'>-</button></td></tr>";
r("editorAdd").onclick=on;r("editorDelete").onclick=pn;b=b.getElementsByTagName("input");e=0;for(d=J.length-1;e<d;e++)k=8*e,g=J[e+1],b[k].onchange=qn,b[k+1].onchange=rn,b[k+2].onchange=lg,b[k+3].onchange=lg,b[k+4].onchange=lg,b[k+5].onchange=lg,b[k+2].res=0,b[k+3].res=1,b[k+4].res=2,b[k+5].res=3,b[k+6].onchange=sn,b[k+6].checked=g.IA,b[k+7].onchange=tn,b[k].team=e+1,b[k+1].team=e+1,b[k+2].team=e+1,b[k+3].team=e+1,b[k+4].team=e+1,b[k+5].team=e+1,b[k+6].team=e+1,b[k+7].team=e+1},lg=function(){var b=
parseInt(this.value);b||(b=Infinity,this.value="\u221e");J[this.team].resources[this.res]=b},on=function(){new Fc("Tzar "+J.length,[~~(256*Math.random()),~~(256*Math.random()),~~(256*Math.random())],[0],0,!0,[v.goldRes,v.woodRes,v.foodRes,v.stoneRes],2);$f();th()},pn=function(){if(2<J.length){for(var b=J.length-1,e=3,d=A.length;e<d;e++){var g=A[e];g.kingdom==b&&g.die()}J.length--;$f();th()}},qn=function(){var b=J[this.team],e=parseInt(this.value.substr(1),16),d=e>>16&255,g=e>>8&255;e&=255;b.color=
[d,g,e];var h=this.team;b=ua[h];J[h].color=[d,g,e];d=0;for(g=b.length;d<g;d++){e=b[d];h=0;for(var k=e.length;h<k;h++)Wb(A[e[h]])}$f()},rn=function(){J[this.team].name=this.value},sn=function(){J[this.team].IA=this.checked?!0:!1},tn=function(){var b=J[this.team];b.team=parseInt(this.value);for(var e=J.length,d=1;d<e;d++){var g=J[d];g.team!==b.team&&(g.diplomacy[b.k]=1,b.diplomacy[g.k]=1)}},cn=function(b){if(b=r("maploadOnline").files[0]){b.name.split(".");var c=new FileReader;c.onload=function(){var b=
new Uint8Array(this.result);if(y.admin){V("optionbutton");var c=b.length;G(999999999,44444);for(var e=fb.step,k=0;k<c;k+=e)b.slice(k,k+e),G(999999999,44444);bl(b);G(ea);dl(ea.kingdoms.length);r("nplayersO").value=y.room.max;r("deleteCusMap").style.display="inline-table"}};c.readAsArrayBuffer(b)}},cl=function(b,e){if(e&&"wmp"==e)return qe(b);G(b[0]);var c=b[1]+(b[2]<<8)+(b[3]<<16)+(b[4]<<24);e=new TextDecoder("utf-8");e=JSON.parse(e.decode(b.slice(5,c+5)));if(!1===e.arje){b=b.slice(c+5,c+5+Math.pow(e.mapx,
2));var g=Math.pow(e.mapx,2);c=b.length;g=g?new Uint8Array(g):[];for(var h=0,k=0;k<c;k++){var l=b[k];if(255!==l)g[h++]=l;else{l=b[k-1];for(var m=(b[k+1]<<8)+b[k+2],n=0;n<m;n++)g[h++]=l;k+=2}}e.terrain=g}e.allunits&&(e.allunits=Yk(e.allunits));e.ini&&(e.ini=Yk(e.ini));return e},ea,vl=function(b,e,d,g,h,k){G(Za(b,20));r("custombody").innerHTML+="<tr>\n<td style='background:rgb("+g+","+h+","+k+')\' class="ucolor1"></td>\n<td class="username1">'+Jc(Za(b,20))+'</td>\n<td style="display:none" class="race1">'+
d+'</td>\n<td class="team1">'+e+"</td></tr>"},un=function(b){var c={Blue:189,Red:13506841,Green:3257600,Purple:11337925,Yellow:16768512,Cyan:46517,Orange:16751649,Gray:5921370},d=b.split(["[Player"]),g=b.split("GameDuration =")[1].split("[")[0].split(" min")[0].split(" ")[1],h=[];b=[];for(var k=1,l=d.length;k<l;k++){var m=d[k].split("\n"),n={};h[k-1]=n;for(var r=0,t=m.length;r<t;r++){var v=m[r];v=v.split(" = ");if(v[1]&&r){v[1]=v[1].trim();"Color"==v[0]&&(v[1]=c[v[1]]);"Type"==w&&"Status"!==v[0]&&
b.put("N");v[1]=encodeURIComponent(v[1]);b.put(v[1]);n[v[0]]=v[1];var w=v[0]}}}c=h[0].Name+"'s Game";var x=new XMLHttpRequest;x.open("POST",baseUrl+"php/stats.php",!0);x.setRequestHeader("Content-type","application/x-www-form-urlencoded");x.onreadystatechange=function(){200===x.status&&4===x.readyState&&(location.hash="MatchX"+x.responseText)};b=b.join("<");x.send("arr="+b+"&time="+6E4*g+"&name="+c+"&players="+h.length)},vn=function(b,e){for(var c="<tr style='background:#000;'><td style='    padding-right: 150px;'>Name</td><td>Type</td><td>Status</td><td>Team</td><td>Race</td><td>Score</td><td>Gold</td><td>Wood</td><td>Food</td><td>Stone</td><td title='Damage Inflicted'>D.I</td><td title='Damage Taken'>D.T</td><td title='Units Killed'>U.K</td><td title='Units Losed'>U.L</td><td title='Buildings Destroyed'>B.D</td><td title='Buildings Losed'>B.L</td><td title='Maximum Peasants'>M.P</td><td title='Maximum Towers'>M.T</td><td title='Maximum Stone Towers'>M.S.T</td><td title='Gold Traded'>G.T</td><td title='Stone Traded'>S.T</td><td title='Gold Converted'>G.C</td><td title='Stone Converted'>S.C</td></tr>",
g=2,h=b.length;g<h;g++)if((g-2)%24)0!==(g-3)%24&&(k=~~((g-2)/24)%2?"style = 'background:rgba(0,0,0,0.45)'":"style = 'background:rgba(0,0,0,0.65)'"),c+="<td "+k+">"+Ka(decodeURIComponent(b[g]))+"</td>";else{g-2&&(c+="</tr>");k=parseInt(Ka(decodeURIComponent(b[g])));var k="style = 'background:rgba("+Math.floor(k/65536)+","+Math.floor(k/256)%256+","+k%256+",0.45)'";c+="<tr>"}c+="</tr>";e?(la("ingameStats"),""==r("ingameStats").innerHTML&&(r("ingameStats").innerHTML='<div>\n<table id="statsGame"></table>\n</div>\n<button id="backToGameS" class="stanButton">'+
t.backToGame+"</button>",r("backToGameS").onclick=function(){var b=r("ingameStats");b.style.display="none"==b.style.display?"block":"none";gb()}),r("statsGame").innerHTML="<tbody>"+c+"</tbody>",e=r("statsGame").getElementsByTagName("td")):(r("MatchX").style.display="block",r("returnmenu").style.display="block",r("statsTable").innerHTML="<tbody>"+c+"</tbody>",e=r("statsTable").getElementsByTagName("td"));b=[];g=0;for(h=e.length;g<h;g++)c=g%23,4<c&&23<g&&(b[c-5]||(b[c-5]=[]),b[c-5].put(e[g]));g=0;for(h=
b.length;g<h;g++){e=b[g];e.sort(Ql);c=e.length;if(!e[1])break;e[0].innerHTML!=e[1].innerHTML&&(e[0].style.background="rgba(127,0,0,0.45)");e[c-1].innerHTML!=e[c-2].innerHTML&&(e[c-1].style.background="rgba(0,127,0,0.45)")}};r("statsLoad").onchange=function(){var b=r("statsLoad").files[0],e=new FileReader;e.onloadend=function(b){un(b.target.result)};b&&e.readAsText(b,"ascii")};var Il=function(b){var c=new XMLHttpRequest;c.open("POST",baseUrl+"php/loadstat.php",!0);c.setRequestHeader("Content-type",
"application/x-www-form-urlencoded");Dl(c,function(b){vn(b.responseText.split("<"))});G(b);c.send("id="+b)},Dl=function(b,e){b.onreadystatechange=function(){4===b.readyState&&(200===b.status?e(b):alert("Error: "+b.status))}},fl=function(){r("mapconfiguration").style.display="block";r("basic").style.filter="blur(94px)";if(""==r("mapconfiguration").innerHTML){for(var b="",e=["grass","snow"],d=0,g=0*e.length+1;d<g;d++)b+='<option value="'+e[d]+'" '+(e[d]==localStorage.terrain?"selected":"")+">"+t[e[d]]+
"</option>";e="";"true"==localStorage.infinity&&(e="checked");r("mapconfiguration").innerHTML="<table>\n<tbody>\n<tr><td>"+t.mapSize+'</td><td><input id="mapwidth" type="number" value="'+localStorage.mapx+'" step="32" min="32" max="1024" /></td></tr>\n<tr><td><hr></td></tr>\n<tr><td>'+t.startingResources+"</td></tr>\n<tr><td><hr></td></tr>\n<tr><td>"+t.infinite+'</td><td><label class="container">\n  <input id="infiniteValue" type="checkbox" '+e+'>\n  <span class="checkmark"></span>\n</label></td></tr>\n<tr><td>'+
t.gold+'</td><td><input id="goldValue" type="number" value="'+localStorage.goldRes+'" step="250" /></td></tr>\n<tr><td>'+t.wood+'</td><td><input id="woodValue" type="number" value="'+localStorage.woodRes+'" step="250" /></td></tr>\n<tr><td>'+t.food+'</td><td><input id="foodValue" type="number" value="'+localStorage.foodRes+'" step="250" /></td></tr>\n<tr><td>'+t.stone+'</td><td><input id="stoneValue" type="number" value="'+localStorage.stoneRes+'" step="250" /></td></tr>\n<tr><td><hr></td></tr>\n<tr><td>'+
t.terrainOption+'</td></tr>\n<tr><td><select name="terrain" id="terrainSelect">\n'+b+"\n<tr><td>"+t.water+'</td><td><input type="number" value="'+localStorage.water+'" id="waterValue" min="0"/></td></tr>\n<tr><td>'+t.items+'</td><td><input type="number" value="'+localStorage.items+'" id="itemsValue" min="0"/></td></tr>\n<tr><td>'+t.peons+'</td><td><input type="number" value="'+localStorage.peons+'" id="peonValue" min="0"/></td></tr>\n<tr><td>'+t.gateways+'</td><td><input type="number" value="'+0*
localStorage.gateways+'" id="gatewaysValue" min="0" readonly/></td></tr>\n<tr><td>'+t.freePop+'</td><td><input type="number" value="'+localStorage.freePop+'" id="freePopValue" /></td></tr>\n</select>\n</td>\n</tr>\n<tr><td></td></tr>\n<tr><td><button id="closeButton1" class="start">'+t.close+"</button></td></tr>\n</tbody>\n</table>";r("infiniteValue").onchange=function(){var b=this.checked;r("goldValue").disabled=b;r("stoneValue").disabled=b;r("woodValue").disabled=b;r("foodValue").disabled=b};r("infiniteValue").onchange();
r("closeButton1").onclick=function(){v.online&&Tc();r("mapconfiguration").style.display="none";gb()}}};r("returnmenu1").onclick=Qb;r("returnmenu").onclick=Qb;r("refreshButton1").onclick=Gb;r("sendmsg").onclick=vh;r("start1").onclick=fl;r("start2").onclick=od;r("alertok").onclick=function(){r("alert").style.display="none";gb()};r("createGame1").onclick=Xk;var wn=function(){G(this,this.checked);localStorage[this.localProp]=this.checked},El=function(){var b=this.value;"color"==this.type?this.style.backgroundColor=
b:"name"==this.localProp&&(b=Ka(b));y[this.localProp]=b;localStorage[this.localProp]=b},qg={MatchHistory:function(){r("returnmenu").style.display="block";var b=new XMLHttpRequest;b.open("GET",baseUrl+"php/latest.php",!0);Dl(b,function(b){b=b.responseText.split("|");for(var c=b.length-1,e="",h=0;h<c;h+=5)e+="<tr id='statList"+Ka(decodeURIComponent(b[h]))+"'><td>"+Ka(decodeURIComponent(b[h+1]))+"</td><td>"+Ka(decodeURIComponent(b[h+2]))+"</td><td>"+Ka(decodeURIComponent(b[h+3]))+"</td><td>"+parseInt(Ka(decodeURIComponent(b[h+
4])))/6E4+" min</td></tr>";r("matchtable").innerHTML="<tbody>"+e+"</tbody>";e={};for(h=0;h<c;e={l:e.l},h+=5)e.l=Ka(decodeURIComponent(b[h])),r("statList"+e.l).onclick=function(b){return function(){location.hash="MatchX"+b.l}}(e)});b.send(null)},GameList:Gb,RandomMap:rl,Twitter:function(){r("returnmenu").style.display="block"},Account:function(){pd.returnmenu.style.display="block";""==pd.Account.innerHTML&&(pd.Account.innerHTML='<iframe id="accountIframe"></iframe>',pd.accountIframe=r("accountIframe"));
pd.accountIframe.src=baseUrl+y.langCodeUrl+"account/?iframe=1"},MapEditor:Ph.start,CustomMap:function(){""==r("CustomMap").innerHTML&&(r("CustomMap").innerHTML="<h2>"+t.strcusMap+'</h2>\n<input id="mapload" type="file" />\n<label for="mapload" id="maploadlabel">Choose a file</label>\n<table id="mapcache"></table>\n<div id="customMapcont" style="display:none">\n<table class="players" id="customaptable">\n<tbody id="custombody">\n</tbody>\n</table>\n<button style="margin-left:40px" id="startCustom" class="start startButton">'+
t.play+'</button>\n\n<button style="margin-left:40px" id="closeCustom" class="start">'+t.close+"</button>\n</div>",r("closeCustom").onclick=function(){V("customMapcont");r("maploadlabel").style.display="inline-block";r("mapcache").style.display="table"},r("startCustom").onclick=function(){V("customMapcont");r("closeCustom").onclick();od()},r("mapload").accept=".tzared",r("mapload").onchange=function(b){b=r("mapload").files[0];G(b);b.name.split(".");var c=new FileReader;c.onload=function(){var b=new Uint8Array(this.result,
4),c=(new Uint32Array(this.result,0,1))[0];G(c,b);for(var e=b.length,k=x.readSavegame0(e),l=0;l<e;l++)Uc[k+l]=b[l];x.readSVG(4*c,e,!0);la("customMapcont");r("closeCustom").style.display="inline-table";r("custombody").innerHTML="";x.customMapTable()};c.readAsArrayBuffer(b)});la("returnmenu");xl()},Settings:function(){var b=r("Settings");if(""==b.innerHTML){var e=document.createElement("h2");e.innerHTML=t.strSettings;b.appendChild(e);e=document.createElement("div");var d=document.createElement("span");
d.innerHTML=t.color;e.appendChild(d);var g=document.createElement("input");g.type="color";g.value=localStorage.color;g.onchange=El;g.localProp="color";g.style.backgroundColor=localStorage.color;e.appendChild(g);d=document.createElement("span");d.innerHTML=t.username;e.appendChild(d);g=document.createElement("input");g.type="text";g.value=Vk(localStorage.name);g.onchange=El;g.localProp="name";e.appendChild(g);d=document.createElement("span");d.innerHTML=t.language;e.appendChild(d);d=document.createElement("select");
d.innerHTML='<option value="en">'+t.english+'</option>\n<option value="es">'+t.spanish+'</option>\n<option value="it">'+t.italian+'</option>\n<option value="pt">'+t.portuguese+'</option>\n<option value="ru">'+t.russian+'</option>\n<option value="pl">'+t.polish+'</option>\n<option value="bg">'+t.bulgarian+'</option>\n<option value="de">'+t.german+"</option>\n";d.value=y.langstr;d.onchange=function(){localStorage.language=this.value;location.href=""};e.appendChild(d);d=document.createElement("span");
d.innerHTML=t.offlinePlay;e.appendChild(d);d=document.createElement("button");d.innerHTML=t.downloadAll;d.onclick=fc;e.appendChild(d);d=document.createElement("span");d.innerHTML=t.fullscreen;e.appendChild(d);var h=document.createElement("label");h.className="container";d=document.createElement("span");d.className="checkmark";g=document.createElement("input");g.type="checkbox";g.checked="true"==localStorage.fullscreen?!0:!1;g.onchange=wn;g.localProp="fullscreen";h.appendChild(g);h.appendChild(d);
e.appendChild(h);b.appendChild(e)}la("returnmenu")},About:function(){var b=r("About");""==b.innerHTML&&(b.innerHTML='<div style="text-align:center;    user-select: text;"><div class="svgnehhon" style="background-repeat: no-repeat;height:342px;background-position: center;"></div>\nFully programmed by Donov from <a href="https://nehhon.com" target="_blank">nehhon</a><p>\n<a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=ABHGGGQ4TZFA2&source=url" target="_blank"><img src="/nehhon/donate.gif" /></a><p>\nContact:</p>\n<a href=\'mailto:webmaster@nehhon.com\' target="_blank">webmaster@nehhon.com</a> <br> <a href="https://twitter.com/TzaredGame" target="_blank">@TzaredGame</a>\n<p>Graphics, sound and game concept (Tzar) by Haemimont</p>\n<hr>\n<p>Special thanks to:</p>\n<img style="max-width:422px" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgODc0LjMgMzkzLjciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDg3NC4zIDM5My43OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHN0eWxlIHR5cGU9InRleHQvY3NzIj4uc3Qwe2ZpbGw6I0ZGRkZGRjt9LnN0MXtmaWxsOiNGMzgwMjA7fS5zdDJ7ZmlsbDojRkFBRTQwO308L3N0eWxlPjxnPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik03OTAuNiwyNzEuOWMtMy40LDAtNi4xLTIuNy02LjEtNi4xYzAtMy4zLDIuNy02LjEsNi4xLTYuMWMzLjMsMCw2LjEsMi43LDYuMSw2LjFDNzk2LjcsMjY5LjEsNzkzLjksMjcxLjksNzkwLjYsMjcxLjkgTTc5MC42LDI2MC45Yy0yLjcsMC00LjksMi4yLTQuOSw0LjljMCwyLjcsMi4yLDQuOSw0LjksNC45YzIuNywwLDQuOS0yLjIsNC45LTQuOUM3OTUuNSwyNjMuMSw3OTMuMywyNjAuOSw3OTAuNiwyNjAuOSBNNzkzLjcsMjY5aC0xLjRsLTEuMi0yLjNoLTEuNnYyLjNoLTEuM3YtNi43aDMuMmMxLjQsMCwyLjMsMC45LDIuMywyLjJjMCwxLTAuNiwxLjctMS40LDJMNzkzLjcsMjY5eiBNNzkxLjMsMjY1LjVjMC41LDAsMS0wLjMsMS0xYzAtMC44LTAuNC0xLTEtMWgtMnYyTDc5MS4zLDI2NS41TDc5MS4zLDI2NS41eiIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iMTU1LjEsMjU5LjEgMTcwLjcsMjU5LjEgMTcwLjcsMzAxLjYgMTk3LjgsMzAxLjYgMTk3LjgsMzE1LjIgMTU1LjEsMzE1LjIgIi8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTIxMy45LDI4Ny4zdi0wLjJjMC0xNi4xLDEzLTI5LjIsMzAuMy0yOS4yczMwLjEsMTIuOSwzMC4xLDI5djAuMmMwLDE2LjEtMTMsMjkuMi0zMC4zLDI5LjJDMjI2LjcsMzE2LjMsMjEzLjksMzAzLjQsMjEzLjksMjg3LjMgTTI1OC41LDI4Ny4zdi0wLjJjMC04LjEtNS44LTE1LjEtMTQuNC0xNS4xYy04LjUsMC0xNC4yLDYuOS0xNC4yLDE1djAuMmMwLDguMSw1LjgsMTUuMSwxNC4zLDE1LjFDMjUyLjgsMzAyLjMsMjU4LjUsMjk1LjQsMjU4LjUsMjg3LjMiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjkzLjQsMjkwLjZ2LTMxLjVoMTUuOHYzMS4yYzAsOC4xLDQuMSwxMS45LDEwLjMsMTEuOXMxMC4zLTMuNywxMC4zLTExLjV2LTMxLjZoMTUuOHYzMS4xYzAsMTguMS0xMC4zLDI2LTI2LjMsMjZDMzAzLjQsMzE2LjIsMjkzLjQsMzA4LjIsMjkzLjQsMjkwLjYiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzY5LjQsMjU5LjFIMzkxYzIwLDAsMzEuNywxMS41LDMxLjcsMjcuN3YwLjJjMCwxNi4yLTExLjgsMjguMi0zMiwyOC4yaC0yMS4zTDM2OS40LDI1OS4xTDM2OS40LDI1OS4xeiBNMzkxLjMsMzAxLjRjOS4zLDAsMTUuNS01LjEsMTUuNS0xNC4ydi0wLjJjMC05LTYuMi0xNC4yLTE1LjUtMTQuMkgzODV2MjguNUgzOTEuM3oiLz48cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjQ0NS4zLDI1OS4xIDQ5MC4yLDI1OS4xIDQ5MC4yLDI3Mi43IDQ2MC44LDI3Mi43IDQ2MC44LDI4Mi4zIDQ4Ny40LDI4Mi4zIDQ4Ny40LDI5NS4yIDQ2MC44LDI5NS4yIDQ2MC44LDMxNS4yIDQ0NS4zLDMxNS4yICIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNTExLjgsMjU5LjEgNTI3LjMsMjU5LjEgNTI3LjMsMzAxLjYgNTU0LjUsMzAxLjYgNTU0LjUsMzE1LjIgNTExLjgsMzE1LjIgIi8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTU5NS4xLDI1OC43aDE1bDIzLjksNTYuNWgtMTYuN2wtNC4xLTEwaC0yMS42bC00LDEwaC0xNi4zTDU5NS4xLDI1OC43eiBNNjA4LjgsMjkzLjFsLTYuMi0xNS45bC02LjMsMTUuOUg2MDguOHoiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNNjU0LDI1OS4xaDI2LjVjOC42LDAsMTQuNSwyLjIsMTguMyw2LjFjMy4zLDMuMiw1LDcuNSw1LDEzLjF2MC4yYzAsOC42LTQuNiwxNC4zLTExLjUsMTcuMmwxMy40LDE5LjZoLTE4bC0xMS4zLTE3aC02Ljh2MTdINjU0TDY1NCwyNTkuMUw2NTQsMjU5LjF6IE02NzkuOCwyODZjNS4zLDAsOC4zLTIuNiw4LjMtNi42di0wLjJjMC00LjQtMy4yLTYuNi04LjQtNi42aC0xMC4yVjI4Nkw2NzkuOCwyODZMNjc5LjgsMjg2eiIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNzI2LjIsMjU5LjEgNzcxLjMsMjU5LjEgNzcxLjMsMjcyLjMgNzQxLjYsMjcyLjMgNzQxLjYsMjgwLjggNzY4LjUsMjgwLjggNzY4LjUsMjkzLjEgNzQxLjYsMjkzLjEgNzQxLjYsMzAyIDc3MS43LDMwMiA3NzEuNywzMTUuMiA3MjYuMiwzMTUuMiAiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTIxLjEsMjkzLjljLTIuMiw0LjktNi44LDguNC0xMi44LDguNGMtOC41LDAtMTQuMy03LjEtMTQuMy0xNS4xVjI4N2MwLTguMSw1LjctMTUsMTQuMi0xNWM2LjQsMCwxMS4zLDMuOSwxMy4zLDkuM2gxNi40Yy0yLjYtMTMuNC0xNC40LTIzLjMtMjkuNi0yMy4zYy0xNy4zLDAtMzAuMywxMy4xLTMwLjMsMjkuMnYwLjJjMCwxNi4xLDEyLjgsMjksMzAuMSwyOWMxNC44LDAsMjYuNC05LjYsMjkuNC0yMi40TDEyMS4xLDI5My45TDEyMS4xLDI5My45eiIvPjxnPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNzUyLjksMTY5LjYgNzEwLDE0NSA3MDIuNiwxNDEuOCA1MjcuMSwxNDMgNTI3LjEsMjMyLjEgNzUyLjksMjMyLjEgIi8+PHBhdGggY2xhc3M9InN0MSIgZD0iTTY3NC44LDIyMy45YzIuMS03LjIsMS4zLTEzLjgtMi4yLTE4LjdjLTMuMi00LjUtOC42LTcuMS0xNS4xLTcuNGwtMTIzLjEtMS42Yy0wLjgsMC0xLjUtMC40LTEuOS0xYy0wLjQtMC42LTAuNS0xLjQtMC4zLTIuMmMwLjQtMS4yLDEuNi0yLjEsMi45LTIuMmwxMjQuMi0xLjZjMTQuNy0wLjcsMzAuNy0xMi42LDM2LjMtMjcuMmw3LjEtMTguNWMwLjMtMC44LDAuNC0xLjYsMC4yLTIuNGMtOC0zNi4yLTQwLjMtNjMuMi03OC45LTYzLjJjLTM1LjYsMC02NS44LDIzLTc2LjYsNTQuOWMtNy01LjItMTUuOS04LTI1LjUtNy4xYy0xNy4xLDEuNy0zMC44LDE1LjQtMzIuNSwzMi41Yy0wLjQsNC40LTAuMSw4LjcsMC45LDEyLjdjLTI3LjksMC44LTUwLjIsMjMuNi01MC4yLDUxLjdjMCwyLjUsMC4yLDUsMC41LDcuNWMwLjIsMS4yLDEuMiwyLjEsMi40LDIuMWwyMjcuMiwwYzEuMywwLDIuNS0wLjksMi45LTIuMkw2NzQuOCwyMjMuOXoiLz48cGF0aCBjbGFzcz0ic3QyIiBkPSJNNzE0LDE0NC44Yy0xLjEsMC0yLjMsMC0zLjQsMC4xYy0wLjgsMC0xLjUsMC42LTEuOCwxLjRsLTQuOCwxNi43Yy0yLjEsNy4yLTEuMywxMy44LDIuMiwxOC43YzMuMiw0LjUsOC42LDcuMSwxNS4xLDcuNGwyNi4yLDEuNmMwLjgsMCwxLjUsMC40LDEuOSwxYzAuNCwwLjYsMC41LDEuNSwwLjMsMi4yYy0wLjQsMS4yLTEuNiwyLjEtMi45LDIuMmwtMjcuMywxLjZjLTE0LjgsMC43LTMwLjcsMTIuNi0zNi4zLDI3LjJsLTIsNS4xYy0wLjQsMSwwLjMsMiwxLjQsMmg5My44YzEuMSwwLDIuMS0wLjcsMi40LTEuOGMxLjYtNS44LDIuNS0xMS45LDIuNS0xOC4yQzc4MS4zLDE3NSw3NTEuMSwxNDQuOCw3MTQsMTQ0LjgiLz48L2c+PC9nPjwvc3ZnPg==" alt="cloudflare">\n</div>');
la("returnmenu")}};r("about").onclick=function(){location.hash="About"};r("discord").onclick=function(){window.open("https://discord.gg/ndxJHxT","_blank")};ei();var Ib=[Bb,nf,Ec,Cc,Td,bf,xf,rf,ff,df,mf,zf,tf,Ej,Bf,hf,kf,vf,Wd,Xi,Rc,Ti,Ng,Li,Qi,Cj,Ye,Ij,Kj,bd,mh,Lj,Mj,Nj,Oj,Ye,Nk,yj,Pj,Jd,zj,Pe,vj,wj,ch,Xe,Qd,Eb,bh,Dc,Cc,We,Ec,lb,Zc,ad,W,function(b,e){e=D[e];var c=e.nu.id;J[b.kingdom].technology.hidden[e.id.id]=0;cb(b,e,c);vk.actv[e.id.id]&&X(!1)},Re,Se,Ja,mj,Ua,$g,ah,Gd,Fh,ek,Hj,ih,sf,Dj,Aj,function(b,
e){}];(function(){for(var b=0,e=Ib.length;b<e;b++)Ib[b].url=b})();Xi.rule="moving";Xe.rule="attack"})();
