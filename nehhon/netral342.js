var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(x,M,da){x!=Array.prototype&&x!=Object.prototype&&(x[M]=da.value)};$jscomp.getGlobal=function(x){return"undefined"!=typeof window&&window===x?x:"undefined"!=typeof global&&null!=global?global:x};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var x=0;return function(M){return $jscomp.SYMBOL_PREFIX+(M||"")+x++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var x=$jscomp.global.Symbol.iterator;x||(x=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[x]&&$jscomp.defineProperty(Array.prototype,x,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(x){var M=0;return $jscomp.iteratorPrototype(function(){return M<x.length?{done:!1,value:x[M++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(x){$jscomp.initSymbolIterator();x={next:x};x[$jscomp.global.Symbol.iterator]=function(){return this};return x};$jscomp.iteratorFromArray=function(x,M){$jscomp.initSymbolIterator();x instanceof String&&(x+="");var da=0,D={next:function(){if(da<x.length){var T=da++;return{value:M(T,x[T]),done:!1}}D.next=function(){return{done:!0,value:void 0}};return D.next()}};D[Symbol.iterator]=function(){return D};return D};
$jscomp.polyfill=function(x,M,da,D){if(M){da=$jscomp.global;x=x.split(".");for(D=0;D<x.length-1;D++){var T=x[D];T in da||(da[T]={});da=da[T]}x=x[x.length-1];D=da[x];M=M(D);M!=D&&null!=M&&$jscomp.defineProperty(da,x,{configurable:!0,writable:!0,value:M})}};$jscomp.polyfill("Array.prototype.keys",function(x){return x?x:function(){return $jscomp.iteratorFromArray(this,function(x){return x})}},"es6","es3");
$jscomp.polyfill("Object.getOwnPropertySymbols",function(x){return x?x:function(){return[]}},"es6","es5");$jscomp.findInternal=function(x,M,da){x instanceof String&&(x=String(x));for(var D=x.length,T=0;T<D;T++){var Y=x[T];if(M.call(da,Y,T,x))return{i:T,v:Y}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(x){return x?x:function(x,da){return $jscomp.findInternal(this,x,da).v}},"es6","es3");$jscomp.owns=function(x,M){return Object.prototype.hasOwnProperty.call(x,M)};
$jscomp.polyfill("Object.assign",function(x){return x?x:function(x,da){for(var D=1;D<arguments.length;D++){var M=arguments[D];if(M)for(var Y in M)$jscomp.owns(M,Y)&&(x[Y]=M[Y])}return x}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(x){return x?x:function(){return $jscomp.iteratorFromArray(this,function(x,da){return da})}},"es8","es3");$jscomp.polyfill("Math.sign",function(x){return x?x:function(x){x=Number(x);return 0===x||isNaN(x)?x:0<x?1:-1}},"es6","es3");
$jscomp.polyfill("Number.isFinite",function(x){return x?x:function(x){return"number"!==typeof x?!1:!isNaN(x)&&Infinity!==x&&-Infinity!==x}},"es6","es3");$jscomp.polyfill("Number.isInteger",function(x){return x?x:function(x){return Number.isFinite(x)?x===Math.floor(x):!1}},"es6","es3");$jscomp.makeIterator=function(x){$jscomp.initSymbolIterator();var M=x[Symbol.iterator];return M?M.call(x):$jscomp.arrayIterator(x)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(x){function M(){this.batch_=null}function da(x){return x instanceof T?x:new T(function(D,zb){D(x)})}if(x&&!$jscomp.FORCE_POLYFILL_PROMISE)return x;M.prototype.asyncExecute=function(x){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(x);return this};M.prototype.asyncExecuteBatch_=function(){var x=this;this.asyncExecuteFunction(function(){x.executeBatch_()})};var D=$jscomp.global.setTimeout;M.prototype.asyncExecuteFunction=function(x){D(x,
0)};M.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var x=this.batch_;this.batch_=[];for(var D=0;D<x.length;++D){var T=x[D];delete x[D];try{T()}catch(Ab){this.asyncThrow_(Ab)}}}this.batch_=null};M.prototype.asyncThrow_=function(x){this.asyncExecuteFunction(function(){throw x;})};var T=function(x){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var D=this.createResolveAndReject_();try{x(D.resolve,D.reject)}catch(Pc){D.reject(Pc)}};T.prototype.createResolveAndReject_=
function(){function x(x){return function(zb){T||(T=!0,x.call(D,zb))}}var D=this,T=!1;return{resolve:x(this.resolveTo_),reject:x(this.reject_)}};T.prototype.resolveTo_=function(x){if(x===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(x instanceof T)this.settleSameAsPromise_(x);else{a:switch(typeof x){case "object":var D=null!=x;break a;case "function":D=!0;break a;default:D=!1}D?this.resolveToNonPromiseObj_(x):this.fulfill_(x)}};T.prototype.resolveToNonPromiseObj_=function(x){var D=
void 0;try{D=x.then}catch(Pc){this.reject_(Pc);return}"function"==typeof D?this.settleSameAsThenable_(D,x):this.fulfill_(x)};T.prototype.reject_=function(x){this.settle_(2,x)};T.prototype.fulfill_=function(x){this.settle_(1,x)};T.prototype.settle_=function(x,D){if(0!=this.state_)throw Error("Cannot settle("+x+", "+D|"): Promise already settled in state"+this.state_);this.state_=x;this.result_=D;this.executeOnSettledCallbacks_()};T.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var x=
this.onSettledCallbacks_,D=0;D<x.length;++D)x[D].call(),x[D]=null;this.onSettledCallbacks_=null}};var Y=new M;T.prototype.settleSameAsPromise_=function(x){var D=this.createResolveAndReject_();x.callWhenSettled_(D.resolve,D.reject)};T.prototype.settleSameAsThenable_=function(x,D){var T=this.createResolveAndReject_();try{x.call(D,T.resolve,T.reject)}catch(Ab){T.reject(Ab)}};T.prototype.then=function(x,D){function M(x,D){return"function"==typeof x?function(D){try{da(x(D))}catch(re){zb(re)}}:D}var da,
zb,Y=new T(function(x,D){da=x;zb=D});this.callWhenSettled_(M(x,da),M(D,zb));return Y};T.prototype.catch=function(x){return this.then(void 0,x)};T.prototype.callWhenSettled_=function(x,D){function T(){switch(M.state_){case 1:x(M.result_);break;case 2:D(M.result_);break;default:throw Error("Unexpected state: "+M.state_);}}var M=this;null==this.onSettledCallbacks_?Y.asyncExecute(T):this.onSettledCallbacks_.push(function(){Y.asyncExecute(T)})};T.resolve=da;T.reject=function(x){return new T(function(D,
T){T(x)})};T.race=function(x){return new T(function(D,T){for(var M=$jscomp.makeIterator(x),Y=M.next();!Y.done;Y=M.next())da(Y.value).callWhenSettled_(D,T)})};T.all=function(x){var D=$jscomp.makeIterator(x),M=D.next();return M.done?da([]):new T(function(x,T){function Y(D){return function(T){zb[D]=T;Ab--;0==Ab&&x(zb)}}var zb=[],Ab=0;do zb.push(void 0),Ab++,da(M.value).callWhenSettled_(Y(zb.length-1),T),M=D.next();while(!M.done)})};return T},"es6","es3");
(function(){function x(k,c,d){this.context=k;this.urlList=c;this.onload=d;this.loadCount=0}function M(k,c,d){c=c.split(".")[0].toLowerCase();se[c]=k;!d||d.music&&d.mid!=Ka.id||(na(c,d.x,d.y,d.k,d.music,d.date),d.date=0)}function da(k,c){var d=H,e;for(e=2;60>=e;e+=2){k--;c--;for(var b=0;b<=e;){if(2<Z[k+b+d*c]&&1==B[Z[k+b+d*c]].res&&fa(k+b,c))return Z[k+b+d*c];if(2<Z[k+b+d*(c+e)]&&1==B[Z[k+b+d*(c+e)]].res&&fa(k+b,c+e))return Z[k+b+d*(c+e)];b++}for(b=0;b<e-1;){b++;if(2<Z[k+d*(c+b)]&&1==B[Z[k+d*(c+b)]].res&&
fa(k,c+b))return Z[k+d*(c+b)];if(2<Z[k+e+d*(c+b)]&&1==B[Z[k+e+d*(c+b)]].res&&fa(k+e,c+b))return Z[k+e+d*(c+b)]}}return!1}function D(k,c){if(!Qc(k)){var d=k.x32,e=k.y32,b=k.sight;k.build&&(b=k.attDist);var g=H,m=2*b+1,q=m*m,w=k.id,z={};k.callList||(k.callList=[]);for(var E=0;E<q;E++){var N=E%m-b,O=~~(E/m)-b;if(Math.sqrt(Math.pow(N,2)+Math.pow(O,2))<=b){N+=d;O+=e;var xa=N+O*g;fa(N,O)&&(tc[xa]?(N=B[tc[xa]],z[N.id]||c||(N.callList||C(N),N.callList.put(k.id),N.callList.put(k.x32+k.y32*g),z[N.id]=1)):tc[xa]=
w)}}}}function T(){for(var k=0,c=Oa.length;k<c;Oa[k++].className="");}function Y(){if(""==p("playingMenu").innerHTML){p("playingMenu").innerHTML='<div>\n<ul>\n<li id="backToGame">'+t.backToGame+'</li>\n<li style="display:none" id="saveGameCache">'+t.save+' (cache)</li>\n<li id="saveGame">'+t.downloadmap+'</li>\n<li id="fullscreenmenu">'+t.fullscreen2+'</li>\n<li id="quitButton1">'+t.quit+"</li>\n</ul>\n<div>\n<span>"+t.musicVolume+'</span><br/><input type="range" id="musicRange" value="'+localStorage.musicRange+
'"/><br/><br/>\n<form id="musicSelect">\n<input type="radio" name="mversion" value="originalMusic" checked /> Original<br/>\n<input type="radio" name="mversion" value="sharpRain" /> Original - <a href="https://www.youtube.com/user/rainheart666787/featured" target="_blank" rel="noopener noreferrer">Sharp Rain</a> Version<br/>\n<input type="radio" name="mversion" value="originalMusic1" /> Original - Alternative One<br/>\n<input type="radio" name="mversion" value="mute" /> Mute\n</form>\n<br />\n<span>'+
t.soundVolume+'</span><br/><input type="range" id="soundRange" value="'+localStorage.soundRange+'"/><br/>\n</div>\n</div>\n';p("quitButton1").onclick=zb;p("saveGame").onclick=fi;p("saveGameCache").onclick=Fl;p("backToGame").onclick=function(){V("playingMenu");gb()};p("fullscreenmenu").onclick=gi;p("musicRange").oninput=function(){td.gain.value=parseInt(p("musicRange").value)/100;localStorage.musicRange=p("musicRange").value};p("soundRange").oninput=function(){ud.gain.value=parseInt(p("soundRange").value)/
100;localStorage.soundRange=p("soundRange").value};localStorage.favMusic&&(p("musicSelect").mversion.value=localStorage.favMusic);for(var k=p("musicSelect").getElementsByTagName("input"),c=0,d=k.length;c<d;c++)k[c].onchange=Ka.reset}r.demo&&V("saveGame")||ia("saveGame");p("playingMenu").style.display="block";uc()}function zb(){location.href=""}function Dl(k){C("setup:",k);k.toSend=[];k.orderList=[];var c=Da.roomName;c=c.substr(0,c.length-1);k.id==c&&(k.admin=!0);k.superID=hi(k.id);k.sendDirectly("channelMessage",
"nehhof",{});C(k.channels.channelMessage);k.channels.channelMessage.onopen=function(){Za.put(k);na("attack");og(1);C("DATACHANNEL OPEN");setTimeout(function(){C(k);y.admin?(Rc(v.onlADD(0,0,parseInt(y.color.substr(1),16),k.superID,0),17,"..."),v.onlineKingdoms(),Sc()):k.admin&&(Rc(v.mnameadd(),17,y.name),v.shareName(k.superID))},500)};k.channels.channelMessage.onerror=function(k){C(k)}}function Pc(){p("buttons").innerHTML="";p("gameName").innerHTML=""}function Ab(){y.p2p?(gb(),y.p2p.emit("getRooms"),
p("returnmenu").style.display="block"):(Da||Lb(),Lb.func=Ab)}function di(){var k=location,c=k.hash.substr(1);""==c&&(p("returnmenu").style.display="none");if("MatchX"==c.substr(0,6))6<c.length&&Gl(c.substr(6-c.length));else if("Room"==k.hash.substr(-4))pg?ii():te=ii;else if(qg[c])if(pg)qg[c]();else te=qg[c];else k.hash=""}function ng(k){k.style.display="none"==k.style.display?"block":"none"}function El(k){return n.locateFile?n.locateFile(k,Mb):Mb+k}function mg(k,c){k||Gb("Assertion failed: "+c)}function ei(k,
c,d){var e=c+d;for(d=c;k[d]&&!(d>=e);)++d;if(16<d-c&&k.subarray&&ji)return ji.decode(k.subarray(c,d));for(e="";c<d;){var b=k[c++];if(b&128){var g=k[c++]&63;if(192==(b&224))e+=String.fromCharCode((b&31)<<6|g);else{var m=k[c++]&63;b=224==(b&240)?(b&15)<<12|g<<6|m:(b&7)<<18|g<<12|m<<6|k[c++]&63;65536>b?e+=String.fromCharCode(b):(b-=65536,e+=String.fromCharCode(55296|b>>10,56320|b&1023))}}else e+=String.fromCharCode(b)}return e}function re(k){for(var c=0,d=0;d<k.length;++d){var e=k.charCodeAt(d);55296<=
e&&57343>=e&&(e=65536+((e&1023)<<10)|k.charCodeAt(++d)&1023);127>=e?++c:c=2047>=e?c+2:65535>=e?c+3:c+4}var b=c+1;c=ki(b);d=li;e=c;if(0<b){b=e+b-1;for(var g=0;g<k.length;++g){var m=k.charCodeAt(g);if(55296<=m&&57343>=m){var q=k.charCodeAt(++g);m=65536+((m&1023)<<10)|q&1023}if(127>=m){if(e>=b)break;d[e++]=m}else{if(2047>=m){if(e+1>=b)break;d[e++]=192|m>>6}else{if(65535>=m){if(e+2>=b)break;d[e++]=224|m>>12}else{if(e+3>=b)break;d[e++]=240|m>>18;d[e++]=128|m>>12&63}d[e++]=128|m>>6&63}d[e++]=128|m&63}}d[e]=
0}return c}function rg(k,c){0<k%c&&(k+=c-k%c);return k}function mi(){n.HEAP8=li=new Int8Array(Wa);n.HEAP16=new Int16Array(Wa);n.HEAP32=hb=new Int32Array(Wa);n.HEAPU8=Tc=new Uint8Array(Wa);n.HEAPU16=new Uint16Array(Wa);n.HEAPU32=ni=new Uint32Array(Wa);n.HEAPF32=new Float32Array(Wa);n.HEAPF64=new Float64Array(Wa)}function vd(k){for(;0<k.length;){var c=k.shift();if("function"==typeof c)c();else{var d=c.func;"number"===typeof d?void 0===c.arg?n.dynCall_v(d):n.dynCall_vi(d,c.arg):d(void 0===c.arg?null:
c.arg)}}}function oi(k){return String.prototype.startsWith?k.startsWith("data:application/octet-stream;base64,"):0===k.indexOf("data:application/octet-stream;base64,")}function pi(){try{if(n.wasmBinary)return new Uint8Array(n.wasmBinary);if(n.readBinary)return n.readBinary(Xb);throw"both async and sync fetching of the wasm failed";}catch(k){Gb(k)}}function Hl(){return n.wasmBinary||!wd&&!vc||"function"!==typeof fetch?new Promise(function(k,c){k(pi())}):fetch(Xb,{credentials:"same-origin"}).then(function(k){if(!k.ok)throw"failed to load wasm binary file at '"+
Xb+"'";return k.arrayBuffer()}).catch(function(){return pi()})}function Il(k){function c(k,c){n.asm=k.exports;wc--;n.monitorRunDependencies&&n.monitorRunDependencies(wc);0==wc&&(null!==sg&&(clearInterval(sg),sg=null),xd&&(k=xd,xd=null,k()))}function d(k){c(k.instance)}function b(k){Hl().then(function(k){return WebAssembly.instantiate(k,f)}).then(k,function(k){Nb("failed to asynchronously prepare wasm: "+k);Gb(k)})}var f={env:k,global:{NaN:NaN,Infinity:Infinity},"global.Math":Math,asm2wasm:Jl};wc++;
n.monitorRunDependencies&&n.monitorRunDependencies(wc);if(n.instantiateWasm)try{return n.instantiateWasm(f,c)}catch(g){return Nb("Module.instantiateWasm callback failed with error: "+g),!1}n.wasmBinary||"function"!==typeof WebAssembly.instantiateStreaming||oi(Xb)||"function"!==typeof fetch?b(d):WebAssembly.instantiateStreaming(fetch(Xb,{credentials:"same-origin"}),f).then(d,function(k){Nb("wasm streaming compile failed: "+k);Nb("falling back to ArrayBuffer instantiation");b(d)});return{}}function qi(){return!!qi.uncaught_exception}
function ri(k){try{return Kl(k)}catch(c){}}function yd(){var k=Pa.last;if(!k)return Uc=0;var c=Pa.infos[k],d=c.type;if(!d)return Uc=0,k|0;var b=Array.prototype.slice.call(arguments);n.___cxa_is_pointer_type(d);yd.buffer||(yd.buffer=Ll(4));hb[yd.buffer>>2]=k;k=yd.buffer;for(var f=0;f<b.length;f++)if(b[f]&&n.___cxa_can_catch(b[f],d,k))return k=hb[k>>2],c.adjusted.push(k),Uc=b[f],k|0;k=hb[k>>2];Uc=d;return k|0}function si(){Gb()}function ti(k){k=rg(k,65536);var c=n.buffer.byteLength;try{return-1!==ue.grow((k-
c)/65536)?n.buffer=ue.buffer:null}catch(d){return null}}function Vc(k){this.name="ExitStatus";this.message="Program terminated with exit("+k+")";this.status=k}function tg(k){function c(){if(!n.calledRun&&(n.calledRun=!0,!ug)){ve||(ve=!0,vd(vg));vd(Ml);if(n.onRuntimeInitialized)n.onRuntimeInitialized();n._main&&ui&&n.callMain(k);if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)vi.unshift(n.postRun.shift());vd(vi)}}k=k||n.arguments;if(!(0<wc)){if(n.preRun)for("function"==
typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)wi.unshift(n.preRun.shift());vd(wi);0<wc||n.calledRun||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1);c()},1)):c())}}function Gb(k){if(n.onAbort)n.onAbort(k);void 0!==k?(wg(k),Nb(k),k=JSON.stringify(k)):k="";ug=!0;throw"abort("+k+"). Build with -s ASSERTIONS=1 for more info.";}function Nl(){for(var k=Q,c=0,d=k.length;c<d;c++){var b=B[k[c]];b.build||(b.d=(b.d+1)%8,ca(b,b.img))}}function xi(k){ec=
!1;var c=ja;c.d=k.d;ca(c,k.img);c.active=!0;ib=A[52];we=k;document.addEventListener("mousemove",xg);document.addEventListener("mousedown",zd)}function Ol(k,c){return k.innerHTML-c.innerHTML}var Sl=function(){(function(k){"object"===typeof exports&&"undefined"!==typeof module?module.exports=k():"function"===typeof define&&define.amd?define([],k):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).SimpleWebRTC=k()})(function(){return function f(c,
b,e){function d(g,q){if(!b[g]){if(!c[g]){var w="function"==typeof require&&require;if(!q&&w)return w(g,!0);if(m)return m(g,!0);q=Error("Cannot find module '"+g+"'");throw q.code="MODULE_NOT_FOUND",q;}q=b[g]={exports:{}};c[g][0].call(q.exports,function(b){var e=c[g][1][b];return d(e?e:b)},q,q.exports,f,c,b,e)}return b[g].exports}for(var m="function"==typeof require&&require,q=0;q<e.length;q++)d(e[q]);return d}({1:[function(c,b,e){function d(){}b.exports=function(c,b,e){function f(c,d){if(0>=f.count)throw Error("after called too many times");
--f.count;c?(g=!0,b(c),b=e):0!==f.count||g||b(null,d)}var g=!1;e=e||d;f.count=c;return 0===c?b():f}},{}],2:[function(c,b,e){b.exports=function(c,b,d){var e=c.byteLength;b=b||0;d=d||e;if(c.slice)return c.slice(b,d);0>b&&(b+=e);0>d&&(d+=e);d>e&&(d=e);if(b>=e||b>=d||0===e)return new ArrayBuffer(0);c=new Uint8Array(c);e=new Uint8Array(d-b);for(var f=0;b<d;b++,f++)e[f]=c[b];return e.buffer}},{}],3:[function(c,b,e){b.exports=function(c,b,d){var e,f=b;b={autoplay:!0,mirror:!1,muted:!1,audio:!1,disableContextMenu:!1};
if(d)for(e in d)b[e]=d[e];f?"audio"===f.tagName.toLowerCase()&&(b.audio=!0):f=document.createElement(b.audio?"audio":"video");b.disableContextMenu&&(f.oncontextmenu=function(c){c.preventDefault()});b.autoplay&&(f.autoplay="autoplay");b.muted&&(f.muted=!0);!b.audio&&b.mirror&&["","moz","webkit","o","ms"].forEach(function(c){f.style[c?c+"Transform":"transform"]="scaleX(-1)"});f.srcObject=c;return f}},{}],4:[function(c,b,e){function d(c){c=c||{};this.ms=c.min||100;this.max=c.max||1E4;this.factor=c.factor||
2;this.jitter=0<c.jitter&&1>=c.jitter?c.jitter:0;this.attempts=0}b.exports=d;d.prototype.duration=function(){var c=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),d=Math.floor(b*this.jitter*c);c=0==(Math.floor(10*b)&1)?c-d:c+d}return Math.min(c,this.max)|0};d.prototype.reset=function(){this.attempts=0};d.prototype.setMin=function(c){this.ms=c};d.prototype.setMax=function(c){this.max=c};d.prototype.setJitter=function(c){this.jitter=c}},{}],5:[function(c,b,e){(function(c){e.encode=
function(b){b=new Uint8Array(b);var d,e=b.length,f="";for(d=0;d<e;d+=3)f+=c[b[d]>>2],f+=c[(b[d]&3)<<4|b[d+1]>>4],f+=c[(b[d+1]&15)<<2|b[d+2]>>6],f+=c[b[d+2]&63];2===e%3?f=f.substring(0,f.length-1)+"=":1===e%3&&(f=f.substring(0,f.length-2)+"==");return f};e.decode=function(b){var d=.75*b.length,e=b.length,f=0;"="===b[b.length-1]&&(d--,"="===b[b.length-2]&&d--);var g=new ArrayBuffer(d),E=new Uint8Array(g);for(d=0;d<e;d+=4){var N=c.indexOf(b[d]);var O=c.indexOf(b[d+1]);var xa=c.indexOf(b[d+2]);var xe=
c.indexOf(b[d+3]);E[f++]=N<<2|O>>4;E[f++]=(O&15)<<4|xa>>2;E[f++]=(xa&3)<<6|xe&63}return g}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],6:[function(c,b,e){(function(c){function d(c){for(var b=0;b<c.length;b++){var d=c[b];if(d.buffer instanceof ArrayBuffer){var e=d.buffer;if(d.byteLength!==e.byteLength){var f=new Uint8Array(d.byteLength);f.set(new Uint8Array(e,d.byteOffset,d.byteLength));e=f.buffer}c[b]=e}}}function e(c,b){b=b||{};var e=new w;d(c);for(var f=0;f<c.length;f++)e.append(c[f]);
return b.type?e.getBlob(b.type):e.getBlob()}function f(c,b){d(c);return new Blob(c,b||{})}var w=c.BlobBuilder||c.WebKitBlobBuilder||c.MSBlobBuilder||c.MozBlobBuilder;try{var z=2===(new Blob(["hi"])).size}catch(O){z=!1}var E;if(E=z)try{E=2===(new Blob([new Uint8Array([1,2])])).size}catch(O){E=!1}var N=w&&w.prototype.append&&w.prototype.getBlob;c=z?E?c.Blob:f:N?e:void 0;b.exports=c}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},
{}],7:[function(c,b,e){var d=[].slice;b.exports=function(c,b){"string"==typeof b&&(b=c[b]);if("function"!=typeof b)throw Error("bind() requires a function");var e=d.call(arguments,2);return function(){return b.apply(c,e.concat(d.call(arguments)))}}},{}],8:[function(c,b,e){function d(c){if(c){for(var b in d.prototype)c[b]=d.prototype[b];return c}}b.exports=d;d.prototype.on=d.prototype.addEventListener=function(c,b){this._callbacks=this._callbacks||{};(this._callbacks[c]=this._callbacks[c]||[]).push(b);
return this};d.prototype.once=function(c,b){function d(){e.off(c,d);b.apply(this,arguments)}var e=this;this._callbacks=this._callbacks||{};d.fn=b;this.on(c,d);return this};d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(c,b){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var d=this._callbacks[c];if(!d)return this;if(1==arguments.length)return delete this._callbacks[c],this;for(var e,f=0;f<
d.length;f++)if(e=d[f],e===b||e.fn===b){d.splice(f,1);break}return this};d.prototype.emit=function(c){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),d=this._callbacks[c];if(d){d=d.slice(0);for(var e=0,f=d.length;e<f;++e)d[e].apply(this,b)}return this};d.prototype.listeners=function(c){this._callbacks=this._callbacks||{};return this._callbacks[c]||[]};d.prototype.hasListeners=function(c){return!!this.listeners(c).length}},{}],9:[function(c,b,e){b.exports=function(c,b){var d=function(){};
d.prototype=b.prototype;c.prototype=new d;c.prototype.constructor=c}},{}],10:[function(c,b,e){function d(c){return d.enabled(c)?function(b){b instanceof Error&&(b=b.stack||b.message);var e=new Date,f=e-(d[c]||e);d[c]=e;b=c+" "+b+" +"+d.humanize(f);window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}b.exports=d;d.names=[];d.skips=[];d.enable=function(c){try{localStorage.debug=c}catch(z){}for(var b=(c||"").split(/[\s,]+/),e=b.length,f=0;f<e;f++)c=
b[f].replace("*",".*?"),"-"===c[0]?d.skips.push(new RegExp("^"+c.substr(1)+"$")):d.names.push(new RegExp("^"+c+"$"))};d.disable=function(){d.enable("")};d.humanize=function(c){return 36E5<=c?(c/36E5).toFixed(1)+"h":6E4<=c?(c/6E4).toFixed(1)+"m":1E3<=c?(c/1E3|0)+"s":c+"ms"};d.enabled=function(c){for(var b=0,e=d.skips.length;b<e;b++)if(d.skips[b].test(c))return!1;b=0;for(e=d.names.length;b<e;b++)if(d.names[b].test(c))return!0;return!1};try{window.localStorage&&d.enable(localStorage.debug)}catch(g){}},
{}],11:[function(c,b,e){b.exports=c("./lib/")},{"./lib/":12}],12:[function(c,b,e){b.exports=c("./socket");b.exports.parser=c("engine.io-parser")},{"./socket":13,"engine.io-parser":24}],13:[function(c,b,e){(function(d){function e(c,b){if(!(this instanceof e))return new e(c,b);b=b||{};c&&"object"==typeof c&&(b=c,c=null);c&&(c=N(c),b.host=c.host,b.secure="https"==c.protocol||"wss"==c.protocol,b.port=c.port,c.query&&(b.query=c.query));this.secure=null!=b.secure?b.secure:d.location&&"https:"==location.protocol;
b.host&&(c=b.host.split(":"),b.hostname=c.shift(),c.length?b.port=c.pop():b.port||(b.port=this.secure?"443":"80"));this.agent=b.agent||!1;this.hostname=b.hostname||(d.location?location.hostname:"localhost");this.port=b.port||(d.location&&location.port?location.port:this.secure?443:80);this.query=b.query||{};"string"==typeof this.query&&(this.query=xa.decode(this.query));this.upgrade=!1!==b.upgrade;this.path=(b.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!b.forceJSONP;this.jsonp=!1!==
b.jsonp;this.forceBase64=!!b.forceBase64;this.enablesXDR=!!b.enablesXDR;this.timestampParam=b.timestampParam||"t";this.timestampRequests=b.timestampRequests;this.transports=b.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.callbackBuffer=[];this.policyPort=b.policyPort||843;this.rememberUpgrade=b.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=b.onlyBinaryUpgrades;this.pfx=b.pfx||null;this.key=b.key||null;this.passphrase=b.passphrase||null;this.cert=
b.cert||null;this.ca=b.ca||null;this.ciphers=b.ciphers||null;this.rejectUnauthorized=b.rejectUnauthorized||null;this.open()}var f=c("./transports"),q=c("component-emitter"),w=c("debug")("engine.io-client:socket"),z=c("indexof"),E=c("engine.io-parser"),N=c("parseuri"),O=c("parsejson"),xa=c("parseqs");b.exports=e;e.priorWebsocketSuccess=!1;q(e.prototype);e.protocol=E.protocol;e.Socket=e;e.Transport=c("./transport");e.transports=c("./transports");e.parser=c("engine.io-parser");e.prototype.createTransport=
function(c){w('creating transport "%s"',c);var b=this.query,d={},e;for(e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);d.EIO=E.protocol;d.transport=c;this.id&&(d.sid=this.id);return new f[c]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:d,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,
key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})};e.prototype.open=function(){if(this.rememberUpgrade&&e.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))var c="websocket";else{if(0==this.transports.length){var b=this;setTimeout(function(){b.emit("error","No transports available")},0);return}c=this.transports[0]}this.readyState="opening";try{c=this.createTransport(c)}catch(Ob){this.transports.shift();
this.open();return}c.open();this.setTransport(c)};e.prototype.setTransport=function(c){w("setting transport %s",c.name);var b=this;this.transport&&(w("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=c;c.on("drain",function(){b.onDrain()}).on("packet",function(c){b.onPacket(c)}).on("error",function(c){b.onError(c)}).on("close",function(){b.onClose("transport close")})};e.prototype.probe=function(c){function b(){if(O.onlyBinaryUpgrades){var b=
!this.supportsBinary&&O.transport.supportsBinary;N=N||b}N||(w('probe transport "%s" opened',c),z.send([{type:"ping",data:"probe"}]),z.once("packet",function(b){N||("pong"==b.type&&"probe"==b.data?(w('probe transport "%s" pong',c),O.upgrading=!0,O.emit("upgrading",z),z&&(e.priorWebsocketSuccess="websocket"==z.name,w('pausing current transport "%s"',O.transport.name),O.transport.pause(function(){N||"closed"==O.readyState||(w("changing transport and sending upgrade packet"),E(),O.setTransport(z),z.send([{type:"upgrade"}]),
O.emit("upgrade",z),z=null,O.upgrading=!1,O.flush())}))):(w('probe transport "%s" failed',c),b=Error("probe error"),b.transport=z.name,O.emit("upgradeError",b)))}))}function d(){N||(N=!0,E(),z.close(),z=null)}function f(b){var e=Error("probe error: "+b);e.transport=z.name;d();w('probe transport "%s" failed because of error: %s',c,b);O.emit("upgradeError",e)}function g(){f("transport closed")}function m(){f("socket closed")}function q(c){z&&c.name!=z.name&&(w('"%s" works - aborting "%s"',c.name,z.name),
d())}function E(){z.removeListener("open",b);z.removeListener("error",f);z.removeListener("close",g);O.removeListener("close",m);O.removeListener("upgrading",q)}w('probing transport "%s"',c);var z=this.createTransport(c,{probe:1}),N=!1,O=this;e.priorWebsocketSuccess=!1;z.once("open",b);z.once("error",f);z.once("close",g);this.once("close",m);this.once("upgrading",q);z.open()};e.prototype.onOpen=function(){w("socket open");this.readyState="open";e.priorWebsocketSuccess="websocket"==this.transport.name;
this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){w("starting upgrade probes");for(var c=0,b=this.upgrades.length;c<b;c++)this.probe(this.upgrades[c])}};e.prototype.onPacket=function(c){if("opening"==this.readyState||"open"==this.readyState)switch(w('socket receive: type "%s", data "%s"',c.type,c.data),this.emit("packet",c),this.emit("heartbeat"),c.type){case "open":this.onHandshake(O(c.data));break;case "pong":this.setPing();break;case "error":var b=Error("server error");
b.code=c.data;this.emit("error",b);break;case "message":this.emit("data",c.data),this.emit("message",c.data)}else w('packet received with socket readyState "%s"',this.readyState)};e.prototype.onHandshake=function(c){this.emit("handshake",c);this.id=c.sid;this.transport.query.sid=c.sid;this.upgrades=this.filterUpgrades(c.upgrades);this.pingInterval=c.pingInterval;this.pingTimeout=c.pingTimeout;this.onOpen();"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),
this.on("heartbeat",this.onHeartbeat))};e.prototype.onHeartbeat=function(c){clearTimeout(this.pingTimeoutTimer);var b=this;b.pingTimeoutTimer=setTimeout(function(){if("closed"!=b.readyState)b.onClose("ping timeout")},c||b.pingInterval+b.pingTimeout)};e.prototype.setPing=function(){var c=this;clearTimeout(c.pingIntervalTimer);c.pingIntervalTimer=setTimeout(function(){w("writing ping packet - expecting pong within %sms",c.pingTimeout);c.ping();c.onHeartbeat(c.pingTimeout)},c.pingInterval)};e.prototype.ping=
function(){this.sendPacket("ping")};e.prototype.onDrain=function(){for(var c=0;c<this.prevBufferLen;c++)if(this.callbackBuffer[c])this.callbackBuffer[c]();this.writeBuffer.splice(0,this.prevBufferLen);this.callbackBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0==this.writeBuffer.length?this.emit("drain"):this.flush()};e.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(w("flushing %d packets in socket",this.writeBuffer.length),
this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};e.prototype.write=e.prototype.send=function(c,b){this.sendPacket("message",c,b);return this};e.prototype.sendPacket=function(c,b,d){"closing"!=this.readyState&&"closed"!=this.readyState&&(c={type:c,data:b},this.emit("packetCreate",c),this.writeBuffer.push(c),this.callbackBuffer.push(d),this.flush())};e.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){var c=function(){e.once("upgrade",
b);e.once("upgradeError",b)},b=function(){e.removeListener("upgrade",b);e.removeListener("upgradeError",b);d()},d=function(){e.onClose("forced close");w("socket closing - telling transport to close");e.transport.close()};this.readyState="closing";var e=this;if(this.writeBuffer.length)this.once("drain",function(){this.upgrading?c():d()});else this.upgrading?c():d()}return this};e.prototype.onError=function(c){w("socket error %j",c);e.priorWebsocketSuccess=!1;this.emit("error",c);this.onClose("transport error",
c)};e.prototype.onClose=function(c,b){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){w('socket close with reason: "%s"',c);var d=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);setTimeout(function(){d.writeBuffer=[];d.callbackBuffer=[];d.prevBufferLen=0},0);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",c,b)}};e.prototype.filterUpgrades=
function(c){for(var b=[],d=0,e=c.length;d<e;d++)~z(this.transports,c[d])&&b.push(c[d]);return b}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":8,debug:21,"engine.io-parser":24,indexof:32,parsejson:40,parseqs:41,parseuri:23}],14:[function(c,b,e){function d(c){this.path=c.path;this.hostname=c.hostname;this.port=c.port;this.secure=c.secure;this.query=c.query;this.timestampParam=
c.timestampParam;this.timestampRequests=c.timestampRequests;this.readyState="";this.agent=c.agent||!1;this.socket=c.socket;this.enablesXDR=c.enablesXDR;this.pfx=c.pfx;this.key=c.key;this.passphrase=c.passphrase;this.cert=c.cert;this.ca=c.ca;this.ciphers=c.ciphers;this.rejectUnauthorized=c.rejectUnauthorized}var g=c("engine.io-parser");c=c("component-emitter");b.exports=d;c(d.prototype);d.timestamps=0;d.prototype.onError=function(c,b){c=Error(c);c.type="TransportError";c.description=b;this.emit("error",
c);return this};d.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this};d.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this};d.prototype.send=function(c){if("open"==this.readyState)this.write(c);else throw Error("Transport not open");};d.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};d.prototype.onData=function(c){c=
g.decodePacket(c,this.socket.binaryType);this.onPacket(c)};d.prototype.onPacket=function(c){this.emit("packet",c)};d.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":8,"engine.io-parser":24}],15:[function(c,b,e){(function(b){var d=c("xmlhttprequest"),f=c("./polling-xhr"),q=c("./polling-jsonp"),w=c("./websocket");e.polling=function(c){var e=!1,g=!1,m=!1!==c.jsonp;b.location&&(g="https:"==location.protocol,(e=location.port)||(e=g?443:80),e=c.hostname!=
location.hostname||e!=c.port,g=c.secure!=g);c.xdomain=e;c.xscheme=g;if("open"in new d(c)&&!c.forceJSONP)return new f(c);if(!m)throw Error("JSONP disabled");return new q(c)};e.websocket=w}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(c,b,e){(function(d){function e(){}function f(c){q.call(this,c);this.query=this.query||{};N||(d.___eio||(d.___eio=
[]),N=d.___eio);this.index=N.length;var b=this;N.push(function(c){b.onData(c)});this.query.j=this.index;d.document&&d.addEventListener&&d.addEventListener("beforeunload",function(){b.script&&(b.script.onerror=e)},!1)}var q=c("./polling"),w=c("component-inherit");b.exports=f;var z=/\n/g,E=/\\n/g,N;w(f,q);f.prototype.supportsBinary=!1;f.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),
this.iframe=this.form=null);q.prototype.doClose.call(this)};f.prototype.doPoll=function(){var c=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);b.async=!0;b.src=this.uri();b.onerror=function(b){c.onError("jsonp poll error",b)};var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(b,d);this.script=b;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var c=document.createElement("iframe");
document.body.appendChild(c);document.body.removeChild(c)},100)};f.prototype.doWrite=function(c,b){function d(){e();b()}function e(){if(f.iframe)try{f.form.removeChild(f.iframe)}catch(zg){f.onError("jsonp polling iframe removal error",zg)}try{w=document.createElement('<iframe src="javascript:0" name="'+f.iframeId+'">')}catch(zg){w=document.createElement("iframe"),w.name=f.iframeId,w.src="javascript:0"}w.id=f.iframeId;f.form.appendChild(w);f.iframe=w}var f=this;if(!this.form){var g=document.createElement("form"),
m=document.createElement("textarea"),q=this.iframeId="eio_iframe_"+this.index,w;g.className="socketio";g.style.position="absolute";g.style.top="-1000px";g.style.left="-1000px";g.target=q;g.method="POST";g.setAttribute("accept-charset","utf-8");m.name="d";g.appendChild(m);document.body.appendChild(g);this.form=g;this.area=m}this.form.action=this.uri();e();c=c.replace(E,"\\\n");this.area.value=c.replace(z,"\\n");try{this.form.submit()}catch(zg){}this.iframe.attachEvent?this.iframe.onreadystatechange=
function(){"complete"==f.iframe.readyState&&d()}:this.iframe.onload=d}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-inherit":9}],17:[function(c,b,e){(function(d){function e(){}function f(c){E.call(this,c);if(d.location){var b="https:"==location.protocol,e=location.port;e||(e=b?443:80);this.xd=c.hostname!=d.location.hostname||e!=c.port;this.xs=c.secure!=b}}function q(c){this.method=c.method||"GET";this.uri=
c.uri;this.xd=!!c.xd;this.xs=!!c.xs;this.async=!1!==c.async;this.data=void 0!=c.data?c.data:null;this.agent=c.agent;this.isBinary=c.isBinary;this.supportsBinary=c.supportsBinary;this.enablesXDR=c.enablesXDR;this.pfx=c.pfx;this.key=c.key;this.passphrase=c.passphrase;this.cert=c.cert;this.ca=c.ca;this.ciphers=c.ciphers;this.rejectUnauthorized=c.rejectUnauthorized;this.create()}function w(){for(var c in q.requests)q.requests.hasOwnProperty(c)&&q.requests[c].abort()}var z=c("xmlhttprequest"),E=c("./polling"),
N=c("component-emitter"),O=c("component-inherit"),xa=c("debug")("engine.io-client:polling-xhr");b.exports=f;b.exports.Request=q;O(f,E);f.prototype.supportsBinary=!0;f.prototype.request=function(c){c=c||{};c.uri=this.uri();c.xd=this.xd;c.xs=this.xs;c.agent=this.agent||!1;c.supportsBinary=this.supportsBinary;c.enablesXDR=this.enablesXDR;c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;return new q(c)};
f.prototype.doWrite=function(c,b){c=this.request({method:"POST",data:c,isBinary:"string"!==typeof c&&void 0!==c});var d=this;c.on("success",b);c.on("error",function(c){d.onError("xhr post error",c)});this.sendXhr=c};f.prototype.doPoll=function(){xa("xhr poll");var c=this.request(),b=this;c.on("data",function(c){b.onData(c)});c.on("error",function(c){b.onError("xhr poll error",c)});this.pollXhr=c};N(q.prototype);q.prototype.create=function(){var c={agent:this.agent,xdomain:this.xd,xscheme:this.xs,
enablesXDR:this.enablesXDR};c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;var b=this.xhr=new z(c),e=this;try{xa("xhr open %s: %s",this.method,this.uri);b.open(this.method,this.uri,this.async);this.supportsBinary&&(b.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?b.setRequestHeader("Content-type","application/octet-stream"):b.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(yg){}"withCredentials"in
b&&(b.withCredentials=!0);this.hasXDR()?(b.onload=function(){e.onLoad()},b.onerror=function(){e.onError(b.responseText)}):b.onreadystatechange=function(){if(4==b.readyState)if(200==b.status||1223==b.status)e.onLoad();else setTimeout(function(){e.onError(b.status)},0)};xa("xhr data %s",this.data);b.send(this.data)}catch(yg){setTimeout(function(){e.onError(yg)},0);return}d.document&&(this.index=q.requestsCount++,q.requests[this.index]=this)};q.prototype.onSuccess=function(){this.emit("success");this.cleanup()};
q.prototype.onData=function(c){this.emit("data",c);this.onSuccess()};q.prototype.onError=function(c){this.emit("error",c);this.cleanup(!0)};q.prototype.cleanup=function(c){if("undefined"!=typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=this.xhr.onerror=e:this.xhr.onreadystatechange=e;if(c)try{this.xhr.abort()}catch(ye){}d.document&&delete q.requests[this.index];this.xhr=null}};q.prototype.onLoad=function(){try{try{var c=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(Ob){}var b=
"application/octet-stream"===c?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(Ob){this.onError(Ob)}if(null!=b)this.onData(b)};q.prototype.hasXDR=function(){return"undefined"!==typeof d.XDomainRequest&&!this.xs&&this.enablesXDR};q.prototype.abort=function(){this.cleanup()};d.document&&(q.requestsCount=0,q.requests={},d.attachEvent?d.attachEvent("onunload",w):d.addEventListener&&d.addEventListener("beforeunload",w,!1))}).call(this,"undefined"!==typeof global?global:"undefined"!==
typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-emitter":8,"component-inherit":9,debug:21,xmlhttprequest:20}],18:[function(c,b,e){function d(c){var b=c&&c.forceBase64;if(!z||b)this.supportsBinary=!1;g.call(this,c)}var g=c("../transport"),m=c("parseqs"),q=c("engine.io-parser");e=c("component-inherit");var w=c("debug")("engine.io-client:polling");b.exports=d;var z=null!=(new (c("xmlhttprequest"))({xdomain:!1})).responseType;e(d,g);d.prototype.name="polling";d.prototype.doOpen=
function(){this.poll()};d.prototype.pause=function(c){function b(){w("paused");d.readyState="paused";c()}var d=this;this.readyState="pausing";if(this.polling||!this.writable){var e=0;this.polling&&(w("we are currently polling - waiting to pause"),e++,this.once("pollComplete",function(){w("pre-pause polling complete");--e||b()}));this.writable||(w("we are currently writing - waiting to pause"),e++,this.once("drain",function(){w("pre-pause writing complete");--e||b()}))}else b()};d.prototype.poll=function(){w("polling");
this.polling=!0;this.doPoll();this.emit("poll")};d.prototype.onData=function(c){var b=this;w("polling got data %s",c);q.decodePayload(c,this.socket.binaryType,function(c,d,e){if("opening"==b.readyState)b.onOpen();if("close"==c.type)return b.onClose(),!1;b.onPacket(c)});"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():w('ignoring poll - transport state "%s"',this.readyState))};d.prototype.doClose=function(){function c(){w("writing close packet");
b.write([{type:"close"}])}var b=this;"open"==this.readyState?(w("transport open - closing"),c()):(w("transport not open - deferring close"),this.once("open",c))};d.prototype.write=function(c){var b=this;this.writable=!1;var d=function(){b.writable=!0;b.emit("drain")};b=this;q.encodePayload(c,this.supportsBinary,function(c){b.doWrite(c,d)})};d.prototype.uri=function(){var c=this.query||{},b=this.secure?"https":"http",d="";!1!==this.timestampRequests&&(c[this.timestampParam]=+new Date+"-"+g.timestamps++);
this.supportsBinary||c.sid||(c.b64=1);c=m.encode(c);this.port&&("https"==b&&443!=this.port||"http"==b&&80!=this.port)&&(d=":"+this.port);c.length&&(c="?"+c);return b+"://"+this.hostname+d+this.path+c}},{"../transport":14,"component-inherit":9,debug:21,"engine.io-parser":24,parseqs:41,xmlhttprequest:20}],19:[function(c,b,e){function d(c){c&&c.forceBase64&&(this.supportsBinary=!1);g.call(this,c)}var g=c("../transport"),m=c("engine.io-parser"),q=c("parseqs");e=c("component-inherit");var w=c("debug")("engine.io-client:websocket"),
z=c("ws");b.exports=d;e(d,g);d.prototype.name="websocket";d.prototype.supportsBinary=!0;d.prototype.doOpen=function(){if(this.check()){var c=this.uri(),b={agent:this.agent};b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;this.ws=new z(c,void 0,b);void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.binaryType="arraybuffer";this.addEventListeners()}};d.prototype.addEventListeners=function(){var c=
this;this.ws.onopen=function(){c.onOpen()};this.ws.onclose=function(){c.onClose()};this.ws.onmessage=function(b){c.onData(b.data)};this.ws.onerror=function(b){c.onError("websocket error",b)}};"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(d.prototype.onData=function(c){var b=this;setTimeout(function(){g.prototype.onData.call(b,c)},0)});d.prototype.write=function(c){var b=this;this.writable=!1;for(var d=0,e=c.length;d<e;d++)m.encodePacket(c[d],this.supportsBinary,function(c){try{b.ws.send(c)}catch(ye){w("websocket closed before onclose event")}});
setTimeout(function(){b.writable=!0;b.emit("drain")},0)};d.prototype.onClose=function(){g.prototype.onClose.call(this)};d.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()};d.prototype.uri=function(){var c=this.query||{},b=this.secure?"wss":"ws",d="";this.port&&("wss"==b&&443!=this.port||"ws"==b&&80!=this.port)&&(d=":"+this.port);this.timestampRequests&&(c[this.timestampParam]=+new Date);this.supportsBinary||(c.b64=1);c=q.encode(c);c.length&&(c="?"+c);return b+"://"+this.hostname+
d+this.path+c};d.prototype.check=function(){return!!z&&!("__initialize"in z&&this.name===d.prototype.name)}},{"../transport":14,"component-inherit":9,debug:21,"engine.io-parser":24,parseqs:41,ws:66}],20:[function(c,b,e){var d=c("has-cors");b.exports=function(c){var b=c.xdomain,e=c.xscheme;c=c.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!b||d))return new XMLHttpRequest}catch(w){}try{if("undefined"!=typeof XDomainRequest&&!e&&c)return new XDomainRequest}catch(w){}if(!b)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(w){}}},
{"has-cors":31}],21:[function(c,b,e){function d(){try{var c=localStorage.debug}catch(m){}return c}e=b.exports=c("./debug");e.log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)};e.formatArgs=function(){var c=arguments,b=this.useColors;c[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+c[0]+(b?"%c ":" ")+"+"+e.humanize(this.diff);if(!b)return c;b="color: "+this.color;c=[c[0],b,"color: inherit"].concat(Array.prototype.slice.call(c,
1));var d=0,f=0;c[0].replace(/%[a-z%]/g,function(c){"%%"!==c&&(d++,"%c"===c&&(f=d))});c.splice(f,0,b);return c};e.save=function(c){try{null==c?localStorage.removeItem("debug"):localStorage.debug=c}catch(m){}};e.load=d;e.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)};e.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");
e.formatters.j=function(c){return JSON.stringify(c)};e.enable(d())},{"./debug":22}],22:[function(c,b,e){e=b.exports=function(c){function b(){}function f(){var c=+new Date;f.diff=c-(g||c);f.prev=g;g=f.curr=c;null==f.useColors&&(f.useColors=e.useColors());null==f.color&&f.useColors&&(f.color=e.colors[d++%e.colors.length]);var b=Array.prototype.slice.call(arguments);b[0]=e.coerce(b[0]);"string"!==typeof b[0]&&(b=["%o"].concat(b));var m=0;b[0]=b[0].replace(/%([a-z%])/g,function(c,d){if("%%"===c)return c;
m++;d=e.formatters[d];"function"===typeof d&&(c=d.call(f,b[m]),b.splice(m,1),m--);return c});"function"===typeof e.formatArgs&&(b=e.formatArgs.apply(f,b));(f.log||e.log||console.log.bind(console)).apply(f,b)}b.enabled=!1;f.enabled=!0;var m=e.enabled(c)?f:b;m.namespace=c;return m};e.coerce=function(c){return c instanceof Error?c.stack||c.message:c};e.disable=function(){e.enable("")};e.enable=function(c){e.save(c);for(var b=(c||"").split(/[\s,]+/),d=b.length,f=0;f<d;f++)b[f]&&(c=b[f].replace(/\*/g,
".*?"),"-"===c[0]?e.skips.push(new RegExp("^"+c.substr(1)+"$")):e.names.push(new RegExp("^"+c+"$")))};e.enabled=function(c){var b;var d=0;for(b=e.skips.length;d<b;d++)if(e.skips[d].test(c))return!1;d=0;for(b=e.names.length;d<b;d++)if(e.names[d].test(c))return!0;return!1};e.humanize=c("ms");e.names=[];e.skips=[];e.formatters={};var d=0,g},{ms:38}],23:[function(c,b,e){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
g="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");b.exports=function(c){var b=c,e=c.indexOf("["),f=c.indexOf("]");-1!=e&&-1!=f&&(c=c.substring(0,e)+c.substring(e,f).replace(/:/g,";")+c.substring(f,c.length));c=d.exec(c||"");for(var m={},N=14;N--;)m[g[N]]=c[N]||"";-1!=e&&-1!=f&&(m.source=b,m.host=m.host.substring(1,m.host.length-1).replace(/;/g,":"),m.authority=m.authority.replace("[","").replace("]","").replace(/;/g,":"),m.ipv6uri=
!0);return m}},{}],24:[function(c,b,e){(function(b){function d(c,b,d){if(!b)return e.encodeBase64Packet(c,d);var f=new FileReader;f.onload=function(){c.data=f.result;e.encodePacket(c,b,!0,d)};return f.readAsArrayBuffer(c.data)}function f(c,b,d){var e=Array(c.length);d=N(c.length,d);for(var f=function(c,d,f){b(d,function(b,d){e[c]=d;f(b,e)})},g=0;g<c.length;g++)f(g,c[g],d)}var q=c("./keys"),w=c("has-binary"),z=c("arraybuffer.slice"),E=c("base64-arraybuffer"),N=c("after"),O=c("utf8"),xa=navigator.userAgent.match(/Android/i),
l=/PhantomJS/i.test(navigator.userAgent),h=xa||l;e.protocol=3;var n=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},p=q(n),r={type:"error",data:"parser error"},t=c("blob");e.encodePacket=function(c,f,g,m){"function"==typeof f&&(m=f,f=!1);"function"==typeof g&&(m=g,g=null);var q=void 0===c.data?void 0:c.data.buffer||c.data;if(b.ArrayBuffer&&q instanceof ArrayBuffer){if(f){g=c.data;f=new Uint8Array(g);g=new Uint8Array(1+g.byteLength);g[0]=n[c.type];for(c=0;c<f.length;c++)g[c+1]=
f[c];c=m(g.buffer)}else c=e.encodeBase64Packet(c,m);return c}if(t&&q instanceof b.Blob)return f?h?c=d(c,f,m):(f=new Uint8Array(1),f[0]=n[c.type],c=new t([f.buffer,c.data]),c=m(c)):c=e.encodeBase64Packet(c,m),c;if(q&&q.base64)return m("b"+e.packets[c.type]+c.data.data);f=n[c.type];void 0!==c.data&&(f+=g?O.encode(String(c.data)):String(c.data));return m(""+f)};e.encodeBase64Packet=function(c,d){var f="b"+e.packets[c.type];if(t&&c.data instanceof t){var g=new FileReader;g.onload=function(){var c=g.result.split(",")[1];
d(f+c)};return g.readAsDataURL(c.data)}try{var m=String.fromCharCode.apply(null,new Uint8Array(c.data))}catch(xn){c=new Uint8Array(c.data);m=Array(c.length);for(var q=0;q<c.length;q++)m[q]=c[q];m=String.fromCharCode.apply(null,m)}f+=b.btoa(m);return d(f)};e.decodePacket=function(c,b,d){if("string"==typeof c||void 0===c){if("b"==c.charAt(0))return e.decodeBase64Packet(c.substr(1),b);if(d)try{c=O.decode(c)}catch(wn){return r}d=c.charAt(0);return Number(d)==d&&p[d]?1<c.length?{type:p[d],data:c.substring(1)}:
{type:p[d]}:r}d=(new Uint8Array(c))[0];c=z(c,1);t&&"blob"===b&&(c=new t([c]));return{type:p[d],data:c}};e.decodeBase64Packet=function(c,d){var e=p[c.charAt(0)];if(!b.ArrayBuffer)return{type:e,data:{base64:!0,data:c.substr(1)}};c=E.decode(c.substr(1));"blob"===d&&t&&(c=new t([c]));return{type:e,data:c}};e.encodePayload=function(c,b,d){"function"==typeof b&&(d=b,b=null);var g=w(c);if(b&&g)return t&&!h?e.encodePayloadAsBlob(c,d):e.encodePayloadAsArrayBuffer(c,d);if(!c.length)return d("0:");f(c,function(c,
d){e.encodePacket(c,g?b:!1,!0,function(c){d(null,c.length+":"+c)})},function(c,b){return d(b.join(""))})};e.decodePayload=function(c,b,d){if("string"!=typeof c)return e.decodePayloadAsBinary(c,b,d);"function"===typeof b&&(d=b,b=null);if(""==c)return d(r,0,1);var f="";for(var g,m,q=0,w=c.length;q<w;q++)if(m=c.charAt(q),":"!=m)f+=m;else{if(""==f||f!=(g=Number(f)))return d(r,0,1);m=c.substr(q+1,g);if(f!=m.length)return d(r,0,1);if(m.length){f=e.decodePacket(m,b,!0);if(r.type==f.type&&r.data==f.data)return d(r,
0,1);if(!1===d(f,q+g,w))return}q+=g;f=""}if(""!=f)return d(r,0,1)};e.encodePayloadAsArrayBuffer=function(c,b){if(!c.length)return b(new ArrayBuffer(0));f(c,function(c,b){e.encodePacket(c,!0,!0,function(c){return b(null,c)})},function(c,d){c=d.reduce(function(c,b){b="string"===typeof b?b.length:b.byteLength;return c+b.toString().length+b+2},0);var e=new Uint8Array(c),f=0;d.forEach(function(c){var b="string"===typeof c,d=c;if(b){d=new Uint8Array(c.length);for(var g=0;g<c.length;g++)d[g]=c.charCodeAt(g);
d=d.buffer}b?e[f++]=0:e[f++]=1;c=d.byteLength.toString();for(g=0;g<c.length;g++)e[f++]=parseInt(c[g]);e[f++]=255;d=new Uint8Array(d);for(g=0;g<d.length;g++)e[f++]=d[g]});return b(e.buffer)})};e.encodePayloadAsBlob=function(c,b){f(c,function(c,b){e.encodePacket(c,!0,!0,function(c){var d=new Uint8Array(1);d[0]=1;if("string"===typeof c){for(var e=new Uint8Array(c.length),f=0;f<c.length;f++)e[f]=c.charCodeAt(f);c=e.buffer;d[0]=0}e=(c instanceof ArrayBuffer?c.byteLength:c.size).toString();var g=new Uint8Array(e.length+
1);for(f=0;f<e.length;f++)g[f]=parseInt(e[f]);g[e.length]=255;t&&(c=new t([d.buffer,g.buffer,c]),b(null,c))})},function(c,d){return b(new t(d))})};e.decodePayloadAsBinary=function(c,b,d){"function"===typeof b&&(d=b,b=null);for(var f=[],g=!1;0<c.byteLength;){for(var m=new Uint8Array(c),q=0===m[0],w="",E=1;255!=m[E];E++){if(310<w.length){g=!0;break}w+=m[E]}if(g)return d(r,0,1);c=z(c,2+w.length);w=parseInt(w);m=z(c,0,w);if(q)try{m=String.fromCharCode.apply(null,new Uint8Array(m))}catch(yn){for(q=new Uint8Array(m),
m="",E=0;E<q.length;E++)m+=String.fromCharCode(q[E])}f.push(m);c=z(c,w)}var N=f.length;f.forEach(function(c,f){d(e.decodePacket(c,b,!0),f,N)})}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./keys":25,after:1,"arraybuffer.slice":2,"base64-arraybuffer":5,blob:6,"has-binary":30,utf8:60}],25:[function(c,b,e){b.exports=Object.keys||function(c){var b=[],d=Object.prototype.hasOwnProperty,e;for(e in c)d.call(c,e)&&b.push(e);return b}},
{}],26:[function(c,b,e){function d(c){m.call(this);c=c||{};this.config={chunksize:16384,pacing:0};for(var b in c)this.config[b]=c[b];this.channel=this.file=null}function g(){m.call(this);this.receiveBuffer=[];this.received=0;this.metadata={};this.channel=null}var m=c("wildemitter");c=c("util");c.inherits(d,m);d.prototype.send=function(c,b){var d=this;this.file=c;this.channel=b;var e="number"!==typeof b.bufferedAmountLowThreshold,f=0,g=function(){var m=new window.FileReader;m.onload=function(){return function(m){d.channel.send(m.target.result);
d.emit("progress",f,c.size,m.target.result);c.size>f+m.target.result.byteLength?e?window.setTimeout(g,d.config.pacing):b.bufferedAmount<=b.bufferedAmountLowThreshold&&window.setTimeout(g,0):(d.emit("progress",c.size,c.size,null),d.emit("sentFile"));f+=d.config.chunksize}}(c);var q=c.slice(f,f+d.config.chunksize);m.readAsArrayBuffer(q)};e||(b.bufferedAmountLowThreshold=8*this.config.chunksize,b.addEventListener("bufferedamountlow",g));window.setTimeout(g,0)};c.inherits(g,m);g.prototype.receive=function(c,
b){var d=this;c&&(this.metadata=c);this.channel=b;b.binaryType="arraybuffer";this.channel.onmessage=function(c){d.received+=c.data.byteLength;d.receiveBuffer.push(c.data);d.emit("progress",d.received,d.metadata.size,c.data);d.received===d.metadata.size?(d.emit("receivedFile",new window.Blob(d.receiveBuffer),d.metadata),d.receiveBuffer=[]):d.received>d.metadata.size&&(console.error("received more than expected, discarding..."),d.receiveBuffer=[])}};b.exports={};b.exports.support="undefined"!==typeof window&&
window&&window.File&&window.FileReader&&window.Blob;b.exports.Sender=d;b.exports.Receiver=g},{util:63,wildemitter:65}],27:[function(c,b,e){var d={};b.exports=function(c,b){var e=2===arguments.length,f=e?b:c;if("undefined"===typeof window||"http:"===window.location.protocol){var g=Error("NavigatorUserMediaError");g.name="HTTPS_REQUIRED";return f(g)}if(window.navigator.userAgent.match("Chrome")){var m=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),N=33,O=!window.chrome.webstore;window.navigator.userAgent.match("Linux")&&
(N=35);sessionStorage.getScreenMediaJSExtensionId?chrome.runtime.sendMessage(sessionStorage.getScreenMediaJSExtensionId,{type:"getScreen",id:1},null,function(b){b&&""!==b.sourceId?(c=e&&c||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3}}},c.video.mandatory.chromeMediaSourceId=b.sourceId,window.navigator.mediaDevices.getUserMedia(c).then(function(c){f(null,c)}).catch(function(c){f(c)})):(b=Error("NavigatorUserMediaError"),
b.name="NotAllowedError",f(b))}):window.cefGetScreenMedia?window.cefGetScreenMedia(function(b){b?(c=e&&c||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},c.video.mandatory.chromeMediaSourceId=b,window.navigator.mediaDevices.getUserMedia(c).then(function(c){f(null,c)}).catch(function(c){f(c)})):(b=Error("cefGetScreenMediaError"),b.name="CEF_GETSCREENMEDIA_CANCELED",
f(b))}):O||26<=m&&m<=N?(c=e&&c||{video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3,chromeMediaSource:"screen"}}},window.navigator.mediaDevices.getUserMedia(c).then(function(c){f(null,c)}).catch(function(c){f(c)})):(m=window.setTimeout(function(){g=Error("NavigatorUserMediaError");g.name="EXTENSION_UNAVAILABLE";return f(g)},1E3),d[m]=[f,e?c:null],window.postMessage({type:"getScreen",id:m},"*"))}else window.navigator.userAgent.match("Firefox")&&
(33<=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10)?(c=e&&c||{video:{mozMediaSource:"window",mediaSource:"window"}},window.navigator.mediaDevices.getUserMedia(c).then(function(c){f(null,c);var b=c.currentTime,d=window.setInterval(function(){c||window.clearInterval(d);if(c.currentTime==b&&(window.clearInterval(d),c.onended))c.onended();b=c.currentTime},500)}).catch(function(c){f(c)})):(g=Error("NavigatorUserMediaError"),g.name="EXTENSION_UNAVAILABLE"))};"undefined"!==typeof window&&
window.addEventListener("message",function(c){if(c.origin==window.location.origin)if("gotScreen"==c.data.type&&d[c.data.id]){var b=d[c.data.id],e=b[1],f=b[0];delete d[c.data.id];""===c.data.sourceId?(c=Error("NavigatorUserMediaError"),c.name="NotAllowedError",f(c)):(e=e||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},e.video.mandatory.chromeMediaSourceId=
c.data.sourceId,window.navigator.mediaDevices.getUserMedia(e).then(function(c){f(null,c)}).catch(function(c){f(c)}))}else"getScreenPending"==c.data.type&&window.clearTimeout(c.data.id)})},{}],28:[function(c,b,e){b.exports=function(){return this}()},{}],29:[function(c,b,e){var d=c("wildemitter"),g;"undefined"!==typeof window&&(g=window.AudioContext||window.webkitAudioContext);var m=null;b.exports=function(c,b){var e=new d;if(!g)return e;b=b||{};var f=b.smoothing||.1,q=b.interval||50,w=b.threshold,
xa=b.play;b=b.history||10;var l=!0;m||(m=new g);var h=m.createAnalyser();h.fftSize=512;h.smoothingTimeConstant=f;var n=new Float32Array(h.frequencyBinCount);c.jquery&&(c=c[0]);if(c instanceof HTMLAudioElement||c instanceof HTMLVideoElement){var p=m.createMediaElementSource(c);"undefined"===typeof xa&&(xa=!0)}else p=m.createMediaStreamSource(c);w=w||-50;p.connect(h);xa&&h.connect(m.destination);e.speaking=!1;e.setThreshold=function(c){w=c};e.setInterval=function(c){q=c};e.stop=function(){l=!1;e.emit("volume_change",
-100,w);e.speaking&&(e.speaking=!1,e.emit("stopped_speaking"));h.disconnect();p.disconnect()};e.speakingHistory=[];for(c=0;c<b;c++)e.speakingHistory.push(0);var t=function(){setTimeout(function(){if(l){var c=-Infinity;h.getFloatFrequencyData(n);for(var b=4,d=n.length;b<d;b++)n[b]>c&&0>n[b]&&(c=n[b]);e.emit("volume_change",c,w);b=0;if(c>w&&!e.speaking){for(d=e.speakingHistory.length-3;d<e.speakingHistory.length;d++)b+=e.speakingHistory[d];2<=b&&(e.speaking=!0,e.emit("speaking"))}else if(c<w&&e.speaking){for(d=
0;d<e.speakingHistory.length;d++)b+=e.speakingHistory[d];0==b&&(e.speaking=!1,e.emit("stopped_speaking"))}e.speakingHistory.shift();e.speakingHistory.push(0+(c>w));t()}},q)};t();return e}},{wildemitter:65}],30:[function(c,b,e){(function(d){var e=c("isarray");b.exports=function(c){function b(c){if(!c)return!1;if(d.Buffer&&d.Buffer.isBuffer(c)||d.ArrayBuffer&&c instanceof ArrayBuffer||d.Blob&&c instanceof Blob||d.File&&c instanceof File)return!0;if(e(c))for(var f=0;f<c.length;f++){if(b(c[f]))return!0}else if(c&&
"object"==typeof c)for(f in c.toJSON&&(c=c.toJSON()),c)if(Object.prototype.hasOwnProperty.call(c,f)&&b(c[f]))return!0;return!1}return b(c)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{isarray:33}],31:[function(c,b,e){c=c("global");try{b.exports="XMLHttpRequest"in c&&"withCredentials"in new c.XMLHttpRequest}catch(f){b.exports=!1}},{global:28}],32:[function(c,b,e){var d=[].indexOf;b.exports=function(c,b){if(d)return c.indexOf(b);
for(var e=0;e<c.length;++e)if(c[e]===b)return e;return-1}},{}],33:[function(c,b,e){b.exports=Array.isArray||function(c){return"[object Array]"==Object.prototype.toString.call(c)}},{}],34:[function(c,b,e){(function(c){function b(c){if(b[c]!==w)return b[c];if("bug-string-char-index"==c)var e=!1;else if("json"==c)e=b("json-stringify")&&b("json-parse");else{var f;if("json-stringify"==c){e=E.stringify;var g="function"==typeof e&&N;if(g){(f=function(){return 1}).toJSON=f;try{g="0"===e(0)&&"0"===e(new Number)&&
'""'==e(new String)&&e(d)===w&&e(w)===w&&e()===w&&"1"===e(f)&&"[1]"==e([f])&&"[null]"==e([w])&&"null"==e(null)&&"[null,null,null]"==e([w,d,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==e({a:[f,!0,!1,null,"\x00\b\n\f\r\t"]})&&"1"===e(null,f)&&"[\n 1,\n 2\n]"==e([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==e(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==e(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==e(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==e(new Date(-1))}catch(ze){g=
!1}}e=g}if("json-parse"==c){e=E.parse;if("function"==typeof e)try{if(0===e("0")&&!e(!1)){f=e('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var m=5==f.a.length&&1===f.a[0];if(m){try{m=!e('"\t"')}catch(ze){}if(m)try{m=1!==e("01")}catch(ze){}if(m)try{m=1!==e("1.")}catch(ze){}}}}catch(ze){m=!1}e=m}}return b[c]=!!e}var d={}.toString,f,w,z="object"==typeof JSON&&JSON,E="object"==typeof e&&e&&!e.nodeType&&e;E&&z?(E.stringify=z.stringify,E.parse=z.parse):E=c.JSON=z||{};var N=new Date(-0xc782b5b800cec);
try{N=-109252==N.getUTCFullYear()&&0===N.getUTCMonth()&&1===N.getUTCDate()&&10==N.getUTCHours()&&37==N.getUTCMinutes()&&6==N.getUTCSeconds()&&708==N.getUTCMilliseconds()}catch(zn){}if(!b("json")){var O=b("bug-string-char-index");if(!N)var xa=Math.floor,l=[0,31,59,90,120,151,181,212,243,273,304,334],h=function(c,b){return l[b]+365*(c-1970)+xa((c-1969+(b=+(1<b)))/4)-xa((c-1901+b)/100)+xa((c-1601+b)/400)};(f={}.hasOwnProperty)||(f=function(c){var b={};if((b.__proto__=null,b.__proto__={toString:1},b).toString!=
d)f=function(c){var b=this.__proto__;c=c in(this.__proto__=null,this);this.__proto__=b;return c};else{var e=b.constructor;f=function(c){var b=(this.constructor||e).prototype;return c in this&&!(c in b&&this[c]===b[c])}}b=null;return f.call(this,c)});var n={"boolean":1,number:1,string:1,undefined:1};var p=function(c,b){var e=0,g,m;(g=function(){this.valueOf=0}).prototype.valueOf=0;var q=new g;for(m in q)f.call(q,m)&&e++;g=q=null;e?p=2==e?function(c,b){var e={},g="[object Function]"==d.call(c),m;for(m in c)g&&
"prototype"==m||f.call(e,m)||!(e[m]=1)||!f.call(c,m)||b(m)}:function(c,b){var e="[object Function]"==d.call(c),g,m;for(g in c)e&&"prototype"==g||!f.call(c,g)||(m="constructor"===g)||b(g);(m||f.call(c,g="constructor"))&&b(g)}:(q="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),p=function(c,b){var e="[object Function]"==d.call(c),g,m;if(m=!e&&"function"!=typeof c.constructor)m=typeof c.hasOwnProperty,m="object"==m?!!c.hasOwnProperty:!n[m];m=
m?c.hasOwnProperty:f;for(g in c)e&&"prototype"==g||!m.call(c,g)||b(g);for(e=q.length;g=q[--e];m.call(c,g)&&b(g));});return p(c,b)};if(!b("json-stringify")){var t={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},r=function(c,b){return("000000"+(b||0)).slice(-c)},x=function(c){var b='"',d=0,e=c.length,f=10<e&&O,g;for(f&&(g=c.split(""));d<e;d++){var m=c.charCodeAt(d);switch(m){case 8:case 9:case 10:case 12:case 13:case 34:case 92:b+=t[m];break;default:b=32>m?b+("\\u00"+r(2,m.toString(16))):
b+(f?g[d]:O?c.charAt(d):c[d])}}return b+'"'},A=function(c,b,e,g,m,q,E){var N;try{var z=b[c]}catch(Bn){}if("object"==typeof z&&z){var O=d.call(z);if("[object Date]"!=O||f.call(z,"toJSON"))"function"==typeof z.toJSON&&("[object Number]"!=O&&"[object String]"!=O&&"[object Array]"!=O||f.call(z,"toJSON"))&&(z=z.toJSON(c));else if(z>-1/0&&z<1/0){if(h){var l=xa(z/864E5);for(O=xa(l/365.2425)+1970-1;h(O+1,0)<=l;O++);for(N=xa((l-h(O,0))/30.42);h(O,N+1)<=l;N++);l=1+l-h(O,N);var n=(z%864E5+864E5)%864E5;var xe=
xa(n/36E5)%24;var ye=xa(n/6E4)%60;var t=xa(n/1E3)%60;n%=1E3}else O=z.getUTCFullYear(),N=z.getUTCMonth(),l=z.getUTCDate(),xe=z.getUTCHours(),ye=z.getUTCMinutes(),t=z.getUTCSeconds(),n=z.getUTCMilliseconds();z=(0>=O||1E4<=O?(0>O?"-":"+")+r(6,0>O?-O:O):r(4,O))+"-"+r(2,N+1)+"-"+r(2,l)+"T"+r(2,xe)+":"+r(2,ye)+":"+r(2,t)+"."+r(3,n)+"Z"}else z=null}e&&(z=e.call(b,c,z));if(null===z)return"null";O=d.call(z);if("[object Boolean]"==O)return""+z;if("[object Number]"==O)return z>-1/0&&z<1/0?""+z:"null";if("[object String]"==
O)return x(""+z);if("object"==typeof z){for(c=E.length;c--;)if(E[c]===z)throw TypeError();E.push(z);var Ob=[];b=q;q+=m;if("[object Array]"==O){N=0;for(c=z.length;N<c;N++)O=A(N,z,e,g,m,q,E),Ob.push(O===w?"null":O);c=Ob.length?m?"[\n"+q+Ob.join(",\n"+q)+"\n"+b+"]":"["+Ob.join(",")+"]":"[]"}else p(g||z,function(c){var b=A(c,z,e,g,m,q,E);b!==w&&Ob.push(x(c)+":"+(m?" ":"")+b)}),c=Ob.length?m?"{\n"+q+Ob.join(",\n"+q)+"\n"+b+"}":"{"+Ob.join(",")+"}":"{}";E.pop();return c}};E.stringify=function(c,b,e){var f;
if("function"==typeof b||"object"==typeof b&&b)if("[object Function]"==(f=d.call(b)))var g=b;else if("[object Array]"==f){var m={};for(var q=0,w=b.length,E;q<w;E=b[q++],(f=d.call(E),"[object String]"==f||"[object Number]"==f)&&(m[E]=1));}if(e)if("[object Number]"==(f=d.call(e))){if(0<(e-=e%1)){var z="";for(10<e&&(e=10);z.length<e;z+=" ");}}else"[object String]"==f&&(z=10>=e.length?e:e.slice(0,10));return A("",(E={},E[""]=c,E),g,m,z,"",[])}}if(!b("json-parse")){var B=String.fromCharCode,y={92:"\\",
34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},v,D,C=function(){v=D=null;throw SyntaxError();},H=function(){for(var c=D,b=c.length,d,e,f,g,m;v<b;)switch(m=c.charCodeAt(v),m){case 9:case 10:case 13:case 32:v++;break;case 123:case 125:case 91:case 93:case 58:case 44:return d=O?c.charAt(v):c[v],v++,d;case 34:d="@";for(v++;v<b;)if(m=c.charCodeAt(v),32>m)C();else if(92==m)switch(m=c.charCodeAt(++v),m){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:d+=y[m];v++;break;case 117:e=
++v;for(f=v+4;v<f;v++)m=c.charCodeAt(v),48<=m&&57>=m||97<=m&&102>=m||65<=m&&70>=m||C();d+=B("0x"+c.slice(e,v));break;default:C()}else{if(34==m)break;m=c.charCodeAt(v);for(e=v;32<=m&&92!=m&&34!=m;)m=c.charCodeAt(++v);d+=c.slice(e,v)}if(34==c.charCodeAt(v))return v++,d;C();default:e=v;45==m&&(g=!0,m=c.charCodeAt(++v));if(48<=m&&57>=m){for(48==m&&(m=c.charCodeAt(v+1),48<=m&&57>=m)&&C();v<b&&(m=c.charCodeAt(v),48<=m&&57>=m);v++);if(46==c.charCodeAt(v)){for(f=++v;f<b&&(m=c.charCodeAt(f),48<=m&&57>=m);f++);
f==v&&C();v=f}m=c.charCodeAt(v);if(101==m||69==m){m=c.charCodeAt(++v);43!=m&&45!=m||v++;for(f=v;f<b&&(m=c.charCodeAt(f),48<=m&&57>=m);f++);f==v&&C();v=f}return+c.slice(e,v)}g&&C();if("true"==c.slice(v,v+4))return v+=4,!0;if("false"==c.slice(v,v+5))return v+=5,!1;if("null"==c.slice(v,v+4))return v+=4,null;C()}return"$"},F=function(c){var b,d;"$"==c&&C();if("string"==typeof c){if("@"==(O?c.charAt(0):c[0]))return c.slice(1);if("["==c){for(b=[];;d||(d=!0)){c=H();if("]"==c)break;d&&(","==c?(c=H(),"]"==
c&&C()):C());","==c&&C();b.push(F(c))}return b}if("{"==c){for(b={};;d||(d=!0)){c=H();if("}"==c)break;d&&(","==c?(c=H(),"}"==c&&C()):C());","!=c&&"string"==typeof c&&"@"==(O?c.charAt(0):c[0])&&":"==H()||C();b[c.slice(1)]=F(H())}return b}C()}return c},J=function(c,b,d){d=G(c,b,d);d===w?delete c[b]:c[b]=d},G=function(c,b,e){var f=c[b],g;if("object"==typeof f&&f)if("[object Array]"==d.call(f))for(g=f.length;g--;)J(f,g,e);else p(f,function(c){J(f,c,e)});return e.call(c,b,f)};E.parse=function(c,b){var e;
v=0;D=""+c;c=F(H());"$"!=H()&&C();v=D=null;return b&&"[object Function]"==d.call(b)?G((e={},e[""]=c,e),"",b):c}}}})(this)},{}],35:[function(c,b,e){function d(c){var b=!0;c.getTracks().forEach(function(c){b="ended"===c.readyState&&b});return b}function g(){if("undefined"===typeof window||!window.navigator.mozGetUserMedia)return!1;var c=window.navigator.userAgent.match(/Firefox\/(\d+)\./);return 50>(c&&1<=c.length&&parseInt(c[1],10))}function m(c){z.call(this);var b=this.config={detectSpeakingEvents:!1,
audioFallback:!1,media:{audio:!0,video:!0},harkOptions:null,logger:E},d;for(d in c)c.hasOwnProperty(d)&&(this.config[d]=c[d]);this.logger=b.logger;this._log=this.logger.log.bind(this.logger,"LocalMedia:");this._logerror=this.logger.error.bind(this.logger,"LocalMedia:");this.localStreams=[];this.localScreens=[];navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||this._logerror("Your browser does not support local media capture.");this._audioMonitors=[];this.on("localStreamStopped",this._stopAudioMonitor.bind(this));
this.on("localScreenStopped",this._stopAudioMonitor.bind(this))}e=c("util");var q=c("hark"),w=c("getscreenmedia"),z=c("wildemitter"),E=c("mockconsole");e.inherits(m,z);m.prototype.start=function(c,b){var e=this,f=c||this.config.media;this.emit("localStreamRequested",f);navigator.mediaDevices.getUserMedia(f).then(function(c){f.audio&&e.config.detectSpeakingEvents&&e._setupAudioMonitor(c,e.config.harkOptions);e.localStreams.push(c);c.getTracks().forEach(function(b){b.addEventListener("ended",function(){d(c)&&
e._removeStream(c)})});e.emit("localStream",c);if(b)return b(null,c)}).catch(function(c){if(e.config.audioFallback&&"NotFoundError"===c.name&&!1!==f.video)f.video=!1,e.start(f,b);else if(e.emit("localStreamRequestFailed",f),b)return b(c,null)})};m.prototype.stop=function(c){this.stopStream(c);this.stopScreenShare(c)};m.prototype.stopStream=function(c){var b=this;c?-1<this.localStreams.indexOf(c)&&(c.getTracks().forEach(function(c){c.stop()}),g()&&this._removeStream(c)):this.localStreams.forEach(function(c){c.getTracks().forEach(function(c){c.stop()});
g()&&b._removeStream(c)})};m.prototype.startScreenShare=function(c,b){var d=this;this.emit("localScreenRequested");"function"!==typeof c||b||(b=c,c=null);w(c,function(c,e){c?d.emit("localScreenRequestFailed"):(d.localScreens.push(e),e.getTracks().forEach(function(c){c.addEventListener("ended",function(){var c=!0;e.getTracks().forEach(function(b){c="ended"===b.readyState&&c});c&&d._removeStream(e)})}),d.emit("localScreen",e));if(b)return b(c,e)})};m.prototype.stopScreenShare=function(c){var b=this;
c?-1<this.localScreens.indexOf(c)&&(c.getTracks().forEach(function(c){c.stop()}),g()&&this._removeStream(c)):this.localScreens.forEach(function(c){c.getTracks().forEach(function(c){c.stop()});g()&&b._removeStream(c)})};m.prototype.mute=function(){this._audioEnabled(!1);this.emit("audioOff")};m.prototype.unmute=function(){this._audioEnabled(!0);this.emit("audioOn")};m.prototype.pauseVideo=function(){this._videoEnabled(!1);this.emit("videoOff")};m.prototype.resumeVideo=function(){this._videoEnabled(!0);
this.emit("videoOn")};m.prototype.pause=function(){this.mute();this.pauseVideo()};m.prototype.resume=function(){this.unmute();this.resumeVideo()};m.prototype._audioEnabled=function(c){this.localStreams.forEach(function(b){b.getAudioTracks().forEach(function(b){b.enabled=!!c})})};m.prototype._videoEnabled=function(c){this.localStreams.forEach(function(b){b.getVideoTracks().forEach(function(b){b.enabled=!!c})})};m.prototype.isAudioEnabled=function(){var c=!0;this.localStreams.forEach(function(b){b.getAudioTracks().forEach(function(b){c=
c&&b.enabled})});return c};m.prototype.isVideoEnabled=function(){var c=!0;this.localStreams.forEach(function(b){b.getVideoTracks().forEach(function(b){c=c&&b.enabled})});return c};m.prototype._removeStream=function(c){var b=this.localStreams.indexOf(c);-1<b?(this.localStreams.splice(b,1),this.emit("localStreamStopped",c)):(b=this.localScreens.indexOf(c),-1<b&&(this.localScreens.splice(b,1),this.emit("localScreenStopped",c)))};m.prototype._setupAudioMonitor=function(c,b){this._log("Setup audio");b=
q(c,b);var d=this,e;b.on("speaking",function(){d.emit("speaking")});b.on("stopped_speaking",function(){e&&clearTimeout(e);e=setTimeout(function(){d.emit("stoppedSpeaking")},1E3)});b.on("volume_change",function(c,b){d.emit("volumeChange",c,b)});this._audioMonitors.push({audio:b,stream:c})};m.prototype._stopAudioMonitor=function(c){var b=-1;this._audioMonitors.forEach(function(d,e){d.stream===c&&(b=e)});-1<b&&(this._audioMonitors[b].audio.stop(),this._audioMonitors.splice(b,1))};b.exports=m},{getscreenmedia:27,
hark:29,mockconsole:37,util:63,wildemitter:65}],36:[function(c,b,e){(function(c){function d(c,b){c.set(b[0],b[1]);return c}function f(c,b){c.add(b);return c}function q(c,b){for(var d=-1,e=c?c.length:0;++d<e&&!1!==b(c[d],d,c););return c}function w(c,b,d,e){var f=-1,g=c?c.length:0;for(e&&g&&(d=c[++f]);++f<g;)d=b(d,c[f],f,c);return d}function z(c){var b=!1;if(null!=c&&"function"!=typeof c.toString)try{b=!!(c+"")}catch(Dn){}return b}function E(c){var b=-1,d=Array(c.size);c.forEach(function(c,e){d[++b]=
[e,c]});return d}function N(c,b){return function(d){return c(b(d))}}function O(c){var b=-1,d=Array(c.size);c.forEach(function(c){d[++b]=c});return d}function l(c){var b=-1,d=c?c.length:0;for(this.clear();++b<d;){var e=c[b];this.set(e[0],e[1])}}function h(c){var b=-1,d=c?c.length:0;for(this.clear();++b<d;){var e=c[b];this.set(e[0],e[1])}}function n(c){var b=-1,d=c?c.length:0;for(this.clear();++b<d;){var e=c[b];this.set(e[0],e[1])}}function p(c){this.__data__=new h(c)}function r(c,b,d){var e=c[b];ca.call(c,
b)&&(e===d||e!==e&&d!==d)&&(void 0!==d||b in c)||(c[b]=d)}function t(c,b){for(var d=c.length;d--;){var e=c[d][0];if(e===b||e!==e&&b!==b)return d}return-1}function v(c,b){return c&&D(b,T(b),c)}function x(c,b,d,e,f,g,m){var w;e&&(w=g?e(c,f,g,m):e(c));if(void 0!==w)return w;if(!I(c))return c;if(f=ea(c)){if(w=G(c),!b)return C(c,w)}else{var E=wa(c),N="[object Function]"==E||"[object GeneratorFunction]"==E;if(Da(c))return B(c,b);if("[object Object]"==E||"[object Arguments]"==E||N&&!g){if(z(c))return g?
c:{};w=L(N?{}:c);if(!b)return H(c,v(w,c))}else{if(!K[E])return g?c:{};w=P(c,E,x,b)}}m||(m=new p);if(g=m.get(c))return g;m.set(c,w);if(!f)var O=d?A(c,T,Ia):T(c);q(O||c,function(f,g){O&&(g=f,f=c[g]);r(w,g,x(f,b,d,e,g,c,m))});return w}function A(c,b,d){b=b(c);if(!ea(c)){c=d(c);d=-1;for(var e=c.length,f=b.length;++d<e;)b[f+d]=c[d]}return b}function B(c,b){if(b)return c.slice();b=new c.constructor(c.length);c.copy(b);return b}function y(c){var b=new c.constructor(c.byteLength);(new da(b)).set(new da(c));
return b}function C(c,b){var d=-1,e=c.length;for(b||(b=Array(e));++d<e;)b[d]=c[d];return b}function D(c,b,d,e){d||(d={});for(var f=-1,g=b.length;++f<g;){var m=b[f],q=e?e(d[m],c[m],m,d,c):void 0;r(d,m,void 0===q?c[m]:q)}return d}function H(c,b){return D(c,Ia(c),b)}function F(c,b){c=c.__data__;var d=typeof b;return("string"==d||"number"==d||"symbol"==d||"boolean"==d?"__proto__"!==b:null===b)?c["string"==typeof b?"string":"hash"]:c.map}function J(c,b){c=null==c?void 0:c[b];b=!I(c)||Q&&Q in c?!1:(S(c)||
z(c)?ha:W).test(xc(c));return b?c:void 0}function G(c){var b=c.length,d=c.constructor(b);b&&"string"==typeof c[0]&&ca.call(c,"index")&&(d.index=c.index,d.input=c.input);return d}function L(c){"function"!=typeof c.constructor||yi(c)?c={}:(c=la(c),c=I(c)?na(c):{});return c}function P(c,b,e,g){var m=c.constructor;switch(b){case "[object ArrayBuffer]":return y(c);case "[object Boolean]":case "[object Date]":return new m(+c);case "[object DataView]":return b=g?y(c.buffer):c.buffer,new c.constructor(b,
c.byteOffset,c.byteLength);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return b=g?y(c.buffer):c.buffer,new c.constructor(b,c.byteOffset,c.length);case "[object Map]":return b=g?e(E(c),!0):E(c),w(b,d,new c.constructor);case "[object Number]":case "[object String]":return new m(c);case "[object RegExp]":return b=
new c.constructor(c.source,Z.exec(c)),b.lastIndex=c.lastIndex,b;case "[object Set]":return b=g?e(O(c),!0):O(c),w(b,f,new c.constructor);case "[object Symbol]":return Ca?Object(Ca.call(c)):{}}}function yi(c){var b=c&&c.constructor;return c===("function"==typeof b&&b.prototype||fa)}function xc(c){if(null!=c){try{return ja.call(c)}catch(Cn){}return c+""}return""}function zi(c){var b;if(b=null!=c)b=c.length,b="number"==typeof b&&-1<b&&0==b%1&&9007199254740991>=b;return b&&!S(c)}function S(c){c=I(c)?ba.call(c):
"";return"[object Function]"==c||"[object GeneratorFunction]"==c}function I(c){var b=typeof c;return!!c&&("object"==b||"function"==b)}function T(c){if(zi(c)){var b;(b=ea(c))||(b=!!c&&"object"==typeof c&&zi(c)&&ca.call(c,"callee")&&(!oa.call(c,"callee")||"[object Arguments]"==ba.call(c)));if(b){b=c.length;for(var d=String,e=-1,f=Array(b);++e<b;)f[e]=d(e);b=f}else b=[];d=b.length;e=!!d;for(var g in c){if(!(f=!ca.call(c,g))&&(f=e)&&!(f="length"==g)){f=g;var m=d;m=null==m?9007199254740991:m;f=!!m&&("number"==
typeof f||X.test(f))&&-1<f&&0==f%1&&f<m}f||b.push(g)}c=b}else if(yi(c)){g=[];for(b in Object(c))ca.call(c,b)&&"constructor"!=b&&g.push(b);c=g}else c=va(c);return c}function M(){return[]}function U(){return!1}var Z=/\w*$/,W=/^\[object .+?Constructor\]$/,X=/^(?:0|[1-9]\d*)$/,K={};K["[object Arguments]"]=K["[object Array]"]=K["[object ArrayBuffer]"]=K["[object DataView]"]=K["[object Boolean]"]=K["[object Date]"]=K["[object Float32Array]"]=K["[object Float64Array]"]=K["[object Int8Array]"]=K["[object Int16Array]"]=
K["[object Int32Array]"]=K["[object Map]"]=K["[object Number]"]=K["[object Object]"]=K["[object RegExp]"]=K["[object Set]"]=K["[object String]"]=K["[object Symbol]"]=K["[object Uint8Array]"]=K["[object Uint8ClampedArray]"]=K["[object Uint16Array]"]=K["[object Uint32Array]"]=!0;K["[object Error]"]=K["[object Function]"]=K["[object WeakMap]"]=!1;var V="object"==typeof self&&self&&self.Object===Object&&self;c="object"==typeof c&&c&&c.Object===Object&&c||V||Function("return this")();var R=(V="object"==
typeof e&&e&&!e.nodeType&&e)&&"object"==typeof b&&b&&!b.nodeType&&b;V=R&&R.exports===V;R=Array.prototype;var aa=Function.prototype,fa=Object.prototype,ia=c["__core-js_shared__"],Q=function(){var c=/[^.]+$/.exec(ia&&ia.keys&&ia.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),ja=aa.toString,ca=fa.hasOwnProperty,ba=fa.toString,ha=RegExp("^"+ja.call(ca).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");aa=V?c.Buffer:void 0;V=c.Symbol;
var da=c.Uint8Array,la=N(Object.getPrototypeOf,Object),na=Object.create,oa=fa.propertyIsEnumerable,ua=R.splice;R=Object.getOwnPropertySymbols;aa=aa?aa.isBuffer:void 0;var va=N(Object.keys,Object),ra=J(c,"DataView"),sa=J(c,"Map"),qa=J(c,"Promise"),ka=J(c,"Set");c=J(c,"WeakMap");var Y=J(Object,"create"),Ea=xc(ra),za=xc(sa),Aa=xc(qa),Ka=xc(ka),Fa=xc(c),Ca=(V=V?V.prototype:void 0)?V.valueOf:void 0;l.prototype.clear=function(){this.__data__=Y?Y(null):{}};l.prototype["delete"]=function(c){return this.has(c)&&
delete this.__data__[c]};l.prototype.get=function(c){var b=this.__data__;return Y?(c=b[c],"__lodash_hash_undefined__"===c?void 0:c):ca.call(b,c)?b[c]:void 0};l.prototype.has=function(c){var b=this.__data__;return Y?void 0!==b[c]:ca.call(b,c)};l.prototype.set=function(c,b){this.__data__[c]=Y&&void 0===b?"__lodash_hash_undefined__":b;return this};h.prototype.clear=function(){this.__data__=[]};h.prototype["delete"]=function(c){var b=this.__data__;c=t(b,c);if(0>c)return!1;c==b.length-1?b.pop():ua.call(b,
c,1);return!0};h.prototype.get=function(c){var b=this.__data__;c=t(b,c);return 0>c?void 0:b[c][1]};h.prototype.has=function(c){return-1<t(this.__data__,c)};h.prototype.set=function(c,b){var d=this.__data__,e=t(d,c);0>e?d.push([c,b]):d[e][1]=b;return this};n.prototype.clear=function(){this.__data__={hash:new l,map:new (sa||h),string:new l}};n.prototype["delete"]=function(c){return F(this,c)["delete"](c)};n.prototype.get=function(c){return F(this,c).get(c)};n.prototype.has=function(c){return F(this,
c).has(c)};n.prototype.set=function(c,b){F(this,c).set(c,b);return this};p.prototype.clear=function(){this.__data__=new h};p.prototype["delete"]=function(c){return this.__data__["delete"](c)};p.prototype.get=function(c){return this.__data__.get(c)};p.prototype.has=function(c){return this.__data__.has(c)};p.prototype.set=function(c,b){var d=this.__data__;if(d instanceof h){d=d.__data__;if(!sa||199>d.length)return d.push([c,b]),this;d=this.__data__=new n(d)}d.set(c,b);return this};var Ia=R?N(R,Object):
M,wa=function(c){return ba.call(c)};if(ra&&"[object DataView]"!=wa(new ra(new ArrayBuffer(1)))||sa&&"[object Map]"!=wa(new sa)||qa&&"[object Promise]"!=wa(qa.resolve())||ka&&"[object Set]"!=wa(new ka)||c&&"[object WeakMap]"!=wa(new c))wa=function(c){var b=ba.call(c);if(c=(c="[object Object]"==b?c.constructor:void 0)?xc(c):void 0)switch(c){case Ea:return"[object DataView]";case za:return"[object Map]";case Aa:return"[object Promise]";case Ka:return"[object Set]";case Fa:return"[object WeakMap]"}return b};
var ea=Array.isArray,Da=aa||U;b.exports=function(c){return x(c,!0,!0)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],37:[function(c,b,e){c="assert count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd time timeEnd trace warn".split(" ");e=c.length;for(var d=function(){},g={};e--;)g[c[e]]=d;b.exports=g},{}],38:[function(c,b,e){function d(c){if(c=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(c)){var b=
parseFloat(c[1]);switch((c[2]||"ms").toLowerCase()){case "years":case "year":case "y":return b*m;case "days":case "day":case "d":return 864E5*b;case "hours":case "hour":case "h":return 36E5*b;case "minutes":case "minute":case "m":return 6E4*b;case "seconds":case "second":case "s":return 1E3*b;case "ms":return b}}}function g(c,b,d){if(!(c<b))return c<1.5*b?Math.floor(c/b)+" "+d:Math.ceil(c/b)+" "+d+"s"}var m=315576E5;b.exports=function(c,b){b=b||{};return"string"==typeof c?d(c):b.long?g(c,864E5,"day")||
g(c,36E5,"hour")||g(c,6E4,"minute")||g(c,1E3,"second")||c+" ms":864E5<=c?Math.round(c/864E5)+"d":36E5<=c?Math.round(c/36E5)+"h":6E4<=c?Math.round(c/6E4)+"m":1E3<=c?Math.round(c/1E3)+"s":c+"ms"}},{}],39:[function(c,b,e){var d=Object.prototype.hasOwnProperty;e.keys=Object.keys||function(c){var b=[],e;for(e in c)d.call(c,e)&&b.push(e);return b};e.values=function(c){var b=[],e;for(e in c)d.call(c,e)&&b.push(c[e]);return b};e.merge=function(c,b){for(var e in b)d.call(b,e)&&(c[e]=b[e]);return c};e.length=
function(c){return e.keys(c).length};e.isEmpty=function(c){return 0==e.length(c)}},{}],40:[function(c,b,e){(function(c){var d=/^[\],:{}\s]*$/,e=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,f=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,w=/(?:^|:|,)(?:\s*\[)+/g,z=/^\s+/,E=/\s+$/;b.exports=function(b){if("string"!=typeof b||!b)return null;b=b.replace(z,"").replace(E,"");if(c.JSON&&JSON.parse)return JSON.parse(b);if(d.test(b.replace(e,"@").replace(f,"]").replace(w,"")))return(new Function("return "+
b))()}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],41:[function(c,b,e){e.encode=function(c){var b="",d;for(d in c)c.hasOwnProperty(d)&&(b.length&&(b+="&"),b+=encodeURIComponent(d)+"="+encodeURIComponent(c[d]));return b};e.decode=function(c){var b={};c=c.split("&");for(var d=0,e=c.length;d<e;d++){var f=c[d].split("=");b[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return b}},{}],42:[function(c,b,e){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
g="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");b.exports=function(c){c=d.exec(c||"");for(var b={},e=14;e--;)b[g[e]]=c[e]||"";return b}},{}],43:[function(c,b,e){function d(){throw Error("setTimeout has not been defined");}function g(){throw Error("clearTimeout has not been defined");}function m(c){if(O===setTimeout)return setTimeout(c,0);if((O===d||!O)&&setTimeout)return O=setTimeout,setTimeout(c,0);try{return O(c,0)}catch(Ql){try{return O.call(null,
c,0)}catch(Rl){return O.call(this,c,0)}}}function q(c){if(l===clearTimeout)return clearTimeout(c);if((l===g||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(c);try{return l(c)}catch(Ql){try{return l.call(null,c)}catch(Rl){return l.call(this,c)}}}function w(){n&&p&&(n=!1,p.length?h=p.concat(h):t=-1,h.length&&z())}function z(){if(!n){var c=m(w);n=!0;for(var b=h.length;b;){p=h;for(h=[];++t<b;)p&&p[t].run();t=-1;b=h.length}p=null;n=!1;q(c)}}function E(c,b){this.fun=c;this.array=b}function N(){}c=
b.exports={};try{var O="function"===typeof setTimeout?setTimeout:d}catch(Pl){O=d}try{var l="function"===typeof clearTimeout?clearTimeout:g}catch(Pl){l=g}var h=[],n=!1,p,t=-1;c.nextTick=function(c){var b=Array(arguments.length-1);if(1<arguments.length)for(var d=1;d<arguments.length;d++)b[d-1]=arguments[d];h.push(new E(c,b));1!==h.length||n||m(z)};E.prototype.run=function(){this.fun.apply(null,this.array)};c.title="browser";c.browser=!0;c.env={};c.argv=[];c.version="";c.versions={};c.on=N;c.addListener=
N;c.once=N;c.off=N;c.removeListener=N;c.removeAllListeners=N;c.emit=N;c.prependListener=N;c.prependOnceListener=N;c.listeners=function(c){return[]};c.binding=function(c){throw Error("process.binding is not supported");};c.cwd=function(){return"/"};c.chdir=function(c){throw Error("process.chdir is not supported");};c.umask=function(){return 0}},{}],44:[function(c,b,e){function d(c,b){var d=this,e;m.call(this);c=c||{};c.iceServers=c.iceServers||[];this.enableChromeNativeSimulcast=!1;b&&b.optional&&
window.chrome&&null===navigator.appVersion.match(/Chromium\//)&&b.optional.forEach(function(c){c.enableChromeNativeSimulcast&&(d.enableChromeNativeSimulcast=!0)});this.enableMultiStreamHacks=!1;b&&b.optional&&window.chrome&&b.optional.forEach(function(c){c.enableMultiStreamHacks&&(d.enableMultiStreamHacks=!0)});this.restrictBandwidth=0;b&&b.optional&&b.optional.forEach(function(c){c.andyetRestrictBandwidth&&(d.restrictBandwidth=c.andyetRestrictBandwidth)});this.batchIceCandidates=0;b&&b.optional&&
b.optional.forEach(function(c){c.andyetBatchIce&&(d.batchIceCandidates=c.andyetBatchIce)});this.batchedIceCandidates=[];b&&b.optional&&window.chrome&&b.optional.forEach(function(c){c.andyetFasterICE&&(d.eliminateDuplicateCandidates=c.andyetFasterICE)});b&&b.optional&&b.optional.forEach(function(c){c.andyetDontSignalCandidates&&(d.dontSignalCandidates=c.andyetDontSignalCandidates)});this.assumeSetLocalSuccess=!1;b&&b.optional&&b.optional.forEach(function(c){c.andyetAssumeSetLocalSuccess&&(d.assumeSetLocalSuccess=
c.andyetAssumeSetLocalSuccess)});window.navigator.mozGetUserMedia&&b&&b.optional&&(this.wtFirefox=0,b.optional.forEach(function(c){c.andyetFirefoxMakesMeSad&&(d.wtFirefox=c.andyetFirefoxMakesMeSad,0<d.wtFirefox&&(d.firefoxcandidatebuffer=[]))}));this.pc=new RTCPeerConnection(c,b);this.getLocalStreams="function"===typeof this.pc.getLocalStreams?this.pc.getLocalStreams.bind(this.pc):function(){return[]};this.getSenders="function"===typeof this.pc.getSenders?this.pc.getSenders.bind(this.pc):function(){return[]};
this.getRemoteStreams="function"===typeof this.pc.getRemoteStreams?this.pc.getRemoteStreams.bind(this.pc):function(){return[]};this.getReceivers="function"===typeof this.pc.getReceivers?this.pc.getReceivers.bind(this.pc):function(){return[]};this.addStream=this.pc.addStream.bind(this.pc);this.removeStream=function(c){"function"===typeof d.pc.removeStream?d.pc.removeStream.apply(d.pc,arguments):"function"===typeof d.pc.removeTrack&&c.getTracks().forEach(function(c){d.pc.removeTrack(c)})};"function"===
typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc));this.pc.onremovestream=this.emit.bind(this,"removeStream");this.pc.onremovetrack=this.emit.bind(this,"removeTrack");this.pc.onaddstream=this.emit.bind(this,"addStream");this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded");this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange");this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange");this.pc.onicecandidate=this._onIce.bind(this);
this.pc.ondatachannel=this._onDataChannel.bind(this);this.localDescription={contents:[]};this.remoteDescription={contents:[]};this.config={debug:!1,sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1};this.iceCredentials={local:{},remote:{}};for(e in c)this.config[e]=c[e];if(this.config.debug)this.on("*",function(){(c.logger||console).log("PeerConnection event:",arguments)});this.hadRemoteIPv6Candidate=this.hadLocalIPv6Candidate=this.hadRemoteRelayCandidate=this.hadLocalRelayCandidate=this.hadRemoteStunCandidate=
this.hadLocalStunCandidate=!1;this._remoteDataChannels=[];this._localDataChannels=[];this._candidateBuffer=[]}e=c("util");var g=c("sdp-jingle-json"),m=c("wildemitter"),q=c("lodash.clonedeep");e.inherits(d,m);Object.defineProperty(d.prototype,"signalingState",{get:function(){return this.pc.signalingState}});Object.defineProperty(d.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}});d.prototype._role=function(){return this.isInitiator?"initiator":"responder"};d.prototype.addStream=
function(c){this.localStream=c;this.pc.addStream(c)};d.prototype._checkLocalCandidate=function(c){c=g.toCandidateJSON(c);"srflx"==c.type?this.hadLocalStunCandidate=!0:"relay"==c.type&&(this.hadLocalRelayCandidate=!0);-1!=c.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)};d.prototype._checkRemoteCandidate=function(c){c=g.toCandidateJSON(c);"srflx"==c.type?this.hadRemoteStunCandidate=!0:"relay"==c.type&&(this.hadRemoteRelayCandidate=!0);-1!=c.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)};d.prototype.processIce=
function(c,b){b=b||function(){};var d=this;if("closed"===this.pc.signalingState)return b();if(c.contents||c.jingle&&c.jingle.contents){var e=this.remoteDescription.contents.map(function(c){return c.name});(c.contents||c.jingle.contents).forEach(function(c){var f=c.transport||{},m=f.candidates||[],q=e.indexOf(c.name),w=c.name,E=d.remoteDescription.contents.find(function(b){return b.name===c.name}),z=function(){m.forEach(function(c){c=g.toCandidateSDP(c);d.pc.addIceCandidate(new RTCIceCandidate({candidate:c,
sdpMLineIndex:q,sdpMid:w}),function(){},function(c){d.emit("error",c)});d._checkRemoteCandidate(c)});b()};d.iceCredentials.remote[c.name]&&f.ufrag&&d.iceCredentials.remote[c.name].ufrag!==f.ufrag?E?(E.transport.ufrag=f.ufrag,E.transport.pwd=f.pwd,f={type:"offer",jingle:d.remoteDescription},f.sdp=g.toSessionSDP(f.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"incoming"}),d.pc.setRemoteDescription(new RTCSessionDescription(f),function(){z()},function(c){d.emit("error",c)})):d.emit("error",
"ice restart failed to find matching content"):z()})}else{c.candidate&&0!==c.candidate.candidate.indexOf("a=")&&(c.candidate.candidate="a="+c.candidate.candidate);if(this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(c.candidate),b();d.pc.addIceCandidate(new RTCIceCandidate(c.candidate),function(){},function(c){d.emit("error",c)});d._checkRemoteCandidate(c.candidate.candidate);b()}};d.prototype.offer=
function(c,b){var d=this,e=2===arguments.length,f=e&&c?c:{offerToReceiveAudio:1,offerToReceiveVideo:1};b=(b=e?b:c)||function(){};if("closed"===this.pc.signalingState)return b("Already closed");this.pc.createOffer(function(c){var e={type:"offer",sdp:c.sdp};d.assumeSetLocalSuccess&&(d.emit("offer",e),b(null,e));d._candidateBuffer=[];d.pc.setLocalDescription(c,function(){if(d.config.useJingle){var f=g.toSessionJSON(c.sdp,{role:d._role(),direction:"outgoing"});f.sid=d.config.sid;d.localDescription=f;
f.contents.forEach(function(c){var b=c.transport||{};b.ufrag&&(d.iceCredentials.local[c.name]={ufrag:b.ufrag,pwd:b.pwd})});e.jingle=f}e.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&d._checkLocalCandidate(c)});d.assumeSetLocalSuccess||(d.emit("offer",e),b(null,e))},function(c){d.emit("error",c);b(c)})},function(c){d.emit("error",c);b(c)},f)};d.prototype.handleOffer=function(c,b){b=b||function(){};var d=this;c.type="offer";if(c.jingle){this.enableChromeNativeSimulcast&&c.jingle.contents.forEach(function(c){"video"===
c.name&&(c.application.googConferenceFlag=!0)});this.enableMultiStreamHacks&&c.jingle.contents.forEach(function(c){if("video"===c.name){var b=c.application.sources||[];if(0===b.length||"3735928559"!==b[0].ssrc)b.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),c.application.sources=b}});if(0<d.restrictBandwidth&&2<=c.jingle.contents.length&&"video"===c.jingle.contents[1].name){var e=c.jingle.contents[1];e.application&&e.application.bandwidth&&
e.application.bandwidth.bandwidth||(c.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:d.restrictBandwidth.toString()},c.sdp=g.toSessionSDP(c.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"outgoing"}))}c.jingle.contents.forEach(function(c){var b=c.transport||{};b.ufrag&&(d.iceCredentials.remote[c.name]={ufrag:b.ufrag,pwd:b.pwd})});c.sdp=g.toSessionSDP(c.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"incoming"});d.remoteDescription=c.jingle}c.sdp.split("\r\n").forEach(function(c){0===
c.indexOf("a=candidate:")&&d._checkRemoteCandidate(c)});d.pc.setRemoteDescription(new RTCSessionDescription(c),function(){b()},b)};d.prototype.answerAudioOnly=function(c){this._answer({mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},c)};d.prototype.answerBroadcastOnly=function(c){this._answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},c)};d.prototype.answer=function(c,b){var d=2===arguments.length;this._answer(d&&c?c:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},
d?b:c)};d.prototype.handleAnswer=function(c,b){b=b||function(){};var d=this;c.jingle&&(c.sdp=g.toSessionSDP(c.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"incoming"}),d.remoteDescription=c.jingle,c.jingle.contents.forEach(function(c){var b=c.transport||{};b.ufrag&&(d.iceCredentials.remote[c.name]={ufrag:b.ufrag,pwd:b.pwd})}));c.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&d._checkRemoteCandidate(c)});d.pc.setRemoteDescription(new RTCSessionDescription(c),function(){d.wtFirefox&&
window.setTimeout(function(){d.firefoxcandidatebuffer.forEach(function(c){d.pc.addIceCandidate(new RTCIceCandidate(c),function(){},function(c){d.emit("error",c)});d._checkRemoteCandidate(c.candidate)});d.firefoxcandidatebuffer=null},d.wtFirefox);b(null)},b)};d.prototype.close=function(){this.pc.close();this._localDataChannels=[];this._remoteDataChannels=[];this.emit("close")};d.prototype._answer=function(c,b){b=b||function(){};var d=this;if(!this.pc.remoteDescription)throw Error("remoteDescription not set");
if("closed"===this.pc.signalingState)return b("Already closed");d.pc.createAnswer(function(c){var e=[];if(d.enableChromeNativeSimulcast&&(c.jingle=g.toSessionJSON(c.sdp,{role:d._role(),direction:"outgoing"}),2<=c.jingle.contents.length&&"video"===c.jingle.contents[1].name)){var f=c.jingle.contents[1].application.sourceGroups||[],m=!1;f.forEach(function(c){"SIM"==c.semantics&&(m=!0)});if(!m&&c.jingle.contents[1].application.sources.length){var w=JSON.parse(JSON.stringify(c.jingle.contents[1].application.sources[0]));
w.ssrc=""+Math.floor(4294967295*Math.random());c.jingle.contents[1].application.sources.push(w);e.push(c.jingle.contents[1].application.sources[0].ssrc);e.push(w.ssrc);f.push({semantics:"SIM",sources:e});e=JSON.parse(JSON.stringify(w));e.ssrc=""+Math.floor(4294967295*Math.random());c.jingle.contents[1].application.sources.push(e);f.push({semantics:"FID",sources:[w.ssrc,e.ssrc]});c.jingle.contents[1].application.sourceGroups=f;c.sdp=g.toSessionSDP(c.jingle,{sid:d.config.sdpSessionID,role:d._role(),
direction:"outgoing"})}}var z={type:"answer",sdp:c.sdp};d.assumeSetLocalSuccess&&(f=q(z),d.emit("answer",f),b(null,f));d._candidateBuffer=[];d.pc.setLocalDescription(c,function(){if(d.config.useJingle){var e=g.toSessionJSON(c.sdp,{role:d._role(),direction:"outgoing"});e.sid=d.config.sid;d.localDescription=e;z.jingle=e}d.enableChromeNativeSimulcast&&(z.jingle||(z.jingle=g.toSessionJSON(c.sdp,{role:d._role(),direction:"outgoing"})),z.jingle.contents[1].application.sources.forEach(function(c,b){c.parameters=
c.parameters.map(function(c){"msid"===c.key&&(c.value+="-"+Math.floor(b/2));return c})}),z.sdp=g.toSessionSDP(z.jingle,{sid:d.sdpSessionID,role:d._role(),direction:"outgoing"}));z.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&d._checkLocalCandidate(c)});d.assumeSetLocalSuccess||(e=q(z),d.emit("answer",e),b(null,e))},function(c){d.emit("error",c);b(c)})},function(c){d.emit("error",c);b(c)},c)};d.prototype._onIce=function(c){var b=this;if(c.candidate){if(!this.dontSignalCandidates){c=
c.candidate;var d={candidate:{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex}};this._checkLocalCandidate(c.candidate);var e=g.toCandidateJSON(c.candidate);if(this.eliminateDuplicateCandidates&&"relay"===e.type){var f=this._candidateBuffer.filter(function(c){return"relay"===c.type}).map(function(c){return c.foundation+":"+c.component});var m=f.indexOf(e.foundation+":"+e.component);if(-1<m&&e.priority>>24>=f[m].priority>>24)return}if("max-bundle"===this.config.bundlePolicy&&(f=
this._candidateBuffer.filter(function(c){return e.type===c.type}).map(function(c){return c.address+":"+c.port}),m=f.indexOf(e.address+":"+e.port),-1<m))return;if("require"!==this.config.rtcpMuxPolicy||"2"!==e.component){this._candidateBuffer.push(e);if(b.config.useJingle&&(c.sdpMid||(c.sdpMid=b.pc.remoteDescription&&"offer"===b.pc.remoteDescription.type?b.remoteDescription.contents[c.sdpMLineIndex].name:b.localDescription.contents[c.sdpMLineIndex].name),b.iceCredentials.local[c.sdpMid]||g.toSessionJSON(b.pc.localDescription.sdp,
{role:b._role(),direction:"outgoing"}).contents.forEach(function(c){var d=c.transport||{};d.ufrag&&(b.iceCredentials.local[c.name]={ufrag:d.ufrag,pwd:d.pwd})}),d.jingle={contents:[{name:c.sdpMid,creator:b._role(),transport:{transportType:"iceUdp",ufrag:b.iceCredentials.local[c.sdpMid].ufrag,pwd:b.iceCredentials.local[c.sdpMid].pwd,candidates:[e]}}]},0<b.batchIceCandidates)){0===b.batchedIceCandidates.length&&window.setTimeout(function(){var c={};b.batchedIceCandidates.forEach(function(b){b=b.contents[0];
c[b.name]||(c[b.name]=b);c[b.name].transport.candidates.push(b.transport.candidates[0])});var d={jingle:{contents:[]}};Object.keys(c).forEach(function(b){d.jingle.contents.push(c[b])});b.batchedIceCandidates=[];b.emit("ice",d)},b.batchIceCandidates);b.batchedIceCandidates.push(d.jingle);return}this.emit("ice",d)}}}else this.emit("endOfCandidates")};d.prototype._onDataChannel=function(c){c=c.channel;this._remoteDataChannels.push(c);this.emit("addChannel",c)};d.prototype.createDataChannel=function(c,
b){c=this.pc.createDataChannel(c,b);this._localDataChannels.push(c);return c};d.prototype.getStats=function(){if("function"===typeof arguments[0]){var c=arguments[0];this.pc.getStats().then(function(b){c(null,b)},function(b){c(b)})}else return this.pc.getStats.apply(this.pc,arguments)};b.exports=d},{"lodash.clonedeep":36,"sdp-jingle-json":45,util:63,wildemitter:65}],45:[function(c,b,e){var d=c("./lib/tosdp"),g=c("./lib/tojson");e.toIncomingSDPOffer=function(c){return d.toSessionSDP(c,{role:"responder",
direction:"incoming"})};e.toOutgoingSDPOffer=function(c){return d.toSessionSDP(c,{role:"initiator",direction:"outgoing"})};e.toIncomingSDPAnswer=function(c){return d.toSessionSDP(c,{role:"initiator",direction:"incoming"})};e.toOutgoingSDPAnswer=function(c){return d.toSessionSDP(c,{role:"responder",direction:"outgoing"})};e.toIncomingMediaSDPOffer=function(c){return d.toMediaSDP(c,{role:"responder",direction:"incoming"})};e.toOutgoingMediaSDPOffer=function(c){return d.toMediaSDP(c,{role:"initiator",
direction:"outgoing"})};e.toIncomingMediaSDPAnswer=function(c){return d.toMediaSDP(c,{role:"initiator",direction:"incoming"})};e.toOutgoingMediaSDPAnswer=function(c){return d.toMediaSDP(c,{role:"responder",direction:"outgoing"})};e.toCandidateSDP=d.toCandidateSDP;e.toMediaSDP=d.toMediaSDP;e.toSessionSDP=d.toSessionSDP;e.toIncomingJSONOffer=function(c,b){return g.toSessionJSON(c,{role:"responder",direction:"incoming",creators:b})};e.toOutgoingJSONOffer=function(c,b){return g.toSessionJSON(c,{role:"initiator",
direction:"outgoing",creators:b})};e.toIncomingJSONAnswer=function(c,b){return g.toSessionJSON(c,{role:"initiator",direction:"incoming",creators:b})};e.toOutgoingJSONAnswer=function(c,b){return g.toSessionJSON(c,{role:"responder",direction:"outgoing",creators:b})};e.toIncomingMediaJSONOffer=function(c,b){return g.toMediaJSON(c,{role:"responder",direction:"incoming",creator:b})};e.toOutgoingMediaJSONOffer=function(c,b){return g.toMediaJSON(c,{role:"initiator",direction:"outgoing",creator:b})};e.toIncomingMediaJSONAnswer=
function(c,b){return g.toMediaJSON(c,{role:"initiator",direction:"incoming",creator:b})};e.toOutgoingMediaJSONAnswer=function(c,b){return g.toMediaJSON(c,{role:"responder",direction:"outgoing",creator:b})};e.toCandidateJSON=g.toCandidateJSON;e.toMediaJSON=g.toMediaJSON;e.toSessionJSON=g.toSessionJSON},{"./lib/tojson":48,"./lib/tosdp":49}],46:[function(c,b,e){e.lines=function(c){return c.split("\r\n").filter(function(c){return 0<c.length})};e.findLine=function(c,b,d){for(var e=c.length,f=0;f<b.length;f++)if(b[f].substr(0,
e)===c)return b[f];if(!d)return!1;for(b=0;b<d.length;b++)if(d[b].substr(0,e)===c)return d[b];return!1};e.findLines=function(c,b,d){for(var e=[],f=c.length,g=0;g<b.length;g++)b[g].substr(0,f)===c&&e.push(b[g]);if(e.length||!d)return e;for(b=0;b<d.length;b++)d[b].substr(0,f)===c&&e.push(d[b]);return e};e.mline=function(c){c=c.substr(2).split(" ");for(var b={media:c[0],port:c[1],proto:c[2],formats:[]},d=3;d<c.length;d++)c[d]&&b.formats.push(c[d]);return b};e.rtpmap=function(c){c=c.substr(9).split(" ");
var b={id:c.shift()};c=c[0].split("/");b.name=c[0];b.clockrate=c[1];b.channels=3==c.length?c[2]:"1";return b};e.sctpmap=function(c){c=c.substr(10).split(" ");return{number:c.shift(),protocol:c.shift(),streams:c.shift()}};e.fmtp=function(c){for(var b,d=c.substr(c.indexOf(" ")+1).split(";"),e=[],f=0;f<d.length;f++)b=d[f].split("="),c=b[0].trim(),b=b[1],c&&b?e.push({key:c,value:b}):c&&e.push({key:"",value:c});return e};e.crypto=function(c){c=c.substr(9).split(" ");return{tag:c[0],cipherSuite:c[1],keyParams:c[2],
sessionParams:c.slice(3).join(" ")}};e.fingerprint=function(c){c=c.substr(14).split(" ");return{hash:c[0],value:c[1]}};e.extmap=function(c){c=c.substr(9).split(" ");var b={},d=c.shift(),e=d.indexOf("/");0<=e?(b.id=d.substr(0,e),b.senders=d.substr(e+1)):(b.id=d,b.senders="sendrecv");b.uri=c.shift()||"";return b};e.rtcpfb=function(c){c=c.substr(10).split(" ");var b={};b.id=c.shift();b.type=c.shift();"trr-int"===b.type?b.value=c.shift():b.subtype=c.shift()||"";b.parameters=c;return b};e.candidate=function(c){c=
0===c.indexOf("a=candidate:")?c.substring(12).split(" "):c.substring(10).split(" ");for(var b={foundation:c[0],component:c[1],protocol:c[2].toLowerCase(),priority:c[3],ip:c[4],port:c[5],type:c[7],generation:"0"},d=8;d<c.length;d+=2)"raddr"===c[d]?b.relAddr=c[d+1]:"rport"===c[d]?b.relPort=c[d+1]:"generation"===c[d]?b.generation=c[d+1]:"tcptype"===c[d]&&(b.tcpType=c[d+1]);b.network="1";return b};e.sourceGroups=function(c){for(var b=[],d=0;d<c.length;d++){var e=c[d].substr(13).split(" ");b.push({semantics:e.shift(),
sources:e})}return b};e.sources=function(c){for(var b=[],d={},e=0;e<c.length;e++){var f=c[e].substr(7).split(" "),z=f.shift();if(!d[z]){var E={ssrc:z,parameters:[]};b.push(E);d[z]=E}f=f.join(" ").split(":");E=f.shift();f=f.join(":")||null;d[z].parameters.push({key:E,value:f})}return b};e.groups=function(c){for(var b=[],d,e=0;e<c.length;e++)d=c[e].substr(8).split(" "),b.push({semantics:d.shift(),contents:d});return b};e.bandwidth=function(c){c=c.substr(2).split(":");var b={};b.type=c.shift();b.bandwidth=
c.shift();return b};e.msid=function(c){c=c.substr(7);var b=c.split(" ");return{msid:c,mslabel:b[0],label:b[1]}}},{}],47:[function(c,b,e){b.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",
responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],48:[function(c,b,e){var d=c("./senders"),g=c("./parsers"),m=Math.random();e._setIdCounter=function(c){m=c};e.toSessionJSON=function(c,b){var d,f=b.creators||[],m=b.role||"initiator";b=b.direction||"outgoing";
var q=c.split("\r\nm=");for(d=1;d<q.length;d++)q[d]="m="+q[d],d!==q.length-1&&(q[d]+="\r\n");var w=q.shift()+"\r\n",l=g.lines(w);c={};var h=[];for(d=0;d<q.length;d++)h.push(e.toMediaJSON(q[d],w,{role:m,direction:b,creator:f[d]||"initiator"}));c.contents=h;f=g.findLines("a=group:",l);f.length&&(c.groups=g.groups(f));return c};e.toMediaJSON=function(c,b,f){var m=f.creator||"initiator",q=f.role||"initiator",w=f.direction||"outgoing",z=g.lines(c);c=g.lines(b);b=g.mline(z[0]);m={creator:m,name:b.media,
application:{applicationType:"rtp",media:b.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==b.media&&(m.application={applicationType:"datachannel"},m.transport.sctp=[]);var l=m.application,h=m.transport;if(b=g.findLine("a=mid:",z))m.name=b.substr(6);g.findLine("a=sendrecv",z,c)?m.senders="both":g.findLine("a=sendonly",z,c)?m.senders=d[q][w].sendonly:g.findLine("a=recvonly",z,c)?m.senders=d[q][w].recvonly:
g.findLine("a=inactive",z,c)&&(m.senders="none");if("rtp"==l.applicationType){if(b=g.findLine("b=",z))l.bandwidth=g.bandwidth(b);if(b=g.findLine("a=ssrc:",z))l.ssrc=b.substr(7).split(" ")[0];g.findLines("a=rtpmap:",z).forEach(function(c){var b=g.rtpmap(c);b.parameters=[];b.feedback=[];g.findLines("a=fmtp:"+b.id,z).forEach(function(c){b.parameters=g.fmtp(c)});g.findLines("a=rtcp-fb:"+b.id,z).forEach(function(c){b.feedback.push(g.rtcpfb(c))});l.payloads.push(b)});g.findLines("a=crypto:",z,c).forEach(function(c){l.encryption.push(g.crypto(c))});
g.findLine("a=rtcp-mux",z)&&(l.mux=!0);g.findLines("a=rtcp-fb:*",z).forEach(function(c){l.feedback.push(g.rtcpfb(c))});g.findLines("a=extmap:",z).forEach(function(c){c=g.extmap(c);c.senders=d[q][w][c.senders];l.headerExtensions.push(c)});b=g.findLines("a=ssrc-group:",z);l.sourceGroups=g.sourceGroups(b||[]);b=g.findLines("a=ssrc:",z);var n=l.sources=g.sources(b||[]);if(b=g.findLine("a=msid:",z)){var p=g.msid(b);["msid","mslabel","label"].forEach(function(c){for(var b=0;b<n.length;b++){for(var d=!1,
e=0;e<n[b].parameters.length;e++)n[b].parameters[e].key===c&&(d=!0);d||n[b].parameters.push({key:c,value:p[c]})}})}g.findLine("a=x-google-flag:conference",z,c)&&(l.googConferenceFlag=!0)}b=g.findLines("a=fingerprint:",z,c);var t=g.findLine("a=setup:",z,c);b.forEach(function(c){c=g.fingerprint(c);t&&(c.setup=t.substr(8));h.fingerprints.push(c)});b=g.findLine("a=ice-ufrag:",z,c);f=g.findLine("a=ice-pwd:",z,c);b&&f&&(h.ufrag=b.substr(12),h.pwd=f.substr(10),h.candidates=[],g.findLines("a=candidate:",
z,c).forEach(function(c){h.candidates.push(e.toCandidateJSON(c))}));"datachannel"==l.applicationType&&g.findLines("a=sctpmap:",z).forEach(function(c){c=g.sctpmap(c);h.sctp.push(c)});return m};e.toCandidateJSON=function(c){c=g.candidate(c.split("\r\n")[0]);c.id=(m++).toString(36).substr(0,12);return c}},{"./parsers":46,"./senders":47}],49:[function(c,b,e){var d=c("./senders");e.toSessionSDP=function(c,b){var d=b.sid||c.sid||Date.now(),f=b.time||Date.now(),g=["v=0","o=- "+d+" "+f+" IN IP4 0.0.0.0",
"s=-","t=0 0"];d=c.contents||[];var m=!1;d.forEach(function(c){c.application.sources&&c.application.sources.length&&(m=!0)});m&&g.push("a=msid-semantic: WMS *");(c.groups||[]).forEach(function(c){g.push("a=group:"+c.semantics+" "+c.contents.join(" "))});d.forEach(function(c){g.push(e.toMediaSDP(c,b))});return g.join("\r\n")+"\r\n"};e.toMediaSDP=function(c,b){var f=[],g=b.role||"initiator",m=b.direction||"outgoing",E=c.application;b=c.transport;var l=E.payloads||[],h=b&&b.fingerprints||[],n=[];"datachannel"==
E.applicationType?(n.push("application"),n.push("1"),n.push("DTLS/SCTP"),b.sctp&&b.sctp.forEach(function(c){n.push(c.number)})):(n.push(E.media),n.push("1"),0<h.length?n.push("UDP/TLS/RTP/SAVPF"):E.encryption&&0<E.encryption.length?n.push("RTP/SAVPF"):n.push("RTP/AVPF"),l.forEach(function(c){n.push(c.id)}));f.push("m="+n.join(" "));f.push("c=IN IP4 0.0.0.0");E.bandwidth&&E.bandwidth.type&&E.bandwidth.bandwidth&&f.push("b="+E.bandwidth.type+":"+E.bandwidth.bandwidth);"rtp"==E.applicationType&&f.push("a=rtcp:1 IN IP4 0.0.0.0");
b&&(b.ufrag&&f.push("a=ice-ufrag:"+b.ufrag),b.pwd&&f.push("a=ice-pwd:"+b.pwd),h.forEach(function(c){f.push("a=fingerprint:"+c.hash+" "+c.value);c.setup&&f.push("a=setup:"+c.setup)}),b.sctp&&b.sctp.forEach(function(c){f.push("a=sctpmap:"+c.number+" "+c.protocol+" "+c.streams)}));"rtp"==E.applicationType&&f.push("a="+(d[g][m][c.senders]||"sendrecv"));f.push("a=mid:"+c.name);E.sources&&E.sources.length&&(E.sources[0].parameters||[]).forEach(function(c){"msid"===c.key&&f.push("a=msid:"+c.value)});E.mux&&
f.push("a=rtcp-mux");(E.encryption||[]).forEach(function(c){f.push("a=crypto:"+c.tag+" "+c.cipherSuite+" "+c.keyParams+(c.sessionParams?" "+c.sessionParams:""))});E.googConferenceFlag&&f.push("a=x-google-flag:conference");l.forEach(function(c){var b="a=rtpmap:"+c.id+" "+c.name+"/"+c.clockrate;c.channels&&"1"!=c.channels&&(b+="/"+c.channels);f.push(b);if(c.parameters&&c.parameters.length){b=["a=fmtp:"+c.id];var d=[];c.parameters.forEach(function(c){d.push((c.key?c.key+"=":"")+c.value)});b.push(d.join(";"));
f.push(b.join(" "))}c.feedback&&c.feedback.forEach(function(b){"trr-int"===b.type?f.push("a=rtcp-fb:"+c.id+" trr-int "+(b.value?b.value:"0")):f.push("a=rtcp-fb:"+c.id+" "+b.type+(b.subtype?" "+b.subtype:""))})});E.feedback&&E.feedback.forEach(function(c){"trr-int"===c.type?f.push("a=rtcp-fb:* trr-int "+(c.value?c.value:"0")):f.push("a=rtcp-fb:* "+c.type+(c.subtype?" "+c.subtype:""))});(E.headerExtensions||[]).forEach(function(c){f.push("a=extmap:"+c.id+(c.senders?"/"+d[g][m][c.senders]:"")+" "+c.uri)});
(E.sourceGroups||[]).forEach(function(c){f.push("a=ssrc-group:"+c.semantics+" "+c.sources.join(" "))});(E.sources||[]).forEach(function(c){for(var b=0;b<c.parameters.length;b++){var d=c.parameters[b];f.push("a=ssrc:"+(c.ssrc||E.ssrc)+" "+d.key+(d.value?":"+d.value:""))}});(b.candidates||[]).forEach(function(c){f.push(e.toCandidateSDP(c))});return f.join("\r\n")};e.toCandidateSDP=function(c){var b=[];b.push(c.foundation);b.push(c.component);b.push(c.protocol.toUpperCase());b.push(c.priority);b.push(c.ip);
b.push(c.port);var d=c.type;b.push("typ");b.push(d);("srflx"===d||"prflx"===d||"relay"===d)&&c.relAddr&&c.relPort&&(b.push("raddr"),b.push(c.relAddr),b.push("rport"),b.push(c.relPort));c.tcpType&&"TCP"==c.protocol.toUpperCase()&&(b.push("tcptype"),b.push(c.tcpType));b.push("generation");b.push(c.generation||"0");return"a=candidate:"+b.join(" ")}},{"./senders":47}],50:[function(c,b,e){b.exports=c("./lib/")},{"./lib/":51}],51:[function(c,b,e){function d(c,b){"object"==typeof c&&(b=c,c=void 0);b=b||
{};c=g(c);var d=c.source,e=c.id;b.forceNew||b["force new connection"]||!1===b.multiplex?(w("ignoring socket cache for %s",d),b=q(d,b)):(z[e]||(w("new io instance for %s",d),z[e]=q(d,b)),b=z[e]);return b.socket(c.path)}var g=c("./url"),m=c("socket.io-parser"),q=c("./manager"),w=c("debug")("socket.io-client");b.exports=e=d;var z=e.managers={};e.protocol=m.protocol;e.connect=d;e.Manager=c("./manager");e.Socket=c("./socket")},{"./manager":52,"./socket":54,"./url":55,debug:10,"socket.io-parser":57}],52:[function(c,
b,e){function d(c,b){if(!(this instanceof d))return new d(c,b);c&&"object"==typeof c&&(b=c,c=void 0);b=b||{};b.path=b.path||"/socket.io";this.nsps={};this.subs=[];this.opts=b;this.reconnection(!1!==b.reconnection);this.reconnectionAttempts(b.reconnectionAttempts||Infinity);this.reconnectionDelay(b.reconnectionDelay||1E3);this.reconnectionDelayMax(b.reconnectionDelayMax||5E3);this.randomizationFactor(b.randomizationFactor||.5);this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),
jitter:this.randomizationFactor()});this.timeout(null==b.timeout?2E4:b.timeout);this.readyState="closed";this.uri=c;this.connected=[];this.encoding=!1;this.packetBuffer=[];this.encoder=new q.Encoder;this.decoder=new q.Decoder;(this.autoConnect=!1!==b.autoConnect)&&this.open()}c("./url");var g=c("engine.io-client"),m=c("./socket");e=c("component-emitter");var q=c("socket.io-parser"),w=c("./on"),z=c("component-bind");c("object-component");var E=c("debug")("socket.io-client:manager"),l=c("indexof"),
h=c("backo2");b.exports=d;d.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var c in this.nsps)this.nsps[c].emit.apply(this.nsps[c],arguments)};d.prototype.updateSocketIds=function(){for(var c in this.nsps)this.nsps[c].id=this.engine.id};e(d.prototype);d.prototype.reconnection=function(c){if(!arguments.length)return this._reconnection;this._reconnection=!!c;return this};d.prototype.reconnectionAttempts=function(c){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=
c;return this};d.prototype.reconnectionDelay=function(c){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=c;this.backoff&&this.backoff.setMin(c);return this};d.prototype.randomizationFactor=function(c){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=c;this.backoff&&this.backoff.setJitter(c);return this};d.prototype.reconnectionDelayMax=function(c){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=c;this.backoff&&
this.backoff.setMax(c);return this};d.prototype.timeout=function(c){if(!arguments.length)return this._timeout;this._timeout=c;return this};d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};d.prototype.open=d.prototype.connect=function(c){E("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;E("opening %s",this.uri);var b=this.engine=g(this.uri,this.opts),d=this;this.readyState="opening";this.skipReconnect=
!1;var e=w(b,"open",function(){d.onopen();c&&c()}),f=w(b,"error",function(b){E("connect_error");d.cleanup();d.readyState="closed";d.emitAll("connect_error",b);if(c){var e=Error("Connection error");e.data=b;c(e)}else d.maybeReconnectOnOpen()});if(!1!==this._timeout){var m=this._timeout;E("connect attempt will timeout after %d",m);var q=setTimeout(function(){E("connect attempt timed out after %d",m);e.destroy();b.close();b.emit("error","timeout");d.emitAll("connect_timeout",m)},m);this.subs.push({destroy:function(){clearTimeout(q)}})}this.subs.push(e);
this.subs.push(f);return this};d.prototype.onopen=function(){E("open");this.cleanup();this.readyState="open";this.emit("open");var c=this.engine;this.subs.push(w(c,"data",z(this,"ondata")));this.subs.push(w(this.decoder,"decoded",z(this,"ondecoded")));this.subs.push(w(c,"error",z(this,"onerror")));this.subs.push(w(c,"close",z(this,"onclose")))};d.prototype.ondata=function(c){this.decoder.add(c)};d.prototype.ondecoded=function(c){this.emit("packet",c)};d.prototype.onerror=function(c){E("error",c);
this.emitAll("error",c)};d.prototype.socket=function(c){var b=this.nsps[c];if(!b){b=new m(this,c);this.nsps[c]=b;var d=this;b.on("connect",function(){b.id=d.engine.id;~l(d.connected,b)||d.connected.push(b)})}return b};d.prototype.destroy=function(c){c=l(this.connected,c);~c&&this.connected.splice(c,1);this.connected.length||this.close()};d.prototype.packet=function(c){E("writing packet %j",c);var b=this;b.encoding?b.packetBuffer.push(c):(b.encoding=!0,this.encoder.encode(c,function(c){for(var d=0;d<
c.length;d++)b.engine.write(c[d]);b.encoding=!1;b.processPacketQueue()}))};d.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var c=this.packetBuffer.shift();this.packet(c)}};d.prototype.cleanup=function(){for(var c;c=this.subs.shift();)c.destroy();this.packetBuffer=[];this.encoding=!1;this.decoder.destroy()};d.prototype.close=d.prototype.disconnect=function(){this.skipReconnect=!0;this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};
d.prototype.onclose=function(c){E("close");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",c);this._reconnection&&!this.skipReconnect&&this.reconnect()};d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var c=this;if(this.backoff.attempts>=this._reconnectionAttempts)E("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();E("will wait %dms before reconnect attempt",
b);this.reconnecting=!0;var d=setTimeout(function(){c.skipReconnect||(E("attempting reconnect"),c.emitAll("reconnect_attempt",c.backoff.attempts),c.emitAll("reconnecting",c.backoff.attempts),c.skipReconnect||c.open(function(b){b?(E("reconnect attempt error"),c.reconnecting=!1,c.reconnect(),c.emitAll("reconnect_error",b.data)):(E("reconnect success"),c.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(d)}})}};d.prototype.onreconnect=function(){var c=this.backoff.attempts;this.reconnecting=
!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",c)}},{"./on":53,"./socket":54,"./url":55,backo2:4,"component-bind":7,"component-emitter":8,debug:10,"engine.io-client":11,indexof:32,"object-component":39,"socket.io-parser":57}],53:[function(c,b,e){b.exports=function(c,b,d){c.on(b,d);return{destroy:function(){c.removeListener(b,d)}}}},{}],54:[function(c,b,e){function d(c,b){this.io=c;this.nsp=b;this.json=this;this.ids=0;this.acks={};this.io.autoConnect&&this.open();this.receiveBuffer=
[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0}var g=c("socket.io-parser");e=c("component-emitter");var m=c("to-array"),q=c("./on"),w=c("component-bind"),z=c("debug")("socket.io-client:socket"),E=c("has-binary");b.exports=d;var l={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},h=e.prototype.emit;e(d.prototype);d.prototype.subEvents=function(){if(!this.subs){var c=this.io;this.subs=
[q(c,"open",w(this,"onopen")),q(c,"packet",w(this,"onpacket")),q(c,"close",w(this,"onclose"))]}};d.prototype.open=d.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==this.io.readyState)this.onopen();return this};d.prototype.send=function(){var c=m(arguments);c.unshift("message");this.emit.apply(this,c);return this};d.prototype.emit=function(c){if(l.hasOwnProperty(c))return h.apply(this,arguments),this;var b=m(arguments),d=g.EVENT;E(b)&&(d=g.BINARY_EVENT);
d={type:d,data:b};"function"==typeof b[b.length-1]&&(z("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),d.id=this.ids++);this.connected?this.packet(d):this.sendBuffer.push(d);return this};d.prototype.packet=function(c){c.nsp=this.nsp;this.io.packet(c)};d.prototype.onopen=function(){z("transport is open - connecting");"/"!=this.nsp&&this.packet({type:g.CONNECT})};d.prototype.onclose=function(c){z("close (%s)",c);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",
c)};d.prototype.onpacket=function(c){if(c.nsp==this.nsp)switch(c.type){case g.CONNECT:this.onconnect();break;case g.EVENT:this.onevent(c);break;case g.BINARY_EVENT:this.onevent(c);break;case g.ACK:this.onack(c);break;case g.BINARY_ACK:this.onack(c);break;case g.DISCONNECT:this.ondisconnect();break;case g.ERROR:this.emit("error",c.data)}};d.prototype.onevent=function(c){var b=c.data||[];z("emitting event %j",b);null!=c.id&&(z("attaching ack callback to event"),b.push(this.ack(c.id)));this.connected?
h.apply(this,b):this.receiveBuffer.push(b)};d.prototype.ack=function(c){var b=this,d=!1;return function(){if(!d){d=!0;var e=m(arguments);z("sending ack %j",e);var f=E(e)?g.BINARY_ACK:g.ACK;b.packet({type:f,id:c,data:e})}}};d.prototype.onack=function(c){z("calling ack %s with %j",c.id,c.data);this.acks[c.id].apply(this,c.data);delete this.acks[c.id]};d.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};d.prototype.emitBuffered=function(){var c;
for(c=0;c<this.receiveBuffer.length;c++)h.apply(this,this.receiveBuffer[c]);this.receiveBuffer=[];for(c=0;c<this.sendBuffer.length;c++)this.packet(this.sendBuffer[c]);this.sendBuffer=[]};d.prototype.ondisconnect=function(){z("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};d.prototype.destroy=function(){if(this.subs){for(var c=0;c<this.subs.length;c++)this.subs[c].destroy();this.subs=null}this.io.destroy(this)};d.prototype.close=d.prototype.disconnect=function(){this.connected&&
(z("performing disconnect (%s)",this.nsp),this.packet({type:g.DISCONNECT}));this.destroy();if(this.connected)this.onclose("io client disconnect");return this}},{"./on":53,"component-bind":7,"component-emitter":8,debug:10,"has-binary":30,"socket.io-parser":57,"to-array":59}],55:[function(c,b,e){(function(d){var e=c("parseuri"),f=c("debug")("socket.io-client:url");b.exports=function(c,b){var g=c;b=b||d.location;null==c&&(c=b.protocol+"//"+b.host);"string"==typeof c&&("/"==c.charAt(0)&&(c="/"==c.charAt(1)?
b.protocol+c:b.hostname+c),/^(https?|wss?):\/\//.test(c)||(f("protocol-less url %s",c),c="undefined"!=typeof b?b.protocol+"//"+c:"https://"+c),f("parse %s",c),g=e(c));g.port||(/^(http|ws)$/.test(g.protocol)?g.port="80":/^(http|ws)s$/.test(g.protocol)&&(g.port="443"));g.path=g.path||"/";g.id=g.protocol+"://"+g.host+":"+g.port;g.href=g.protocol+"://"+g.host+(b&&b.port==g.port?"":":"+g.port);return g}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?
window:{})},{debug:10,parseuri:42}],56:[function(c,b,e){(function(b){var d=c("isarray"),f=c("./is-buffer");e.deconstructPacket=function(c){function b(c){if(!c)return c;if(f(c)){var g={_placeholder:!0,num:e.length};e.push(c);return g}if(d(c)){g=Array(c.length);for(var m=0;m<c.length;m++)g[m]=b(c[m]);return g}if("object"==typeof c&&!(c instanceof Date)){g={};for(m in c)g[m]=b(c[m]);return g}return c}var e=[];c.data=b(c.data);c.attachments=e.length;return{packet:c,buffers:e}};e.reconstructPacket=function(c,
b){function e(c){if(c&&c._placeholder)return b[c.num];if(d(c))for(var f=0;f<c.length;f++)c[f]=e(c[f]);else if(c&&"object"==typeof c)for(f in c)c[f]=e(c[f]);return c}c.data=e(c.data);c.attachments=void 0;return c};e.removeBlobs=function(c,e){function g(c,w,z){if(!c)return c;if(b.Blob&&c instanceof Blob||b.File&&c instanceof File){m++;var E=new FileReader;E.onload=function(){z?z[w]=this.result:q=this.result;--m||e(q)};E.readAsArrayBuffer(c)}else if(d(c))for(E=0;E<c.length;E++)g(c[E],E,c);else if(c&&
"object"==typeof c&&!f(c))for(E in c)g(c[E],E,c)}var m=0,q=c;g(q);m||e(q)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./is-buffer":58,isarray:33}],57:[function(c,b,e){function d(){}function g(c){var b=!1;var d=""+c.type;if(e.BINARY_EVENT==c.type||e.BINARY_ACK==c.type)d+=c.attachments,d+="-";c.nsp&&"/"!=c.nsp&&(b=!0,d+=c.nsp);null!=c.id&&(b&&(d+=",",b=!1),d+=c.id);null!=c.data&&(b&&(d+=","),d+=E.stringify(c.data));z("encoded %j as %s",
c,d);return d}function m(c,b){l.removeBlobs(c,function(c){var d=l.deconstructPacket(c);c=g(d.packet);d=d.buffers;d.unshift(c);b(d)})}function q(){this.reconstructor=null}function w(c){this.reconPack=c;this.buffers=[]}var z=c("debug")("socket.io-parser"),E=c("json3");c("isarray");b=c("component-emitter");var l=c("./binary"),h=c("./is-buffer");e.protocol=4;e.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" ");e.CONNECT=0;e.DISCONNECT=1;e.EVENT=2;e.ACK=3;e.ERROR=4;e.BINARY_EVENT=
5;e.BINARY_ACK=6;e.Encoder=d;e.Decoder=q;d.prototype.encode=function(c,b){z("encoding packet %j",c);e.BINARY_EVENT==c.type||e.BINARY_ACK==c.type?m(c,b):(c=g(c),b([c]))};b(q.prototype);q.prototype.add=function(c){if("string"==typeof c){a:{var b={},d=0;b.type=Number(c.charAt(0));if(null==e.types[b.type])c={type:e.ERROR,data:"parser error"};else{if(e.BINARY_EVENT==b.type||e.BINARY_ACK==b.type){for(var f="";"-"!=c.charAt(++d)&&(f+=c.charAt(d),d!=c.length););if(f!=Number(f)||"-"!=c.charAt(d))throw Error("Illegal attachments");
b.attachments=Number(f)}if("/"==c.charAt(d+1))for(b.nsp="";++d;){f=c.charAt(d);if(","==f)break;b.nsp+=f;if(d==c.length)break}else b.nsp="/";f=c.charAt(d+1);if(""!==f&&Number(f)==f){for(b.id="";++d;){f=c.charAt(d);if(null==f||Number(f)!=f){--d;break}b.id+=c.charAt(d);if(d==c.length)break}b.id=Number(b.id)}if(c.charAt(++d))try{b.data=E.parse(c.substr(d))}catch(yg){c={type:e.ERROR,data:"parser error"};break a}z("decoded %s as %j",c,b);c=b}}e.BINARY_EVENT==c.type||e.BINARY_ACK==c.type?(this.reconstructor=
new w(c),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",c)):this.emit("decoded",c)}else if(h(c)||c.base64)if(this.reconstructor){if(c=this.reconstructor.takeBinaryData(c))this.reconstructor=null,this.emit("decoded",c)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+c);};q.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};w.prototype.takeBinaryData=function(c){this.buffers.push(c);
return this.buffers.length==this.reconPack.attachments?(c=l.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),c):null};w.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},{"./binary":56,"./is-buffer":58,"component-emitter":8,debug:10,isarray:33,json3:34}],58:[function(c,b,e){(function(c){b.exports=function(b){return c.Buffer&&c.Buffer.isBuffer(b)||c.ArrayBuffer&&b instanceof ArrayBuffer}}).call(this,"undefined"!==typeof global?global:"undefined"!==
typeof self?self:"undefined"!==typeof window?window:{})},{}],59:[function(c,b,e){b.exports=function(c,b){for(var d=[],e=(b=b||0)||0;e<c.length;e++)d[e-b]=c[e];return d}},{}],60:[function(c,b,e){(function(c){(function(d){function f(c){for(var b=[],d=0,e=c.length,f,g;d<e;)f=c.charCodeAt(d++),55296<=f&&56319>=f&&d<e?(g=c.charCodeAt(d++),56320==(g&64512)?b.push(((f&1023)<<10)+(g&1023)+65536):(b.push(f),d--)):b.push(f);return b}function g(c){if(55296<=c&&57343>=c)throw Error("Lone surrogate U+"+c.toString(16).toUpperCase()+
" is not a scalar value");}function w(){if(r>=t)throw Error("Invalid byte index");var c=p[r]&255;r++;if(128==(c&192))return c&63;throw Error("Invalid continuation byte");}function z(){if(r>t)throw Error("Invalid byte index");if(r==t)return!1;var c=p[r]&255;r++;if(0==(c&128))return c;if(192==(c&224)){var b=w();c=(c&31)<<6|b;if(128<=c)return c;throw Error("Invalid continuation byte");}if(224==(c&240)){b=w();var d=w();c=(c&15)<<12|b<<6|d;if(2048<=c)return g(c),c;throw Error("Invalid continuation byte");
}if(240==(c&248)){b=w();d=w();var e=w();c=(c&15)<<18|b<<12|d<<6|e;if(65536<=c&&1114111>=c)return c}throw Error("Invalid UTF-8 detected");}var E="object"==typeof e&&e,l="object"==typeof b&&b&&b.exports==E&&b,h="object"==typeof c&&c;if(h.global===h||h.window===h)d=h;var n=String.fromCharCode,p,t,r;h={version:"2.0.0",encode:function(c){c=f(c);for(var b=c.length,d=-1,e,m="";++d<b;){e=c[d];if(0==(e&4294967168))e=n(e);else{var q="";0==(e&4294965248)?q=n(e>>6&31|192):0==(e&4294901760)?(g(e),q=n(e>>12&15|
224),q+=n(e>>6&63|128)):0==(e&4292870144)&&(q=n(e>>18&7|240),q+=n(e>>12&63|128),q+=n(e>>6&63|128));e=q+=n(e&63|128)}m+=e}return m},decode:function(c){p=f(c);t=p.length;r=0;c=[];for(var b;!1!==(b=z());)c.push(b);b=c.length;for(var d=-1,e,g="";++d<b;)e=c[d],65535<e&&(e-=65536,g+=n(e>>>10&1023|55296),e=56320|e&1023),g+=n(e);return g}};if(E&&!E.nodeType)if(l)l.exports=h;else{d={}.hasOwnProperty;for(var v in h)d.call(h,v)&&(E[v]=h[v])}else d.utf8=h})(this)}).call(this,"undefined"!==typeof global?global:
"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],61:[function(c,b,e){b.exports="function"===typeof Object.create?function(c,b){c.super_=b;c.prototype=Object.create(b.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}})}:function(c,b){c.super_=b;var d=function(){};d.prototype=b.prototype;c.prototype=new d;c.prototype.constructor=c}},{}],62:[function(c,b,e){b.exports=function(c){return c&&"object"===typeof c&&"function"===typeof c.copy&&"function"===
typeof c.fill&&"function"===typeof c.readUInt8}},{}],63:[function(c,b,e){(function(b,d){function f(c,b){var d={seen:[],stylize:w};3<=arguments.length&&(d.depth=arguments[2]);4<=arguments.length&&(d.colors=arguments[3]);v(b)?d.showHidden=b:b&&e._extend(d,b);B(d.showHidden)&&(d.showHidden=!1);B(d.depth)&&(d.depth=2);B(d.colors)&&(d.colors=!1);B(d.customInspect)&&(d.customInspect=!0);d.colors&&(d.stylize=g);return E(d,c,d.depth)}function g(c,b){return(b=f.styles[b])?"\u001b["+f.colors[b][0]+"m"+c+"\u001b["+
f.colors[b][1]+"m":c}function w(c,b){return c}function z(c){var b={};c.forEach(function(c,d){b[c]=!0});return b}function E(c,b,d){if(c.customInspect&&b&&F(b.inspect)&&b.inspect!==e.inspect&&(!b.constructor||b.constructor.prototype!==b)){var f=b.inspect(d,c);A(f)||(f=E(c,f,d));return f}if(f=l(c,b))return f;var g=Object.keys(b),m=z(g);c.showHidden&&(g=Object.getOwnPropertyNames(b));if(H(b)&&(0<=g.indexOf("message")||0<=g.indexOf("description")))return h(b);if(0===g.length){if(F(b))return c.stylize("[Function"+
(b.name?": "+b.name:"")+"]","special");if(y(b))return c.stylize(RegExp.prototype.toString.call(b),"regexp");if(D(b))return c.stylize(Date.prototype.toString.call(b),"date");if(H(b))return h(b)}f="";var q=!1,w=["{","}"];r(b)&&(q=!0,w=["[","]"]);F(b)&&(f=" [Function"+(b.name?": "+b.name:"")+"]");y(b)&&(f=" "+RegExp.prototype.toString.call(b));D(b)&&(f=" "+Date.prototype.toUTCString.call(b));H(b)&&(f=" "+h(b));if(0===g.length&&(!q||0==b.length))return w[0]+f+w[1];if(0>d)return y(b)?c.stylize(RegExp.prototype.toString.call(b),
"regexp"):c.stylize("[Object]","special");c.seen.push(b);g=q?n(c,b,d,m,g):g.map(function(e){return p(c,b,d,m,e,q)});c.seen.pop();return t(g,f,w)}function l(c,b){if(B(b))return c.stylize("undefined","undefined");if(A(b))return b="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",c.stylize(b,"string");if(x(b))return c.stylize(""+b,"number");if(v(b))return c.stylize(""+b,"boolean");if(null===b)return c.stylize("null","null")}function h(c){return"["+Error.prototype.toString.call(c)+
"]"}function n(c,b,d,e,f){for(var g=[],m=0,q=b.length;m<q;++m)Object.prototype.hasOwnProperty.call(b,String(m))?g.push(p(c,b,d,e,String(m),!0)):g.push("");f.forEach(function(f){f.match(/^\d+$/)||g.push(p(c,b,d,e,f,!0))});return g}function p(c,b,d,e,f,g){var m,q;b=Object.getOwnPropertyDescriptor(b,f)||{value:b[f]};b.get?q=b.set?c.stylize("[Getter/Setter]","special"):c.stylize("[Getter]","special"):b.set&&(q=c.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(e,f)||(m="["+f+"]");q||
(0>c.seen.indexOf(b.value)?(q=null===d?E(c,b.value,null):E(c,b.value,d-1),-1<q.indexOf("\n")&&(q=g?q.split("\n").map(function(c){return"  "+c}).join("\n").substr(2):"\n"+q.split("\n").map(function(c){return"   "+c}).join("\n"))):q=c.stylize("[Circular]","special"));if(B(m)){if(g&&f.match(/^\d+$/))return q;m=JSON.stringify(""+f);m.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(m=m.substr(1,m.length-2),m=c.stylize(m,"name")):(m=m.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),m=c.stylize(m,
"string"))}return m+": "+q}function t(c,b,d){var e=0;return 60<c.reduce(function(c,b){e++;0<=b.indexOf("\n")&&e++;return c+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)?d[0]+(""===b?"":b+"\n ")+" "+c.join(",\n  ")+" "+d[1]:d[0]+b+" "+c.join(", ")+" "+d[1]}function r(c){return Array.isArray(c)}function v(c){return"boolean"===typeof c}function x(c){return"number"===typeof c}function A(c){return"string"===typeof c}function B(c){return void 0===c}function y(c){return C(c)&&"[object RegExp]"===Object.prototype.toString.call(c)}
function C(c){return"object"===typeof c&&null!==c}function D(c){return C(c)&&"[object Date]"===Object.prototype.toString.call(c)}function H(c){return C(c)&&("[object Error]"===Object.prototype.toString.call(c)||c instanceof Error)}function F(c){return"function"===typeof c}function J(c){return 10>c?"0"+c.toString(10):c.toString(10)}function G(){var c=new Date,b=[J(c.getHours()),J(c.getMinutes()),J(c.getSeconds())].join(":");return[c.getDate(),S[c.getMonth()],b].join(" ")}var K=/%[sdj%]/g;e.format=
function(c){if(!A(c)){for(var b=[],d=0;d<arguments.length;d++)b.push(f(arguments[d]));return b.join(" ")}d=1;var e=arguments,g=e.length;b=String(c).replace(K,function(c){if("%%"===c)return"%";if(d>=g)return c;switch(c){case "%s":return String(e[d++]);case "%d":return Number(e[d++]);case "%j":try{return JSON.stringify(e[d++])}catch(An){return"[Circular]"}default:return c}});for(var m=e[d];d<g;m=e[++d])b=null!==m&&C(m)?b+(" "+f(m)):b+(" "+m);return b};e.deprecate=function(c,f){if(B(d.process))return function(){return e.deprecate(c,
f).apply(this,arguments)};if(!0===b.noDeprecation)return c;var g=!1;return function(){if(!g){if(b.throwDeprecation)throw Error(f);b.traceDeprecation?console.trace(f):console.error(f);g=!0}return c.apply(this,arguments)}};var L={},I;e.debuglog=function(c){B(I)&&(I=b.env.NODE_DEBUG||"");c=c.toUpperCase();if(!L[c])if((new RegExp("\\b"+c+"\\b","i")).test(I)){var d=b.pid;L[c]=function(){var b=e.format.apply(e,arguments);console.error("%s %d: %s",c,d,b)}}else L[c]=function(){};return L[c]};e.inspect=f;
f.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};f.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};e.isArray=r;e.isBoolean=v;e.isNull=function(c){return null===c};e.isNullOrUndefined=function(c){return null==c};e.isNumber=x;e.isString=A;e.isSymbol=function(c){return"symbol"===
typeof c};e.isUndefined=B;e.isRegExp=y;e.isObject=C;e.isDate=D;e.isError=H;e.isFunction=F;e.isPrimitive=function(c){return null===c||"boolean"===typeof c||"number"===typeof c||"string"===typeof c||"symbol"===typeof c||"undefined"===typeof c};e.isBuffer=c("./support/isBuffer");var S="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");e.log=function(){console.log("%s - %s",G(),e.format.apply(e,arguments))};e.inherits=c("inherits");e._extend=function(c,b){if(!b||!C(b))return c;for(var d=Object.keys(b),
e=d.length;e--;)c[d[e]]=b[d[e]];return c}}).call(this,c("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":62,_process:43,inherits:61}],64:[function(c,b,e){if(window.mozRTCPeerConnection||navigator.mozGetUserMedia){var d="moz";var g=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)}else if(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)d="webkit",g=navigator.userAgent.match(/Chrom(e|ium)/)&&
parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10);c=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;e=window.mozRTCIceCandidate||window.RTCIceCandidate;var m=window.mozRTCSessionDescription||window.RTCSessionDescription,q=window.webkitMediaStream||window.MediaStream,w="https:"===window.location.protocol&&("webkit"===d&&26<=g||"moz"===d&&33<=g),z=window.AudioContext||window.webkitAudioContext,E=document.createElement("video");E=E&&E.canPlayType&&
"probably"===E.canPlayType('video/webm; codecs="vp8", vorbis');var l=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;b.exports={prefix:d,browserVersion:g,support:!!c&&!!l,supportRTCPeerConnection:!!c,supportVp8:E,supportGetUserMedia:!!l,supportDataChannel:!!(c&&c.prototype&&c.prototype.createDataChannel),supportWebAudio:!(!z||!z.prototype.createMediaStreamSource),supportMediaStream:!(!q||!q.prototype.removeTrack),supportScreenSharing:!!w,AudioContext:z,
PeerConnection:c,SessionDescription:m,IceCandidate:e,MediaStream:q,getUserMedia:l}},{}],65:[function(c,b,e){function d(){}b.exports=d;d.mixin=function(c){c=c.prototype||c;c.isWildEmitter=!0;c.on=function(c,b,d){this.callbacks=this.callbacks||{};var e=3===arguments.length,f=e?arguments[2]:arguments[1];f._groupName=e?arguments[1]:void 0;(this.callbacks[c]=this.callbacks[c]||[]).push(f);return this};c.once=function(c,b,d){function e(){f.off(c,e);m.apply(this,arguments)}var f=this,g=3===arguments.length,
m=g?arguments[2]:arguments[1];this.on(c,g?arguments[1]:void 0,e);return this};c.releaseGroup=function(c){this.callbacks=this.callbacks||{};var b,d;for(b in this.callbacks){var e=this.callbacks[b];var f=0;for(d=e.length;f<d;f++)e[f]._groupName===c&&(e.splice(f,1),f--,d--)}return this};c.off=function(c,b){this.callbacks=this.callbacks||{};var d=this.callbacks[c];if(!d)return this;if(1===arguments.length)return delete this.callbacks[c],this;var e=d.indexOf(b);d.splice(e,1);0===d.length&&delete this.callbacks[c];
return this};c.emit=function(c){this.callbacks=this.callbacks||{};var b=[].slice.call(arguments,1),d=this.callbacks[c],e=this.getWildcardCallbacks(c),f;if(d){var g=d.slice();d=0;for(f=g.length;d<f&&g[d];++d)g[d].apply(this,b)}if(e)for(g=e.slice(),d=0,f=g.length;d<f&&g[d];++d)g[d].apply(this,[c].concat(b));return this};c.getWildcardCallbacks=function(c){this.callbacks=this.callbacks||{};var b,d=[];for(b in this.callbacks){var e=b.split("*");if("*"===b||2===e.length&&c.slice(0,e[0].length)===e[0])d=
d.concat(this.callbacks[b])}return d}};d.mixin(d)},{}],66:[function(c,b,e){function d(c,b,d){return b?new g(c,b):new g(c)}c=window;var g=c.WebSocket||c.MozWebSocket;b.exports=g?d:null;g&&(d.prototype=g.prototype)},{}],67:[function(c,b,e){function d(c){var b=!0;c.getTracks().forEach(function(c){b="ended"===c.readyState&&b});return b}function g(c){var b=this;w.call(this);this.id=c.id;this.parent=c.parent;this.type=c.type||"video";this.oneway=c.oneway||!1;this.sharemyscreen=c.sharemyscreen||!1;this.browserPrefix=
c.prefix;this.stream=c.stream;this.enableDataChannels=void 0===c.enableDataChannels?this.parent.config.enableDataChannels:c.enableDataChannels;this.receiveMedia=c.receiveMedia||this.parent.config.receiveMedia;this.channels={};this.sid=c.sid||Date.now().toString();this.pc=new q(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints);this.pc.on("ice",this.onIceCandidate.bind(this));this.pc.on("endOfCandidates",function(c){b.send("endOfCandidates",c)});this.pc.on("offer",
function(c){b.parent.config.nick&&(c.nick=b.parent.config.nick);b.send("offer",c)});this.pc.on("answer",function(c){b.parent.config.nick&&(c.nick=b.parent.config.nick);b.send("answer",c)});this.pc.on("addStream",this.handleRemoteStreamAdded.bind(this));this.pc.on("addChannel",this.handleDataChannelAdded.bind(this));this.pc.on("removeStream",this.handleStreamRemoved.bind(this));this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded"));this.pc.on("iceConnectionStateChange",this.emit.bind(this,
"iceConnectionStateChange"));this.pc.on("iceConnectionStateChange",function(){switch(b.pc.iceConnectionState){case "failed":"offer"===b.pc.pc.localDescription.type&&(b.parent.emit("iceFailed",b),b.send("connectivityError"))}});this.pc.on("signalingStateChange",this.emit.bind(this,"signalingStateChange"));this.logger=this.parent.logger;"screen"===c.type?this.parent.localScreens&&this.parent.localScreens[0]&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),this.pc.addStream(this.parent.localScreens[0]),
this.broadcaster=c.broadcaster):this.parent.localStreams.forEach(function(c){b.pc.addStream(c)});this.on("channelOpen",function(c){"https://simplewebrtc.com/protocol/filetransfer#inband-v1"===c.protocol&&(c.onmessage=function(d){d=JSON.parse(d.data);var e=new l.Receiver;e.receive(d,c);b.emit("fileTransfer",d,e);e.on("receivedFile",function(c,b){e.channel.close()})})});this.on("*",function(){b.parent.emit.apply(b.parent,arguments)})}e=c("util");var m=c("webrtcsupport"),q=c("rtcpeerconnection"),w=c("wildemitter"),
l=c("filetransfer");e.inherits(g,w);g.prototype.handleMessage=function(c){var b=this;this.logger.log("getting",c.type,c);c.prefix&&(this.browserPrefix=c.prefix);"offer"===c.type?(this.nick||(this.nick=c.payload.nick),delete c.payload.nick,this.pc.handleOffer(c.payload,function(c){c||b.pc.answer(function(c,b){})})):"answer"===c.type?(this.nick||(this.nick=c.payload.nick),delete c.payload.nick,this.pc.handleAnswer(c.payload)):"candidate"===c.type?this.pc.processIce(c.payload):"connectivityError"===
c.type?this.parent.emit("connectivityError",b):"mute"===c.type?this.parent.emit("mute",{id:c.from,name:c.payload.name}):"unmute"===c.type&&this.parent.emit("unmute",{id:c.from,name:c.payload.name})};g.prototype.send=function(c,b){b={to:this.id,sid:this.sid,broadcaster:this.broadcaster,roomType:this.type,type:c,payload:b,prefix:m.prefix};this.logger.log("sending",c,b);this.parent.emit("message",b)};g.prototype.sendDirectly=function(c,b,d){this.logger.log("sending via datachannel",c,b,{type:b,payload:d});
c=this.getDataChannel(c);if("open"!=c.readyState)return!1;c.send(d);return!0};g.prototype._observeDataChannel=function(c){var b=this;c.binaryType="arraybuffer";c.onclose=this.emit.bind(this,"channelClose",c);c.onerror=this.emit.bind(this,"channelError",c);c.onmessage=function(d){var e=new Uint32Array(d.data);b.emit("channelMessage",b,c.label,e,c,d)};c.onopen=this.emit.bind(this,"channelOpen",c)};g.prototype.getDataChannel=function(c,b){if(!m.supportDataChannel)return this.emit("error",Error("createDataChannel not supported"));
var d=this.channels[c];b||(b={});if(d)return d;d=this.channels[c]=this.pc.createDataChannel(c,b);d.binaryType="arraybuffer";this._observeDataChannel(d);return d};g.prototype.onIceCandidate=function(c){if(!this.closed)if(c){var b=this.parent.config.peerConnectionConfig;"moz"===m.prefix&&b&&b.iceTransports&&c.candidate&&c.candidate.candidate&&0>c.candidate.candidate.indexOf(b.iceTransports)?this.logger.log("Ignoring ice candidate not matching pcConfig iceTransports type: ",b.iceTransports):this.send("candidate",
c)}else this.logger.log("End of candidates.")};g.prototype.start=function(){this.enableDataChannels&&this.getDataChannel("simplewebrtc");this.pc.offer(this.receiveMedia,function(c,b){})};g.prototype.icerestart=function(){var c=this.receiveMedia;c.mandatory.IceRestart=!0;this.pc.offer(c,function(c,b){})};g.prototype.end=function(){this.closed||(this.pc.close(),this.handleStreamRemoved())};g.prototype.handleRemoteStreamAdded=function(c){var b=this;this.stream?this.logger.warn("Already have a remote stream"):
(this.stream=c.stream,this.stream.getTracks().forEach(function(c){c.addEventListener("ended",function(){d(b.stream)&&b.end()})}),this.parent.emit("peerStreamAdded",this))};g.prototype.handleStreamRemoved=function(){var c=this.parent.peers.indexOf(this);-1<c&&(this.parent.peers.splice(c,1),this.closed=!0,this.parent.emit("peerStreamRemoved",this))};g.prototype.handleDataChannelAdded=function(c){this.channels[c.label]=c;this._observeDataChannel(c)};g.prototype.sendFile=function(c){var b=new l.Sender,
d=this.getDataChannel("filetransfer"+(new Date).getTime(),{protocol:"https://simplewebrtc.com/protocol/filetransfer#inband-v1"});d.onopen=function(){d.send(JSON.stringify({size:c.size,name:c.name}));b.send(c,d)};d.onclose=function(){console.log("sender received transfer");b.emit("complete")};return b};b.exports=g},{filetransfer:26,rtcpeerconnection:44,util:63,webrtcsupport:64,wildemitter:65}],68:[function(c,b,e){function d(c){var b=this,d=c||{},e=this.config={url:"https://sandbox.simplewebrtc.com:443/",
socketio:{},connection:null,debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!1,peerVolumeWhenSpeaking:.25,media:{video:!0,audio:!0},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},localVideo:{autoplay:!0,mirror:!0,muted:!0}},f;var z=c.debug?c.logger||console:c.logger||l;this.logger=z;for(f in d)d.hasOwnProperty(f)&&(this.config[f]=d[f]);this.capabilities=q;m.call(this);var E=null===this.config.connection?this.connection=
new h(this.config):this.connection=this.config.connection;E.on("connect",function(){b.emit("connectionReady",E.getSessionid());b.sessionReady=!0;b.testReadiness()});E.on("message",function(c){var d=b.webrtc.getPeers(c.from,c.roomType);if("offer"===c.type){d.length&&d.forEach(function(b){b.sid==c.sid&&(e=b)});if(!e){var e=b.webrtc.createPeer({id:c.from,sid:c.sid,type:c.roomType,enableDataChannels:b.config.enableDataChannels&&"screen"!==c.roomType,sharemyscreen:"screen"===c.roomType&&!c.broadcaster,
broadcaster:"screen"!==c.roomType||c.broadcaster?null:b.connection.getSessionid()});b.emit("createdPeer",e)}e.handleMessage(c)}else d.length&&d.forEach(function(b){c.sid?b.sid===c.sid&&b.handleMessage(c):b.handleMessage(c)})});E.on("remove",function(c){c.id!==b.connection.getSessionid()&&b.webrtc.removePeers(c.id,c.type)});c.logger=this.logger;c.debug=!1;this.webrtc=new g(c);"mute unmute pauseVideo resumeVideo pause resume sendToAll sendDirectlyToAll getPeers".split(" ").forEach(function(c){b[c]=
b.webrtc[c].bind(b.webrtc)});this.webrtc.on("*",function(){b.emit.apply(b,arguments)});if(e.debug)this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:"));this.webrtc.on("localStream",function(){b.testReadiness()});this.webrtc.on("message",function(c){b.connection.emit("message",c)});this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this));this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this));this.config.adjustPeerVolume&&(this.webrtc.on("speaking",
this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1)));E.on("stunservers",function(c){b.webrtc.config.peerConnectionConfig.iceServers=c;b.emit("stunservers",c)});E.on("turnservers",function(c){b.webrtc.config.peerConnectionConfig.iceServers=b.webrtc.config.peerConnectionConfig.iceServers.concat(c);b.emit("turnservers",c)});this.webrtc.on("iceFailed",function(c){});this.webrtc.on("connectivityError",function(c){});this.webrtc.on("audioOn",
function(){b.webrtc.sendToAll("unmute",{name:"audio"})});this.webrtc.on("audioOff",function(){b.webrtc.sendToAll("mute",{name:"audio"})});this.webrtc.on("videoOn",function(){b.webrtc.sendToAll("unmute",{name:"video"})});this.webrtc.on("videoOff",function(){b.webrtc.sendToAll("mute",{name:"video"})});this.webrtc.on("localScreen",function(c){var d=document.createElement("video"),e=b.getRemoteVideoContainer();d.oncontextmenu=function(){return!1};d.id="localScreen";w(c,d);e&&e.appendChild(d);b.emit("localScreenAdded",
d);b.connection.emit("shareScreen");b.webrtc.peers.forEach(function(c){"video"===c.type&&(c=b.webrtc.createPeer({id:c.id,type:"screen",sharemyscreen:!0,enableDataChannels:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},broadcaster:b.connection.getSessionid()}),b.emit("createdPeer",c),c.start())})});this.webrtc.on("localScreenStopped",function(c){b.getLocalScreen()&&b.stopScreenShare()});this.webrtc.on("channelMessage",function(c,d,e){"volume"==e.type&&b.emit("remoteVolumeChange",c,e.volume)});
this.config.autoRequestMedia&&this.startLocalVideo()}var g=c("./webrtc"),m=c("wildemitter"),q=c("webrtcsupport"),w=c("attachmediastream"),l=c("mockconsole"),h=c("./socketioconnection");d.prototype=Object.create(m.prototype,{constructor:{value:d}});d.prototype.leaveRoom=function(){if(this.roomName){for(this.connection.emit("leave");this.webrtc.peers.length;)this.webrtc.peers[0].end();this.getLocalScreen()&&this.stopScreenShare();this.emit("leftRoom",this.roomName);this.roomName=void 0}};d.prototype.disconnect=
function(){this.connection.disconnect();delete this.connection};d.prototype.handlePeerStreamAdded=function(c){var b=this,d=this.getRemoteVideoContainer(),e=w(c.stream);c.videoEl=e;e.id=this.getDomId(c);d&&d.appendChild(e);this.emit("videoAdded",e,c);window.setTimeout(function(){b.webrtc.isAudioEnabled()||c.send("mute",{name:"audio"});b.webrtc.isVideoEnabled()||c.send("mute",{name:"video"})},250)};d.prototype.handlePeerStreamRemoved=function(c){var b=this.getRemoteVideoContainer(),d=c.videoEl;this.config.autoRemoveVideos&&
b&&d&&b.removeChild(d);d&&this.emit("videoRemoved",d,c)};d.prototype.getDomId=function(c){return[c.id,c.type,c.broadcaster?"broadcasting":"incoming"].join("_")};d.prototype.setVolumeForAll=function(c){this.webrtc.peers.forEach(function(b){b.videoEl&&(b.videoEl.volume=c)})};d.prototype.joinRoom=function(c,b){var d=this;this.roomName=c;this.connection.emit("join",c,function(e,f){console.log("join CB",e);if(e)d.emit("error",e);else{if(!f.xtra){gb();Pb();Wc(t.errorLoading,"#ff0000");return}y.room=f.xtra;
var g,m;for(g in f.clients){var q=f.clients[g];for(m in q)if(q[m]){var w=d.webrtc.createPeer({id:g,type:m,enableDataChannels:d.config.enableDataChannels&&"screen"!==m,receiveMedia:{offerToReceiveAudio:"screen"!==m&&d.config.receiveMedia.offerToReceiveAudio?1:0,offerToReceiveVideo:d.config.receiveMedia.offerToReceiveVideo}});d.emit("createdPeer",w);w.start()}}}b&&b(e,f);d.emit("joinedRoom",c)})};d.prototype.getEl=function(c){return"string"===typeof c?document.getElementById(c):c};d.prototype.startLocalVideo=
function(){var c=this;this.webrtc.start(this.config.media,function(b,d){b?c.emit("localMediaError",b):w(d,c.getLocalVideoContainer(),c.config.localVideo)})};d.prototype.stopLocalVideo=function(){this.webrtc.stop()};d.prototype.getLocalVideoContainer=function(){var c=this.getEl(this.config.localVideoEl);if(c&&"VIDEO"===c.tagName)return c.oncontextmenu=function(){return!1},c;if(c){var b=document.createElement("video");b.oncontextmenu=function(){return!1};c.appendChild(b);return b}};d.prototype.getRemoteVideoContainer=
function(){return this.getEl(this.config.remoteVideosEl)};d.prototype.shareScreen=function(c){this.webrtc.startScreenShare(c)};d.prototype.getLocalScreen=function(){return this.webrtc.localScreens&&this.webrtc.localScreens[0]};d.prototype.stopScreenShare=function(){this.connection.emit("unshareScreen");var c=document.getElementById("localScreen"),b=this.getRemoteVideoContainer();this.config.autoRemoveVideos&&b&&c&&b.removeChild(c);c&&this.emit("videoRemoved",c);this.getLocalScreen()&&this.webrtc.stopScreenShare();
this.webrtc.peers.forEach(function(c){c.broadcaster&&c.end()})};d.prototype.testReadiness=function(){this.sessionReady&&(this.config.media.video||this.config.media.audio?0<this.webrtc.localStreams.length&&this.emit("readyToCall",this.connection.getSessionid()):this.emit("readyToCall",this.connection.getSessionid()))};d.prototype.createRoom=function(c,b){this.roomName=c;this.connection.emit("create",y.room,b)};d.prototype.sendFile=function(){if(!q.dataChannel)return this.emit("error",Error("DataChannelNotSupported"))};
b.exports=d},{"./socketioconnection":69,"./webrtc":70,attachmediastream:3,mockconsole:37,webrtcsupport:64,wildemitter:65}],69:[function(c,b,e){function d(c){this.connection=g.connect(c.url,c.socketio)}var g=c("socket.io-client");d.prototype.on=function(c,b){this.connection.on(c,b)};d.prototype.emit=function(){this.connection.emit.apply(this.connection,arguments)};d.prototype.getSessionid=function(){return this.connection.id};d.prototype.disconnect=function(){return this.connection.disconnect()};b.exports=
d},{"socket.io-client":50}],70:[function(c,b,e){function d(c){var b=this,d=c||{};this.config={debug:!1,peerConnectionConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[]},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},enableDataChannels:!0};var e;c=c.debug?c.logger||console:c.logger||m;this.logger=c;for(e in d)d.hasOwnProperty(e)&&(this.config[e]=d[e]);g.support||this.logger.error("Your browser doesn't seem to support WebRTC");this.peers=[];
q.call(this,this.config);this.on("speaking",function(){b.hardMuted||b.peers.forEach(function(c){c.enableDataChannels&&(c=c.getDataChannel("hark"),"open"==c.readyState&&c.send(JSON.stringify({type:"speaking"})))})});this.on("stoppedSpeaking",function(){b.hardMuted||b.peers.forEach(function(c){c.enableDataChannels&&(c=c.getDataChannel("hark"),"open"==c.readyState&&c.send(JSON.stringify({type:"stoppedSpeaking"})))})});this.on("volumeChange",function(c,d){b.hardMuted||b.peers.forEach(function(b){b.enableDataChannels&&
(b=b.getDataChannel("hark"),"open"==b.readyState&&b.send(JSON.stringify({type:"volume",volume:c})))})});if(this.config.debug)this.on("*",function(c,d,e){(b.config.logger===m?console:b.logger).log("event:",c,d,e)})}e=c("util");var g=c("webrtcsupport"),m=c("mockconsole"),q=c("localmedia"),w=c("./peer");e.inherits(d,q);d.prototype.createPeer=function(c){c.parent=this;c=new w(c);this.peers.push(c);return c};d.prototype.removePeers=function(c,b){this.getPeers(c,b).forEach(function(c){c.end()})};d.prototype.getPeers=
function(c,b){return this.peers.filter(function(d){return(!c||d.id===c)&&(!b||d.type===b)})};d.prototype.sendToAll=function(c,b){this.peers.forEach(function(d){d.send(c,b)})};d.prototype.sendDirectlyToAll=function(c,b,d){this.peers.forEach(function(e){e.enableDataChannels&&e.sendDirectly(c,b,d)})};b.exports=d},{"./peer":67,localmedia:35,mockconsole:37,util:63,webrtcsupport:64}]},{},[68])(68)})},H,Fa,t={},y={name:localStorage.name,color:localStorage.color||"#ff0000"},Bb=function(){};console.log("%c nehhon %c POWER ",
"background: #00ffd4; color: #000; font-size:20px","background: #000; color: #00ffd4; font-size:20px");console.log("%c webmaster@nehhon.com ","background: #00ffd4; color: #000; font-size:20px");console.log("%c @nehhon ","background: #000; color: #00ffd4; font-size:20px");var p=function(b){return document.getElementById(b)},Ba=function(b,c,d){void 0===localStorage[b]&&(localStorage[b]=c);d&&(p(d).value=localStorage[b])};void 0===localStorage.fullscreen&&(localStorage.fullscreen=!0);Ba("favMusic","originalMusic");
Ba("musicRange",36);Ba("soundRange",100);Ba("goldRes",400);Ba("foodRes",400);Ba("stoneRes",400);Ba("woodRes",400);Ba("nplayed",0);Ba("infinity","true");Ba("mapx",256);Ba("terrainType","grass");Ba("water","0");Ba("items","10");Ba("peons","3");Ba("gateways","1");Ba("freePop","1");console.log=Bb;console.error=Bb;console.warn=Bb;console.info=Bb;"tza.red"!==location.hostname&&(location.href="https://tza.red");window.onbeforeunload=function(){return"Are you sure you want to quit?"};var Tl=function(b){b.parentNode.removeChild(b)},
Wc=function(b,c){var k=p("notifybar"),e=document.createElement("div");e.innerHTML=b;c&&(e.style.background=c);k.appendChild(e);setTimeout(Tl,11E3,e)};document.body.style.setProperty("--baksp","linear-gradient(60deg, rgba(55, 0, 56, 0.6) 0%, rgba(var(--lred),var(--lgreen),var(--lblue), 0.5) 100%), url(/nehhon/bak2.jpg) fixed repeat");document.body.style.setProperty("--bak2sp","url(/nehhon/bak.jpg) fixed repeat");var Ul=location;(function(){var b=!!window.opr||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),
c="undefined"!==typeof InstallTrigger,d=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),e=!!document.documentMode,f=!e&&!!window.StyleMedia,g=!!window.chrome&&!!window.chrome.webstore,m;b?m="Opera":c?m="Firefox":d?m="Safari":e?m="IE":f?m="Edge":g&&(m="Chrome");y.navLang=localStorage.language||navigator.language||navigator.userLanguage;"IE"!=m&&"Edge"!=m&&"Safari"!=m||Wc("Your browser is not supported","#ff0000");b=y.navLang.substr(0,2);c={es:["Tzared","Juego de estrategia en tiempo real para navegadores web, juega solo o con amigos",
"tzared,jugar,multijugador,juego,online,navegador web,tzar"],it:["Tzared","Gioco di strategia in tempo reale per browser web, giocare da soli o con gli amici","tzared,giocare,multigiocatore,gioco,online,navigatore,tzar,web"],pl:["Tzared","Gra strategiczna w czasie rzeczywistym dla przegl\u0105darek internetowych, bawi\u0107 si\u0119 samotnie lub z przyjaci\u00f3\u0142mi","tzared,gra,multiplayer,online,tzar,przegl\u0105darka internetowa"],ru:["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u043b\u044f \u0432\u0435\u0431-\u0431\u0440\u0430\u0443\u0437\u0435\u0440\u043e\u0432, \u0438\u0433\u0440\u0430\u0442\u044c \u0432 \u043e\u0434\u0438\u043d\u043e\u0447\u043a\u0443 \u0438\u043b\u0438 \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438",
"\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u044c\u0442\u0438\u043f\u043b\u0435\u0435\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u0435\u0440,\u043e\u0433\u043d\u0451\u043c \u0438 \u043c\u0435\u0447\u043e\u043c"],pt:["Tzared","Jogo de estrat\u00e9gia em tempo real para navegadores da web, jogar sozinho ou com amigos","tzared,jogar,multiplayer,jogo,online,navegador web,tzar"],bg:["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0447\u0435\u0441\u043a\u0430 \u0438\u0433\u0440\u0430 \u0432 \u0440\u0435\u0430\u043b\u043d\u043e \u0432\u0440\u0435\u043c\u0435 \u0437\u0430 \u0443\u0435\u0431 \u0431\u0440\u0430\u0443\u0437\u044a\u0440\u0438, \u0438\u0433\u0440\u0430\u0439\u0442\u0435 \u0441\u0430\u043c\u0438 \u0438\u043b\u0438 \u0441 \u043f\u0440\u0438\u044f\u0442\u0435\u043b\u0438",
"\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u0442\u0438\u043f\u043b\u0435\u0439\u044a\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u044a\u0440"],de:["Tzared","Echtzeit-Strategiespiel f\u00fcr Webbrowser, alleine oder mit Freunden spielen","tzared,multiplayer,spiel,online,Webbrowser,tzar"],en:["Tzared","Real-time strategy game for web browsers, play alone or with friends","tzared,play,multiplayer,game,online,browser,tzar,web"]};c[b]||(b=
"en");document.getElementsByTagName("html")[0].lang=b;c=c[location.search.split("lang=")[1]||"en"];document.title=c[0];y.title=c[0];document.getElementsByTagName("meta").description=c[1];document.getElementsByTagName("meta").keywords=c[2];y.version="v34.2";y.versionDate=Date.now()-1553802482789;localStorage.version!==y.version&&(localStorage.version=y.version,Wc("Updated to "+y.version));p("info").innerHTML="Work in progress - Beta "+y.version+" - Updated "+~~(y.versionDate/864E5)+" days ago";y.lang=
"en es it pt ru pl bg de".split(" ").indexOf(b);0>y.lang&&(y.lang=0);y.langstr=b;y.team=0;y.race=0;y.navigator=m;y.mx=151;y.onlineID=null;y.temperature=0;y.cdn="/nehhon/"})();window.onload=function(){document.getElementById("loadingpage").style="visibility: hidden;\n  opacity: 0;\n  transition: visibility .5s, opacity .5s linear;";setTimeout(function(){document.body.removeChild(document.getElementById("loadingpage"))},1E3)};t={open:"Open",loading:"Loading...",systemAlert:"System Message",notEnough:"Not enough %s",
ok:"OK",yes:"Yes",no:"No",secure:"Are you sure?",gold:"Gold",stone:"Stone",wood:"Wood",food:"Food",mana:"Manna",warning:"Warning",play:"PLAY",grass:"Grass",snow:"Snow",close:"CLOSE",gameClosed:"The game was canceled by the server.",loadgraphics:"Downloading graphics...",waitImages:"Downloading graphics",wait:"Wait",audioproblem:"Your browser is not compatible with Web Audio",defeated:"DEFEATED",victorious:"VICTORIOUS",options:"OPTIONS",refresh:"Refresh",back:"BACK",paused:"PAUSED",chatMsg:"CHAT MESSAGE",
disconnect:"Disconnect",playerDisconnected:"%s has disconnected!",connectionError:"Connection error",noP2P:"Engine not loaded",startingResources:"Starting Resources",mapSize:"Map Size",menu:"MENU",quit:"QUIT",downloadAll:"Download all",continue:"Continue",backToGame:"BACK TO GAME",initializing:"Initializing...",requires:"Requires",stop:"Stop",pickItems:"Pick items",move:"Move",stand:"Stand ground",explore:"Explore",patrol:"Patrol",guard:"Guard",errorLoading:"Error loading game.",waitingPlayers:"Waiting for players to connect",
musicVolume:"Music Volume",soundVolume:"Sound Volume",common:"Common",popLimit:"Population limit reached",houseLimit:"Not enough houses",lightning:"Lightning",freeze:"Freeze",bless:"Bless",heal:"Heal",invisibility:"Invisibility",dcm:"Dig, chop or mine",repair:"Repair building",menuBuild:"See what you can build",units:"Units",infinite:"Infinite",gameFull:"Sorry, the game is full.",terrainOption:"Terrain",playerDefeated:"%s has been defeated!",savegame:"SAVE GAME",loadRecord:"Recording",stats:"Stats",
builds:"Builds",items:"Items",nature:"Nature",trees:"Trees",delete:"Delete",create:"Create",username:"Player Name",gameOptions:"GAME OPTIONS",nplayers:"Number of Players",gameName:"Enter Game Name",gamesFound:"Games Found",strSearch:"SEARCH| Search for existing games",strCreate:"CREATE| Create a game",randomMap:"RANDOM MAP",strcusMap:"CUSTOM MAP",strSettings:"SETTINGS",mapMaking:"Map Making",terrain:"Terrain",save:"SAVE",accept:"ACCEPT",team:"Team",color:"Colour",offlinePlay:"For playing offline",
AI:"AI Assist",kingdom:"Kingdom",attack:"Attack",defence:"Defence",health:"Health",maxHealth:"Max health",playing:"Playing",waiting:"Waiting",joining:"Joining...",random:"Random",cancel:"CANCEL",rules:"Rules",events:"Events",actions:"Actions",objAction:"Object action",destroyObj:"Destroy object",defined:"Defined",undefined:"Undefined",destroy:"Destroy",capture:"Capture",moving:"Moving",add:"Add",objOrder:"Order",objZone:"Object in zone",zone:"Zone",editMap:"Edit",mapName:"Map name",water:"Water",
description:"Map Description",author:"Author",fullscreen:"Automatic full screen",fullscreen2:"Full screen",versionError:"Incorrect game version.",language:"Language",english:"English",spanish:"Espa\u00f1ol",italian:"Italiano",portuguese:"Portugu\u00eas",russian:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439",polish:"Polski",bulgarian:"\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438",german:"Deutsch",up:"Up",down:"Down",kick:"Kick",kicked:"You were kicked off by the server.",nospace:"Not enought space",
peons:"Peasants",gateways:"Magic Gateways",computer:"Computer",addAI:"Add AI",race:"Race",date:"Date",freePop:"Free population",about:"About",loadTerrain:"Loading Terrain...",downloadmap:"Download savegame",timePlayed:"Played time"};var Ai=Bb,Ci=function(k){k--;var c=new XMLHttpRequest;c.open("GET","/nehhon/"+y.langstr+".json",!0);c.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");c.onreadystatechange=function(){if(4==c.readyState&&200==c.status){var k=JSON.parse(c.response);
Ai=function(){for(var c=A,b=0;b<c.length;b++){var d=c[b].name;k[d]&&(c[b].name=k[d])}for(b=0;b<F.length;b++)c=F[b],k[c.name[0]]&&k[c.name[1]]&&(c.name[0]=k[c.name[0]],c.name[1]=k[c.name[1]]);k=null};for(var e=[],f=0;0>f;f++)"undefined"!=typeof b[f]&&null!=b[f].tech&&(e.push(b[f].tech.name),Object.freeze(b[f].tech));for(f=0;f<e.length;f++)e[f][0]=k[e[f][0]],e[f][1]=k[e[f][1]];e=Object.keys(t);for(f=0;f<e.length;f++){var g=e[f];void 0!=k[t[g]]&&(t[g]=k[t[g]])}Object.freeze(t);for(f=0;f<Ra.length;f++)Ra[f]=
k[Ra[f]];for(f=0;f<0*Ag.length;f++)Ag[f]=k[Ag[f]];Object.freeze(Ra);Bi()}};c.send()},Bi=function(){for(var b=["refreshButton",t.refresh,"optionsButton",t.options,"startButton",t.play,"backButton",t.back,"closeButton",t.close,"quitButton",t.quit,"continueButton",t.continue],c=0,d=b.length;c<d;c+=2)for(var e=document.getElementsByClassName(b[c]),f=0,g=e.length;f<g;f++)e[f].innerHTML=b[c+1];b=["alertok",t.ok,"gamesFound",t.gamesFound,"strSearch",t.strSearch.split("| ")[1],"strCreate",t.strCreate.split("| ")[1],
"strRandomMap",t.randomMap,"strcusMap",t.strcusMap,"strMapEditor",t.mapMaking,"h2rndMap",t.randomMap,"strSettings",t.strSettings,"about",t.about];c=0;for(d=b.length;c<d;c+=2)p(b[c]).innerHTML=b[c+1]};0<y.lang?(Ci(y.lang),Ci.translated=!0):Bi();var C=console.log,Vl=p("alerttitle"),Wl=p("alerttext"),Xl=p("alert"),yc=function(b,c,d){Xl.style.display="block";Vl.innerHTML=c||t.warning;Wl.innerHTML=b;d?p("alertok").style.display="none":p("alertok").style.display="block";p("basic").style.filter="blur(94px)"},
Yl=[1E3,0,2E3,0],Qb=function(){C(u8234);var b=["icons.png","images.json","graphics.nh17","terrainDataGrass.json","grass.nh17"];b=b.concat(Ae);var c=b.length;Qb.max=c;for(var d=0;d<c;d++)Zl(y.cdn+b[d]);this.innerHTML="0%";this.disabled=!0;Qb.button=this};Qb.loaded=0;var Zl=function(b){var c=new XMLHttpRequest;c.open("GET",b,!0);c.responseType="arraybuffer";c.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");c.onload=function(){Qb.loaded++;Qb.button.innerHTML=~~(100*
Qb.loaded/Qb.max+.5)+"%"};c.send("")},va={size:512,load:0,xtra:[],common:1,xtraRes:[]},l,$a=function(b){b.target.loadedSize||($a.total+=b.total,b.target.lastLoaded=0,b.target.loadedSize=!0);$a.progress+=b.loaded-b.target.lastLoaded;b.target.lastLoaded=b.loaded;p("loadingtext").innerHTML=t.loadgraphics+~~(100*$a.progress/$a.total)+"%"};va.check=function(){va.load++;if(va.load===va.images){Di();var b=h.createTexture();h.activeTexture(h.TEXTURE0);h.bindTexture(h.TEXTURE_2D,b);h.texImage2D(h.TEXTURE_2D,
0,h.RGBA32F,512,512,0,h.RGBA,h.FLOAT,va.info);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT);h.uniform1i(h.getUniformLocation(ba,"u_image1"),0);h.activeTexture(h.TEXTURE1);var c=h.createTexture();h.bindTexture(h.TEXTURE_2D_ARRAY,c);h.texParameteri(h.TEXTURE_2D_ARRAY,h.TEXTURE_MAG_FILTER,h.NEAREST);h.texParameteri(h.TEXTURE_2D_ARRAY,
h.TEXTURE_MIN_FILTER,h.NEAREST);var d=performance.now();h.texImage3D(h.TEXTURE_2D_ARRAY,0,h.RGBA,va.size,va.size,va.common.length/(va.size*va.size*4),0,h.RGBA,h.UNSIGNED_BYTE,va.common);C("3dtex",performance.now()-d);h.activeTexture(h.TEXTURE1);h.bindTexture(h.TEXTURE_2D_ARRAY,c);h.uniform1i(h.getUniformLocation(ba,"img_common"),1);h.useProgram(la);h.activeTexture(h.TEXTURE0);h.bindTexture(h.TEXTURE_2D_ARRAY,c);h.uniform1i(h.getUniformLocation(la,"img_common"),0);h.activeTexture(h.TEXTURE5);h.bindTexture(h.TEXTURE_2D,
b);h.uniform1i(h.getUniformLocation(la,"u_image1"),5);v.delTexs();h.activeTexture(h.TEXTURE2);$l();Hb.check()}};var cm=function(b){var c=1048576*(323+Ad[r.terrainType||"grass"].size);va.common=Be(v.crtStxt(c),c);p("loadingtext").innerHTML=t.waitImages;va.images=Object.keys(b).length;va.load=0;$a.progress=0;$a.total=0;Date.now();ra.icons?va.check():Bg(b.icons,function(c){c=new Uint8Array(c.target.response);c=new Blob([c],{type:"image/png"});var b=new Image;b.src=URL.createObjectURL(c);ra.icons=b;va.check()},
$a);Bg(b.common,am,$a);p("terrainSelect")&&(localStorage.terrain=p("terrainSelect").value);r.terrainType=localStorage.terrain;b=Ad[r.terrainType];C(b);va.images++;Bg(y.cdn+b.url,bm,$a)},Ad={grass:{url:"grass.neh2",size:32,id:0},trenkorian:{url:"trenkorian.neh2",size:36,id:1},last:""};(function(){"serviceWorker"in navigator?(console.log("CLIENT: service worker registration in progress."),navigator.serviceWorker.register("/sworker.js").then(function(b){console.log("CLIENT: service worker registration complete.")},
function(b){C(b);console.log("CLIENT: service worker registration failure.")}),navigator.serviceWorker.oncontrollerchange=function(){console.log("page controlled by:",navigator.serviceWorker.controller);location.reload(!0)}):console.log("CLIENT: service worker is not supported.")})();var Cb,Xc,Ce,fc,De,Cg,Bd,Ei,Cd,Fi,Gi,L,Ee,Dd,ab,Dg,Ka,na,se={},Ae="ts1.mp3 ts2.mp3 ts3.mp3 ts4.mp3 ts5.mp3 ts6.mp3 ts7.mp3 ts8.mp3 ts9.mp3 ts10.mp3 sr1.mp3 sr2.mp3 sr3.mp3 sr4.mp3 sr5.mp3 sr6.mp3 sr7.mp3 sr8.mp3 sr9.mp3 sr10.mp3 o1.mp3 o2.mp3 o3.mp3 o4.mp3 o5.mp3 o6.mp3 o7.mp3 o8.mp3 o9.mp3 o10.mp3 INTRO.mp3 OUTRO.mp3 WIN1.mp3 WIN2.mp3 ATTACK.WAV BALLISTA.WAV BLDGDONE.WAV CHAT%20LOCATION.WAV TECHDONE.WAV UNITDONE.WAV CHAT.WAV E_CASTLE1.WAV E_CATHEDRAL1.WAV E_CATHEDRAL2.WAV E_FARM1.WAV E_CHURCH1.WAV E_FARM2.WAV E_HARBOR1.WAV E_LUMBER1.WAV E_MAGETOWER1.WAV E_MAGETOWER2.WAV E_MAGETOWER3.WAV E_MARKET1.WAV E_SHIPYARD1.WAV E_STABLES1.WAV E_STORAGE1.WAV E_OUTPOST1.WAV E_STORAGE2.WAV E_TAVERN1.WAV E_WARACADEMY1.WAV E_WORKSHOP1.WAV EVILCASTLE.WAV GATE1.WAV GATE2.WAV GATE3.WAV GATE4.WAV GATE5.WAV GATE6.WAV GATEWAY.WAV HOUSE1.WAV HOUSE2.WAV HOUSE3.WAV HOUSE4.WAV HOUSE5.WAV MERCHANT.WAV MINE1.WAV MONASTERY1.WAV MONASTERY2.WAV R_CATHEDRAL1.WAV R_CHURCH1.WAV SHAOLIN2.WAV SHAOLIN.WAV CHOP%201.WAV CHOP%202.WAV CHOP%203.WAV CHOP%204.WAV CHOP%205.WAV CHOP%206.WAV CHOP%207.WAV CHOP%208.WAV CHOP%209.WAV CHOP%2010.WAV CHOP%2011.WAV DIG%201.WAV DIG%202.WAV DIG%203.WAV MINE%201.WAV MINE%202.WAV MINE%203.WAV HIT%201.WAV HIT%202.WAV HIT%203.WAV HIT%204.WAV HIT%205.WAV HIT%206.WAV HIT%207.WAV GHOST1.WAV GHOST2.WAV GOLEM1.WAV GOLEM2.WAV H%20SWORD%201.WAV H%20SWORD%202.WAV H%20SWORD%203.WAV H%20SWORD%204.WAV H%20SWORD%205.WAV H%20SWORD%206.WAV H%20SWORD%207.WAV H%20SWORD%207.WAV H%20SWORD%208.WAV H%20SWORD%209.WAV H%20SWORD%2010.WAV H%20SWORD%2011.WAV H%20SWORD%2012.WAV HAND1.WAV HAND2.WAV HAND3.WAV HAND4.WAV MAGE%20ATTACK.WAV MESSIAH.WAV ORC%20SWORD%201.WAV ORC%20SWORD%202.WAV ORC%20SWORD%203.WAV ORC%20SWORD%204.WAV ORC%20SWORD%205.WAV ORC%20SWORD%206.WAV ORC%20SWORD%20V1.WAV ORC%20SWORD%20V2.WAV ORC%20SWORD%20V3.WAV SHIP%20CANNON%201.WAV SHIP%20CANNON%202.WAV SHIP%20CANNON%203.WAV SHIP%20CANNON%204.WAV SHIP%20CANNON%205.WAV SHIP%20CANNON%206.WAV SHIP%20CANNON%207.WAV SIEGE.WAV SWORD%201.WAV SWORD%202.WAV SWORD%203.WAV SWORD%204.WAV SWORD%205.WAV SWORD%206.WAV SWORD%207.WAV SWORD%208.WAV SWORD%209.WAV SWORD%2010.WAV SWORD%2011.WAV SWORD%2012.WAV SWORD%2013.WAV SWORD%2014.WAV SWORD%2015.WAV SWORD%2016.WAV V%20SWORD%201.WAV V%20SWORD%202.WAV V%20SWORD%203.WAV V%20SWORD%204.WAV V%20SWORD%205.WAV V%20SWORD%206.WAV V%20SWORD%207.WAV ADRAGON2.WAV ADRAGON3.WAV ARROW%201.WAV ARROW%202.WAV ARROW%203.WAV ARROW%204.WAV ARROW%205.WAV ARROW%206.WAV ARROW%20V1.WAV ARROW%20V2.WAV ARROW%20V3.WAV ARROW%20V4.WAV BEAR1.WAV BEAR2.WAV BEAR3.WAV BEAR4.WAV BEAR5.WAV MWORKSHOP.WAV DESTROY%20BUILDING.WAV DESTROY%20MINE.WAV LIGHTING2.WAV LIGHTING.WAV METEOR.WAV SMALL%20EXPLOSION.WAV WATER%20BLOP.WAV SPY%20KILL%201.WAV SPY%20KILL%203.WAV SPY%20KILL%202.WAV PRIEST%20ATTACK.WAV LIGHTNING.WAV INVISIBLE.WAV HEAL.WAV FREEZE.WAV FLAME%20BALL.WAV CURSE.WAV CRUSADE.WAV CONFUSION.WAV BLESS.WAV WHIRLPOOL.WAV TURN%20TO%20STONE.WAV TEACH.WAV SUMMON10.WAV SUMMON9.WAV SUMMON8.WAV SUMMON7.WAV SUMMON6.WAV SUMMON5.WAV SUMMON4.WAV SUMMON3.WAV SUMMON2.WAV SUMMON1.WAV REVEAL.WAV RESSURECT.WAV COWDIE1.WAV COWDIE2.WAV COWDIE1.WAV COWDIE3.WAV COWDIE4.WAV DIE%201.WAV DIE%202.WAV DIE%203.WAV DIE%204.WAV DIE%205.WAV DIE%206.WAV DIE%207.WAV DIE%208.WAV DIE%209.WAV DIE%2010.WAV DRAGON%20DIE%201.WAV DRAGON%20DIE%202.WAV GHOST1.WAV GHOST2.WAV GOLEM.WAV H%20DIE%201.WAV H%20DIE%202.WAV H%20DIE%203.WAV H%20DIE%204.WAV H%20DIE%205.WAV H%20DIE%206.WAV H%20DIE%207.WAV H%20DIE%208.WAV H%20DIE%209.WAV H%20DIE%2010.WAV MAGE.WAV ORC%20DIE%201.WAV ORC%20DIE%202.WAV SHIP%20SINK.WAV SIEGE%20DIE%201.WAV SIEGE%20DIE%202.WAV SIEGE%20DIE%203.WAV SIEGE%20DIE%204.WAV SKELETON%20DIE%201.WAV SKELETON%20DIE%202.WAV SKELETON%20DIE%203.WAV SKELETON%20DIE%204.WAV MESSIAH_ATTACK.WAV C%20DIE%201.WAV C%20DIE%202.WAV C%20DIE%203.WAV C%20DIE%204.WAV C%20DIE%205.WAV CAMELDIE1.WAV CAMELDIE2.WAV CAMELDIE3.WAV BAT%20ATTACK.WAV BAT%20CMD.WAV BAT%20DIE.WAV".split(" "),
Hi,td,ud,Eg=function(){if(!Cb){x.prototype.loadBuffer=function(c,b){var k=new XMLHttpRequest;k.open("GET",e+c,!0);k.responseType="arraybuffer";k.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");var d=this;k.onreadystatechange=function(){4===k.readyState&&200===k.status&&d.context.decodeAudioData(k.response).then(function(k){k&&M(k,c,b)})};k.send()};for(var b=0,c=Ae.length;b<c;b++){var d=Ae[b];se[d.split(".")[0].toLowerCase()]=d}C("");Xc="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206 arrow%20v1 arrow%20v2 arrow%20v3 arrow%20v4".split(" ");
Ce="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206".split(" ");fc="sword%201 sword%202 sword%203 sword%204 sword%205 sword%206 sword%207 sword%208 sword%209 sword%2010 sword%2011 sword%2012 sword%2013 sword%2014 sword%2015 sword%2016 v%20sword%201 v%20sword%202 v%20sword%203 v%20sword%204 v%20sword%205 v%20sword%206 v%20sword%207".split(" ");De=["siege"];Cg=["hand1","hand2","hand3","hand4"];Bd="h%20sword%201 h%20sword%202 h%20sword%203 h%20sword%204 h%20sword%205 h%20sword%206 h%20sword%207 h%20sword%208 h%20sword%209 h%20sword%2010 h%20sword%2011 h%20sword%2012".split(" ");
Ei=["ork%20sword%20v1","ork%20sword%20v2","ork%20sword%20v3"];Cd="ship%20cannon%201 ship%20cannon%202 ship%20cannon%203 ship%20cannon%204 ship%20cannon%205 ship%20cannon%206 ship%20cannon%207".split(" ");Fi=["ghost%201","ghost%202"];Gi=["mage%20attack"];L=["destroy%20building"];Ee=["siege%20die%201","siege%20die%202","siege%20die%203","siege%20die%204"];Dd="h%20die%201 h%20die%202 h%20die%203 h%20die%204 h%20die%205 h%20die%206 h%20die%207 h%20die%208 h%20die%209 h%20die%2010".split(" ");ab="die%201 die%202 die%203 die%204 die%205 die%206 die%207 die%208 die%209 die%2010".split(" ");
Dg=["e_barrack1"];var e=y.cdn;"undefined"!==typeof AudioContext&&(window.AudioContext=window.AudioContext||window.webkitAudioContext,Cb=new AudioContext,td=Cb.createGain(),ud=Cb.createGain(),Hi=new x(Cb,void 0,M),C("Sound: OK"),td.gain.value=parseInt(localStorage.musicRange)/100,ud.gain.value=parseInt(localStorage.soundRange)/100);Ka=function(){if(!r.editor){Ka.id++;p("musicSelect")&&(localStorage.favMusic=p("musicSelect").mversion.value);var c=Ka.list[localStorage.favMusic];c&&na(c[~~(c.length*Math.random())],
0,0,void 0,1,0,Ka.id)}};Ka.reset=function(){Ka.stop();Ka()};Ka.stop=function(){Ka.active&&(Ka.active.stop(),clearTimeout(Ka.intv))};Ka.id=0;Ka.list={originalMusic1:"o1 o2 o3 o4 o5 o6 o7 o8 o9 o10 outro".split(" "),originalMusic:"ts1 ts2 ts3 ts4 ts5 ts6 ts7 ts8 ts9 ts10".split(" "),sharpRain:"sr1 sr2 sr3 sr4 sr5 sr6 sr7 sr8 sr9 sr10".split(" ")};na=function(c,b,k,d,e,l,h){"string"!==typeof c&&(c=Ae[c].split(".")[0].toLowerCase());var f=c;if((c=se[c])&&"loading"!==c&&!r.canceled){var g=-Ta+(window.innerWidth-
y.mx)/2,m=-ya+window.innerHeight/2;if(c.duration){if(r.started)if(64<r.now()-c.lastPlayed||!c.lastPlayed)c.lastPlayed=r.now();else return;if(!(!e&&"attack"!=f&&l&&600<Date.now()-l)){if(b){b=-g+32*b;k=-m+32*k;m=R;if(b*b+k*k>Math.pow(2E3,2))return!1;b/=80;k/=80;m/=8}else m=k=b=0;void 0!==d&&d!==y.kingdom||r.mute||(d=Cb.createBufferSource(),d.buffer=c,e?(d.connect(td),td.connect(Cb.destination),Ka.active=d,Ka.intv=setTimeout(Ka,~~(1E3*c.duration)+1E3)):(c=Cb.createPanner(),c.panningModel="HRTF",c.setPosition(b,
k,m),d.connect(c),c.connect(ud),ud.connect(Cb.destination)),d.start(0))}}else se[f]="loading",e={x:b,y:k,k:d,music:e,date:Date.now(),mid:h},Hi.loadBuffer(c,e)}}}},Ed=function(b,c,d,e){b.img===e.url&&(na(c+~~(Math.random()*d+1),b.x32,b.y32),setTimeout(Ed,Xa(e),b,c,d,e))};"use strict";var dm=function(b){for(var c=[],k=0,e=[b.icons],f=0,g=e.length;f<g;f++)for(var m=e[f],q=0,w=m.length;q<w;q++)if(m[q]){var l=m[q];l.doneBy||(l.doneBy=[]);l.doneBy.put(b);c[k++]=l;l.xtra&&(e.put(l.xtra),g++)}b.habilities=
c},em=function(b,c){return c.balanceTotal-b.balanceTotal},Fg=function(b,c){var k=b.slice(0),e={};e[c]=Infinity;for(var f=k.length,g=0;g<f;g++){var m=e;for(var q=0;q<f;q++)if(k[q]&&k[q][c]<m[c]){m=k[q];var w=q}m==e&&(m=void 0);b[g]=m;k[w]=e}return b},Fe=function(b,c){if(!b.url.attack||b.attackOnly&&!b.attackOnly[c.type])return 0;var k=25*~~(Xa(b.url.attack)/25);b=b.attack*((Fd[b.type][c.type]||0)+1);b-=c.defence;1>b&&(b=1);return~~(c.health/b)*k},rb=function(b){this.kingdom=b.k;this.aggressive=this.perfection=
1;this.cantBuild={};this.houseLoading=0;this.mineGroup={};b.IAD=rb.arr.length;rb.arr.put(this)};rb.prototype.valorateLost=function(b){this.script&&this.script.put({order:b.nu,obj:b,priority:1})};var Gg=function(b,c,d,e,f){var k=d.obj.cost;e[0]+=k[0];e[1]+=k[1];e[2]+=k[2];e[3]+=k[3];b[b.length]={order:d,priority:c.priority,name:d.obj.name,obj:d.obj,pTime:c.obj.time,required:1,doner:f};b.changed=!0},Hg=function(b,c,d,e){var k=[b],g=[],m={},q=e.target;g.put(b);for(var w=0;w<k.length;w++){var l=k[w];
l.availables&&(l.availables=void 0);if((b=l.order)&&!m[l.order.id]){m[l.order.id]=1;var h=b.requireObj;if(h)for(var n=0,p=h.length;n<p;n++)if(b=h[n],b.tech)c[b.nu.id]||Gg(k,l,b.nu,q);else{var t=d[b.type];t.length||Gg(k,l,b.nu,q)}if(h=b.doneBy)for(n=0,p=h.length;n<p;n++)b=h[n],t=d[b.type],t.length||b.race!=e.racestr||Gg(k,l,b.nu,q,1);w&&!l.doner&&g.put(l)}}return g},Ig={food:2,wood:1,gold:0,stone:3},hc=function(b,c){b=b.order;var k=b.obj,e=hc.tech;k.build?e=hc.build:k.tech||(e=hc.unit);return e(b,
c)};hc.unit=function(b,c){b=b.doneBy;if(c.pop<c.popMax)for(var k=0,e=b.length;k<e;k++)for(var f=c[b[k].type],g=0,m=f.length;g<m;g++){var q=f[g];if(q.free)return[q]}return!1};hc.tech=function(b,c){b=b.doneBy;for(var k=0,e=b.length;k<e;k++)for(var f=c[b[k].type],g=0,m=f.length;g<m;g++){var q=f[g];if(q.free)return[q]}return!1};hc.build=function(b,c,d){b=b.doneBy;d=0;for(var k=b.length;d<k;d++)for(var f=c[b[d].type],g=0,m=f.length;g<m;g++){var q=f[g];if(q.free)return[q]}return!1};hc.sPeasant=function(b){for(var c=
[10,79,64],k=[],e=0,f=0,g=c.length;f<g;f++)for(var m=b[c[f]],q=0,w=m.length;q<w;q++)m[q].free&&(k[e++]=m[q]);return k};var Yb=function(b,c,d){if(b){b=b.order;var k=b.obj,f=Yb.unit;k.tech?f=Yb.tech:k.build&&(f=Yb.build);return f(b,c,d)}};Yb.build=function(b,c,d){var k=rb.arr[c.IAD];if(4<=k.cantBuild[b.obj.type]&&c.stats.buildsLosed==k.buildsLosed)return!1;for(var f=[],g=b.doneBy,m=sa[c.k],q=0,w=g.length;q<w;q++)for(var l=m[g[q].type],h=0,n=l.length;h<n;h++){var p=B[l[h]];if(!p.func&&!p.in||d){f.put(p.id);
break}}if(!f.length)return!1;d=H;p=b.obj;b=c.origin[0];f=c.origin[1];g=f-1;m=b-1;q=rb.arr[c.IAD].reserved;if(w=q.added[p.type]){h=p.space;l=p.rbase();var t=w%d,r=~~(w/d),v=h[h.length-1];n=(h.length-1)/v*v;for(h=0;h<n&&!l(t+h%v+(~~(h/v)+r)*d);h++);if(h==n)for(q.added[p.type]=!1,h=0;h<n;h++)q[t+h%v+(~~(h/v)+r)*d]=0;else w=-1}else w=-1;0>w&&(w=Ge(b,f,80,g,m,c,p,900));if(0>w)return k.cantBuild[p.type]||(k.cantBuild[p.type]=0),k.cantBuild[p.type]++,k.buildsLosed=c.stats.buildsLosed,!1;k.cantBuild[p.type]&&
(k.cantBuild[p.type]=0);C(999999999,44444);return!0};var Ge=function(b,c,d,e,f,g,m,q){var k=rb.arr[g.IAD].reserved,l=H,h=m.space;m=m.validator.check;if(!m)return-1;for(var n=-1,p=d/2*(d/2),t=1,r=b,v=c;0>n&&b-r<d/2;){--r;--v;for(var x=2*t+1,B=2*t+1,A=0,y=x*B;A<y;A++){var C=A%x,D=~~(A/x);if(!C||!D||C==x-1||D==B-1){C+=r;D+=v;var F=(C-b)*(C-b)+(D-c)*(D-c);if(F<p&&m(C,D,h,e,f,F<q,g.k,k)){n=C+D*l;break}}}t++}return n};Yb.tech=function(b,c,d){b=b.doneBy;c=sa[c.k];d=[];for(var k=0,f=b.length;k<f;k++)for(var g=
c[b[k].type],m=0,q=g.length;m<q;m++){var w=B[g[m]];w.working||w.techStart||!w.built||d.put(w.id)}if(!d.length)return!1;C(999999999,44444);return!0};Yb.unit=function(b,c,d){b=b.doneBy;c=sa[c.k];d=[];for(var k=0,f=b.length;k<f;k++)for(var g=c[b[k].type],m=0,q=g.length;m<q;m++){var w=B[g[m]];w.working||w.techStart||!1===w.built||d.put(w.id)}if(!d.length)return!1;C(999999999,44444);return!0};rb.prototype.leaveMeAloneIKnowWhatToDo=function(){performance.now();var b=J[this.kingdom],c=b.resources,d=sa[this.kingdom],
e=H;if(b.origin){var f=b.origin[0],g=b.origin[1],m=b.race+"-"+c[0]+""+c[1]+""+c[2]+""+c[3];if(rb.precooked[m])pa=rb.precooked[m].slice(0);else{for(var q=g-1,w=f-1,l=f-40,h=g-40,n=0,p=-1,t=6400,v=0;v<t;v++){var x=v%80+l,y=~~(v/80)+h;1600>(f-x)*(f-x)+(g-y)*(g-y)&&(!(x>=w&&x<=w+2)||y>=q&&y<=q+2)&&0===Z[x+y*e]&&fa(x,y)&&n++}var D=[];performance.now();for(var G=0,K=0,L=A.length;K<L;K++){var I=A[K];if(!I.build&&!I.item&&!I.boat&&I.url.attack&&I.race==b.racestr&&8!=I.type&&void 0==I.res){D.put(I);I.balanceSum=
0;I.bestBalance=-1;I.balanceDefence={};for(var S=Infinity,P=I.attDist,T=0;T<L;T++){var M=A[T];if(!M.build&&!M.item&&!M.boat&&M.race==b.racestr&&M.url.attack&&8!=M.type&&void 0==I.res&&(G=Fe(M,I))){var V=Fe(I,M);V&&(G-=V,G+=2E3*P,G<S&&(S=G,I.bestBalance=M),I.balanceSum+=G)}}I.balanceTotal=I.balanceSum}}D.sort(em);I=D[0];for(var U=1E3,X={},R=[],aa=0,ca=U;!X[I.type];)X[I.type]=1,R[aa++]=I,R[aa++]=U,M=I.bestBalance,U=~~(U*Fe(M,I)/Fe(I,M)+.5),ca+=U,I=M;R.nu=ca-U;C(R);for(var ia=b.target,Q=F,ja=Q.length,
ba=[],ha=0;ha<ja;ha++){var da=Q[ha],la;if(!(la=!da.type||da.upgrade||da.type==W||void 0!==Ig[da.value]&&b.resources[da.value]>=ia[da.value])){a:{for(var na=da.nu.doneBy,oa=0,ra=na.length;oa<ra;oa++)if(na[oa].race==b.racestr){var qa=!0;break a}qa=!1}la=!qa}la||ba.put({order:da.nu,obj:da,original:1,priority:1E-10})}var ka=[];v=0;t=R.length;for(var wa=R.nu;v<t;v+=2){var ua=~~(.5+R[v+1]/wa*250)-d[R[v].type].length,Y=R[v],va=Y.type;Y=Y.nu;for(var ea=0;ea<ua;ea++)ba.put({order:Y,priority:1-ea/ua,obj:Y.obj,
original:1})}var Ca=0,Ia=0,za=b.target,Aa={};Ia++;za[0]=0;za[1]=0;za[2]=0;za[3]=0;v=Ca=ka.length=0;for(t=ba.length;v<t;v++){var Ka=ba[v].priority,Fa=Hg(ba[v],b.technology.investigated,d,b);ea=0;for(var Da=Fa.length;ea<Da;ea++){Y=Fa[ea];Y.original||(Y.priority=Ka);var Ha=1;void 0!==Y.priority&&(Ha=Y.priority);var Ja=Y.obj;Ja.increase&&void 0!==Ig[Ja.value]&&(Ha=Ja.increase*Ha/c[Ig[Ja.value]]);Ha/=Ja.time;Y.priority=Ha;if(!(0>=Y.priority)){var Ma=Y.order.id;!Aa[Ma]||Y.original?(Aa[Ma]=Ca,ka[Ca++]=Y):
ka[Aa[Ma]].priority+=Y.priority}}}var Oa=!1;Fg(ka,"priority");var Ra={},Ta={},ya={},pa=[],Za=A.length;for(v=0;v<Za;ya[v++]=0);for(v=0;v<ka.length;v++){var Ea=ka[v];Y=Ea.order;var Ba=Ea.obj;if(Ea.original||Ea.required)Ea.obj.tech||ya[Ea.obj.type]++,pa.put(Ea);var ab=Y.doneBy,Xa=Ba.time;ea=0;for(t=ab.length;ea<t;ea++){var ta=ab[ea],lb=ta.time;if(ta.race===b.racestr){if(Ba){for(var pb=ta,fb=d[ta.type],gb=rb.process,ub=Xa,zb=fb.length,Wa=!1,hb=Infinity,ib=0;ib<zb;ib++){var Qa=B[fb[ib]],Na=0;Qa.build&&
(Qa.working||Qa.techStart||!Qa.built)&&(Qa.built?(Na=(Qa.c-r.cycle)*zc.speed,Na/=1E3):(Na=Qa.time*(Qa.maxHealth-Qa.health)/Qa.maxHealth,Qa.workers&&Qa.workers.length&&(Na/=Qa.workers.length)));Qa.build||!Qa.func&&!Qa.in||(Na=Infinity);Qa.nato!=gb?(Qa.nato=gb,Qa.natoTime=0):Na+=Qa.natoTime;Na<hb&&(hb=Na,Wa=Qa)}Wa&&hb<=pb.time?(Wa.natoTime+=ub,Oa=Wa):Oa=!1}if(!Oa){Ra[ta.type]||(Ra[ta.type]=[],Ta[ta.type]=[]);var Ua=Ra[ta.type],nb=Ta[ta.type];ya[ta.type]||(ya[ta.type]=0);var vb=!1,La=0;for(Da=Ua.length+
1;La<Da;La++){if(void 0==Ua[La]){var tb={order:ta.nu,priority:0,obj:ta};ka.put(tb);pa.put(tb);Ua[La]=0;nb[La]=tb;ya[ta.type]++;vb=!0}if(Ua[La]+Xa<=lb||vb){Ua[La]+=Xa;nb[La].priority+=Ea.priority;break}}}}}}Fg(pa,"priority");var ob=0;v=0;for(t=pa.length;v<t;v++)if(Ea=pa[v].obj,Ea.build){var Va=Ea.space[Ea.space.length-1]+2,Ab=(Ea.space.length-1)/Va+2;ob+=Va*Ab}C(ob,n);if(ob>n){var Gb=n/ob*.7;v=0;for(t=A.length;v<t;v++)A[v].build&&(Ea=ya[v])&&((Ea=~~(Ea*Gb))||(Ea=1),ya[v]=Ea)}v=0;for(t=pa.length;v<
t;v++)Ea=pa[v].obj,Ea.build&&(ya[Ea.type]?ya[Ea.type]--:pa[v]=0);for(var Pa=pa,$a=new Uint32Array(14),bb=new Uint32Array(7),db=new Uint32Array(7),eb=new Uint32Array(7),Fb=6.25,wb=b.resources,Hb=[bb,eb,$a,db],ma=0,Sa=0,Db=0;3>Db;Db++){var sb=wb[0],qb=wb[1],xb=wb[2],yb=wb[3];Infinity==sb&&Infinity==qb&&Infinity==xb&&Infinity==yb&&(Fb=-1);var Lb=0,Mb=0,Nb=0,Pb=0;ma=0;for(Sa=Pa.length;ma<Sa;ma++)if(Pa[ma]){var Bb=Pa[ma].obj.cost;Lb+=Bb[0];Mb+=Bb[1];Nb+=Bb[2];Pb+=Bb[3]}if(Db){for(ma=0;ma<$a.length;$a[ma++]=
0);for(ma=0;ma<bb.length;bb[ma++]=0);for(ma=0;ma<db.length;db[ma++]=0);for(ma=0;ma<eb.length;eb[ma++]=0);}var Cb=[],Sb={},Ub={},cb={pop:0,popMax:2E3},Eb=[[]];ma=0;for(Sa=d.length;ma<Sa;ma++){Ga=d[ma];var Wb=[];cb[ma]=Wb;for(var mb=0,Kb=Ga.length;mb<Kb;mb++)Wb[mb]={free:1,type:ma}}for(var Ya=0;9E3>Ya;){var cc=10*He(bb)/7,dc=10*He(eb)/7,Xb=10*He($a)/14,ec=10*He(db)/7;sb+=10*bb[Ya%bb.length];qb+=10*eb[Ya%eb.length];xb+=10*$a[Ya%$a.length];yb+=10*db[Ya%db.length];var Qb=Eb[Ya];if(Qb)for(ma=0,Sa=Qb.length;ma<
Sa;ma++){var Zb=Qb[ma],ic=Zb.list;mb=0;for(Kb=ic.length;mb<Kb;mb++){var Ga=ic[mb];Ga.used||(Ga.used=!0,Cb.put(Ga.action));Ga.free=1}var fc=Zb.action&&(Zb.action.original||Zb.action.required)?!0:!1;if(Zb.obj.tech){Sb[Zb.obj.nu.id]=1;var Yb=Zb.obj;"popLimit"==Yb.value&&(cb.popMax+=Yb.increase)}else Zb.obj.build||cb.pop++,cb[Zb.obj.type].put({free:1,type:Zb.obj.type,action:Zb.action,used:fc})}ma=0;for(Sa=Pa.length;ma<Sa;ma++)if(Ga=Pa[ma]){var $b=Ga.obj;if($b.peon||!(Xb<Fb)){var jb=$b.cost;if(!(jb[0]>
sb||jb[1]>qb||jb[2]>xb||jb[3]>yb)&&1===Hg(Ga,Sb,cb,b).length&&(ic=hc(Ga,cb))){var Rb=Ga.obj.time+Ya;Eb[Rb]||(Eb[Rb]=[]);if(Ga.obj.tech){if(Ub[Ga.order.id])continue;Ub[Ga.order.id]=1}Pa[ma]=void 0;(Ga.original||Ga.required)&&Cb.put(Ga);for(var ac=0;ac<ic.length;ic[ac++].free=0);Eb[Rb].put({list:ic,obj:Ga.obj,action:Ga});sb-=jb[0];qb-=jb[1];xb-=jb[2];yb-=jb[3]}}}ic=hc.sPeasant(cb);ma=0;for(Sa=ic.length;ma<Sa;ma++){var Ib=Ii(cc,dc,Xb,ec,sb,qb,xb,yb,Lb,Mb,Nb,Pb);if(0>Ib)break;2===Ib&&(qb-=200);Hb[Ib][Ya%
Hb[Ib].length]++;Ga=ic[ma];Ga.free=0;Ga.used||(Ga.used=!0,Cb.put(Ga.action))}Ya++}Pa=Cb;Fg(Pa,"priority")}for(var kb=pa=Pa,Jb={},jc=0;jc<kb.length;jc++)kb[jc]&&!kb[jc].obj.tech&&(Jb[kb[jc].obj.name]||(Jb[kb[jc].obj.name]=0),Jb[kb[jc].obj.name]++,"Blacksmith"==kb[jc].obj.name&&C(kb[jc]));C(Jb);rb.precooked[m]=pa}this.script=pa;var Tb={},bc={added:Tb};this.reserved=bc;v=0;for(t=pa.length;v<t;v++)if((Y=pa[v])&&(Ba=Y.obj)&&Ba.build&&void 0==Tb[Ba.type]&&(p=Ge(f,g,80,q,w,b,Ba,900),-1<p)){x=p%e;y=~~(p/
e);va=Ba.type;Tb[Ba.type]=p;var Vb=Ba.space;Va=Vb[Vb.length-1];Ab=(Vb.length-1)/Va;var gc=Va*Ab;for(ea=0;ea<gc;ea++)bc[x+ea%Va+(~~(ea/Va)+y)*e]=va}}};var He=function(b){for(var c=0,k=b.length,e=0;e<k;c+=b[e++]);return c},Ii=function(b,c,d,e,f,g,m,q,w,l,h,n){if(Infinity==f&&Infinity==g&&Infinity==m&&Infinity==q)return-1;if(6.25>d)return 200>g?1:2;f=w+n+h+l;g=b+c+d+e;b/=w/f*g;c/=l/f*g;d/=h/f*g;e/=n/f*g;return b<c&&b<d&&b<e?0:c<d&&c<e?1:d<e?2:3},Ji=function(){for(var b=0,c=rb.arr,d=c.length;b<d;c[b++].maintenance());
Ha({func:Ji},rb.time,1);rb.process++},Ki=function(b,c,d){for(var k=b.length,f=Infinity,g=0,m=0;m<k;m++){var q=B[b[m]],w=Math.pow(c-q.x32,2)+Math.pow(d-q.y32,2);w<f&&(f=w,g=q.id)}return g};rb.prototype.maintenance=function(){var k=this.script;if(k){var c=J[this.kingdom];if(c.origin){r.blocked=!0;var d=c.technology.investigated,e=sa[c.k],f=H,g={};if(c.values.pop+c.unitLoading+5>c.values.popMax&&c.values.popMax<=c.values.popLimit){for(var m=ta[c.race].house.nu,q=0,w=0,l=c.building,h=l.length;w<h;w++){var n=
B[l[w]];n.population&&(q+=n.population)}c.values.pop+c.unitLoading+5>c.values.popMax+q&&Yb({order:m,priority:1,obj:m.obj},c,!0)}l=c.resources;m=l[0];q=l[1];var p=l[2],t=l[3],v=[];if(Infinity!=m||Infinity!=q||Infinity!=p||Infinity!=t){n=0==c.race?b.createPeon.obj:1==c.race?b.createPeon2.obj:b.createPeon1.obj;var x=0,y=0,F=0,G=0;w=0;for(h=k.length;w<h;w++)if(k[w]){var I=k[w].obj.cost;x+=I[0];y+=I[1];F+=I[2];G+=I[3]}var K=I=0,L=0,S=0,M=e[n.type];w=0;for(h=M.length;w<h;w++)if(n=B[M[w]],40==n.func)21==
B[n.funcObj.u].type?I+=10/7:S+=10/7;else if(43==n.func)L+=10/14;else if(42==n.func)K+=10/7;else{if(19==n.func&&n.stock){var P=n.stock[1];0==P?I+=10/7:1==P?K+=10/7:2==P?L+=10/14:S+=10/7}(19!=n.func||n.action)&&n.func||v.put(n)}}w=0;for(h=k.length;w<h;w++)!(n=k[w])||!n.order||g[n.order.id]||6.25>L&&!n.obj.peon||(M=Hg(n,d,e,c).length,P=n.obj.cost,P[0]>l[0]||P[1]>l[1]||P[2]>l[2]||P[3]>l[3]||1===M&&(Yb(n,c)?k[w]=0:g[n.order.id]=1));if(v.length)for(k=-Infinity,w=0,l=c.building,h=l.length;w<h;w++){n=B[l[w]];
if(n.population)break;n=n.time*(1-n.health/n.maxHealth);n>k&&(k=n)}w=0;for(h=v.length;w<h;w++)if(n=v[w],l=Ii(I,K,L,S,m,q,p,t,x,y,F,G),0==l)(l=Ki(sa[0][21],n.x32,n.y32))&&Li(l,n,this,c);else if(1==l)Mi(n);else if(2==l){a:{n=e[20];l=n.length;for(k=0;k<l;k++)if(d=B[n[k]],!d.workers.length&&14E3<25*(r.cycle-d.lastUse)){d.lastUse=r.cycle+100;n=d;break a}n=void 0}if(n)C(999999999,44444);else{g=sa[c.k];n=H;M=bb[2];l=[];l.length=M.length;k=0;for(d=M.length;k<d;l[k]=g[M[k++]]);g=Infinity;M=A[20].space;P=-1;
k=0;for(d=l.length;k<d;k++)for(var T=l[k],U=0,V=T.length;U<V;U++){var R=B[T[U]],X=R.x32-10,Z=R.y32-10,W=R.space[R.space.length-1],aa=R.x32+.5*W;R=R.y32+.5*(R.space.length-1)/W;for(W=0;400>W;W++){var Y=W%20,ca=~~(W/20);Y+=X;ca+=Z;var da=(Y+1-aa)*(Y+1-aa)+(ca+1-R)*(ca+1-R);da<g&&Jg(Y,ca,M)[1]&&(P=Y+ca*n,g=da)}}-1<P&&(C(999999999,44444),q-=200)}}else 3==l&&(l=Ki(sa[0][22],n.x32,n.y32))&&Li(l,n,this,c);e=!1;F=Infinity;K=c.diplomacy;x=c.origin[0];y=c.origin[1];c=sa[c.k];w=1;for(h=J.length;w<h;w++)K[w]&&
!J[w].death&&J[w].origin&&(n=J[w],G=n.origin[0]-x,I=n.origin[1]-y,G=G*G+I*I,G<F&&(F=G,e=n));if(e){G=[];w=I=0;for(h=c.length;w<h;w++)for(K=c[w],F=0,L=K.length;F<L;F++)n=B[K[F]],void 0!=n.func||n.standardFunc!=D||n.death||n.build||(G[I++]=n.id);if(60<G.length){c=e.origin[0];K=e.origin[1];l=[40,0,-40,0,0,40,0,-40];F=Infinity;w=0;for(h=l.length;w<h;w+=2)if(G=l[w],I=l[w+1],G+=x+10*Math.sign(G),I+=y+10*Math.sign(I),(G-c)*(G-c)+(K-I)*(K-I)<F&&fa(G,I)){F=(G-c)*(G-c)+(K-I)*(K-I);var ba=G+I*f}h=ba%f;ba=~~(ba/
f);x=-1;y=Infinity;c=sa[e.k];w=0;for(length=c.length;w<length;w++)for(e=c[w],F=0,G=e.length;F<G;F++)n=B[e[F]],I=(n.x32-h)*(n.x32-h)+(n.y32-ba)*(n.y32-ba),I<y&&(y=I,x=n.x32+n.y32*f);-1<x&&C(999999999,44444)}}r.blocked=!1}}};var Li=function(b,c,d,e){c=ta[c.race].storage;var k=B[b];!B[d.mineGroup[b]]&&e.paypalTest(c.cost)?(-1<Ge(k.x32+2,k.y32+2,20,0,0,e,c,0)&&C(999999999,44444),d.mineGroup[b]=e.building[e.building.length-1]):C(999999999,44444)},Mi=function(b){for(var c=J[b.kingdom],k=sa[c.k],e=bb[1],
f=0,g=e.length;f<g;f++)for(var m=k[e[f]],q=0,w=m.length;q<w;q++){var l=B[m[q]];if(!l.castle){if(!1===l.built){C(999999999,44444);return}if(Ni(l.x32,l.y32,.075)){C(999999999,44444);return}}}m=c.building;f=0;for(g=m.length;f<g;f++)if(l=B[m[f]],1===l.storage){C(999999999,44444);return}k=ta[b.race].lumbermill;e=c.origin[0];m=c.origin[1];f=1;g=c.resources;q=k.cost;if(q[0]<g[0]&&q[1]<g[1]&&q[2]<g[2]&&q[3]<g[3])for(;80>f;){--e;--m;w=2*f+1;l=2*f+1;q=0;for(g=w*l;q<g;q++){var h=q%w,n=~~(q/w);if(!h||!n||h==
w-1||n==l-1)if(h+=e,n+=m,-1<Ni(h,n,.15,!0)&&-1<Ge(h,n,8,0,0,c,k,0)){C(999999999,44444);return}}f++}c=sa[0][7];f=c.length;g=Infinity;for(k=q=0;k<f;k++)e=B[c[k]],m=Math.pow(b.x32-e.x32,2)+Math.pow(b.y32-e.y32,2),m<g&&(g=m,q=e.id);q&&C(999999999,44444)},Ni=function(b,c,d,e){var k=H,g=b,m=c;b-=5;c-=5;for(var q=0,w=-1,l=Infinity,h=0;100>h;h++){var n=h%10,p=~~(h/10);n+=b;p+=c;if(fa(n,p)){var t=B[Z[n+p*k]];if(e&&1==t.storage)return-1;7===t.type&&(q++,n=Math.pow(n-g,2)+Math.pow(p-m,2),n<l&&(l=n,w=t.id))}}if(q/
100>=d)return w},Pi=function(b,c){var k=H,e=b[0];b=b[1];var f=b%k;k=~~(b/k);for(var g=0,m=c.length;g<m;g++){var q=B[c[g]];6400<(q.x32-f)*(q.x32-f)+(q.y32-k)*(q.y32-k)?ha(-e,q,Gd,q.url.move):ha(-b,q,Gd,q.url.move)}Kg(!1,c);Ha({func:Oi,data:{list:c,xy:-b}},3E4,1)},Oi=function(b){var c=b.list;b=b.xy;for(var k=0,e=c.length;k<e;k++){var f=B[c[k]];f.death||ha(b,f,Gd,f.url.move)}},Qi=function(b){var c=b.x32+b.y32*H,k=J[b.kingdom].diplomacy;!b.invisible&&tc[c]&&(c=B[tc[c]],!c.freezed&&k[c.kingdom]&&$b(b.id,
[c.id],0,Yc))},Qc=function(b){var c=Lg(b.id);return c?($b(c,[b.id],0,Yc),!0):!1},Lg=function(b,c){b=B[b];return v.radar(b.x32,b.y32,b.sight,b.id)},fm=function(b){b.setupINTV(Ri,0,1E3)},Ri=function(b){var c=b.free;c||(c=Si);var k=H,e=b.x32,f=b.y32,g=[];g.length=J.length;for(var m=g.length,q=0;q<m;g[q++]=0);q=0;for(var w=c.length;q<w;q+=2){var l=c[q]+e,h=c[q+1]+f;fa(l,h)&&(l=B[Z[l+h*k]],l.nocapture||l.build||g[l.kingdom]++)}k=c=0;for(q=1;q<m;q++)g[q]>c&&(k=q,c=g[q]);c&&b.kingdom!=k&&b.changeKingdom(k);
Sa(b,1E3)},Mg,gm=[1,1],Ti=function(){return Date.now()-Hd+25*v.gcycle()},jb=function(b){if(!(b&&r.online||jb.bySystem&&b))if(0===r.paused){r.paused=1;void 0!=Mg&&clearInterval(Mg);var c=r.now();r.pausedTime+=Date.now();b||(jb.bySystem=1);r.now=function(){return c}}else r.pausedTime-=Date.now(),r.paused=0,jb.bySystem=0,b&&(p("alert").style.display="none"),Mg=setInterval(zc,zc.speed),r.now=Ti};jb.bySystem=0;jb.fast=!0;var Rb=function(b,c){var k=0,e=0,f=0;1>b?(b*=-1,f=~~(b/Fa),e=b%Fa):k=b;b=0;for(var g=
c.length;b<g;b++){var m=B[c[b]];m.mimg=m.url.move;v.specialMoveAdapter(m.id,k,0,0,e,f)}};Rb.cursor=7;Rb.allowPos=1;var Sa=function(b,c,d){c=~~(c/25)+r.cycle;b.c=c;b.timestamp=r.now()},Ng=function(b){var c=B[b[0]];if(!c.death){var k=b[1],e=b[2],f=b[3];c.cow&&"milk"==k&&c.workers&&c.workers.length||(c[k]+=J[c.kingdom].values[e],e=c[k+"Max"],c[k]>e&&2!==c.blocked&&(c[k]=e));"mana"==k&&(e=c.manaTask)&&e[2]<=c[k]&&(c.blockedAction(1),ha(e[1],c,ac[e[0]],c.url.move),c.manaTask=void 0);X(c.id,1);Ha({func:Ng,
data:b},f,1)}},Ha=function(b,c,d){b.func.url||C(b.func);b.func=b.func.url;d&&(c=~~(c/25)+r.cycle);d=Ui[c];d||(d=[],Ui[c]=d);d.put(b)},Ui={},Vi=function(b){var c=H,k=!1;b.waiting&&(b.stock&&0!==b.stock[0]?(b.mimg=b.url[b.stock[4].url],b.stock[3]===Ib&&(b.mimg=b.url.milk)):b.mimg=b.url.move);var e=b.y32,f=b.x32;Og(1,b,"zone");var g=v.unitAction(b.id),m=g&&ac[g]||!1;Na(b,32*e);var q=b.rbase();g=q.write;var w=f+e*c;Qi(b);if(b.id===q(w)){var l=b.size;if(2>l)g(w,b.radix);else for(var h=l*l,n=-c,p=0;p<h;p++){var t=
p%l;0===t&&(n+=c);g(w+t+n,0)}}if(b.stop)return g(w,b.id),b.stay(),b.stop=void 0,0;if(b.kx||b.ky){var r=b.kx||0,x=b.ky||0;h=!1;if(0!==q(r+f+(x+e)*c))return b.aspettare()}else{m&&m.rev&&(h=m.rev(b))&&(C("break"),b.action=h[0],m=ac[b.action],b.xf=h[1],b.yf=!0);if(0<(h=v.unitObjetive(b.id))){var y=B[h];if(!y||y.death&&(!m||!m.available))return g(w,b.id),b.stay();p=!0;n=!1;if(m&&m.available){n=m.available(b,y);if(!1===n)return b.aspettare();if("kill"===n)return g(w,b.id),b.stay();if(55===n)return g(w,
b.id);p=n[2]}else y.death||(n=kb(y,b,50,b.radix));v.unitObjetive(b.id)!==h&&(y=B[v.unitObjetive(b.id)]);if(!y||y.death||y.in)return g(w,b.id),b.stay();if(!p&&(A+D*c===w||m))return b.aspettare();var A=n[0],D=n[1];if(m&&m.distance){var F=m.distance;F=0>F?b.attDist:J[b.kingdom].values[F];n=Pg(y,f,e);Id(f,e,n%H,~~(n/H),F)&&(k=2)}b==y&&(k=2)}else{A=v.unitXF(b.id);D=v.unitYF(b.id);h=q(A+D*c);if(2<h&&(!m||m&&m.rev)){h=B[h];n=kb(h,b,50,b.radix);if(!1===n)return g(w,b.id),b.stay();A=n[0];D=n[1]}m&&m.distance&&
(F=m.distance,F=0>F?b.attDist:J[b.kingdom].values[F],Id(f,e,A,D,F)&&(k=2))}h=A+D*c;n=A;p=D;if(!k){x=v.inspector71017(f,e,n,p,b.radix,b.zLevel);void 0!==x?(r=-f+x%c,x=-e+~~(x/c)):x=r=1;if(1<Math.abs(r)||1<Math.abs(x))return b.aspettare();if(q(f+r+(e+x)*c)!==b.radix||!fa(f+r,e+x)){r=[f+1,e,f-1,e,f+1,e+1,f+1,e-1,f,e-1,f-1,e+1,f,e+1,f-1,e-1];x=H;t=Infinity;for(var I,G=0;G<r.length;G+=2)0===q(r[G]+r[G+1]*x)&&fa(r[G],r[G+1])&&t>=(r[G]-n)*(r[G]-n)+(r[G+1]-p)*(r[G+1]-p)&&(t=(r[G]-n)*(r[G]-n)+(r[G+1]-p)*(r[G+
1]-p),I=G);n=[r[I],r[I+1]];r=n[0]-f;x=n[1]-e;r=0<r?1:0>r?-1:0;x=0<x?1:0>x?-1:0;if(q(f+r+(e+x)*c)!==b.radix||!fa(f+r,e+x))return b.aspettare()}}}if(w==h||k)if(g(f+e*c,b.id),b.x32=f,b.y32=e,m){if(m.distance&&2!==k)return b.aspettare();b.stay(1);y||(y=A+D*c);m(y,b,F)}else b.stay();else{if(0===r&&0===x)return b.aspettare();b.setupDir(r,x);k=b.spd;ca(b,b.mimg,-1,b.spd/b.__proto__.spd);b.dix=r*k;b.diy=x*k;e+=x;f+=r;b.x32=f;b.y32=e;Sa(b,~~(32E3/k));Jb(b,r*k,x*k,0);w=f+e*c;if(2>l)g(w,b.id);else for(h=l*l,
n=-c,p=0;p<h;p++)t=p%l,0===t&&(n+=c),g(w+t+n,b.id)}},Wi=function(b){b/=1E3;var c=~~(b/60)%60,k=~~(b/3600);b=~~(b%60);1===(b+"").length&&(b="0"+b);0!=k?(k+=":",10>c&&(c="0"+c)):k="";return k+c+":"+b},Hd=0,Xi=0,zc=function(){if(!r.editor){r.cycle=v.gcycle();r.now();Hd&&(Xi+=Date.now()-Hd-zc.speed);Hd=Date.now();var b=Date.now();v.movtablexe();r.cycle=v.gcycle();0===r.cycle%40&&Yi();Qg+=Date.now()-b;0===r.cycle%40&&(p("topinfo").innerHTML="<span>CPU:"+(Qg/10).toFixed(2)+"%</span> <span>"+~~(Rg/Sg+.5)+
"FPS</span> <span>"+Wi(r.now())+"</span>",Rg=Sg=Qg=0);Xi>=zc.speed&&zc()}};zc.speed=25;var Qg=0,Sg=0,Rg=0,Sb=function(b,c,d,e){return[b,c,d,e,b,c,d,e,b,c,d,e,b,c,d,e]};new Float32Array(Sb(1,0,0,.75));new Float32Array(Sb(1,1,1,.5));new Float32Array(Sb(0,1,0,.75));var hm=new Float32Array(Sb(0,1,0,.9));new Float32Array(Sb(.3515625,.29296875,.21875,.9));var im=new Float32Array(Sb(0,1,1,.9));new Float32Array(Sb(1,1,1,.5));var jm=new Float32Array(Sb(.3,.3,.3,.9)),km=new Float32Array(Sb(.7,.2,.2,.9));im.noAlpha=
1;jm.noAlpha=1;km.noAlpha=1;var K=function(b){b=A[b];if(1===Q.length)C(999999999,44444);else for(var c=0,k=4*Ac.shift+1;c<k;c++){var e=Q,f=Infinity;var g=-1;for(var m=0,q=e.length;m<q;m++){var w=B[e[m]];if(!w.techStart&&!1!==w.built){var l=w.icons.indexOf(b.nu);l=(w.work&&w.work[l]||0)+(r.online&&w.usedCycle==r.cycle&&w.usedTimes||0);l<f&&(!Ie||l)&&(f=l,g=w.id)}}0<g&&(g=B[g],g.usedCycle!=r.cycle&&(g.usedTimes=0,g.usedCycle=r.cycle),g.usedTimes++,C(999999999,44444))}},Zi=function(b,c){var k=b[0],e=
b[1],f=b[2];b=A[k];c=B[c];var g=c.icons.indexOf(b.nu);if(!(0>g||void 0!==c.techID)){performance.now();if(0==f)for(f=0;f<e;f++){var m=J[c.kingdom],q=m.mod[k].cost||b.cost;if(m.paypal(q))break;c.waitlist||(c.waitlist=[]);c.waitlist.push(k,-g-1);c.work||(c.work={});c.work[g]||(c.work[g]=0);c.work[g]++;c.working=1;m.unitLoading++;2==c.waitlist.length&&(q=1E3*b.time,c.setupINTV(Jd,0,q))}else{if(!c.work||!c.waitlist.length)return;var w=c.waitlist;m=J[c.kingdom];for(f=0;f<e;f++){q=m.mod[k].cost||b.cost;
m.setupResources(q,-1);q=w.lastIndexOf(k);if(0>q)break;w.splice(q,2);c.work[g]--;if(0==w.length){c.c=-1;c.working=0;break}m.unitLoading--;0===q&&(q=1E3*A[w[0]].time,c.setupINTV(Jd,0,q))}}X(c.id)}},$i=0,Jd=function(b){if(b.death||b.waitlist&&!b.waitlist.length)return!1;var c=b.kingdom;c=J[c];var k=c.values.pop>=c.values.popMax?t.houseLimit:t.popLimit;if(c.values.pop>=c.values.popMax||c.values.pop>=c.values.popLimit)return p("msgs1").getElementsByTagName("li"),3E4<Date.now()-$i&&c.k==y.kingdom&&Tb(k,
0,5),$i=Date.now(),c.onFreePop.put(b.id),!0;c.unitLoading--;c=b.waitlist[0];k=A[c];b.work[-b.waitlist[1]-1]--;b.waitlist.splice(0,2);0<b.waitlist.length?b.setupINTV(Jd,0,1E3*k.time):b.working=0;Je(c,b);X(b.id);return!0},Ca=function(){0==Ie&&C(999999999,44444)},Ia=function(){0==Ie&&C(999999999,44444)},aj=function(b,c){var k=b[0];b=b[1];c=B[c];var e=J[c.kingdom],f=J[c.kingdom];if(f.values.pop>=f.values.popMax&&c.kingdom===y.kingdom)return Tb(t.popLimit,0,5);if(b)var g=f.values.fameTech;f=4;var m=9*
b;m||(m=1);if(b)var q=c.mlist,w=c.mlistID;else q=c.hlist,w=c.hlistID;var l=w.indexOf(k);if(!(0>l)){k=q[l].unit;var h=A[k].cost,n=g,p=1.6,r=0;1===m&&(n=0,p=3.6,r=620);if(e.paypal([r+~~(p*h[0]*m+.5)+120*n,~~(p*h[1]*m+.5),~~(p*h[2]*m+.5),~~(p*h[3]*m+.5)]))return 0;q.splice(l,1);w.splice(l,1);for(e=0;e<m;e++)w=Je(k,c),g?w.level=f:b||(f=16,w.level=f,q=lm[w.race],w.name=q[w.id%q.length],q=w,w=q.level,q.attack+=w,q.defence+=~~(.5*w))}},Je=function(b,c,d,e){var k=H,g=c.kingdom;c.rnd||Tg(c);var m=-1,q=-1;
if(c.point&&!c.disallowPoint){var w=c.point[0],l=c.point[1];m=bj(c,w,l,A[b].radix,A[b].rbase())[0]}else m=bj(c,m,q,A[b].radix,A[b].rbase())[1],m=m[cj(c,m.length)];q=~~(m/k);b=new Zc(b,g,m%k,q,0,!1,e);popinfo(g);d||na("unitdone",0,0,b.kingdom);if(c.point){var h;c=b||B[Q[0]];d=J[c.kingdom];"peon"==(b?c.clss:Kd)&&(h=!0);if(r.editor)h=[mm,n];else{var n=w+l*H;w=Z[n];l=0;if(c){if(2<w||(w=Ke[n])&&2<w){var p=B[w];p.invisible||(h&&p.storage&&c.stock?l=Le:h&&void 0!=p.res?l=Me:h&&p.health<p.maxHealth&&!d.diplomacy[p.kingdom]&&
p.build&&!p.dummy||p.dummy&&!p.built?l=Ld:d.diplomacy[p.kingdom]||p.dummy&&d.values.experience||p.confused?l=$b:1===p.invType&&!c.build&&!c.boat&&0<p.invMax&&Ug(c,p)&&(l=Md))}else w=lb[n],2<w&&!c.build&&!c.boat&&(p=B[w],p.item?l=Nd:p.field&&h?l=Ne:1===p.invType&&!c.build&&!c.boat&&0<p.invMax&&Ug(c,p)&&(l=Md));0===l&&(l=Ub[c.kingdom],l[n]&&h?(w=l[n],l=Ld):(p||(w=-n),l=Rb,Rb.cursor=2));h=[l,w]}else h=[l,n]}n=h[1];if(h[0])h[0](n,[b.id])}return b},dj=0,ej=0,ec,ib,we,S=function(b){b=A[b];ec=!1;var c=ja;
ca(c,b.img);c.active=!0;ib=b;we=!1;C(ec);document.addEventListener("mousemove",xg);document.addEventListener("mousedown",zd)},zd=function(b){var c=ib.validator,k=ib.space,e=Db[ib.img];0==b.button&&151<b.pageX?(b=bc(b.pageX-y.mx-.5*e[8]/R,b.pageY-.5*e[9]/R),e=~~(.03125*b[1]),b=~~(.03125*b[0]),ib.wall?cb(b,e):c(b,e,k,y.kingdom)[1]&&(ec=!0,ja.active=!0,ja.x=-9999,ja.y=-9999,document.removeEventListener("mousedown",zd),C(999999999,44444),Ac.shift&&(we?xi(we):S(ib.type)))):(ja.active=!0,ja.x=-9999,ja.y=
-9999,ec=!0,document.removeEventListener("mousedown",zd))},xg=function(b){var c=ib.validator,k=ib.space,e=Db[ib.img];if(ec)document.removeEventListener("mousemove",xg);else{var f=b.pageX,g=b.pageY;if(f!=dj||g!=ej)ja.active=!0,dj=f,ej=g,f=bc(b.pageX-y.mx-.5*e[8]/R,b.pageY-.5*e[9]/R),g=~~(.03125*f[1]),f=~~(.03125*f[0]),b=32*f,e=32*g,c=!c(f,g,k,fj.k)[1],c!=gj&&(gj=c),ja.x=b,ja.y=e}},Vg=function(b,c){var k=b[0],e=k%Fa,f=~~(k/Fa),g=r.editor?y.kingdom:B[c[0]].kingdom;k=b[1];var m=A[k],q=m.cost,l=J[g];if(!m.validator(e,
f,m.space,g)[1]||!r.editor&&l.paypal(q))return!1;b=new Zc(k,g,e,f,0,!r.editor,b[2]);if(!0===b.invalid||r.editor)return!1;b.waitlist=[];if(20===k)b.built=1,e=B[c[0]],ha(b.id,e,Bc,e.url.move);else for(b.health=1,ca(b,b.bimg),b=b.id,k=0,f=c.length;k<f;k++)e=B[c[k]],e.buildList?(e.buildList.put(b),e.func!==Oe.url&&(g=Pe(e.buildList,e.x32,e.y32))&&ha(g,e,Cc,e.url.move)):(e.buildList=[b],e.func!==Oe.url&&ha(b,e,Cc,e.url.move))},gj=null,cb=function(b,c){cb.x=b;cb.y=c;ec=!0;ja.active=!0;ja.x=-9999;ja.y=-9999;
document.removeEventListener("mousedown",zd);cb.click=!1;cb.painted={};Vb.lastFrame=za.frameCount-1;Vb(b,c);document.addEventListener("mousemove",Wg);document.addEventListener("mouseup",hj)},Vb=function(b,c){if(cb.click)document.removeEventListener("mousemove",Wg);else if(za.frameCount>Vb.lastFrame){Xg=!1;Vb.lastFrame=za.frameCount;var k=cb.x,e=cb.y,f=0,g=Math.abs(k-b)+1,m=Math.abs(e-c)+1;k=b<k?b:k;e=c<e?c:e;var q=Vb.anims;b=0;for(c=q.length;b<c;b++)La(q[b].bufferID);for(b=q.length=0;b<g;b++)for(c=
0;c<m;c++)if(!b||!c||b===g-1||c===m-1){var w=b&&b<g-1?l.wood_horz:c&&c<m-1?l.wood_vert:ib.img;var h=b+k;var n=c+e;h={x32:h,y32:n,img:w,d:0};q[f++]=h}}};Vb.anims=[];var hj=function(b){b=Vb.anims;for(var c=0,k=b.length;c<k;c++){var e=b[c];C(999999999,44444);La(e.bufferID)}b.length=0;cb.click=!0;document.removeEventListener("mouseup",hj)},Wg=function(b){var c=Db[ib.img];b=bc(b.pageX-y.mx-.5*c[8]/R,b.pageY-.5*c[9]/R);c=~~(.03125*b[1]);b=~~(.03125*b[0]);Vb(b,c)},ij=function(b,c){b=0;for(var k=c.length;b<
k;b++){var e=B[c[b]];e.xf?e.stop=1:e.stay()}},Yg=function(b,c){b=B[c[0]];b.techStart=0;b.c=void 0;v.unitWorking(this.id,!1);c=b.techID;b.techID=void 0;if(c){var k=J[b.kingdom].technology.hidden;-1<c&&(k[c]=0);J[b.kingdom].setupResources(F[b.activeTech].cost,-1)}else if(b.lcost)J[b.kingdom].setupResources(b.lcost,-1);else return;X(b.id)},G=function(b){C(999999999,44444)},jj=function(b,c){var k=F[b],e=k.nu.id,f=B[c];k.upgrade&&(e=-1);if(void 0!==f.techID||f.waitlist&&f.waitlist.length||J[f.kingdom].paypal(k.cost))return!1;
f.activeTech=b;f.techID=e;f.setupINTV(k.type,b,1E3*k.time);f.techStart=f.c-r.cycle;b=J[B[c].kingdom].technology.hidden;-1<e&&(b[e]=1);X(c)},W=function(b,c){c=F[c];Eb(b,c,c.nu.id)},Qe=function(b,c){c=F[c];var k=c.nu.id,e=A[c.obj],f=J[b.kingdom].mod[e.type];Zg(b);b.img=e.img;b.attack=f.attack||e.attack;b.health=b.health/b.maxHealth*e.health;b.maxHealth=e.health;b.__proto__=e;Eb(b,c,k)},Re=function(b,c){c=F[c];var k=c.nu.id;if(c.actvintv)for(var e=c.actvintv,f=0,g=e.length;f<g;f++){var m=e[f];J[b.kingdom].technology.disabled[m.id]=
0;for(var q=m.builds,l=sa[b.kingdom],h=0,n=q.length;h<n;h++)for(var p=l[q[h]],t=0,r=p.length;t<r;t++)m(B[p[t]])}Eb(b,c,k)},Ja=function(b,c){c=F[c];var k=c.nu.id;J[b.kingdom].values[c.value]+=c.increase;"popMax"==c.value&&popinfo(b.kingdom);Eb(b,c,k)},kj=function(b,c){c=F[c];var k=c.nu.id,e=c.group,f=J[b.kingdom],g=sa[f.k];f=f.mod;for(var m=0,q=e.length;m<q;m++)for(var l=f[e[m].type],h=g[e[m].type],n=0,p=c.values,t=p.length;n<t;n+=2){var r=p[n],v=p[n+1];l[r]||(l[r]=e[m][r]||0);for(var x=0,y=h.length;x<
y;x++)B[h[x]][r]+=v;l[r]+=v}Eb(b,c,k)},Ua=function(b,c){c=F[c];var k=c.nu.id,e=c.group,f=J[b.kingdom],g=f.mod;f=sa[f.k];for(var m=0,q=e.length;m<q;m++){var l=g[e[m].type];l[c.value]||(l[c.value]=e[m][c.value]||0);l[c.value]+=c.increase;l=f[e[m].type];for(var h=0,n=l.length;h<n;h++)B[l[h]][c.value]+=c.increase}Eb(b,c,k)},$g=function(b,c){c=F[c];for(var k=c.nu.id,e=J[b.kingdom].mod,f=c.mulp,g=0,m=c.group.length;g<m;g++){var q=c.group[g],l=e[q.type].cost||q.cost;e[q.type].cost=f?[~~(l[0]*f),~~(l[1]*
f),~~(l[2]*f),~~(l[3]*f)]:[l[0]-c.decrease[0],l[1]-c.decrease[1],l[2]-c.decrease[2],l[3]-c.decrease[3]]}Eb(b,c,k)},ah=function(b,c){c=F[c];for(var k=c.nu.id,e=J[b.kingdom].mod,f=0,g=c.decrease,m=g.length;f<m;f+=2){var q=g[f],l=g[f+1],h=e[q.type].cost||q.cost;e[q.type].cost=[h[0]-l[0],h[1]-l[1],h[2]-l[2],h[3]-l[3]]}Eb(b,c,k)},Eb=function(b,c,d){b.techStart=void 0;b.activeTech=void 0;b.techID=void 0;b.func=void 0;var k=J[b.kingdom].technology,f=k.disabled;k.investigated[d]=1;v.investigateTech(k.k,d+
A.length);na("techdone",0,0,b.kingdom);if(c=c.next)for(d=0,k=c.length;d<k;d++)f[c[d].id]--;b.standardFunc&&b.standardFunc(b);X(b.id)};"use strict";var bb,nm={icon:"food",img:"item_meat",url:"meat"},om={icon:"milk",img:"milk",url:"milk"},pm={icon:"gold",img:"item_gold",url:"gold"},qm={icon:"stone",img:"item_stone",url:"stone"},lj={icon:"wood",img:"item_tree",url:"tree"},rm={icon:"food",img:"item_food",url:"food"},Od=function(b,c,d,e){b=sa[b];var k=bb[c];c=[];c.length=k.length;for(var g=0,m=k.length;g<
m;c[g]=b[k[g++]]);b=Infinity;k=-1;for(g=0;g<c.length;g++){m=c[g];for(var q=m.length,l=0;l<q;l++){var h=B[m[l]];if(!1!==h.built){var n=h.x32,p=h.y32,r=h.space;h=r[r.length-1];r=(r.length-1)/h;h*=.5;r*=.5;n+=h;p+=r;h=.5*(h+r);n=Math.sqrt((n-d)*(n-d)+(p-e)*(p-e))-h;b>=n&&(b=n,k=m[l])}}}return k},cj=function(b,c){b=b.rnd;var k=b[0],e=b[1],f=b[2];k+=f;e-=f;k=36969*(k&65535)+(k>>16)&4294967295;e=18E3*(e&65535)+(e>>16)&4294967295;b[0]=k;b[1]=e;b[2]++;return~~((((k<<16)+e&4294967295)/4294967295+.5)*c)},Pd=
function(b){b!=mj&&(mj=b,document.body.className="ncursor"+b)},mj=-1,Nd=function(b,c){for(var k=0,e=c.length;k<e;k++){var f=B[c[k]];ha(b,f,Qd,f.url.move)}};Nd.spLevel=function(b){var c=0;2<lb[b]&&(c=lb[b]);return c};var Qd=function(b,c){c.stay55();if(c.inventory&&c.invMax===c.inventory.length||!b.item)return 1;lb[b.x32+b.y32*H]=b.radix;Na(b,NaN);if(c.peon&&b.contain){var k=b.contain[1],e=b.contain[0];c.stock&&nj(c);var f=oj(c.x32,c.y32)||!1,g=b.contain[2];b.die(1);c.stock=[e,k,f,Qd.url,g];b=Od(c.kingdom,
k,c.x32,c.y32);ha(b,c,Wb,c.url[g.url]);X(c.id);return 1}c.addItem(b);X(c.id)},nj=function(b){var c=pj(b.x32,b.y32),k=~~(c/H);c%=H;c=new Zc(52,b.kingdom,c,k,0);ca(c,l[b.stock[4].img]);c.contain=[b.stock[0],2,b.stock[4]]},qj=function(b,c){b=0;for(var k=c.length;b<k;b++){var e=B[c[b]];e.xf?e.stop=2:(e.stop=2,e.stay(),e.stop=void 0)}},Te=function(b,c){var k=H;b=B[b];for(var e=0,f=c.length;e<f;e++){var g=B[c[e]];if(g.in){var m=g.rbase(),q=g.x32+g.y32*k;if(0!==m(q)||!b.build){q=b.build?Se(g,g.x32,g.y32):
Se(g,b.x32,b.y32);if(!1===q)continue;g.x32=q%H;g.y32=~~(q/H)}g.item&&(b.attack-=g.attack||0,b.defence-=g.defence||0);g.url.idle&&ca(g,g.url.idle,1);m.write(q,g.id);g.in=0;b.inventory.quit(g.id);m=1;g.z32&&(m=g.z32);Na(g,32*g.y32*m)}}X(b.id,1)},Md=function(b,c){b=B[b];if(1===b.invType)for(var k=0,e=c.length;k<e;k++){var f=B[c[k]];f==b||f.in||ha(b.id,f,bh,f.url.move)}},bh=function(b,c){var k=b.inventory;if(k.length<b.invMax){var e=c.x32,f=c.y32;c.stay55();c.rbase().write(e+f*H,c.radix);k.put(c.id);
Na(c,NaN);c.in=b.id;Rd(c.id);X(b.id)}else c.stay55()},Ld=function(b,c){for(var k=c.length,e=0;e<k;e++){var f=B[c[e]];f.buildList=!1;ha(b,f,Cc,f.url.move)}},Cc=function(b,c){if(b.dummy&&b.dummy.built)return c.stay55();if(b.health<b.maxHealth)c.dix=0,c.diy=0,c.mv=!0,c.setupDirBuild(b),ca(c,c.url.build,1),c.setupINTV(Oe,b.id,Xa(c.img)),Ed(c,"hit%20",7,c.img);else{if(c.buildList&&(b=Pe(c.buildList,c.x32,c.y32)))return ha(b,c,Cc,c.url.move),0;c.stay55()}},Ue=function(b,c){return c[b]&&13==B[c[b]].type||
13==B[Z[b]].type?!0:!1},Oe=function(b,c){c=B[c];var k=b.x32,e=b.y32,f=c.x32+c.y32*H;if(c.death)return b.stay();var g=c.maxHealth,m=g/c.__proto__.time*J[b.kingdom].values.buildSpeed;c.health+=m;var q=c.health;if(0==c.built){if(1===c.health-m){for(var h=c.validator(c.x32,c.y32,c.space,c.kingdom)[0],n=c.id,p=c.validator.dimension,r=p.write,t=0,v=h.length;t<v;t++)if(2<p(h[t])){Sa(b,Xa(b.img));c.health-=m;return}m=Ub[c.kingdom];t=0;for(v=h.length;t<v;t++)r(h[t],n),m[h[t]]=void 0;sa[c.kingdom][c.type].put(c.id);
mb(c)}h=~~(4*q/g);h>c.d&&(c.d=h,ca(c,c.img))}if(q>=g){q=c.health=g;X(c.id);if(!1===c.built){c.d=0;h=c.url;m=Ub[c.kingdom];13===c.type&&(Ue(f-1,m)&&Ue(f+1,m)?(h=l.wood_horz,c.child=void 0):Ue(f+H,m)&&Ue(f-H,m)&&(h=l.wood_vert,c.child=void 0));c.built=1;c.img=h;if(c.valid2)for(h=c.validator(c.x32,c.y32,c.space,c.kingdom)[2],r=c.validator.dimension.write,t=0,v=h.length;t<v;r(h[t++],0));f=c;h=J[f.kingdom];if(f.population)for(n=f.population,h.values.popMax+=n,popinfo(f.kingdom),r=0;r<n;r++)h.checkPopArray();
if(f.onbuild)for(f=f.onbuild,n=h.technology,h=n.disabled,n=n.actived,r=0;r<f.length;r++)t=f[r].id,n[t]||(n[t]=0),n[t]++,n[t]-1||h[t]--;na("bldgdone",0,0,c.kingdom);J[c.kingdom].building.quit(c.id);X(c.id);c.standardFunc&&c.standardFunc(c)}c.action=void 0;(f=b.buildList)&&f.quit(c.id);if(!f||b.buildList&&0===b.buildList.length)b.buildList=rj(b),f=b.buildList;if(k=Pe(f,k,e))return ha(k,b,Cc,b.url.move),0;b.buildList.length=0;b.stay();b.stock&&b.stock[0]&&ca(b,b.url[b.stock[4].url])}else X(c.id),Sa(b,
Xa(b.img));Q[0]==c&&(sb.innerHTML=q+"/"+g,qa.value=q)},Ne=function(b,c){if(2<b)for(var k=0,e=c.length;k<e;k++){var f=B[c[k]];ha(b,f,Bc,f.url.move)}},Me=function(b,c){var k=b;b=B[b];if(b.field)for(e=0,b=c.length;e<b;e++)f=B[c[e]],ha(k,f,Bc,f.url.move);else if(0===b.res||3===b.res){var e=0;for(b=c.length;e<b;e++){var f=B[c[e]];ha(k,f,Ve,f.url.move)}}else if(1===b.res)for(e=0,b=c.length;e<b;e++)f=B[c[e]],ha(k,f,Dc,f.url.move);else if(2===b.res)for(e=0,b=c.length;e<b;e++)f=B[c[e]],ha(k,f,Ib,f.url.move)},
sj=function(b,c){var k=A[b],e=c.length;b=J[B[c[0]].kingdom].mod[b];for(var f=0;f<e;f++){var g=B[c[f]];g.stay();Zg(g);g.img=k.img;g.attack=b.attack||k.attack;g.health=g.health/g.maxHealth*k.health;g.maxHealth=k.health;g.defence=b.defence||k.defence;g.__proto__=k;X(g.id)}},$b=function(b,c,d,e){d=e||$c;if(!(3>b||(b=B[b],void 0!=b.res&&!b.cow||b.magicGateway))){e=0;for(var k=c.length;e<k;e++){var g=B[c[e]];g==b||g.attackOnly&&!g.attackOnly[b.type]||g.bat&&b.build||b.stoned||(g.build?d(b,g):ha(b.id,g,
d,g.url.move))}}},Dc=function(b,c){if(0<b.health){var k=c.x32,e=c.y32;c.mv=!0;c.setupDir(b.x32-k,b.y32-e);ca(c,c.url.cut,1);c.dix=0;c.diy=0;Ed(c,"chop%20",11,c.img);c.setupINTV(tj,b.id,7E3);b.addWorker(c)}else c.stay55()},tj=function(b,c){var k=H;c=B[c];var e=J[b.kingdom].values.wood;c.workers.quit(b.id);var f=Od(b.kingdom,1,b.x32,b.y32),g=B[f];c.health-=e;b.mv=!1;X(c.id);if(1>c.health){e+=c.health;Z[c.x32+c.y32*k]=0;k=da(g.x32,g.y32);g=c.health=0;for(var m=c.workers.slice(0),q=m.length;g<q;g++){var l=
B[m[g]];k?ha(k,l,Dc,b.url.move):l.stay()}b.stock=[e,1,k,Dc.url,lj];b.mv=!1;ha(f,b,Wb,b.url.tree);X(b.id,1);c.workers.length=0;c.die()}else b.stock=[e,1,c.id,Dc.url,lj],ha(f,b,Wb,b.url.tree),X(b.id,1);if(0>f)return b.stay()},Bc=function(b,c){c.mv=!0;c.setupDir(b.x32-c.x32,b.y32-c.y32);ca(c,c.url.dig,1);Ed(c,"dig%20",3,c.img);c.setupINTV(uj,b.id,14E3);b.addWorker(c)},uj=function(b,c){c=B[c];var k=J[b.kingdom].values.food,e=b.x32,f=b.y32;c.lastUse=r.cycle;e=Od(b.kingdom,2,e,f);b.mv=!1;b.stock=[k,2,c.id,
Bc.url,rm];ha(e,b,Wb,b.url.food);X(b.id,1);if(0>e)return b.stay()},Ib=function(b,c){c.mv=!0;c.setupDir(b.x32-c.x32,b.y32-c.y32);ca(c,c.url.milk1,1);c.stock=[0,2,b.id,Ib.url,om];c.setupINTV(ch,b.id,1E3);b.addWorker(c);b.d=(8-c.d)%8;b.stay()},ch=function(b,c){c=B[c];c.milk-=3;var k=b.x32,e=b.y32;b.stock[0]+=3;X(b.id,1);if(0>=c.milk||c.death){if(50<b.stock[0]&&(b.stock[0]=50),b.mv=!1,c=Od(b.kingdom,2,k,e),ha(c,b,Wb,b.url.milk),0>c)return b.stay()}else Sa(b,1E3)},Gd=function(b,c){c.stay55()},Yc=function(b,
c){$c(b,c)},$c=function(b,c){if(1!==b.death&&b!=c){if(b.dummy&&!J[c.kingdom].values.experience)return c.stay55();c.invisible&&ad(c.id);if(!0!==c.build){c.mv=1;var k=b.x32-c.x32,e=b.y32-c.y32;b.space&&(e=Pg(b,c.x32,c.y32),k=e%H-c.x32,e=~~(e/H)-c.y32);c.setupDir(k,e,c.d2attack);c.url.attack&&ca(c,c.url.attack,1)}c.setupINTV(We,b.id,c.attackTime||Xa(c.img),b);b.addWorker(c)}else c.stay55()};$c.distance=-1;Yc.distance=-1;var dh=function(b,c){var k=J[b.kingdom];if(k.values.experience&&(!c||0!=k.diplomacy[c.kingdom]||
c.dummy)){if(0==b.level||null==b.level)b.level=0,b.levelProgress=0;b.levelProgress++;b.levelProgress>=~~(b.level/k.values.experience)&&b.level<k.values.maxLevel&&(b.level++,b.health+=k.values.healthJump,b.maxHealth+=k.values.healthJump,b.levelProgress=0,b.attack+=b.level,b.defence+=b.level%2,X(b.id,1))}},vj=function(b,c){b=.5-Math.atan2(c,b)/(2*Math.PI);1==b&&(b=0);return b},We=function(b,c){c=B[c];var k=b.attDist,e=c.x32-b.x32,f=c.y32-b.y32,g=c.x32,m=c.y32,q=!b.build;if(b.attackSound){var l=b.attackSound;
na(l[~~(l.length*Math.random())],b.x32,b.y32)}q&&!c.build&&b.setupDir(e,f,b.d2attack);ca(b,b.img,1);if(c.death||b.level&&8<=b.level&&c.dummy||c.dummy&&b.level&&b.level>=J[b.kingdom].values.maxLevel)return b.stay();if(1<k&&!b.dragon){q=!0;var h=Db[b.attimg]}else q=!1;if(c.build||Id(c.x32,c.y32,b.x32,b.y32,k)){c.onattack(b);k=b.attack*((Fd[b.type][c.type]||0)+1);if(q){c.space&&(e=Pg(c,b.x32,b.y32),g=e%H,m=~~(e/H),e=g-b.x32,f=m-b.y32);q=0;if(b.arrow||b.ball){l=wj;var n=vj(-e,-f);var p=e;var t=f;var v=
411/Math.sqrt(p*p+t*t);p*=v;t*=v;var x=Math.sqrt(1024*e*e+f*f*1024)/Math.sqrt(p*p+t*t);b.ball&&(h[1]=h[0]/x)}else{var y=2;l=Xe;q=p=r.gravity;n=Math.PI/180*60;v=Math.cos(n);n=b.attackDeg;n*=Math.PI/180;t=Math.sin(n);x=Math.cos(n);n=32*Math.sqrt(e*e+f*f);p=x*Math.sqrt(p*n/(t*x*2));x=n/p;t=-Math.sin(Math.atan2(-e,-f));n=vj(-e,-f);p*=t;q=Math.abs(q*v*t);t=(32*f-q*x*x*.5)/x}x=Math.round(1E3*x);v={x32:b.x32+.5,y32:b.y32+.5,img:h.url,mv:b.ball,d:0,rotation:2*-n*Math.PI-3*Math.PI/2,xf:g,yf:m,obj:c.id,attack:k,
range:y};Jb(v,p,t,q);Ha({func:l,data:v},x,1)}v||c.damage(k,b);if(c.dummy){if(50<=b.dummyDamage||!b.dummyDamage)b.dummyDamage=0;b.dummyDamage+=k;50<=b.dummyDamage&&dh(b,c)}c.death?(b.action=null,c.build||b.build||dh(b,c),Qc(b)||b.stay()):Sa(b,b.attackTime||Xa(b.img))}else b.build&&(Qc(b)||b.stay()),b.mv=!1,0!==b.state&&ha(c.id,b,$c,b.url.move)},Ve=function(b,c){0<b.health?(c.dix=0,c.diy=0,c.mv=1,c.setupDirBuild(b),ca(c,c.url.kirka,1),Ed(c,"mine%20",3,c.img),c.setupINTV(xj,b.id,7E3),b.addWorker(c)):
c.stay()},xj=function(b,c){c=B[c];var k=c.res,e=J[b.kingdom].values[0==k?"gold":"stone"],f=b.x32,g=b.y32;c.health-=e/J[b.kingdom].values.miningPerf;X(c.id);1>c.health&&(e=c.health+e,c.health=0,c.d=3,c.die());b.mv=!1;f=Od(b.kingdom,k,f,g);0==k?(b.stock=[e,k,c.id,Ve.url,pm],ha(f,b,Wb,b.url.gold)):(b.stock=[e,k,c.id,Ve.url,qm],ha(f,b,Wb,b.url.stone));X(b.id,1);if(0>f)return b.stay()},ha=function(b,c,d,e){var k=0,g=0;0>=b&&(b*=-1,k=b%H,g=~~(b/H),b=0);v.specialMoveAdapter(c.id,b,d.url,e,k,g);c.mimg=e},
Ze=function(b,c){if(B[c[0]].boat&&(b=-b,b=-Se(A[76],b%H,~~(b/H)),!b))return!1;Ye(c,b,yj)};Ze.allowPos=1;var yj=function(b,c){C(b);Te(c.id,c.inventory.slice(0));c.stay55()},Pg=function(b,c,d){var k=b.space||gm,f=k.length-1,g=k[f],m=b.x32;b=b.y32-1;for(var q=Infinity,l=0,h=0;h<f;h++){var n=h%g;n||b++;var p=(m+n-c)*(m+n-c)+(b-d)*(b-d);p<q&&k[h]&&(l=m+n+b*H,q=p)}return l},Se=function(b,c,d){var k=H,f=b.radix,g=b.rbase();for(b=2;60>=b;b+=2){c--;d--;for(var m=0;m<=b;){var q=c+m+k*d;if(g(q)===f)return q;
q=c+m+k*(d+b);if(g(q)===f)return q;m++}for(m=0;m<b-1;){m++;q=c+k*(d+m);if(g(q)===f)return q;q=c+b+k*(d+m);if(g(q)===f)return q}}return!1},pj=function(b,c){var k=H,e,f=bd;for(e=2;60>=e;e+=2){b--;c--;for(var g=0;g<=e;){var m=b+g+k*c;if(0===f(m)&&0===Z[m])return m;m=b+g+k*(c+e);if(0===f(m)&&0===Z[m])return m;g++}for(g=0;g<e-1;){g++;m=b+k*(c+g);if(0===f(m)&&0===Z[m])return m;m=b+e+k*(c+g);if(0===f(m)&&0===Z[m])return m}}return!1},kb=function(b,c,d,e){var k=c.x32,g=c.y32,m=H,q=k+g*m,l=b.x32,h=b.y32,n=
b.space;if(n){var p=n[n.length-1];n=(n.length-1)/p;b=b.free}else n=p=1,b=Si;c=c.rbase();for(var t,r=Infinity,v=-1,x=!1,y=0;y<d&&-1==v;){if(0==y&&b){for(var A=[],B=0,D=b.length;B<D;B+=2){var C=b[B]+l;t=b[B+1]+h;if(fa(C,t)&&(c(C+t*m)===e||C+t*m==q))a:{var F=A;C+=t*m;t=k;for(var G=g,I=H,J=Math.pow(C%I-t,2)+Math.pow(~~(C/I)-G,2),K=0,L=F.length;K<L;K++)if(Math.pow(F[K]%I-t,2)+Math.pow(~~(F[K]/I)-G,2)>J){F.splice(K,0,C);break a}F.put(C)}}A[0]&&(v=A[0]);if(-1<v){x=!0;break}if(1==d)break}y++;--l;--h;A=p+
2*y;F=n+2*y;B=0;for(D=A*F;B<D;B++)t=B%A,G=~~(B/A),t&&G&&t!=A-1&&G!=F-1||(t+=l,G+=h,C=t+G*m,c(C)==e&&fa(t,G)&&(t=(t-k)*(t-k)+(G-g)*(G-g),r>t&&(r=t,v=C)))}return-1<v?[v%m,~~(v/m),x]:!1},bj=function(b,c,d,e,f){performance.now();var k=H,m=b.x32,q=b.y32,l=b.space,h=[],n=0;if(l){var p=l[l.length-1];l=(l.length-1)/p;var t=b.free}else l=p=1;b=-1==c?-Infinity:Infinity;for(var r=-1,v=0,x=0;0==h.length;){if(t&&0==x){for(var y=0,A=t.length;y<A;y+=2){var B=t[y]+m,C=t[y+1]+q;fa(B,C)&&f(B+C*k)===e&&(h[n++]=B+C*
k,v=(B-c)*(B-c)+(C-d)*(C-d),b>v&&(b=v,r=B+C*k))}if(h.length)break}x++;--m;--q;for(y=0;y<p+2*x;y++)f(m+q*k+y)==e&&fa(m+y,q)&&(h[n++]=m+y+q*k,v=(m+y-c)*(m+y-c)+(q-d)*(q-d),b>v&&(b=v,r=m+y+q*k)),f(m+(q+l+2*x-1)*k+y)==e&&fa(m+y,q+l+2*x-1)&&(h[n++]=m+(q+l+2*x-1)*k+y,v=(m+y-c)*(m+y-c)+(q+l+2*x-1-d)*(q+l+2*x-1-d),b>v&&(b=v,r=m+(q+l+2*x-1)*k+y));for(y=1;y<l+2*x-1;y++)f(m+(q+y)*k)==e&&fa(m,q+y)&&(h[n++]=m+(q+y)*k,v=(m-c)*(m-c)+(q+y-d)*(q+y-d),b>v&&(b=v,r=m+(q+y)*k)),f(m+p+2*x-1+(q+y)*k)==e&&fa(m+p+2*x-1,q+
y)&&(h[n++]=m+p+2*x-1+(q+y)*k,b>v&&(b=v,r=m+p+2*x-1+(q+y)*k))}return[r,h]},Si=[-1,0,-1,-1,0,-1,1,-1,1,0,1,1,0,1,-1,1],Pe=function(b,c,d){for(var k=Infinity,f=!1,g=0,m=b.length;g<m;g++){var q=b[g],l=B[b[g]];if(0!=l.built||l.death)g--,m--,b.quit(q);else{var h=l.x32;l=l.y32;l=(h-c)*(h-c)+(l-d)*(l-d);k>=l&&(k=l,f=q)}}return f},zj=function(b,c){b=0;for(var k=c.length;b<k;b++){var e=B[c[b]];e.spd=e.__proto__.spd}},Kg=function(b,c){b=Infinity;for(var k=0,e=c.length;k<e;k++){var f=B[c[k]];f.spd<b&&(b=f.spd)}eh(b,
c)},oj=function(b,c){for(var k=H,e,f=Infinity,g=0,m=0;121>m;m++){var q=m%11-5,l=~~(m/11)-5,h=q*q+l*l;q+=b;l+=c;h<f&&(e=lb[q+k*l],0<e&&0==Z[q+k*l]&&(e=B[e],e.contain&&(f=h,g=e.id)))}return g},Le=function(b,c){Ye(c,b,Wb)},Wb=function(b,c){b=J[c.kingdom];var k=c.stock;b.resources[k[1]]+=k[0];b.stats.resources[k[1]]+=k[0];$e(c.kingdom);c.func=1;var e=ac[k[3]],f=B[k[2]];if(e==Ib){var g=c.x32;for(var m=c.y32,q=H,l,h=Infinity,n=!1,p=0;961>p;p++){var t=p%31-15,v=~~(p/31)-15,x=t*t+v*v;t+=g;v+=m;x<h&&(l=lb[t+
q*v],0<l&&0===Z[t+q*v]&&(l=B[l],l.contain&&"meat"==l.contain[2].url&&(h=x,n=l)))}if(g=n)e=Qd,f=g}else"meat"==k[4].url&&!1===k[2]&&(g=fh(c.x32,c.y32,!0))&&(e=Ib,f=g,k[2]=1);c.stock=void 0;if(!1===k[2])return c.stay();if(g=100<Math.pow(f.x32-c.x32,2)+Math.pow(f.y32-c.y32,2))a:{g=bb[1];m=sa[c.kingdom];q=0;for(h=g.length;q<h;q++)if(n=g[q],1==A[n].storage&&m[n].length){g=!0;break a}g=!1}g&&void 0!==b.IAD&&1==k[1]?(r.blocked=!0,Mi(c),r.blocked=!1):(ha(f.id,c,e,c.url.move),X(c.id,1))};Me.cursor=6;$b.cursor=
1;Ld.cursor=9;Nd.cursor=5;Md.cursor=7;Ze.cursor=7;Ne.cursor=6;Le.cursor=6;var rj=function(b){var c=H,k=b.kingdom,e=b.x32,f=b.y32;e-=16;f-=16;for(var g={},m=[],q=0,l=Ub[k],h=0;1024>h;h++){b=h%32+e;var n=~~(h/32)+f;fa(b,n)&&(b=l[b+n*c],void 0!==b&&(b=B[b],b.kingdom!=k||!1!==b.built||g[b.id]||(m[q++]=b.id,g[b.id]=1)))}return m};Dc.available=function(b,c){var k=J[b.kingdom].values.wood;if(c.death||1>c.health-k&&c.workers.length){c=da(c.x32,c.y32);if(!c)return"kill";b.xf=c;c=B[c]}return kb(c,b,1,b.radix)};
Bc.available=function(b,c){if(c.death)return"kill";b=c.x32+1;c=c.y32+1;return 0===Z[b+c*H]?[b,c,1]:!1};Cc.available=function(b,c){var k=b.x32,e=b.y32;if(!c.death&&c.health<c.maxHealth){var f=kb(c,b,1,b.radix);if(f[2])return f}b.buildList?(f=b.buildList,f.quit(c.id)):(b.buildList=rj(b),f=b.buildList);c=Pe(f,k,e);if(!c)return"kill";b.xf=c;c=B[c];return kb(c,b,1,b.radix)};Gd.rev=function(b){return 0===b.distance%3&&(b=Lg(b.id,1))?[Yc.url,b]:!1};Yc.available=function(b,c){if(0===b.distance%3){var k=Lg(b.id);
k&&(b.xf=k,c=B[k])}return kb(c,b,5,b.radix)};Qd.available=function(b,c){if(c.death||c.in)if(c.contain)if(c=oj(c.x32,c.y32))b.xf=c,c=B[c];else return(c=fh(b.x32,b.y32,!0))?(b.stay(),ha(c.id,b,Ib,b.url.move),55):"kill";else return"kill";b=c.x32;c=c.y32;return 0===Z[b+c*H]?[b,c,1]:!1};Ib.available=function(b,c){if(c.workers.length||10>c.milk||c.death){c=fh(b.x32,b.y32);if(!c)return!1;b.xf=c.id}return c.xf?!1:kb(c,b,5,b.radix)};bh.available=function(b,c){if(c.death)return"kill";var k=1;c.boat&&(k=2);
return(b=kb(c,b,k,b.radix))?(b[2]=1,b):!1};var fh=function(b,c,d){for(var k=H,f,g=Infinity,m=!1,q=0;441>q;q++){f=q%21-10;var l=~~(q/21)-10,h=f*f+l*l;f+=b;l+=c;h<g&&(f=Z[f+k*l],0<f&&(f=B[f],f.cow&&(!f.workers.length&&f.milk>=50/1.5||d)&&(g=h,m=f)))}return m},Ye=function(b,c,d){for(var k=0,f=b.length;k<f;k++){var g=B[b[k]];ha(c,g,d,g.url.move)}},bf=function(b,c){Ma(c,b,af)};bf.noObj=1;var af=function(b,c){Sd(c,-b,77,af)},df=function(b,c){Ma(c,b,cf)};df.noObj=1;var cf=function(b,c){Sd(c,-b,130,cf)},
ff=function(b,c){Ma(c,b,ef)};ff.noObj=1;var ef=function(b,c){Sd(c,-b,78,ef)},hf=function(b,c){Ma(c,b,gf)};hf.noObj=1;hf.cursor=10;var gf=function(b,c){Sd(c,-b,132,gf)},kf=function(b,c){Ma(c,b,jf)};kf.cursor=10;kf.noObj=1;var jf=function(b,c){Sd(c,-b,131,jf)},Sd=function(b,c,d,e){var k=H,g=J[b.kingdom],m=A[d],q=A[d].cost,l=b.mana>b.manaMax;if(nb(b)||b.checkMana(q[4],c,e,q)){l||g.paypal(q);e=d;c*=-1;l=c%k;var h=~~(c/k),n=l,p=h,t=m.rbase(),r=~~(b.mana/q[4])+1;1<r&&(g.resources[0]-=q[0]*(r-1),b.mana-=
q[4]*(r-1));for(g=0;g<r;g++)0!==t(c)&&(d=Se(m,l,h),n=d%k,p=~~(d/k)),na("summon"+~~(10*Math.random()+1),n,p),d=new Zc(e,b.kingdom,n,p,0),d.setupChild(gc.spawn);b.setupDir(-b.x32+d.x32,-b.y32+d.y32);b.setupSpellIMG()}else g.paypal(q);X(b.id)},Id=function(b,c,d,e,f){return~~Math.sqrt((b-d)*(b-d)+(c-e)*(c-e))<=f},gh=function(b,c){Ma(c,b,lf)};gh.cursor=0;var lf=function(b,c){b.build||b.terrain||b.nofreeze||!nb(c)&&!c.checkMana(50,b.id,lf)||(b.freezed=1,b.stoned=1,Na(b,32*b.y32),b.stay(),ca(b,b.img,0),
b.setupChild(gc.turnStone),Rd(b.id),c.setupDir(-c.x32+b.x32,-c.y32+b.y32),c.setupSpellIMG(),na("turn%20to%20stone",c.x32,c.y32),Ha({func:Aj,data:b.id},24E4,1))},Aj=function(b){b=B[b];b.freezed=0;mb(b);b.stoned=0},hh=function(b,c){Ma(c,b,Td)},Td=function(b,c){b.health<b.maxHealth&&!b.build?(c.setupDir(b.x32-c.x32,b.y32-c.y32),C("heal",Xa(c.img)),c.setupSpellIMG(!0),c.setupINTV(Bj,b.id,0),b.addWorker(c)):c.stay()},Dj=function(){Ma(list,obj,Cj)},Cj=function(){},Bj=function(b,c){c=B[c];var k=J[b.kingdom].values.healingRange;
na("heal",b.x32,b.y32);if(!Id(c.x32,c.y32,b.x32,b.y32,k))return ha(c.id,b,Td,b.url.move);if(nb(b)||b.checkMana(4,c.id,Td)){b.setupDir(c.x32-b.x32,c.y32-b.y32);c.health+=6;c.setupChild(gc.heal);if(c.health>=c.maxHealth)return c.health=c.maxHealth,X(c.id,1),X(b.id,1),b.stay();X(c.id,1);X(b.id,1);Sa(b,Xa(b.url.spell))}},nf=function(b,c){Ma(c,b,mf)};nf.cursor=10;var Ej=function(k,c){k=B[k];c=B[c];if(k.inventory.quit(c.id)){c=b[c.spell];k.icons==k.__proto__.icons&&(k.icons=k.icons.slice(0));k.icons.put(c);
var d=k.icons;d.olegal||(d.olegal={});d.olegal[c.id]=1;X(k.id)}},of=function(b,c){var k=c[1];c=B[c[0]];B[b].nopotion||B[b].build||(ha(b,c,Fj,c.url.move),c.actionItem=k)};of.item=1;var Fj=function(b,c){var d=B[c.actionItem];c.actionItem=void 0;d.attack&&(b.attack+=d.attack);d.defence&&(b.defence+=d.defence);d.mana&&(b.mana||(b.mana=0,b.manaMax=0,b.update?b.update.push("mana","manaSpeed",1E3):b.update=["mana","manaSpeed",1E3],Ha({func:Ng,data:[b.id,"mana","manaSpeed",1E3]},1E3,1)),b.manaMax+=d.mana,
b.mana+=d.mana);d.level&&(b.level||(b.level=0),b.level+=d.level);na("bless",b.x32,b.y32);c.inventory.quit(d.id);c.stay55();X(c.id);X(b.id)};of.cursor=10;hh.cursor=10;bf.cursor=10;df.cursor=10;ff.cursor=10;var jh=function(b,c){Ma(c,b,ih)};jh.cursor=1;var ih=function(b,c){if(b.isSpy&&b==c)c.stay55();else if(nb(c)||c.checkMana(90,b.id,ih))c.setupDir(-c.x32+b.x32,-c.y32+b.y32),ca(c,c.url.attack,1),Ha({func:Gj,data:[b,c]},Xa(c.img)-25,1)},Gj=function(k){var c=k[1];k=k[0];k.die(1);var d=k.rbase().write;
d(c.x32+c.y32*H,c.radix);c.x32=k.x32;c.y32=k.y32;c.d=k.d;c.name=c.name;c.attack=k.attack;c.defence=k.defence;c.update=c.update;c.mana=0;c.manaMax=c.manaMax;d(c.x32+c.y32*H,c.id);Na(c,32*c.y32);c.__proto__=k.__proto__;ca(c,c.url.idle);d=k.icons.slice(0);d.quit(b.menuBuilds);d.quit(b.menuBuilds1);d.quit(b.menuBuilds2);d.put(b.impersonate);d.put(b.revealSelf);c.icons=d;c.spy||(c.spy=c.kingdom);c.kingdom!==k.kingdom&&c.changeKingdom(k.kingdom);c.setupChild(gc.impersonate);X(c.id)},Hj=function(b){b=B[b];
if(b.spy){var c=A[2];b.attack=c.attack;b.defence=c.defence;b.__proto__=c;b.icons=c.icons;b.kingdom!==b.spy?b.changeKingdom(b.spy):b.stay();ca(b,b.url.idle);X(b.id);b.spy=void 0}};nf.allowPos=1;var mf=function(b,c){if(b.id){var d=b.id,k=b.x32;b=b.y32}else d=-b,k=b%H,b=~~(b/H);if(nb(c)||c.checkMana(60,d,mf)){c.setupDir(-c.x32+k,-c.y32+b);c.setupSpellIMG();d=8;k-=.5*d;b-=.5*d;var f=[];d+=1;var g=d*d;na("bless",c.x32,c.y32);for(c=0;c<g;c++)for(var m=1;3>m;m++){var l=B[(0,pf[m])(c%d+k+(~~(c/d)+b)*H)];
l.build||l.terrain||(l.setupChild(gc.bless),l.blessed||(l.blessed=1,l.attack+=5,X(l.id,1),f.put(l)))}Ha({func:Ij,data:f},3E4,1)}},Ma=function(b,c,d){if(b[1]&&B[b[1]].item){var k=b[1];b.length--;Ye(b,c,d);B[b[0]].actionItem=k}else Ye(b,c,d)},nb=function(b){var c=b.actionItem;if(!c)return!1;c=B[c];c.attack&&(c.attack--,0===c.attack&&(b.inventory.quit(c.id),X(b.id)));return!0},Ij=function(b){for(var c=0,d=b.length;c<d;c++){var k=b[c];k.blessed=void 0;k.attack-=5;X(k.id,1)}},kh=function(b,c){Ma(c,b,qf)};
kh.cursor=10;var qf=function(b,c){b.freezed||!nb(c)&&!c.checkMana(50,b.id,qf)?c.stay55():(c.setupDir(-c.x32+b.x32,-c.y32+b.y32),b!==c&&c.setupSpellIMG(),na("invisible",b.x32,b.y32),b.invisible||(b.invisible=1,b.stay()),X(b.id),Ha({func:ad,data:b.id},5E4,1))},ad=function(b){b=B[b];b.death||(b.invisible=void 0,mb(b),Qi(b))},lh=function(b,c){Ma(c,b,rf)};lh.cursor=0;var rf=function(b,c){if(nb(c)||c.checkMana(50,b.id,rf))c.setupDir(-c.x32+b.x32,-c.y32+b.y32),c.setupSpellIMG(),na("lightning",c.x32,c.y32),
b.damage(50,c)},tf=function(b,c){Ma(c,b,sf)};tf.cursor=0;tf.noObj=1;var sf=function(b,c){var d=H;if(b.id){var k=b.id,f=b.x32;b=b.y32}else k=-b,f=b%d,b=~~(b/d);if(nb(c)||c.checkMana(50,k,sf)){c.setupDir(-c.x32+f,-c.y32+b);c.setupSpellIMG();na("flame%20ball",f,b);var g=f-c.x32,m=b-c.y32,l=Math.sqrt(g*g+m*m);g/=l;m/=l;var h=c.x32+.5,n=c.y32+.5;k=[];f=[];var p=0;for(b=0;b<l;b++){var t=h+g*b;var r=n+m*b;f.put(t);f.put(r);t=~~t;r=~~r;k[p++]=t+r*d;k[p++]=~~(t+m)+~~(r+g)*d;k[p++]=~~(t-m)+~~(r-g)*d}for(b=
0;b<0*k.length;b++)g=k[b]%d,m=~~(k[b]/d),l=Object.assign({},Ud.food),l.x32=g,l.y32=m,l.z32=2,Vd.new(l,5E3);Ha({func:mh,data:{list:k,anim:f,i:2,a:c}},1E3,1)}},nh=function(b,c){Ma(c,b,Wd)};nh.cursor=10;var Wd=function(b,c){c.setupDir(-c.x32+b.x32,-c.y32+b.y32);c.setupSpellIMG(!0);c.setupINTV(sm,b.id,0);b.addWorker(c)},sm=function(b,c){c=B[c];if(!Id(c.x32,c.y32,b.x32,b.y32,J[b.kingdom].values.teachDistance))return ha(c.id,b,Wd,b.url.move);if(c.level>=b.level)return b.stay();if(nb(b)||b.checkMana(10,
c.id,Wd))na("teach",b.x32,b.y32),b.setupDir(c.x32-b.x32,c.y32-b.y32),c.setupChild(gc.curse,!1,hm),dh(c,!1),X(c.id,1),X(b.id,1),Sa(b,Xa(b.url.spell))},vf=function(b,c){Ma(c,b,uf)};vf.cursor=0;vf.noObj=1;var uf=function(b,c){var d=H;if(b.id){var k=b.id,f=b.x32;b=b.y32}else k=-b,f=b%d,b=~~(b/d);if(nb(c)||c.checkMana(70,k,uf)){c.setupDir(-c.x32+f,-c.y32+b);c.setupSpellIMG();k=f;var g=b;f-=8;b-=8;for(var m=0;256>m;m++){var l=f+m%16,h=~~(m/16)+b,n=l+h*d;fa(l,h)&&64>=Math.pow(l-k,2)+Math.pow(h-g,2)&&oh[n]&&
0===Z[xy]&&(C(l,h),new Zc(60,c.kingdom,l,h,0))}}},mh=function(b){var c=b.list,d=b.anim,k=b.i,f=b.a,g={x32:d[2*k],y32:d[2*k+1],d:0,img:l.flame_trail,mv:1,z32:2,alpha:!0};Vd.new(g,Xa(g.img));for(g=0;3>g;g++){var m=B[Z[c[g+3*k]]];m.health&&m.damage(96,f)}b.i++;b.i<.5*d.length&&Ha({func:mh,data:b},50,1)},xf=function(b,c){Ma(c,b,wf)};xf.cursor=0;xf.noObj=1;var wf=function(b,c){if(b.id){var d=b.id,k=b.x32;b=b.y32}else d=-b,k=b%H,b=~~(b/H);if(nb(c)||c.checkMana(60,d,wf))c.setupDir(-c.x32+k,-c.y32+b),c.setupSpellIMG(),
na("freeze",k,b),Ha({func:Jj,data:[k,b]},1E3,1)},zf=function(b,c){Ma(c,b,yf)};zf.cursor=0;zf.noObj=1;var yf=function(b,c){if(b.id){var d=b.id,k=b.x32;b=b.y32}else d=-b,k=b%H,b=~~(b/H);if(nb(c)||c.checkMana(70,d,yf)){c.setupDir(-c.x32+k,-c.y32+b);c.setupSpellIMG();na("confusion",k,b);c=4;k-=.5*c;b-=.5*c;d=H;var f=[];c+=1;for(var g=c*c,m=0;m<g;m++)for(var l=1;3>l;l++){var h=B[(0,pf[l])(m%c+k+(~~(m/c)+b)*d)];h.build||h.terrain||h.stoned||(h.confused=1,h.invisible&&ad(h),h.stay(),f.put(h),Rd(h.id))}g&&
1===Q.length&&X(Q[0]);f.length&&Ha({func:Kj,data:f},2E4,1)}},Kj=function(b){for(var c=0,d=b.length;c<d;c++){var k=b[c];k.confused=void 0;k.death||(ca(k,k.img,1),mb(k),k.stay(),db==k&&(db=void 0,Q[0]=k.id,X(k.id)))}},Jj=function(b){var c=6,d=b[0]-.5*c,k=b[1]-.5*c,f=H,g=[];c+=1;var m=c*c;b={img:l.freeze_expl,d:0,mv:1,x32:b[0],y32:b[1]};Vd.new(b,Xa(b.img));for(var q=0;q<m;q++)for(var h=1;3>h;h++)b=B[(0,pf[h])(q%c+d+(~~(q/c)+k)*f)],b.build||b.terrain||b.nofreeze||b.stoned||(b.freezed=1,Na(b,32*b.y32),
b.stay(),ca(b,b.img,0),b.invisible&&ad(b),b.health-=40,1>b.health&&(b.health=1),g.put(b),Rd(b.id));m&&1===Q.length&&X(Q[0]);Ha({func:Lj,data:g},2E4,1)},Lj=function(b){for(var c=0,d=b.length;c<d;c++){var k=b[c];k.freezed=void 0;k.death||(ca(k,k.img,1),mb(k),db==k&&(db=void 0,Q[0]=k.id,X(k.id)))}},Bf=function(b,c){Ma(c,b,Af)};Bf.cursor=0;Bf.noObj=1;var Af=function(b,c){if(b.id){var d=b.id,k=b.x32;b=b.y32}else d=-b,k=b%H,b=~~(b/H);if(nb(c)||c.checkMana(100,d,Af))c.setupDir(-c.x32+k,-c.y32+b),c.setupSpellIMG(),
ph(k,b,3,20,4500,c.id)},ph=function(b,c,d,e,f,g){for(var k=l.fire_rain,q=r.gravity,h=Date.now(),n=ph.rnd,p=Math.PI,t=performance.now(),v=0;v<e;v++){var x=2*n()*p,y=d*n(),A=b+y*Math.cos(x);x=c+y*Math.sin(x);y=~~(v/e*f);fa(A,x)&&Ha({func:Mj,data:{x32:A,y32:x-6,dix:0,diy:140,img:k,mv:1,d:0,timestamp:h,finnish:Infinity,aceleration:q,attack:40,xf:A,yf:x,range:2,kingdom:0,obj:g,crashTime:(Math.sqrt(19600+384*q)-140)/q*1E3}},y,1)}C(performance.now()-t)},Mj=function(b){Ha({func:Xe,data:b},b.crashTime,1)};
ph.rnd=function(){var b=4096,c=2048;return function(){c=36969*(c&65535)+(c>>16)&4294967295;b=18E3*(b&65535)+(b>>16)&4294967295;return((c<<16)+b&4294967295)/4294967296+.5}}();var La=function(b){Xd(-1E4,0,0,b);tm.put(b)},Zg=function(b){if(b=b.childLoc)for(var c=0,d=b.length;c<d;c++)La(b[c])},wj=function(b){B[b.obj].damage(b.attack,B[b.obj]);La(b.bufferID)},Nj=function(b){b=B[b];void 0!=b.bufferID&&La(b.bufferID);oh[b.x32+b.y32*H]=void 0},Xe=function(b){var c=H,d=b.xf,e=b.yf,k=b.attack;b.mv=1;b.func=
void 0;b.x32=d;b.y32=e;Jb(b,0,0,0);Na(b,2);d=~~d;e=~~e;var g=d+e*c,m=Z[g];kc[g]?(b.img=l.expl_small_water,na("water%blop",b.x32,b.y32)):(b.img=l.expl_small_hole,na("small%20explosion",b.x32,b.y32));ca(b,b.img,1);Vd.new(b,Oj(Db[b.img]));if(kc[g]){if(m=lb[g],2<m){var q=B[m];q.damage(k,B[b.obj])}}else{2<m&&(q=B[m],q.damage(k,B[b.obj]));g=b.range;m=2*g+1;for(var h=0,n=m*m;h<n;h++){q=h%m-g;var p=~~(h/m)-g,t=~~Math.sqrt(q*q+p*p);t<g&&(q+=d,p+=e,q=Z[q+p*c],2<q&&(q=B[q],q.damage(k*(1-t/g),B[b.obj])))}}},
um=function(b){if(0<Q.length){var c=B[Q[0]],d=0,e=0,k=0,g=0;void 0!==c.dix&&(b=.001*(b-c.timestamp),g=c.dix,k=c.diy,d=g*b,e=k*b);if(c.space){var m=c.space;b=m[m.length-1];m=(m.length-1)/b}else m=b=1;d+=32*(c.x32+.5*b-Math.sign(g))+.5*-tzar.width+.5;e+=32*(c.y32+.5*m-Math.sign(k))+.5*-tzar.height+.5;Ta=~~-d;ya=~~-e;cd(-Ta,-ya)}},Pj=function(){};Td.distance="healingRange";af.distance="createGolemRange";mf.distance="blessDistance";wf.distance="freezeDistance";yf.distance="confusionDistance";qf.distance=
"invisibilityDistance";rf.distance="lightningDistance";ef.distance="createBatDistance";cf.distance="createDragonDistance";jf.distance="createCarpetDistance";gf.distance="createJinnDistance";lf.distance="turnToStoneDistance";sf.distance="flameBoltDistance";Af.distance="fireRainDistance";uf.distance="freezeDistance";Wd.distance="teachDistance";var J=[];var Ec=function(b,c,d,e,f,g,m){this.name=b;this.k=J.length;g||(g=[0,0,0,0]);this.color=c;this.status="";this.stats={dmgInflicted:0,dmgTaken:0,resources:[0,
0,0,0],score:0,unitsKilled:0,unitsLosed:0,buildsLosed:0,buildsDestroyed:0,unitCount:new Uint32Array(A.length),unitCountMax:new Uint32Array(A.length),unitCountDeath:new Uint32Array(A.length),goldTraded:0,goldConverted:0,stoneTraded:0};this.team=m;this.resources=g||[5E4,5E4,5E4,5E4];this.values={gold:10,wood:10,food:10,stone:10,buildSpeed:1,experience:0,healthJump:0,maxLevel:4,pop:0,popMax:r.freePop||1,popLimit:200,healingRange:1,blessDistance:9,createGolemRange:5,freezeDistance:13,invisibilityDistance:9,
createBatDistance:16,lightningDistance:12,createDragonDistance:4,turnToStoneDistance:21,flameBoltDistance:19,fameTech:0,confusionDistance:13,manaSpeed:2,milkSpeed:2,cowSpeed:2,stealCow:0,miningPerf:1,fireRainDistance:15,createCarpetDistance:3,createJinnDistance:3,teachDistance:2};this.race=e;this.racestr=Qj[e];this.IA=f||0;this.building=[];this.diplomacy=d;this.control={};this.control[this.k]=1;this.onFreePop=[];b=[];b.length0function=vm;this.unitLoading=0;this.target=[0,0,0,0];this.crusade={number:0,
list:b};this.technology={hidden:{},disabled:{},actived:{},investigated:{}};this.mod=b=[];wm[this.racestr]++;c=0;for(d=A.length;c<d;b[c++]={});J[J.length]=this;c=this.k;b=[];Ub[c]={};sa[c]=b;for(c=0;c<A.length;c++)b[c]=[]};Ec.prototype.setupResources=function(b,c){var d=this.resources;c||(c=1);d[0]-=b[0]*c;d[1]-=b[1]*c;d[2]-=b[2]*c;d[3]-=b[3]*c;v.setupResources(-b[0]*c,-b[1]*c,-b[2]*c,-b[3]*c,d.k);$e(this.k)};var sa=[];var Ub=[];Ec.prototype.check=function(){if(this.values.pop)return!0;for(var b=xm,
c=sa[this.k],d=0,e=A.length;d<e;d++)if(!b[d]&&0<c[d].length)return!0;this.die()};Ec.prototype.checkPopArray=function(){if(this.onFreePop.length)for(;!Jd(this.onFreePop.shift())&&this.onFreePop.length;);};Ec.prototype.die=function(){this.death||(this.death=1,this.status="defeated",qh(),Tb(rh(t.playerDefeated,this.name),0,5))};Ec.prototype.paypal=function(b){var c=this.resources,d=!1,e=this.k;c[0]<b[0]&&(Cf(e,t.gold),d=!0);c[1]<b[1]&&(Cf(e,t.wood),d=!0);c[2]<b[2]&&(Cf(e,t.food),d=!0);c[3]<b[3]&&(Cf(e,
t.stone),d=!0);if(d)return d;c[0]-=b[0];c[1]-=b[1];c[2]-=b[2];c[3]-=b[3];v.setupResources(b[0],b[1],b[2],b[3],e.k);$e(this.k)};Ec.prototype.paypalTest=function(b){var c=this.resources;return b[0]>c[0]||b[1]>c[1]||b[2]>c[2]||b[3]>c[3]?!1:!0};var Cf=function(b,c){b==y.kingdom&&Tb(rh(t.notEnough,c),0,5)},$e=function(b,c,d,e){b==Math.pow(2,31)-1&&(b="***");c==Math.pow(2,31)-1&&(c="***");d==Math.pow(2,31)-1&&(d="***");e==Math.pow(2,31)-1&&(e="***");Rj.innerHTML=b;Sj.innerHTML=c;Tj.innerHTML=d;Uj.innerHTML=
e},xm={13:1,20:1,21:1,22:1,27:1,32:1,35:1,36:1,43:1,44:1,55:1,56:1,57:1},fj;var Vj=[];(function(){var b="",c=new Image;c.src="data:image/gif;base64,R0lGODlhIQB2AfcAAAAAABAIAAgAABEhACE6ABkbChAQAAgIABAQCO/vlN7epf/6hZSQUv76n721a//rY/XmhnNjECklEP7oecW1Y+7ZeP/rhvvrljEpCCgiB+/Wa97OjP/WSu3YhyEZAIhzLf/WWOnHWv7baL2lVt3Db/vsvUo3BGtSCGhVIdq1SnhjKdy4V62USuvIaPzad/felO/XlzopAGtaMe3Kd/zbiOjMhv/9+JxzGWNKECEZCP/JSuu5Sc6lSMynV4tzPdSyaK2UWjEhADopCNacKWNKGVdCGf/IVuu4VruUSPzJZ7qYU0IqABkQAGdFB2tKEFI6D5tzKMqVN9unSNyrVlRDI/nLd7JwACkZAOaUEDEhCMSMMZRrKYlkJ/u3SJt0M8yYRquDQO66Zu3MlrWcc5haAItSAf+lGUIqCGNCEJdjGXpTGJxrIfisOGtKGcSNOtacQruHOfu6VsiYVOm6dPvLh/rZqTohAHdHB3NKEFo6D0kxEJRjIc6MMalzKYRaIZxrKXlTIuCcP6x5M+umR1I6GX5aKdacSuqqVdedUollNK2HVUopAFQxBXtKEGtCEMmBJ7h2J3NKGdeNNMOCMWNBGZRjKf2rR86MOtaUQpdpMt6cSrqFQkk0GnVWL9OjZolVGeeQLJ5jIKdqJ4xaIeCTObd6NembRt6UQsWEPGlHIf+tUsuMQ9aUSppyRzEZAGU1BkopCHNCEDohCFIxECkZCPeXM3tKGdKDMIRSIZxjKlo6Gc6EOoxaKahwNt6USjUkE/zLmUIgACEQAIZLEtZ2H5ZUF2Y6ELlpIN9/KGtBGUUpEHVKIRkQCNaMRntCEHNCGZdZI86MUjoZAFQoBs5qIF0xECUZEE8hAHQ0CIQ9C5RHD65TFb5cGXY6EDEZCHtCGYRKIVIxGSkQAEohCEIfCVIpEKJEEUUpGWgnBzoZCEIzKzEQABkIAHMpCIw0CyEQCFsZAlEZBikQCDQZECEHAD4PATEQCGshEDEIAPNGKRkAABAAABkICBAICAgICP///yH5BAEAAP8ALAAAAAAhAHYBAAj/AP8JHEiwIEEBBhMqXPiP3QGEAwVAZKgQYoBwLAIMpIUCwESKE5lI/CeA0woU+wTSIvHk40IBD/9x+vHrnYB9+358EbdPwDsavfi5NMiEChcA/5i0QIKrzTsANeQoC+DzAhJvKYcK3AeoAheqAlbo0XNGlpIKR5axEyChwwo/U7UK+EWiAxRdgH5RGnWpD6ArwpCUWlaES40WX0pRompQwIcXLbR8ObKi1BdUcXatMsZuFCUuUtxKidLr11ABT5Ag+tIHjK5MYb5UilPqlK0rVwKkmiJFyyVBpgsyCRCAEpIvyubJC4CkCq9Rh3JhqiRSAJQvcPgIUgaTIIofMvL8/5hCKwfEHmEiDcq0CtosdklHjeoDaSpSgQKoWGjRowMYWh4JlEgYm4wyhR+buaKLAEwoQ4gfs9CikUBM/OBWCytEAuBESIThhyZbVGILOU+QJEAOhFBCyy/44QDDDFKsgJwwqRA0oBejiBJJMmecYSIAOSxjjzf4jeLCFNi9ocxugAyk3hSVhIILGmd4U6KJ77yTAzu/cMIOZXBQ4gcsRXyRhB4CPXEJHT2U4kUyeggzS0QCABAAHD0koUIP/HkjzwH/+ODCFz7qUQoNM3zBVB5X+GjQLGBQtkIHSTxDXAB5wGFBGEUUcUsVF8SWSzJZyJLQTZUc0cIMK7ghhAAZ/P9DySAWuBCHKYdcMMMUgkQSZxGnyiPFF27wIAUX9hgQQBu4DOKCrVLQUMURboySBxNonurFCmn4UYoWfsiT0l6TDBLHIWGEgeQfaAQhREXhrADHLLrgIsgswgiURySiuCEFK4dg4oYoz5yhlUDiRCEFJfZk0UYeNgkkizGfiCJKKajAkYstswTQpEKzVsIOO+Rk4Y1IAglzRh7OQFOKIKF8wmgWClHVhyRFBOARLbRMxI4wsDgSSh99jJKMLKfNxY4abgiii851fiQAO64Yc4woebiCckE5qFCFEnB8IcUWv2zdmDDDSCMRg40RIkgILVAmxRPvTJjQPuwA4FG+pzL/w8UkYGCXzC8BJkSVnSBloYssnMxSsgEHU2RQFjoH4I0wkUuuEAB4Z655RZ8rVAIgzIQeehx0RMKE6Z9XkcQspbNOESZ0xAG77BQFAoztseOukO6WlNO77waZUocls+RAvEKHHJ/88gk1X4sxtEBvUBh1sGGM8tYTNIgNtXzC/T9kVA99IOA/f0cJtYxPPB82gHLHP03QYAU93fOBzDE5bGLKK90byB1I4Q3zdS8PjGhCCaxgQOjdwQZWMAMtzIAFmlmPBmzIAiX+8YohlKEM81teGXg2kDLYgAZkCOBAmlCLWtxHhf/4IAxnSMMa2vCGOMyhDnfIwx768B82QEMN/2dgg3fN0BNhsAERZtgKRMDABsaYISvCAIMSPINIAczEEeRQhxK8woLWe8UOLrGCElzAFukIIB+O8IgpXGAOr0hHH6yXiyQkRgwwSMIdvGGx5anBCFNYhSjmMIcj3MAbgIDE8jQRBkQIYg3j2YEUZBELLRAPCUk4hBy4kAs5wEFh8nDEG6KAuyZkcgpwaEQvFCGIK3jjDIx4xA5wd4QjBPITjviDMITBjiysCAMvDF0f4iCFUkBDDx6QhTVmIY/CyY4eSZACKi5BjgA0QgtbkEUDZReFHexAHOKoRAPC0IZXLm8ZIBCHzvTgiVKlwhrLO4cx9oEUAGSAFnKYAhf6of9CABxAEDtIhCxMAMMA7OEMPSiGGmDIiDF0AAnQgOEBQFEDRgSzeyYoBqZ+yNGOevSjIA2pSAVygic0gXVLkFwT3BGPeIQOHYx4wkUL0gRzcCMe2KiH5tCBDnfo7R/kUIg79hcPdLhUcuiwqUvrwQiDtJQatQiEOdxBAKQO9RgR6GlCpsENZOgAGdxoRzAo8tSoTpUA7RhIPYo6VB3ooAuSaCpFuOpVsLZDrsFohzt4So0u6MAIICjGWBligra+Na7uYEQw3OGOf5iAG2z46wOksA10UAQdff1rYBlbD3MU4x/40EYtACuCB1SWIo+NrBEmy9MMcIMa7sAHPh6hAxD/GIEDoOAGNggrWtKaFh3C2AYoGCvbY7CBDaAgRjF2S9ha1Pa2oMgGPhhRC9hqY6/aSC4xZMHchZgAG9g4bnKLEQ/hgsIc1KCGOeqhjW6wFJwUwYY7skuM7b5iG1A9BlSJgQ5yoMMY2CiA5kyAjm24Nx5LcAc12BAIZBx3G8HARgbEEVTJYWMc4/gvNmiBDmKAQge1YEMXkGEOciDucxgex4QZUY/6dsEIx60FMnA3DmwwIwCMYIQ5zEGMOOiADSGuMOsC8F1s5HjHo+1CLUABCuIFYLc7tikpunAL4Q4Deozdhja2wQ1zwOMRw7gy8eABj20Uoxxchgc5lKGM5cGj/7NnCEA3wgqAJaQUeu2gypPRUY9pbMN6AchCBhAQjAybo3tkzkA83lEAIXcvB9gQRwGkMdJKW/rSBlHGDFhHAxZRJAdV2PTnfhCGbSbkHZqgQRg0hwgXaMLTDBEGL1ywK4qsIgxJyISpDSKMZEBCD0VIxEIooQxvbCMZuy6IN6YSgGQPJAuY24ezB+IndsDCCFFUSB6mAIt3sAOLmnsGJXRBhSIAQhB9EIUXEkGIZETI0Zr7hS5IMYELXKABF6hAC5JwhC+0wZes08UXBpEEC1igAQ2oVRICAYdKKAPeklvGwI0wgYM3YAJJiMMb4MALPUw7Ictwg7lEgHFTTCEJYf9wQy9SUZOA/yEQcQDBD/KRD3f4AA598MMTaPEO1inDW4OwRCvu4Y56qAMQe2iDMnIgD9Z5IxJ9MIUlOsGJeajj6J/QxS+Y8XGD0IISezhFF7rwB3VQAQqTiESEEADuz3ljFkDvgghEYIRBKGbpzADj52ThsJfL3QVGOAIXnpAFZuRddjl4Ai5IYQkjiICYfvA4M3ouO1n8IhKCGIQRkmCJLwBi6c32nTcI0Qdz1V0QRaBc1xkiC13AwQinJwQz2o67TCjDGKUwRR+MUQ0JWO8Qn3+HhNjxiVNA7xBfqIaQx5EHTKyCeGCYAiXSSJB08IIUgsBdKwyBC9oLRBm5sLv/7MCQiDYrJBWtyASm189+9tvBDq4QBwyfMApW9CEZ7EhJ98Cwik3EYRKrYFHdkwhV8AW4kASiYAqRMDLWIwc0gAu2cAi4oAm84DmjVgV5IIHNMApnMFOy4zWbAAiH8AyowAj0MCfQowRzEAmHUAi84AhXQFCycyUCUgWZgAu5gAbGcAWuIDtEcAjAIhDJcAg/wAuVoAbV4ArsIIOh8wRy4AJBIBBnsAoX8AOb4AXGEAz7YCqs4wMQgAhX8A9nUAoXQANToARqwAhUIzsmsAoJEAZjsQs00AAFWAnGsEu4kwdxkAATcASkEAYNoGqCEAvBIADZYjqUoAaHAAEYlyuq/2aAsCAAjsI6eTAKbnAIKFcFVRAGhvAHeSAMYYg7JuAIorAKU4AIYcAKXyAKO+iBnyMOjKAGfyAKvVAKm5ALjhAMAPAxuLMP0jANxjAMgiAI0OAIsPAzy+MRrjANwwAN0MB74uCKoaM3+jANxVAMdrAW0mg6nPMK9KA3zgQ9HgGOdmM94LiN7ZeO6riO7HhpvdALgJAKNdI9QFAKq7AKqggGhQBrvvMDM2AKvsAK94gKm5AJ50A8PwADdBAGAMkKqECQmyAInOA7JFACM3AIhzAIlXBurLAJBTmRsvMDJVADh7ADEPACiZAKuXePnYA7P2ADdRAGgzAHNqAA35AKnP+QCJ1ABbjDRSUQBhipATZwBLkAADc2ALgDBh1AA3FzBKkQAhuwCalQjrKDCPl2BILgD9TQC60QDa0gYL6TCj/QAodwDgDACZsADK3ADAiwPKmQCVQQO5nQCe/Qb9XglsFEBb9QBz8gCLYAQ79ABXy5ChukQr/QCTDgCaUQDoBJBWLgCZkAkgH0C4nwmJnAmIbZCmIgB51AldDzC62gCOqQAZ65PL/wCwdAHDN0Ke3Ymq75mrAZm7ApmbhDmwSRCqdQmOFgfp9DCKigC5kGCKUADsogAnCFmQwRB3GgBxeDC6aWBctwBtzwAA1gCZFAEV0wAQ1wDNWQDJRnEAeQBZD/YAkuUJ28aRCWUHGWgAzCoHeZJgi7kJ4NcAsKUQsNIAKmIAmiAJwMkQOUwC+3cAQQkAwGkQsL0AWQMArQoCGSkwM8MwvVMAu+QhCzoAbdMA16oE3uwzq4EAeqcJ7W06ElIALQAKLLE4E0cAvpUJq+MwtWMw4BsDoq9A4ZyqIU8XV/UAqScJ9GwIsDMQopQAKBMAkv0waHyDX+VApJUAITEAi8gJwDoQzHcAQlQAeDwAVTYaL/ACBMcABwMAinIApQShCyAAldkACJEAAHACQJoQx/gAzKcABuUApaOhDGIAnHAADdoA0kVBCzIAmWwAbcAADLkAx1+n1/wAS/wAeg/0ANBaEMcKAKpoAJnZAFAKAHhzoQyaAzlPAFpkAKkGBBunEJojALT2GUR6oQlKM3utALl0CnysMMB7AM5sMzY7oQv2A+DqML72B+zMCPxMMJB7B6slmsxnqsyNqO+0AfvoMOxcANxIAMknALx9AHoHgEgzAIxxA6jNAIj0AKRxCI0hIGkjAM7JAG5UmHpvA5mNMIXeAGaeAIS3AF4tAEWfMIoGAEFjcDbyA5IoEbxMEOTMAEAssEwuAEofAIjyAJSfAsUyA5+ReF//AJgjAJdwaKrrAIefAKd3AHogAH/fo5dyAGJWAJ1BAD/yAM4mAHMWAHgLFLBksRFisQV0ADSf8wCKGwCLgzCW/AB4GABsPxD3aQbq/wCnbwOVwABsYyAzRgK4MQBIUDGOIgo/8AB1uABqJAgwQhDksjBWFQBS5QBVGAOaIACYvwBGcQA4wgCF57CHFACqJwZwkBAMGwDccACX2xD0EgCpJgBC5gAWVYBdIyGsVAD/LHEPtwDdjwCX2wFsWQBpCgsNN6CZOQBp8QC9JwBVTLEAHADoygM0zgCuswDdfAU9LQE5wTDD34OewQAK6gfzPEN8k6u7Rbu7Z7u7ibu5rTB+LAhSr0LNPAN4VgqbuoBJ+FOyKwAq9gCAYXBqUwAxVAAz8wDdhwvKxTDCFgAUlwb67TAmEwA47/kA2LKzsNsABJAHtx0AWB0AMkQAl5EwvOwDoJB3tG0AWDQApTAAaYQxw/FTrl6wIZ1wWgQAqIsARrozcWWBAAbARxMAiSgAibsL/nKDthgK2kgAmIYAwSoY11gjtTsAluoAmlQBX0cAYqEBO+AwdKoASMIBH0Cgap4AqhiDtKoAiuQBUHgAcqsAAO0AEMQDxMIA514hEBIAwU8ASfcAUJ/DlXUAFPYLfXsBYBdAbbUAWmEAoC2D2u8AoAPAmfIMXdIwClUAWaAA0trEKycAhVAAmOgDkBZAe4EAY/8AmRqEJnAAdzIAiOcMMqxAhfMAqzQDl2nMRqaqO4kxtLrLuK/7zIjBxSsLAIROIEgMkCUqAOUDANAbQFH8ACK+ACbfAJAqEGLLBQvpMBbbACK9AFXOAov7ADR+s7A5ACPAACg2ALRiQNtHANy+MNn5AMsMAEJ2UQetAGbcAIsAAFn0MLJsAOdiBXBgEASAAIPdAK5ODMC+EIjjANWSACSDEWZSEQX0ACYcADK2AIMkIR2VAEKwA0D8AEe9EXfyEMAGAMSRACIdArM7wQAXAEI8AFM9AGXnAZmbEZ7JC8UoAEUfAJqWo4gGABSqABI6AHmyAbtGEbuNEHe4AHdWYQd2DCjKAJLoAEIr0CUiAFhFAERQgd0kEd7CAPApBsDDABLSAA5P/gLCtAGVPwB0TgA+mxHu3xHuxwDbsGAJsQAl2gN8swCFMgKVJgDHpAIAaCIMagIAshDVzQBVpwAFywADCCylOQCZSgB53gISAiIiTCEOGgN1CgBUUbBVGgDFygBt7wDlwQBjiiIzwyiQnxCgLACK7gCrvIBYSwCUXwBHP9JFEyJVWitQzRD81w0mYyFkygJmziJnAiJ5rzCrLwDD4hKIQyD4aCKIqCC4yi1wvxCvQkDrSQKZvSKZ8SKl8wKqXCOgbgDbNSK7eSK7vSK7/CED4ABipQEMziLNAiLdRiLdiyEMxwBF1gouRiLuiiLl/ALu6yENOQCG0ACwmxL/3yLwFJMzAFkzmguBATUzEXkzEb0zE+yjoqwzIuAzMycwXuyTo/EzRDUzRHk8gVQTVWgzVao98vgTZqIxGbuzx4g8CyC2h1YsiN/DkBAQA7";
var d=document.createElement("canvas"),e=d.getContext("2d");c.onload=function(){d.width=33;d.height=34;for(var k=0;11>k;k++)e.drawImage(c,0,34*k,33,34,0,0,33,34),Vj[k]=d.toDataURL("image/png"),b+=".ncursor"+k+"{cursor:url('"+Vj[k]+"'), default}",e.clearRect(0,0,33,34);document.getElementsByTagName("style")[0].innerHTML=b};Pd(2)})();var lc,mc,dd,nc,Fc,qa,Yd,sb,Oa,sh,Wj,Xj,ra,Zd,Rj,Sj,Tj,Uj,Yj,oc,ed=function(){p("mgitem").style.backgroundPositionY=-48*v.mwicon()+"px";p("mgamount").innerHTML=v.amount()},
Df=function(){if(!Df.setup){Df.setup=!0;p("content").innerHTML='\n<ul id="msgs1"></ul>\n<div id="clicks" style="display:none;margin-top:0;margin-left:151px"></div>\n\n<div id="playersinfo"></div>\n<div id="resources" style="display:block">\n<div id="gold"></div>\n<div id="wood"></div>\n<div id="food"></div>\n<div id="stone"></div>\n<div id="pop"></div>\n<div id="temperature"></div>\n</div>\n<div id="enterwindow" class="displaynone">\n<h2 id="sendMessageH2">'+t.chatMsg+'</h2>\n<input id="msginputGame" />\n</div>\n\n<div id="statButton"></div>\n<div id="topinfo"></div>\n<div id="bottominfo"></div>\n<div id="mapeditorinfo">\n<div id="sButtons"><button id="selectUnits">'+
t.units+'</button><button id="selectBuilds">'+t.builds+'</button><button id="selectItems">'+t.items+'</button><button id="selectNature">'+t.nature+'</button></div>\n<div id="mapeditorinfoUnits"></div>\n<div id="mapeditorinfoBuilds" style="display:none"></div>\n<div id="mapeditorinfoItems" style="display:none"></div>\n<div id="mapeditorinfoNature" style="display:none"></div>\n</div>\n<div id="mapeditorinfotop">\n<button id="menueditor">'+t.menu+'</button>\n<button id="deleteUnit" style="color:#f00;font-weight:bold;font-size:19px">x</button>\n<button id="rotatebutton"></button>\n<button id="mapProps">'+
t.options+'</button>\n<button id="mapRules">'+t.rules+'</button>\n<span>Brush size: </span><input type="number" min="1" max="256" value="6" id="brushSize"/>\n<span>Active kingdom</span>\n<select id="selectKingdom">\n</select>\n</div>\n<div id="minimap" style="position:absolute;top:31px;left:4px;z-index:99"></div>\n<div id="menu" style="display:block">\n<button id="gameMenu">'+t.menu+'</button>\n<div style="width:151px;height:calc(100% - 741px);top:645px;background:url(/nehhon/menurepeat.gif) repeat" id="kingdomcolor"></div>\n<div id="daynighticon"></div>\n<div id="icons20">\n<div id="attackmenu" style="display:none"></div>\n<div id="defencemenu" style="display:none"></div>\n<div id="levelmenu" style="display:none"></div>\n<div id="manamenu" style="display:none"></div>\n<div id="manamenu1" style="display:none"></div>\n</div>\n<div id="progressvalue"></div>\n<div id="kingdom"></div>\n<div id="unitname" contenteditable="true"></div>\n<progress id="progressone" style="display:none"></progress>\n<progress id="progressmana" style="display:none" max="100"></progress>\n<input id="unitSpeed" min="1" max="100" type="range"/>\n<canvas width="48" height="48" id="selectedobject"></canvas>\n<div id="navigation">\n<button id="aleft"></button>\n<button id="stock"></button>\n<button id="aright"></button>\n</div>\n<div id="orders">\n<button id="order1"><progress class="loadingunit" style="display:none"></progress></button>\n<button id="order2"></button>\n<button id="order3"></button>\n<button id="order4"></button>\n<button id="order5"></button>\n<button id="order6"></button>\n<button id="order7"></button>\n<button id="order8"></button>\n</div>\n<div id="magicworkshopmenu" style="display:none">\n<button id="mgbook"></button>\n<button id="mgpotion"></button>\n<button id="mgsword"></button>\n<button id="mgamount"></button>\n<button id="mgitem"></button>\n<button id="mgdecline"></button>\n<button id="mgaccept"></button>\n<div id="mgbak"></div>\n</div>\n</div>\n\n\n        ';
oc=p("msgs1");ra={page:0,length:8,leftButton:p("aleft"),rightButton:p("aright"),stock:p("stock")};ra.leftButton.onclick=function(){v.changePage(-1)};lc=p("minimap");Zd=p("unitSpeed");Rj=p("gold");Sj=p("wood");Tj=p("food");Uj=p("stone");Yj=p("daynighticon");ra.rightButton.onclick=function(){v.changePage(1)};ra.displayed=[];mc=p("attackmenu");dd=p("defencemenu");nc=p("levelmenu");Fc=p("kingdom");qa=p("progressone");Yd=p("unitname");sb=p("progressvalue");p("selectedobject");p("mgbook").onclick=function(){v.mwSelect(0);
ed()};p("mgpotion").onclick=function(){v.mwSelect(1);ed()};p("mgsword").onclick=function(){v.mwSelect(2);ed()};p("mgdecline").onclick=function(){p("magicworkshopmenu").style.display="none"};p("mgitem").onmousedown=function(c){var b=1;c.button&&(b*=-1);v.mwMore(b);ed()};p("mgaccept").onclick=function(){p("magicworkshopmenu").style.display="none";v.createItems()};p("mgamount").onmousedown=function(c){var b=1;c.button&&(b=-1);Ac.shift&&(b*=5);v.mwamount(b);ed()};Oa=[p("order1"),p("order2"),p("order3"),
p("order4"),p("order5"),p("order6"),p("order7"),p("order8")];sh=p("bottominfo");for(var b=0,c=Oa.length;b<c;b++)Oa[b].addEventListener("mousedown",ym),Oa[b].addEventListener("mouseup",zm),Oa[b].ordid=b,Oa[b].addEventListener("mouseenter",Am),Oa[b].addEventListener("mouseout",Bm);p("stock").addEventListener("click",function(c){v.checkStock()});lc.addEventListener("mousedown",function(c){0==c.button?(document.addEventListener("mouseup",function g(c){document.removeEventListener("mouseup",g);document.removeEventListener("mousemove",
Ef)}),$d=!0,Ef(c),document.addEventListener("mousemove",Ef)):2==c.button&&C(999999999,44444)});Wj=[manamenu,manamenu1];Xj={mana:{background:"0px -120px",progress:progressmana},food:{background:"0px -240px"},milk:{background:"0px -280px"},gold:{background:"0px -260px"},stone:{background:"0px -320px"},wood:{background:"0px -340px"}};p("selectUnits").onclick=function(){p("mapeditorinfoUnits").style.display="block";p("mapeditorinfoBuilds").style.display="none";p("mapeditorinfoItems").style.display="none";
p("mapeditorinfoNature").style.display="none"};p("selectBuilds").onclick=function(){p("mapeditorinfoUnits").style.display="none";p("mapeditorinfoBuilds").style.display="block";p("mapeditorinfoItems").style.display="none";p("mapeditorinfoNature").style.display="none"};p("selectItems").onclick=function(){p("mapeditorinfoUnits").style.display="none";p("mapeditorinfoBuilds").style.display="none";p("mapeditorinfoItems").style.display="block";p("mapeditorinfoNature").style.display="none"};p("selectNature").onclick=
function(){p("mapeditorinfoUnits").style.display="none";p("mapeditorinfoBuilds").style.display="none";p("mapeditorinfoItems").style.display="none";p("mapeditorinfoNature").style.display="block"};p("selectKingdom").onchange=function(){y.kingdom=parseInt(this.value);var c=J[y.kingdom].color;this.style.background="rgba("+c[0]+","+c[1]+","+c[2]+",.8)"};p("mapProps").onclick=function(){p("mapPropsWindow").style.display="block";uc();if(""==p("mapPropsWindow").innerHTML){var c=document.createElement("div");
p("mapPropsWindow").appendChild(c);var b=document.createElement("table");c.appendChild(b);b=document.createElement("div");b.innerHTML=t.mapName;var k=document.createElement("input");k.value=r.name||t.strcusMap;k.id="mapName";k.type="text";c.appendChild(b);c.appendChild(k);b=document.createElement("div");b.innerHTML=t.description;k=document.createElement("textarea");k.type="text";k.value=r.description||"";k.id="mapDescription";c.appendChild(b);c.appendChild(k);b=document.createElement("div");b.innerHTML=
t.author;k=document.createElement("input");k.id="mapAuthor";k.value=r.author||"";k.type="text";c.appendChild(b);c.appendChild(k);c.appendChild(document.createElement("p"));b=document.createElement("button");b.onclick=Zj;b.innerHTML=t.close;c.appendChild(b)}th()};p("mapRules").onclick=function(){p("mapRulesWindow").style.display="block";uc();if(""==p("mapRulesWindow").innerHTML){var c=document.createElement("div");c.innerHTML='\n<div id="mapEvent">\n<h4>'+t.events+'</h4>\n<select id="eventOptions" style="display:none">\n<option value="objAction">'+
t.objAction+'</option>\n<option value="objZone">'+t.objZone+'</option>\n</select>\n<div id="eventScreen">\n</div>\n<div id="eventLayout">\n</div>\n<button id="addEvent">+</button>\n</div>\n<div id="mapActions">\n<h4>'+t.actions+'</h4>\n<select id="actionOptions" style="display:none">\n<option value="objOrder">'+t.objOrder+'</option>\n</select>\n<div id="actionScreen">\n</div>\n<div id="actionLayout">\n</div>\n<button id="addAction">+</button>\n</div>\n<h4>'+t.rules+"</h4>\n";var b=document.createElement("div");
b.id="rulist";c.appendChild(b);b=document.createElement("button");b.onclick=Cm;b.innerHTML="+";c.appendChild(b);b.id="addRule";c.appendChild(document.createElement("p"));b=document.createElement("button");b.onclick=Zj;b.innerHTML=t.close;c.appendChild(b);p("mapRulesWindow").appendChild(c);p("addEvent").onclick=Dm;p("addAction").onclick=Em;p("eventOptions").onchange=function(){var c=ak[this.value];oa.div=c.id;ia(oa.div);oa.active.name=this.value;c.func&&c.func();c=p("eventScreen").getElementsByTagName("button");
for(var b=!1,d=0,k=c.length;d<k;d++){var e=c[d];if(e.sdiv)if("none"==e.style.display)e.sdiv.style.display="none";else{if(!b)e.onclick();b=!0}}Ff(tb.active,"eventLayout")};p("actionOptions").onchange=function(){ub.active.name=this.value;Ff(tb.active,"actionLayout")};c=document.createElement("div");c.id="edobjAction";var k=document.createElement("select");k.innerHTML='\n<option value="attack">'+t.attack+'</option>\n<option value="destroy">'+t.destroy+'</option>\n<option value="moving">'+t.moving+'</option>\n<option value="capture">'+
t.capture+"</option>\n";k.value="attack";k.id="selectionEvents";k.onchange=Fm;var g=document.createElement("section"),m=document.createElement("section"),l=document.createElement("section"),h=document.createElement("section"),n=document.createElement("section");b=document.createElement("button");b.innerHTML=t.add;b.onclick=fd;var r=document.createElement("div");r.className="unitList";r.id="zoneList";l.appendChild(b);l.appendChild(r);r=document.createElement("div");r.className="unitList";r.id="unitListDiv";
r.spType=oa;b=document.createElement("button");b.innerHTML=t.add;b.onclick=function(){vb(this)};b.button=r;b.style.margin="10px";g.appendChild(b);b=document.createElement("button");b.innerHTML=t.defined;b.onclick=ob;b.sdiv=g;c.appendChild(b);b.onclick();b=document.createElement("button");b.innerHTML=t.undefined;b.onclick=ob;b.sdiv=m;c.appendChild(b);g.appendChild(r);c.appendChild(g);c.appendChild(m);c.appendChild(document.createElement("p"));c.appendChild(k);c.appendChild(document.createElement("p"));
r=document.createElement("div");r.className="unitList";r.id="unitListDiv2";r.spType=oa;b=document.createElement("button");b.innerHTML=t.add;b.onclick=function(){vb(this)};b.button=r;b.style.margin="10px";h.appendChild(b);b=document.createElement("button");b.innerHTML=t.defined;b.onclick=ob;b.sdiv=h;b.id="byButton1";c.appendChild(b);b=document.createElement("button");b.innerHTML=t.undefined;b.onclick=ob;b.id="byButton2";b.sdiv=n;c.appendChild(b);h.appendChild(r);b=document.createElement("button");
b.innerHTML=t.zone;b.onclick=ob;b.sdiv=l;b.id="eventZone";b.style.display="none";c.appendChild(b);c.appendChild(l);c.appendChild(h);c.appendChild(n);p("eventScreen").appendChild(c);V("mapEvent");V("mapActions");c=document.createElement("div");c.id="edobjOrder";k=document.createElement("select");k.innerHTML='\n<option value="move">'+t.move+'</option>\n<option value="attack">'+t.attack+"</option>\n";k.value="move";k.id="selectionActions";k.onchange=Gm;g=document.createElement("section");m=document.createElement("section");
h=document.createElement("section");n=document.createElement("section");r=document.createElement("div");r.className="unitList";r.id="unitListDivAction";r.spType=ub;b=document.createElement("button");b.innerHTML=t.add;b.onclick=function(){vb(this)};b.button=r;b.style.margin="10px";g.appendChild(b);b=document.createElement("button");b.innerHTML=t.defined;b.onclick=ob;b.sdiv=g;c.appendChild(b);b=document.createElement("button");b.innerHTML=t.undefined;b.onclick=ob;b.sdiv=m;c.appendChild(b);g.appendChild(r);
c.appendChild(g);c.appendChild(m);b.onclick();c.appendChild(document.createElement("p"));c.appendChild(k);c.appendChild(document.createElement("p"));r=document.createElement("div");r.className="unitList";r.id="unitListDivAction2";r.spType=ub;b=document.createElement("button");b.innerHTML=t.add;b.onclick=function(){vb(this)};b.button=r;b.style.margin="10px";h.appendChild(b);b=document.createElement("button");b.innerHTML=t.defined;b.onclick=ob;b.sdiv=h;b.id="toButton1";c.appendChild(b);b=document.createElement("button");
b.innerHTML=t.undefined;b.onclick=ob;b.id="toButton2";b.sdiv=n;c.appendChild(b);h.appendChild(r);c.appendChild(h);c.appendChild(n);b.onclick();p("actionScreen").appendChild(c);V("mapEvent");V("mapActions")}};Zd.onchange=function(c){parseInt(Zd.value);C(999999999,44444)};p("deleteUnit").onclick=function(){Q.slice(0);C(999999999,44444)};p("rotatebutton").onclick=Nl;p("gameMenu").onclick=Y;p("menueditor").onclick=Y;p("statButton").onclick=function(){}}};Df.setup=!1;var Am=function(){v.mouseEnter(this.ordid)},
Bm=function(){ra.stockActive&&ae(Q[0],1,1);sh.innerHTML=""},zm=function(b){Ie=b.button;v.executeOrder(this.ordid,b.button);this.style.transform="translate(0px,0px)"},ym=function(){this.style.transform="translate(2px,2px)"},uh=function(b,c){p(b).style.display="block";uh.actived=b;c.actual="potion";c.id=0;c.amount=100;c.func()};uh.actived="";var bk={potion:{bak:1,max:4,ord:["level","mana","attack","defence"]},sword:{bak:5,max:3,ord:["attack","attackBow","defence"]},book:{bak:8,max:18,ord:"fireRain lightning healing createCarpet createBat bless freeze confusion invisibility createGolem magicVision raiseDead turnToStone whirlpool createDragon flameBolt teach createJinn".split(" ")}},
dk=function(b,c){c=B[c];var d=b[2],k=[d,0,0,0];fj.paypal(k)||(d=~~(250*d),"book"==b[0]&&(d*=2),c.setupINTV(ck,b,d),c.lcost=k,c.techStart=c.c-r.cycle,X(c.id)&&(p("magicworkshopmenu").style.display="none"))},Hm={defence:6,mana:0,level:2,health:1,attack:5},Im={attack:"sword",attackBow:"bow",defence:"shield"},Jm={attack:.5,mana:1,defence:.5,level:.2},ck=function(k,c){k=B[inf[1]];var d=c[0],e=bk[d].ord[c[1]];c=c[2];k.lcost=void 0;"sword"==d&&(d=Im[e]);"attackBow"==e&&(e="attack");d=Object.assign({},Ud[d]);
if(d.potion)d.d=Hm[e],d[e]=~~(c*Jm[e]);else if(d.book){var f=b[e],g=f.obj;d.spell=e;d.attack=~~(c/g.spcost[0]);d.name=g.name;d.iconID=f.iconIDbook}else d[e]=~~(.25*c),250<d[e]&&(d[e]=250);C(d);Je(52,k,!0,d);k.techStart=void 0;X(k.id)},Ie,$d,ek=function(){history.pushState("",document.title,window.location.pathname)},Pb=function(){r.online=0;location.hash="";p("MatchX").style.display="none";p("index").style.display="block";p("returnmenu").style.display="none";p("game").style.display="none";p("gameFinish").style.display=
"none";setTimeout(ek,200)},eb=[.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.27,.3,1,.5,.5,.5,1,.62,.62,.62,1,.74,.74,.74,1,.88,.88,.88,1,.94,.94,.94,1,1,1,1,1,1.06,1.06,1.06,1,1.12,1.12,1.12,1,1.08,1.08,1.08,1,1.04,1.04,1.04,1,1,1,1,1,.95,.95,.95,1,.88,.8,.7,1,.84,.72,.6,1,.7,.62,.5,1,.6,.55,.45,1,.5,.44,.42,1,.4,.37,.35,1],Yi=function(){var b=(.025*r.cycle/r.daylength*24+r.initialhour)%24,c=~~b;b-=c;Yj.style.backgroundPosition="0 -"+36*c+"px";var d=new Float32Array([eb[4*c],eb[4*
c+1],eb[4*c+2],eb[4*c+3]]);c=(c+1)%24;d[0]+=(-d[0]+eb[4*c])*b;d[1]+=(-d[1]+eb[4*c+1])*b;d[2]+=(-d[2]+eb[4*c+2])*b;d[3]+=(-d[3]+eb[4*c+3])*b;h.useProgram(la);h.uniform4fv(fk,d);h.useProgram(ba);h.uniform4fv(gk,d)},Ta=0,ya=0,Gc=0,Hc=0,cd=function(b,c){var d=tzar.width,k=tzar.height,f=y.mx/32;b/=32;c/=32;var g=R*d*.03125,m=R*k*.03125,l=.03125*d,h=.03125*k,n=b+.5*(l-g),p=c+.5*(h-m);0>n?b=.5*-(l-g):n+g-f*R>H&&(b=H-g-.5*(l-g)+f*R);0>p?c=.5*-(h-m):p+m>Fa&&(c=Fa-m-.5*(h-m));g-y.mx>H&&(R=H/(.03125*d),C(R));
m>Fa&&(R=Fa/(.03125*k),C(R));Ta=32*-b;ya=32*-c},Ef=function(b){var c=b.pageX-parseInt(lc.style.left);b=b.pageY-parseInt(lc.style.top);var d=tzar.height*Kb/(32*Fa);c=~~(.5+(c-tzar.width*pc/(32*H)*.5)*H/pc);b=~~(.5+(b-.5*d)*Fa/Kb);cd(32*c,32*b);0==$d&&document.removeEventListener("mousemove",Ef)},Ac={control:0,shift:0,esc:0},gd={37:function(b){Gc=b},40:function(b){Hc=-b},39:function(b){Gc=-b},38:function(b){Hc=b},32:function(b){Pj=b?um:function(){}},16:function(b){Ac.shift=b;v.shiftONOFF(b)},17:function(b){Ac.control=
b},27:function(b){Ac.esc=b},13:function(b){b&&!r.editor&&("displaynone"==p("enterwindow").className?(p("enterwindow").className="displayblock",p("msginputGame").focus(),gd.blocked=13):(vh(),p("enterwindow").className="displaynone",gd.blocked=null))},19:function(b){b||r.online||jb(1)},48:function(b){b&&Ac.control&&(R=1,hk({deltaY:0}))},219:function(b){b&&ik(-1)},221:function(b){b&&ik(1)},blocked:null};document.oncontextmenu=function(){return!1};var jk=function(b,c){if(c.length){b=b||r.editor?c.length:
1;for(var d=0;d<b;d++)B[c[d]].die()}},wa=function(b,c){b.sound&&!c&&(c=b.sound,na(c[~~(c.length*Math.random())]));nc.style.display="none";Zd.style.display="none";Fc.style.display="block";qa.style.display="block";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";dd.style.display="none";Yd.innerHTML=b.name;be(b);Fc.innerHTML=J[b.kingdom].name;b.attack?(mc.style.display="block",mc.innerHTML=b.attack):mc.style.display="none";c=b.health;var d=b.maxHealth;Infinity==
c?(qa.value=100,qa.max=100,sb.innerHTML=c):qa.value=c;Infinity==d&&Infinity!=c?(qa.max=100,qa.value=1):Infinity!==d&&(qa.max=d);b.inventory&&b.inventory.length&&(manamenu1.style.display="block",manamenu1.style.backgroundPosition="0px -80px",manamenu1.innerHTML=b.inventory.length);sb.innerHTML=~~c+"/"+d;if(Ug(b,y))if(b.point&&(c=b.point,Fb.x32=c[0],Fb.y32=c[1],Na(Fb,96*(Fa-1)),Fb.show=1),!1===b.built)be(b);else if(b.techStart)be(b),manamenu.style.display="block",manamenu.style.backgroundPosition="0px -200px",
manamenu.innerHTML=100-~~(100*(b.c-r.cycle)/b.techStart)+"%",wa.intv&&clearInterval(wa.intv),wa.intv=setInterval(function(){Q[0]==b.id?manamenu.innerHTML=100-~~(100*(b.c-r.cycle)/b.techStart)+"%":clearInterval(wa.intv)},400);else if(T(),b.working){d=b.work;var k=ra.page*ra.length;c=0;for(var f=ra.length;c<f;c++){var g=d[c+k];Oa[c].innerHTML=g?g:""}manamenu.style.display="block";manamenu.style.backgroundPosition="0px -200px";var m=1E3*A[b.waitlist[0]].time;c=~~(100*(r.now()-b.timestamp)/m);100<c&&
(c=100);manamenu.innerHTML=c+"%";wa.intv&&clearInterval(wa.intv);wa.intv=setInterval(function(){if(Q[0]==b.id&&b.working){var c=~~(100*(r.now()-b.timestamp)/m);100<c&&(c=100);manamenu.innerHTML=c+"%"}else clearInterval(wa.intv)},400)}else for(c=0,d=ra.length;c<d;Oa[c++].innerHTML="");};wa.intv=!1;var hd=function(){V("magicworkshopmenu");mc.style.display="none";dd.style.display="none";nc.style.display="none";qa.style.display="none";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display=
"none";Yd.innerHTML="";mc.innerHTML="";dd.innerHTML="";manamenu.innerHTML="";nc.innerHTML="";Fc.innerHTML="";sb.innerHTML="";qa.value="";sb.maxLength="";Zd.style.display="none";for(var b=0;b<Oa.length;Oa[b++].innerHTML="");wh();kk()},db,Kd,Gf={},Q=[];Q.change=1;var xh;var Xg=!1;var bc=function(b,c){var d=R,k=tzar.width,f=tzar.height;b=b*d-Ta+.5*(k-d*k);c=c*d-ya+.5*(f-d*f);return[b,c]},qc=function(b){if(b){var c=b.pageX;b=b.pageY;qc.lastX=c;qc.lastY=b}else c=qc.lastX,b=qc.lastY;c=bc(c-y.mx,b);b=c[1];
c=c[0];0==Xg?(window.removeEventListener("mousemove",qc),xh=!1):xh=!0;yh=c;zh=b},lk=function(b,c){for(var d=c.length,e=0;e<d;e++){var k=B[c[e]];k.build&&(Z[b[0]+b[1]*H]==k.id?(k.point=void 0,Q[0]==k.id&&(Fb.x32=2*H,Na(Fb,128*H),Fb.show=0)):(k.point=b,Fb.x32=b[0],Fb.y32=b[1],Q[0]==k.id&&(Na(Fb,96*(Fa-1)),Fb.show=1)))}};document.onkeydown=function(b){return b.ctrlKey&&b.shiftKey?!1:{116:1,115:1,123:1}[b.keyCode]?!1:!0};var Km=function(b){C(b.keyCode);if(gd[b.keyCode])gd[b.keyCode](1);v.runKey(b.keyCode,
!0)},Lm=function(b){if(gd[b.keyCode])gd[b.keyCode](0);v.runKey(b.keyCode,!1)},Mm=function(b){var c=window.innerWidth,d=window.innerHeight,e=b.pageX,k=b.pageY;v.mouseMove(b.pageX,b.pageY);if(screen.height-10<=d){if(1.2==Math.abs(Gc)||0==Gc)Gc=1.2*((10>e)-(e>c-10));if(1.2==Math.abs(Hc)||0==Hc)Hc=1.2*((10>k)-(k>d-10))}},Nm=function(b){bc(b.pageX-y.mx,b.pageY);v.mouseDown(b.pageX,b.pageY,b.button);if(!ce&&b.pageX>y.menumx&&0==b.button){window.addEventListener("mousemove",qc);b=bc(b.pageX-y.mx,b.pageY);
var c=b[1];mk=b=b[0];nk=c;yh=b;zh=c;Xg=!0}},mk,nk,yh,zh,Om=function(b){ce||(v.mouseUp(b.pageX,b.pageY,b.button),fd.actived&&fd(),vb.actived&&vb(),$d&&($d=!1))},mm=function(){v.selection(mk,nk,yh,zh)},ae=function(b,c){b={attack:v.gAttack(b),defence:v.gDefence(b),level:v.glevel(b),health:v.ghealth(b),maxHealth:v.gmaxHealth(b),mana:v.gMana(b),item:v.gItem(b),build:v.gBuild(b),kingdom:v.gKingdom(b),c:v.gCval(b),manaMax:v.gManaMax(b),utype:v.giType(b),inventoryLength:v.gInventory(b),control:v.gControl(b),
iconID:v.gIconID(b),type:v.gType(b),helper:v.gHelper(b)};b.name=A[b.type]&&A[b.type].name||"";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";b.sound&&!c&&(c=b.sound,na(c[~~(c.length*Math.random())]));b.inventoryLength&&b.control?(p("stock").className="",manamenu1.style.display="block",manamenu1.style.backgroundPosition="0px -80px",manamenu1.innerHTML=b.inventoryLength):p("stock").className="blocked";b.build&&b.c&&(c=Math.floor(25*(b.c-r.cycle)/1E3),
manamenu.style.display="block",manamenu.style.backgroundPosition="0px -200px",manamenu.innerHTML=c+"s");Fc.style.display="block";Yd.innerHTML=b.name;b.attack||0==b.utype?(mc.innerHTML=b.attack,ia("attackmenu")):V("attackmenu");0==b.utype||2==b.utype&&b.defence?(dd.innerHTML=b.defence,ia("defencemenu")):V("defencemenu");b.manaMax&&(manamenu.style.display="block",manamenu.innerHTML=b.mana,27===b.type?(manamenu.style.backgroundPosition="0px -280px",ia("manamenu1"),manamenu1.style.backgroundPosition=
"0px -240px",manamenu1.innerHTML=b.helper):(progressmana.value=~~(100*b.mana/b.manaMax),ia("progressmana"),manamenu.style.backgroundPosition="0px -120px"));if(b.stock){c=b.stock;var d=Wj[i/3];d.style.display="block";d.style.backgroundPosition=Xj[c[4].icon].background;d.innerHTML=c[0]}nc.innerHTML=b.level;nc.style.display="block";0===b.level&&(b.item||b.build)&&(nc.style.display="none");Fc.innerHTML=Ic(Ya(v.empName(b.kingdom),17));qa.style.display="block";ok(b);be(b.iconID)},Ic=function(b){for(var c,
d="",e=0;c=b[e++];)d+=String.fromCharCode(c);return d},ok=function(b){var c=b.health;b=b.maxHealth;Infinity==c?(qa.value=100,qa.max=100,sb.innerHTML=c):(qa.value=c,Infinity==b?(qa.max=100,qa.value=1):qa.max=b,sb.innerHTML=~~c+"/"+b)},pk=function(b,c){var d=B[b[0]],e=0,k=0,g=d.clss,m=b.length,l={},h=[];h.cut={};for(var n={},p=0;p<m;p++){d=B[b[p]];e+=d.maxHealth;k+=d.health;Kd=g!=d.clss?-1:!0;if(d.work)for(var r=d.work,v=Object.keys(r),x=0,y=v.length;x<y;x++){var A=v[x];n[A]||(n[A]=0);n[A]+=r[A]}v=
d.icons;r=v.length;if(void 0===d.techID&&!1!==d.built)for(x=0;x<r;x++)y=v[x].id,v[x].obj.tech||(void 0===l[y]?l[y]=1:l[y]++,l[y]===m&&(v.cut&&(y=v.cut,A=v[x].objName,y[A]&&(h.cut[A]=y[A],h.cut[y[A]]=A)),h.put(v[x])))}!0===Kd&&(Kd=d.clss);k=Infinity==k?100:~~(k/e*100);sb.innerHTML=k+"/100(%)";Ah();Yd.innerHTML="";mc.style.display="none";dd.style.display="none";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";nc.style.display="none";Fc.innerHTML=m+" "+t.units;
qa.style.display="block";qa.value=k;qa.max=100;if(!c)for(p=0,b=ra.page*ra.length,r=ra.length;p<r;p++)c=n[p+b],Oa[p].innerHTML=c?c:""},qk=function(){};new Float32Array(8);var Bh,Ch,Dh,Eh,R=1,Pm=function(b){La(b.bufferID)},Vd={table:{},dates:[],new:function(b,c,d){c=Math.floor(c)+r.now();var e=this.table;d||(d=Pm);e[c]||(e[c]=[]);b.animFunc=d;e[c].put(b);this.dates.add(c);this.needOrder=!0}},Xa=function(b){b=Db[b];return 0>b[1]?l.delay[b[0]-b[1]-1]:~~(b[0]/b[1]*1E3)};new Float32Array(12);var Tg=function(b){var c=
b.id+r.arje+b.x32+b.y32;b.rnd=[4294967295+c,4294967295-c,0]},Fh=function(b){b.mlist&&rk(b,!0);b.hlist&&rk(b,!1)},rk=function(b,c){if(c){var d=b.mlist;var e=b.mlistID;var k=id.mercenaries}else d=b.hlist,e=b.hlistID,k=id.heroes;d.unshift(k[cj(b,k.length)]);c?e.unshift(b.mercID++):e.unshift(b.heroID++);8<d.length&&(d.length=8,e.length=8);Sa(b,5E4)},sk=function(k){k=B[k];if(!J[k.kingdom].paypal(Yl)){var c=J[k.kingdom],d=c.technology.disabled;if(!d[b.createCrusaders.id]){var e=16+4*c.crusade.number;c.crusade.number++;
32<e&&(e=32);c=c.crusade.list;c.length=e;for(var f=0;f<e;f++)(c[f]=Je(8,k,1)).deleteFromList=c;na("crusade",k.x32,k.y32);d[b.createCrusaders.id]=1;X(k.id)}}},vm=function(k){J[k.kingdom].technology.disabled[b.createCrusaders.id]=0},h,jd,tc={},lb,Z,Ke,kd=function(b,c){return new Float32Array(n.buffer,b,c)},Ya=function(b,c){return new Uint16Array(n.buffer,b,c)},Be=function(b,c){return new Uint8Array(n.buffer,b,c)},bd=function(b){return lb[b]},Jc=function(b){return Z[b]},Gh=function(b){return Ke[b]};
bd.write=function(b,c){lb[b]=c};Jc.write=function(b,c){Z[b]=c};Gh.write=function(b,c){Ke[b]=c};var pf=[bd,Jc,Gh],wh=function(){for(var b=ra.displayed.length=0,c=ra.length;b<c;b++){var d=Oa[b];d.className="blocked";d.style.backgroundPosition="48px 96px";d.innerHTML=""}ra.rightButton.className="blocked";ra.leftButton.className="blocked";ra.stock.className="blocked";ra.rightBlocked=1},tk=function(b,c,d){};tk.actv={};var gk,ba,la,uk,fk,vk,Hf,Hh,Ih,If,de,ee,fe,ld,Jh,Kh,Kc,wk,ge=function(b,c){var d=4*xk,
e=h.createBuffer();e.size=c;e.len=d;h.bindBuffer(h.ARRAY_BUFFER,e);h.enableVertexAttribArray(b);h.vertexAttribPointer(b,c,h.FLOAT,!1,0,0);h.bufferData(h.ARRAY_BUFFER,d*c,h.STATIC_DRAW);h.vertexAttribDivisor(b,1);return e};ge.jump=4E3;var Jf=function(b,c){var d=h.createBuffer(),e=c+1E4;c*=4;e*=4;h.bindBuffer(h.COPY_READ_BUFFER,b);h.bindBuffer(h.ARRAY_BUFFER,d);h.bufferData(h.ARRAY_BUFFER,c*b.size,h.STATIC_DRAW);h.copyBufferSubData(h.COPY_READ_BUFFER,h.ARRAY_BUFFER,0,0,c*b.size);h.bindBuffer(h.COPY_READ_BUFFER,
d);h.bindBuffer(h.ARRAY_BUFFER,b);h.bufferData(h.ARRAY_BUFFER,e*b.size,h.STATIC_DRAW);h.copyBufferSubData(h.COPY_READ_BUFFER,h.ARRAY_BUFFER,0,0,c*b.size);h.bindBuffer(h.COPY_READ_BUFFER,null);h.deleteBuffer(d)},za=function(){if(!r.canceled){performance.now();requestAnimationFrame(za);var b=za.fp1000,c=za.delta,d=za.now,e=za.realnow,f=za.delta,g=d;za.frameCount++;d=Date.now()-Hd+25*r.cycle;za.now=d;c=(c+(d-g))/1E3;za.delta=c;g=e;e=Date.now();za.realnow=e;f=(f+(e-g))/1E3;za.realdelta=f;Sg+=c;Rg++;za.fp1000=
b+c;if(0!=Gc||0!=Hc)Ta+=Gc*f*640*R,ya+=Hc*f*640*R,cd(-Ta,-ya),qc();h.useProgram(ba);Pj(d);qk();h.uniform1f(vk,d);h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT);b=d;c=window.innerWidth;d=window.innerHeight;h.useProgram(la);h.bindVertexArray(Jh);h.uniform1f(Hh,~~((.01*b+.5)%5));h.drawArrays(h.TRIANGLES,0,6);h.viewport(y.marx,d-Kb-y.mary,pc,Kb);h.uniform1i(If,1);h.uniform2fv(fe,[0,0]);h.uniform1f(ld,pc/32/H);h.drawArrays(h.TRIANGLES,0,6);h.uniform1i(If,0);h.uniform2f(Ih,c,d);h.uniform2fv(fe,[Ta,ya]);
h.uniform1f(ld,1/R);h.viewport(y.mx,0,c,d);h.useProgram(ba);h.bindVertexArray(Kh);Lh(v.getBufferID());b=tzar.width;c=tzar.height;h.viewport(y.marx,c-Kb-y.mary,pc,Kb);h.uniform2f(Hf,32*H,32*Fa);h.uniform2fv(ee,[0,0]);h.uniform1i(de,1);h.uniform1f(jd,1);Lh(v.getBufferID());h.uniform1i(de,2);Lh(1);h.uniform1i(de,0);h.uniform2f(Hf,b,c);h.uniform2fv(ee,[Ta,ya]);h.uniform1f(jd,1/R);h.viewport(y.mx,0,b,c);ja.active&&(Xd(ja.x,ja.y,96*H,ja.bufferID),ja.active=!1);Lc.update&&Lc(1)}},Lh=function(b){b&&(h.enable(h.BLEND),
h.blendEquation(h.FUNC_ADD),h.blendFunc(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA),h.drawArraysInstanced(h.TRIANGLES,0,6,b),h.disable(h.BLEND))},he=!1,hk=function(b){if(!ce&&(b.clientX>y.menumx||$d||!b.clientX)){b=.07*Math.sign(b.deltaY)*R;var c=(R+b)*tzar.height*.03125;(R+b)*tzar.width*.03125-(R+b)*y.mx/32>H||c>Fa||(R+=b,.08>R&&(R=.08),xh&&qc(),cd(-Ta,-ya),h.useProgram(la),h.uniform1f(ld,1/R),h.useProgram(ba),h.uniform1f(jd,1/R),v.setupZoom(R),yk())}},yk=function(){var b=tzar.width,c=tzar.height,d=-ya+.5*
(c-R*c),e=R*(b-y.mx);c*=R;pb[0]=-Ta+.5*(b-R*b);pb[1]=d;pb[2]=-999999999;pb[3]=0;pb[4]=0;Xd();pb[0]=e;pb[1]=c;pb[2]=0;pb[3]=0;pb[4]=0;zk()},Ak,Bk;qk=function(){var b=[Ta,ya];if(Ta!=Ak||ya!=Bk)Ak=Ta,Bk=ya,v.setupTranslation(-Ta,-ya),h.useProgram(la),h.uniform2fv(fe,b),h.useProgram(ba),h.uniform2fv(ee,b),yk()};var Mh,md,Kf=function(){var b=window.innerWidth,c=window.innerHeight;h.canvas.width=b;h.canvas.height=c;v.canvasSize(b,c);h.useProgram(la);h.uniform2f(Ih,b,c);h.useProgram(ba);Kc.width=b;Kc.height=
c;h.activeTexture(h.TEXTURE2);md||(md=h.createTexture());h.bindTexture(h.TEXTURE_2D,md);h.texImage2D(h.TEXTURE_2D,0,h.RGBA,b,c,0,h.RGBA,h.UNSIGNED_BYTE,null);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE);h.bindFramebuffer(h.FRAMEBUFFER,Kc);h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,
md,0);h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT);h.bindFramebuffer(h.FRAMEBUFFER,null);h.uniform1f(jd,1);h.uniform1i(h.getUniformLocation(ba,"lightmap"),2);h.useProgram(la);h.uniform1i(h.getUniformLocation(la,"lightmap"),2);h.uniform1f(ld,1);h.useProgram(ba);h.uniform2f(Hf,b,c);h.viewport(y.mx,0,b,c);Kf.changed=1;cd(-Ta,-ya)};"use strict";var fa=function(b,c){return b<H&&0<=b&&0<=c&&c<Fa?!0:!1};Array.prototype.put=function(b){this[this.length]=b};var gc,ie,Ud,nd=function(b,c,d,e){e&&0==nd.cols[e]&&
(nd.list.push(e,b),nd.cols[e]=1)};nd.cols={};nd.list=[];var I=function(b){for(var c=Object.keys(b),d=0;d<0*c.length;d++)b[b[c[d]]]=c[d];return b};window.onerror=nd;var r={},Db=[],P=function(b,c,d,e){var k=0,g=d.length-1,m=d[g];e=Ub[e];var l=[],h=0,n=!0;fa(b,c)&&fa(b+m-1,c+g/m-1)||(n=!1);for(var p=H,r=0;r<g;r++){k==m&&(k=0,c++);if(d[r]){var t=b+k+p*c;e[t]&&(n=!1);if(0<Z[t]||kc[t])n=!1;l[h++]=t}k++}return[l,n]};P.check=function(b,c,d,e,f,g,m,l){var k=d.length-1;d=d[k];var h=k/d;k=H;m=Ub[m];d+=2;--b;
--c;h=d*(h+2);for(var q=0;q<h;q++){var n=b+q%d,p=c+~~(q/d),r=n+p*k;if(0<Z[r]||kc[r]||g&&(n>=f&&n<=f+2||p>=e&&p<=e+2)||!fa(n,p)||m[r]||B[lb[r]].field||l[r])return!1}return!0};var Ck=function(b,c,d){var e=0,k=d.length-1,g=d[k],m=[],l=[],h=0,n=!0;fa(b,c)&&fa(b+g-1,c+k/g-1)||(n=!1);for(var p=0,r=0;r<k;r++){e==g&&(e=0,c++);var t=b+e+H*c;d[r]?(2<Z[t]&&(n=!1),m[h++]=t):(l[p++]=t,2<Z[t]&&(n=!1));e++}return[m,n,l]},Jg=function(b,c,d){var e=0,k=d.length-1,g=d[k],m=[],l=0,h=!0;fa(b,c)&&fa(b+g-1,c+k/g-1)||(h=
!1);for(var n=0;n<k;n++){e==g&&(e=0,c++);var p=b+e+c*H;if(d[n]&&2<Z[p]&&1==B[Z[p]].build||0<lb[p])h=!1;m[l++]=p;e++}return[m,h]},Lf=function(b,c,d){var e=!1,k=0,g=[],m=0,l=d.length-1,h=d[l],n=0,p=!0;fa(b,c)&&fa(b+h-1,c+l/h-1)||(p=!1);for(var r=0;r<l;r++){n==h&&(n=0,c++);if(d[r]){var t=b+n+H*c,v=Z[t];2<v&&(p=!1);0<v?k++:e=!0;g[m++]=t}n++}k>.5*(l-1)&&e||(p=!1);return[g,p]},je=function(b,c,d){d=!0;fa(b,c)||(d=!1);1!==lb[b+c*H]&&(d=!1);return[[b+c*H],d]},U=function(b,c,d){d=!0;fa(b,c)||(d=!1);0<Z[b+c*
H]&&(d=!1);return[[b+c*H],d]},Mf=function(b,c,d){d=!0;fa(b,c)||(d=!1);0<Ke[b+c*H]&&(d=!1);return[[b+c*H],d]},wb=function(b,c,d){d=!0;fa(b,c)||(d=!1);if(0<lb[b+c*H]||2==Z[b+c*H]||1==Z[b+c*H])d=!1;return[[b+c*H],d]};P.dimension=Jc;je.dimension=bd;Ck.dimension=Jc;Jg.dimension=bd;U.dimension=Jc;Mf.dimension=Gh;wb.dimension=bd;Lf.dimension=Jc;var ja,F,pa,ta,Di=function(){ja={img:0,x32:-1E3,y32:-1E3,rgb:[0,0,0,.5],d:0,active:!1};var k=8;var c=9;if(!he){Qm();var d=[b.move,b.attack,b.guard,b.patrol,b.pickUp,
b.explore,b.stop,b.stand,b.sameSpeed,b.restoreSpeed];ie={magic_creatures:[58,40,59,5,78,77,60,130,131,132,89,129]};var e=Object.keys(ie),f=0;for(k=e.length;f<k;f++){var g=ie[e[f]],m={};g.obj=m;for(var h=0,n=g.length;h<n;m[g[h++]]=1);}id.mercenaries=[b.mercArcher,b.mercFootman,b.mercMaceman,b.mercLongbowman,b.mercPikeman,b.mercKnight,b.mercArcherAsian,b.mercSamurai,b.mercHourseSamurai,b.mercRonin,b.mercHorseArcher,b.mercChariot,b.mercFootmanArab,b.mercArcherArab,b.mercMacemanArab,b.mercPikemanArab,
b.mercCavalry,b.mercEnichar,b.mercJihad];id.heroes=[b.mercArcher6,b.mercFootman6,b.mercMaceman6,b.mercLongbowman6,b.mercPikeman6,b.mercKnight6,b.mercArcherAsian6,b.mercSamurai6,b.mercHourseSamurai6,b.mercRonin6,b.mercHorseArcher6,b.mercChariot6,b.mercFootmanArab6,b.mercArcherArab6,b.mercMacemanArab6,b.mercPikemanArab6,b.mercCavalry6,b.mercEnichar6,b.mercJihad6];e=id.mercenaries;f=0;for(k=e.length;f<k;e[f++].merc=9);e=id.heroes;f=0;for(k=e.length;f<k;e[f++].hero=1);Date.now();f=[b.createKnight,b.createHorseArcher1,
b.createHorseArcher2,b.createHorseSamurai,b.createChariot,b.createEnichar,b.createCavalry];e=kd(v.atlasLoc(),1048576);e.splen=0;va.info=e;va.originalLength=Db.length;Ud={sword:{name:"Sword",iconID:16,img:l.items1,d:0,dMax:7,attack:1,type:52,sword:1},bow:{name:"Bow",iconID:4,img:l.items1,d:15,dMax:4,attack:1,type:52,sword:1},shield:{name:"Shield",iconID:1,img:l.items1,d:8,dMax:6,defence:1,type:52,shield:1},potion:{name:"Potion",iconID:11,img:l.potions,d:0,dMax:7,type:52,potion:1},book:{name:"Book",
iconID:9,img:l.books,d:0,dMax:4,type:52,book:1},gold:{name:"Gold",iconID:20,img:l.item_gold,d:0,dMax:0,type:52},stone:{name:"Stone",iconID:22,img:l.item_stone,d:0,dMax:0,type:52},food:{name:"Food",iconID:14,img:l.item_food,d:0,dMax:0,type:52},wood:{name:"Wood",iconID:15,img:l.item_tree,d:0,dMax:0,type:52},iron:{name:"Iron",iconID:21,img:l.item_iron,d:0,dMax:0,type:52}};e=[b.move,b.attack,b.stop,b.stand,b.pickUp,b.explore,b.healing,b.bless];k=[b.attack,b.guard,b.patrol,b.explore,b.stop,b.stand,b.attackGround,
b.steady,b.move];h=[b.buildAcademy,b.buildWorkshop,b.buildWorkshop1,b.buildAcademy1,b.buildWorkshop2,b.buildAcademy2];m=[b.buildMerchands1,b.buildMerchands2,b.buildMerchands];ta={euro:{},asia:{},arab:{},common:{}};A=[{name:"Footman",attack:6,defence:3,health:65,maxHealth:65,img:l.euro_footman,attackSound:fc,invType:0,invMax:8,validator:U,human:12,iconID:36,time:12,sight:5,url:l.euro_footman,icons:d,cost:[0,0,50,0],attDist:1,spd:50,dieSound:ab,clss:"footman",size:1,standardFunc:D,radix:0,zLevel:1,
strID:"e_footman",race:"euro"},{name:"Pikeman",radix:0,attackSound:fc,attack:8,defence:4,health:75,maxHealth:75,img:l.euro_pikeman,invType:0,dieSound:ab,invMax:8,validator:U,human:1,iconID:39,time:18,sight:5,url:l.euro_pikeman,icons:d,cost:[40,0,60,0],attDist:1,spd:50,standardFunc:D,clss:"e_pikeman",zLevel:1,size:1,strID:"e_pikeman",nu:b.createPikeman,race:"euro"},{name:"Spy",radix:0,attack:20,defence:0,mana:100,manaMax:100,health:50,maxHealth:50,img:l.euro_spy,attackSound:["spy%20kill%201","spy%20kill%202",
"spy%20kill%203"],invType:0,invMax:8,validator:U,human:1,dieSound:ab,iconID:41,time:30,sight:12,url:l.euro_spy,icons:[b.move,b.attack,b.guard,b.patrol,b.pickUp,b.explore,b.stop,b.stand,b.impersonate,b.revealSelf],zLevel:1,cost:[120,0,0,0],attDist:1,spd:50,clss:"spy",standardFunc:D,size:1,update:["mana","manaSpeed",1E3],isSpy:1,strID:"spy",nu:b.createSpy,race:"common"},{name:"Maceman",radix:0,attack:8,defence:0,health:120,maxHealth:120,img:l.euro_maceman,attackSound:fc,invType:0,invMax:8,validator:U,
human:1,iconID:37,time:14,dieSound:ab,sight:5,zLevel:1,url:l.euro_maceman,icons:d,cost:[0,0,120,0],attDist:1,spd:50,clss:"maceman",standardFunc:D,size:1,strID:"e_maceman",nu:b.createMaceman,race:"euro"},{radix:0,name:"Archer",attack:5,defence:0,health:50,maxHealth:50,img:l.euro_archer1,invType:0,invMax:8,validator:U,human:1,sight:10,dieSound:ab,arrow:!0,iconID:38,zLevel:1,time:12,url:l.euro_archer1,icons:d,cost:[0,20,40,0],attDist:7,spd:50,clss:"archer",standardFunc:D,attimg:l.arrow1,attackSound:Xc,
size:1,strID:"e_archer",nu:b.createArcher,race:"euro"},{radix:0,name:"Wizard",attackSound:Gi,dieSound:["mage"],attack:5,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:l.euro_mage,zLevel:1,invType:0,invMax:8,validator:U,human:1,iconID:42,time:30,sight:15,url:l.euro_mage,icons:[b.stop,b.pickUp,b.explore,b.lightning,b.createBat,b.freeze,b.createGolem,b.invisibility,b.stand,b.attack,b.move],cost:[150,0,0,0],attDist:10,attimg:l.flame_bolt,ball:1,spd:50,clss:"mage",standardFunc:D,size:1,update:["mana",
"manaSpeed",1E3],strID:"e_mage",nu:b.createMage,race:"euro"},{radix:0,name:"Longbowman",attack:6,defence:2,health:50,maxHealth:50,img:l.euro_longbowman,zLevel:1,invType:0,invMax:8,dieSound:ab,attackSound:Xc,arrow:!0,validator:U,race:"euro",human:1,iconID:35,time:18,sight:18,url:l.euro_longbowman,icons:d,cost:[50,0,90,0],attDist:12,spd:50,standardFunc:D,clss:"longbowman",size:1,d2attack:2,strID:"e_longbowman",attimg:l.arrow1,nu:b.createLongbowman},{radix:0,clss:"tree",name:"Tree",health:100,maxHealth:100,
img:l.terrain_tree,invType:0,invMax:8,zLevel:1,mMapcolor:[11,131,11],validator:U,child:[{img:l.terrain_tree_s,rgb:[0,0,0,.5],alpha:1,x:0,y:0}],iconID:23,url:l.terrain_tree,dimgInfinity:l.terrain_tree,dimgRND:3,icons:[],res:1,race:"common",build:!0,size:1,zolotoy:1,strID:"tree"},{radix:0,name:"Crusader",zLevel:1,dieSound:Dd,attackSound:Bd,attack:14,defence:8,health:180,maxHealth:180,img:l.crus,invType:0,invMax:8,validator:U,human:1,race:"euro",iconID:100,time:19,sight:5,url:l.crus,icons:d,cost:[0,
0,0,0],attDist:1,spd:85,standardFunc:D,clss:"crusader",size:1,strID:"crusader"},{radix:0,name:"Priest",attack:20,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:l.euro_priest,invType:0,zLevel:1,invMax:8,validator:U,human:1,iconID:40,time:30,ball:1,sight:21,dieSound:ab,url:l.euro_priest,icons:e,attackOnly:ie.magic_creatures.obj,cost:[150,0,0,0],attDist:18,race:"euro",spd:50,standardFunc:D,clss:"priest",size:1,update:["mana","manaSpeed",1E3],strID:"e_priest",nu:b.createPriest,attimg:l.flame_bolt},
{radix:0,name:"Peasant",attackSound:Cg,attack:5,defence:0,health:50,maxHealth:50,img:l.euro_peasant,invType:0,invMax:8,dieSound:ab,zLevel:1,validator:U,human:1,race:"euro",iconID:33,time:8,sight:5,url:l.euro_peasant,icons:[b.move,b.menuBuilds,b.repair,b.conquest,b.dcm,b.pickUp,b.explore,b.stop,b.stand,b.attack,b.bribe,b.sameSpeed,b.restoreSpeed],cost:[0,0,50,0],attDist:1,spd:50,clss:"peon",size:1,peon:1,strID:"e_peon",nu:b.createPeon,nocapture:1},{radix:0,clss:"cathedral",name:"Cathedral",dieSound:L,
sound:["e_cathedral1","e_cathedral2"],resistance:700,health:5E3,maxHealth:5E3,img:l.euro_cathedral,invType:0,invMax:8,race:"euro",zLevel:1,validator:P,bimg:l.build5x5,dimg:l.des_5x5,iconID:60,icons:[b.createCrusaders,b.techFanaticism,b.techEspionage,b.techInquisition,b.techHealing,b.techBless,b.techCrusade,b.techMedicine],time:90,sight:8,child:[{img:l.euro_cathedral_c,x:0,y:0},{img:l.euro_cathedral_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
1,1,0,0,5]),url:l.euro_cathedral,build:!0,cost:[2E3,0,0,2E3],onbuild:[b.buildChurch],size:1,strID:"cathedral"},{radix:0,name:"Castle",clss:"castle",dieSound:L,sound:["e_castle1"],resistance:700,health:8E3,maxHealth:8E3,img:l.euro_castle,invType:1,invMax:50,race:"euro",zLevel:1,validator:P,bimg:l.build6x6,dimg:l.des_6x6,iconID:59,time:120,sight:12,child:[{img:l.euro_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:l.euro_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[b.createPeon,b.createSpy,b.emergeAllUnits,b.techFeudalism,
b.techArchitecture,b.techLearning],space:new Uint8Array([0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,0,1,1,7]),menu:wa,url:l.euro_castle,build:!0,cost:[0,1500,0,1500],storage:4,castle:!0,population:20,size:1,strID:"e_castle"},{radix:0,name:"Wooden Wall",clss:"wall_wood",resistance:700,health:2E3,maxHealth:2E3,img:l.wood_tower,time:6,sight:1,zLevel:1,dieSound:L,validator:P,bimg:l.wood_build,dimgInfinity:l.wood_debris,iconID:49,icons:[],mx:0,race:"common",
my:0,hframe:71,menu:wa,url:l.wood_tower,space:new Uint8Array([1,1]),wall:1,build:!0,cost:[0,20,0,0],size:1,strID:"woodwall",child:[{img:l.wood_tower_c,x:0,y:0}]},{radix:0,name:"Barracks",clss:"barracks",strID:"e_barrack",sound:Dg,generator:1,resistance:500,health:1400,maxHealth:1400,img:l.euro_barrack,invType:1,invMax:0,dieSound:L,time:60,sight:6,zLevel:1,race:"euro",validator:P,bimg:l.build5x5,dimg:l.des_5x5,child:[{img:l.euro_barracks_c,mv:!0},{img:l.euro_barrack_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],
iconID:57,icons:[b.createFootman,b.createArcher,b.createMaceman,b.createPikeman,b.createLongbowman,b.createKnight],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:l.euro_barrack,build:!0,cost:[0,0,200,200],size:1},{radix:0,strID:"e_lumber",name:"Lumber Mill",sound:["e_lumber1"],clss:"lumber_mill",resistance:500,health:800,maxHealth:800,img:l.euro_lumbermill,invType:1,invMax:0,time:30,race:"euro",sight:4,dieSound:L,zLevel:1,validator:P,bimg:l.build2x2,dimg:l.des_2x2,
iconID:64,child:[{img:l.euro_lumbermill_c,x:0,y:0},{alpha:!0,img:l.euro_lumbermill_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[b.techLongbow,b.techWoodCutting,b.techCrossbow],space:new Uint8Array([1,1,1,1,2]),hframe:98,url:l.euro_lumbermill,build:!0,cost:[0,100,0,0],storage:1,size:1},{radix:0,name:"Mage Tower",strID:"e_magetower",sound:["e_magetower1","e_magetower2","e_magetower3"],clss:"magictower",resistance:700,health:5E3,maxHealth:5E3,img:l.euro_magetower,invType:1,invMax:0,time:90,race:"euro",dieSound:L,
sight:8,validator:P,bimg:l.build5x5,dimg:l.des_5x5,zLevel:1,child:[{img:l.euro_magetower_c,x:0,y:0},{img:l.euro_magetower_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:71,icons:[b.createMage,b.techBat,b.techInvisibility,b.techLightning,b.techFreeze,b.techGolem],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:l.euro_magetower,build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,strID:"e_waracademy",name:"Warriors Guild",sound:["e_waracademy1"],clss:"academy",resistance:700,health:5E3,maxHealth:5E3,
img:l.euro_waracademy,invType:1,invMax:0,race:"euro",time:90,sight:8,dieSound:L,zLevel:1,validator:P,bimg:l.build6x6,dimg:l.des_6x6,iconID:56,child:[{img:l.euro_waracademy_c,x:0,y:0,mv:!0},{img:l.euro_waracademy_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],icons:[b.techHeroism,b.techWarfare,b.techMercenaries,b.techSiegeTactics,b.techBodyBuilding,b.techLeadership,b.techTactics,b.techHeroes,b.techHonor,b.techFame],space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,0,5]),url:l.euro_waracademy,
build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,name:"Storage",strID:"e_storage",sound:["e_storage1","e_storage2"],clss:"storage",resistance:80,health:800,maxHealth:800,img:l.euro_storage,invType:1,invMax:0,time:30,dieSound:L,zLevel:1,sight:5,validator:P,bimg:l.build4x4,dimg:l.des_4x4,iconID:69,race:"euro",icons:[b.techGoldMining,b.techStoneMining],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,4]),url:l.euro_storage,storage:0,build:!0,cost:[0,200,0,0],size:1,child:[{img:l.euro_storage_c,x:0,
y:0},{img:l.euro_storage_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Knight",strID:"e_knight",dieSound:Dd,clss:"knight",attackSound:Bd,attack:12,defence:6,health:120,maxHealth:120,img:l.euro_knight,invType:0,zLevel:1,race:"euro",invMax:8,validator:U,human:1,iconID:43,d2attack:2,time:22,sight:5,url:l.euro_knight,icons:d,cost:[120,0,70,0],attDist:1,spd:85,nu:b.createKnight,standardFunc:D,size:1},{radix:0,name:"Field",clss:"field",strID:"field",instantBuild:1,resistance:80,health:100,maxHealth:100,
img:l.fields,invMax:0,validator:Jg,zLevel:0,iconID:104,race:"common",icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:l.fields,build:!0,field:1,res:2,cost:[0,200,0,0],rndDirection:9,time:0,sight:1,z32:.5,size:1},{radix:0,name:"Golden rocks",mMapcolor:[148,148,0],strID:"gold",sound:["mine1"],clss:"golden_rocks",resistance:0,health:8E3,maxHealth:8E3,img:l.res_gold,invMax:0,validator:P,iconID:20,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:l.res_gold,build:!0,zLevel:1,
race:"common",res:0,cost:[0,0,0,0],time:0,sight:2,dieSound:["destroy%20mine"],size:1,zolotoy:1,child:[{img:l.res_gold_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:l.res_gold},{radix:0,name:"Rocks",strID:"stone",mMapcolor:[132,132,132],sound:["mine1"],clss:"rocks",dieSound:["destroy%20mine"],resistance:0,health:8E3,maxHealth:8E3,img:l.res_stone,invMax:0,validator:P,zLevel:1,iconID:22,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:l.res_stone,build:!0,res:3,cost:[0,0,0,0],
race:"common",time:0,sight:2,size:1,zolotoy:1,child:[{img:l.res_stone_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:l.res_stone},{radix:0,name:"Farm",strID:"e_farm",sound:["e_farm1","e_farm2"],clss:"farm",resistance:0,health:800,maxHealth:800,img:l.euro_farm,invType:1,invMax:0,zLevel:1,validator:P,bimg:l.build4x4,dimg:l.des_4x4,iconID:61,dieSound:L,race:"euro",icons:[b.createCow,b.techCropRotation,b.techDomestication],space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),menu:wa,url:l.euro_farm,
build:!0,cost:[0,200,0,0],time:30,sight:5,storage:2,size:1,child:[{img:l.euro_farm_c,x:0,y:0}]},{radix:0,name:"Merchants Guild",strID:"e_merchant",sound:["merchant"],clss:"merchants_guild",resistance:0,health:5E3,maxHealth:5E3,img:l.euro_tcguild,invType:1,invMax:0,validator:P,bimg:l.build6x6,zLevel:1,dimg:l.des_6x6,race:"euro",iconID:62,dieSound:L,icons:[b.techMapMaking,b.techTradeRoutes,b.techUsury,b.techSupplyStorage,b.techBribery,b.techTradeTaxes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,0,1,1,1,0,5]),menu:wa,url:l.euro_tcguild,build:!0,time:90,sight:8,cost:[2E3,0,0,2E3],onbuild:[b.buildMarket],size:1,child:[{img:l.euro_tcguild_c,x:0,y:0},{img:l.euro_tcguild_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Church",clss:"church",strID:"e_church",sound:["e_church1"],resistance:0,health:800,maxHealth:800,img:l.euro_church,invType:1,invMax:0,dieSound:L,validator:P,bimg:l.build3x3,race:"euro",zLevel:1,dimg:l.des_3x3,iconID:139,icons:[b.createPriest],space:new Uint8Array([1,
1,1,1,1,1,1,1,1,3]),menu:wa,url:l.euro_church,build:!0,cost:[0,0,200,200],time:40,sight:6,size:1,child:[{img:l.euro_church_c,x:0,y:0},{img:l.euro_church_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Blacksmith",clss:"blacksmith",strID:"e_blacksmith",resistance:0,health:800,maxHealth:800,img:l.euro_blacksmith,invType:1,invMax:0,time:40,zLevel:1,sight:5,dieSound:L,validator:P,bimg:l.build4x4,race:"euro",dimg:l.des_4x4,child:[{img:l.euro_blacksmith_c,x:0,y:0}],iconID:58,icons:[b.techPlateArmor,
b.techTemperIron,b.techScaleArmor,b.techHalberd,b.techChainMail],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),menu:wa,url:l.euro_blacksmith,build:!0,cost:[0,0,200,200],onbuild:h,size:1},{radix:0,name:"Cow",clss:"cow",nu:b.createCow,race:"common",strID:"cow",attack:0,defence:3,health:50,maxHealth:50,img:l.cow,invType:0,invMax:8,zLevel:1,validator:U,iconID:99,time:20,dieSound:["cowdie1","cowdie2","cowdie3","cowdie4"],url:l.cow,icons:[b.move,b.stop],sight:3,cost:[0,0,300,0],attDist:0,spd:32,
res:2,food:300,milk:50,milkMax:50,foodMax:600,size:1,cow:1,update:["milk","milkSpeed",1E3,"food","cowSpeed",1E3]},{radix:0,name:"Stable",sound:["e_stables1"],clss:"stable",strID:"e_stable",onlyRequired:1,resistance:0,health:800,maxHealth:800,invType:1,invMax:0,race:"euro",zLevel:1,validator:P,bimg:l.build4x4,dimg:l.des_4x4,iconID:68,dieSound:L,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,4]),url:l.euro_stables,build:!0,cost:[0,200,0,0],onbuild:f,size:1,time:40,sight:5,img:l.euro_stables,
nu:b.createCow,child:[{img:l.euro_stable_c,x:0,y:0}]},{radix:0,name:"Workshop",sound:["e_workshop1"],clss:"workshop",strID:"e_workshop",zLevel:1,resistance:0,health:800,maxHealth:800,img:l.euro_workshop,invType:1,invMax:0,dieSound:L,validator:P,bimg:l.build4x4,race:"euro",dimg:l.des_4x4,iconID:75,icons:[b.createCatapult,b.createHeavyCatapult,b.createBallist,b.techEngineering,b.techCannonTower],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,4]),url:l.euro_workshop,build:!0,cost:[0,200,200,0],
size:1,time:40,sight:5,child:[{img:l.euro_workshop_c,x:0,y:0}]},{radix:0,name:"Tavern",sound:["e_tavern1"],clss:"tavern",strID:"e_tavern",dieSound:L,resistance:0,health:1E3,maxHealth:1E3,img:l.euro_tavern,invType:1,invMax:0,validator:P,race:"euro",bimg:l.build4x4,dimg:l.des_4x4,zLevel:1,iconID:70,icons:[b.createMercenaries,b.createHeroes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,4]),url:l.euro_tavern,build:1,cost:[0,200,200,0],onbuild:m,actvintv:[b.iniMercenaries,b.iniHeroes],size:1,
time:40,sight:5,child:[{img:l.euro_tavern_c,x:0,y:0}]},{name:"House",sound:["house1","house2","house3","house4","house5"],clss:"house",strID:"e_house",resistance:0,health:500,maxHealth:500,img:l.euro_houses,invType:1,invMax:0,validator:P,bimg:l.build3x3,dimg:l.des_3x3,race:"euro",iconID:73,zLevel:1,dieSound:L,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:l.euro_houses,build:!0,cost:[0,75,0,0],population:10,size:1,time:20,sight:4,child:[{img:l.euro_houses_c,x:0,y:0}]},{name:"Watch Tower",
attackSound:Ce,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),clss:"watch_tower",strID:"watch_tower",attack:7,health:400,maxHealth:400,img:l.euro_tower_wood_2,state:0,invType:1,race:"common",invMax:0,zLevel:1,dieSound:L,level:0,validator:P,child:[{img:l.euro_tower_wood_2_c,x:0,y:0},{alpha:!0,img:l.euro_tower_wood_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attimg:l.arrow1,attDist:8,bimg:l.build2x2,dimg:l.des_2x2,iconID:53,icons:[b.attack,b.stop,b.upgradeGuildTower],space:new Uint8Array([1,1,1,1,2]),url:l.euro_tower_wood_2,
build:!0,cost:[0,300,0,0],size:1,arrow:!0,time:10,sight:15,standardFunc:D},{name:"Market",sound:["e_market1"],clss:"market",strID:"e_market",resistance:0,health:1400,maxHealth:1400,img:l.euro_market,invType:1,invMax:0,dieSound:L,zLevel:1,validator:P,bimg:l.build4x4,dimg:l.des_4x4,iconID:65,race:"euro",icons:[b.createCaravan],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,4]),url:l.euro_market,build:!0,cost:[0,200,200,0],size:1,time:60,sight:8,child:[{img:l.euro_market_c,x:0,y:0}]},{name:"Outpost",
sound:["e_outpost1"],clss:"outpost",strID:"e_outpost",zLevel:1,resistance:0,health:2E3,maxHealth:2E3,img:l.euro_outpost,invType:1,dieSound:L,invMax:50,validator:P,race:"euro",bimg:l.build4x4,dimg:l.des_4x4,iconID:66,icons:[b.emergeAllUnits],space:new Uint8Array([0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,4]),url:l.euro_outpost,build:!0,cost:[0,200,0,400],size:1,child:[{img:l.euro_outpost_c,x:0,y:0},{img:l.euro_outpost_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:60,sight:8},{name:"Bridge",clss:"bridge",strID:"bridge",
resistance:0,health:1E4,maxHealth:1E4,img:l.bridge_horz,invMax:0,valid2:!0,validator:Ck,bimg:l.bridge_horz_build,race:"common",zLevel:1,dieSound:L,child:[{alpha:!0,img:l.bridge_horz_s,x:0,y:0,rgb:[0,0,0,.5]},{img:l.bridge_horz1,x:0,y:0,z:6}],time:22,sight:1,dimg:l.bridge_horz_demol,iconID:44,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,11]),url:l.bridge_horz,
build:!0,cost:[0,200,0,400],size:1},{name:"Dummy",clss:"dummy",strID:"dummy",resistance:0,health:5E3,maxHealth:5E3,img:l.dummy1,invMax:0,validator:U,bimg:l.dummy1_b,iconID:165,icons:[],mx:0,zLevel:1,my:16,hframe:65,race:"common",url:l.dummy1,dimg:l.dummy1_d,build:!0,cost:[0,300,0,0],dummy:!0,child:[{img:l.dummy1_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:10,sight:1},{name:"Catapult",strID:"catapult",dieSound:Ee,clss:"catapult",attackSound:De,defence:0,attack:10,health:110,maxHealth:110,img:l.catapult,
invMax:0,radix:0,validator:U,iconID:30,time:30,sight:20,race:"common",url:l.catapult,level:0,zLevel:1,icons:k,cost:[0,600,0,0],nofreeze:1,arrow:!1,attDist:17,spd:40,standardFunc:D,size:1,attimg:l.cat_stone,space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:b.createCatapult},{name:"Ballista",radix:0,strID:"ballista",attackSound:De,dieSound:Ee,clss:"ballista",defence:0,attack:60,health:75,maxHealth:75,img:l.ballista,invMax:0,validator:U,iconID:31,time:30,sight:16,nofreeze:1,race:"common",zLevel:1,url:l.ballista,
icons:k,cost:[0,800,0,0],attDist:13,spd:40,standardFunc:D,size:1,attimg:l.arrow_ballista1,space:new Uint8Array([1,1,1,1,2]),attackDeg:30,nu:b.createBallist},{name:"Heavy Catapult",strID:"heavy_catapult",attackSound:De,defence:0,attack:25,health:250,maxHealth:250,img:l.h_catapult,invMax:0,radix:0,validator:U,iconID:45,time:60,dieSound:Ee,sight:26,race:"common",url:l.h_catapult,zLevel:1,icons:k,standardFunc:D,cost:[0,1200,0,0],attDist:22,spd:40,nofreeze:1,clss:"heavy_catapult",size:1,attimg:l.cb_metal,
space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:b.createHeavyCatapult},{radix:0,name:"Ghost",strID:"ghost",defence:0,attack:8,health:60,maxHealth:60,img:l.euro_ghost,invType:0,invMax:8,dieSound:["ghost1","ghost2"],validator:U,iconID:178,zLevel:1,race:"common",time:15,attackSound:Fi,sight:5,standardFunc:D,url:l.euro_ghost,icons:d,w:1,cost:[40,0,0,0],attDist:1,spd:80,clss:"ghost",size:1,nu:b.createGhost},{name:"Harbor",strID:"e_harbor",resistance:80,health:800,maxHealth:800,img:l.euro_harbor,invType:1,
invMax:0,validator:Lf,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:l.build_harbor,dimg:l.des_harbor,zLevel:1,race:"euro",dieSound:L,iconID:63,icons:[b.createFishingBoat,b.createXebec,b.createHulk,b.createGalleon,b.techLandingTactics],clss:"harbor",url:l.euro_harbor,storage:4,build:!0,cost:[0,200,200,0],child:[{img:l.euro_harbor_c,x:0,y:0},{img:l.euro_harbor_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:60,sight:8},{radix:0,name:"Messiah",strID:"messiah",attack:50,defence:10,mana:1E3,manaMax:1E3,
health:1E3,maxHealth:1E3,img:l.messiah,invType:0,invMax:0,race:"common",validator:U,human:1,iconID:169,zLevel:1,attackSound:["messiah_attack"],dieSound:["messiah"],time:300,sight:26,url:l.messiah,standardFunc:D,icons:d,cost:[2E3,0,0,0],attDist:10,spd:50,clss:"messiah",size:1,update:["mana","manaSpeed",1E3]},{name:"Magic Gateway",sound:["gateway"],strID:"gateway",magicGateway:1,resistance:0,health:Infinity,maxHealth:Infinity,img:l.teleport,invMax:0,validator:P,bimg:l.build4x4,zLevel:1,dieSound:L,race:"common",
iconID:180,clss:"magic_gateway",icons:[b.createOrk,b.createDwarf,b.createGhost,b.createSkeleton],space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,5]),url:l.teleport,build:!0,cost:[0,0,0,0],size:1,time:10,sight:10,zolotoy:1,child:[{img:l.teleport_c,x:0,y:0},{alpha:!0,img:l.teleport_s,x:0,y:0,rgb:[0,0,0,.5]}],standardFunc:fm},{name:"Guard Tower",strID:"guard_tower",race:"common",clss:"guard_tower",attackSound:Ce,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:12,
health:1E3,maxHealth:1E3,img:l.euro_tower_wood,state:0,invType:1,invMax:0,dieSound:L,zLevel:1,validator:P,child:[{img:l.euro_tower_wood_c,x:0,y:0},{alpha:!0,img:l.euro_tower_wood_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:12,bimg:l.build2x2,dimg:l.des_2x2,iconID:52,icons:[b.attack,b.stop,b.upgradeStoneTower,b.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:l.euro_tower_wood,build:!0,cost:[0,600,0,0],size:1,arrow:!0,attimg:l.arrow1,time:35,sight:16,standardFunc:D},{name:"Sword",attack:0,defence:0,
health:25,maxHealth:25,img:l.items1,state:0,invMax:0,validator:wb,iconID:16,url:l.items1,icons:[],cost:[0,0,0,0],size:1,zLevel:0,z32:.5,radix:0,race:"common",item:1},{name:"Bow",attack:0,defence:0,health:25,maxHealth:25,img:l.items1,state:0,invMax:0,validator:wb,iconID:4,url:l.items1,icons:[],cost:[0,0,0,0],size:1,z32:.5,zLevel:0,radix:0,race:"common",item:1},{name:"Shield",attack:0,defence:0,health:25,maxHealth:25,img:l.items1,state:0,invMax:0,validator:wb,iconID:1,url:l.items1,icons:[],cost:[0,
0,0,0],zLevel:0,race:"common",radix:0,size:1,z32:.5,item:1},{name:"Potion",attack:0,defence:0,health:25,maxHealth:25,img:l.potions,state:0,invMax:0,validator:wb,iconID:11,url:l.potions,icons:[],radix:0,race:"common",zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Book",attack:0,defence:0,health:25,maxHealth:25,img:l.book1,state:0,invMax:0,validator:wb,iconID:9,zLevel:0,race:"common",radix:0,url:l.books,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Gold",health:1,maxHealth:1,img:l.item_gold,
invMax:0,validator:wb,iconID:20,radix:0,race:"common",zLevel:0,url:l.item_gold,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Stone",health:1,maxHealth:1,img:l.item_stone,invMax:0,validator:wb,iconID:22,race:"common",radix:0,url:l.item_stone,zLevel:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Food",health:15,maxHealth:15,img:l.item_food,invMax:0,mMapcolor:[0,255,255],validator:wb,iconID:14,url:l.item_food,radix:0,race:"common",icons:[],zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},
{ignore:1,name:"Wood",health:1,maxHealth:1,img:l.item_wood,invMax:0,validator:wb,iconID:15,url:l.item_wood,icons:[],race:"common",radix:0,zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Iron",health:1,maxHealth:1,img:l.item_iron,invMax:0,validator:wb,iconID:21,zLevel:0,race:"common",url:l.item_iron,radix:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Keep Tower",strID:"keep_tower",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:16,health:2E3,maxHealth:2E3,img:l.euro_tower_stone,
state:0,invType:1,zLevel:1,attackSound:Ce,invMax:0,dieSound:L,validator:P,clss:"keep_tower",race:"common",child:[{alpha:!0,img:l.euro_tower_stone_s,x:0,y:0,rgb:[0,0,0,.5]},{img:l.euro_tower_stone_c,x:0,y:0}],attDist:14,bimg:l.build2x2,dimg:l.des_2x2,standardFunc:D,iconID:54,icons:[b.attack,b.stop,b.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:l.euro_tower_stone,build:!0,cost:[0,600,0,0],size:1,arrow:!0,attimg:l.arrow_big1,time:40,sight:18},{name:"Cannon Tower",clss:"tower_stone2",strID:"tower_stone2",
attackSound:Cd,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:40,health:2500,maxHealth:2500,img:l.euro_tower_stone_2,state:0,invType:1,invMax:0,dieSound:L,race:"common",validator:P,zLevel:1,child:[{img:l.euro_tower_stone_2_c,x:0,y:0},{alpha:!0,img:l.euro_tower_stone_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:10,bimg:l.build2x2,dimg:l.des_2x2,iconID:54,icons:[b.attack,b.stop],space:new Uint8Array([1,1,1,1,2]),url:l.euro_tower_stone_2,build:!0,cost:[0,600,0,0],standardFunc:D,size:1,arrow:!1,
attimg:l.hot_cannon,time:45,sight:18,attackDeg:30},{name:"Rocket Tower",strID:"tower_rocket",race:"asia",clss:"tower_rocket",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),zLevel:1,attack:30,health:1400,maxHealth:1400,img:l.rocket_tower,state:0,invType:1,invMax:0,dieSound:L,validator:P,child:[{img:l.rocket_tower_c},{alpha:!0,img:l.rocket_tower_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:20,bimg:l.build2x2,dimg:l.des_2x2,iconID:186,icons:[],space:new Uint8Array([1,1,1,1,2]),url:l.rocket_tower,build:!0,
cost:[0,600,0,0],standardFunc:D,size:1,arrow:!0,attimg:l.arrow_big1,time:60,sight:26},{radix:0,name:"Ork",race:"common",strID:"ork",dieSound:["orc%20die%201","orc%20die%202"],attackSound:Ei,attack:18,defence:2,health:75,maxHealth:75,img:l.ork,invType:0,invMax:8,validator:U,zLevel:1,iconID:143,time:12,sight:5,url:l.ork,standardFunc:D,icons:d,cost:[60,0,0,0],attDist:1,spd:50,clss:"ork",size:1,nu:b.createOrk},{radix:0,name:"Dwarf",race:"common",attack:7,defence:7,health:120,maxHealth:120,img:l.dwarf,
invType:0,strID:"dwarf",invMax:8,zLevel:1,dieSound:ab,validator:U,iconID:185,time:12,sight:3,url:l.dwarf,standardFunc:D,icons:d,cost:[80,0,0,0],attDist:1,spd:50,clss:"dwarf",size:1,nu:b.createDwarf},{radix:0,name:"Skeleton",strID:"skeleton",race:"common",dieSound:["skeleton%20die%201","skeleton%20die%202","skeleton%20die%203","skeleton%20die%204"],attack:4,defence:0,health:40,maxHealth:40,img:l.skeleton,invType:0,zLevel:1,attackSound:fc,invMax:8,nofreeze:1,validator:U,iconID:167,time:12,sight:3,url:l.skeleton,
standardFunc:D,icons:d,cost:[0,0,30,0],attDist:1,spd:50,clss:"skeleton",size:1,nu:b.createSkeleton},{radix:0,name:"Caravan",race:"euro",strID:"e_caravan",attack:0,defence:0,health:350,maxHealth:350,img:l.caravan,invType:1,invMax:8,validator:U,iconID:34,zLevel:1,time:50,sight:7,url:l.caravan,icons:[b.move,b.trade,b.explore,b.stop,b.stand,b.unload],cost:[0,200,400,0],attDist:1,spd:75,clss:"caravan",size:1,nu:b.createCaravan},{name:"Castle",health:8E3,maxHealth:8E3,img:l.asia_castle,invType:1,strID:"a_castle",
zLevel:1,race:"asia",invMax:50,validator:P,bimg:l.build6x6,dimg:l.des_6x6,iconID:164,time:120,sight:12,dieSound:L,clss:"castle",child:[{img:l.asia_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:l.asia_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[b.createPeon1,b.createNinja,b.emergeAllUnits,b.techFeudalism,b.techArchitecture,b.techLearning,b.techBuddhism,b.techGreatWall],space:new Uint8Array([0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,
1,1,0,0,8]),menu:wa,url:l.asia_castle,build:!0,cost:[0,1500,0,1500],storage:4,castle:!0,population:20,size:1},{name:"Castle",dieSound:L,clss:"castle",strID:"r_castle",race:"arab",health:8E3,maxHealth:8E3,img:l.arab_castle,invType:1,invMax:50,validator:P,bimg:l.build6x6,dimg:l.des_6x6,zLevel:1,iconID:97,time:120,sight:12,child:[{img:l.arab_castle_c}],icons:[b.createPeon2,b.createSpy,b.emergeAllUnits,b.techFeudalism,b.techArchitecture,b.techLearning,b.techSlavery],space:new Uint8Array([0,0,0,1,1,1,
0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,0,0,0,1,0,0,0,,8]),menu:wa,url:l.arab_castle,build:!0,cost:[0,1500,0,1500],storage:4,castle:!0,population:20,size:1},{radix:0,name:"Peasant",attack:5,defence:0,health:50,maxHealth:50,img:l.asian_peasant,invType:0,invMax:8,attackSound:Cg,race:"asia",validator:U,human:1,strID:"a_peon",iconID:132,dieSound:ab,zLevel:1,time:8,peon:1,sight:5,url:l.asian_peasant,icons:[b.move,b.menuBuilds1,b.repair,b.conquest,
b.dcm,b.pickUp,b.explore,b.stop,b.stand,b.attack,b.sameSpeed,b.restoreSpeed],cost:[0,0,40,0],attDist:1,spd:50,clss:"peon",nocapture:1,size:1},{radix:0,name:"Ninja",race:"asia",attack:12,defence:5,mana:100,manaMax:100,health:90,maxHealth:90,img:l.asian_ninja,invType:0,invMax:8,attackSound:fc,validator:U,human:1,iconID:133,strID:"ninja",dieSound:ab,zLevel:1,time:20,standardFunc:D,sight:10,url:l.asian_ninja,icons:[b.guard,b.patrol,b.pickUp,b.explore,b.stop,b.stand,b.invisibility,b.murder,b.move,b.attack,
b.sameSpeed,b.restoreSpeed],cost:[120,0,0,0],attDist:1,spd:85,clss:"ninja",size:1,update:["mana","manaSpeed",1E3]},{radix:0,name:"Ronin",attack:7,defence:0,health:45,maxHealth:45,img:l.asian_ronin,invType:0,invMax:8,race:"asia",validator:U,human:1,standardFunc:D,iconID:141,strID:"ronin",dieSound:ab,zLevel:1,time:8,sight:5,url:l.asian_ronin,icons:d,cost:[0,0,40,0],attDist:1,spd:50,attackSound:fc,clss:"a_footman",size:1},{radix:0,name:"Archer",attack:5,defence:0,health:50,maxHealth:50,img:l.asian_archer,
invType:0,invMax:8,race:"asia",validator:U,human:1,strID:"a_archer",dieSound:ab,zLevel:1,attimg:l.arrow1,iconID:136,arrow:1,attackSound:Xc,time:12,sight:10,url:l.asian_archer,icons:d,cost:[0,20,40,0],standardFunc:D,spd:50,clss:"archer",size:1,attDist:6},{radix:0,name:"Samurai",attack:10,defence:4,health:90,maxHealth:90,img:l.asian_samurai,invType:0,race:"asia",strID:"samurai",invMax:8,attackSound:fc,validator:U,human:1,iconID:142,time:20,standardFunc:D,zLevel:1,dieSound:ab,sight:6,url:l.asian_samurai,
icons:d,cost:[50,0,150,0],attDist:1,spd:50,clss:"a_maceman",size:1},{radix:0,name:"Horse Archer",attack:7,defence:0,health:75,maxHealth:75,img:l.asian_horsarcher,invType:0,race:"asia",invMax:8,validator:U,human:1,attackSound:Xc,iconID:183,strID:"a_horse_archer",dieSound:Dd,time:20,standardFunc:D,sight:12,url:l.asian_horsarcher,zLevel:1,icons:d,arrow:1,attimg:l.arrow1,cost:[40,0,120,0],spd:85,clss:"horse_archer",size:1,attDist:7},{radix:0,name:"Horse Samurai",attack:14,defence:4,health:160,maxHealth:160,
img:l.asian_horsamurai,invType:0,invMax:8,validator:U,human:1,iconID:135,race:"asia",standardFunc:D,attackSound:Bd,time:22,zLevel:1,strID:"horse_samurai",dieSound:Dd,sight:5,url:l.asian_horsamurai,icons:d,cost:[75,0,120,0],attDist:1,spd:85,clss:"horse_samurai",size:1},{name:"Barracks",resistance:500,health:1400,maxHealth:1400,img:l.asia_barracks,invType:1,sound:Dg,invMax:0,time:60,dieSound:L,radix:0,sight:6,race:"asia",strID:"a_barrack",validator:P,zLevel:1,bimg:l.build5x5,dimg:l.des_5x5,child:[{img:l.asia_barracks_c,
x:0,y:0,mv:!0},{img:l.asia_barracks_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:146,icons:[b.createRonin,b.createArcher1,b.createSamurai,b.createHorseArcher1,b.createHorseSamurai,b.createChariot],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:l.asia_barracks,build:!0,cost:[0,200,0,200],size:1,clss:"barracks"},{name:"Chariot",attack:4,defence:3,health:180,maxHealth:180,img:l.asian_charriot,invType:0,radix:0,race:"asia",invMax:8,strID:"chariot",dieSound:["c%20die%201",
"c%20die%202","c%20die%203","c%20die%204","c%20die%205"],attackSound:Bd,validator:U,human:1,zLevel:1,iconID:175,standardFunc:D,time:8,sight:5,url:l.asian_charriot,icons:d,cost:[0,200,150,0],attDist:1,spd:85,clss:"chariot",size:1},{radix:1,name:"Galleon",attackSound:Cd,attack:35,attDist:12,race:"common",defence:0,health:1200,attackTime:2E3,maxHealth:1200,strID:"galleon",nu:b.createGalleon,img:l.galleon,invType:1,invMax:24,dieSound:["ship%20sink"],zLevel:0,validator:je,iconID:32,time:50,boat:!0,attimg:l.cb_metal,
attackDeg:20,sight:16,url:l.galleon,icons:[b.move,b.explore,b.unload,b.attack,b.attackGround,b.stop,b.stand,b.stop,b.stand,b.attack,b.steady,b.upgradeShip],cost:[0,1200,800,0],spd:50,nofreeze:1,clss:"galleon",standardFunc:D,size:1,peon:1},{radix:1,name:"Fishing Boat",attackSound:Cd,attack:0,attDist:8,race:"common",defence:0,health:50,boat:!0,nu:b.createFishingBoat,maxHealth:50,img:l.boat,invType:1,invMax:0,strID:"fishing_boat",dieSound:["ship%20sink"],zLevel:0,validator:je,iconID:184,nofreeze:1,time:50,
sight:16,url:l.boat,icons:[b.move,b.explore,b.stop,b.stand,b.fishing],cost:[0,200,100,0],spd:65,clss:"fishing_boat",size:1},{radix:1,name:"Hulk",attackSound:Cd,attack:18,attDist:10,race:"common",defence:0,health:700,maxHealth:700,strID:"hulk",img:l.hulk,invType:1,attackTime:2E3,boat:!0,nu:b.createHulk,attackDeg:20,invMax:16,dieSound:["ship%20sink"],zLevel:0,validator:je,iconID:128,time:30,sight:14,attimg:l.cb_metal,url:l.hulk,icons:[b.move,b.explore,b.unload,b.attack,b.attackGround,b.stop,b.stand,
b.stop,b.stand,b.attack,b.steady,b.upgradeShip],cost:[0,500,300,0],spd:65,nofreeze:1,clss:"hulk",standardFunc:D,size:1},{radix:1,name:"Pinque",attackSound:Xc,attack:10,race:"common",attDist:8,defence:0,health:300,boat:!0,maxHealth:300,img:l.xebec,attimg:l.arrow1,arrow:!0,strID:"pinque",invType:1,invMax:8,dieSound:["ship%20sink"],zLevel:0,validator:je,iconID:129,time:20,nofreeze:1,sight:12,url:l.xebec,icons:[b.move,b.explore,b.unload,b.attack,b.attackGround,b.stop,b.stand,b.stop,b.stand,b.attack,b.steady,
b.upgradeShip],cost:[0,300,200,0],spd:80,clss:"xebec",size:1,standardFunc:D,nu:b.createXebec},{radix:0,name:"Stone Golem",strID:"troll",defence:3,attack:25,health:400,maxHealth:400,img:l.troll,invType:0,invMax:0,dieSound:["golem"],validator:U,iconID:144,race:"common",zLevel:1,nofreeze:1,attackSound:["golem1","golem2"],sight:10,standardFunc:D,url:l.troll,icons:d,w:1,cost:[120,0,0,0,600],attDist:1,spd:56,clss:"troll",size:1},{radix:0,name:"Bat",strID:"bat",defence:0,attack:3,health:20,maxHealth:20,
img:l.bat,invType:0,invMax:0,race:"common",bat:1,dieSound:["bat%20die"],validator:Mf,iconID:105,zLevel:2,attackSound:["bat%20attack"],sight:10,standardFunc:D,url:l.bat,icons:d,w:1,cost:[0,0,0,0,25],attDist:1,spd:128,clss:"bat",size:1,z32:1.5},{race:"arab",invType:0,invMax:8,iconID:138,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_peasant,img:l.arab_peasant,spd:50,validator:U,human:1,icons:[b.move,b.menuBuilds2,b.repair,b.conquest,b.dcm,b.pickUp,b.explore,b.stop,b.stand,b.attack,b.convertJihad,
b.bribe,b.sameSpeed,b.restoreSpeed],name:"Peasant",clss:"peon",cost:[0,0,50,0],attDist:1,time:8,nocapture:1,peon:1,sight:5,health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:172,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_footman,img:l.arab_footman,standardFunc:D,spd:50,validator:U,human:1,attDist:1,icons:d,name:"Footman",clss:"footman",cost:[0,0,50,0],time:12,sight:5,health:50,attack:6,defence:1},{race:"arab",invType:0,invMax:8,iconID:170,zLevel:1,dieSound:[],
attackSound:[],size:1,radix:0,url:l.arab_archer,img:l.arab_archer,spd:50,validator:U,standardFunc:D,human:1,attimg:l.arrow1,arrow:1,icons:d,name:"Archer",clss:"archer",cost:[0,20,40,0],time:12,sight:10,attDist:6,health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:173,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_spearman,img:l.arab_spearman,spd:50,validator:U,standardFunc:D,human:1,icons:d,name:"Spearman",clss:"pikeman",attDist:1,cost:[40,0,60,0],time:14,sight:5,health:75,
attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:174,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,standardFunc:D,url:l.arab_satrap,img:l.arab_satrap,spd:50,validator:U,human:1,icons:d,name:"Satrap",attDist:1,clss:"maceman",cost:[0,0,120,0],time:14,sight:5,health:120,attack:8,defence:0},{race:"arab",invType:0,invMax:8,iconID:171,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_cavalry,standardFunc:D,img:l.arab_cavalry,spd:85,validator:U,human:1,attDist:1,icons:d,name:"Cavalry",
clss:"heavy_cavalry",cost:[60,0,100,0],time:14,sight:5,health:90,attack:10,defence:4},{race:"arab",invType:0,invMax:8,iconID:168,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_horse_archer,img:l.arab_horse_archer,spd:85,validator:U,human:1,standardFunc:D,icons:d,name:"Horse Archer",clss:"horse_archer",cost:[50,0,100,0],time:14,attimg:l.arrow1,arrow:1,sight:12,attDist:7,health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:179,zLevel:1,dieSound:[],attackSound:[],size:1,
radix:0,url:l.arab_jwarrior,img:l.arab_jwarrior,spd:50,validator:U,human:1,standardFunc:D,icons:d,name:"Jihad warrior",attDist:1,clss:"jihad_warrior",cost:[0,0,100,0],time:8,sight:5,health:75,attack:10,defence:2},{race:"arab",invType:0,invMax:8,iconID:176,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_priest,img:l.arab_priest,standardFunc:D,spd:50,mana:100,validator:U,human:1,icons:e,name:"Priest",clss:"priest",cost:[150,0,0,0],time:30,sight:21,attDist:18,health:60,attack:20,update:["mana",
"manaSpeed",1E3],manaMax:100,defence:0,attimg:l.flame_bolt,ball:1,attackOnly:ie.magic_creatures.obj},{race:"arab",invType:0,invMax:0,iconID:105,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:0,img:0,testing:1,illegal:1,spd:50,validator:U,human:1,icons:[],name:"Spy",clss:"spy",cost:150,time:30,sight:12,health:50,attack:20,defence:0},{race:"arab",invType:0,invMax:8,iconID:188,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,attimg:l.flame_bolt,url:l.arab_mage,img:l.arab_mage,spd:50,validator:U,
human:1,icons:[b.stop,b.pickUp,b.explore,b.createCarpet,b.createJinn,b.fireRain,b.magicVision,b.raiseDead,b.attack,b.stand,b.move],standardFunc:D,name:"Mage",clss:"mage",ball:1,mana:100,manaMax:100,update:["mana","manaSpeed",1E3],cost:[150,0,0,0],time:30,sight:15,attDist:10,health:60,attack:8,defence:0},{race:"arab",invType:1,invMax:8,iconID:126,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_caravan,img:l.arab_caravan,spd:75,validator:U,human:1,icons:[],name:"Caravan",clss:"trader",
cost:[0,0,500,0],time:30,sight:5,health:150},{race:"arab",invType:0,invMax:8,iconID:177,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_enichar,img:l.arab_enichar,spd:85,validator:U,human:1,standardFunc:D,icons:d,name:"Enichar",attDist:1,clss:"enichar",cost:[80,0,120,0],time:25,sight:5,health:130,attack:18,defence:4},{race:"arab",invType:1,invMax:0,iconID:82,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,population:10,url:l.arab_houses,
validator:P,build:1,icons:[],child:[{img:l.arab_houses_c}],name:"House",clss:"house",cost:[0,75,0,0],time:20,sight:4,resistance:50,health:500},{race:"arab",invType:1,invMax:0,iconID:85,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.arab_lumbermill,validator:P,build:1,icons:[b.techWoodCutting,b.techCrossbow],child:[{img:l.arab_lumbermill_c}],name:"Lumber Mill",clss:"lumber",cost:[0,100,0,0],storage:1,time:30,sight:4,resistance:80,health:800},
{race:"arab",invType:1,invMax:0,iconID:96,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_storage,validator:P,build:1,storage:0,icons:[b.techGoldMining,b.techStoneMining],child:[{img:l.arab_storage_c},{alpha:!0,img:l.arab_storage_s,rgb:[0,0,0,.5]}],name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:80,zLevel:1,dieSound:L,space:new Uint8Array([1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_farm,validator:P,build:1,icons:[b.createCow,b.techCropRotation,b.techDomestication,b.techCowPoaching,b.ridingHorses,b.techHorseManShip],child:[{img:l.arab_farm_c}],name:"Farm",storage:2,clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:81,zLevel:1,dieSound:L,validator:Lf,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:l.build_harbor,dimg:l.des_harbor,
radix:0,url:l.arab_harbour,build:1,icons:[b.createFishingBoat,b.createXebec,b.createHulk,b.techLandingTactics],child:[{img:l.arab_harbour_c},{alpha:!0,img:l.arab_harbour_s,rgb:[0,0,0,.5]}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,iconID:79,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.arab_blacksmith,validator:P,build:1,icons:[b.techTemperIron,b.techScaleArmor,
b.techScimitar,b.techChainMail,b.techHalberd],child:[{img:l.arab_blacksmith_c},{alpha:!0,img:l.arab_blacksmith_s,rgb:[0,0,0,.5]}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,150,0],onbuild:h,time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:95,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_workshop,validator:P,build:1,icons:[b.createCatapult,b.createBallist,b.techEngineering,b.techCannonTower],
child:[{img:l.arab_workshop_c},{alpha:!0,img:l.arab_workshop_s,rgb:[0,0,0,.5]}],name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:140,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.arab_church,validator:P,build:1,icons:[b.createPriest2],child:[{img:l.arab_church_c},{alpha:!0,img:l.arab_church_s,rgb:[0,0,0,.5]}],name:"Church",clss:"church",cost:[0,0,200,200],
time:40,sight:6,resistance:200,health:1E3},{race:"arab",invType:1,invMax:0,iconID:92,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_tavern,validator:P,build:1,icons:[b.createMercenaries,b.createHeroes],child:[{img:l.arab_tavern_c}],name:"Tavern",clss:"tavern",cost:[0,200,200,0],onbuild:m,actvintv:[b.iniMercenaries,b.iniHeroes],time:40,sight:5,resistance:150,health:1E3},{race:"arab",invType:1,invMax:0,iconID:87,zLevel:1,
dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_market,validator:P,build:1,icons:[b.createCaravan2],child:[{img:l.arab_market_c}],name:"Market",clss:"market",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,iconID:98,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.arab_barracks,validator:P,
build:1,icons:[b.createFootman2,b.createArcher2,b.createSatrap,b.createPikeman2,b.createHorseArcher2,b.createCavalry,b.createEnichar,b.createJihad],child:[{img:l.arab_barracks_c},{alpha:!0,img:l.arab_barracks_s,rgb:[0,0,0,.5]}],name:"Barracks",clss:"barrack",cost:[0,0,200,200],time:60,sight:6,resistance:500,health:1400},{race:"arab",invType:1,invMax:0,iconID:91,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_stables,validator:P,
build:1,icons:[],child:[{img:l.arab_stables_c}],name:"Stable",clss:"stable",cost:[0,200,200,0],time:40,onbuild:f,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:50,iconID:89,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_outpost,validator:P,build:1,icons:[b.emergeAllUnits],child:[{img:l.arab_outpost_c,mv:1},{alpha:!0,img:l.arab_outpost_s,rgb:[0,0,0,.5]}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],
time:60,sight:8,resistance:500,health:2E3},{race:"arab",invType:1,invMax:0,iconID:105,zLevel:1,dieSound:L,bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:0,img:0,validator:P,build:1,icons:[],child:[{img:3213123}],name:"NULL",testing:1,clss:"castle",cost:[0,1500,0,1500],time:120,sight:12,resistance:1E3,health:8E3},{race:"arab",invType:1,invMax:0,iconID:88,zLevel:1,dieSound:L,space:new Uint8Array([0,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,0,6]),bimg:l.build5x5,dimg:l.des_5x5,
radix:0,url:l.arab_mosque,validator:P,build:1,icons:[b.techFanaticism,b.techEspionage,b.techHealing,b.techBless,b.techJihad],child:[{img:l.arab_mosque_c},{alpha:!0,img:l.arab_mosque_s,rgb:[0,0,0,.5]}],name:"Mosque",onbuild:[b.buildChurch2],clss:"mosque",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:86,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_magetower,validator:P,
build:1,icons:[b.createMage2,b.techCarpet,b.techMagicWorkshop,b.techFireRain,b.techMagicVision,b.techNecromancy,b.techJinn],child:[{img:l.arab_magetower_c},{alpha:!0,img:l.arab_magetower_s,rgb:[0,0,0,.5]}],name:"Mage Guild",clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:93,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.arab_tc_guild,validator:P,
build:1,icons:[b.techUsury,b.techTradeRoutes,b.techSupplyStorage,b.techBribery,b.techOreFloatation],child:[{img:l.arab_tcguild_c},{alpha:!0,img:l.arab_tc_guild_s,rgb:[0,0,0,.5]}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,0,2E3],time:90,onbuild:[b.buildMarket2],sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:94,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.arab_waracademy,
validator:P,build:1,icons:[b.techHeroism,b.techWarfare,b.techMercenaries,b.techRiddingHorses,b.techBodyBuilding,b.techLeadership,b.techHeroes,b.techJanissary,b.techHonor,b.techFame],child:[{img:l.arab_waracademy_c},{alpha:!0,img:l.arab_waracademy_s,rgb:[0,0,0,.5]}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:158,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,
radix:0,url:l.arab_magicworkshop,validator:P,build:1,icons:[b.createObjects],child:[{img:l.arab_magicworkshop_c},{alpha:!0,img:l.arab_magicworkshop_s,rgb:[0,0,0,.5]}],name:"Magic Workshop",disallowPoint:!0,clss:"magicworkshop",cost:[0,0,0,300],time:20,sight:5,resistance:200,health:1200},{race:"asia",invType:1,invMax:0,iconID:161,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,0,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.asia_houses,validator:P,build:1,icons:[],child:[{img:l.asia_houses_c}],
name:"House",clss:"house",cost:[0,75,0,0],population:10,time:20,sight:4,resistance:50,health:500},{race:"asia",invType:1,invMax:0,iconID:149,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,storage:1,url:l.asia_lumbermill,validator:P,build:1,icons:[b.techWoodCutting,b.techCrossbow],child:[{img:l.asia_lumbermill_c},{img:l.asia_lumbermill_s,rgb:[0,0,0,.5],alpha:!0}],name:"Lumber Mill",clss:"lumber",cost:[0,100,0,0],time:30,sight:4,resistance:80,
health:800},{race:"asia",invType:1,invMax:0,iconID:154,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_storage,storage:0,validator:P,build:1,icons:[b.techGoldMining,b.techStoneMining],child:[{img:l.asia_storage_s,rgb:[0,0,0,.5],alpha:!0},{img:l.asia_storage_c}],name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:147,zLevel:1,dieSound:L,space:new Uint8Array([1,
1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,storage:2,url:l.asia_farm,validator:P,build:1,icons:[b.techCropRotation,b.ridingHorses,b.irrigation],child:[{img:l.asia_farm_c}],name:"Farm",clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:148,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,1,1,1,1,1,1,3]),validator:Lf,bimg:l.build_harbor,dimg:l.des_harbor,radix:0,url:l.asia_harbor,build:1,icons:[b.createFishingBoat,
b.createXebec,b.createHulk,b.techLandingTactics],child:[{img:l.asia_harbor_c},{img:l.asia_harbor_s,rgb:[0,0,0,.5],alpha:!0}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:145,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asia_blacksmith,validator:P,build:1,icons:[b.techTemperIron,b.techScaleArmor,b.techArmoredChariot,b.techChainMail],
child:[{img:l.asia_blacksmith_c},{img:l.asia_blacksmith_s,rgb:[0,0,0,.5],alpha:!0}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,150,0],time:40,sight:5,onbuild:h,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:157,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_workshop,validator:P,build:1,icons:[b.createCatapult,b.createBallist,b.techEngineering,b.techCannonTower],child:[{img:l.asia_workshop_c,x:0,
y:0},{img:l.asia_workshop_s,rgb:[0,0,0,.5],alpha:!0}],name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:162,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,0,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,1,0,0,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asian_monastery,validator:P,build:1,icons:[b.createMonk,b.createPriest1],child:[{img:l.asian_monastery_c},{img:l.asian_monastery_s,rgb:[0,0,0,.5],alpha:!0}],name:"Monastery",
clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"asia",invType:1,invMax:0,iconID:155,zLevel:1,dieSound:L,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_tavern,validator:P,build:1,icons:[b.createMercenaries,b.createHeroes],child:[{img:l.asia_tavern_c},{img:l.asia_tavern_s,rgb:[0,0,0,.5],alpha:!0}],onbuild:m,name:"Tavern",clss:"tavern",actvintv:[b.iniMercenaries,b.iniHeroes],cost:[0,200,200,0],time:40,sight:5,
resistance:150,health:1E3},{race:"asia",invType:1,invMax:0,iconID:150,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_market,validator:P,build:1,icons:[],child:[{img:l.asia_market_c}],name:"Market",clss:"market",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:153,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,
radix:0,url:l.asia_stables,validator:P,build:1,icons:[],child:[{img:l.asia_stables_c,mv:!0},{img:l.asia_stables_s,rgb:[0,0,0,.5],alpha:!0}],name:"Stable",clss:"stable",onbuild:f,cost:[0,200,200,0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:151,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.asia_outpost,validator:P,build:1,icons:[b.emergeAllUnits],child:[{img:l.asia_outpost_c,mv:1},{img:l.asia_outpost_s,
rgb:[0,0,0,.5],alpha:!0}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},{race:"asia",invType:1,invMax:0,iconID:163,zLevel:1,dieSound:L,space:new Uint8Array([0,0,1,1,0,0,0,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,0,6]),bimg:l.build6x6,dimg:l.des_6x6,radix:0,url:l.asia_shao_lin,validator:P,build:1,icons:[b.techMeditation,b.techKungFu,b.techHealing,b.techPhilosophy,b.techNinjas,b.techMastery,b.techTournaments,b.techMedicine],child:[{img:l.asia_shao_lin_c},
{img:l.asia_shao_lin_s,rgb:[0,0,0,.5],alpha:!0}],name:"Shao Linn",onbuild:[b.buildChurch1],clss:"shaolinn",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:152,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asia_wizardguild,validator:P,build:1,icons:[b.createMage1,b.techConcentration,b.techWhirlpool,b.techFlameBolt,b.techTurnToStone,b.techConfusion,b.techDragon],
child:[{img:l.asia_wizardguild_c},{img:l.asia_wizardguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Mage Guild",clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:159,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asia_tcguild,validator:P,build:1,icons:[b.techTradeRoutes,b.techUsury,b.techJewelry,b.techSupplyStorage,b.techBanking,b.techChemistry,
b.techSeaFood,b.techGunPowder,b.techRocketArrow],child:[{img:l.asia_tcguild_c,mv:!0},{img:l.asia_tcguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,0,2E3],time:90,onbuild:[b.buildMarket1],sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:156,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asia_warguild,validator:P,build:1,icons:[b.techBushido,b.techHeroism,
b.techWarfare,b.techMercenaries,b.techLeadership,b.techTactics,b.techHeroes,b.techHonor,b.techSunTzu],child:[{img:l.asia_warguild_c,mv:!0},{img:l.asia_warguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:0,invMax:0,iconID:166,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.asian_priest,img:l.asian_priest,spd:50,validator:U,human:1,icons:[b.attack,b.stop,b.stand,b.pickUp,b.explore,b.healing,
b.teach,b.move],name:"Priest",clss:"priest",cost:[170,0,0,0],time:30,sight:21,health:120,standardFunc:D,attDist:1,attack:10,defence:10,mana:100,update:["mana","manaSpeed",1E3],manaMax:100},{race:"asia",invType:0,invMax:0,iconID:187,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.asian_monk,img:l.asian_monk,spd:50,validator:U,human:1,icons:d,name:"Monk",standardFunc:D,clss:"monk",cost:[0,0,200,0],time:20,sight:5,health:90,attack:6,defence:6,attDist:1},{race:"asia",invType:0,invMax:0,iconID:134,
zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.asian_mage,img:l.asian_mage,spd:50,attimg:l.flame_bolt,validator:U,standardFunc:D,human:1,icons:[b.stop,b.pickUp,b.explore,b.confusion,b.turnToStone,b.whirlpool,b.flameBolt,b.createDragon,b.attack,b.stand,b.move],name:"Mage",clss:"mage",cost:[150,0,0,0],ball:1,time:30,sight:15,mana:100,attDist:10,health:60,attack:8,defence:0,update:["mana","manaSpeed",1E3],manaMax:100},{radix:0,name:"Dragon",strID:"dragon",defence:0,attack:25,health:300,maxHealth:300,
img:l.dragon,invType:0,invMax:0,dieSound:[],sSizex:2,sSizey:2,dragon:1,iconID:160,race:"common",zLevel:2,nofreeze:1,attackSound:[],sight:12,standardFunc:D,url:l.dragon,icons:d,cost:[80,0,0,0,800],attDist:2,spd:128,clss:"drg",size:1,z32:1.5,validator:Mf},{radix:0,name:"Carpet",strID:"carpet",defence:0,attack:0,health:90,maxHealth:90,img:l.carpet,invType:1,invMax:8,dieSound:[],iconID:131,race:"common",zLevel:2,nofreeze:1,attackSound:[],sight:8,url:l.carpet,icons:[b.move,b.unload,b.explore,b.stop,b.stand],
cost:[80,0,0,0,500],attDist:2,spd:120,clss:"carpet",size:1,z32:1.5,validator:Mf},{radix:0,name:"Jinn",strID:"jinn",defence:5,attack:20,health:300,maxHealth:300,img:l.arab_jinn,invType:0,invMax:0,dieSound:[],validator:U,iconID:182,race:"common",zLevel:1,nofreeze:1,attackSound:[],sight:8,standardFunc:D,url:l.arab_jinn,icons:d,w:1,cost:[80,0,0,0,300],attDist:1,spd:85,clss:"jinn",size:1}];C(A[105].space);Fd={};Nh={arr:[]};pa={euro:[],asia:[],arab:[],common:[]};Dk=[];bb=[[],[],[],[],[],[]];n=0;for(m=A.length;n<
m;n++){g=A[n];A[n].type=n;var z=g.space;g.name.split(" ").join("");g.population&&Dk.put(g);Fd[n]={};void 0!==g.storage&&(-1<g.storage?(0===g.storage&&bb[3].put(n),bb[g.storage].put(n)):(bb[0].put(n),bb[1].put(n),bb[2].put(n),bb[3].put(n)));ta[g.race][g.name.toLowerCase().split(" ").join("")]=g;g.icons.menuName=g.strID;Nh[g.name]=n;Nh.arr.put(n);g.img||(g.img=g.url);g.maxHealth=g.health;g.race&&pa[g.race].put(g);f=0;e=g.icons;for(k=e.length;f<k;f++)(h=e[f])&&h.obj&&(h.orderOrigin=g);if(z){f=[];g.free=
f;k=z[z.length-1];c=(z.length-1)/k;g=k+2;var x=c+2;e=new Uint8Array(g*x);for(h=0;h<c;h++)for(var y=0;y<k;y++)e[(h+1)*g+y+1]=z[y+h*k];h=0;for(k=g*x;h<k;h++)!e[h]&&(e[h+1]||e[h-1]||e[h+1+g]||e[h+1-g]||e[h-1+g]||e[h-1-g]||e[h+g]||e[h-g])&&(f.put(h%g-1),f.put(~~(h/g)-1))}}pa.euro=pa.euro.concat(pa.common);pa.asia=pa.asia.concat(pa.common);pa.arab=pa.arab.concat(pa.common);pa[0]=pa.euro;pa[1]=pa.arab;pa[2]=pa.asian;e=ta.euro;k=ta.asia;h=ta.arab;m=ta.common;ta[0]=ta.euro;ta[1]=ta.arab;ta[2]=ta.asia;he||
(d.cut=I({a:"attack",g:"guard",r:"patrol",p:"pickUp",e:"explore",s:"stop",n:"stand"}),e.tavern.icons.cut=I({t:"trade1",g:"gamble",m:"createMercenaries",h:"createHeroes",l:"loan"}),e.castle.icons.cut=I({p:"createPeon",s:"createSpy",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning"}),k.castle.icons.cut=I({p:"createPeon1",n:"createNina",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning",b:"techBudhism",w:"techGreatwall"}),h.castle.icons.cut=I({p:"createPeon2",
s:"createSpy",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning",y:"techSlavery"}),e.barracks.icons.cut=I({f:"createFootman",a:"createArcher",m:"createMaceman",p:"createPikeman",l:"createLongbowman",k:"createKnight"}),k.barracks.icons.cut=I({r:"createRonin",a:"createArcher1",s:"createSamurai",h:"createHorseArcher1",o:"createHorseSamurai",c:"createChariot"}),h.barracks.icons.cut=I({f:"createFootman2",a:"createArcher2",s:"createSatrap",p:"createPikeman2",h:"createHorseArcher2",
c:"createCavalry",j:"createEnichar",d:"createJihad"}),e.magetower.icons.cut=I({m:"createMage"}),k.mageguild.icons.cut=I({m:"createMage1"}),h.mageguild.icons.cut=I({m:"createMage2"}),e.peasant.icons.cut=I({b:"menuBuilds",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",i:"bribe"}),h.peasant.icons.cut=I({b:"menuBuilds2",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",j:"become_jihadw",i:"bribe"}),k.peasant.icons.cut=I({b:"menuBuilds1",
r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",t:"trade"}),e.priest.icons.cut=I({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",b:"bless"}),h.priest.icons.cut=I({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",b:"bless"}),k.priest.icons.cut=I({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",r:"raiseexp"}),e.wizard.icons.cut=I({m:"move",a:"attack",s:"stop",n:"stand",l:"lightning",b:"createBat",f:"freeze",t:"createGolem",
i:"invisibility"}),h.mage.icons.cut=I({m:"move",a:"attack",s:"stop",n:"stand",c:"spell_spawncarpet",j:"spell_spawnjin",r:"spell_firerain",v:"spell_magicvision",d:"raisedead"}),k.mage.icons.cut=I({m:"move",a:"attack",s:"stop",n:"stand",h:"spell_hypnotize",t:"spell_turntostone",w:"spell_whirlpool",f:"spell_flamebolt",d:"spell_spawndragon"}),m.spy.icons.cut=I({a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",n:"stand",s:"stop"}),k.monk.icons.cut=I({a:"attack",g:"guard",r:"patrol",p:"pick_item",
e:"explore",s:"stop",n:"stand"}),k.ninja.icons.cut=I({a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",s:"stop",n:"stand",c:"cloak",u:"murder"}),m.catapult.icons.cut=I({a:"attack",g:"guard",p:"patrol",e:"explore",s:"stop",n:"stand",r:"attack_ground",h:"hold_steady"}),e.market.icons.cut=I({c:"createCaravan"}),h.market.icons.cut=I({c:"createCaravan2"}),k.market.icons.cut=I({b:"market_items",s:"market_sell"}),e.workshop.icons.cut=I({c:"createCatapult",h:"createHeavyCatapult",b:"createBallista",
e:"techEngineering",t:"techCannonTower"}),h.workshop.icons.cut=I({c:"createCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),k.workshop.icons.cut=I({c:"createCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),e.church.icons.cut=I({p:"createPriest"}),h.church.icons.cut=I({p:"createPriest2"}),k.monastery.icons.cut=I({m:"createMonk",p:"createPriest1"}),h.magicworkshop.icons.cut=I({i:"build_item"}),f=I({c:"buildCastle",s:"buildStorage",b:"buildBarrack",k:"buildBlacksmith",
f:"buildFarm",l:"buildLumbermill",p:"buildWorkshop",e:"buildCathedral",u:"buildChurch",n:"buildTavern",m:"buildMageTower",a:"buildStable",r:"buildHarbor",o:"buildOutpost",i:"buildFields",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse",g:"buildGateWood",y:"buildDummy"}),n=I({c:"buildCastle2",k:"buildBlacksmith2",f:"buildFarm2",n:"buildTavern2",b:"buildBarrack2",p:"buildWorkshop2",s:"buildStorage2",a:"buildStable2",l:"buildLumbermill2",r:"buildHarbor2",o:"buildOutpost2",u:"buildChurch2",
e:"buildMosque",i:"buildFields",m:"buildMageTower2",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse2",g:"buildGateWood"}),g=I({c:"buildCastle1",f:"buildFarm1",e:"buildShaolinn",n:"buildTavern1",b:"buildBarrack1",p:"buildWorkshop1",s:"buildStorage1",k:"buildBlacksmith1",a:"buildStable1",l:"buildLumbermill1",r:"buildHarbor1",o:"buildOutpost1",u:"buildChurch1",i:"buildFields",m:"buildMageTower1",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse1",g:"buildGateWood"}),Nf.cut=
g,Of.cut=g,Pf.cut=f,Qf.cut=f,Rf.cut=f,Sf.cut=g,Tf.cut=f,Uf.cut=g,Vf.cut=n,Wf.cut=n,Xf.cut=n,Yf.cut=n,e.lumbermill.icons.cut=I({b:"techLongbow",w:"techWoodCutting",c:"techCrossbow"}),h.lumbermill.icons.cut=I({w:"techWoodCutting",c:"techCrossbow"}),k.lumbermill.icons.cut=I({w:"techWoodCutting",c:"techCrossbow"}),e.blacksmith.icons.cut=I({p:"techPlateArmor",t:"techTemperIron",s:"techScaleArmor",h:"techHalberd",c:"techChainMail"}),h.blacksmith.icons.cut=I({t:"techTemperIron",a:"techScaleArmor",s:"techScimitar",
c:"techChainMail",h:"techHalberd"}),k.blacksmith.icons.cut=I({t:"techTemperIron",a:"techScaleArmor",r:"techArmoredChariot",c:"techChainMail"}),e.outpost.icons.cut=I({e:"emergeAllUnits"}),h.outpost.icons.cut=I({e:"emergeAllUnits"}),k.outpost.icons.cut=I({e:"emergeAllUnits"}),m.watchtower.icons.cut=I({a:"attack",s:"stop",g:"upgradeGuildTower"}),m.guardtower.icons.cut=I({a:"attack",s:"stop",g:"upgradeStoneTower",c:"upgradeCannonTower"}),m.keeptower.icons.cut=I({a:"attack",s:"stop",c:"upgradeCannonTower"}),
m.cannontower.icons.cut=I({a:"attack",r:"attack_ground",s:"stop",h:"holdfire"}),k.rockettower.icons.cut=I({a:"attack",r:"attack_ground",s:"stop",f:"fireatwill"}),e.harbor.icons.cut=I({f:"createFishingBoat",x:"createXebec",h:"createHulk",g:"createGalleon",t:"te_landingtactics"}),h.harbor.icons.cut=I({f:"createFishingBoat",h:"createHulk",x:"createXebec",t:"te_landingtactics"}),k.harbor.icons.cut=I({f:"createFishingBoat",h:"createHulk",x:"createXebec"}),e.farm.icons.cut=I({c:"createCow",f:"techCropRotation",
d:"techDomestication"}),h.farm.icons.cut=I({c:"createCow",f:"techDomestication",d:"techDomestication",p:"techCowPoaching",r:"ridingHorses",h:"techHorseManShip"}),k.farm.icons.cut=I({f:"techDomestication",a:"ridingHorses",i:"irrigation"}),e.storage.icons.cut=I({g:"techGoldMining",s:"techStoneMining"}),h.storage.icons.cut=I({g:"techGoldMining",s:"techStoneMining"}),k.storage.icons.cut=I({g:"techGoldMining",s:"techStoneMining"}),e.cathedral.icons.cut=I({c:"createCrusaders"}),m.magicgateway.icons.cut=
I({o:"createOrk",d:"createDwarf",g:"createGhost",s:"createSkeleton"}));f=[e.knight,k.horsesamurai,h.cavalry,h.enichar,e.crusader,k.chariot,k.horsearcher,h.horsearcher];n=[k.horsesamurai,e.crusader,h.enichar];g=[e.knight,h.cavalry,k.chariot,k.horsearcher,h.horsearcher];d=[e.longbowman,h.archer,k.archer,e.archer];c=[m.catapult,m.ballista,m.heavycatapult];z=[m.galleon,m.hulk,m.pinque,m.fishingboat];x=[m.galleon,m.hulk,m.pinque];y=[h.satrap,e.maceman];var B=[e.longbowman,h.archer,k.archer,e.archer,k.horsearcher,
h.horsearcher,m.pinque,m.watchtower,m.keeptower,m.guardtower],G=[m.stonegolem,m.ork,m.dwarf,m.skeleton,m.ghost,m.dragon,m.jinn,m.bat,e.wizard,h.mage,k.mage],H=[e.peasant,k.peasant,h.peasant,e.footman,h.footman,k.ronin,e.pikeman,h.spearman,h.satrap,e.maceman,h.cavalry,h.jihadwarrior,m.spy,h.enichar,k.horsesamurai,k.monk,k.chariot,k.ninja,m.stonegolem,m.ork,m.dwarf,m.jinn,m.skeleton,m.ghost,e.knight,e.crusader],J=[m.watchtower,m.keeptower,m.guardtower,m.cannontower],K=[m.cannontower,k.rockettower],
M=[e.cathedral,e.castle,m.woodenwall,e.barracks,e.lumbermill,e.magetower,e.warriorsguild,e.storage,e.farm,e.merchantsguild,e.church,e.blacksmith,e.stable,e.workshop,e.tavern,e.house,m.watchtower,e.market,e.outpost,m.bridge,e.harbor,m.guardtower,m.keeptower,m.cannontower,k.rockettower,k.castle,h.castle,k.barracks,h.house,h.lumbermill,h.storage,h.farm,h.harbor,h.blacksmith,h.workshop,h.church,h.tavern,h.market,h.barracks,h.stable,h.outpost,h.mosque,h.mageguild,h.merchantsguild,h.warriorsguild,h.magicworkshop,
k.house,k.lumbermill,k.storage,k.farm,k.harbor,k.blacksmith,k.workshop,k.monastery,k.tavern,k.market,k.stable,k.outpost,k.shaolinn,k.mageguild,k.merchantsguild,k.warriorsguild],T=[e.cathedral,e.castle,m.woodenwall,e.barracks,e.lumbermill,e.magetower,e.warriorsguild,e.storage,e.farm,e.merchantsguild,e.church,e.blacksmith,e.stable,e.workshop,e.tavern,e.house,m.watchtower,e.market,e.outpost,m.bridge,e.harbor,k.castle,h.castle,k.barracks,h.house,h.lumbermill,h.storage,h.farm,h.harbor,h.blacksmith,h.workshop,
h.church,h.tavern,h.market,h.barracks,h.stable,h.outpost,h.mosque,h.mageguild,h.merchantsguild,h.warriorsguild,h.magicworkshop,k.house,k.lumbermill,k.storage,k.farm,k.harbor,k.blacksmith,k.workshop,k.monastery,k.tavern,k.market,k.stable,k.outpost,k.shaolinn,k.mageguild,k.merchantsguild,k.warriorsguild],R=[m.catapult,m.heavycatapult],X=[e.pikeman,h.spearman],Y=[k.monk,k.priest],Z=[m.woodenwall],aa=[e.peasant,k.peasant,h.peasant],ba=[e.wizard,h.mage,k.mage],da=[e.footman,h.footman,k.ronin],fa=[e.priest,
h.priest,k.priest];gc={bless:{img:l.bless,d:0,mv:1},star:{img:l.star,d:0,mv:1},heal:{img:l.healing,d:0,mv:1},impersonate:{img:l.impersonate,d:0,mv:1},select:{img:l.select,d:0,mv:0,select:1,z32:.8},spawn:{img:l.spawn,d:0,mv:1},curse:{img:l.curse,d:0,mv:1},turnStone:{img:l.turn_to_stone,d:0,mv:1}};var Q=function(c,b,d){for(var e=c.length,k=0,f=b.length;k<f;k++)for(var g=0;g<e;g++)Fd[c[g].type][b[k].type]=d};Q(K,x,4);Q(x,x,3);Q(x,T,3);Q(x,J,3);Q(x,Z,5);Q(x,c,2);Q(R,T,4);Q(R,z,4);Q(R,J,6);Q(R,c,4);Q(R,
Z,9);Q([k.samurai],n,.5);Q([k.samurai],g,.3);Q([k.ronin],aa,1);Q(X,f,6);Q(da,X,1.5);Q(da,d,1.5);Q(da,[h.jihadwarrior],1);Q([h.satrap],aa,2);Q(y,c,1.5);Q(B,[m.dragon],.75);Q(B,[m.bat],1);Q(B,[e.pikeman],-.75);Q(B,y,1);Q(B,[k.chariot],-.3);Q(B,Y,.5);Q(ba,fa,4);Q(fa,ba,3);Q(fa,G,3);Q(H,[m.bat],-.2);Q(H,[m.dragon],-.5);Q([m.stonegolem],M,1);Q([m.dwarf],M,4);Q(G,[k.priest],-.5);g=ka;d=Object.keys(g);for(f=0;f<A.length;f++)for(c=A[f],n=0;n<d.length;n++)c[d[n]]=g[d[n]];window.Utype={archer:[e.archer,e.longbowman,
k.archer,k.horsearcher,h.archer,h.horsearcher],sword:[e.footman,e.maceman,e.knight,e.crusader,e.pikeman,h.jihadwarrior,h.cavalry,h.footman,h.enichar,e.peasant,h.peasant,h.satrap,h.spearman,m.spy,k.chariot,k.monk,k.samurai,k.ronin,k.horsesamurai,k.ninja,k.peasant,m.skeleton,m.ghost,m.ork,m.dwarf],allunits:[e.footman,e.maceman,e.knight,e.crusader,e.pikeman,h.jihadwarrior,h.cavalry,h.footman,h.enichar,e.peasant,h.peasant,h.satrap,h.spearman,m.spy,k.chariot,k.monk,k.samurai,k.ronin,k.horsesamurai,k.ninja,
k.peasant,e.archer,e.longbowman,k.archer,k.horsearcher,h.archer,h.horsearcher,e.wizard,h.mage,k.mage,e.priest,h.priest,k.priest,m.skeleton,m.ghost,m.ork,m.dwarf],allbuildings:[],priest:[e.priest,h.priest,k.priest],catapults:[m.ballista,m.catapult,m.heavycatapult],kungfu:[k.peasant,k.ninja,k.monk,k.priest],peasants:[e.peasant,h.peasant,k.peasant]};F=[{name:["Longbow","Allows the production of longbowmen"],next:[b.createLongbowman],cost:[400,0,0,0],time:45,type:W},{name:["Gold Mining","Increases gold production"],
increase:2,value:"gold",cost:[400,0,0,0],time:20,type:Ja},{name:["Stone Mining","Increases stone production"],increase:2,value:"stone",cost:[400,0,0,0],time:20,type:Ja},{name:["Wood Cutting","Increases wood production"],increase:2,value:"wood",cost:[400,0,0,0],time:20,type:Ja},{name:["Temper Iron","Increases hand-to-hand units' attack power"],increase:2,value:"attack",cost:[400,0,0,0],time:30,group:Utype.sword,next:[b.techHalberd],type:Ua},{name:["Scale Armor","Increases unit's defense"],increase:1,
value:"defence",cost:[400,0,0,0],time:30,group:Utype.allunits,next:[b.techChainMail],type:Ua},{name:["Halberd","Allows the production of spear units"],next:[b.createPikeman,b.createPikeman2],cost:[400,0,0,0],time:30,type:W},{name:["Domestication","Allows the production of cows"],next:[b.createCow],cost:[300,0,0,0],time:20,type:W},{name:["Crop Rotation","Increases the production of fields"],increase:2,value:"food",cost:[400,0,0,0],time:20,type:Ja,next:[b.irrigation]},{name:["Chain Mail","Increases unit's defense"],
increase:2,value:"defence",cost:[400,0,0,0],time:30,group:Utype.allunits,type:Ua},{name:["Plate Armor","Allows the production of knights"],next:[b.createKnight],cost:[400,0,0,0],time:60,type:W},{name:["Crossbow","Increases arrow units' attack power"],increase:2,value:"attack",cost:[400,0,0,0],time:30,group:Utype.archer,type:Ua},{name:["Feudalism","Makes peasants cheaper"],cost:[300,0,0,0],time:30,decrease:[k.peasant,[0,0,8,0],e.peasant,[0,0,10,0],h.peasant,[0,0,10,0]],type:ah,next:[b.techSlavery]},
{name:["Architecture","Peasants build faster, and allows stone wall, gate and towers"],increase:.5,value:"buildSpeed",cost:[300,0,0,0],time:30,type:Ja,next:[b.upgradeStoneTower,b.techGreatWall,b.buildBridge]},{name:["Learning","Allows units to gather experience"],increase:1,value:"experience",cost:[400,0,0,0],time:30,type:Ja,next:[b.buildAcademy,b.buildAcademy1,b.buildAcademy2]},{name:["Convert Resources",""],cost:[400,0,0,0],time:30},{name:["Map Making","Allows the production of galleons"],cost:[800,
0,0,0],time:30,type:W,next:[b.createGalleon]},{name:["Trade Routes","Allows trading"],cost:[400,0,0,0],time:30,type:W,next:[b.techTradeTaxes]},{name:["Trade Taxes","Increases trade profit"],cost:[400,0,0,0],time:30},{name:["Usury","Allows the obtaining of loans in taverns"],cost:[300,0,0,0],time:30,type:Re,next:[b.techBanking]},{name:["Supply Storage","Increases the population limit"],cost:[500,0,0,0],time:30,increase:50,type:Ja,value:"popLimit",next:[b.techSeaFood]},{name:["Bribery","Allows the bribing of enemy units"],
cost:[600,0,0,0],time:60,type:W,next:[b.bribe]},{name:["Heroism","Allows unlimited experience"],cost:[500,0,0,0],time:30,increase:Infinity,value:"maxLevel",type:Ja,next:[b.techLeadership]},{name:["Warfare","Gain experience faster"],cost:[400,0,0,0],time:30,type:Ja,increase:1,value:"experience",next:[b.techTactics]},{name:["Tactics","Gain experience faster"],cost:[800,0,0,0],time:30,type:W,next:[b.buildDummy,b.techSunTzu]},{name:["Mercenaries","Allows the recruitment of units in taverns"],cost:[600,
0,0,0],time:30,type:Re,next:[b.techHeroes,b.createMercenaries],actvintv:[b.iniMercenaries]},{name:["Heroes' Quest","Allows the recruitment of heroes in taverns"],cost:[800,0,0,0],time:30,type:Re,next:[b.techFame,b.createHeroes],actvintv:[b.iniHeroes]},{name:["Fame","Recruit better units from taverns"],cost:[500,0,0,0],time:30,value:"fameTech",increase:1,type:Ja},{name:["Siege Tactics","Allows the production of heavy catapults"],cost:[1200,0,0,0],time:60,type:W,next:[b.createHeavyCatapult]},{name:["Body Building",
"Increases unit's hit points at every new level"],cost:[800,0,0,0],time:60,value:"healthJump",increase:5,type:Ja},{name:["Espionage","Allows the production of a spy"],cost:[400,0,0,0],time:30,type:W,next:[b.createSpy]},{name:["Fanaticism","Increases the building's resistance"],cost:[400,0,0,0],time:30,type:Ua,group:Utype.allbuildings,increase:5,value:"resistance",next:[b.techCrusade,b.techJihad]},{name:["Crusade","Allows the preaching of a crusade"],cost:[1200,0,0,0],time:180,type:W,next:[b.createCrusaders]},
{name:["Inquisition","Increases priest attack"],cost:[400,0,0,0],time:30,type:Ua,group:Utype.priest,increase:5,value:"attack"},{name:["Healing","Allows healing of units"],cost:[400,0,0,0],time:30,next:[b.techMedicine,b.healing],type:W},{name:["Medicine","Allows remote healing of units"],cost:[500,0,0,0],time:30,value:"healingRange",increase:5,type:Ja},{name:["Bless","Temporarily increases unit attack skill"],cost:[400,0,0,0],time:30,type:W,next:[b.bless]},{name:["Invisibility","Invisibility spell"],
cost:[500,0,0,0],time:30,type:W,next:[b.invisibility]},{name:["Bat","Researches bat summoning"],cost:[400,0,0,0],time:240,type:W,next:[b.createBat]},{name:["Freeze","Freeze spell"],cost:[800,0,0,0],time:30,type:W,next:[b.freeze]},{name:["Lightning","Lightning spell"],cost:[400,0,0,0],time:30,type:W,next:[b.lightning]},{name:["Stone Golem","Researches stone golem summoning"],cost:[800,0,0,0],time:120,type:W,next:[b.createGolem]},{name:"Upgrade to Guard Tower",cost:[0,600,0,0],time:20,type:Qe,obj:44,
upgrade:1},{name:"Upgrade to Stone Tower",cost:[0,0,0,500],time:30,type:Qe,obj:55,upgrade:1},{name:"Upgrade to Cannon Tower",cost:[0,0,0,500],time:30,type:Qe,obj:56,upgrade:1},{name:["Buddhism"],cost:[400,0,0,0],time:30,type:W,next:[b.buildCathedral1]},{name:["Cannon Tower","Allows the building of cannon towers"],next:[b.upgradeCannonTower],cost:[400,0,0,0],time:30,type:W},{name:["Engineering","Increases siege weapon's attack"],increase:5,value:"attack",cost:[400,0,0,0],time:30,group:Utype.catapults,
type:Ua},{name:["Great Wall","Makes stone walls, towers and gates stronger"],cost:[600,0,0,0],time:30,type:W},{name:["Art of Riding","Allows the production of horse archers"],cost:[500,0,0,0],time:30,type:W,next:[b.createHorseArcher1,b.createHorseArcher2,b.techHorseManShip]},{name:["Irrigation","Increases field production"],increase:4,value:"food",cost:[400,0,0,0],time:30,type:Ja},{name:["Armored Chariot","Allows the production of armored chariots"],cost:[500,0,0,0],time:60,type:W,next:[b.createChariot]},
{name:["Meditation","Makes monks cheaper"],cost:[300,0,0,0],time:30,decrease:[0,0,50,0],type:$g,next:[b.techPhilosophy],group:[k.monk]},{name:["Kung-Fu","Increases the attack of all kung-fu units"],cost:[400,0,0,0],time:30,type:Ua,increase:1,value:"attack",group:Utype.kungfu,next:[b.techMastery,b.techNinjas,b.techTournaments]},{name:["Tournaments","Allows sharing of experience between kung-fu units"],cost:[800,0,0,0],time:30,type:W,next:[]},{name:["Philosophy","Allows the production of more experienced monks"],
cost:[400,0,0,0],time:30,type:Ua,increase:2,value:"level",group:[k.monk,k.priest],next:[b.createPriest1]},{name:["Ninjas","Allows the production of ninjas"],cost:[500,0,0,0],time:30,type:W,next:[b.createNinja]},{name:["Mastery","Allows priests to teach kung-fu units"],cost:[500,0,0,0],time:30,type:W,next:[b.teach]},{name:["Concentration","Allows faster manna restoration"],cost:[600,0,0,0],time:80,type:W,next:[b.techConfusion]},{name:["Confusion","Researches the Confusion spell"],cost:[400,0,0,0],
time:30,type:W,next:[b.confusion]},{name:["Whirlpool","Researches the Whirlpool spell"],cost:[300,0,0,0],time:30,type:W,next:[b.whirlpool]},{name:["Dragon","Researches Dragon summoning"],cost:[800,0,0,0],time:300,type:W,next:[b.createDragon]},{name:["Turn to Stone","Researches the Turn to Stone spell"],cost:[300,0,0,0],time:30,type:W,next:[b.turnToStone]},{name:["Flame Bolt","Researches the Flame Bolt spell"],cost:[400,0,0,0],time:30,type:W,next:[b.techDragon,b.flameBolt]},{name:["Jewelry","Allows trading of items"],
cost:[400,0,0,0],time:30,type:W,next:[b.sellItems,b.buyItems]},{name:["Banking","Increases trade profit"],cost:[600,0,0,0],time:30,type:W},{name:["Chemistry","Increases arrow units' attack power"],cost:[500,0,0,0],time:30,type:Ua,group:Utype.archer,increase:1,value:"attack",next:[b.techGunPowder]},{name:["Sea Food","Increases the population limit"],cost:[500,0,0,0],time:30,increase:50,type:Ja,value:"popLimit"},{name:["Gun Powder","Increases cannon tower's attack power"],cost:[500,0,0,0],time:30,type:Ua,
increase:10,value:"attack",group:[m.cannontower],next:[b.techRocketArrow]},{name:["Rocket Arrow","Allows the building of rocket tower"],cost:[800,0,0,0],time:30,type:W,next:[b.buildRocketTower]},{name:["Bushido","Allows the production of horse samurai"],cost:[800,0,0,0],time:120,type:W,next:[b.createHorseSamurai]},{name:["Leadership","Units around a hero gain experience"],cost:[600,0,0,0],time:30,type:W,next:[b.techHonor]},{name:["Honor","Hero vs. hero attack bonus"],cost:[500,0,0,0],time:30,type:W},
{name:["Sun Tzu's Book","Increases the speed of learning"],cost:[800,0,0,0],time:30,type:Ja,increase:1,value:"experience"},{name:["Cow Poaching","Allows peasants to steal cows"],cost:[200,0,0,0],time:30,type:Ja,increase:1,value:"stealCows"},{name:["Horsemanship","Makes mounted units cheaper"],cost:[500,0,0,0],time:30,type:$g,mulp:.75,group:[k.horsearcher,h.cavalry,h.horsearcher]},{name:["Scimitar","Increases sword attack power and allows the production of satraps"],cost:[400,0,0,0],time:30,type:Ua,
increase:1,value:"attack",group:Utype.sword,next:[b.createSatrap]},{name:["Jihad","Allows the production of Jihad Warriors"],cost:[1200,0,0,0],time:30,type:W,next:[b.createJihad,b.convertJihad]},{name:["Magic Carpet","Researches Magic Carpet summoning"],cost:[300,0,0,0],time:30,type:W,next:[b.createCarpet,b.techJinn]},{name:["Magic Workshop","Allows the building of a magic workshop"],cost:[1200,0,0,0],time:180,type:W,next:[b.buildMagicWorkshop]},{name:["Rain of Fire",""],cost:[800,0,0,0],time:60,
type:W,next:[b.fireRain]},{name:["Magic Vision","Researches the Magic Vision spell"],cost:[400,0,0,0],time:30,type:W,next:[b.magicVision]},{name:["Necromancy","Researches the Raise the Dead spell"],cost:[400,0,0,0],time:30,type:W,next:[b.raiseDead]},{name:["Jinn","Researches Jinn summoning"],cost:[600,0,0,0],time:300,type:W,next:[b.createJinn]},{name:["Ore Enrichment","Increases mine production"],cost:[800,0,0,0],time:30,type:Ja,increase:1,value:"miningPerf"},{name:["Riding Horses","Increases the mounted units' attack and defense power"],
cost:[500,0,0,0],time:30,type:kj,values:["attack",2,"defence",1],group:[k.horsearcher,h.cavalry,h.horsearcher],next:[b.techJanissary]},{name:["Janissary","Allows the production of Janissaries"],cost:[1200,0,0,0],time:120,type:W,next:[b.createEnichar]},{name:["Slavery","Makes peasants cheaper"],cost:[200,0,0,0],time:30,decrease:[k.peasant,[0,0,7,0],e.peasant,[0,0,8,0],h.peasant,[0,0,8,0]],type:ah}];Ai();b.buildMarket.disabled=1;d="";Ek();f=0;for(k=F.length;f<k;f++)m=F[f],m.tech=!0,m.id=f;n=0;for(m=
0*A.length;n<m;n++){g=A[n];k=0;c=[];if(g.onbuild){e=g.onbuild;f=0;for(k=e.length;f<k;f++)z=e[f],c.push(z.id),z.obj.race==g.race&&(z.disabled=1,z.requireObj||(z.requireObj=[]),z.requireObj.put(g)),h=0,h=z.obj.tech?z.obj.id+A.length:z.obj.type,Mc[f]=h;v.Uint16Array(k)}g.space?(e=g.space.slice(0,g.space.length-1).join(","),Rm(g.space),z=v.boolArray(g.space.length-1)):(z=0,e="1");x=0;h=[];if(g.icons){f=0;for(k=g.icons.length;f<k;f++)z=g.icons[f],Mc[x++]=z.id,h.push(z.id);x&&v.Uint16Array(x)}z=0;k=[];
if(g.child){for(f=0;f<g.child.length;f++)k.push(g.child[f].img.urlID),Mc[z++]=g.child[f].img.urlID;v.Uint32Array(z)}f=g.res;z=g.storage;void 0==f&&(f=55);void 0==z&&(z=55);c.length&&(d+="uint NEXTZQ"+n+"[]={"+c.join(",")+"};\n");g.icons&&g.icons.cut&&(f=Sm(g.icons.cut),d+="uint SCUT"+n+"[]={"+f.join(",")+"};\n");h.length&&(d+="uint ORDERZQ"+n+"[]={"+h.join(",")+"};\n");k.length&&(d+="uint CHILDSZQ"+n+"[]={"+k.join(",")+"};\n");d+="bool SPACEZQ"+n+"[]={"+e+"};\n"}d="";f=0;for(k=0*F.length;f<k;f++){m=
F[f];n=0;c=[];if(m.next)for(e=m.next,h=0,n=e.length;h<n;h++)g=e[h],g.disabled?(g.disabled++,g.requireObj.put(m)):(g.requireObj=[m],g.disabled=1),c.push(g.id);e=f+A.length;c.length&&(d+="u16 NEXTZQ"+e+"[]={"+c.join(",")+"};\n")}f=0;e=A;for(k=e.length;f<k;dm(e[f++]));}if(r.editor){if(V("statButton"),V("menu"),V("resources"),ia("mapeditorinfotop"),ia("mapeditorinfo"),n=p("mapeditorinfoUnits"),n.style.display="block",Zf(),!Oh.preload){Oh.preload=!0;m={};d={};e=A;h={euro:Ra[0],arab:Ra[1],asia:Ra[2],common:t.common};
m[Ra[0]]=[];m[Ra[1]]=[];m[Ra[2]]=[];m[t.common]=[];d[Ra[0]]=[];d[Ra[1]]=[];d[Ra[2]]=[];d[t.common]=[];f=0;for(k=e.length;f<k;f++)g=e[f],!g.race||g.illegal||7==g.type||g.item||(g.build?d[h[g.race]].put(f):m[h[g.race]].put(f));for(h=0;2>h;h++){e=Object.keys(m);z={};f=0;for(k=e.length;f<k;z={ul$17:z.ul$17},f++){x=document.createElement("h1");x.innerHTML=e[f];z.ul$17=document.createElement("ul");x.onclick=function(c){return function(){ng(c.ul$17)}}(z);z.ul$17.style.display="none";y=m[e[f]];B=Object.keys(y);
G={};c=0;for(H=B.length;c<H;G={tcreate:G.tcreate},c++)g=document.createElement("li"),g.innerHTML=A[y[B[c]]].name,G.tcreate=y[B[c]],g.onclick=function(c){return function(){var b=c.tcreate;if(A[b].wall){b=A[b];ec=!1;var d=ja;ib=b;ca(d,b.img);document.addEventListener("mousemove",Wg);document.addEventListener("mousedown",pushbuildWall)}else S(b)}}(G),z.ul$17.appendChild(g);n.appendChild(x);n.appendChild(z.ul$17)}m=d;n=p("mapeditorinfoBuilds")}e=Object.keys(Ud);n=p("mapeditorinfoItems");var ea=document.createElement("ul");
h={};f=0;for(k=e.length;f<k;h={u$18:h.u$18},f++)g=document.createElement("li"),h.u$18=Ud[e[f]],g.onclick=function(c){return function(){xi(c.u$18)}}(h),g.innerHTML=h.u$18.name,ea.appendChild(g);n.appendChild(ea);n=p("mapeditorinfoNature");x=document.createElement("h1");x.innerHTML=t.trees;ea=document.createElement("ul");x.onclick=function(){ng(ea)};ea.style.display="none";g=document.createElement("li");ea.appendChild(g);n.appendChild(x);n.appendChild(ea);g.onclick=function(){Ph(Tm)};g.innerHTML=t.delete;
g=document.createElement("li");ea.appendChild(g);g.onclick=function(){Ph(Um)};g.innerHTML=t.create;x=document.createElement("h1");x.innerHTML=t.terrain;var ha=document.createElement("ul");x.onclick=function(){ng(ha)};ha.style.display="none";n.appendChild(x);n.appendChild(ha);k=Fk.texturesRandomMap;e={};f=0;for(k=k.length;f<k;e={l:e.l},f++)g=document.createElement("li"),ha.appendChild(g),g.innerHTML=f,e.l=f,g.onclick=function(c){return function(){Ph(Qh);Qh.active=c.l}}(e)}}else ia("menu"),ia("statButton"),
ia("resources"),V("mapeditorinfo"),V("mapeditorinfotop");Gk()},A,Fd,Nh,Fb,Dk,xk,Zc=function(b,c,d,e,f,g,m){v.newUnit(b,c,d,e,f,g)},tm=[];new Float32Array(4);new Float32Array(3);var Xd=function(){h.bindBuffer(h.ARRAY_BUFFER,Ch);h.bufferSubData(h.ARRAY_BUFFER,12*pb[4],$f)},Ik=function(){h.bindBuffer(h.ARRAY_BUFFER,Dh);h.bufferSubData(h.ARRAY_BUFFER,16*pb[4],Hk)},Jk=function(){h.bindBuffer(h.ARRAY_BUFFER,Bh);h.bufferSubData(h.ARRAY_BUFFER,12*pb[4],$f)},zk=function(){h.bindBuffer(h.ARRAY_BUFFER,Eh);h.bufferSubData(h.ARRAY_BUFFER,
12*pb[4],$f)},mb=function(b){if(b.child&&(!1!==b.built||!b.build)){var c=0;for(b=b.child.length;c<b;c++);}},Jb=function(b,c,d,e){Ik(c,d,e,r.now(),b.bufferID);if(b.tempChild){var k=0;b=b.tempChild;for(var g=b.length;k<g;Jb(b[k++],c,d,e));}},Na=function(b,c,d){void 0==d&&(d=32);b.z32&&(c*=b.z32);Xd(b.x32*d,b.y32*d,c,b.bufferID);if(b.tempChild){c=b.tempChild;d=0;for(var e=c.length;d<e;d++){var k=c[d];k.x32=b.x32;k.y32=b.y32;Na(k,32*b.y32)}}},ka={checkMana:function(b,c,d,e){if(!this.mana)return!1;if(0>
this.mana-b)return this.manaTask=[d.url,c,b],this.stay55(),b>this.manaMax&&e&&(this.blockedCost=e,c=this.setupChild(gc.curse,1),this.blocked=2,this.blockedimg=c,this.manaTarget=b),!1;this.mana-=b;return!0}},Ug=function(b,c){return r.editor?!0:b.freezed||b.confused?!1:J[b.spy||b.kingdom].control[c.spy||c.kingdom]};ka.changeKingdom=function(b){sa[this.kingdom][this.type].quit(this.id);if(Gf[this.id]){Gf[this.id]=0;Q.quit(this.id);0==Q.length&&(hd(),Kd=-1);var c=this.id;c=B[c];c.tempChild.quit(c.selectAnim);
La(c.selectAnim.bufferID);c.selectAnim=void 0}this.kingdom=b;mb(this);this.childBuild&&(this.childBuild=0);if(!this.build||this.arrow)r.editor||this.stay();sa[b][this.type].put(this.id)};ka.aspettare=function(){this.rbase().write(this.x32+this.y32*H,this.id);this.waiting=!0;ca(this,this.url.idle);Jb(this,0,0,0);Sa(this,~~(32E3/this.spd))};ka.addItem=function(b){var c=this.inventory;c&&(c[c.length]=b.id,b.in=this.id,b.sword||b.shield)&&(b.attack&&(this.attack+=b.attack),b.defence&&(this.defence+=b.defence))};
ka.showInventory=function(){wh();for(var b=this.inventory,c=0;8>c;c++){var d=b[c];if(!d)break;var e=Oa[c];e.style.backgroundPosition="0px "+48*d.iconID+"px";e.className=""}};ka.deleteItem=function(b){this.inventory.quit(b.id);this.attack-=b.attack;this.defence-=b.defence};ka.useItem=function(b){48==b.type&&(this.health+=b.lives,this.health>this.maxHealth&&(this.maxHealth=this.health),this.inventory.quit(b.id))};ka.onattack=function(b){!this.attack||this.freezed||this.death||this.item||this.func!=
Qc.url&&this.func||$b(b.id,[this.id],1)};ka.setupINTV=function(b,c,d,e){v.setupINTVadapter(this.id,b.url,c,d)};ka.damage=function(b,c){if(!(this.zolotoy||this.death||this.stoned)){this.defence&&(b-=this.defence);1>b&&(b=1);this.health-=b;c=J[c.kingdom].stats;c.dmgInflicted+=b;var d=J[this.kingdom].stats;d.dmgTaken+=b;1>this.health?(this.build?(d.buildsLosed++,c.buildsKilled++):(d.unitsLosed++,c.unitsKilled++),this.die()):X(this.id,1)}};var X=function(b,c){if(Gf[b]||!1===b){b=Q.length;if(1===b)if(b=
B[Q[0]],ra.stockActive==b&&b.inventory.length){if(ae(b.id,1,1),b=b.inventory,b.length)for(c=0,b=b.length;c<b;c++);}else b.build?wa(b,1):ae(b.id,c);else 1<b?pk(Q,c):ok(db);return!0}};ka.setupSpellIMG=function(b){this.invisible&&ad(this.id);this.url.spell?(ca(this,this.url.spell,1),b||Ha({func:Kk,data:this.id},Xa(this.img),1)):this.stay()};var Kk=function(b){b=B[b];b.death||b.stay()};ka.setupChild=function(b,c,d){d={x32:this.x32,y32:this.y32,d:b.d,img:b.img,mv:b.mv,parent:this.id,z32:b.z32};if((this.dix||
this.diy)&&!this.waiting){var e=.001*(r.now()-this.timestamp);d.x32+=this.dix*e/32-Math.sign(this.dix);d.y32+=this.diy*e/32-Math.sign(this.diy)}if(b.select){if(this.space)b=this.space[this.space.length-1],k=(this.space.length-1)/b;else{b=this.sSizex||1;var k=this.sSizey||1}this.z32&&(d.z32=this.z32);d.wh=[32*b-3,32*k-3];this.selectAnim=d}e&&Jb(d,this.dix,this.diy,0);this.tempChild||(this.tempChild=[]);this.tempChild.put(d);c||Vd.new(d,Xa(d.img),Lk);return d};var Lk=function(b){B[b.parent].tempChild.quit(b);
La(b.bufferID)};ka.distance=0;var ca=function(b,c,d,e){b.img=c;Db[c]||C(c);(c=Db[c])||C(b);var k=c[0],g=c[1];0<=g&&(g*=.001);e&&(g*=e);c=c.id+4*b.d*c[2];e=-1;1===d?e=r.now():0>d&&(e=1);Jk(c,e,k,g,b.bufferID)};ka.setupDir=function(b,c,d){b=Math.sign(b);c=Math.sign(c);b=3*(c-1)+(b+1);2==b?this.d=1:-6==b?this.d=5:0==b?this.d=7:-4==b?this.d=3:-1==b?this.d=2:1==b?this.d=0:-5==b?this.d=4:-3==b&&(this.d=6);d&&(this.d=(this.d+d)%8)};ka.setupDirBuild=function(b){var c=H,d=this.x32+this.y32*c;if(1==b.health&&
0==b.built)e=Ub[b.kingdom],b=b.id,e[d+c]==b?this.d=0:e[d-c]==b?this.d=4:e[d+1]==b?this.d=2:e[d-1]==b?this.d=6:e[d+c+1]==b?this.d=1:e[d-c+1]==b?this.d=3:e[d+c-1]==b?this.d=7:e[d-c-1]==b&&(this.d=5);else{b=b.id;var e=Jc;e(d+c)==b?this.d=0:e(d-c)==b?this.d=4:e(d+1)==b?this.d=2:e(d-1)==b?this.d=6:e(d+c+1)==b?this.d=1:e(d-c+1)==b?this.d=3:e(d+c-1)==b?this.d=7:e(d-c-1)==b&&(this.d=5)}};ka.spdMod=0;var eh=function(b,c){for(var d=c.length,e=0;e<d;e++){var k=B[c[e]];k.build||(k.spd=b)}};ka.changeFunc=function(b,
c){var d=this.func;this.func=b;if(Rh){if(void 0!==this.workingOn)var e=B[this.workingOn];(d=ac[d])&&d.rule&&Og(-1,this,d.rule,e);(b=ac[b])&&b.rule&&Og(1,this,b.rule,c)}};var Sm=function(k){for(var c=[],d=Object.keys(k),e=0;e<d.length;e++){var f=b[k[d[e]]];f&&c.push(d[e].charCodeAt(0),f.id)}return c};ka.stay=function(b){this.mv=1;this.time=void 0;this.diy=this.dix=0;this.c=void 0;v.unitWorking(this.id,!1);this.xf=null;Jb(this,0,0,0);v.unitMovement(this.id,!1);if(!b){b=this.action==$c.url||this.func==
We.url;this.changeFunc(void 0);this.stock&&0!==this.stock[0]?ca(this,this.img,NaN):ca(this,this.__proto__.img,1);this.buildList&&(this.buildList=void 0);this.deleteWorker();if(this.standardFunc&&2!==this.stop&&void 0==this.spy)return this.standardFunc(this);b&&Qc(this)}};ka.stay55=function(){this.changeFunc(void 0);this.stock&&0!==this.stock[0]?ca(this,this.img,NaN):ca(this,this.__proto__.img,1);this.deleteWorker();this.standardFunc&&2!==this.stop&&void 0==this.spy&&this.standardFunc(this)};ka.addWorker=
function(b){this.workers.put(b.id);b.workingOn=this.id};ka.deleteWorker=function(){this.workingOn&&(B[this.workingOn].workers.quit(this.id),this.workingOn=0);this.actionItem&&(this.actionItem=void 0);this.blockedAction()};ka.blockedAction=function(b){var c=this.blocked;if(Mk[c])Mk[c](this,b)};var Mk={2:function(b,c){b.blocked=void 0;mb(b);Lk(b.blockedimg);b.blockedimg=void 0;b.manaTarget=void 0;c||(J[b.kingdom].setupResources(b.blockedCost,-1),b.blockedCost=void 0)}},Oj=function(b){return l.delay[-b[1]+
b[0]-1]},Rd=function(b){var c=Q.length;Q.quit(b);if(c!=Q.length){var d=B[b];d.selectAnim=void 0;c=0;for(d=d.tempChild;c<d.length;c++){var e=d[c];La(e.bufferID);var k=d.length;d.quit(e);k!=d.length&&c--}Gf[b]=void 0;0==Q.length?hd():1==Q.length?B[b].build?wa(B[b],1):ae(b):pk(Q)}db&&db.id===b&&(hd(),db.selectAnim&&(La(db.selectAnim.bufferID),db.selectAnim=void 0),db=void 0)};ka.rbase=function(){return pf[this.zLevel]};var oh;ka.die=function(b){if(!this.death&&!this.magicGateway){var c=H,d=this.id,e=
this.kingdom,k=J[e];this.waitlist&&(k.unitLoading-=.5*this.waitlist.length);if(this.dieSound&&!r.editor){var g=this.dieSound;na(g[~~(g.length*Math.random())],this.x32,this.y32)}Rd(this.id);(this.freezed||this.invisible)&&mb(this);var m=this.x32,h=this.y32;this.death=1;1==this.zLevel&&(oh[m+h*c]=1);v.unitWorking(this.id,!1);this.c=void 0;var n=this.url.die||this.dimg;!1===this.built&&k.building.quit(this.id);void 0!=k.IAD&&k.k&&!this.item&&rb.arr[k.IAD].valorateLost(this);if(this.food&&!r.editor){var p=
100,t=this.food/p,x=~~t,y=~~((t-x)*p);for(g=0;g<t;g++){g==x&&y&&(p=y);var A=pj(m,h),C=~~(A/c);A%=c;A=new Zc(52,e,A,C,0);ca(A,l.item_meat);A.contain=[p,2,nm]}}k.stats.unitCountDeath[this.type]++;g=this.x32;c=this.y32;b||r.editor?La(this.bufferID):n?(this.mv=!0,ca(this,n,1),b=Db[this.img],n=b[1],n=0>n?Oj(b):1E3*b[0]/n,Ha({func:Nj,data:this.id},n-25,1),Jb(this,0,0,0),void 0!==this.dix&&(b=.001*(r.now()-this.timestamp),this.x32+=this.dix*b/32-Math.sign(this.dix),this.y32+=this.diy*b/32-Math.sign(this.diy))):
this.dimgInfinity?(this.dimgRND&&(this.d=this.id%this.dimgRND),ca(this,this.dimgInfinity)):La(this.bufferID);Zg(this);this.techStart&&Yg(0,[this.id]);Na(this,32*this.y32-36);this.x32=g;this.y32=c;this.build||this.item||this.cow||k.values.pop--;this.population&&this.built&&(k.values.popMax-=this.population);h=this.validator(m,h,this.space,this.kingdom);b=h[0];if(this.onbuild&&!r.editor)for(m=this.onbuild,n=k.technology,g=n.disabled,n=n.actived,c=0;c<m.length;c++)e=m[c].id,n[e]--,0===n[e]&&g[e]++;m=
this.validator.dimension;c=m.write;g=0;for(n=b.length;g<n;g++)e=b[g],kc[e]?c(e,kc[e]):c(e,0);if(1==this.health&&!this.built)for(e=Ub[this.kingdom],g=0,n=b.length;g<n;e[b[g++]]=void 0);if(h[2])for(b=h[2],g=0,n=b.length;g<n;g++)e=b[g],kc[e]?(2<m(e)&&B[m(e)].die(1),c(e,kc[e])):(2<m(e)&&B[m(e)].die(),c(e,0));sa[this.kingdom][this.type].quit(this.id);if(this.callList){b=this.x32;n=this.y32;c=this.sight;g=H;e=2*c+1;m=e*e;p=this.id;for(h=0;h<m;h++)t=h%e-c,x=~~(h/e)-c,Math.sqrt(Math.pow(t,2)+Math.pow(x,2))<=
c&&(t+=b,x+=n,t+=x*g,tc[t]==p&&(tc[t]=void 0));b=this.callList;this.callList=void 0;h=0;for(m=b.length;h<m;h+=2)n=B[b[h]],n.x32+n.y32*g==b[h+1]&&n.callList&&D(n,!0);b.length=0}if(this.workers){g=0;m=this.workers.slice(0);for(n=m.length;g<n;g++)h=B[m[g]],h.workingOn===d&&(h.workingOn=0,h.func!==ch.url&&h.stay());this.workers.length=0}this.deleteFromList&&(m=this.deleteFromList,m.quit(this),m.length||m.length0function(this));this.time=void 0;this.changeFunc(void 0);this.diy=this.dix=0;this.inventory&&
0<this.inventory.length&&Te(this.id,this.inventory.slice(0));this.stock&&nj(this);r.editor||(k.check(),popinfo(this.kingdom),k.checkPopArray());this.deleteWorker()}};Array.prototype.quit=function(b){b=this.indexOf(b);return-1<b?(this.splice(b,1),!0):!1};Array.prototype.add=function(b){0>this.indexOf(b)&&(this[this.length]=b)};var Ra=["European","Arab","Asian"],Ag=[t.gold,t.wood,t.food,t.stone,t.mana],lm={euro:"Lancelot Arthur Guivain Merlin Blackthorn Morin Golstuck Karambol Kelerick Rockmore Bridport Casevil Stirm Tonis Pelegrim Peresohn Pirk Pharn Gork".split(" "),
arab:"Ibn Fadlan;Mohammad;Al Ferissa;Harun Al Rashid;Sindbad;Mellemad;Moarrac;Sakhavan;Bellefars;Mokhac;Norahz;Kerhetin;Maham;Dushesh;Direkh".split(";"),asia:"Ishida Toranaga Ichinzen Haiako Mozuki Hitachi Tosheba Harachiko Marasuma Korodzum Ishinghen Genghis Musa Echibo Ichikahr Yotokan Maraga".split(" "),common:"Fistantilus Skenderbeg Raislin Tenis Morok Sokob Baras Haram Billihz Ynte Orgh Savael Birgos Savator Gandeh Gordor Fessh Gilmi Phergas".split(" ")},rh=function(b,c,d){d&&(b=b.replace("%d",
d));return b.replace("%s",c)},id={},ag,bg,Sc=function(b){r.infinity=void 0;if(""!=p("mapconfiguration").innerHTML){b="mapx mapwidth goldRes goldValue woodRes woodValue foodRes foodValue stoneRes stoneValue infinity infiniteValue water waterValue terrainType terrainSelect items itemsValue peons peonValue gateways gatewaysValue freePop freePopValue".split(" ");for(var c=0,d=b.length;c<d;c+=2){var e=p(b[c+1]).value;"infinity"==b[c]?(e=p(b[c+1]).checked,r[b[c]]=e):parseInt(e)?r[b[c]]=parseInt(e):r[b[c]]=
e;localStorage[b[c]]=e}}else"true"==localStorage.infinity&&(r.infinity=!0),r.goldRes=parseInt(localStorage.goldRes),r.foodRes=parseInt(localStorage.foodRes),r.woodRes=parseInt(localStorage.woodRes),r.stoneRes=parseInt(localStorage.stoneRes),r.mapx=parseInt(localStorage.mapx),r.water=parseInt(localStorage.water),r.terrainType=localStorage.terrainType,r.items=parseInt(localStorage.items),r.peons=parseInt(localStorage.peons),r.gateways=parseInt(localStorage.gateways),r.freePop=parseInt(localStorage.freePop);
r.daylength=2880;r.initialhour=12;r.infinity&&(r.goldRes=Math.pow(2,31)-1,r.foodRes=Math.pow(2,31)-1,r.woodRes=Math.pow(2,31)-1,r.stoneRes=Math.pow(2,31)-1);r.mapy=r.mapx;r.gravity=580.9/9.8*9.8;r.name="";r.arje=~~(555555*Math.random()+1);b=r;b.goldRes=parseInt(b.goldRes);b.foodRes=parseInt(b.foodRes);b.woodRes=parseInt(b.woodRes);b.stoneRes=parseInt(b.stoneRes);b.goldRes||(b.goldRes=Infinity);b.foodRes||(b.foodRes=Infinity);b.woodRes||(b.woodRes=Infinity);b.stoneRes||(b.stoneRes=Infinity);b.mapx=
parseInt(b.mapx);(!b.mapx||32>b.mapx)&&(b.mapx=32);1024<b.mapx&&(b.mapx=1024);b.items=parseInt(b.items)||0;0>b.items&&(b.items=0);b.peons=parseInt(b.peons)||0;0>b.peons&&(b.peons=0);b.gateways=parseInt(b.gateways)||0;0>b.gateways&&(b.gateways=0);b.water=parseInt(b.water)||0;0>b.water&&(b.water=0);b.freePop=parseInt(b.freePop)||0;b.terrainType=Aa(b.terrainType);b.description=Aa(b.description);b.author=Aa(b.author);b.name=Aa(b.name);v.setupGame(r.peons,r.freePop,r.goldRes,r.woodRes,r.foodRes,r.stoneRes,
r.water,Ad[r.terrainType].id,r.items,r.gateways,r.mapx,r.arje);return r},Gk=function(){oc.innerHTML="";p("notifybottom").style.display="none";p("loadingtext").innerHTML=t.loading;y.kingdom||(y.kingdom=1);r.online&&(Vm(t.initializing),r.editor=0);C(v.mapWidth(),"asd");v.mapWidth()?(r.mapx=v.mapWidth(),r.mapy=r.mapx):Sc();r.pausedTime=0;r.canceled=0;bg=performance.now();rc=p("msgs1");r.online||(location.hash="");V("playermenu");V("index");r.cycle?r.deltaTime=25*r.cycle:(r.players=J.length-1,r.date=
Date.now(),r.cycle=0,r.kingdoms=J,r.deltaTime=0);r.loadDate=Date.now();r.online||ek();r.now=Ti;r.paused=0;r.pausedTime=0;r.zMax=96*r.mapy;jb();performance.now();r.allow14=!0;H=r.mapx;Fa=r.mapy;r.temperature=25;var b=r.temperature;0==y.temperature&&(b+="&deg;C");p("temperature").innerHTML=b;R=1;p("loadingtext").innerHTML="Loading terrain";C("arje",r.arje);v.preldd()?(b=v.trradd(),ag=new Int8Array(n.buffer,b,void 0),C(ag)):(v.configRandomMap(),b=v.randomTerrain(H,r.water),ag=new Int8Array(n.buffer,
b,H*Fa));ia("content");p("loadingtext").innerHTML="Loading textures";h.getError()==h.CONTEXT_LOST_WEBGL&&(h=p("tzar").getContext("webgl2",{antialias:!1,alpha:!1}),C("restored"));if(!he){var c=h.createShader(h.VERTEX_SHADER);h.shaderSource(c,"#version 300 es\nprecision mediump float;\n\nin vec3 a_position;\nin vec3 a_texCoord;\nin vec4 a_physic;\nin vec3 a_margins;\nin uint a_step;\n\nuniform float kingdoms;\nuniform float zoom;\nuniform mediump int miniMap;\nuniform float now;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform sampler2D u_image1;\nuniform sampler2D delay;\nuniform sampler2D colorArray;\n\nuniform float zMax;\nout highp vec2 vTextureCoord;\nout vec4 v_kcolor;\nout float height;\nflat out int rColor;\n\nvec4 superArray(in highp int position) {\n     return(texelFetch(u_image1, ivec2(\t\t(position%512)\t\t,\tposition/512\t), 0));\n}\n\nvoid main() {\n\n\n\n    highp float  x;\n    float t;\n\thighp int pos;\n    int jump=0;\n    pos=int(a_texCoord.x);\n   // pos=260840u/4u;\n\n\n\nvec4 imgInfo=superArray(pos);\n\nint frames=int(imgInfo[0]);\nfloat fps=imgInfo[1];\nfloat dirs=imgInfo[2];\nfloat recolor=imgInfo[3];\n\nrColor=int(recolor);\n\n\nif(fps!=0.0&&miniMap==0){\nif(a_texCoord.y>=0.0){\nt=(now-a_texCoord.y);\nif(fps>0.0){\njump=int(floor(t * fps*0.001));         \n}else{\n\n\nint index=int(-fps);\n\nfloat spt= mod(t,texelFetch(delay, ivec2(frames-1+index, 0), 0).r);\n\nfor(jump=0;jump<frames;jump++)\nif(texelFetch(delay, ivec2(jump+index, 0), 0).r>spt){ \nbreak;\n }\n\n\n\n\n}\n\njump=(jump%frames)*2;\npos=(pos+jump);\n}\n}\n\npos+=1;\n   \n    vec4 coord = superArray(pos);\n    vec2 mxy=coord.xy;\n    vec2 txtcord = coord.zw/512.0;\n\n    \n    vec2 sizes = superArray(pos+1).xy;\n\n    if(a_step==1u||a_step==3u){\n    mxy.x+=sizes.x;\n    txtcord.x+=sizes.x/512.0;\n    }\n\n    if(a_step==2u||a_step==3u){\n    mxy.y+=sizes.y;\n    txtcord.y+=sizes.y/512.0;\n    }\n\n\n\n\theight = sizes.y/512.0;\n\n\tfloat z=a_position.z;\n\n\n    \nif(a_margins.x!=0.0&&(a_step==1u||a_step==3u)){\nmxy.x+=a_margins.x-sizes.x;\n}\n\n\nif(a_margins.y!=0.0&&(a_step==2u||a_step==3u)){\nmxy.y+=a_margins.y-sizes.y;\n}\n\n\n\tif(z<0.0){\n\tz*=-1.0;\nif(miniMap<2) mxy*=0.0;\n\t}\n\n\n\n\n\n\nif(a_margins.z!=0.0){\n\tfloat s = sin(a_margins.z);\n\tfloat c = cos(a_margins.z);\n\tmat2 m = mat2(c, -s, s, c);\n\tmxy.xy*=m;\n}\n\n\n\n    t = (now - a_physic.w) * 0.001;\n    mxy.x+=a_physic.x * t;\n\n\tfloat physicY=a_physic.y * t + a_physic.z * .5 * t * t;\n\n    mxy.y+=physicY;\n\n\nif(miniMap!=0){\n\tz=0.0;\n}else{\n\tz=(1.0 - (physicY+z)/ zMax)*.9;\n}\n\n\n   gl_Position = vec4((((a_position.xy+mxy) + u_translation) / u_resolution * 2.0 - 1.0) * vec2(zoom, -zoom), (z), 1.0);\n   vTextureCoord=txtcord;\n\nvec4 outColor=texelFetch(colorArray, ivec2(a_texCoord.z, 0), 0);\n\nif(a_texCoord.z>=kingdoms) outColor.a+=1.0;\n\n\n   v_kcolor=outColor;\n\n\n}\n");
h.compileShader(c);b=h.createShader(h.FRAGMENT_SHADER);h.shaderSource(b,"#version 300 es\nprecision mediump float;\n\n\n\nuniform sampler2D lightmap;\nuniform vec2 u_resolution;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\nuniform mediump int miniMap;\nin vec4 v_kcolor;\nin highp vec2 vTextureCoord;\nin float height;\nflat in int rColor;\nout vec4 COLOR;\n\nvoid main() {\n\n\nif(miniMap==0){\n\n\n\n\nvec2 txtFinal=vTextureCoord;\n\nif(txtFinal.x>=1.0){\ntxtFinal.y+=height*floor(txtFinal.x);\n}\n\n\nvec4 color=texture(img_common, vec3(txtFinal, int(txtFinal.y)));\n \n\nif(color.a<0.5) discard;\n\n\nif(rColor==1 &&color.r==color.g&&color.r==color.b){\ncolor.rgb*=v_kcolor.rgb;\n}\n\nif(v_kcolor.a>1.0)\n{\ncolor*=v_kcolor-vec4(0.0,0.0,0.0,1.0);\n}\n\n\n\n\nvec4 light=vec4(1.0);\nlight = texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+vec4(1.0,1.0,1.0,0.0)*u_ambient;\n\nCOLOR=color*light;\n}else{\n\nif(v_kcolor.a>1.0)\nCOLOR=v_kcolor-vec4(0.0,0.0,0.0,1.0);\nelse\nCOLOR=v_kcolor;\n}\n\n}");
h.compileShader(b);ba=h.createProgram();h.attachShader(ba,c);h.attachShader(ba,b);h.linkProgram(ba);h.useProgram(ba);(c=h.getShaderInfoLog(c))&&console.log("Shader compiler log: "+c);(c=h.getShaderInfoLog(b))&&console.log("Shader compiler log: "+c);c=h.createShader(h.VERTEX_SHADER);h.shaderSource(c,"#version 300 es\nprecision mediump float;\n\nin vec3 a_position;\n\n\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform mediump int miniMap;\nuniform float zoom;\n\n\nvoid main() {\n\nfloat depth;\nif(miniMap==1){\ndepth=.03;\n}else{\ndepth=1.0;\n}\n\n   gl_Position = vec4(a_position.x, a_position.y, depth, 1.0);\n   \n\n}");
h.compileShader(c);b=h.createShader(h.FRAGMENT_SHADER);h.shaderSource(b,"#version 300 es\nprecision mediump float;\n\nuniform float u_fps;\nuniform mediump int miniMap;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\n\nuniform vec2 u_translation;\nuniform vec2 u_light;\nuniform vec2 u_resolution;\nuniform vec2 minimapMargin;\nuniform mediump sampler2D img_data;\nuniform sampler2D lightmap;\nout vec4 COLOR;\nuniform float zoom;\nuniform float mx;\nuniform float mapSize;\n\n\nuniform sampler2D u_image1;\nvec4 superArray(in highp int position) {\n     return(texelFetch(u_image1, ivec2(\t\t(position%512)\t\t,\tposition/512\t), 0));\n}\n\nvec4 sptexture3D(in vec2 coords,float h) {\nif(coords.x>=1.0){\ncoords.y+=h*floor(coords.x)/512.0;\n}\n    return(\ttexture(img_common, vec3(coords,int(coords.y)))\t);\n}\n\nvoid main() {\nvec4 color;\n\nvec2 xy =  vec2(gl_FragCoord.x,u_resolution.y-gl_FragCoord.y)/zoom;\n\nif(miniMap==1){\nxy+=minimapMargin/zoom;\n}else{\nxy+=-u_translation+vec2(mx,0.0)/zoom+0.5*(u_resolution-u_resolution/zoom);\n}\n\n\nvec4 coords=texture(img_data,xy/(mapSize*32.0));\nvec2 xy32=xy/32.0;\nvec2 floorxy32=floor(xy32);\nvec2 xyr=xy32-floorxy32;\nint pos;\n\nvec4 nrgb;\n\nif(coords.q!=0.0) nrgb=sptexture3D((coords.pq)+xyr/16.0,448.0);\n\n\nif(nrgb==vec4(1.0,0.0,1.0,1.0)) \npos=int(coords[1])+1;\nelse\npos=int(coords[0])+1;\n\n\n\nif(nrgb!=vec4(0.0,0.0,0.0,0.0)&&nrgb!=vec4(1.0,0.0,1.0,1.0)){\ncolor=nrgb;\n}else{\nvec4 info=superArray(pos);\n\n\n\n\n\nvec2 wh=superArray(pos+1).xy;\n\nvec2 nxy=vec2(mod(xy.x,wh.x),mod(xy.y,wh.y));\n\n\ncolor=sptexture3D((info.pq+nxy)/512.0,wh.t);\n\n\n//if(miniMap==0) light = (texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+1.0);\n\n}\n\n\nvec4 tlight=sptexture3D(  (u_light+vec2(mod(xy.x,512.0),mod(xy.y,512.0)))/512.0,512.0    );\n\n\n\n//\nCOLOR=color*u_ambient*(vec4(.5)+tlight*.75);\n}");
h.compileShader(b);la=h.createProgram();h.attachShader(la,c);h.attachShader(la,b);h.linkProgram(la);(c=h.getShaderInfoLog(c))&&console.log("Shader1 compiler log T: "+c);(c=h.getShaderInfoLog(b))&&console.log("Shader compiler log T: "+c)}b=h.getAttribLocation(ba,"a_position");c=h.getAttribLocation(ba,"a_texCoord");var d=h.getAttribLocation(ba,"a_step");var e=h.getAttribLocation(ba,"a_physic"),f=h.getAttribLocation(ba,"a_margins");h.useProgram(la);var g=h.getUniformLocation(la,"minimapMargin");fe=h.getUniformLocation(la,
"u_translation");Ih=h.getUniformLocation(la,"u_resolution");Hh=h.getUniformLocation(la,"u_fps");fk=h.getUniformLocation(la,"u_ambient");ld=h.getUniformLocation(la,"zoom");var m=h.getUniformLocation(la,"mx"),l=h.getUniformLocation(la,"mapSize");h.getUniformLocation(la,"borderCoords");h.getUniformLocation(la,"waterBorder");If=h.getUniformLocation(la,"miniMap");h.uniform1i(If,0);h.uniform2fv(fe,[0,0]);h.uniform1f(Hh,-1);h.uniform1f(ld,1);h.uniform1f(m,-y.mx);h.uniform1f(l,H);h.uniform2fv(h.getUniformLocation(la,
"u_light"),Mh);C(Mh);r.editor?h.uniform2fv(g,[0,-60]):h.uniform2fv(g,[-4,-31]);g=h.getAttribLocation(la,"a_position");Jh=h.createVertexArray();h.bindVertexArray(Jh);m=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,m);h.bufferData(h.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,-1,1,1,-1,1]),h.STATIC_DRAW);h.enableVertexAttribArray(g);h.vertexAttribPointer(g,2,h.FLOAT,!1,0,0);h.bindVertexArray(null);h.useProgram(ba);h.bindBuffer(h.ARRAY_BUFFER,null);Kh=h.createVertexArray();h.bindVertexArray(Kh);
wk=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,wk);h.enableVertexAttribArray(d);h.vertexAttribIPointer(d,1,h.UNSIGNED_BYTE,0,0);h.bufferData(h.ARRAY_BUFFER,new Uint8Array([0,1,2,1,2,3]),h.STATIC_DRAW);h.vertexAttribDivisor(d,0);xk=Math.floor(H*Fa/2);Bh=ge(c,3);Ch=ge(b,3);Dh=ge(e,4);Eh=ge(f,3);h.bindVertexArray(null);Hf=h.getUniformLocation(ba,"u_resolution");gk=h.getUniformLocation(ba,"u_ambient");ee=h.getUniformLocation(ba,"u_translation");jd=h.getUniformLocation(ba,"zoom");vk=h.getUniformLocation(ba,
"now");de=h.getUniformLocation(ba,"miniMap");b=h.getUniformLocation(ba,"zMax");h.uniform1f(b,r.zMax);h.uniform1i(de,0);h.useProgram(ba);b=kd(v.sharedDelayID(),1323);r.daylength||(r.daylength=2880);r.initialhour||(r.initialhour=12);d=0;for(c=eb.length;d<c;d++).55>eb[d]&&(eb[d]=.55);Yi();h.uniform1f(jd,1);h.uniform2fv(ee,[0,0]);Kc=h.createFramebuffer();Kf.changed=0;window.addEventListener("resize",Kf,!1);Kf();h.blendEquation(h.FUNC_ADD);h.blendFunc(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA);h.disable(h.DITHER);
h.disable(h.BLEND);performance.now();Lc(1);he||(h.uniform1f(h.getUniformLocation(ba,"kingdoms"),v.nkingdom()),c=Be(v.getColorTexture(),4*(v.nkingdom()+7)),h.activeTexture(h.TEXTURE4),d=h.createTexture(),h.bindTexture(h.TEXTURE_2D,d),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,c.length/4,1,0,h.RGBA,h.UNSIGNED_BYTE,c),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,
h.TEXTURE_WRAP_T,h.REPEAT),h.bindTexture(h.TEXTURE_2D,null),h.bindTexture(h.TEXTURE_2D,d),h.uniform1i(h.getUniformLocation(ba,"colorArray"),4),h.activeTexture(h.TEXTURE3),d=h.createTexture(),h.bindTexture(h.TEXTURE_2D,d),h.texImage2D(h.TEXTURE_2D,0,h.R16F,b.length,1,0,h.RED,h.FLOAT,b),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,
h.REPEAT),h.bindTexture(h.TEXTURE_2D,null),h.bindTexture(h.TEXTURE_2D,d),h.uniform1i(h.getUniformLocation(ba,"delay"),3),h.activeTexture(h.TEXTURE2),uk=h.createTexture(),h.bindTexture(h.TEXTURE_2D,uk),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,1,1,0,h.RGBA,h.UNSIGNED_BYTE,new Uint8Array([255,255,255,255])),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,
h.TEXTURE_WRAP_T,h.REPEAT),h.clearColor(0,0,0,1));h.bindFramebuffer(h.FRAMEBUFFER,Kc);Kc.width=1;Kc.height=1;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,md,0);h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT);h.bindFramebuffer(h.FRAMEBUFFER,null);new Float32Array(8);v.setupGL();h.enable(h.DEPTH_TEST);h.depthFunc(h.LEQUAL);za.fp1000=1E3;za.delta=0;za.now=0;za.frameCount=0;h.bindTexture(h.TEXTURE_2D,md);he=va.setup=!0;v.preldd()||v.randomMap();C(Ta,ya);Hb.check()},Hb=function(){for(var b=
["loading","playermenu","index"],c=b.length,d=0;d<c;p(b[d++]).style.display="none");qh();hd();Nk();window.addEventListener("keydown",Km);window.addEventListener("keyup",Lm);window.addEventListener("mousemove",Mm);window.addEventListener("wheel",hk,!1);window.addEventListener("mousedown",Nm);window.addEventListener("mouseup",Om);bg=performance.now()-bg;C("FULL: ",bg);r.online?(C("readyyyy"),v.plready()):ke();r.allow14=!1};Hb.check=function(){Hb.load++;Hb.load===Hb.target&&Hb()};Hb.target=2;var le=
function(){for(var b=Za.length,c=Za,d="",e=0;e<b;e++){var f=c[e];le.obj[f.id]||f.id==y.onlineID||(d+="<br>"+f.nhinfo.name)}return d};le.obj={};var Ok=function(){return y.gl?!1:(yc("You can't run WEBGL 2<br>More info <a href='http://webglreport.com/?v=2'>here</a>","Error"),Pb(),!0)},gi=function(){var b=document.documentElement;b.requestFullscreen?b.requestFullscreen():b.msRequestFullscreen?b.msRequestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullscreen&&b.webkitRequestFullscreen()},
od=function(){if(!Ok())if(Df(),Eg(),Hb.load=0,"true"==localStorage.fullscreen&&gi(),r.editor?(y.marx=0,y.mary=60,y.menumy=60,Kb=pc=171,y.mx=171,y.menumx=171):(y.mx=151,Kb=pc=128,y.menumx=151,y.menumy=0,y.marx=4,y.mary=31),lc.style.width=pc+"px",lc.style.height=Kb+"px",lc.style.left=y.marx+"px",lc.style.top=y.mary+"px",ia("loading"),""==p("loading").innerHTML&&(p("loading").innerHTML='<p id="loadingtext"></p>\n<div>\n<div class="svgtzared"></div>\n<div id=\'logo\' class="svgnehhon"></div>\n<span id="netral">NEHHON NETRAL-H ENGINE</span>\n</div>'),
origin=!1,v.mapWidth()||Sc(),Ad.last!==r.terrainType){va.started=!0;var b=y.cdn;cm({icons:b+"icons.png",common:b+"common.neh2"});Ad.last=r.terrainType}else Hb.check(),Di()},Rh,qh=function(){var b=p("playersinfo");b.innerHTML="";if(!r.editor)for(var c=1,d=J.length;c<d;c++){var e=J[c],f=e.death?e.name.strike():e.name;b.innerHTML+=f+"<span id='score"+c+"'></span><div class='playercolor' style='background:rgb("+e.color[0]+","+e.color[1]+","+e.color[2]+")'></div><span class='ping'>"+(void 0!=J[c].ping&&
" "+J[c].ping+"ms"||"")+"</span><br>"}},Nk=function(){var b=window.innerWidth-y.mx,c=window.innerHeight,d=v.empXY(),e=d%H,f=~~(d/H);d?(b=32*e-.5*b,c=32*f-.5*c):c=b=0;cd(~~b,~~c)},be,Ah,kk,$l=function(){var b=p("selectedobject").getContext("webgl",{antialias:!1,depth:!1}),c=b.createShader(b.VERTEX_SHADER);b.shaderSource(c,"void main() {\ngl_Position = vec4(0 ,0, 0, 1);\ngl_PointSize=48.0;\n}");b.compileShader(c);var d=b.createShader(b.FRAGMENT_SHADER);b.shaderSource(d,"precision mediump float;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nuniform float txtCoord;\nvoid main() {\ngl_FragColor = texture2D(u_image, (vec2(\tmod(txtCoord,21.0) ,floor(txtCoord/21.0) ) + gl_PointCoord)*(0.046875));\nif(gl_FragColor.r==gl_FragColor.g&&gl_FragColor.r==gl_FragColor.b) gl_FragColor*=u_color;\n}");
b.compileShader(d);var e=b.createProgram();b.attachShader(e,c);b.attachShader(e,d);b.linkProgram(e);b.useProgram(e);c=b.createTexture();b.bindTexture(b.TEXTURE_2D,c);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texImage2D(b.TEXTURE_2D,0,b.RGB,b.RGB,b.UNSIGNED_BYTE,ra.icons);var f=b.getUniformLocation(e,"u_color"),
g=b.getUniformLocation(e,"txtCoord");be=function(c){b.uniform4f(f,1,1,1,1);b.uniform1f(g,c);b.drawArrays(b.POINTS,0,1)};Ah=function(){b.uniform4f(f,1,1,1,1);b.uniform1f(g,189);b.drawArrays(b.POINTS,0,1)};kk=function(){b.uniform1f(g,0);b.uniform4f(f,0,0,0,0);b.drawArrays(b.POINTS,0,1)}},pc=128,Kb=128,B=[{terrain:1},{terrain:1},{terrain:1}],kc={};window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(b){window.setTimeout(b,
1E3/60)}}();var Za=[];window.addEventListener("offline",function(b){Wc("Offline","#ff0000")});window.addEventListener("online",function(b){Wc("Online","#00ff00")});var pd={};(function(){for(var b=["returnmenu","index","Account","accountIframe"],c=0,d=b.length;c<d;pd[b[c]]=p(b[c++]));})();var Wm=function(){location.replace("#"+this.gameID+"Room")},Pk=function(b){Za=[];C("connecting to",b,t.loading);p("game").style.display="block";p("gameName").innerHTML=t.loading;p("returnmenu").style.display="none";
p("index").style.display="none";rc.innerHTML="";cc=[];y.p2p?(Da.joinRoom(b,og),Eg()):(Da||Lb(),Lb.func=function(){Pk(b)})},Xm={6400900:".",28462225:"a",29052100:"b",29648025:"c",3025E4:"d",30858025:"e",31472100:"f",32092225:"g",32718400:"h",33350625:"i",33988900:"j",34633225:"k",35283600:"l",35940025:"m",36602500:"n",37271025:"o",37945600:"p",38626225:"q",39312900:"r",40005625:"s",40704400:"t",41409225:"u",42120100:"v",42837025:"w",4356E4:"x",44289025:"y",45024100:"z"},Ym=function(b){V("game");qd.length=
0;r.online=0;ea=r.id=void 0;Da.leaveRoom();Za.length=0;Pb();v.closeRoom();b.constructor==String&&yc(b)},wm={euro:0,arab:0,asia:0},cc,Qk=function(b,c,d){cc=b;rd()},Rk=function(b){for(var c=0,d=Za.length;c<d;c++){var e=Za[c];if(e.id==b)return e}},Da,Tk=function(b){if(!p("usernameForm")){uc();var c=localStorage.name||"Guest",d=localStorage.color||"#"+Math.floor(16777215*Math.random()).toString(16),e=document.createElement("div");e.id="usernameForm";e.innerHTML="\n            <div>\n            <h2>"+
t.username+'</h2>\n            <div>\n<input type="color" id=\'usernameColor\' value="'+d+'" /><input id=\'usernameVal\' type="text" value="'+Sk(c)+'" />\n</div>\n<br />\n</div>';c=document.createElement("button");c.innerHTML=t.continue;c.onclick=function(){y.name=Aa(p("usernameVal").value);y.color=p("usernameColor").value;localStorage.color=y.color;localStorage.name=y.name;document.body.removeChild(p("usernameForm"));b();gb()};e.children[0].appendChild(c);document.body.appendChild(e)}},hi=function(b){for(var c=
0,d=0;d<b.length;d++)c+=b.charCodeAt(d)*d+(c&d);C(c,"id");return c%4294967295},Lb=function(){Ok()||(y.name?(Sl(),Da=new SimpleWebRTC({localVideoEl:"",remoteVideosEl:"",autoRequestMedia:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},url:"https://solar.tza.red/"}),Da.on("channelMessage",function(b,c,d){c=v.tempointeradd(d.length);c=new Uint32Array(n.buffer,c,d.length);for(var e=0;e<d.length;e++)c[e]=d[e];v.onldata(b.superID)}),Da.on("error",function(b){"full"==b&&(Pb(),Wc(t.gameFull,
"#ff0000"))}),Da.on("connectionReady",function(b){var c=Da.connection.connection;y.p2p=c;y.superID=hi(c.id);v.setupOnlID(y.superID);c.username=y.name;c.color=y.color;c.on("getRooms",function(b){var c=b.date,d=Object.keys(b),k=p("gameList");if(1<d.length){k.innerHTML="";for(var m=0,h=d.length;m<h;m++){var l=d[m],n=b[l];if("date"!=l){var r=n.len;if(r){var v=document.createElement("tr"),x="";x=n.playing?x+("<td><div class='redCircle'></div>"+t.playing+"</td>"):x+("<td><div class='redCircle' style=\"background:rgba(0,255,0,.8); box-shadow:0px 0px 20px rgba(0,255,0,.8)\"></div>"+
t.waiting+"</td></td>");x+="<td>"+Aa(n.description)+"</td><td>"+~~((c-n.date)/6E4)+" min ago</td><td>"+Aa(r)+"/"+Aa(n.max)+"</td>";v.innerHTML=x;v.gameID=l;n.playing||(v.onclick=Wm);k.appendChild(v)}}}}else k.innerHTML="<tr><td>No games found</td></tr>"});y.onlineID=b;Lb.func&&Lb.func()}),Da.on("createdPeer",function(b){r.started||Dl(b)})):Tk(Lb))},Zm=function(){Eg();gb();ia("game");V("returnmenu");V("index");p("gameName").innerHTML=t.loading;rc.innerHTML="";Za=[];Pc();y.admin=1;y.room={description:p("gameFormName").value,
max:parseInt(p("gameMax").value),public:!0};2>y.room.max&&(y.room.max=2);14<y.room.max&&(y.room.max=14);localStorage.gameDescription=y.room.description;Da.createRoom(y.onlineID+"b",og);r.online=1;document.body.removeChild(p("gameForm"));cc=[y.onlineID];Sc();v.setupOnlTable(y.room.max+1);Rc(v.onlADD(0,0,parseInt(y.color.substr(1),16),y.superID,0),17,y.name);rd()},Uk=function(){Da||Lb();if(y.onlineID){uc();var b=localStorage.gameDescription||y.name+"'s room",c=document.createElement("div");c.id="gameForm";
c.innerHTML="\n<div>\n            <h2>"+t.gameOptions+"</h2>\n            "+t.gameName+': <input id=\'gameFormName\' type="text" value="'+b+'" maxlength="29" /><br />\n'+t.nplayers+': <input id="gameMax" type="number" value="6" max="14" min="2"/><br />\n            </div>';b=document.createElement("button");b.innerHTML=t.continue;b.onclick=Zm;c.children[0].appendChild(b);document.body.appendChild(c)}else setTimeout(function(){location.hash=""},200),Lb.func=Uk},Vk=function(b){for(var c="kingdom d type img x32 y32 name iconID attack defence level health maxHealth func funcObj workers workingOn inventory dix diy timestamp working rnd techID techStart activeTech levelProgress c mimg built xf yf action point waitlist mv work death freezed confused sword shield book spy stock".split(" "),
d=[],e=b.length,k=0;k<e;k++){var g=b[k],m=Object.keys(g),h={};d.put(h);for(var l=0,n=m.length;l<n;l++)h[c[m[l]]]=g[m[l]]}return d},Fl=function(){compressMap.download=!1;fi();compressMap.download=!0},fi=function(){var b=v.savegame(),c=Be(b,Mc[0]),d=Mc[1];C(c,b);b=new Blob([new Uint32Array([d]),c],{type:"application/octet-binary"});b=URL.createObjectURL(b);c=document.createElement("a");document.body.appendChild(c);c.style="display: none";c.href=b;c.download="savegame.tzared";c.click()},$m=function(){Za.length&&
(Sc(),v.strOnl(),y.p2p.emit("gameStarted"))},me=function(b,c,d){if(d){if(le.obj[d.id])return;le.obj[d.id]=1;b=le();""==b?yc(b,t.loading,1):yc(b,t.waitingPlayers,1)}y.admin&&(me.i++,C(me.i,qd.length,d),me.i==qd.length-r.bots&&setTimeout(function(){C(999999999,44444)},100))};me.i=0;var ke=function(){gb();p("alert").style.display="none";r.started=1;r.date=Date.now();jb();Ka();v.startMovement();za()};ke.fast=!0;var Wk=function(b,c,d){od()},ce=!1,gb=function(){ce=!1;p("basic").style.filter=""},uc=function(){ce=
!0;p("basic").style.filter="blur(94px)"};var Xk=function(){ia("game");qd.length=0;r.id=void 0;r.online=0;ea=void 0;r.compressed=void 0;r.arje=void 0;Da.leaveRoom();Za.length=0;Pb();y.admin=0;v.closeRoom()};var Yk=function(b,c,d){d&&(fb.arr=new Uint8Array(parseInt(b)),fb.i=0,p("showGameInfo").innerHTML="<table><tr><td>Downloading custom map</td><td id='cmappr'></td></tr></table>")},fb=function(b,c,d){d&&(fb.arr.set(b,fb.i),fb.i+=b.length,p("cmappr").innerHTML=~~(100*fb.i/fb.arr.length+.5)+"%",fb.i==
fb.arr.length&&Zk(fb.arr))};fb.step=1E4;var Zk=function(b){var c=$k(b);c.custom=!0;ea=c;ea.online=!0;ea.started=!1;ea.editor=!1;y.admin&&(ea.compressed=b);C("newmap",c);cg(c);rd()},al=function(b){b=parseInt(b);if(2>b||!b)b=2;14<b&&(b=14);b!==y.room.max&&(y.p2p.emit("maxPlayers",b-(cc.length-Za.length-1)),C(999999999,44444))},bl=function(b){y.room.max=b;rd()},an=function(){C(999999999,44444);p("optionbutton").style.display="inline-table";V("deleteCusMap")},og=function(b){if((y.admin||b)&&!r.id)if(b=
Da.roomName,b+="Room",C("login"),gb(),0!==Da.getPeers().length||y.admin){var c=y.room||NaN;C(c);r.id=b;r.online=1;Pc();y.admin&&(p("onlineTopInfo").innerHTML=' <button id="addAI" style="padding: 6px;">'+t.addAI+'</button><span style="float:right">'+t.nplayers+'<input id="nplayersO" min="2" type="number" max="14" value="'+y.room.max+'" /></span>',p("nplayersO").onchange=function(){var b=this.value;b<cc.length&&(b=cc.length);C(cc.length,b);cc.length!=b||Za.length||b++;al(b);this.value=y.room.max},p("addAI").onclick=
function(){v.onlCount()<y.room.max&&(Rc(v.onlADD(0,0,16777216*Math.random(),0,1),17,"AI"),y.p2p.emit("maxPlayers",y.room.max-v.nAIs()),v.sndNfo())});p("copyButton")&&(p("copyButton").onclick=function(){p("onlineID").select();document.execCommand("Copy")},p("onlineID").value=location.origin+"/#"+r.id);p("gameName").innerHTML=Aa(c.description)||"Online Game";V("returnmenu");y.admin?(location.replace("#"+r.id),p("buttons").innerHTML='<button id="startbutton">'+t.play+'</button><button id="optionbutton">'+
t.options+'</button><button id="closebutton">'+t.close+'</button><br><input id="maploadOnline" type="file" /> <label style="display:none" for= "maploadOnline">'+t.strcusMap+'</label> <button id="deleteCusMap">'+t.randomMap+"</button>",p("startbutton").onclick=$m,p("optionbutton").onclick=cl,p("closebutton").onclick=Xk,p("maploadOnline").accept=".tzared",p("maploadOnline").onchange=bn,V("deleteCusMap"),p("deleteCusMap").onclick=an):(p("buttons").innerHTML='<button id="quitbutton">'+t.disconnect+"</button>",
p("quitbutton").onclick=Ym);Da.connection.on("remove",cn)}else location.hash="",Pb()},cn=function(b){if(b=Rk(b.id)){var c=Ic(Ya(v.empName(v.pidkingdom(b.superID)),17));Tb(rh(t.playerDisconnected,c),0,5);Za.quit(b);v.deletePlayer(b.superID)}},Va=function(){0===Va.active&&(C(999999999,44444),Va.date=Date.now(),Va.received=0,Va.max=-Infinity,Va.active=1)};Va.active=0;var dl=function(b,c,d){d&&C(999999999,44444)};dl.fast=!0;var Sh={},Th=function(b){C(b);if(y.superID==b)return yc(t.kicked),Xk();(b=Rk(b))&&
b.end()},el=document.getElementsByClassName("ucolor"),fl=document.getElementsByClassName("username"),gl=document.getElementsByClassName("race"),Uh=document.getElementsByClassName("team"),qb=function(b){if(y.admin){qb.div&&(document.body.removeChild(qb.div),qb.div=void 0);var c=b.pageX;b=b.pageY;var d=this.i2,e=document.createElement("div");e.style.top=b+"px";e.style.left=c+"px";e.className="onlPlayer";qb.div=e;C(this.peer,this.i2);if(this.peer.name)c=document.createElement("button"),c.onclick=function(){v.userKick(d);
y.p2p.emit("maxPlayers",v.onlCount());document.body.removeChild(e);qb.div=void 0},c.innerHTML=t.kick,e.appendChild(c);else{var k=this.peer;c=document.createElement("button");c.onclick=function(){v.updown(d,-1);document.body.removeChild(e);qb.div=void 0};c.innerHTML=t.up;e.appendChild(c);c=document.createElement("button");c.onclick=function(){v.updown(d,1);document.body.removeChild(e);qb.div=void 0};c.innerHTML=t.down;e.appendChild(c);y.onlineID!=k&&(c=document.createElement("button"),c.onclick=function(){C(22222,
k);v.userKick(d);y.p2p.emit("maxPlayers",v.onlCount());document.body.removeChild(e);qb.div=void 0},c.innerHTML=t.kick,e.appendChild(c))}c=document.createElement("button");c.onclick=function(){document.body.removeChild(e);qb.div=void 0};c.innerHTML=t.close;e.appendChild(c);document.body.appendChild(e)}},rd=function(){var b=p("multiplayertable"),c='<tr style="text-transform:uppercase"><td></td><td>'+t.username+"</td><td>"+t.race+"</td><td>"+t.team+"</td></tr>",d=cc,e=v.nkingdom()-1||14;C("LENGTH",e);
d&&e<d.length&&(e=d.length);for(d=0;d<e;d++)c+='<tr><td class="ucolor"></td><td class="username">'+t.open+'</td><td class="race"></td><td class="team"></td></tr>';6>e&&(c+='<tr style="height: '+(260-46*e)+'px"></tr>');b.innerHTML=c;p("multiplayertable").getElementsByTagName("tr");v.onlineKingdoms();p("msgs").style.height=b.clientHeight-87+"px"},cg=function(b,c,d,e,f,g,m,h,l,n,r){var k="<table><tbody>";b==Math.pow(2,31)-1&&(b="***");d==Math.pow(2,31)-1&&(d="***");c==Math.pow(2,31)-1&&(c="***");e==
Math.pow(2,31)-1&&(e="***");b=[t.gold,b,t.mapSize,l,t.items,m,t.wood,d,t.terrainOption,g,t.peons,n,t.food,c,t.water,f,t.gateways,h,t.stone,e,t.freePop,r];c=b.length;for(d=0;d<c;d+=2)d%6||(d&&(k+="</tr>"),k+="<tr>"),k+="<td>"+b[d]+":</td><td>"+b[d+1]+"</td>";k+="</tbody></table>";return p("showGameInfo").innerHTML=k},qd=[],te=Bb,ii=function(){var b=location.hash.substr(1);y.admin||Pk(b.substr(0,b.length-4))};window.onhashchange=di;var rc=p("msgs"),Vh=p("msginput");Vh.addEventListener("keyup",function(b){13==
b.keyCode&&vh()});var Tb=function(b,c,d,e){na("chat");d&&(c=v.gstarted()?oc:rc,c.innerHTML=5!==d?c.innerHTML+("<li><span>"+Ic(Ya(d,17))+" \u2014</span> "+Ic(Ya(b,e))+"</li>"):c.innerHTML+("<li>"+b+"</li>"),c.scrollTop=c.scrollHeight,v.gstarted()&&dg())};Tb.fast=!0;var dg=function(){11==rc.children.length&&oc.removeChild(oc.children[0]);1==rc.children.length&&(dg.intv=setInterval(dn,16E3))},dn=function(){oc.removeChild(oc.children[0]);0==rc.children.length&&clearInterval(dg.intv)},Aa=function(b){return String(b).replace(/</g,
"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},Sk=function(b){return String(b).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},vh=function(){if(r.started){var b=oc,c=p("msginputGame").value;p("msginputGame").value=""}else b=rc,c=Vh.value,Vh.value="";""!=c&&(c=Aa(c),b.innerHTML+="<li><span>"+y.name+" \u2014</span> "+c+"</li>",Rc(v.tempstradd(),1024,c),v.liveChat(c.length),b.scrollTop=b.scrollHeight,r.started&&dg())},hl=[Wk,Rb,Me,$b,Ne,Ld,Vg,Tb,Zi,Md,Nd,sk,Te,jk,ij,Yg,aj,me,
dl,function(b,c,d){d&&(d.ping=~~(.5*(Date.now()-Va.date)+.5),Sh[d.id]?Sh[d.id].put(d.ping):Sh[d.id]=[d.ping],d.ping>Va.max&&(Va.max=d.ping),Va.received++,Va.received==Za.length&&(Va.active=0,r.started&&(J[d.kingdom].ping=d.ping,qh())))},lk,ke,jj,hh,nf,jh,Hj,Le,Ze,bf,xf,kh,lh,ff,qj,of,eh,zj,Kg,df,gh,zf,tf,Dj,Bf,kf,hf,vf,nh,dk,Ej,sj,cg,function(b,c,d){if(!r.started&&d){C("peerInfo",b);b.name=Aa(b.name);b.team=parseInt(b.team);0>b.team&&(b.team=0);b.team%=6;b.race=parseInt(b.race);if(0>b.race||2<b.race)b.race=
0;c=b.version;d&&d.admin&&c!=y.version&&(Pb(),Da.leaveRoom(),yc(t.versionError+"<p> Admin version: "+parseFloat(c.substr(1))+"<br> Your version: "+parseFloat(y.version.substr(1))));d.nhinfo=b;d.username=b.name;rd()}},Qk,fb,Th,bl,Pi,Yk],il=function(b,c,d){return d&&d.admin},ne=function(b,c,d){return(d&&d.admin||!d)&&!r.started},aa=function(b,c,d){b=c.length;d=J[d.kingdom].control;for(var e=0;e<b;e++)if(!d[B[c[e]].kingdom])return!1;return!0},eg=function(b,c,d){b=J[d.kingdom].control;c=B[c];return b[c.kingdom]?
!0:!1},Wh=function(b,c,d){c=J[d.kingdom].control;b=B[b];return c[b.kingdom]?!0:!1};Wk.secureNH=ne;Rb.secureNH=aa;Me.secureNH=aa;$b.secureNH=aa;Ne.secureNH=aa;Ld.secureNH=aa;Vg.secureNH=aa;Zi.secureNH=aa;Md.secureNH=aa;Nd.secureNH=aa;sk.secureNH=Wh;Te.secureNH=aa;jk.secureNH=aa;ij.secureNH=aa;Yg.secureNH=aa;aj.secureNH=eg;lk.secureNH=aa;ke.secureNH=function(b,c,d){return d&&d.admin||!d};jj.secureNH=eg;hh.secureNH=aa;nf.secureNH=aa;jh.secureNH=aa;Hj.secureNH=Wh;Le.secureNH=aa;Ze.secureNH=aa;bf.secureNH=
aa;xf.secureNH=aa;kh.secureNH=aa;lh.secureNH=aa;ff.secureNH=aa;qj.secureNH=aa;of.secureNH=Wh;eh.secureNH=aa;zj.secureNH=aa;Kg.secureNH=aa;df.secureNH=aa;gh.secureNH=aa;zf.secureNH=aa;tf.secureNH=aa;Dj.secureNH=aa;Bf.secureNH=aa;kf.secureNH=aa;hf.secureNH=aa;vf.secureNH=aa;nh.secureNH=aa;dk.secureNH=eg;Ej.secureNH=eg;sj.secureNH=aa;cg.secureNH=ne;Qk.secureNH=ne;Th.secureNH=ne;bl.secureNH=ne;Yk.secureNH=il;fb.secureNH=il;Pi.secureNH=function(b,c,d){return!d};(function(){for(var b=0,c=hl.length;b<c;b++)hl[b].location=
b})();var jl=document.getElementsByClassName("ucolor1"),en=document.getElementsByClassName("username1"),fn=document.getElementsByClassName("race1"),gn=document.getElementsByClassName("team1"),kl=function(b){var c=1;2==b.button&&(c=-1);this.innerHTML=v.changeTeam(this.iteam,c)},ll=function(b){b=1;2==event.button&&(b=-1);this.innerHTML=Ra[v.changeRace(this.iteam,b)]},ml=function(){C(this.value);this.parentElement.style.background=this.value;v.changeColor(this.iteam,parseInt(this.value.substr(1),16))},
hn=function(){v.randomKingdoms(1)},jn=function(){v.randomKingdoms(-1)},Qj={0:"euro",1:"arab",2:"asia"},nl=function(b,c,d,e,f,g,m){var k="#"+e.toString(16);b=Ic(Ya(b,17));var h=p("multiplayertable").getElementsByTagName("tr"),l=g==y.superID,n=f+1;e=parseInt(k.substr(1),16);e=[e>>16&255,e>>8&255,e&255];el[f].style.background="rgb("+e[0]+","+e[1]+","+e[2]+")";fl[f].innerHTML=b;m&&(fl[f].style.color="#fff900");l||m&&y.admin?(Uh[f].innerHTML="",b=document.createElement("button"),b.onmousedown=kl,b.iteam=
n,b.innerHTML=c,Uh[f].appendChild(b),m&&(b.style.color="#fff900"),b=document.createElement("button"),b.onmousedown=ll,b.iteam=n,b.innerHTML=Ra[d],gl[f].appendChild(b),m&&(b.style.color="#fff900"),c=document.createElement("input"),c.type="color",c.iteam=n,c.value=k,el[f].appendChild(c),c.onchange=ml):(Uh[f].innerHTML=c,gl[f].innerHTML=Ra[d]);y.admin&&!l&&(h[f+1].onclick=qb,h[f+1].peer=g,h[f+1].i2=f+1)},ol=function(){y.name?(ia("returnmenu"),v.randomKingdoms()):Tk(ol)},bm=function(b){C(b,1111111);va.terrain=
pl(b,323,264248);va.check()},am=function(b){pl(b,0,0);l={};va.check()},pl=function(b,c,d){b=b.target.response;var e=new Uint8Array(b,24),k=v.nh19add(e.length);k=Be(k,e.length);for(var g=0;g<e.length;g++)k[g]=e[g];b=new Uint32Array(b,0,6);C(b);e=performance.now();v.rdnh19(b[0],b[1],b[2],b[3],b[4],b[5],c,d);C(performance.now()-e)},Bg=function(b,c,d){var e=new XMLHttpRequest;e.open("GET",b,!0);e.responseType="arraybuffer";e.onload=c;d&&(e.onprogress=d);e.send()},Vm=function(b,c,d){"granted"!=Notification.permission&&
Notification.requestPermission(function(b){});var e=new Notification(b,{icon:"/nehhon/807.png",body:c,requireInteraction:!1});d||(d=5550);setTimeout(function(){e.close()},d)},Fk,ql=function(b){for(var c="",d=0,e=b.length;d<e;d++)c+=Xm[b[d]];return c};Ul[ql([32718400,37271025,40005625,40704400,36602500,28462225,35940025,30858025])]!==ql([40704400,45024100,28462225,6400900,39312900,30858025,3025E4])&&(C("edge chrome firefox - compt"),Gk=Bb);var Lc=function(b){if(b){Lc.update=!1;var c=performance.now();
b=kd(v.configTerrain(),H*H*4);C(performance.now()-c);h.useProgram(la);h.activeTexture(h.TEXTURE1);c=h.createTexture();h.bindTexture(h.TEXTURE_2D,c);h.pixelStorei(h.UNPACK_ALIGNMENT,1);h.texImage2D(h.TEXTURE_2D,0,h.RGBA32F,H,Fa,0,h.RGBA,h.FLOAT,b);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT);h.bindTexture(h.TEXTURE_2D,
null);h.bindTexture(h.TEXTURE_2D,c);h.uniform1i(h.getUniformLocation(la,"img_data"),1);h.useProgram(ba);h.activeTexture(h.TEXTURE2)}else Lc.update=!0};Lc.update=!1;var b,Ek,Nf,Of,Pf,Qf,Rf,Sf,Tf,Uf,Vf,Wf,Xf,Yf,Qm=function(){var k={};b={move:function(){Rb.cursor=7}};b.move.iconID=262;b.move.obj={name:t.move};b.attack=function(){};b.attack.iconID=250;b.attack.obj={name:t.attack};b.guard=function(){Pd(4)};b.guard.iconID=237;b.guard.obj={name:t.guard};b.patrol=function(){Pd(8)};b.patrol.iconID=238;b.patrol.obj=
{name:t.patrol};b.pickUp=function(){};b.pickUp.iconID=240;b.pickUp.obj={name:t.pickItems};b.explore=function(){Pd(7)};b.explore.iconID=40;b.explore.obj={name:t.explore};b.stop=function(){C(999999999,44444)};b.stop.iconID=160;b.stop.obj={name:t.stop};b.stand=function(){C(999999999,44444)};b.stand.iconID=27;b.stand.obj={name:t.stand};b.attackGround=function(){};b.attackGround.iconID=100;b.steady=function(){};b.steady.iconID=21;b.createOrk=function(){K(58)};b.createOrk.iconID=120;b.createDwarf=function(){K(59)};
b.createDwarf.iconID=117;b.createSkeleton=function(){K(60)};b.createSkeleton.iconID=87;b.createGhost=function(){K(40)};b.createGhost.iconID=222;b.createFootman=function(){K(0)};b.createFootman.iconID=182;b.createArcher=function(){K(4)};b.createArcher.iconID=185;b.createMaceman=function(){K(3)};b.createMaceman.iconID=186;b.createPikeman=function(){K(1)};b.createPikeman.iconID=183;b.createLongbowman=function(){K(6)};b.createLongbowman.iconID=184;b.createKnight=function(){K(19)};b.createKnight.iconID=
180;b.iniMercenaries=function(b){b.mlist=[];b.mlistID=[];b.mercID=0;Tg(b);b.setupINTV(Fh,0,2E3)};b.iniMercenaries.builds=[30];b.iniHeroes=function(b){b.hlist=[];b.hlistID=[];b.heroID=0;Tg(b);b.setupINTV(Fh,0,2E3)};b.iniHeroes.builds=[30];b.mercFootmanArab=function(){Ca()};b.mercFootmanArab.iconID=49;b.mercFootmanArab.unit=80;b.mercFootmanArab.obj={};b.mercArcherArab=function(){Ca()};b.mercArcherArab.iconID=52;b.mercArcherArab.unit=85;b.mercArcherArab.obj={};b.mercMacemanArab=function(){Ca()};b.mercMacemanArab.iconID=
116;b.mercMacemanArab.obj={};b.mercMacemanArab.unit=83;b.mercPikemanArab=function(){Ca()};b.mercPikemanArab.iconID=52;b.mercPikemanArab.unit=82;b.mercPikemanArab.obj={};b.mercCavalry=function(){Ca()};b.mercCavalry.iconID=133;b.mercCavalry.unit=84;b.mercCavalry.obj={};b.mercEnichar=function(){Ca()};b.mercEnichar.iconID=123;b.mercEnichar.unit=91;b.mercEnichar.obj={};b.mercJihad=function(){Ca()};b.mercJihad.iconID=236;b.mercJihad.unit=86;b.mercJihad.obj={};b.mercFootmanArab6=function(){Ia()};b.mercFootmanArab6.iconID=
49;b.mercFootmanArab6.unit=80;b.mercFootmanArab6.obj={};b.mercArcherArab6=function(){Ia()};b.mercArcherArab6.iconID=52;b.mercArcherArab6.unit=85;b.mercArcherArab6.obj={};b.mercMacemanArab6=function(){Ia()};b.mercMacemanArab6.iconID=116;b.mercMacemanArab6.unit=83;b.mercMacemanArab6.obj={};b.mercPikemanArab6=function(){Ia()};b.mercPikemanArab6.iconID=52;b.mercPikemanArab6.unit=82;b.mercPikemanArab6.obj={};b.mercCavalry6=function(){Ia()};b.mercCavalry6.iconID=133;b.mercCavalry6.unit=84;b.mercCavalry6.obj=
{};b.mercEnichar6=function(){Ia()};b.mercEnichar6.iconID=123;b.mercEnichar6.unit=91;b.mercEnichar6.obj={};b.mercJihad6=function(){Ia()};b.mercJihad6.iconID=236;b.mercJihad6.unit=86;b.mercJihad6.obj={};b.mercFootman=function(){Ca()};b.mercFootman.iconID=182;b.mercFootman.unit=0;b.mercArcher=function(){Ca()};b.mercArcher.iconID=185;b.mercArcher.unit=4;b.mercMaceman=function(){Ca()};b.mercMaceman.iconID=186;b.mercMaceman.unit=3;b.mercPikeman=function(){Ca()};b.mercPikeman.iconID=183;b.mercPikeman.unit=
1;b.mercLongbowman=function(){Ca()};b.mercLongbowman.iconID=184;b.mercLongbowman.unit=6;b.mercKnight=function(){Ca()};b.mercKnight.iconID=180;b.mercKnight.unit=19;b.mercFootman6=function(){Ia()};b.mercFootman6.iconID=182;b.mercFootman6.unit=0;b.mercFootman6.obj={};b.mercArcher6=function(){Ia()};b.mercArcher6.iconID=185;b.mercArcher6.unit=4;b.mercArcher6.obj={};b.mercMaceman6=function(){Ia()};b.mercMaceman6.iconID=186;b.mercMaceman6.unit=3;b.mercMaceman6.obj={};b.mercPikeman6=function(){Ia()};b.mercPikeman6.iconID=
183;b.mercPikeman6.unit=1;b.mercPikeman6.obj={};b.mercLongbowman6=function(){Ia()};b.mercLongbowman6.iconID=184;b.mercLongbowman6.unit=6;b.mercLongbowman6.obj={};b.mercKnight6=function(){Ia()};b.mercKnight6.iconID=180;b.mercKnight6.unit=19;b.mercKnight6.obj={};b.mercArcherAsian6=function(){Ia()};b.mercArcherAsian6.iconID=53;b.mercArcherAsian6.unit=67;b.mercArcherAsian6.obj={};b.mercSamurai6=function(){Ia()};b.mercSamurai6.iconID=122;b.mercSamurai6.unit=68;b.mercSamurai6.obj={};b.mercHourseSamurai6=
function(){Ia()};b.mercHourseSamurai6.iconID=121;b.mercHourseSamurai6.unit=70;b.mercHourseSamurai6.obj={};b.mercRonin6=function(){Ia()};b.mercRonin6.iconID=54;b.mercRonin6.unit=66;b.mercRonin6.obj={};b.mercHorseArcher6=function(){Ia()};b.mercHorseArcher6.iconID=52;b.mercHorseArcher6.unit=69;b.mercHorseArcher6.obj={};b.mercChariot6=function(){Ia()};b.mercChariot6.iconID=79;b.mercChariot6.unit=72;b.mercChariot6.obj={};b.mercArcherAsian=function(){Ca()};b.mercArcherAsian.iconID=53;b.mercArcherAsian.unit=
67;b.mercArcherAsian.obj={};b.mercSamurai=function(){Ca()};b.mercSamurai.iconID=122;b.mercSamurai.unit=68;b.mercSamurai.obj={};b.mercHourseSamurai=function(){Ca()};b.mercHourseSamurai.iconID=121;b.mercHourseSamurai.unit=70;b.mercHourseSamurai.obj={};b.mercRonin=function(){Ca()};b.mercRonin.iconID=54;b.mercRonin.unit=66;b.mercRonin.obj={};b.mercHorseArcher=function(){Ca()};b.mercHorseArcher.iconID=52;b.mercHorseArcher.unit=69;b.mercHorseArcher.obj={};b.mercChariot=function(){Ca()};b.mercChariot.iconID=
79;b.mercChariot.unit=72;b.mercChariot.obj={};b.createPeon=function(){K(10)};b.createPeon.iconID=187;b.sameSpeed=function(){C(999999999,44444)};b.sameSpeed.iconID=82;b.restoreSpeed=function(){C(999999999,44444)};b.restoreSpeed.iconID=88;b.createSpy=function(){K(2)};b.createSpy.iconID=162;b.emergeAllUnits=function(){B[Q[0]].inventory.slice(0);C(999999999,44444)};b.emergeAllUnits.iconID=261;b.techFeudalism=function(){G(12)};b.techFeudalism.iconID=233;b.techArchitecture=function(){G(13)};b.techArchitecture.iconID=
226;b.techLearning=function(){G(14)};b.techLearning.iconID=129;b.createPeon1=function(){K(64)};b.createPeon1.iconID=55;b.createPeon2=function(){K(79)};b.createPeon2.iconID=132;b.createNinja=function(){K(65)};b.createNinja.iconID=51;b.techArmoredChariot=function(){G(51)};b.techArmoredChariot.iconID=79;b.techBuddhism=function(){G(45)};b.techBuddhism.iconID=127;b.techGreatWall=function(){G(48)};b.techGreatWall.iconID=80;b.ridingHorses=function(){G(49)};b.ridingHorses.iconID=64;b.irrigation=function(){G(50)};
b.irrigation.iconID=72;b.createHorseArcher2=function(){K(85)};b.createHorseArcher2.iconID=52;b.techMeditation=function(){G(52)};b.techMeditation.iconID=71;b.techKungFu=function(){G(53)};b.techKungFu.iconID=228;b.techTournaments=function(){G(54)};b.techTournaments.iconID=73;b.techPhilosophy=function(){G(55)};b.techPhilosophy.iconID=68;b.techNinjas=function(){G(56)};b.techNinjas.iconID=56;b.techMastery=function(){G(57)};b.techMastery.iconID=69;b.techGoldMining=function(){G(1)};b.techGoldMining.iconID=
58;b.techStoneMining=function(){G(2)};b.techStoneMining.iconID=57;b.createCrusaders=function(){C(999999999,44444)};b.createCrusaders.iconID=221;b.techFanaticism=function(){G(31)};b.techFanaticism.iconID=235;b.techCrusade=function(){G(32)};b.techCrusade.iconID=93;b.techEspionage=function(){G(30)};b.techEspionage.iconID=215;b.techInquisition=function(){G(33)};b.techInquisition.iconID=97;b.techHealing=function(){G(34)};b.techHealing.iconID=219;b.healing=function(){};b.healing.iconID=219;b.healing.iconIDbook=
201;b.teach=function(){};b.teach.iconID=23;b.teach.iconIDbook=217;b.techBless=function(){G(36)};b.techBless.iconID=159;b.bless=function(){};b.bless.iconID=159;b.bless.iconIDbook=204;b.techMedicine=function(){G(35)};b.techMedicine.iconID=220;b.createMage=function(){K(5)};b.createMage.iconID=156;b.techBat=function(){G(38)};b.techBat.iconID=168;b.techGolem=function(){G(41)};b.techGolem.iconID=119;b.techInvisibility=function(){G(37)};b.techInvisibility.iconID=217;b.techLightning=function(){G(40)};b.techLightning.iconID=
143;b.techFreeze=function(){G(39)};b.techFreeze.iconID=130;b.techHeroism=function(){G(22)};b.techHeroism.iconID=136;b.techWarfare=function(){G(23)};b.techWarfare.iconID=108;b.techTactics=function(){G(24)};b.techTactics.iconID=257;b.techMercenaries=function(){G(25)};b.techMercenaries.iconID=95;b.techHeroes=function(){G(26)};b.techHeroes.iconID=96;b.techFame=function(){G(27)};b.techFame.iconID=111;b.techSiegeTactics=function(){G(28)};b.techSiegeTactics.iconID=258;b.techBodyBuilding=function(){G(29)};
b.techBodyBuilding.iconID=101;b.createPriest=function(){K(9)};b.createPriest.iconID=155;b.createCow=function(){K(27)};b.createCow.iconID=163;b.techCropRotation=function(){G(8)};b.techCropRotation.iconID=227;b.techDomestication=function(){G(7)};b.techDomestication.iconID=157;b.techMapMaking=function(){G(16)};b.techMapMaking.iconID=89;b.techTradeRoutes=function(){G(17)};b.techTradeRoutes.iconID=102;b.techTradeTaxes=function(){G(18)};b.techTradeTaxes.iconID=110;b.techUsury=function(){G(19)};b.techUsury.iconID=
105;b.techSupplyStorage=function(){G(20)};b.techSupplyStorage.iconID=62;b.techBribery=function(){G(21)};b.techBribery.iconID=109;b.bribe=function(){};b.bribe.iconID=128;b.createCaravan=function(){K(61)};b.createCaravan.iconID=169;b.createCaravan2=function(){K(90)};b.createCaravan2.iconID=134;b.createFootman2=function(){K(80)};b.createFootman2.iconID=49;b.createArcher2=function(){K(81)};b.createArcher2.iconID=43;b.createSatrap=function(){K(83)};b.createSatrap.iconID=116;b.createPikeman2=function(){K(82)};
b.createPikeman2.iconID=42;b.createHorseArcher2=function(){K(85)};b.createHorseArcher2.iconID=124;b.createCavalry=function(){K(84)};b.createCavalry.iconID=133;b.createEnichar=function(){K(91)};b.createEnichar.iconID=123;b.createJihad=function(){K(86)};b.createJihad.iconID=236;b.trade=function(){};b.trade.iconID=161;b.unload=function(){};b.unload.iconID=148;b.createMercenaries=function(){};b.createMercenaries.iconID=95;b.createHeroes=function(){};b.createHeroes.iconID=96;b.upgradeGuildTower=function(){G(42)};
b.upgradeGuildTower.iconID=171;b.upgradeStoneTower=function(){G(43)};b.upgradeStoneTower.iconID=178;b.upgradeCannonTower=function(){G(44)};b.upgradeCannonTower.iconID=178;b.createCatapult=function(){K(37)};b.createCatapult.iconID=152;b.createHeavyCatapult=function(){K(39)};b.createHeavyCatapult.iconID=153;b.createBallist=function(){K(38)};b.createBallist.iconID=154;b.techEngineering=function(){G(47)};b.techEngineering.iconID=92;b.techCannonTower=function(){G(46)};b.techCannonTower.iconID=178;b.techPlateArmor=
function(){G(10)};b.techPlateArmor.iconID=131;b.techTemperIron=function(){G(4)};b.techTemperIron.iconID=266;b.techHalberd=function(){G(6)};b.techHalberd.iconID=113;b.techScaleArmor=function(){G(5)};b.techScaleArmor.iconID=251;b.techChainMail=function(){G(9)};b.techChainMail.iconID=252;b.techLongbow=function(){G(0)};b.techLongbow.iconID=259;b.techWoodCutting=function(){G(3)};b.techWoodCutting.iconID=107;b.techCrossbow=function(){G(11)};b.techCrossbow.iconID=112;b.createFishingBoat=function(){K(74)};
b.createFishingBoat.iconID=48;b.createXebec=function(){K(76)};b.createXebec.iconID=166;b.upgradeShip=function(){};b.upgradeShip.iconID=268;b.fishing=function(){};b.fishing.iconID=41;b.createHulk=function(){K(75)};b.createHulk.iconID=165;b.createGalleon=function(){K(73)};b.createGalleon.iconID=164;b.techLandingTactics=function(){};b.techLandingTactics.iconID=98;b.techConcentration=function(){G(58)};b.techConcentration.iconID=75;b.techConfusion=function(){G(59)};b.techConfusion.iconID=76;b.techWhirlpool=
function(){G(60)};b.techWhirlpool.iconID=78;b.techDragon=function(){G(61)};b.techDragon.iconID=115;b.techTurnToStone=function(){G(62)};b.techTurnToStone.iconID=77;b.techFlameBolt=function(){G(63)};b.techFlameBolt.iconID=25;b.techJewelry=function(){G(64)};b.techJewelry.iconID=230;b.techBanking=function(){G(65)};b.techBanking.iconID=74;b.techChemistry=function(){G(66)};b.techChemistry.iconID=225;b.techSeaFood=function(){G(67)};b.techSeaFood.iconID=67;b.techGunPowder=function(){G(68)};b.techGunPowder.iconID=
212;b.techRocketArrow=function(){G(69)};b.techRocketArrow.iconID=47;b.techBushido=function(){G(70)};b.techBushido.iconID=60;b.techLeadership=function(){G(71)};b.techLeadership.iconID=114;b.techHonor=function(){G(72)};b.techHonor.iconID=94;b.techSunTzu=function(){G(73)};b.techSunTzu.iconID=66;b.createRonin=function(){K(66)};b.createRonin.iconID=54;b.createArcher1=function(){K(67)};b.createArcher1.iconID=53;b.createSamurai=function(){K(68)};b.createSamurai.iconID=122;b.createHorseArcher1=function(){K(69)};
b.createHorseArcher1.iconID=52;b.createMonk=function(){K(128)};b.createMonk.iconID=45;b.createMage1=function(){K(129)};b.createMage1.iconID=50;b.createPriest1=function(){K(127)};b.createPriest1.iconID=44;b.createPriest2=function(){K(87)};b.createPriest2.iconID=125;b.buyItems=function(){};b.buyItems.iconID=31;b.sellItems=function(){};b.sellItems.iconID=30;b.createHorseSamurai=function(){K(70)};b.createHorseSamurai.iconID=121;b.createChariot=function(){K(72)};b.createChariot.iconID=79;b.stopTech=function(){C(999999999,
44444)};b.stopTech.iconID=160;b.repair=function(){};b.repair.iconID=145;b.conquest=function(){};b.conquest.iconID=249;b.dcm=function(){};b.dcm.iconID=260;b.buildBarrack=function(){S(14)};b.buildBarrack.iconID=205;b.buildBarrack1=function(){S(71)};b.buildBarrack1.iconID=205;b.buildBarrack2=function(){S(102)};b.buildBarrack2.iconID=205;b.buildTower=function(){S(32)};b.buildTower.iconID=170;b.buildStorage=function(){S(18)};b.buildStorage.iconID=200;b.buildLumbermill=function(){S(15)};b.buildLumbermill.iconID=
199;b.buildLumbermill2=function(){S(93)};b.buildLumbermill2.iconID=199;b.buildFields=function(){S(20)};b.buildFields.iconID=265;b.buildCastle=function(){S(12)};b.buildCastle.iconID=206;b.buildCastle1=function(){S(62)};b.buildCastle1.iconID=206;b.buildCastle2=function(){S(63)};b.buildCastle2.iconID=206;b.buildAcademy=function(){S(17)};b.buildAcademy.iconID=204;b.buildCathedral=function(){S(11)};b.buildCathedral.iconID=191;b.buildCathedral2=function(){S(106)};b.buildCathedral2.iconID=189;b.buildMerchands=
function(){S(24)};b.buildMerchands.iconID=198;b.buildMerchands2=function(){S(108)};b.buildMerchands2.iconID=198;b.buildChurch=function(){S(25)};b.buildChurch.iconID=197;b.buildMarket=function(){S(33)};b.buildMarket.iconID=194;b.buildMageTower=function(){S(16)};b.buildMageTower.iconID=192;b.buildMageTower2=function(){S(107)};b.buildMageTower2.iconID=192;b.buildDummy=function(){S(36)};b.buildDummy.iconID=65;b.buildFarm=function(){S(23)};b.buildFarm.iconID=193;b.buildBlacksmith=function(){S(26)};b.buildBlacksmith.iconID=
202;b.buildWorkshop=function(){S(29)};b.buildWorkshop.iconID=201;b.buildWorkshop2=function(){S(98)};b.buildWorkshop2.iconID=201;b.buildStable=function(){S(28)};b.buildStable.iconID=196;b.buildStable2=function(){S(103)};b.buildStable2.iconID=196;b.buildTavern=function(){S(30)};b.buildTavern.iconID=208;b.buildHouse=function(){S(31)};b.buildHouse.iconID=195;b.buildHarbor=function(){S(41)};b.buildHarbor.iconID=188;b.buildOutpost=function(){S(34)};b.buildOutpost.iconID=158;b.buildWoodWall=function(){S(13)};
b.buildWoodWall.iconID=210;b.buildWoodGate=function(){};b.buildWoodGate.iconID=209;b.buildWoodGate.disabled=2;b.buildBridge=function(){S(35)};b.buildBridge.iconID=176;b.freeze=function(){};b.freeze.iconID=99;b.freeze.obj={name:t.freeze};b.freeze.iconIDbook=205;b.confusion=function(){};b.confusion.iconID=76;b.confusion.obj={name:"Confusion",spcost:[120,0,0,0]};b.confusion.iconIDbook=206;b.turnToStone=function(){};b.turnToStone.iconID=77;b.turnToStone.iconIDbook=213;b.turnToStone.obj={name:"Turn to Stone",
spcost:[40,0,0,0]};b.whirlpool=function(){};b.whirlpool.iconID=78;b.whirlpool.iconIDbook=214;b.whirlpool.obj={name:"Whirlpool",spcost:[80,0,0,0]};b.flameBolt=function(){};b.flameBolt.iconID=25;b.flameBolt.obj={name:"Flame Bolt",spcost:[120,0,0,0]};b.flameBolt.iconIDbook=216;b.createDragon=function(){};b.createDragon.iconID=115;b.createDragon.obj={name:"Spawn Dragon",spcost:[320,0,0,0]};b.createDragon.iconIDbook=215;b.lightning=function(){};b.lightning.iconID=263;b.lightning.obj={name:t.lightning,
spcost:[80,0,0,0]};b.lightning.iconIDbook=200;b.createBat=function(){};b.createBat.iconID=168;b.createBat.iconIDbook=203;b.createGolem=function(){};b.createGolem.iconID=119;b.createGolem.iconIDbook=209;b.autoInvisibility=function(){};b.autoInvisibility.iconID=217;b.autoInvisibility.obj={name:t.invisibility};b.invisibility=function(){};b.invisibility.iconID=217;b.invisibility.iconIDbook=208;b.impersonate=function(){};b.impersonate.iconID=32;b.impersonate.obj={name:"Impersonate"};b.revealSelf=function(){C(999999999,
44444)};b.revealSelf.iconID=33;b.revealSelf.obj={name:"Reveal your true self"};b.buildHouse1=function(){S(111)};b.buildHouse1.iconID=195;b.buildHouse2=function(){S(92)};b.buildHouse2.iconID=195;b.buildLumbermill1=function(){S(112)};b.buildLumbermill1.iconID=199;b.buildStorage1=function(){S(113)};b.buildStorage1.iconID=200;b.buildStorage2=function(){S(94)};b.buildStorage2.iconID=200;b.buildFarm1=function(){S(114)};b.buildFarm1.iconID=193;b.buildFarm2=function(){S(95)};b.buildFarm2.iconID=193;b.buildHarbor1=
function(){S(115)};b.buildHarbor1.iconID=188;b.buildHarbor2=function(){S(96)};b.buildHarbor2.iconID=188;b.buildBlacksmith1=function(){S(116)};b.buildBlacksmith1.iconID=202;b.buildBlacksmith2=function(){S(97)};b.buildBlacksmith2.iconID=202;b.buildWorkshop1=function(){S(117)};b.buildWorkshop1.iconID=201;b.buildChurch1=function(){S(118)};b.buildChurch1.iconID=197;b.buildChurch2=function(){S(99)};b.buildChurch2.iconID=197;b.buildTavern1=function(){S(119)};b.buildTavern1.iconID=208;b.buildTavern2=function(){S(100)};
b.buildTavern2.iconID=208;b.buildMarket1=function(){S(120)};b.buildMarket1.iconID=194;b.buildMarket2=function(){S(101)};b.buildMarket2.iconID=194;b.buildStable1=function(){S(121)};b.buildStable1.iconID=196;b.buildOutpost1=function(){S(122)};b.buildOutpost1.iconID=158;b.buildOutpost2=function(){S(104)};b.buildOutpost2.iconID=158;b.buildCathedral1=function(){S(123)};b.buildCathedral1.iconID=190;b.buildMageTower1=function(){S(124)};b.buildMageTower1.iconID=192;b.createObjects=function(){uh("magicworkshopmenu",
bk)};b.createObjects.iconID=20;b.createObjects.obj={};b.buildMagicWorkshop=function(){S(110)};b.buildMagicWorkshop.iconID=46;b.buildMerchands1=function(){S(125)};b.buildMerchands1.iconID=198;b.buildAcademy1=function(){S(126)};b.buildAcademy1.iconID=204;b.buildAcademy2=function(){S(109)};b.buildAcademy2.iconID=204;b.buildRocketTower=function(){S(57)};b.buildRocketTower.iconID=47;b.murder=function(){};b.murder.iconID=28;b.convertJihad=function(){C(999999999,44444)};b.convertJihad.iconID=236;b.convertJihad.obj=
{};b.menuCommonBuild2=function(){};b.menuCommonBuild2.iconID=17;Vf=[b.buildFarm2,b.buildBlacksmith2,b.buildWorkshop2,b.buildStable2,b.buildTavern2,b.buildHouse2];Vf.menuName="a_build";b.menuCommonBuild2.xtra=Vf;b.menuSpecialBuild2=function(){};b.menuSpecialBuild2.iconID=15;Wf=[b.buildCastle2,b.buildAcademy2,b.buildCathedral2,b.buildMerchands2,b.buildChurch2,b.buildMarket2,b.buildMageTower2,b.buildMagicWorkshop];Wf.menuName="a_build";b.menuSpecialBuild2.xtra=Wf;b.menuOtherBuild2=function(){};b.menuOtherBuild2.iconID=
16;Xf=[b.buildHarbor2,b.buildOutpost2,b.buildWoodWall,b.buildWoodGate,b.buildBridge];Xf.menuName="e_build";b.menuOtherBuild2.xtra=Xf;b.menuBuilds2=function(){};b.menuBuilds2.iconID=245;Yf=[b.menuSpecialBuild2,b.menuCommonBuild2,b.menuOtherBuild2,b.buildBarrack2,b.buildTower,b.buildStorage2,b.buildLumbermill2,b.buildFields];Yf.menuName="a_build";b.menuBuilds2.xtra=Yf;b.origin=Nk;b.origin.iconID=255;b.createCarpet=function(){};b.createCarpet.iconID=146;b.createCarpet.iconIDbook=202;b.createJinn=function(){};
b.createJinn.iconID=118;b.createJinn.iconIDbook=218;b.magicVision=function(){};b.magicVision.iconID=223;b.magicVision.iconIDbook=210;b.fireRain=function(){};b.fireRain.iconID=264;b.fireRain.iconIDbook=199;b.raiseDead=function(){};b.raiseDead.iconID=87;b.raiseDead.iconIDbook=211;b.createMage2=function(){K(89)};b.createMage2.iconID=126;b.techCowPoaching=function(){G(74)};b.techCowPoaching.iconID=85;b.techHorseManShip=function(){G(75)};b.techHorseManShip.iconID=231;b.techScimitar=function(){G(76)};b.techScimitar.iconID=
84;b.techJihad=function(){G(77)};b.techJihad.iconID=236;b.techCarpet=function(){G(78)};b.techCarpet.iconID=146;b.techMagicWorkshop=function(){G(79)};b.techMagicWorkshop.iconID=86;b.techFireRain=function(){G(80)};b.techFireRain.iconID=264;b.techMagicVision=function(){G(81)};b.techMagicVision.iconID=224;b.techNecromancy=function(){G(82)};b.techNecromancy.iconID=87;b.techJinn=function(){G(83)};b.techJinn.iconID=118;b.techOreFloatation=function(){G(84)};b.techOreFloatation.iconID=106;b.techRiddingHorses=
function(){G(85)};b.techRiddingHorses.iconID=232;b.techJanissary=function(){G(86)};b.techJanissary.iconID=81;b.buildMagicItems=function(){};b.buildMagicItems.iconID=20;b.techSlavery=function(){G(87)};b.techSlavery.iconID=135;b.stopBuilding=function(){C(999999999,44444)};b.stopBuilding.iconID=160;b.menuSpecialBuild1=function(){};b.menuSpecialBuild1.iconID=15;Nf=[b.buildCastle1,b.buildAcademy1,b.buildCathedral1,b.buildMerchands1,b.buildChurch1,b.buildMarket1,b.buildMageTower1,b.buildRocketTower,b.buildDummy];
Nf.menuName="a_build";b.menuSpecialBuild1.xtra=Nf;b.menuCommonBuild1=function(){};b.menuCommonBuild1.iconID=17;Of=[b.buildFarm1,b.buildBlacksmith1,b.buildWorkshop1,b.buildStable1,b.buildTavern1,b.buildHouse1];Of.menuName="a_build";b.menuCommonBuild1.xtra=Of;b.menuSpecialBuild=function(){};b.menuSpecialBuild.iconID=15;Pf=[b.buildCastle,b.buildAcademy,b.buildCathedral,b.buildMerchands,b.buildChurch,b.buildMarket,b.buildMageTower,b.buildDummy];Pf.menuName="e_build";b.menuSpecialBuild.xtra=Pf;b.menuCommonBuild=
function(){};b.menuCommonBuild.iconID=17;Qf=[b.buildFarm,b.buildBlacksmith,b.buildWorkshop,b.buildStable,b.buildTavern,b.buildHouse];Qf.menuName="e_build";b.menuCommonBuild.xtra=Qf;b.menuOtherBuild=function(){};b.menuOtherBuild.iconID=16;Rf=[b.buildHarbor,b.buildOutpost,b.buildWoodWall,b.buildWoodGate,b.buildBridge];Rf.menuName="e_build";b.menuOtherBuild.xtra=Rf;b.menuOtherBuild1=function(){};b.menuOtherBuild1.iconID=16;Sf=[b.buildHarbor1,b.buildOutpost1,b.buildWoodWall,b.buildWoodGate,b.buildBridge];
Sf.menuName="e_build";b.menuOtherBuild1.xtra=Sf;b.menuBuilds=function(){};Tf=[b.menuSpecialBuild,b.menuCommonBuild,b.menuOtherBuild,b.buildBarrack,b.buildTower,b.buildStorage,b.buildLumbermill,b.buildFields];Tf.menuName="e_build";b.menuBuilds.iconID=245;b.menuBuilds.xtra=Tf;b.menuBuilds1=function(){};b.menuBuilds1.iconID=245;Uf=[b.menuSpecialBuild1,b.menuCommonBuild1,b.menuOtherBuild1,b.buildBarrack1,b.buildTower,b.buildStorage1,b.buildLumbermill1,b.buildFields];Uf.menuName="a_build";b.menuBuilds1.xtra=
Uf;Ek=function(){b.fishing.obj={};b.impersonate.obj={};b.techGreatWall.obj=F[48];b.revealSelf.obj={};b.trade.obj={};b.unload.obj={};b.mercFootman6.obj={};b.murder.obj={};b.mercArcher6.obj={};b.mercMaceman6.obj={};b.mercPikeman6.obj={};b.mercLongbowman6.obj={};b.sameSpeed.obj={name:"Same speed"};b.restoreSpeed.obj={name:"Restore speed"};b.mercKnight6.obj={};b.attackGround.obj={};b.steady.obj={};b.bribe.obj={};b.createPriest1.obj=A[127];b.createPriest2.obj=A[87];b.createFootman2.obj=A[80];b.createArcher2.obj=
A[81];b.createSatrap.obj=A[83];b.createPikeman2.obj=A[82];b.createHorseArcher2.obj=A[85];b.createCavalry.obj=A[84];b.createEnichar.obj=A[91];b.createJihad.obj=A[86];b.createMonk.obj=A[128];b.healing.obj={name:t.heal,spcost:[20,0,0,0]};b.bless.obj={name:t.bless,spcost:[20,0,0,0]};b.stopTech.obj={};b.conquest.obj={};b.dcm.obj={name:t.dcm};b.repair.obj={name:t.repair};b.menuOtherBuild.obj={};b.menuOtherBuild1.obj={};b.menuOtherBuild2.obj={};b.sellItems.obj={};b.buyItems.obj={};b.menuBuilds.obj={name:t.menuBuild};
b.menuCommonBuild.obj={};b.menuSpecialBuild.obj={};b.techMastery.obj=F[57];b.techNinjas.obj=F[56];b.teach.obj={name:"Teach",spcost:[20,0,0,0]};b.techPhilosophy.obj=F[55];b.techKungFu.obj=F[53];b.techTournaments.obj=F[54];b.techMeditation.obj=F[52];b.menuCommonBuild1.obj={};b.menuCommonBuild2.obj={};b.createMage1.obj=A[129];b.menuSpecialBuild1.obj={};b.menuSpecialBuild2.obj={};b.menuBuilds1.obj={name:t.menuBuild};b.menuBuilds2.obj={name:t.menuBuild};b.stopBuilding.obj={};b.freeze.obj={name:t.freeze,
spcost:[200,0,0,0]};b.invisibility.obj={name:t.invisibility,spcost:[40,0,0,0]};b.autoInvisibility.obj={name:t.invisibility};b.createHeroes.obj={};b.createMercenaries.obj={};b.upgradeShip.obj={};b.techMedicine.obj=F[35];b.techBless.obj=F[36];b.buildHouse1.obj=A[111];b.techHealing.obj=F[34];b.techInquisition.obj=F[33];b.techArmoredChariot.obj=F[51];b.techRocketArrow.obj=F[69];b.techJewelry.obj=F[64];b.techGunPowder.obj=F[68];b.techSeaFood.obj=F[67];b.techChemistry.obj=F[66];b.techBanking.obj=F[65];
b.createMage.obj=A[5];b.techBat.obj=F[38];b.techGolem.obj=F[41];b.techInvisibility.obj=F[37];b.techLightning.obj=F[40];b.techFreeze.obj=F[39];b.techHeroism.obj=F[22];b.createHorseSamurai.obj=A[70];b.createChariot.obj=A[72];b.createHorseArcher1.obj=A[69];b.createHorseArcher2.obj=A[85];b.createSamurai.obj=A[68];b.createArcher1.obj=A[67];b.techConfusion.obj=F[59];b.techConcentration.obj=F[58];b.techWhirlpool.obj=F[60];b.techDragon.obj=F[61];b.techTurnToStone.obj=F[62];b.techFlameBolt.obj=F[63];b.createRonin.obj=
A[66];b.buildStorage.obj=A[18];b.buildStorage1.obj=A[113];b.buildStorage2.obj=A[94];b.buildFields.obj=A[20];b.buildLumbermill.obj=A[15];b.buildLumbermill1.obj=A[112];b.buildLumbermill2.obj=A[93];b.buildTower.obj=A[32];b.buildBarrack1.obj=A[71];b.buildBarrack.obj=A[14];b.buildBarrack2.obj=A[102];b.buildDummy.obj=A[36];b.buildRocketTower.obj=A[57];b.buildMageTower.obj=A[16];b.buildMageTower1.obj=A[124];b.buildMageTower2.obj=A[107];b.buildMarket.obj=A[33];b.buildMarket1.obj=A[120];b.buildMarket2.obj=
A[101];b.buildChurch.obj=A[25];b.buildChurch1.obj=A[118];b.buildChurch2.obj=A[99];b.buildMerchands.obj=A[24];b.irrigation.obj=F[50];b.ridingHorses.obj=F[49];b.buildMerchands1.obj=A[125];b.buildMerchands2.obj=A[108];b.buildCathedral.obj=A[11];b.buildCathedral1.obj=A[123];b.buildCathedral2.obj=A[106];b.buildAcademy.obj=A[17];b.buildAcademy1.obj=A[126];b.buildAcademy2.obj=A[109];b.buildCastle.obj=A[12];b.magicVision.obj={name:"Magic Vision",spcost:[20,0,0,0]};b.fireRain.obj={name:"Fire Rain",spcost:[200,
0,0,0]};b.raiseDead.obj={name:"Raise the Dead",spcost:[40,0,0,0]};b.createJinn.obj={name:"Spawn Jinn",spcost:[320,0,0,0]};b.createCarpet.obj={name:"Spawn Magic Carpet",spcost:[320,0,0,0]};b.buildCastle1.obj=A[62];b.buildCastle2.obj=A[63];b.buildHouse.obj=A[31];b.buildHouse2.obj=A[92];b.buildTavern.obj=A[30];b.buildTavern1.obj=A[119];b.buildTavern2.obj=A[100];b.buildStable.obj=A[28];b.buildStable1.obj=A[121];b.buildStable2.obj=A[103];b.buildFarm.obj=A[23];b.buildFarm1.obj=A[114];b.buildFarm2.obj=A[95];
b.buildWorkshop.obj=A[29];b.buildWorkshop1.obj=A[117];b.buildWorkshop2.obj=A[98];b.buildBlacksmith.obj=A[26];b.buildBlacksmith1.obj=A[116];b.buildBlacksmith2.obj=A[97];b.buildBridge.obj=A[35];b.buildHarbor.obj=A[41];b.buildHarbor1.obj=A[115];b.buildHarbor2.obj=A[96];b.createMage2.obj=A[89];b.buildMagicItems.obj={};b.techJanissary.obj=F[86];b.techRiddingHorses.obj=F[85];b.techOreFloatation.obj=F[84];b.techJinn.obj=F[83];b.techNecromancy.obj=F[82];b.techMagicVision.obj=F[81];b.techFireRain.obj=F[80];
b.techMagicWorkshop.obj=F[79];b.techCarpet.obj=F[78];b.techJihad.obj=F[77];b.techScimitar.obj=F[76];b.techHorseManShip.obj=F[75];b.techCowPoaching.obj=F[74];b.buildWoodGate.obj={};b.buildWoodWall.obj=A[13];b.buildOutpost.obj=A[34];b.buildOutpost1.obj=A[122];b.buildOutpost2.obj=A[104];b.createGolem.obj={name:"Spawn Stone Golem",spcost:[480,0,0,0]};b.techSunTzu.obj=F[73];b.techBushido.obj=F[70];b.techLeadership.obj=F[71];b.techHonor.obj=F[72];b.createBat.obj={name:"Spawn Bat",spcost:[40,0,0,0]};b.techGoldMining.obj=
F[1];b.techStoneMining.obj=F[2];b.emergeAllUnits.obj={};b.origin.obj={name:"Origin"};b.createOrk.obj=A[58];b.createDwarf.obj=A[59];b.createSkeleton.obj=A[60];b.createGhost.obj=A[40];b.createFootman.obj=A[0];b.createArcher.obj=A[4];b.techSlavery.obj=F[87];b.createMaceman.obj=A[3];b.createPikeman.obj=A[1];b.createLongbowman.obj=A[6];b.createKnight.obj=A[19];b.mercFootman.obj=k;b.mercArcher.obj=k;b.mercMaceman.obj=k;b.mercPikeman.obj=k;b.mercLongbowman.obj=k;b.mercKnight.obj=k;b.createPeon.obj=A[10];
b.createSpy.obj=A[2];b.techFeudalism.obj=F[12];b.techArchitecture.obj=F[13];b.techLearning.obj=F[14];b.createPeon1.obj=A[64];b.createPeon2.obj=A[79];b.createNinja.obj=A[65];b.techBuddhism.obj=F[45];b.createCrusaders.obj={name:"Preach a crusade",cost:[1E3,0,2E3,0]};b.buildMagicWorkshop.obj=A[110];b.techFanaticism.obj=F[31];b.techCrusade.obj=F[32];b.techEspionage.obj=F[30];b.techChainMail.obj=F[9];b.techHalberd.obj=F[6];b.techLongbow.obj=F[0];b.techScaleArmor.obj=F[5];b.techTemperIron.obj=F[4];b.techPlateArmor.obj=
F[10];b.techLandingTactics.obj={};b.createGalleon.obj=A[73];b.createHulk.obj=A[75];b.createXebec.obj=A[76];b.createFishingBoat.obj=A[74];b.techCrossbow.obj=F[11];b.techWoodCutting.obj=F[3];b.techCannonTower.obj=F[46];b.techEngineering.obj=F[47];b.createBallist.obj=A[38];b.createHeavyCatapult.obj=A[39];b.createCatapult.obj=A[37];b.upgradeCannonTower.obj=F[44];b.upgradeStoneTower.obj=F[43];b.upgradeGuildTower.obj=F[42];b.createCaravan.obj=A[61];b.createCaravan2.obj=A[90];b.techBribery.obj=F[21];b.techSupplyStorage.obj=
F[20];b.techUsury.obj=F[19];b.techCropRotation.obj=F[8];b.createCow.obj=A[27];b.techDomestication.obj=F[7];b.techTradeTaxes.obj=F[18];b.techTradeRoutes.obj=F[17];b.techMapMaking.obj=F[16];b.createPriest.obj=A[9];b.techBodyBuilding.obj=F[29];b.techSiegeTactics.obj=F[28];b.techFame.obj=F[27];b.techHeroes.obj=F[26];b.techMercenaries.obj=F[25];b.techTactics.obj=F[24];b.techWarfare.obj=F[23];for(var c=Object.keys(b),d=0,e=c.length;d<e;d++){var f=b[c[d]];f.id=d;f.objName=c[d];f.obj&&(f.obj.nu=f)}}},fg=
function(b,c){var d=c.length,e=b.length,k=0;a:for(;k<d;k++){for(var g=0;g<e;g++)if(c[k+g]!==b[g])continue a;return k}return!1},rl=function(b){for(var c=b.length,d=new Uint16Array(b.length),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d},dc=function(b,c){return fg(rl(b),c)+b.length},gg=function(b,c){b+=String.fromCharCode(0);return fg(rl(b),c)},Xh=function(b,c,d){var e="";for(c+=b;b<c&&d[b];b++)e+=String.fromCharCode(d[b]);return e},oe=function(b){b=new Uint8Array(b);var c=fg([50,109,122,116],b)+6,d=b[c]+
256*b[c+1],e=b[c+2]+(b[c+3]<<8)+(b[c+4]<<16);C("mapx:",d,"units",e);C("header",b[dc(".header",b)],"description",b[dc(".description",b)],"kingdominfo",b[dc(".kingdominfo",b)],"diplomacy",b[dc(".diplomacy",b)],"forbidden.upgrades",b[dc(".forbidden.upgrades",b)],"tiles",b[dc(".tiles",b)]);C(b);c=2*d;d={mapx:d,mapy:d,arje:!1};var f="utype xx56 xx2 xx562 type xx3 xxtra x32 y32 kingdom race id d health maxHealth attack defence xx8 level xx9 resistance xx11 mana xx12".split(" "),k="utype xx56 xx2 xx562 type xx3 xxtra x32 y32 kingdom race id d health maxHealth attack defence xx8 level xx9 resistance xx11 mana xx12 xx13 xx14 xx15 xx16 xx17 xx18 xx19 xx20 xx21 resource".split(" "),
m=c/2,h=20480+2*m*m,l={};m=0;for(var n=b.length;m<n;m++){var p=b[m];l[p]||(l[p]=[]);l[p].push(m)}l=[];var r={56:!0,58:!0,88:!0,72:!0};m=h+1;for(n=b.length;m<n;m++)if(p=b[m],r[p]&&r[b[m+4]]){h={};p=72!==p?f:k;for(var t=m-2,v=0,x=p.length;v<x;v++){var y=p[v];"kingdom"==y||"race"==y?(h[y]=b[t],t++):(h[y]=b[t]+256*b[t+1],t+=2)}m+=2*x-3;l.push(h)}d.allunits=l;d.allunits.length>e&&(d.allunits.length=e);e=d.allunits;c/=2;l=[];f=0;r=[];p=h=b[dc(".forbidden.upgrades",b)]+1;m=h*=512;for(k=b.length;m<k;m+=2){v=
b[m];t=~~(m/512);for(n=8;n<c&&b[n+m]===(v+n/4)%256;n+=4);20<n&&(m=512*t,1==l.length&&(m=512*(t-(2-(t-p)%2))),n=b.slice(h,m),h-m&&(l[f++]=[h,m],r.push(n)),m+=512,2==l.length&&(m-=512),h=m)}l[f++]=[h,b.length];r={64:[l[0]],96:[l[0]],128:[l[0]],192:[l[1],l[0],l[2],l[3]],256:[l[1],l[0],l[2],l[3]],384:[l[1],l[0],l[2],l[3],l[4],l[5],l[6]],512:[l[1],l[0],l[2],l[3],l[4],l[5],l[6],l[7],l[8],l[9]]}[c];C(l);l=new Uint8Array(c*c);h=new Uint8Array(c*c);n=f=0;for(p=r.length;n<p;n++)if(k=r[n],f<c*c)for(m=k[0],k=
k[1];m<k;m+=2)l[f]=kn[b[m]]||0,h[f]=b[m+1],10<h[f]&&e.push({type:7,d:h[f]%31,x32:f%c,y32:~~(f/c)}),f++;d.terrain=l;e=(c="grass",gg("grass",b))||(c="summer",gg("summer",b))||(c="desert",gg("desert",b))||(c="snow",gg("snow",b));if("summer"==c||c)if("summer"==c||"desert"==c)c="grass";f=Xh(512*(b[dc(".description",b)]-1),512,b);d.description=f;d.author=Xh(e-64,64,b);d.name=Xh(e-128,64,b);d.terrainType=c;d.kingdoms=oe.getKingdoms(b,d);oe.getDiplomacy(b,d.kingdoms);C(d);return d};oe.getKingdoms=function(b,
c){for(var d=fg([192,4],b)+50;!b[d];)d++;var e="name tzar active resGold resStone resFood resWood x6 race x8 x9 x10 x11 x12 x13 x14 AI x16 x17 x18 x19 x20".split(" "),f=e.length,k=[],m,h=[[0,0,189],[206,25,25],[49,181,0],[173,0,197],[255,222,0],[0,181,181],[255,156,33],[90,90,90]];C("kingdoms:",d);c.tr={0:0,9:0,10:0};for(var l=0;8>l;l++){for(var n={color:h[l]},p=!0,t=0;t<f;t++){var r=e[t];if("name"==r||"tzar"==r){for(n[r]="";!b[d];)d++;for(m=d+32;b[d];)n[r]+=String.fromCharCode(b[d]),d++;d=m}else n[r]=
b[d]+(b[d+1]<<8)+(b[d+2]<<16)+(b[d+3]<<24),"race"==r&&(n[r]=b[d],n.racestr=Qj[b[d]-1]),2!=t||b[d]||(p=!1),d+=4}p&&(k.push(n),c.tr[l+1]=k.length);1<k.length&&(n.IA=1);n.resources=[n.resGold,n.resWood,n.resFood,n.resStone];n.race--}C(k);return k};oe.getDiplomacy=function(b,c){for(var d=512*(b[dc(".diplomacy",b)]-1),e=c.length,f=0;f<e;f++){var k=[0];if(c[f]){c[f].diplomacy=k;for(var m=1;9>m;m++){if(c[m-1]){var h=b[d];h=60>h&&m-1!=f?1:0;k.push(h)}d+=4}}else d+=32}};var kn={0:3,32:0,144:1,240:2,64:2},
n="undefined"!==typeof n?n:{},pe={},sc;for(sc in n)n.hasOwnProperty(sc)&&(pe[sc]=n[sc]);n.arguments=[];n.thisProgram="./this.program";n.quit=function(b,c){throw c;};n.preRun=[];n.postRun=[];var wd=!1,vc=!1,hg=!1,sl=!1;wd="object"===typeof window;vc="function"===typeof importScripts;hg="object"===typeof process&&"function"===typeof require&&!wd&&!vc;sl=!wd&&!hg&&!vc;var Mb="";if(hg){Mb=__dirname+"/";var Yh,Zh;n.read=function(b,c){Yh||(Yh=require("fs"));Zh||(Zh=require("path"));b=Zh.normalize(b);b=
Yh.readFileSync(b);return c?b:b.toString()};n.readBinary=function(b){b=n.read(b,!0);b.buffer||(b=new Uint8Array(b));mg(b.buffer);return b};1<process.argv.length&&(n.thisProgram=process.argv[1].replace(/\\/g,"/"));n.arguments=process.argv.slice(2);"undefined"!==typeof module&&(module.exports=n);process.on("uncaughtException",function(b){if(!(b instanceof Vc))throw b;});process.on("unhandledRejection",Gb);n.quit=function(b){process.exit(b)};n.inspect=function(){return"[Emscripten Module object]"}}else if(sl)"undefined"!=
typeof read&&(n.read=function(b){return read(b)}),n.readBinary=function(b){if("function"===typeof readbuffer)return new Uint8Array(readbuffer(b));b=read(b,"binary");mg("object"===typeof b);return b},"undefined"!=typeof scriptArgs?n.arguments=scriptArgs:"undefined"!=typeof arguments&&(n.arguments=arguments),"function"===typeof quit&&(n.quit=function(b){quit(b)});else if(wd||vc)vc?Mb=self.location.href:document.currentScript&&(Mb=document.currentScript.src),Mb=0!==Mb.indexOf("blob:")?Mb.substr(0,Mb.lastIndexOf("/")+
1):"",n.read=function(b){var c=new XMLHttpRequest;c.open("GET",b,!1);c.send(null);return c.responseText},vc&&(n.readBinary=function(b){var c=new XMLHttpRequest;c.open("GET",b,!1);c.responseType="arraybuffer";c.send(null);return new Uint8Array(c.response)}),n.readAsync=function(b,c,d){var e=new XMLHttpRequest;e.open("GET",b,!0);e.responseType="arraybuffer";e.onload=function(){200==e.status||0==e.status&&e.response?c(e.response):d()};e.onerror=d;e.send(null)},n.setWindowTitle=function(b){document.title=
b};var wg=n.print||("undefined"!==typeof console?console.log.bind(console):"undefined"!==typeof print?print:null),Nb=n.printErr||("undefined"!==typeof printErr?printErr:"undefined"!==typeof console&&console.warn.bind(console)||wg);for(sc in pe)pe.hasOwnProperty(sc)&&(n[sc]=pe[sc]);pe=void 0;var Jl={"f64-rem":function(b,c){return b%c},"debugger":function(){debugger}},Uc=0;"object"!==typeof WebAssembly&&Nb("no native wasm support detected");var ug=!1,ji="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):
void 0;"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");var li,Tc,hb,ni,Nc=n.TOTAL_MEMORY||471859200;5242880>Nc&&Nb("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+Nc+"! (TOTAL_STACK=5242880)");if(n.buffer)var Wa=n.buffer;else{if("object"===typeof WebAssembly&&"function"===typeof WebAssembly.Memory){var ue=new WebAssembly.Memory({initial:Nc/65536});Wa=ue.buffer}else Wa=new ArrayBuffer(Nc);n.buffer=Wa}mi();hb[1358396]=10676720;var wi=[],vg=[],Ml=[],vi=[],ve=!1,wc=0,sg=null,xd=null;
n.preloadedImages={};n.preloadedAudios={};var Xb="a.out.wasm";oi(Xb)||(Xb=El(Xb));n.asm=function(b,c,d){c.memory=ue;c.table=new WebAssembly.Table({initial:153,maximum:153,element:"anyfunc"});c.__memory_base=1024;c.__table_base=0;return Il(c)};var xb=[function(b){Pd(b)},function(){p("magicworkshopmenu").style.display="block";ed()},function(b,c,d){a:{for(var e=0,f=Za.length;e<f;e++){var k=Za[e];if(k.superID==d){d=k;break a}}d=void 0}b=new Uint32Array(n.buffer,b,c);d&&d.sendDirectly("channelMessage",
"nehhof",b)},function(b,c,d,e,f,g,m){nl(b,c,d,e,f,g,m)},function(b,c,d,e,f,g){nl(b,c,d,e,f,g)},function(){rd()},function(b,c,d){Tb(b,0,c,d)},function(b){Th(b)},function(){ia("returnmenu");p("oneplayertbody").innerHTML='<tr><td></td><td id="addremove"><button id="addPlayer">+</button><button id="removePlayer">-</button></td><td></td><td></td></tr>';for(var b=0,c=v.nkingdom()-1;b<c;b++)p("oneplayertbody").innerHTML+='<tr><td class="ucolor1"></td><td class="username1"></td><td class="race1"><button></button></td><td class="team1"><button></button></td></tr>';
p("addPlayer").onclick=hn;p("removePlayer").onclick=jn},function(b,c,d,e,f){for(e="#"+e.toString(16);7>e.length;)e+="0";jl[f].style.background=e;en[f].innerHTML=Ic(Ya(b,20));b=gn[f].getElementsByTagName("button")[0];b.iteam=f+1;b.onmousedown=kl;b.innerHTML=c;c=fn[f].getElementsByTagName("button")[0];c.iteam=f+1;c.onmousedown=ll;c.innerHTML=Ra[d];d=document.createElement("input");d.type="color";d.iteam=f+1;d.value=e;jl[f].appendChild(d);d.onchange=ml},function(){wh()},function(b,c,d,e,f){b=Oa[b];b.style.backgroundPosition=
48*f+"px "+48*c+"px";d&&(b.className="");0<e&&(b.innerHTML=e)},function(b,c){b&&(ra.leftButton.className="");8*(b+1)<c&&(ra.rightButton.className="")},function(){Xd()},function(){Jk()},function(){Ik()},function(b,c){ae(b,c)},function(b,c,d){qa.value=c;qa.max=d;sb.innerHTML=c+"/"+d;qa.style.display="block";p("kingdom").innerHTML=b+" "+t.units;Ah()},function(){hd()},function(b,c,d,e){$e(b,c,d,e)},function(){zk()},function(b,c){p("pop").innerHTML=b+"/"+c},function(b,c,d,e,f,g,m,h,l,n,p){cg(b,c,d,e,f,
g,m,h,l,n,p)},function(){ke()},function(){od()},function(b,c,d){(b=A[b].attackSound)&&b.length&&na(b[~~(b.length*Math.random())],c,d)},function(b){C(b);Jf(Bh,b);Jf(Ch,b);Jf(Dh,b);Jf(Eh,b)},function(b,c,d){na(b,c,d)},function(){yc(55)},function(b,c,d,e,f,g){tl(b,c,d,e,f,g)},function(){hd()},function(b,c,d,e,f){var g="<span>";b&&(g+=b+"<img class='resource' src='/nehhon/gold.gif' /> ");c&&(g+=c+"<img class='resource' src='/nehhon/wood.gif' /> ");d&&(g+=d+"<img class='resource' src='/nehhon/food.gif' /> ");
e&&(g+=e+"<img class='resource' src='/nehhon/stone.gif' /> ");g+="</span>";f&&(g+="<span class='shotcut'>"+String.fromCharCode(f).toUpperCase()+"</span>");sh.innerHTML=g},function(b,c){Mh=[b,c]}];vg.push({func:function(){ln()}});var Pa={last:0,caught:[],infos:{},deAdjust:function(b){if(!b||Pa.infos[b])return b;for(var c in Pa.infos)for(var d=+c,e=Pa.infos[d].adjusted,f=e.length,g=0;g<f;g++)if(e[g]===b)return d;return b},addRef:function(b){b&&Pa.infos[b].refcount++},decRef:function(b){if(b){var c=
Pa.infos[b];mg(0<c.refcount);c.refcount--;0!==c.refcount||c.rethrown||(c.destructor&&n.dynCall_vi(c.destructor,b),delete Pa.infos[b],ri(b))}},clearRef:function(b){b&&(Pa.infos[b].refcount=0)}},ua={buffers:[null,[],[]],printChar:function(b,c){var d=ua.buffers[b];0===c||10===c?((1===b?wg:Nb)(ei(d,0)),d.length=0):d.push(c)},varargs:0,get:function(b){ua.varargs+=4;return hb[ua.varargs-4>>2]},getStr:function(){var b=ua.get();return b?ei(Tc,b,void 0):""},get64:function(){var b=ua.get();ua.get();return b},
getZero:function(){ua.get()}};si=hg?function(){var b=process.hrtime();return 1E3*b[0]+b[1]/1E6}:"undefined"!==typeof dateNow?dateNow:"object"===typeof self&&self.performance&&"function"===typeof self.performance.now?function(){return self.performance.now()}:"object"===typeof performance&&"function"===typeof performance.now?function(){return performance.now()}:Date.now;var ul=n.asm({},{abort:Gb,setTempRet0:function(b){Uc=b},getTempRet0:function(){return Uc},__ZSt18uncaught_exceptionv:qi,___cxa_find_matching_catch:yd,
___cxa_free_exception:ri,___gxx_personality_v0:function(){},___resumeException:function(b){Pa.last||(Pa.last=b);throw b;},___setErrNo:function(b){n.___errno_location&&(hb[n.___errno_location()>>2]=b);return b},___syscall140:function(b,c){ua.varargs=c;try{var d=ua.getStreamFromFD();ua.get();var e=ua.get(),f=ua.get(),g=ua.get();FS.llseek(d,e,g);hb[f>>2]=d.position;d.getdents&&0===e&&0===g&&(d.getdents=null);return 0}catch(m){return"undefined"!==typeof FS&&m instanceof FS.ErrnoError||Gb(m),-m.errno}},
___syscall146:function(b,c){ua.varargs=c;try{var d=ua.get(),e=ua.get(),f=ua.get();for(c=b=0;c<f;c++){for(var g=hb[e+8*c>>2],k=hb[e+(8*c+4)>>2],h=0;h<k;h++)ua.printChar(d,Tc[g+h]);b+=k}return b}catch(w){return"undefined"!==typeof FS&&w instanceof FS.ErrnoError||Gb(w),-w.errno}},___syscall54:function(b,c){ua.varargs=c;return 0},___syscall6:function(b,c){ua.varargs=c;try{var d=ua.getStreamFromFD();FS.close(d);return 0}catch(e){return"undefined"!==typeof FS&&e instanceof FS.ErrnoError||Gb(e),-e.errno}},
_emscripten_asm_const_i:function(b){return xb[b]()},_emscripten_asm_const_idd:function(b,c,d){return xb[b](c,d)},_emscripten_asm_const_ii:function(b,c){return xb[b](c)},_emscripten_asm_const_iii:function(b,c,d){return xb[b](c,d)},_emscripten_asm_const_iiii:function(b,c,d,e){return xb[b](c,d,e)},_emscripten_asm_const_iiiii:function(b,c,d,e,f){return xb[b](c,d,e,f)},_emscripten_asm_const_iiiiii:function(b,c,d,e,f,g){return xb[b](c,d,e,f,g)},_emscripten_asm_const_iiiiiii:function(b,c,d,e,f,g,m){return xb[b](c,
d,e,f,g,m)},_emscripten_asm_const_iiiiiiii:function(b,c,d,e,f,g,m,h){return xb[b](c,d,e,f,g,m,h)},_emscripten_asm_const_iiiiiiiiiiii:function(b,c,d,e,f,g,m,h,l,n,p,r){return xb[b](c,d,e,f,g,m,h,l,n,p,r)},_emscripten_get_heap_size:function(){return Nc},_emscripten_get_now:si,_emscripten_memcpy_big:function(b,c,d){Tc.set(Tc.subarray(c,c+d),b)},_emscripten_resize_heap:function(b){if(2147418112<b)return!1;for(var c=Math.max(Nc,16777216);c<b;)c=536870912>=c?rg(2*c,65536):Math.min(rg((3*c+2147483648)/4,
65536),2147418112);var d=ti(c);if(!d||d.byteLength!=c)return!1;n.buffer=Wa=d;mi();Nc=c;ni[1358396]=b;return!0},abortOnCannotGrowMemory:function(b){Gb("OOM")},emscripten_realloc_buffer:ti,flush_NO_FILESYSTEM:function(){var b=n._fflush;b&&b(0);b=ua.buffers;b[1].length&&ua.printChar(1,10);b[2].length&&ua.printChar(2,10)},tempDoublePtr:5433824,DYNAMICTOP_PTR:5433584},Wa);n.asm=ul;var ln=n.__GLOBAL__sub_I_nh_cpp=function(){return n.asm.__GLOBAL__sub_I_nh_cpp.apply(null,arguments)};n.__Z10Uint8Arrayj=function(){return n.asm.__Z10Uint8Arrayj.apply(null,
arguments)};n.__Z10canvasSizejj=function(){return n.asm.__Z10canvasSizejj.apply(null,arguments)};n.__Z10changePagei=function(){return n.asm.__Z10changePagei.apply(null,arguments)};n.__Z10changeRaceji=function(){return n.asm.__Z10changeRaceji.apply(null,arguments)};n.__Z10changeTeamji=function(){return n.asm.__Z10changeTeamji.apply(null,arguments)};n.__Z10checkStockv=function(){return n.asm.__Z10checkStockv.apply(null,arguments)};n.__Z10gInventoryj=function(){return n.asm.__Z10gInventoryj.apply(null,
arguments)};n.__Z10gmaxHealthj=function(){return n.asm.__Z10gmaxHealthj.apply(null,arguments)};n.__Z10mouseEnterj=function(){return n.asm.__Z10mouseEnterj.apply(null,arguments)};n.__Z10movtablexev=function(){return n.asm.__Z10movtablexev.apply(null,arguments)};n.__Z10nameSharedPjS_j=function(){return n.asm.__Z10nameSharedPjS_j.apply(null,arguments)};n.__Z10pidkingdomj=function(){return n.asm.__Z10pidkingdomj.apply(null,arguments)};n.__Z10searchUnitth=function(){return n.asm.__Z10searchUnitth.apply(null,
arguments)};n.__Z10setupOnlIDj=function(){return n.asm.__Z10setupOnlIDj.apply(null,arguments)};n.__Z10shiftONOFFb=function(){return n.asm.__Z10shiftONOFFb.apply(null,arguments)};n.__Z10tempstraddv=function(){return n.asm.__Z10tempstraddv.apply(null,arguments)};n.__Z10unitActionj=function(){return n.asm.__Z10unitActionj.apply(null,arguments)};n.__Z10userConfigj=function(){return n.asm.__Z10userConfigj.apply(null,arguments)};n.__Z11Uint16Arrayj=function(){return n.asm.__Z11Uint16Arrayj.apply(null,arguments)};
n.__Z11Uint32Arrayt=function(){return n.asm.__Z11Uint32Arrayt.apply(null,arguments)};n.__Z11changeColorjj=function(){return n.asm.__Z11changeColorjj.apply(null,arguments)};n.__Z11createItemsv=function(){return n.asm.__Z11createItemsv.apply(null,arguments)};n.__Z11getBufferIDv=function(){return n.asm.__Z11getBufferIDv.apply(null,arguments)};n.__Z11movtableADDjjjj=function(){return n.asm.__Z11movtableADDjjjj.apply(null,arguments)};n.__Z11setupRandomi=function(){return n.asm.__Z11setupRandomi.apply(null,
arguments)};n.__Z11synchroHashv=function(){return n.asm.__Z11synchroHashv.apply(null,arguments)};n.__Z12bufferMarginfffj=function(){return n.asm.__Z12bufferMarginfffj.apply(null,arguments)};n.__Z12deletePlayerj=function(){return n.asm.__Z12deletePlayerj.apply(null,arguments)};n.__Z12executeOrderjj=function(){return n.asm.__Z12executeOrderjj.apply(null,arguments)};n.__Z12setupIMGinfojjjjjjjjjjjjjjjjjjj=function(){return n.asm.__Z12setupIMGinfojjjjjjjjjjjjjjjjjjj.apply(null,arguments)};n.__Z12setupKingdomjjjjhbjjj=
function(){return n.asm.__Z12setupKingdomjjjjhbjjj.apply(null,arguments)};n.__Z12unitObjetivej=function(){return n.asm.__Z12unitObjetivej.apply(null,arguments)};n.__Z13configTerrainv=function(){return n.asm.__Z13configTerrainv.apply(null,arguments)};n.__Z13randomTerrainii=function(){return n.asm.__Z13randomTerrainii.apply(null,arguments)};n.__Z13readSavegame0j=function(){return n.asm.__Z13readSavegame0j.apply(null,arguments)};n.__Z13setupOnlTablej=function(){return n.asm.__Z13setupOnlTablej.apply(null,
arguments)};n.__Z13sharedDelayIDv=function(){return n.asm.__Z13sharedDelayIDv.apply(null,arguments)};n.__Z13sharedFloatIDv=function(){return n.asm.__Z13sharedFloatIDv.apply(null,arguments)};n.__Z13startMovementv=function(){return n.asm.__Z13startMovementv.apply(null,arguments)};n.__Z13tempointeraddj=function(){return n.asm.__Z13tempointeraddj.apply(null,arguments)};n.__Z14customMapTablev=function(){return n.asm.__Z14customMapTablev.apply(null,arguments)};n.__Z14finishSavegamev=function(){return n.asm.__Z14finishSavegamev.apply(null,
arguments)};n.__Z14onlineKingdomsv=function(){return n.asm.__Z14onlineKingdomsv.apply(null,arguments)};n.__Z14randomKingdomsi=function(){return n.asm.__Z14randomKingdomsi.apply(null,arguments)};n.__Z14setupResourcesjjjjt=function(){return n.asm.__Z14setupResourcesjjjjt.apply(null,arguments)};n.__Z15configRandomMapv=function(){return n.asm.__Z15configRandomMapv.apply(null,arguments)};n.__Z15getColorTexturev=function(){return n.asm.__Z15getColorTexturev.apply(null,arguments)};n.__Z15setupOnlineGamePjS_j=
function(){return n.asm.__Z15setupOnlineGamePjS_j.apply(null,arguments)};n.__Z16setupTranslationjj=function(){return n.asm.__Z16setupTranslationjj.apply(null,arguments)};n.__Z3rndi=function(){return n.asm.__Z3rndi.apply(null,arguments)};n.__Z4nAIsv=function(){return n.asm.__Z4nAIsv.apply(null,arguments)};n.__Z4testjj=function(){return n.asm.__Z4testjj.apply(null,arguments)};n.__Z5empXYv=function(){return n.asm.__Z5empXYv.apply(null,arguments)};n.__Z5gCvalj=function(){return n.asm.__Z5gCvalj.apply(null,
arguments)};n.__Z5gItemj=function(){return n.asm.__Z5gItemj.apply(null,arguments)};n.__Z5gManaj=function(){return n.asm.__Z5gManaj.apply(null,arguments)};n.__Z5gTypej=function(){return n.asm.__Z5gTypej.apply(null,arguments)};n.__Z5nhlenv=function(){return n.asm.__Z5nhlenv.apply(null,arguments)};n.__Z5test2jj=function(){return n.asm.__Z5test2jj.apply(null,arguments)};n.__Z5test3jj=function(){return n.asm.__Z5test3jj.apply(null,arguments)};n.__Z6amountv=function(){return n.asm.__Z6amountv.apply(null,
arguments)};n.__Z6dbgspdj=function(){return n.asm.__Z6dbgspdj.apply(null,arguments)};n.__Z6gBuildj=function(){return n.asm.__Z6gBuildj.apply(null,arguments)};n.__Z6gcyclev=function(){return n.asm.__Z6gcyclev.apply(null,arguments)};n.__Z6giTypej=function(){return n.asm.__Z6giTypej.apply(null,arguments)};n.__Z6glevelj=function(){return n.asm.__Z6glevelj.apply(null,arguments)};n.__Z6mapLocv=function(){return n.asm.__Z6mapLocv.apply(null,arguments)};n.__Z6mwMorei=function(){return n.asm.__Z6mwMorei.apply(null,
arguments)};n.__Z6mwiconv=function(){return n.asm.__Z6mwiconv.apply(null,arguments)};n.__Z6nhcompv=function(){return n.asm.__Z6nhcompv.apply(null,arguments)};n.__Z6onlADDjjjjb=function(){return n.asm.__Z6onlADDjjjjb.apply(null,arguments)};n.__Z6prelddv=function(){return n.asm.__Z6prelddv.apply(null,arguments)};n.__Z6rdnh19mmmmmmjj=function(){return n.asm.__Z6rdnh19mmmmmmjj.apply(null,arguments)};n.__Z6runKeyjb=function(){return n.asm.__Z6runKeyjb.apply(null,arguments)};n.__Z6sndNfov=function(){return n.asm.__Z6sndNfov.apply(null,
arguments)};n.__Z6strOnlv=function(){return n.asm.__Z6strOnlv.apply(null,arguments)};n.__Z6trraddv=function(){return n.asm.__Z6trraddv.apply(null,arguments)};n.__Z6unitXFj=function(){return n.asm.__Z6unitXFj.apply(null,arguments)};n.__Z6unitYFj=function(){return n.asm.__Z6unitYFj.apply(null,arguments)};n.__Z6updownji=function(){return n.asm.__Z6updownji.apply(null,arguments)};n.__Z7crtStxtm=function(){return n.asm.__Z7crtStxtm.apply(null,arguments)};n.__Z7delTexsv=function(){return n.asm.__Z7delTexsv.apply(null,
arguments)};n.__Z7empNamej=function(){return n.asm.__Z7empNamej.apply(null,arguments)};n.__Z7gAttackj=function(){return n.asm.__Z7gAttackj.apply(null,arguments)};n.__Z7gHelperj=function(){return n.asm.__Z7gHelperj.apply(null,arguments)};n.__Z7gIconIDj=function(){return n.asm.__Z7gIconIDj.apply(null,arguments)};n.__Z7getPagev=function(){return n.asm.__Z7getPagev.apply(null,arguments)};n.__Z7ghealthj=function(){return n.asm.__Z7ghealthj.apply(null,arguments)};n.__Z7mouseUpiij=function(){return n.asm.__Z7mouseUpiij.apply(null,
arguments)};n.__Z7nh19addj=function(){return n.asm.__Z7nh19addj.apply(null,arguments)};n.__Z7onldataj=function(){return n.asm.__Z7onldataj.apply(null,arguments)};n.__Z7plreadyv=function(){return n.asm.__Z7plreadyv.apply(null,arguments)};n.__Z7readSVGmmb=function(){return n.asm.__Z7readSVGmmb.apply(null,arguments)};n.__Z7setupGLv=function(){return n.asm.__Z7setupGLv.apply(null,arguments)};n.__Z8atlasLocv=function(){return n.asm.__Z8atlasLocv.apply(null,arguments)};n.__Z8gControlj=function(){return n.asm.__Z8gControlj.apply(null,
arguments)};n.__Z8gDefencej=function(){return n.asm.__Z8gDefencej.apply(null,arguments)};n.__Z8gKingdomj=function(){return n.asm.__Z8gKingdomj.apply(null,arguments)};n.__Z8gManaMaxj=function(){return n.asm.__Z8gManaMaxj.apply(null,arguments)};n.__Z8gstartedv=function(){return n.asm.__Z8gstartedv.apply(null,arguments)};n.__Z8liveChatj=function(){return n.asm.__Z8liveChatj.apply(null,arguments)};n.__Z8mapWidthv=function(){return n.asm.__Z8mapWidthv.apply(null,arguments)};n.__Z8mnameaddv=function(){return n.asm.__Z8mnameaddv.apply(null,
arguments)};n.__Z8mwSelectj=function(){return n.asm.__Z8mwSelectj.apply(null,arguments)};n.__Z8mwamounti=function(){return n.asm.__Z8mwamounti.apply(null,arguments)};n.__Z8nkingdomv=function(){return n.asm.__Z8nkingdomv.apply(null,arguments)};n.__Z8onlCountv=function(){return n.asm.__Z8onlCountv.apply(null,arguments)};n.__Z8savegamev=function(){return n.asm.__Z8savegamev.apply(null,arguments)};n.__Z8shapointv=function(){return n.asm.__Z8shapointv.apply(null,arguments)};n.__Z8userKickj=function(){return n.asm.__Z8userKickj.apply(null,
arguments)};n.__Z9boolArrayt=function(){return n.asm.__Z9boolArrayt.apply(null,arguments)};n.__Z9closeRoomv=function(){return n.asm.__Z9closeRoomv.apply(null,arguments)};n.__Z9createMapi=function(){return n.asm.__Z9createMapi.apply(null,arguments)};n.__Z9mouseDowniij=function(){return n.asm.__Z9mouseDowniij.apply(null,arguments)};n.__Z9mouseMoveii=function(){return n.asm.__Z9mouseMoveii.apply(null,arguments)};n.__Z9onLimits2ii=function(){return n.asm.__Z9onLimits2ii.apply(null,arguments)};n.__Z9randomMapv=
function(){return n.asm.__Z9randomMapv.apply(null,arguments)};n.__Z9selectionv=function(){return n.asm.__Z9selectionv.apply(null,arguments)};n.__Z9setupGamejjjjjjjjjjjj=function(){return n.asm.__Z9setupGamejjjjjjjjjjjj.apply(null,arguments)};n.__Z9setupInfojjjjjjjjjjcchhhhhhbbPjhbPbS_hthS_hth=function(){return n.asm.__Z9setupInfojjjjjjjjjjcchhhhhhbbPjhbPbS_hthS_hth.apply(null,arguments)};n.__Z9setupOdinj=function(){return n.asm.__Z9setupOdinj.apply(null,arguments)};n.__Z9setupZoomf=function(){return n.asm.__Z9setupZoomf.apply(null,
arguments)};n.__Z9shareNamej=function(){return n.asm.__Z9shareNamej.apply(null,arguments)};n.___errno_location=function(){return n.asm.___errno_location.apply(null,arguments)};n._emscripten_replace_memory=function(){return n.asm._emscripten_replace_memory.apply(null,arguments)};var Kl=n._free=function(){return n.asm._free.apply(null,arguments)};n._llvm_bswap_i32=function(){return n.asm._llvm_bswap_i32.apply(null,arguments)};n._main=function(){return n.asm._main.apply(null,arguments)};var Ll=n._malloc=
function(){return n.asm._malloc.apply(null,arguments)};n._memcpy=function(){return n.asm._memcpy.apply(null,arguments)};n._memset=function(){return n.asm._memset.apply(null,arguments)};n._sbrk=function(){return n.asm._sbrk.apply(null,arguments)};n.establishStackSpace=function(){return n.asm.establishStackSpace.apply(null,arguments)};var ki=n.stackAlloc=function(){return n.asm.stackAlloc.apply(null,arguments)};n.stackRestore=function(){return n.asm.stackRestore.apply(null,arguments)};n.stackSave=function(){return n.asm.stackSave.apply(null,
arguments)};n.dynCall_ii=function(){return n.asm.dynCall_ii.apply(null,arguments)};n.dynCall_iii=function(){return n.asm.dynCall_iii.apply(null,arguments)};n.dynCall_iiii=function(){return n.asm.dynCall_iiii.apply(null,arguments)};n.dynCall_iiiii=function(){return n.asm.dynCall_iiiii.apply(null,arguments)};n.dynCall_v=function(){return n.asm.dynCall_v.apply(null,arguments)};n.dynCall_vi=function(){return n.asm.dynCall_vi.apply(null,arguments)};n.dynCall_vii=function(){return n.asm.dynCall_vii.apply(null,
arguments)};n.dynCall_viii=function(){return n.asm.dynCall_viii.apply(null,arguments)};n.asm=ul;Vc.prototype=Error();Vc.prototype.constructor=Vc;xd=function c(){n.calledRun||tg();n.calledRun||(xd=c)};n.callMain=function(b){b=b||[];ve||(ve=!0,vd(vg));var c=b.length+1,e=ki(4*(c+1));hb[e>>2]=re(n.thisProgram);for(var f=1;f<c;f++)hb[(e>>2)+f]=re(b[f-1]);hb[(e>>2)+c]=0;try{var g=n._main(c,e,0);if(!n.noExitRuntime||0!==g){if(!n.noExitRuntime&&(ug=!0,n.onExit))n.onExit(g);n.quit(g,new Vc(g))}}catch(m){m instanceof
Vc||("SimulateInfiniteLoop"==m?n.noExitRuntime=!0:((b=m)&&"object"===typeof m&&m.stack&&(b=[m,m.stack]),Nb("exception thrown: "+b),n.quit(1,m)))}finally{}};n.run=tg;n.abort=Gb;if(n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);0<n.preInit.length;)n.preInit.pop()();var ui=!0;n.noInitialRun&&(ui=!1);n.noExitRuntime=!0;tg();var pg=!1,v={};te=Bb;var Mc,$f,Hk,pb,$h=function(){pg=!0;for(var b=n.asm,d=Object.keys(b),e=d.length,f="inspector71017 newUnit radar createMap falseunit synchroHash rnd setupRandom randomTerrain unitMovement test setupInfo setupKingdom shapoint Uint16Array setupTech setupRequirements boolArray AIobjetive test2 searchUnit killUnit investigateTech AIprocess setupResources unitWorking movtablexe test3 unitParameter setupGL bufferColor getBufferID setupIMGinfo atlasLoc randomMap selection gAttack gDefence glevel ghealth gmaxHealth gMana gItem gBuild gKingdom executeOrder shiftONOFF gType IMGdata Uint32Array getColorTexture canvasSize setupZoom setupTranslation mouseDown mouseUp sharedFloatID setupGame mouseMove gCval gManaMax giType setupOdin empXY nkingdom empName changePage gInventory gControl checkStock runKey sharedDelayID amount mwicon mwSelect mwMore mwamount createItems gIconID mouseEnter gHelper startMovement savegame finishSavegame readSavegame0 readSVG customMapTable mapWidth gcycle dbgspd randomKingdoms changeTeam changeRace userConfig onlineKingdoms setupOnlTable onlADD changeColor sndNfo tempointeradd onldata shareName mnameadd configRandomMap strOnl plready setupOnlID preldd nAIs closeRoom onlCount userKick pidkingdom deletePlayer updown tempstradd liveChat gstarted trradd nh19add nhcomp nhlen rdnh19 crtStxt configTerrain delTexs".split(" "),
g=0,m=f.length;g<m;g++)for(var l=f[g],p=0;p<e;p++){var r=d[p];if(-1<r.indexOf(l)){v[f[g]]=b[r];break}}b=v.shapoint();Mc=new Int32Array(n.buffer,b,1024);pb=kd(v.sharedFloatID(),5);$f=kd(v.sharedFloatID(),3);Hk=kd(v.sharedFloatID(),4);Rc(v.userConfig(parseInt(y.color.substr(1),16)),17,y.name||"Guest");h=document.getElementById("tzar").getContext("webgl2");y.gl=!!h;$h.waiting&&od();te()},Rc=function(b,d,e){b=Ya(b,d);for(var c=0;c<d;c++)b[c]=e.charCodeAt(c)},Rm=function(b){for(var c=0,e=b.length;c<e;Mc[c]=
b[c++]);};$h.waiting=!1;n.postRun[0]=$h;var ig=window.indexedDB.open("nehhon"),Oc,ai;ig.onsuccess=function(b){Oc=ig.result;ai&&ai()};ig.onupgradeneeded=function(b){Oc=ig.result;Oc.createObjectStore("maps",{keyPath:"id",autoIncrement:!0});Oc.createObjectStore("mapsBlobs",{keyPath:"id2",autoIncrement:!0})};var vl=function(){Oc?Oc.transaction(["maps"],"readwrite").objectStore("maps").getAll().onsuccess=mn:ai=vl},mn=function(b){b=b.target.result;var c=b.length;if(c){var e=p("mapcache");e.innerHTML='<tr style="font-size:23px"><td>'+
t.mapName+"</td><td>"+t.date+"</td><td>"+t.timePlayed+"</td></tr>";for(--c;-1<c;c--){var f=b[c],g=document.createElement("tr");g.cid=f.id;var m=new Date(f.date),h=m.getHours(),l="0"+m.getMinutes();m.getSeconds();var n=m.getDate(),r=m.getMonth()+1;m=m.getFullYear();h=h+":"+l.substr(-2)+" &nbsp; &nbsp;"+n+"/"+r+"/"+m;g.onclick=bi;g.innerHTML="<td>"+(f.name||"savegame")+"</td><td>"+h+"</td><td>"+Wi(f.played)+"</td>";e.appendChild(g)}C(b)}},bi=function(){var b=this.cid;Oc.transaction(["mapsBlobs"],"readwrite").objectStore("mapsBlobs").get(b).onsuccess=
bi.step2};bi.step2=function(b){b=b.target.result;var c=new FileReader;c.onload=function(b){b=new Uint8Array(b.target.result);b=$k(b,".tzared");ia("customMapcont");p("editCustom").style.display="inline-table";p("closeCustom").style.display="inline-table";ea=b;ea.kingdomStart?(p("seeStats").style.display="inline-table",p("playrecord").style.display="inline-table"):(p("seeStats").style.display="none",p("playrecord").style.display="none");null===ea.goldRes&&(ea.goldRes=Infinity);null===ea.stoneRes&&(ea.stoneRes=
Infinity);null===ea.foodRes&&(ea.foodRes=Infinity);null===ea.woodRes&&(ea.woodRes=Infinity);tl();V("maploadlabel");V("mapcache")};c.readAsArrayBuffer(b)};var Og=function(b,d,e,f){if(Rh&&!r.editor){var c=Rh.events.defined[d.id];if(c&&c[e])if(c=c[e],"zone"==e)for(b=0,f=c.length;b<f;b+=5){e=c[b];var m=c[b+2],h=c[b+3],l=c[b+4];d.x32>=c[b+1]&&d.x32<=h&&d.y32>=m&&d.y32<=l?(d.inZone||(d.inZone={}),d.inZone[e.id]||jg([c[b]],1),d.inZone[e.id]=1):d.inZone&&d.inZone[e.id]&&(d.inZone[e.id]=0,jg([c[b]],-1))}else{if(!f)return jg(c,
b);C(f.name);d=c.defined;d[f.id]&&jg(d[f.id],b)}}},jg=function(b,d){for(var c=b.length,f=0;f<c;f++){var g=b[f],m=g.rule,h=g.activeEvents;g.activeEvents+=d;0===h?m.activeEvents++:0===g.activeEvents&&m.activeEvents--;if(1==d&&m.activeEvents==m.events.length)for(g=0,m=m.actions,h=m.length;g<h;g++){var l=m[g];C("action:",l.type);if(wl[l.type])wl[l.type](l.to[0],l.list)}}},wl={attack:$b,move:Rb},Oh={start:function(){},func:function(){C(r.arje);if(void 0==r.arje){gb();p("editorRandom").checked?r.arje=555555*
Math.random()+1:r.arje=!1;r.mapx=parseInt(p("editorSize").value);r.mapy=r.mapx;r.goldRes=Infinity;r.foodRes=Infinity;r.woodRes=Infinity;r.stoneRes=Infinity;r.gravity=580.9/9.8*9.8;r.terrainType="grass";qd=[];for(var b=0,d=parseInt(p("editorPlayers").value);b<d;b++){for(var e="#"+(~~(16777216*Math.random())).toString(16);7>e.length;)e+="0";qd[b]={color:e,IA:!1,name:"Tzar "+(b+1),race:0,team:0}}document.body.removeChild(p("mapForm"))}r.editor=1;od()}},Zf=function(){var b=p("selectKingdom");b.innerHTML=
"";for(var d=1,e=J.length;d<e;d++){var f=J[d];1===d&&(b.style.background="rgba("+f.color[0]+","+f.color[1]+","+f.color[2]+",1)");b.innerHTML+='<option value="'+d+'" style="background:rgba('+f.color[0]+","+f.color[1]+","+f.color[2]+',1)">'+f.name+"</option>"}},V=function(b){p(b).style.display="none"},ia=function(b){p(b).style.display="block"},Ph=function(b){var c=ja;c.img=l.blank;var e=32*sd();c.wh=[e,e];c.active=!0;document.addEventListener("mousemove",yb);document.addEventListener("mousedown",xl);
yb.active=b},xl=function(b){if(2==b.buttons||b.pageX<y.menumx||b.pageY<y.menumy)return yl();yb(b)},ik=function(b){if(r.editor){var c=parseInt(p("brushSize").value)+b;c>p("brushSize").max?p("brushSize").value=p("brushSize").max:1>c?p("brushSize").value=1:(p("brushSize").value=c,ja.wh&&(ja.wh[0]+=32*b,ja.wh[1]+=32*b,ja.active=!0))}},sd=function(){return parseInt(p("brushSize").value)},Qh=function(b,d,e){b=sd();for(var c=b*b,g=H,m=ag,h=Qh.active,l=Fk.type,n=0;n<c;n++){var p=d+n%b,r=e+~~(n/b);fa(p,r)&&
(p+=r*g,m[p]=h,l[h]&&(2<Z[p]&&B[Z[p]].die(),2<lb[p]&&B[lb[p]].die()))}Lc()},Um=function(b,d,e){b=sd();for(var c=b*b,g=H,h=0;h<c;h++){var l=d+h%b,n=e+~~(h/b);fa(l,n)&&(0===Z[l+n*g]?.2>Math.random()&&Vg([l+n*g,7,{d:3+~~(28*Math.random())}]):(l=B[Z[l+n*g]],7==l.type&&l.die()))}},Tm=function(b,d,e){b=sd();for(var c=b*b,g=H,h=0;h<c;h++){var l=d+h%b,n=e+~~(h/b);fa(l,n)&&(l=B[Z[l+n*g]],7==l.type&&l.die())}},yb=function(b){var c=32*sd();c=bc(b.pageX-y.mx-.5*c/R,b.pageY-.5*c/R);var e=~~(.03125*c[1]);c=~~(.03125*
c[0]);ja.x=32*c;ja.y=32*e;ja.active=!0;if(0!==b.buttons){if(2==b.buttons)return yl();yb.last!==c+e*H&&yb.active&&yb.active(b,c,e);yb.last=c+e*H}},yl=function(){ja.active=!0;ja.x=-9999;ja.y=-9999;if(yb.active){var b=32*sd();bc(event.pageX-y.mx-.5*b/R,event.pageY-.5*b/R);yb.active=!1}ja.wh=void 0;document.removeEventListener("mousedown",xl);document.removeEventListener("mousemove",yb)},Zj=function(){C(this);this.parentElement.parentElement.style.display="none";gb()},ak={objAction:{id:"edobjAction",
msg:t.objAction,func:function(){oa.active.type="attack";ia("selectionEvents");V("eventZone");ia("unitListDiv2");p("byButton2").style.display="inline-block";p("byButton1").style.display="inline-block";oa.active.zone=void 0}},objZone:{id:"edobjAction",msg:t.objZone,func:function(){oa.active.type="zone";oa.active.to.length=0;V("selectionEvents");p("eventZone").style.display="inline-block";V("byButton2");V("byButton1");V("unitListDiv2");zl()}}},fd=function(b){if(b)V("mapRulesWindow"),gb(),fd.actived=
!0;else if(fd.actived){ia("mapRulesWindow");uc();b=~~((void 0)[0]/32);var c=~~((void 0)[1]/32),e=~~((void 0)[9]/32),f=~~((void 0)[10]/32);if(b<e)var g=b,h=e;else g=e,h=b;if(c<f)var l=c,n=f;else l=f,n=c;oa.active.zone||(oa.active.zone=[]);oa.active.zone.put([g,l,h,n]);C(b,c,e,f);zl();fd.actived=!1}},zl=function(){var b=p("zoneList");b.innerHTML="";var d=oa.active.zone;if(d)for(var e=d.length,f=0;f<e;f++){var g=d[f],h=document.createElement("div"),l=document.createElement("button");l.innerHTML="x";
l.obj=g;l.pObj=d;l.spObj=!0;l.onclick=ci;h.innerHTML=g[0]+"x "+g[1]+"y -> "+g[2]+"x "+g[3]+"y";h.appendChild(l);b.appendChild(h)}},Al={moving:1},Fm=function(){Al[this.value]?(V("byButton2"),V("byButton1"),V("unitListDiv2")):(ia("unitListDiv2"),p("byButton2").style.display="inline-block",p("byButton1").style.display="inline-block");oa.active.type=this.value},Gm=function(){Al[this.value]?(V("toButton2"),V("toButton1"),V("unitListDivAction2")):(ia("unitListDivAction2"),p("toButton2").style.display="inline-block",
p("toButton1").style.display="inline-block");ub.active.type=this.value},vb=function(b){if(b)V("mapRulesWindow"),gb(),vb.actived=b.button;else if(vb.actived){ia("mapRulesWindow");uc();b=vb.actived.spType.active;b="unitListDiv2"==vb.actived.id||"unitListDivAction2"==vb.actived.id?b.to:b.list;for(var c={},e=0,f=b.length;e<f;e++)c[b[e]]=1;e=0;for(f=Q.length;e<f;e++)c[Q[e]]||b.put(Q[e]);qe(vb.actived,b);vb.actived=!1}},qe=function(b,d){b.innerHTML="";for(var c=0,f=d.length;c<f;c++){var g=document.createElement("div");
g.innerHTML=B[d[c]].name;var h=document.createElement("button");h.onclick=ci;h.innerHTML="x";h.pObj=d;h.spObj=!0;h.obj=d[c];g.appendChild(h);b.appendChild(g)}},ob=function(){ob.active&&(ob.active.className="");ob.active=this;this.className="spSelect";for(var b=this.parentElement.getElementsByTagName("section"),d=0,e=b.length;d<e;d++)b[d].style.display="none";this.sdiv.style.display="block"},tb=function(){var b=this.editorRule;b.deleted||(ia("mapEvent"),ia("mapActions"),V("eventOptions"),tb.active&&
(tb.div.className=""),this.className="spSelect",tb.active=b,tb.div=this,Ff(b,"eventLayout"),Ff(b,"actionLayout"),oa.div&&V(oa.div),oa.div1=void 0)},oa=function(){var b=this.editorRule;b.deleted||(ia("eventOptions"),oa.div1&&(oa.div1.className=""),this.className="spSelect",oa.active=b,p("selectionEvents").value=b.type,oa.div1=this,p("eventOptions").value=b.name,oa.div=ak[b.name].id,ia(oa.div),qe(p("unitListDiv"),b.list),qe(p("unitListDiv2"),b.to))},ub=function(){var b=this.editorRule;b.deleted||(ia("actionOptions"),
ub.div1&&(ub.div1.className=""),this.className="spSelect",ub.active=b,p("selectionActions").value=b.type,ub.div1=this,p("actionOptions").value=b.name,ub.div="ed"+b.name,ia(ub.div),qe(p("unitListDivAction"),b.list),qe(p("unitListDivAction2"),b.to))},Ff=function(b,d){p(d).innerHTML="";if("eventLayout"==d){b=b.events;var c=oa,f=tb.active.events}else b=b.actions,c=ub,f=tb.active.actions;for(var g=0,h=b.length;g<h;g++){var l=document.createElement("div");kg(l,b[g],c,f);p(d).appendChild(l)}},Dm=function(){var b=
tb.active,d={name:"objAction",list:[],to:[],type:"attack"};b.events.put(d);var e=document.createElement("div");kg(e,d,oa,b.events);p("eventLayout").appendChild(e);if(oa.div1)oa.div1.onclick()},Em=function(){var b=tb.active,d={name:"objOrder",list:[],to:[],type:"move"};b.actions.put(d);var e=document.createElement("div");kg(e,d,ub,b.actions);p("actionLayout").appendChild(e);if(ub.div1)ub.div1.onclick()},kg=function(b,d,e,f){b.innerHTML=d.events?d.name:t[d.name];b.onclick=e;b.editorRule=d;e=document.createElement("button");
e.innerHTML="x";e.obj=d;e.pObj=f;e.onclick=ci;b.appendChild(e)},Cm=function(){r.rules||(r.rules=[]);var b={name:"Rule"+r.rules.length,events:[],actions:[]};r.rules.put(b);var d=document.createElement("div");kg(d,b,tb,r.rules);p("rulist").appendChild(d)},ci=function(){this.pObj.quit(this.obj);this.obj.deleted=!0;this.parentElement.parentElement.removeChild(this.parentElement);if(!this.spObj)if(this.pObj!==r.rules)tb.div.onclick();else V("mapEvent"),V("mapActions")},th=function(){var b=p("mapPropsWindow").getElementsByTagName("table")[0];
b.innerHTML="";b.innerHTML+="<tr><td>"+t.color+"</td><td>"+t.username+"</td><td>"+t.gold+"</td><td>"+t.wood+"</td><td>"+t.food+"</td><td>"+t.stone+"</td><td>"+t.AI+"</td><td>"+t.team+"</td></tr>";for(var d=1,e=J.length;d<e;d++){var f=J[d],g=f.color,h=f.resources;g="#"+(16777216+(g[0]<<16)+(g[1]<<8)+g[2]).toString(16).slice(1);b.innerHTML+='<tr><td><input style="background:'+g+'" type="color" value="'+g+'" /></td><td><input type="text" value="'+f.name+'"></td>\n\n<td><input type="text" class="res" value="'+
(parseInt(h[0])||"\u221e")+'"></td>\n<td><input type="text" class="res" value="'+(parseInt(h[1])||"\u221e")+'"></td>\n<td><input type="text" class="res" value="'+(parseInt(h[2])||"\u221e")+'"></td>\n<td><input type="text" class="res" value="'+(parseInt(h[3])||"\u221e")+'"></td>\n<td><label class="container">\n  <input type="checkbox">\n  <span class="checkmark"></span>\n</label></td><td><input type="number" min="0" value="'+f.team+'"></td></tr>'}b.innerHTML+="<tr><td><button id='editorAdd'>+</button><button id='editorDelete'>-</button></td></tr>";
p("editorAdd").onclick=nn;p("editorDelete").onclick=on;b=b.getElementsByTagName("input");d=0;for(e=J.length-1;d<e;d++)h=8*d,f=J[d+1],b[h].onchange=pn,b[h+1].onchange=qn,b[h+2].onchange=lg,b[h+3].onchange=lg,b[h+4].onchange=lg,b[h+5].onchange=lg,b[h+2].res=0,b[h+3].res=1,b[h+4].res=2,b[h+5].res=3,b[h+6].onchange=rn,b[h+6].checked=f.IA,b[h+7].onchange=sn,b[h].team=d+1,b[h+1].team=d+1,b[h+2].team=d+1,b[h+3].team=d+1,b[h+4].team=d+1,b[h+5].team=d+1,b[h+6].team=d+1,b[h+7].team=d+1},lg=function(){var b=
parseInt(this.value);b||(b=Infinity,this.value="\u221e");J[this.team].resources[this.res]=b},nn=function(){new Ec("Tzar "+J.length,[~~(256*Math.random()),~~(256*Math.random()),~~(256*Math.random())],[0],0,!0,[r.goldRes,r.woodRes,r.foodRes,r.stoneRes],2);Zf();th()},on=function(){if(2<J.length){for(var b=J.length-1,d=3,e=B.length;d<e;d++){var f=B[d];f.kingdom==b&&f.die()}J.length--;Zf();th()}},pn=function(){var b=J[this.team],d=parseInt(this.value.substr(1),16),e=d>>16&255,f=d>>8&255;d&=255;b.color=
[e,f,d];var g=this.team;b=sa[g];J[g].color=[e,f,d];e=0;for(f=b.length;e<f;e++){d=b[e];g=0;for(var h=d.length;g<h;g++)mb(B[d[g]])}Zf()},qn=function(){J[this.team].name=this.value},rn=function(){J[this.team].IA=this.checked?!0:!1},sn=function(){var b=J[this.team];b.team=parseInt(this.value);for(var d=J.length,e=1;e<d;e++){var f=J[e];f.team!==b.team&&(f.diplomacy[b.k]=1,b.diplomacy[f.k]=1)}},bn=function(b){if(b=p("maploadOnline").files[0]){b.name.split(".");var c=new FileReader;c.onload=function(){var b=
new Uint8Array(this.result);if(y.admin){V("optionbutton");var c=b.length;C(999999999,44444);for(var d=fb.step,h=0;h<c;h+=d)b.slice(h,h+d),C(999999999,44444);Zk(b);C(ea);al(ea.kingdoms.length);p("nplayersO").value=y.room.max;p("deleteCusMap").style.display="inline-table"}};c.readAsArrayBuffer(b)}},$k=function(b,d){if(d&&"wmp"==d)return oe(b);C(b[0]);var c=b[1]+(b[2]<<8)+(b[3]<<16)+(b[4]<<24);d=new TextDecoder("utf-8");d=JSON.parse(d.decode(b.slice(5,c+5)));if(!1===d.arje){b=b.slice(c+5,c+5+Math.pow(d.mapx,
2));var f=Math.pow(d.mapx,2);c=b.length;f=f?new Uint8Array(f):[];for(var g=0,h=0;h<c;h++){var l=b[h];if(255!==l)f[g++]=l;else{l=b[h-1];for(var n=(b[h+1]<<8)+b[h+2],p=0;p<n;p++)f[g++]=l;h+=2}}d.terrain=f}d.allunits&&(d.allunits=Vk(d.allunits));d.ini&&(d.ini=Vk(d.ini));return d},ea,tl=function(b,d,e,f,g,h){C(Ya(b,20));p("custombody").innerHTML+="<tr>\n<td style='background:rgb("+f+","+g+","+h+')\' class="ucolor1"></td>\n<td class="username1">'+Ic(Ya(b,20))+'</td>\n<td style="display:none" class="race1">'+
e+'</td>\n<td class="team1">'+d+"</td></tr>"},tn=function(b){var c={Blue:189,Red:13506841,Green:3257600,Purple:11337925,Yellow:16768512,Cyan:46517,Orange:16751649,Gray:5921370},e=b.split(["[Player"]),f=b.split("GameDuration =")[1].split("[")[0].split(" min")[0].split(" ")[1],g=[];b=[];for(var h=1,l=e.length;h<l;h++){var n=e[h].split("\n"),p={};g[h-1]=p;for(var r=0,t=n.length;r<t;r++){var v=n[r];v=v.split(" = ");if(v[1]&&r){v[1]=v[1].trim();"Color"==v[0]&&(v[1]=c[v[1]]);"Type"==x&&"Status"!==v[0]&&
b.put("N");v[1]=encodeURIComponent(v[1]);b.put(v[1]);p[v[0]]=v[1];var x=v[0]}}}c=g[0].Name+"'s Game";var y=new XMLHttpRequest;y.open("POST",baseUrl+"php/stats.php",!0);y.setRequestHeader("Content-type","application/x-www-form-urlencoded");y.onreadystatechange=function(){200===y.status&&4===y.readyState&&(location.hash="MatchX"+y.responseText)};b=b.join("<");y.send("arr="+b+"&time="+6E4*f+"&name="+c+"&players="+g.length)},un=function(b,d){for(var c="<tr style='background:#000;'><td style='    padding-right: 150px;'>Name</td><td>Type</td><td>Status</td><td>Team</td><td>Race</td><td>Score</td><td>Gold</td><td>Wood</td><td>Food</td><td>Stone</td><td title='Damage Inflicted'>D.I</td><td title='Damage Taken'>D.T</td><td title='Units Killed'>U.K</td><td title='Units Losed'>U.L</td><td title='Buildings Destroyed'>B.D</td><td title='Buildings Losed'>B.L</td><td title='Maximum Peasants'>M.P</td><td title='Maximum Towers'>M.T</td><td title='Maximum Stone Towers'>M.S.T</td><td title='Gold Traded'>G.T</td><td title='Stone Traded'>S.T</td><td title='Gold Converted'>G.C</td><td title='Stone Converted'>S.C</td></tr>",
f=2,g=b.length;f<g;f++)if((f-2)%24)0!==(f-3)%24&&(h=~~((f-2)/24)%2?"style = 'background:rgba(0,0,0,0.45)'":"style = 'background:rgba(0,0,0,0.65)'"),c+="<td "+h+">"+Aa(decodeURIComponent(b[f]))+"</td>";else{f-2&&(c+="</tr>");h=parseInt(Aa(decodeURIComponent(b[f])));var h="style = 'background:rgba("+Math.floor(h/65536)+","+Math.floor(h/256)%256+","+h%256+",0.45)'";c+="<tr>"}c+="</tr>";d?(ia("ingameStats"),""==p("ingameStats").innerHTML&&(p("ingameStats").innerHTML='<div>\n<table id="statsGame"></table>\n</div>\n<button id="backToGameS" class="stanButton">'+
t.backToGame+"</button>",p("backToGameS").onclick=function(){var b=p("ingameStats");b.style.display="none"==b.style.display?"block":"none";gb()}),p("statsGame").innerHTML="<tbody>"+c+"</tbody>",d=p("statsGame").getElementsByTagName("td")):(p("MatchX").style.display="block",p("returnmenu").style.display="block",p("statsTable").innerHTML="<tbody>"+c+"</tbody>",d=p("statsTable").getElementsByTagName("td"));b=[];f=0;for(g=d.length;f<g;f++)c=f%23,4<c&&23<f&&(b[c-5]||(b[c-5]=[]),b[c-5].put(d[f]));f=0;for(g=
b.length;f<g;f++){d=b[f];d.sort(Ol);c=d.length;if(!d[1])break;d[0].innerHTML!=d[1].innerHTML&&(d[0].style.background="rgba(127,0,0,0.45)");d[c-1].innerHTML!=d[c-2].innerHTML&&(d[c-1].style.background="rgba(0,127,0,0.45)")}};p("statsLoad").onchange=function(){var b=p("statsLoad").files[0],d=new FileReader;d.onloadend=function(b){tn(b.target.result)};b&&d.readAsText(b,"ascii")};var Gl=function(b){var c=new XMLHttpRequest;c.open("POST",baseUrl+"php/loadstat.php",!0);c.setRequestHeader("Content-type",
"application/x-www-form-urlencoded");Bl(c,function(b){un(b.responseText.split("<"))});C(b);c.send("id="+b)},Bl=function(b,d){b.onreadystatechange=function(){4===b.readyState&&(200===b.status?d(b):alert("Error: "+b.status))}},cl=function(){p("mapconfiguration").style.display="block";p("basic").style.filter="blur(94px)";if(""==p("mapconfiguration").innerHTML){for(var b="",d=["grass","trenkorian"],e=0,f=d.length;e<f;e++)b+='<option value="'+d[e]+'" '+(d[e]==localStorage.terrain?"selected":"")+">"+(t[d[e]]||
d[e])+"</option>";d="";"true"==localStorage.infinity&&(d="checked");p("mapconfiguration").innerHTML="<table>\n<tbody>\n<tr><td>"+t.mapSize+'</td><td><input id="mapwidth" type="number" value="'+localStorage.mapx+'" step="32" min="32" max="1024" /></td></tr>\n<tr><td><hr></td></tr>\n<tr><td>'+t.startingResources+"</td></tr>\n<tr><td><hr></td></tr>\n<tr><td>"+t.infinite+'</td><td><label class="container">\n  <input id="infiniteValue" type="checkbox" '+d+'>\n  <span class="checkmark"></span>\n</label></td></tr>\n<tr><td>'+
t.gold+'</td><td><input id="goldValue" type="number" value="'+localStorage.goldRes+'" step="250" /></td></tr>\n<tr><td>'+t.wood+'</td><td><input id="woodValue" type="number" value="'+localStorage.woodRes+'" step="250" /></td></tr>\n<tr><td>'+t.food+'</td><td><input id="foodValue" type="number" value="'+localStorage.foodRes+'" step="250" /></td></tr>\n<tr><td>'+t.stone+'</td><td><input id="stoneValue" type="number" value="'+localStorage.stoneRes+'" step="250" /></td></tr>\n<tr><td><hr></td></tr>\n<tr><td>'+
t.terrainOption+'</td></tr>\n<tr><td><select name="terrain" id="terrainSelect">\n'+b+"\n<tr><td>"+t.water+'</td><td><input type="number" value="'+localStorage.water+'" id="waterValue" min="0"/></td></tr>\n<tr><td>'+t.items+'</td><td><input type="number" value="'+localStorage.items+'" id="itemsValue" min="0"/></td></tr>\n<tr><td>'+t.peons+'</td><td><input type="number" value="'+localStorage.peons+'" id="peonValue" min="0"/></td></tr>\n<tr><td>'+t.gateways+'</td><td><input type="number" value="'+0*
localStorage.gateways+'" id="gatewaysValue" min="0" readonly/></td></tr>\n<tr><td>'+t.freePop+'</td><td><input type="number" value="'+localStorage.freePop+'" id="freePopValue" /></td></tr>\n</select>\n</td>\n</tr>\n<tr><td></td></tr>\n<tr><td><button id="closeButton1" class="start">'+t.close+"</button></td></tr>\n</tbody>\n</table>";p("infiniteValue").onchange=function(){var b=this.checked;p("goldValue").disabled=b;p("stoneValue").disabled=b;p("woodValue").disabled=b;p("foodValue").disabled=b};p("infiniteValue").onchange();
p("closeButton1").onclick=function(){r.online&&Sc();p("mapconfiguration").style.display="none";gb()}}};p("returnmenu1").onclick=Pb;p("returnmenu").onclick=Pb;p("refreshButton1").onclick=Ab;p("sendmsg").onclick=vh;p("start1").onclick=cl;p("start2").onclick=od;p("alertok").onclick=function(){p("alert").style.display="none";gb()};p("createGame1").onclick=Uk;var vn=function(){C(this,this.checked);localStorage[this.localProp]=this.checked},Cl=function(){var b=this.value;"color"==this.type?this.style.backgroundColor=
b:"name"==this.localProp&&(b=Aa(b));y[this.localProp]=b;localStorage[this.localProp]=b},qg={MatchHistory:function(){p("returnmenu").style.display="block";var b=new XMLHttpRequest;b.open("GET",baseUrl+"php/latest.php",!0);Bl(b,function(b){b=b.responseText.split("|");for(var c=b.length-1,d="",g=0;g<c;g+=5)d+="<tr id='statList"+Aa(decodeURIComponent(b[g]))+"'><td>"+Aa(decodeURIComponent(b[g+1]))+"</td><td>"+Aa(decodeURIComponent(b[g+2]))+"</td><td>"+Aa(decodeURIComponent(b[g+3]))+"</td><td>"+parseInt(Aa(decodeURIComponent(b[g+
4])))/6E4+" min</td></tr>";p("matchtable").innerHTML="<tbody>"+d+"</tbody>";d={};for(g=0;g<c;d={l:d.l},g+=5)d.l=Aa(decodeURIComponent(b[g])),p("statList"+d.l).onclick=function(b){return function(){location.hash="MatchX"+b.l}}(d)});b.send(null)},GameList:Ab,RandomMap:ol,Twitter:function(){p("returnmenu").style.display="block"},Account:function(){pd.returnmenu.style.display="block";""==pd.Account.innerHTML&&(pd.Account.innerHTML='<iframe id="accountIframe"></iframe>',pd.accountIframe=p("accountIframe"));
pd.accountIframe.src=baseUrl+y.langCodeUrl+"account/?iframe=1"},MapEditor:Oh.start,CustomMap:function(){""==p("CustomMap").innerHTML&&(p("CustomMap").innerHTML="<h2>"+t.strcusMap+'</h2>\n<input id="mapload" type="file" />\n<label for="mapload" id="maploadlabel">Choose a file</label>\n<table id="mapcache"></table>\n<div id="customMapcont" style="display:none">\n<table class="players" id="customaptable">\n<tbody id="custombody">\n</tbody>\n</table>\n<button style="margin-left:40px" id="startCustom" class="start startButton">'+
t.play+'</button>\n\n<button style="margin-left:40px" id="closeCustom" class="start">'+t.close+"</button>\n</div>",p("closeCustom").onclick=function(){V("customMapcont");p("maploadlabel").style.display="inline-block";p("mapcache").style.display="table"},p("startCustom").onclick=function(){V("customMapcont");p("closeCustom").onclick();od()},p("mapload").accept=".tzared",p("mapload").onchange=function(b){b=p("mapload").files[0];C(b);b.name.split(".");var c=new FileReader;c.onload=function(){var b=new Uint8Array(this.result,
4),c=(new Uint32Array(this.result,0,1))[0];C(c,b);for(var d=b.length,h=v.readSavegame0(d),l=0;l<d;l++)Tc[h+l]=b[l];v.readSVG(4*c,d,!0);ia("customMapcont");p("closeCustom").style.display="inline-table";p("custombody").innerHTML="";v.customMapTable()};c.readAsArrayBuffer(b)});ia("returnmenu");vl()},Settings:function(){var b=p("Settings");if(""==b.innerHTML){var d=document.createElement("h2");d.innerHTML=t.strSettings;b.appendChild(d);d=document.createElement("div");var e=document.createElement("span");
e.innerHTML=t.color;d.appendChild(e);var f=document.createElement("input");f.type="color";f.value=localStorage.color;f.onchange=Cl;f.localProp="color";f.style.backgroundColor=localStorage.color;d.appendChild(f);e=document.createElement("span");e.innerHTML=t.username;d.appendChild(e);f=document.createElement("input");f.type="text";f.value=Sk(localStorage.name);f.onchange=Cl;f.localProp="name";d.appendChild(f);e=document.createElement("span");e.innerHTML=t.language;d.appendChild(e);e=document.createElement("select");
e.innerHTML='<option value="en">'+t.english+'</option>\n<option value="es">'+t.spanish+'</option>\n<option value="it">'+t.italian+'</option>\n<option value="pt">'+t.portuguese+'</option>\n<option value="ru">'+t.russian+'</option>\n<option value="pl">'+t.polish+'</option>\n<option value="bg">'+t.bulgarian+'</option>\n<option value="de">'+t.german+"</option>\n";e.value=y.langstr;e.onchange=function(){localStorage.language=this.value;location.href=""};d.appendChild(e);e=document.createElement("span");
e.innerHTML=t.offlinePlay;d.appendChild(e);e=document.createElement("button");e.innerHTML=t.downloadAll;e.onclick=Qb;d.appendChild(e);e=document.createElement("span");e.innerHTML=t.fullscreen;d.appendChild(e);var g=document.createElement("label");g.className="container";e=document.createElement("span");e.className="checkmark";f=document.createElement("input");f.type="checkbox";f.checked="true"==localStorage.fullscreen?!0:!1;f.onchange=vn;f.localProp="fullscreen";g.appendChild(f);g.appendChild(e);
d.appendChild(g);b.appendChild(d)}ia("returnmenu")},About:function(){var b=p("About");""==b.innerHTML&&(b.innerHTML='<div style="text-align:center;    user-select: text;"><div class="svgnehhon" style="background-repeat: no-repeat;height:342px;background-position: center;"></div>\nFully programmed by Donov from <a href="https://nehhon.com" target="_blank">nehhon</a><p>\n<a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=ABHGGGQ4TZFA2&source=url" target="_blank"><img src="/nehhon/donate.gif" /></a><p>\nContact:</p>\n<a href=\'mailto:webmaster@nehhon.com\' target="_blank">webmaster@nehhon.com</a> <br> <a href="https://twitter.com/TzaredGame" target="_blank">@TzaredGame</a>\n<p>Graphics, sound and game concept (Tzar) by Haemimont</p>\n<hr>\n<p>Special thanks to:</p>\n<img style="max-width:422px" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgODc0LjMgMzkzLjciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDg3NC4zIDM5My43OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHN0eWxlIHR5cGU9InRleHQvY3NzIj4uc3Qwe2ZpbGw6I0ZGRkZGRjt9LnN0MXtmaWxsOiNGMzgwMjA7fS5zdDJ7ZmlsbDojRkFBRTQwO308L3N0eWxlPjxnPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik03OTAuNiwyNzEuOWMtMy40LDAtNi4xLTIuNy02LjEtNi4xYzAtMy4zLDIuNy02LjEsNi4xLTYuMWMzLjMsMCw2LjEsMi43LDYuMSw2LjFDNzk2LjcsMjY5LjEsNzkzLjksMjcxLjksNzkwLjYsMjcxLjkgTTc5MC42LDI2MC45Yy0yLjcsMC00LjksMi4yLTQuOSw0LjljMCwyLjcsMi4yLDQuOSw0LjksNC45YzIuNywwLDQuOS0yLjIsNC45LTQuOUM3OTUuNSwyNjMuMSw3OTMuMywyNjAuOSw3OTAuNiwyNjAuOSBNNzkzLjcsMjY5aC0xLjRsLTEuMi0yLjNoLTEuNnYyLjNoLTEuM3YtNi43aDMuMmMxLjQsMCwyLjMsMC45LDIuMywyLjJjMCwxLTAuNiwxLjctMS40LDJMNzkzLjcsMjY5eiBNNzkxLjMsMjY1LjVjMC41LDAsMS0wLjMsMS0xYzAtMC44LTAuNC0xLTEtMWgtMnYyTDc5MS4zLDI2NS41TDc5MS4zLDI2NS41eiIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iMTU1LjEsMjU5LjEgMTcwLjcsMjU5LjEgMTcwLjcsMzAxLjYgMTk3LjgsMzAxLjYgMTk3LjgsMzE1LjIgMTU1LjEsMzE1LjIgIi8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTIxMy45LDI4Ny4zdi0wLjJjMC0xNi4xLDEzLTI5LjIsMzAuMy0yOS4yczMwLjEsMTIuOSwzMC4xLDI5djAuMmMwLDE2LjEtMTMsMjkuMi0zMC4zLDI5LjJDMjI2LjcsMzE2LjMsMjEzLjksMzAzLjQsMjEzLjksMjg3LjMgTTI1OC41LDI4Ny4zdi0wLjJjMC04LjEtNS44LTE1LjEtMTQuNC0xNS4xYy04LjUsMC0xNC4yLDYuOS0xNC4yLDE1djAuMmMwLDguMSw1LjgsMTUuMSwxNC4zLDE1LjFDMjUyLjgsMzAyLjMsMjU4LjUsMjk1LjQsMjU4LjUsMjg3LjMiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjkzLjQsMjkwLjZ2LTMxLjVoMTUuOHYzMS4yYzAsOC4xLDQuMSwxMS45LDEwLjMsMTEuOXMxMC4zLTMuNywxMC4zLTExLjV2LTMxLjZoMTUuOHYzMS4xYzAsMTguMS0xMC4zLDI2LTI2LjMsMjZDMzAzLjQsMzE2LjIsMjkzLjQsMzA4LjIsMjkzLjQsMjkwLjYiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzY5LjQsMjU5LjFIMzkxYzIwLDAsMzEuNywxMS41LDMxLjcsMjcuN3YwLjJjMCwxNi4yLTExLjgsMjguMi0zMiwyOC4yaC0yMS4zTDM2OS40LDI1OS4xTDM2OS40LDI1OS4xeiBNMzkxLjMsMzAxLjRjOS4zLDAsMTUuNS01LjEsMTUuNS0xNC4ydi0wLjJjMC05LTYuMi0xNC4yLTE1LjUtMTQuMkgzODV2MjguNUgzOTEuM3oiLz48cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjQ0NS4zLDI1OS4xIDQ5MC4yLDI1OS4xIDQ5MC4yLDI3Mi43IDQ2MC44LDI3Mi43IDQ2MC44LDI4Mi4zIDQ4Ny40LDI4Mi4zIDQ4Ny40LDI5NS4yIDQ2MC44LDI5NS4yIDQ2MC44LDMxNS4yIDQ0NS4zLDMxNS4yICIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNTExLjgsMjU5LjEgNTI3LjMsMjU5LjEgNTI3LjMsMzAxLjYgNTU0LjUsMzAxLjYgNTU0LjUsMzE1LjIgNTExLjgsMzE1LjIgIi8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTU5NS4xLDI1OC43aDE1bDIzLjksNTYuNWgtMTYuN2wtNC4xLTEwaC0yMS42bC00LDEwaC0xNi4zTDU5NS4xLDI1OC43eiBNNjA4LjgsMjkzLjFsLTYuMi0xNS45bC02LjMsMTUuOUg2MDguOHoiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNNjU0LDI1OS4xaDI2LjVjOC42LDAsMTQuNSwyLjIsMTguMyw2LjFjMy4zLDMuMiw1LDcuNSw1LDEzLjF2MC4yYzAsOC42LTQuNiwxNC4zLTExLjUsMTcuMmwxMy40LDE5LjZoLTE4bC0xMS4zLTE3aC02Ljh2MTdINjU0TDY1NCwyNTkuMUw2NTQsMjU5LjF6IE02NzkuOCwyODZjNS4zLDAsOC4zLTIuNiw4LjMtNi42di0wLjJjMC00LjQtMy4yLTYuNi04LjQtNi42aC0xMC4yVjI4Nkw2NzkuOCwyODZMNjc5LjgsMjg2eiIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNzI2LjIsMjU5LjEgNzcxLjMsMjU5LjEgNzcxLjMsMjcyLjMgNzQxLjYsMjcyLjMgNzQxLjYsMjgwLjggNzY4LjUsMjgwLjggNzY4LjUsMjkzLjEgNzQxLjYsMjkzLjEgNzQxLjYsMzAyIDc3MS43LDMwMiA3NzEuNywzMTUuMiA3MjYuMiwzMTUuMiAiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTIxLjEsMjkzLjljLTIuMiw0LjktNi44LDguNC0xMi44LDguNGMtOC41LDAtMTQuMy03LjEtMTQuMy0xNS4xVjI4N2MwLTguMSw1LjctMTUsMTQuMi0xNWM2LjQsMCwxMS4zLDMuOSwxMy4zLDkuM2gxNi40Yy0yLjYtMTMuNC0xNC40LTIzLjMtMjkuNi0yMy4zYy0xNy4zLDAtMzAuMywxMy4xLTMwLjMsMjkuMnYwLjJjMCwxNi4xLDEyLjgsMjksMzAuMSwyOWMxNC44LDAsMjYuNC05LjYsMjkuNC0yMi40TDEyMS4xLDI5My45TDEyMS4xLDI5My45eiIvPjxnPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNzUyLjksMTY5LjYgNzEwLDE0NSA3MDIuNiwxNDEuOCA1MjcuMSwxNDMgNTI3LjEsMjMyLjEgNzUyLjksMjMyLjEgIi8+PHBhdGggY2xhc3M9InN0MSIgZD0iTTY3NC44LDIyMy45YzIuMS03LjIsMS4zLTEzLjgtMi4yLTE4LjdjLTMuMi00LjUtOC42LTcuMS0xNS4xLTcuNGwtMTIzLjEtMS42Yy0wLjgsMC0xLjUtMC40LTEuOS0xYy0wLjQtMC42LTAuNS0xLjQtMC4zLTIuMmMwLjQtMS4yLDEuNi0yLjEsMi45LTIuMmwxMjQuMi0xLjZjMTQuNy0wLjcsMzAuNy0xMi42LDM2LjMtMjcuMmw3LjEtMTguNWMwLjMtMC44LDAuNC0xLjYsMC4yLTIuNGMtOC0zNi4yLTQwLjMtNjMuMi03OC45LTYzLjJjLTM1LjYsMC02NS44LDIzLTc2LjYsNTQuOWMtNy01LjItMTUuOS04LTI1LjUtNy4xYy0xNy4xLDEuNy0zMC44LDE1LjQtMzIuNSwzMi41Yy0wLjQsNC40LTAuMSw4LjcsMC45LDEyLjdjLTI3LjksMC44LTUwLjIsMjMuNi01MC4yLDUxLjdjMCwyLjUsMC4yLDUsMC41LDcuNWMwLjIsMS4yLDEuMiwyLjEsMi40LDIuMWwyMjcuMiwwYzEuMywwLDIuNS0wLjksMi45LTIuMkw2NzQuOCwyMjMuOXoiLz48cGF0aCBjbGFzcz0ic3QyIiBkPSJNNzE0LDE0NC44Yy0xLjEsMC0yLjMsMC0zLjQsMC4xYy0wLjgsMC0xLjUsMC42LTEuOCwxLjRsLTQuOCwxNi43Yy0yLjEsNy4yLTEuMywxMy44LDIuMiwxOC43YzMuMiw0LjUsOC42LDcuMSwxNS4xLDcuNGwyNi4yLDEuNmMwLjgsMCwxLjUsMC40LDEuOSwxYzAuNCwwLjYsMC41LDEuNSwwLjMsMi4yYy0wLjQsMS4yLTEuNiwyLjEtMi45LDIuMmwtMjcuMywxLjZjLTE0LjgsMC43LTMwLjcsMTIuNi0zNi4zLDI3LjJsLTIsNS4xYy0wLjQsMSwwLjMsMiwxLjQsMmg5My44YzEuMSwwLDIuMS0wLjcsMi40LTEuOGMxLjYtNS44LDIuNS0xMS45LDIuNS0xOC4yQzc4MS4zLDE3NSw3NTEuMSwxNDQuOCw3MTQsMTQ0LjgiLz48L2c+PC9nPjwvc3ZnPg==" alt="cloudflare">\n</div>');
ia("returnmenu")}};p("about").onclick=function(){location.hash="About"};p("discord").onclick=function(){window.open("https://discord.gg/ndxJHxT","_blank")};di();var ac=[Bb,mf,Dc,Bc,Td,af,wf,qf,ef,cf,lf,yf,sf,Cj,Af,gf,jf,uf,Wd,Vi,Qc,Ri,Ng,Ji,Oi,Aj,Xe,Gj,Ij,ad,mh,Jj,Kj,Lj,Mj,Xe,Kk,wj,Nj,Jd,xj,Oe,tj,uj,ch,We,Qd,Wb,bh,Cc,Bc,Ve,Dc,Ib,Yc,$c,W,function(b,d){d=F[d];var c=d.nu.id;J[b.kingdom].technology.hidden[d.id.id]=0;Eb(b,d,c);tk.actv[d.id.id]&&X(!1)},Qe,Re,Ja,kj,Ua,$g,ah,Gd,Fh,ck,Fj,ih,rf,Bj,yj,function(b,
d){}];(function(){for(var b=0,d=ac.length;b<d;b++)ac[b].url=b})();Vi.rule="moving";We.rule="attack"})();
