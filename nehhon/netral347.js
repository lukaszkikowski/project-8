var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(d){var a=0;return function(){return a<d.length?{done:!1,value:d[a++]}:{done:!0}}};$jscomp.arrayIterator=function(d){return{next:$jscomp.arrayIteratorImpl(d)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,a,c){d!=Array.prototype&&d!=Object.prototype&&(d[a]=c.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(d,a){this.$jscomp$symbol$id_=d;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:a})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function d(c){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+a++,c)}var a=0;return d}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.asyncIterator;d||(d=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};
$jscomp.iteratorFromArray=function(d,a){$jscomp.initSymbolIterator();d instanceof String&&(d+="");var c=0,b={next:function(){if(c<d.length){var e=c++;return{value:a(e,d[e]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};
$jscomp.polyfill=function(d,a,c,b){if(a){c=$jscomp.global;d=d.split(".");for(b=0;b<d.length-1;b++){var e=d[b];e in c||(c[e]={});c=c[e]}d=d[d.length-1];b=c[d];a=a(b);a!=b&&null!=a&&$jscomp.defineProperty(c,d,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.keys",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d){return d})}},"es6","es3");$jscomp.polyfill("Object.getOwnPropertySymbols",function(d){return d?d:function(){return[]}},"es6","es5");
$jscomp.findInternal=function(d,a,c){d instanceof String&&(d=String(d));for(var b=d.length,e=0;e<b;e++){var f=d[e];if(a.call(c,f,e,d))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,c){return $jscomp.findInternal(this,d,c).v}},"es6","es3");$jscomp.polyfill("Math.sign",function(d){return d?d:function(d){d=Number(d);return 0===d||isNaN(d)?d:0<d?1:-1}},"es6","es3");
$jscomp.owns=function(d,a){return Object.prototype.hasOwnProperty.call(d,a)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(d,a){for(var c=1;c<arguments.length;c++){var b=arguments[c];if(b)for(var e in b)$jscomp.owns(b,e)&&(d[e]=b[e])}return d};$jscomp.polyfill("Object.assign",function(d){return d||$jscomp.assign},"es6","es3");$jscomp.makeIterator=function(d){var a="undefined"!=typeof Symbol&&Symbol.iterator&&d[Symbol.iterator];return a?a.call(d):$jscomp.arrayIterator(d)};
$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(d){function a(){this.batch_=null}function c(d){return d instanceof e?d:new e(function(a,b){a(d)})}if(d&&!$jscomp.FORCE_POLYFILL_PROMISE)return d;a.prototype.asyncExecute=function(d){if(null==this.batch_){this.batch_=[];var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})}this.batch_.push(d)};var b=$jscomp.global.setTimeout;a.prototype.asyncExecuteFunction=function(d){b(d,0)};a.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var d=
this.batch_;this.batch_=[];for(var a=0;a<d.length;++a){var b=d[a];d[a]=null;try{b()}catch(n){this.asyncThrow_(n)}}}this.batch_=null};a.prototype.asyncThrow_=function(d){this.asyncExecuteFunction(function(){throw d;})};var e=function(d){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{d(a.resolve,a.reject)}catch(k){a.reject(k)}};e.prototype.createResolveAndReject_=function(){function d(d){return function(c){b||(b=!0,d.call(a,c))}}var a=this,b=!1;
return{resolve:d(this.resolveTo_),reject:d(this.reject_)}};e.prototype.resolveTo_=function(d){if(d===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(d instanceof e)this.settleSameAsPromise_(d);else{a:switch(typeof d){case "object":var a=null!=d;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(d):this.fulfill_(d)}};e.prototype.resolveToNonPromiseObj_=function(d){var a=void 0;try{a=d.then}catch(k){this.reject_(k);return}"function"==typeof a?
this.settleSameAsThenable_(a,d):this.fulfill_(d)};e.prototype.reject_=function(d){this.settle_(2,d)};e.prototype.fulfill_=function(d){this.settle_(1,d)};e.prototype.settle_=function(d,a){if(0!=this.state_)throw Error("Cannot settle("+d+", "+a+"): Promise already settled in state"+this.state_);this.state_=d;this.result_=a;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var d=0;d<this.onSettledCallbacks_.length;++d)f.asyncExecute(this.onSettledCallbacks_[d]);
this.onSettledCallbacks_=null}};var f=new a;e.prototype.settleSameAsPromise_=function(d){var a=this.createResolveAndReject_();d.callWhenSettled_(a.resolve,a.reject)};e.prototype.settleSameAsThenable_=function(d,a){var b=this.createResolveAndReject_();try{d.call(a,b.resolve,b.reject)}catch(n){b.reject(n)}};e.prototype.then=function(d,a){function b(d,a){return"function"==typeof d?function(a){try{c(d(a))}catch(x){f(x)}}:a}var c,f,g=new e(function(d,a){c=d;f=a});this.callWhenSettled_(b(d,c),b(a,f));return g};
e.prototype.catch=function(d){return this.then(void 0,d)};e.prototype.callWhenSettled_=function(d,a){function b(){switch(c.state_){case 1:d(c.result_);break;case 2:a(c.result_);break;default:throw Error("Unexpected state: "+c.state_);}}var c=this;null==this.onSettledCallbacks_?f.asyncExecute(b):this.onSettledCallbacks_.push(b)};e.resolve=c;e.reject=function(d){return new e(function(a,b){b(d)})};e.race=function(d){return new e(function(a,b){for(var e=$jscomp.makeIterator(d),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(a,
b)})};e.all=function(d){var a=$jscomp.makeIterator(d),b=a.next();return b.done?c([]):new e(function(d,e){function f(a){return function(b){g[a]=b;k--;0==k&&d(g)}}var g=[],k=0;do g.push(void 0),k++,c(b.value).callWhenSettled_(f(g.length-1),e),b=a.next();while(!b.done)})};return e},"es6","es3");
var SimpleWebRTC,setupP2PEngine=function(){(function(d){"object"===typeof exports&&"undefined"!==typeof module?module.exports=d():"function"===typeof define&&define.amd?define([],d):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).SimpleWebRTC=d()})(function(){return function e(a,c,b){function f(k,l){if(!c[k]){if(!a[k]){var m="function"==typeof require&&require;if(!l&&m)return m(k,!0);if(g)return g(k,!0);l=Error("Cannot find module '"+k+"'");
throw l.code="MODULE_NOT_FOUND",l;}l=c[k]={exports:{}};a[k][0].call(l.exports,function(b){var c=a[k][1][b];return f(c?c:b)},l,l.exports,e,a,c,b)}return c[k].exports}for(var g="function"==typeof require&&require,l=0;l<b.length;l++)f(b[l]);return f}({1:[function(a,c,b){function e(){}c.exports=function(a,b,c){function f(a,e){if(0>=f.count)throw Error("after called too many times");--f.count;a?(g=!0,b(a),b=c):0!==f.count||g||b(null,e)}var g=!1;c=c||e;f.count=a;return 0===a?b():f}},{}],2:[function(a,c,
b){c.exports=function(a,b,c){var e=a.byteLength;b=b||0;c=c||e;if(a.slice)return a.slice(b,c);0>b&&(b+=e);0>c&&(c+=e);c>e&&(c=e);if(b>=e||b>=c||0===e)return new ArrayBuffer(0);a=new Uint8Array(a);e=new Uint8Array(c-b);for(var f=0;b<c;b++,f++)e[f]=a[b];return e.buffer}},{}],3:[function(a,c,b){c.exports=function(a,b,c){var e,f=b;b={autoplay:!0,mirror:!1,muted:!1,audio:!1,disableContextMenu:!1};if(c)for(e in c)b[e]=c[e];f?"audio"===f.tagName.toLowerCase()&&(b.audio=!0):f=document.createElement(b.audio?
"audio":"video");b.disableContextMenu&&(f.oncontextmenu=function(a){a.preventDefault()});b.autoplay&&(f.autoplay="autoplay");b.muted&&(f.muted=!0);!b.audio&&b.mirror&&["","moz","webkit","o","ms"].forEach(function(a){f.style[a?a+"Transform":"transform"]="scaleX(-1)"});f.srcObject=a;return f}},{}],4:[function(a,c,b){function e(a){a=a||{};this.ms=a.min||100;this.max=a.max||1E4;this.factor=a.factor||2;this.jitter=0<a.jitter&&1>=a.jitter?a.jitter:0;this.attempts=0}c.exports=e;e.prototype.duration=function(){var a=
this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),c=Math.floor(b*this.jitter*a);a=0==(Math.floor(10*b)&1)?a-c:a+c}return Math.min(a,this.max)|0};e.prototype.reset=function(){this.attempts=0};e.prototype.setMin=function(a){this.ms=a};e.prototype.setMax=function(a){this.max=a};e.prototype.setJitter=function(a){this.jitter=a}},{}],5:[function(a,c,b){(function(a){b.encode=function(b){b=new Uint8Array(b);var c,e=b.length,f="";for(c=0;c<e;c+=3)f+=a[b[c]>>2],f+=a[(b[c]&3)<<
4|b[c+1]>>4],f+=a[(b[c+1]&15)<<2|b[c+2]>>6],f+=a[b[c+2]&63];2===e%3?f=f.substring(0,f.length-1)+"=":1===e%3&&(f=f.substring(0,f.length-2)+"==");return f};b.decode=function(b){var c=.75*b.length,e=b.length,f=0;"="===b[b.length-1]&&(c--,"="===b[b.length-2]&&c--);var n=new ArrayBuffer(c),m=new Uint8Array(n);for(c=0;c<e;c+=4){var r=a.indexOf(b[c]);var p=a.indexOf(b[c+1]);var q=a.indexOf(b[c+2]);var t=a.indexOf(b[c+3]);m[f++]=r<<2|p>>4;m[f++]=(p&15)<<4|q>>2;m[f++]=(q&3)<<6|t&63}return n}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},
{}],6:[function(a,c,b){(function(a){function b(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.buffer instanceof ArrayBuffer){var e=c.buffer;if(c.byteLength!==e.byteLength){var f=new Uint8Array(c.byteLength);f.set(new Uint8Array(e,c.byteOffset,c.byteLength));e=f.buffer}a[b]=e}}}function e(a,c){c=c||{};var e=new k;b(a);for(var f=0;f<a.length;f++)e.append(a[f]);return c.type?e.getBlob(c.type):e.getBlob()}function l(a,c){b(a);return new Blob(a,c||{})}var k=a.BlobBuilder||a.WebKitBlobBuilder||a.MSBlobBuilder||
a.MozBlobBuilder;try{var n=2===(new Blob(["hi"])).size}catch(p){n=!1}var m;if(m=n)try{m=2===(new Blob([new Uint8Array([1,2])])).size}catch(p){m=!1}var r=k&&k.prototype.append&&k.prototype.getBlob;a=n?m?a.Blob:l:r?e:void 0;c.exports=a}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],7:[function(a,c,b){var e=[].slice;c.exports=function(a,b){"string"==typeof b&&(b=a[b]);if("function"!=typeof b)throw Error("bind() requires a function");
var c=e.call(arguments,2);return function(){return b.apply(a,c.concat(e.call(arguments)))}}},{}],8:[function(a,c,b){function e(a){if(a){for(var b in e.prototype)a[b]=e.prototype[b];return a}}c.exports=e;e.prototype.on=e.prototype.addEventListener=function(a,b){this._callbacks=this._callbacks||{};(this._callbacks[a]=this._callbacks[a]||[]).push(b);return this};e.prototype.once=function(a,b){function c(){e.off(a,c);b.apply(this,arguments)}var e=this;this._callbacks=this._callbacks||{};c.fn=b;this.on(a,
c);return this};e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(a,b){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var e,f=0;f<c.length;f++)if(e=c[f],e===b||e.fn===b){c.splice(f,1);break}return this};e.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,
1),c=this._callbacks[a];if(c){c=c.slice(0);for(var e=0,f=c.length;e<f;++e)c[e].apply(this,b)}return this};e.prototype.listeners=function(a){this._callbacks=this._callbacks||{};return this._callbacks[a]||[]};e.prototype.hasListeners=function(a){return!!this.listeners(a).length}},{}],9:[function(a,c,b){c.exports=function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a}},{}],10:[function(a,c,b){function e(a){return e.enabled(a)?function(b){b instanceof Error&&
(b=b.stack||b.message);var c=new Date,f=c-(e[a]||c);e[a]=c;b=a+" "+b+" +"+e.humanize(f);window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}c.exports=e;e.names=[];e.skips=[];e.enable=function(a){try{localStorage.debug=a}catch(n){}for(var b=(a||"").split(/[\s,]+/),c=b.length,f=0;f<c;f++)a=b[f].replace("*",".*?"),"-"===a[0]?e.skips.push(new RegExp("^"+a.substr(1)+"$")):e.names.push(new RegExp("^"+a+"$"))};e.disable=function(){e.enable("")};e.humanize=
function(a){return 36E5<=a?(a/36E5).toFixed(1)+"h":6E4<=a?(a/6E4).toFixed(1)+"m":1E3<=a?(a/1E3|0)+"s":a+"ms"};e.enabled=function(a){for(var b=0,c=e.skips.length;b<c;b++)if(e.skips[b].test(a))return!1;b=0;for(c=e.names.length;b<c;b++)if(e.names[b].test(a))return!0;return!1};try{window.localStorage&&e.enable(localStorage.debug)}catch(f){}},{}],11:[function(a,c,b){c.exports=a("./lib/")},{"./lib/":12}],12:[function(a,c,b){c.exports=a("./socket");c.exports.parser=a("engine.io-parser")},{"./socket":13,
"engine.io-parser":24}],13:[function(a,c,b){(function(b){function e(a,c){if(!(this instanceof e))return new e(a,c);c=c||{};a&&"object"==typeof a&&(c=a,a=null);a&&(a=r(a),c.host=a.host,c.secure="https"==a.protocol||"wss"==a.protocol,c.port=a.port,a.query&&(c.query=a.query));this.secure=null!=c.secure?c.secure:b.location&&"https:"==location.protocol;c.host&&(a=c.host.split(":"),c.hostname=a.shift(),a.length?c.port=a.pop():c.port||(c.port=this.secure?"443":"80"));this.agent=c.agent||!1;this.hostname=
c.hostname||(b.location?location.hostname:"localhost");this.port=c.port||(b.location&&location.port?location.port:this.secure?443:80);this.query=c.query||{};"string"==typeof this.query&&(this.query=q.decode(this.query));this.upgrade=!1!==c.upgrade;this.path=(c.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!c.forceJSONP;this.jsonp=!1!==c.jsonp;this.forceBase64=!!c.forceBase64;this.enablesXDR=!!c.enablesXDR;this.timestampParam=c.timestampParam||"t";this.timestampRequests=c.timestampRequests;
this.transports=c.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.callbackBuffer=[];this.policyPort=c.policyPort||843;this.rememberUpgrade=c.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=c.onlyBinaryUpgrades;this.pfx=c.pfx||null;this.key=c.key||null;this.passphrase=c.passphrase||null;this.cert=c.cert||null;this.ca=c.ca||null;this.ciphers=c.ciphers||null;this.rejectUnauthorized=c.rejectUnauthorized||null;this.open()}var g=a("./transports"),l=a("component-emitter"),
k=a("debug")("engine.io-client:socket"),n=a("indexof"),m=a("engine.io-parser"),r=a("parseuri"),p=a("parsejson"),q=a("parseqs");c.exports=e;e.priorWebsocketSuccess=!1;l(e.prototype);e.protocol=m.protocol;e.Socket=e;e.Transport=a("./transport");e.transports=a("./transports");e.parser=a("engine.io-parser");e.prototype.createTransport=function(a){k('creating transport "%s"',a);var b=this.query,c={},e;for(e in b)b.hasOwnProperty(e)&&(c[e]=b[e]);c.EIO=m.protocol;c.transport=a;this.id&&(c.sid=this.id);return new g[a]({agent:this.agent,
hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:c,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})};e.prototype.open=function(){if(this.rememberUpgrade&&e.priorWebsocketSuccess&&
-1!=this.transports.indexOf("websocket"))var a="websocket";else{if(0==this.transports.length){var b=this;setTimeout(function(){b.emit("error","No transports available")},0);return}a=this.transports[0]}this.readyState="opening";try{a=this.createTransport(a)}catch(v){this.transports.shift();this.open();return}a.open();this.setTransport(a)};e.prototype.setTransport=function(a){k("setting transport %s",a.name);var b=this;this.transport&&(k("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());
this.transport=a;a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})};e.prototype.probe=function(a){function b(){if(t.onlyBinaryUpgrades){var b=!this.supportsBinary&&t.transport.supportsBinary;r=r||b}r||(k('probe transport "%s" opened',a),n.send([{type:"ping",data:"probe"}]),n.once("packet",function(b){r||("pong"==b.type&&"probe"==b.data?(k('probe transport "%s" pong',a),t.upgrading=
!0,t.emit("upgrading",n),n&&(e.priorWebsocketSuccess="websocket"==n.name,k('pausing current transport "%s"',t.transport.name),t.transport.pause(function(){r||"closed"==t.readyState||(k("changing transport and sending upgrade packet"),l(),t.setTransport(n),n.send([{type:"upgrade"}]),t.emit("upgrade",n),n=null,t.upgrading=!1,t.flush())}))):(k('probe transport "%s" failed',a),b=Error("probe error"),b.transport=n.name,t.emit("upgradeError",b)))}))}function c(){r||(r=!0,l(),n.close(),n=null)}function f(b){var e=
Error("probe error: "+b);e.transport=n.name;c();k('probe transport "%s" failed because of error: %s',a,b);t.emit("upgradeError",e)}function g(){f("transport closed")}function m(){f("socket closed")}function q(a){n&&a.name!=n.name&&(k('"%s" works - aborting "%s"',a.name,n.name),c())}function l(){n.removeListener("open",b);n.removeListener("error",f);n.removeListener("close",g);t.removeListener("close",m);t.removeListener("upgrading",q)}k('probing transport "%s"',a);var n=this.createTransport(a,{probe:1}),
r=!1,t=this;e.priorWebsocketSuccess=!1;n.once("open",b);n.once("error",f);n.once("close",g);this.once("close",m);this.once("upgrading",q);n.open()};e.prototype.onOpen=function(){k("socket open");this.readyState="open";e.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){k("starting upgrade probes");for(var a=0,b=this.upgrades.length;a<b;a++)this.probe(this.upgrades[a])}};e.prototype.onPacket=function(a){if("opening"==
this.readyState||"open"==this.readyState)switch(k('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),a.type){case "open":this.onHandshake(p(a.data));break;case "pong":this.setPing();break;case "error":var b=Error("server error");b.code=a.data;this.emit("error",b);break;case "message":this.emit("data",a.data),this.emit("message",a.data)}else k('packet received with socket readyState "%s"',this.readyState)};e.prototype.onHandshake=function(a){this.emit("handshake",
a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=this.filterUpgrades(a.upgrades);this.pingInterval=a.pingInterval;this.pingTimeout=a.pingTimeout;this.onOpen();"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};e.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);var b=this;b.pingTimeoutTimer=setTimeout(function(){if("closed"!=b.readyState)b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)};
e.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer);a.pingIntervalTimer=setTimeout(function(){k("writing ping packet - expecting pong within %sms",a.pingTimeout);a.ping();a.onHeartbeat(a.pingTimeout)},a.pingInterval)};e.prototype.ping=function(){this.sendPacket("ping")};e.prototype.onDrain=function(){for(var a=0;a<this.prevBufferLen;a++)if(this.callbackBuffer[a])this.callbackBuffer[a]();this.writeBuffer.splice(0,this.prevBufferLen);this.callbackBuffer.splice(0,this.prevBufferLen);
this.prevBufferLen=0;0==this.writeBuffer.length?this.emit("drain"):this.flush()};e.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(k("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};e.prototype.write=e.prototype.send=function(a,b){this.sendPacket("message",a,b);return this};e.prototype.sendPacket=function(a,b,c){"closing"!=
this.readyState&&"closed"!=this.readyState&&(a={type:a,data:b},this.emit("packetCreate",a),this.writeBuffer.push(a),this.callbackBuffer.push(c),this.flush())};e.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){var a=function(){e.once("upgrade",b);e.once("upgradeError",b)},b=function(){e.removeListener("upgrade",b);e.removeListener("upgradeError",b);c()},c=function(){e.onClose("forced close");k("socket closing - telling transport to close");e.transport.close()};this.readyState=
"closing";var e=this;if(this.writeBuffer.length)this.once("drain",function(){this.upgrading?a():c()});else this.upgrading?a():c()}return this};e.prototype.onError=function(a){k("socket error %j",a);e.priorWebsocketSuccess=!1;this.emit("error",a);this.onClose("transport error",a)};e.prototype.onClose=function(a,b){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){k('socket close with reason: "%s"',a);var c=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);
setTimeout(function(){c.writeBuffer=[];c.callbackBuffer=[];c.prevBufferLen=0},0);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",a,b)}};e.prototype.filterUpgrades=function(a){for(var b=[],c=0,e=a.length;c<e;c++)~n(this.transports,a[c])&&b.push(a[c]);return b}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./transport":14,
"./transports":15,"component-emitter":8,debug:21,"engine.io-parser":24,indexof:32,parsejson:40,parseqs:41,parseuri:23}],14:[function(a,c,b){function e(a){this.path=a.path;this.hostname=a.hostname;this.port=a.port;this.secure=a.secure;this.query=a.query;this.timestampParam=a.timestampParam;this.timestampRequests=a.timestampRequests;this.readyState="";this.agent=a.agent||!1;this.socket=a.socket;this.enablesXDR=a.enablesXDR;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;
this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized}var f=a("engine.io-parser");a=a("component-emitter");c.exports=e;a(e.prototype);e.timestamps=0;e.prototype.onError=function(a,b){a=Error(a);a.type="TransportError";a.description=b;this.emit("error",a);return this};e.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this};e.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),
this.onClose();return this};e.prototype.send=function(a){if("open"==this.readyState)this.write(a);else throw Error("Transport not open");};e.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};e.prototype.onData=function(a){a=f.decodePacket(a,this.socket.binaryType);this.onPacket(a)};e.prototype.onPacket=function(a){this.emit("packet",a)};e.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":8,"engine.io-parser":24}],15:[function(a,
c,b){(function(c){var e=a("xmlhttprequest"),g=a("./polling-xhr"),l=a("./polling-jsonp"),k=a("./websocket");b.polling=function(a){var b=!1,f=!1,k=!1!==a.jsonp;c.location&&(f="https:"==location.protocol,(b=location.port)||(b=f?443:80),b=a.hostname!=location.hostname||b!=a.port,f=a.secure!=f);a.xdomain=b;a.xscheme=f;if("open"in new e(a)&&!a.forceJSONP)return new g(a);if(!k)throw Error("JSONP disabled");return new l(a)};b.websocket=k}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?
self:"undefined"!==typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(a,c,b){(function(b){function e(){}function g(a){l.call(this,a);this.query=this.query||{};r||(b.___eio||(b.___eio=[]),r=b.___eio);this.index=r.length;var c=this;r.push(function(a){c.onData(a)});this.query.j=this.index;b.document&&b.addEventListener&&b.addEventListener("beforeunload",function(){c.script&&(c.script.onerror=e)},!1)}var l=a("./polling"),k=a("component-inherit");
c.exports=g;var n=/\n/g,m=/\\n/g,r;k(g,l);g.prototype.supportsBinary=!1;g.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.iframe=this.form=null);l.prototype.doClose.call(this)};g.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);b.async=!0;b.src=this.uri();b.onerror=function(b){a.onError("jsonp poll error",
b)};var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c);this.script=b;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a);document.body.removeChild(a)},100)};g.prototype.doWrite=function(a,b){function c(){e();b()}function e(){if(f.iframe)try{f.form.removeChild(f.iframe)}catch(G){f.onError("jsonp polling iframe removal error",G)}try{l=document.createElement('<iframe src="javascript:0" name="'+
f.iframeId+'">')}catch(G){l=document.createElement("iframe"),l.name=f.iframeId,l.src="javascript:0"}l.id=f.iframeId;f.form.appendChild(l);f.iframe=l}var f=this;if(!this.form){var g=document.createElement("form"),k=document.createElement("textarea"),q=this.iframeId="eio_iframe_"+this.index,l;g.className="socketio";g.style.position="absolute";g.style.top="-1000px";g.style.left="-1000px";g.target=q;g.method="POST";g.setAttribute("accept-charset","utf-8");k.name="d";g.appendChild(k);document.body.appendChild(g);
this.form=g;this.area=k}this.form.action=this.uri();e();a=a.replace(m,"\\\n");this.area.value=a.replace(n,"\\n");try{this.form.submit()}catch(G){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==f.iframe.readyState&&c()}:this.iframe.onload=c}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-inherit":9}],17:[function(a,c,b){(function(b){function e(){}function g(a){m.call(this,
a);if(b.location){var c="https:"==location.protocol,e=location.port;e||(e=c?443:80);this.xd=a.hostname!=b.location.hostname||e!=a.port;this.xs=a.secure!=c}}function l(a){this.method=a.method||"GET";this.uri=a.uri;this.xd=!!a.xd;this.xs=!!a.xs;this.async=!1!==a.async;this.data=void 0!=a.data?a.data:null;this.agent=a.agent;this.isBinary=a.isBinary;this.supportsBinary=a.supportsBinary;this.enablesXDR=a.enablesXDR;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;
this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.create()}function k(){for(var a in l.requests)l.requests.hasOwnProperty(a)&&l.requests[a].abort()}var n=a("xmlhttprequest"),m=a("./polling"),r=a("component-emitter"),p=a("component-inherit"),q=a("debug")("engine.io-client:polling-xhr");c.exports=g;c.exports.Request=l;p(g,m);g.prototype.supportsBinary=!0;g.prototype.request=function(a){a=a||{};a.uri=this.uri();a.xd=this.xd;a.xs=this.xs;a.agent=this.agent||!1;a.supportsBinary=
this.supportsBinary;a.enablesXDR=this.enablesXDR;a.pfx=this.pfx;a.key=this.key;a.passphrase=this.passphrase;a.cert=this.cert;a.ca=this.ca;a.ciphers=this.ciphers;a.rejectUnauthorized=this.rejectUnauthorized;return new l(a)};g.prototype.doWrite=function(a,b){a=this.request({method:"POST",data:a,isBinary:"string"!==typeof a&&void 0!==a});var c=this;a.on("success",b);a.on("error",function(a){c.onError("xhr post error",a)});this.sendXhr=a};g.prototype.doPoll=function(){q("xhr poll");var a=this.request(),
b=this;a.on("data",function(a){b.onData(a)});a.on("error",function(a){b.onError("xhr poll error",a)});this.pollXhr=a};r(l.prototype);l.prototype.create=function(){var a={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};a.pfx=this.pfx;a.key=this.key;a.passphrase=this.passphrase;a.cert=this.cert;a.ca=this.ca;a.ciphers=this.ciphers;a.rejectUnauthorized=this.rejectUnauthorized;var c=this.xhr=new n(a),e=this;try{q("xhr open %s: %s",this.method,this.uri);c.open(this.method,this.uri,
this.async);this.supportsBinary&&(c.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?c.setRequestHeader("Content-type","application/octet-stream"):c.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(y){}"withCredentials"in c&&(c.withCredentials=!0);this.hasXDR()?(c.onload=function(){e.onLoad()},c.onerror=function(){e.onError(c.responseText)}):c.onreadystatechange=function(){if(4==c.readyState)if(200==c.status||1223==c.status)e.onLoad();else setTimeout(function(){e.onError(c.status)},
0)};q("xhr data %s",this.data);c.send(this.data)}catch(y){setTimeout(function(){e.onError(y)},0);return}b.document&&(this.index=l.requestsCount++,l.requests[this.index]=this)};l.prototype.onSuccess=function(){this.emit("success");this.cleanup()};l.prototype.onData=function(a){this.emit("data",a);this.onSuccess()};l.prototype.onError=function(a){this.emit("error",a);this.cleanup(!0)};l.prototype.cleanup=function(a){if("undefined"!=typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=this.xhr.onerror=
e:this.xhr.onreadystatechange=e;if(a)try{this.xhr.abort()}catch(x){}b.document&&delete l.requests[this.index];this.xhr=null}};l.prototype.onLoad=function(){try{try{var a=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(v){}var b="application/octet-stream"===a?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(v){this.onError(v)}if(null!=b)this.onData(b)};l.prototype.hasXDR=function(){return"undefined"!==typeof b.XDomainRequest&&!this.xs&&this.enablesXDR};l.prototype.abort=
function(){this.cleanup()};b.document&&(l.requestsCount=0,l.requests={},b.attachEvent?b.attachEvent("onunload",k):b.addEventListener&&b.addEventListener("beforeunload",k,!1))}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-emitter":8,"component-inherit":9,debug:21,xmlhttprequest:20}],18:[function(a,c,b){function e(a){var b=a&&a.forceBase64;if(!n||b)this.supportsBinary=!1;f.call(this,a)}var f=a("../transport"),
g=a("parseqs"),l=a("engine.io-parser");b=a("component-inherit");var k=a("debug")("engine.io-client:polling");c.exports=e;var n=null!=(new (a("xmlhttprequest"))({xdomain:!1})).responseType;b(e,f);e.prototype.name="polling";e.prototype.doOpen=function(){this.poll()};e.prototype.pause=function(a){function b(){k("paused");c.readyState="paused";a()}var c=this;this.readyState="pausing";if(this.polling||!this.writable){var e=0;this.polling&&(k("we are currently polling - waiting to pause"),e++,this.once("pollComplete",
function(){k("pre-pause polling complete");--e||b()}));this.writable||(k("we are currently writing - waiting to pause"),e++,this.once("drain",function(){k("pre-pause writing complete");--e||b()}))}else b()};e.prototype.poll=function(){k("polling");this.polling=!0;this.doPoll();this.emit("poll")};e.prototype.onData=function(a){var b=this;k("polling got data %s",a);l.decodePayload(a,this.socket.binaryType,function(a,c,e){if("opening"==b.readyState)b.onOpen();if("close"==a.type)return b.onClose(),!1;
b.onPacket(a)});"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():k('ignoring poll - transport state "%s"',this.readyState))};e.prototype.doClose=function(){function a(){k("writing close packet");b.write([{type:"close"}])}var b=this;"open"==this.readyState?(k("transport open - closing"),a()):(k("transport not open - deferring close"),this.once("open",a))};e.prototype.write=function(a){var b=this;this.writable=!1;var c=function(){b.writable=!0;
b.emit("drain")};b=this;l.encodePayload(a,this.supportsBinary,function(a){b.doWrite(a,c)})};e.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",c="";!1!==this.timestampRequests&&(a[this.timestampParam]=+new Date+"-"+f.timestamps++);this.supportsBinary||a.sid||(a.b64=1);a=g.encode(a);this.port&&("https"==b&&443!=this.port||"http"==b&&80!=this.port)&&(c=":"+this.port);a.length&&(a="?"+a);return b+"://"+this.hostname+c+this.path+a}},{"../transport":14,"component-inherit":9,debug:21,
"engine.io-parser":24,parseqs:41,xmlhttprequest:20}],19:[function(a,c,b){function e(a){a&&a.forceBase64&&(this.supportsBinary=!1);f.call(this,a)}var f=a("../transport"),g=a("engine.io-parser"),l=a("parseqs");b=a("component-inherit");var k=a("debug")("engine.io-client:websocket"),n=a("ws");c.exports=e;b(e,f);e.prototype.name="websocket";e.prototype.supportsBinary=!0;e.prototype.doOpen=function(){if(this.check()){var a=this.uri(),b={agent:this.agent};b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;
b.cert=this.cert;b.ca=this.ca;b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;this.ws=new n(a,void 0,b);void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.binaryType="arraybuffer";this.addEventListeners()}};e.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()};this.ws.onclose=function(){a.onClose()};this.ws.onmessage=function(b){a.onData(b.data)};this.ws.onerror=function(b){a.onError("websocket error",b)}};"undefined"!=typeof navigator&&
/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(e.prototype.onData=function(a){var b=this;setTimeout(function(){f.prototype.onData.call(b,a)},0)});e.prototype.write=function(a){var b=this;this.writable=!1;for(var c=0,e=a.length;c<e;c++)g.encodePacket(a[c],this.supportsBinary,function(a){try{b.ws.send(a)}catch(x){k("websocket closed before onclose event")}});setTimeout(function(){b.writable=!0;b.emit("drain")},0)};e.prototype.onClose=function(){f.prototype.onClose.call(this)};e.prototype.doClose=function(){"undefined"!==
typeof this.ws&&this.ws.close()};e.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",c="";this.port&&("wss"==b&&443!=this.port||"ws"==b&&80!=this.port)&&(c=":"+this.port);this.timestampRequests&&(a[this.timestampParam]=+new Date);this.supportsBinary||(a.b64=1);a=l.encode(a);a.length&&(a="?"+a);return b+"://"+this.hostname+c+this.path+a};e.prototype.check=function(){return!!n&&!("__initialize"in n&&this.name===e.prototype.name)}},{"../transport":14,"component-inherit":9,debug:21,
"engine.io-parser":24,parseqs:41,ws:66}],20:[function(a,c,b){var e=a("has-cors");c.exports=function(a){var b=a.xdomain,c=a.xscheme;a=a.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!b||e))return new XMLHttpRequest}catch(k){}try{if("undefined"!=typeof XDomainRequest&&!c&&a)return new XDomainRequest}catch(k){}if(!b)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(k){}}},{"has-cors":31}],21:[function(a,c,b){function e(){try{var a=localStorage.debug}catch(g){}return a}b=c.exports=a("./debug");
b.log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)};b.formatArgs=function(){var a=arguments,c=this.useColors;a[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+a[0]+(c?"%c ":" ")+"+"+b.humanize(this.diff);if(!c)return a;c="color: "+this.color;a=[a[0],c,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,k=0;a[0].replace(/%[a-z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(k=e))});a.splice(k,0,c);return a};
b.save=function(a){try{null==a?localStorage.removeItem("debug"):localStorage.debug=a}catch(g){}};b.load=e;b.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)};b.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");b.formatters.j=function(a){return JSON.stringify(a)};b.enable(e())},{"./debug":22}],
22:[function(a,c,b){b=c.exports=function(a){function c(){}function g(){var a=+new Date;g.diff=a-(f||a);g.prev=f;f=g.curr=a;null==g.useColors&&(g.useColors=b.useColors());null==g.color&&g.useColors&&(g.color=b.colors[e++%b.colors.length]);var c=Array.prototype.slice.call(arguments);c[0]=b.coerce(c[0]);"string"!==typeof c[0]&&(c=["%o"].concat(c));var k=0;c[0]=c[0].replace(/%([a-z%])/g,function(a,e){if("%%"===a)return a;k++;e=b.formatters[e];"function"===typeof e&&(a=e.call(g,c[k]),c.splice(k,1),k--);
return a});"function"===typeof b.formatArgs&&(c=b.formatArgs.apply(g,c));(g.log||b.log||console.log.bind(console)).apply(g,c)}c.enabled=!1;g.enabled=!0;var n=b.enabled(a)?g:c;n.namespace=a;return n};b.coerce=function(a){return a instanceof Error?a.stack||a.message:a};b.disable=function(){b.enable("")};b.enable=function(a){b.save(a);for(var c=(a||"").split(/[\s,]+/),e=c.length,f=0;f<e;f++)c[f]&&(a=c[f].replace(/\*/g,".*?"),"-"===a[0]?b.skips.push(new RegExp("^"+a.substr(1)+"$")):b.names.push(new RegExp("^"+
a+"$")))};b.enabled=function(a){var c;var e=0;for(c=b.skips.length;e<c;e++)if(b.skips[e].test(a))return!1;e=0;for(c=b.names.length;e<c;e++)if(b.names[e].test(a))return!0;return!1};b.humanize=a("ms");b.names=[];b.skips=[];b.formatters={};var e=0,f},{ms:38}],23:[function(a,c,b){var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
f="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");c.exports=function(a){var b=a,c=a.indexOf("["),g=a.indexOf("]");-1!=c&&-1!=g&&(a=a.substring(0,c)+a.substring(c,g).replace(/:/g,";")+a.substring(g,a.length));a=e.exec(a||"");for(var m={},r=14;r--;)m[f[r]]=a[r]||"";-1!=c&&-1!=g&&(m.source=b,m.host=m.host.substring(1,m.host.length-1).replace(/;/g,":"),m.authority=m.authority.replace("[","").replace("]","").replace(/;/g,":"),m.ipv6uri=
!0);return m}},{}],24:[function(a,c,b){(function(c){function e(a,c,e){if(!c)return b.encodeBase64Packet(a,e);var f=new FileReader;f.onload=function(){a.data=f.result;b.encodePacket(a,c,!0,e)};return f.readAsArrayBuffer(a.data)}function g(a,b,c){var e=Array(a.length);c=r(a.length,c);for(var f=function(a,c,f){b(c,function(b,c){e[a]=c;f(b,e)})},g=0;g<a.length;g++)f(g,a[g],c)}var l=a("./keys"),k=a("has-binary"),n=a("arraybuffer.slice"),m=a("base64-arraybuffer"),r=a("after"),p=a("utf8"),q=navigator.userAgent.match(/Android/i),
t=/PhantomJS/i.test(navigator.userAgent),x=q||t;b.protocol=3;var v=b.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},y=l(v),z={type:"error",data:"parser error"},A=a("blob");b.encodePacket=function(a,f,g,k){"function"==typeof f&&(k=f,f=!1);"function"==typeof g&&(k=g,g=null);var m=void 0===a.data?void 0:a.data.buffer||a.data;if(c.ArrayBuffer&&m instanceof ArrayBuffer){if(f){g=a.data;f=new Uint8Array(g);g=new Uint8Array(1+g.byteLength);g[0]=v[a.type];for(a=0;a<f.length;a++)g[a+1]=f[a];
a=k(g.buffer)}else a=b.encodeBase64Packet(a,k);return a}if(A&&m instanceof c.Blob)return f?x?a=e(a,f,k):(f=new Uint8Array(1),f[0]=v[a.type],a=new A([f.buffer,a.data]),a=k(a)):a=b.encodeBase64Packet(a,k),a;if(m&&m.base64)return k("b"+b.packets[a.type]+a.data.data);f=v[a.type];void 0!==a.data&&(f+=g?p.encode(String(a.data)):String(a.data));return k(""+f)};b.encodeBase64Packet=function(a,e){var f="b"+b.packets[a.type];if(A&&a.data instanceof A){var g=new FileReader;g.onload=function(){var a=g.result.split(",")[1];
e(f+a)};return g.readAsDataURL(a.data)}try{var k=String.fromCharCode.apply(null,new Uint8Array(a.data))}catch(C){a=new Uint8Array(a.data);k=Array(a.length);for(var m=0;m<a.length;m++)k[m]=a[m];k=String.fromCharCode.apply(null,k)}f+=c.btoa(k);return e(f)};b.decodePacket=function(a,c,e){if("string"==typeof a||void 0===a){if("b"==a.charAt(0))return b.decodeBase64Packet(a.substr(1),c);if(e)try{a=p.decode(a)}catch(K){return z}e=a.charAt(0);return Number(e)==e&&y[e]?1<a.length?{type:y[e],data:a.substring(1)}:
{type:y[e]}:z}e=(new Uint8Array(a))[0];a=n(a,1);A&&"blob"===c&&(a=new A([a]));return{type:y[e],data:a}};b.decodeBase64Packet=function(a,b){var e=y[a.charAt(0)];if(!c.ArrayBuffer)return{type:e,data:{base64:!0,data:a.substr(1)}};a=m.decode(a.substr(1));"blob"===b&&A&&(a=new A([a]));return{type:e,data:a}};b.encodePayload=function(a,c,e){"function"==typeof c&&(e=c,c=null);var f=k(a);if(c&&f)return A&&!x?b.encodePayloadAsBlob(a,e):b.encodePayloadAsArrayBuffer(a,e);if(!a.length)return e("0:");g(a,function(a,
e){b.encodePacket(a,f?c:!1,!0,function(a){e(null,a.length+":"+a)})},function(a,b){return e(b.join(""))})};b.decodePayload=function(a,c,e){if("string"!=typeof a)return b.decodePayloadAsBinary(a,c,e);"function"===typeof c&&(e=c,c=null);if(""==a)return e(z,0,1);var f="";for(var g,k,m=0,n=a.length;m<n;m++)if(k=a.charAt(m),":"!=k)f+=k;else{if(""==f||f!=(g=Number(f)))return e(z,0,1);k=a.substr(m+1,g);if(f!=k.length)return e(z,0,1);if(k.length){f=b.decodePacket(k,c,!0);if(z.type==f.type&&z.data==f.data)return e(z,
0,1);if(!1===e(f,m+g,n))return}m+=g;f=""}if(""!=f)return e(z,0,1)};b.encodePayloadAsArrayBuffer=function(a,c){if(!a.length)return c(new ArrayBuffer(0));g(a,function(a,c){b.encodePacket(a,!0,!0,function(a){return c(null,a)})},function(a,b){a=b.reduce(function(a,b){b="string"===typeof b?b.length:b.byteLength;return a+b.toString().length+b+2},0);var e=new Uint8Array(a),f=0;b.forEach(function(a){var b="string"===typeof a,c=a;if(b){c=new Uint8Array(a.length);for(var g=0;g<a.length;g++)c[g]=a.charCodeAt(g);
c=c.buffer}b?e[f++]=0:e[f++]=1;a=c.byteLength.toString();for(g=0;g<a.length;g++)e[f++]=parseInt(a[g]);e[f++]=255;c=new Uint8Array(c);for(g=0;g<c.length;g++)e[f++]=c[g]});return c(e.buffer)})};b.encodePayloadAsBlob=function(a,c){g(a,function(a,c){b.encodePacket(a,!0,!0,function(a){var b=new Uint8Array(1);b[0]=1;if("string"===typeof a){for(var e=new Uint8Array(a.length),f=0;f<a.length;f++)e[f]=a.charCodeAt(f);a=e.buffer;b[0]=0}e=(a instanceof ArrayBuffer?a.byteLength:a.size).toString();var g=new Uint8Array(e.length+
1);for(f=0;f<e.length;f++)g[f]=parseInt(e[f]);g[e.length]=255;A&&(a=new A([b.buffer,g.buffer,a]),c(null,a))})},function(a,b){return c(new A(b))})};b.decodePayloadAsBinary=function(a,c,e){"function"===typeof c&&(e=c,c=null);for(var f=[],g=!1;0<a.byteLength;){for(var k=new Uint8Array(a),m=0===k[0],q="",l=1;255!=k[l];l++){if(310<q.length){g=!0;break}q+=k[l]}if(g)return e(z,0,1);a=n(a,2+q.length);q=parseInt(q);k=n(a,0,q);if(m)try{k=String.fromCharCode.apply(null,new Uint8Array(k))}catch(P){for(m=new Uint8Array(k),
k="",l=0;l<m.length;l++)k+=String.fromCharCode(m[l])}f.push(k);a=n(a,q)}var r=f.length;f.forEach(function(a,f){e(b.decodePacket(a,c,!0),f,r)})}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./keys":25,after:1,"arraybuffer.slice":2,"base64-arraybuffer":5,blob:6,"has-binary":30,utf8:60}],25:[function(a,c,b){c.exports=Object.keys||function(a){var b=[],c=Object.prototype.hasOwnProperty,e;for(e in a)c.call(a,e)&&b.push(e);return b}},
{}],26:[function(a,c,b){function e(a){g.call(this);a=a||{};this.config={chunksize:16384,pacing:0};for(var b in a)this.config[b]=a[b];this.channel=this.file=null}function f(){g.call(this);this.receiveBuffer=[];this.received=0;this.metadata={};this.channel=null}var g=a("wildemitter");a=a("util");a.inherits(e,g);e.prototype.send=function(a,b){var c=this;this.file=a;this.channel=b;var e="number"!==typeof b.bufferedAmountLowThreshold,f=0,g=function(){var k=new window.FileReader;k.onload=function(){return function(k){c.channel.send(k.target.result);
c.emit("progress",f,a.size,k.target.result);a.size>f+k.target.result.byteLength?e?window.setTimeout(g,c.config.pacing):b.bufferedAmount<=b.bufferedAmountLowThreshold&&window.setTimeout(g,0):(c.emit("progress",a.size,a.size,null),c.emit("sentFile"));f+=c.config.chunksize}}(a);var m=a.slice(f,f+c.config.chunksize);k.readAsArrayBuffer(m)};e||(b.bufferedAmountLowThreshold=8*this.config.chunksize,b.addEventListener("bufferedamountlow",g));window.setTimeout(g,0)};a.inherits(f,g);f.prototype.receive=function(a,
b){var c=this;a&&(this.metadata=a);this.channel=b;b.binaryType="arraybuffer";this.channel.onmessage=function(a){c.received+=a.data.byteLength;c.receiveBuffer.push(a.data);c.emit("progress",c.received,c.metadata.size,a.data);c.received===c.metadata.size?(c.emit("receivedFile",new window.Blob(c.receiveBuffer),c.metadata),c.receiveBuffer=[]):c.received>c.metadata.size&&(console.error("received more than expected, discarding..."),c.receiveBuffer=[])}};c.exports={};c.exports.support="undefined"!==typeof window&&
window&&window.File&&window.FileReader&&window.Blob;c.exports.Sender=e;c.exports.Receiver=f},{util:63,wildemitter:65}],27:[function(a,c,b){var e={};c.exports=function(a,b){var c=2===arguments.length,f=c?b:a;if("undefined"===typeof window||"http:"===window.location.protocol){var g=Error("NavigatorUserMediaError");g.name="HTTPS_REQUIRED";return f(g)}if(window.navigator.userAgent.match("Chrome")){var m=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),r=33,p=!window.chrome.webstore;window.navigator.userAgent.match("Linux")&&
(r=35);sessionStorage.getScreenMediaJSExtensionId?chrome.runtime.sendMessage(sessionStorage.getScreenMediaJSExtensionId,{type:"getScreen",id:1},null,function(b){b&&""!==b.sourceId?(a=c&&a||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3}}},a.video.mandatory.chromeMediaSourceId=b.sourceId,window.navigator.mediaDevices.getUserMedia(a).then(function(a){f(null,a)}).catch(function(a){f(a)})):(b=Error("NavigatorUserMediaError"),
b.name="NotAllowedError",f(b))}):window.cefGetScreenMedia?window.cefGetScreenMedia(function(b){b?(a=c&&a||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},a.video.mandatory.chromeMediaSourceId=b,window.navigator.mediaDevices.getUserMedia(a).then(function(a){f(null,a)}).catch(function(a){f(a)})):(b=Error("cefGetScreenMediaError"),b.name="CEF_GETSCREENMEDIA_CANCELED",
f(b))}):p||26<=m&&m<=r?(a=c&&a||{video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3,chromeMediaSource:"screen"}}},window.navigator.mediaDevices.getUserMedia(a).then(function(a){f(null,a)}).catch(function(a){f(a)})):(m=window.setTimeout(function(){g=Error("NavigatorUserMediaError");g.name="EXTENSION_UNAVAILABLE";return f(g)},1E3),e[m]=[f,c?a:null],window.postMessage({type:"getScreen",id:m},"*"))}else window.navigator.userAgent.match("Firefox")&&
(33<=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10)?(a=c&&a||{video:{mozMediaSource:"window",mediaSource:"window"}},window.navigator.mediaDevices.getUserMedia(a).then(function(a){f(null,a);var b=a.currentTime,c=window.setInterval(function(){a||window.clearInterval(c);if(a.currentTime==b&&(window.clearInterval(c),a.onended))a.onended();b=a.currentTime},500)}).catch(function(a){f(a)})):(g=Error("NavigatorUserMediaError"),g.name="EXTENSION_UNAVAILABLE"))};"undefined"!==typeof window&&
window.addEventListener("message",function(a){if(a.origin==window.location.origin)if("gotScreen"==a.data.type&&e[a.data.id]){var b=e[a.data.id],c=b[1],f=b[0];delete e[a.data.id];""===a.data.sourceId?(a=Error("NavigatorUserMediaError"),a.name="NotAllowedError",f(a)):(c=c||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},c.video.mandatory.chromeMediaSourceId=
a.data.sourceId,window.navigator.mediaDevices.getUserMedia(c).then(function(a){f(null,a)}).catch(function(a){f(a)}))}else"getScreenPending"==a.data.type&&window.clearTimeout(a.data.id)})},{}],28:[function(a,c,b){c.exports=function(){return this}()},{}],29:[function(a,c,b){var e=a("wildemitter"),f;"undefined"!==typeof window&&(f=window.AudioContext||window.webkitAudioContext);var g=null;c.exports=function(a,b){var c=new e;if(!f)return c;b=b||{};var k=b.smoothing||.1,l=b.interval||50,p=b.threshold,
q=b.play;b=b.history||10;var t=!0;g||(g=new f);var x=g.createAnalyser();x.fftSize=512;x.smoothingTimeConstant=k;var v=new Float32Array(x.frequencyBinCount);a.jquery&&(a=a[0]);if(a instanceof HTMLAudioElement||a instanceof HTMLVideoElement){var y=g.createMediaElementSource(a);"undefined"===typeof q&&(q=!0)}else y=g.createMediaStreamSource(a);p=p||-50;y.connect(x);q&&x.connect(g.destination);c.speaking=!1;c.setThreshold=function(a){p=a};c.setInterval=function(a){l=a};c.stop=function(){t=!1;c.emit("volume_change",
-100,p);c.speaking&&(c.speaking=!1,c.emit("stopped_speaking"));x.disconnect();y.disconnect()};c.speakingHistory=[];for(a=0;a<b;a++)c.speakingHistory.push(0);var z=function(){setTimeout(function(){if(t){var a=-Infinity;x.getFloatFrequencyData(v);for(var b=4,e=v.length;b<e;b++)v[b]>a&&0>v[b]&&(a=v[b]);c.emit("volume_change",a,p);b=0;if(a>p&&!c.speaking){for(e=c.speakingHistory.length-3;e<c.speakingHistory.length;e++)b+=c.speakingHistory[e];2<=b&&(c.speaking=!0,c.emit("speaking"))}else if(a<p&&c.speaking){for(e=
0;e<c.speakingHistory.length;e++)b+=c.speakingHistory[e];0==b&&(c.speaking=!1,c.emit("stopped_speaking"))}c.speakingHistory.shift();c.speakingHistory.push(0+(a>p));z()}},l)};z();return c}},{wildemitter:65}],30:[function(a,c,b){(function(b){var e=a("isarray");c.exports=function(a){function c(a){if(!a)return!1;if(b.Buffer&&b.Buffer.isBuffer(a)||b.ArrayBuffer&&a instanceof ArrayBuffer||b.Blob&&a instanceof Blob||b.File&&a instanceof File)return!0;if(e(a))for(var f=0;f<a.length;f++){if(c(a[f]))return!0}else if(a&&
"object"==typeof a)for(f in a.toJSON&&(a=a.toJSON()),a)if(Object.prototype.hasOwnProperty.call(a,f)&&c(a[f]))return!0;return!1}return c(a)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{isarray:33}],31:[function(a,c,b){a=a("global");try{c.exports="XMLHttpRequest"in a&&"withCredentials"in new a.XMLHttpRequest}catch(e){c.exports=!1}},{global:28}],32:[function(a,c,b){var e=[].indexOf;c.exports=function(a,b){if(e)return a.indexOf(b);
for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}},{}],33:[function(a,c,b){c.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],34:[function(a,c,b){(function(a){function c(a){if(c[a]!==k)return c[a];if("bug-string-char-index"==a)var b=!1;else if("json"==a)b=c("json-stringify")&&c("json-parse");else{var f;if("json-stringify"==a){b=m.stringify;var g="function"==typeof b&&r;if(g){(f=function(){return 1}).toJSON=f;try{g="0"===b(0)&&"0"===b(new Number)&&
'""'==b(new String)&&b(e)===k&&b(k)===k&&b()===k&&"1"===b(f)&&"[1]"==b([f])&&"[null]"==b([k])&&"null"==b(null)&&"[null,null,null]"==b([k,e,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==b({a:[f,!0,!1,null,"\x00\b\n\f\r\t"]})&&"1"===b(null,f)&&"[\n 1,\n 2\n]"==b([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==b(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==b(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==b(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==b(new Date(-1))}catch(Q){g=
!1}}b=g}if("json-parse"==a){b=m.parse;if("function"==typeof b)try{if(0===b("0")&&!b(!1)){f=b('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var q=5==f.a.length&&1===f.a[0];if(q){try{q=!b('"\t"')}catch(Q){}if(q)try{q=1!==b("01")}catch(Q){}if(q)try{q=1!==b("1.")}catch(Q){}}}}catch(Q){q=!1}b=q}}return c[a]=!!b}var e={}.toString,l,k,n="object"==typeof JSON&&JSON,m="object"==typeof b&&b&&!b.nodeType&&b;m&&n?(m.stringify=n.stringify,m.parse=n.parse):m=a.JSON=n||{};var r=new Date(-0xc782b5b800cec);
try{r=-109252==r.getUTCFullYear()&&0===r.getUTCMonth()&&1===r.getUTCDate()&&10==r.getUTCHours()&&37==r.getUTCMinutes()&&6==r.getUTCSeconds()&&708==r.getUTCMilliseconds()}catch(Z){}if(!c("json")){var p=c("bug-string-char-index");if(!r)var q=Math.floor,t=[0,31,59,90,120,151,181,212,243,273,304,334],x=function(a,b){return t[b]+365*(a-1970)+q((a-1969+(b=+(1<b)))/4)-q((a-1901+b)/100)+q((a-1601+b)/400)};(l={}.hasOwnProperty)||(l=function(a){var b={};if((b.__proto__=null,b.__proto__={toString:1},b).toString!=
e)l=function(a){var b=this.__proto__;a=a in(this.__proto__=null,this);this.__proto__=b;return a};else{var c=b.constructor;l=function(a){var b=(this.constructor||c).prototype;return a in this&&!(a in b&&this[a]===b[a])}}b=null;return l.call(this,a)});var v={"boolean":1,number:1,string:1,undefined:1};var y=function(a,b){var c=0,f,g;(f=function(){this.valueOf=0}).prototype.valueOf=0;var k=new f;for(g in k)l.call(k,g)&&c++;f=k=null;c?y=2==c?function(a,b){var c={},f="[object Function]"==e.call(a),g;for(g in a)f&&
"prototype"==g||l.call(c,g)||!(c[g]=1)||!l.call(a,g)||b(g)}:function(a,b){var c="[object Function]"==e.call(a),f,g;for(f in a)c&&"prototype"==f||!l.call(a,f)||(g="constructor"===f)||b(f);(g||l.call(a,f="constructor"))&&b(f)}:(k="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),y=function(a,b){var c="[object Function]"==e.call(a),f,g;if(g=!c&&"function"!=typeof a.constructor)g=typeof a.hasOwnProperty,g="object"==g?!!a.hasOwnProperty:!v[g];g=
g?a.hasOwnProperty:l;for(f in a)c&&"prototype"==f||!g.call(a,f)||b(f);for(c=k.length;f=k[--c];g.call(a,f)&&b(f));});return y(a,b)};if(!c("json-stringify")){var z={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},A=function(a,b){return("000000"+(b||0)).slice(-a)},D=function(a){var b='"',c=0,e=a.length,f=10<e&&p,g;for(f&&(g=a.split(""));c<e;c++){var k=a.charCodeAt(c);switch(k){case 8:case 9:case 10:case 12:case 13:case 34:case 92:b+=z[k];break;default:b=32>k?b+("\\u00"+A(2,k.toString(16))):
b+(f?g[c]:p?a.charAt(c):a[c])}}return b+'"'},G=function(a,b,c,f,g,m,n){var r;try{var p=b[a]}catch(W){}if("object"==typeof p&&p){var t=e.call(p);if("[object Date]"!=t||l.call(p,"toJSON"))"function"==typeof p.toJSON&&("[object Number]"!=t&&"[object String]"!=t&&"[object Array]"!=t||l.call(p,"toJSON"))&&(p=p.toJSON(a));else if(p>-1/0&&p<1/0){if(x){var E=q(p/864E5);for(t=q(E/365.2425)+1970-1;x(t+1,0)<=E;t++);for(r=q((E-x(t,0))/30.42);x(t,r+1)<=E;r++);E=1+E-x(t,r);var z=(p%864E5+864E5)%864E5;var M=q(z/
36E5)%24;var v=q(z/6E4)%60;var V=q(z/1E3)%60;z%=1E3}else t=p.getUTCFullYear(),r=p.getUTCMonth(),E=p.getUTCDate(),M=p.getUTCHours(),v=p.getUTCMinutes(),V=p.getUTCSeconds(),z=p.getUTCMilliseconds();p=(0>=t||1E4<=t?(0>t?"-":"+")+A(6,0>t?-t:t):A(4,t))+"-"+A(2,r+1)+"-"+A(2,E)+"T"+A(2,M)+":"+A(2,v)+":"+A(2,V)+"."+A(3,z)+"Z"}else p=null}c&&(p=c.call(b,a,p));if(null===p)return"null";t=e.call(p);if("[object Boolean]"==t)return""+p;if("[object Number]"==t)return p>-1/0&&p<1/0?""+p:"null";if("[object String]"==
t)return D(""+p);if("object"==typeof p){for(a=n.length;a--;)if(n[a]===p)throw TypeError();n.push(p);var J=[];b=m;m+=g;if("[object Array]"==t){r=0;for(a=p.length;r<a;r++)t=G(r,p,c,f,g,m,n),J.push(t===k?"null":t);a=J.length?g?"[\n"+m+J.join(",\n"+m)+"\n"+b+"]":"["+J.join(",")+"]":"[]"}else y(f||p,function(a){var b=G(a,p,c,f,g,m,n);b!==k&&J.push(D(a)+":"+(g?" ":"")+b)}),a=J.length?g?"{\n"+m+J.join(",\n"+m)+"\n"+b+"}":"{"+J.join(",")+"}":"{}";n.pop();return a}};m.stringify=function(a,b,c){var f;if("function"==
typeof b||"object"==typeof b&&b)if("[object Function]"==(f=e.call(b)))var g=b;else if("[object Array]"==f){var k={};for(var m=0,q=b.length,l;m<q;l=b[m++],(f=e.call(l),"[object String]"==f||"[object Number]"==f)&&(k[l]=1));}if(c)if("[object Number]"==(f=e.call(c))){if(0<(c-=c%1)){var p="";for(10<c&&(c=10);p.length<c;p+=" ");}}else"[object String]"==f&&(p=10>=c.length?c:c.slice(0,10));return G("",(l={},l[""]=a,l),g,k,p,"",[])}}if(!c("json-parse")){var L=String.fromCharCode,K={92:"\\",34:'"',47:"/",
98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},u,H,C=function(){u=H=null;throw SyntaxError();},F=function(){for(var a=H,b=a.length,c,e,f,g,k;u<b;)switch(k=a.charCodeAt(u),k){case 9:case 10:case 13:case 32:u++;break;case 123:case 125:case 91:case 93:case 58:case 44:return c=p?a.charAt(u):a[u],u++,c;case 34:c="@";for(u++;u<b;)if(k=a.charCodeAt(u),32>k)C();else if(92==k)switch(k=a.charCodeAt(++u),k){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:c+=K[k];u++;break;case 117:e=++u;for(f=
u+4;u<f;u++)k=a.charCodeAt(u),48<=k&&57>=k||97<=k&&102>=k||65<=k&&70>=k||C();c+=L("0x"+a.slice(e,u));break;default:C()}else{if(34==k)break;k=a.charCodeAt(u);for(e=u;32<=k&&92!=k&&34!=k;)k=a.charCodeAt(++u);c+=a.slice(e,u)}if(34==a.charCodeAt(u))return u++,c;C();default:e=u;45==k&&(g=!0,k=a.charCodeAt(++u));if(48<=k&&57>=k){for(48==k&&(k=a.charCodeAt(u+1),48<=k&&57>=k)&&C();u<b&&(k=a.charCodeAt(u),48<=k&&57>=k);u++);if(46==a.charCodeAt(u)){for(f=++u;f<b&&(k=a.charCodeAt(f),48<=k&&57>=k);f++);f==u&&
C();u=f}k=a.charCodeAt(u);if(101==k||69==k){k=a.charCodeAt(++u);43!=k&&45!=k||u++;for(f=u;f<b&&(k=a.charCodeAt(f),48<=k&&57>=k);f++);f==u&&C();u=f}return+a.slice(e,u)}g&&C();if("true"==a.slice(u,u+4))return u+=4,!0;if("false"==a.slice(u,u+5))return u+=5,!1;if("null"==a.slice(u,u+4))return u+=4,null;C()}return"$"},I=function(a){var b,c;"$"==a&&C();if("string"==typeof a){if("@"==(p?a.charAt(0):a[0]))return a.slice(1);if("["==a){for(b=[];;c||(c=!0)){a=F();if("]"==a)break;c&&(","==a?(a=F(),"]"==a&&C()):
C());","==a&&C();b.push(I(a))}return b}if("{"==a){for(b={};;c||(c=!0)){a=F();if("}"==a)break;c&&(","==a?(a=F(),"}"==a&&C()):C());","!=a&&"string"==typeof a&&"@"==(p?a.charAt(0):a[0])&&":"==F()||C();b[a.slice(1)]=I(F())}return b}C()}return a},O=function(a,b,c){c=P(a,b,c);c===k?delete a[b]:a[b]=c},P=function(a,b,c){var f=a[b],g;if("object"==typeof f&&f)if("[object Array]"==e.call(f))for(g=f.length;g--;)O(f,g,c);else y(f,function(a){O(f,a,c)});return c.call(a,b,f)};m.parse=function(a,b){var c;u=0;H=
""+a;a=I(F());"$"!=F()&&C();u=H=null;return b&&"[object Function]"==e.call(b)?P((c={},c[""]=a,c),"",b):a}}}})(this)},{}],35:[function(a,c,b){function e(a){var b=!0;a.getTracks().forEach(function(a){b="ended"===a.readyState&&b});return b}function f(){if("undefined"===typeof window||!window.navigator.mozGetUserMedia)return!1;var a=window.navigator.userAgent.match(/Firefox\/(\d+)\./);return 50>(a&&1<=a.length&&parseInt(a[1],10))}function g(a){n.call(this);var b=this.config={detectSpeakingEvents:!1,audioFallback:!1,
media:{audio:!0,video:!0},harkOptions:null,logger:m},c;for(c in a)a.hasOwnProperty(c)&&(this.config[c]=a[c]);this.logger=b.logger;this._log=this.logger.log.bind(this.logger,"LocalMedia:");this._logerror=this.logger.error.bind(this.logger,"LocalMedia:");this.localStreams=[];this.localScreens=[];navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||this._logerror("Your browser does not support local media capture.");this._audioMonitors=[];this.on("localStreamStopped",this._stopAudioMonitor.bind(this));
this.on("localScreenStopped",this._stopAudioMonitor.bind(this))}b=a("util");var l=a("hark"),k=a("getscreenmedia"),n=a("wildemitter"),m=a("mockconsole");b.inherits(g,n);g.prototype.start=function(a,b){var c=this,f=a||this.config.media;this.emit("localStreamRequested",f);navigator.mediaDevices.getUserMedia(f).then(function(a){f.audio&&c.config.detectSpeakingEvents&&c._setupAudioMonitor(a,c.config.harkOptions);c.localStreams.push(a);a.getTracks().forEach(function(b){b.addEventListener("ended",function(){e(a)&&
c._removeStream(a)})});c.emit("localStream",a);if(b)return b(null,a)}).catch(function(a){if(c.config.audioFallback&&"NotFoundError"===a.name&&!1!==f.video)f.video=!1,c.start(f,b);else if(c.emit("localStreamRequestFailed",f),b)return b(a,null)})};g.prototype.stop=function(a){this.stopStream(a);this.stopScreenShare(a)};g.prototype.stopStream=function(a){var b=this;a?-1<this.localStreams.indexOf(a)&&(a.getTracks().forEach(function(a){a.stop()}),f()&&this._removeStream(a)):this.localStreams.forEach(function(a){a.getTracks().forEach(function(a){a.stop()});
f()&&b._removeStream(a)})};g.prototype.startScreenShare=function(a,b){var c=this;this.emit("localScreenRequested");"function"!==typeof a||b||(b=a,a=null);k(a,function(a,e){a?c.emit("localScreenRequestFailed"):(c.localScreens.push(e),e.getTracks().forEach(function(a){a.addEventListener("ended",function(){var a=!0;e.getTracks().forEach(function(b){a="ended"===b.readyState&&a});a&&c._removeStream(e)})}),c.emit("localScreen",e));if(b)return b(a,e)})};g.prototype.stopScreenShare=function(a){var b=this;
a?-1<this.localScreens.indexOf(a)&&(a.getTracks().forEach(function(a){a.stop()}),f()&&this._removeStream(a)):this.localScreens.forEach(function(a){a.getTracks().forEach(function(a){a.stop()});f()&&b._removeStream(a)})};g.prototype.mute=function(){this._audioEnabled(!1);this.emit("audioOff")};g.prototype.unmute=function(){this._audioEnabled(!0);this.emit("audioOn")};g.prototype.pauseVideo=function(){this._videoEnabled(!1);this.emit("videoOff")};g.prototype.resumeVideo=function(){this._videoEnabled(!0);
this.emit("videoOn")};g.prototype.pause=function(){this.mute();this.pauseVideo()};g.prototype.resume=function(){this.unmute();this.resumeVideo()};g.prototype._audioEnabled=function(a){this.localStreams.forEach(function(b){b.getAudioTracks().forEach(function(b){b.enabled=!!a})})};g.prototype._videoEnabled=function(a){this.localStreams.forEach(function(b){b.getVideoTracks().forEach(function(b){b.enabled=!!a})})};g.prototype.isAudioEnabled=function(){var a=!0;this.localStreams.forEach(function(b){b.getAudioTracks().forEach(function(b){a=
a&&b.enabled})});return a};g.prototype.isVideoEnabled=function(){var a=!0;this.localStreams.forEach(function(b){b.getVideoTracks().forEach(function(b){a=a&&b.enabled})});return a};g.prototype._removeStream=function(a){var b=this.localStreams.indexOf(a);-1<b?(this.localStreams.splice(b,1),this.emit("localStreamStopped",a)):(b=this.localScreens.indexOf(a),-1<b&&(this.localScreens.splice(b,1),this.emit("localScreenStopped",a)))};g.prototype._setupAudioMonitor=function(a,b){this._log("Setup audio");b=
l(a,b);var c=this,e;b.on("speaking",function(){c.emit("speaking")});b.on("stopped_speaking",function(){e&&clearTimeout(e);e=setTimeout(function(){c.emit("stoppedSpeaking")},1E3)});b.on("volume_change",function(a,b){c.emit("volumeChange",a,b)});this._audioMonitors.push({audio:b,stream:a})};g.prototype._stopAudioMonitor=function(a){var b=-1;this._audioMonitors.forEach(function(c,e){c.stream===a&&(b=e)});-1<b&&(this._audioMonitors[b].audio.stop(),this._audioMonitors.splice(b,1))};c.exports=g},{getscreenmedia:27,
hark:29,mockconsole:37,util:63,wildemitter:65}],36:[function(a,c,b){(function(a){function e(a,b){a.set(b[0],b[1]);return a}function g(a,b){a.add(b);return a}function l(a,b){for(var c=-1,e=a?a.length:0;++c<e&&!1!==b(a[c],c,a););return a}function k(a,b,c,e){var f=-1,g=a?a.length:0;for(e&&g&&(c=a[++f]);++f<g;)c=b(c,a[f],f,a);return c}function n(a){var b=!1;if(null!=a&&"function"!=typeof a.toString)try{b=!!(a+"")}catch(Fa){}return b}function m(a){var b=-1,c=Array(a.size);a.forEach(function(a,e){c[++b]=
[e,a]});return c}function r(a,b){return function(c){return a(b(c))}}function p(a){var b=-1,c=Array(a.size);a.forEach(function(a){c[++b]=a});return c}function q(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var e=a[b];this.set(e[0],e[1])}}function t(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var e=a[b];this.set(e[0],e[1])}}function x(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var e=a[b];this.set(e[0],e[1])}}function v(a){this.__data__=new t(a)}function y(a,b,c){var e=a[b];R.call(a,
b)&&(e===c||e!==e&&c!==c)&&(void 0!==c||b in a)||(a[b]=c)}function z(a,b){for(var c=a.length;c--;){var e=a[c][0];if(e===b||e!==e&&b!==b)return c}return-1}function A(a,b){return a&&H(b,J(b),a)}function D(a,b,c,e,f,g,k){var m;e&&(m=g?e(a,f,g,k):e(a));if(void 0!==m)return m;if(!Q(a))return a;if(f=ca(a)){if(m=O(a),!b)return u(a,m)}else{var q=T(a),p="[object Function]"==q||"[object GeneratorFunction]"==q;if(sa(a))return L(a,b);if("[object Object]"==q||"[object Arguments]"==q||p&&!g){if(n(a))return g?a:
{};m=P(p?{}:a);if(!b)return C(a,A(m,a))}else{if(!B[q])return g?a:{};m=Z(a,q,D,b)}}k||(k=new v);if(g=k.get(a))return g;k.set(a,m);if(!f)var r=c?G(a,J,ja):J(a);l(r||a,function(f,g){r&&(g=f,f=a[g]);y(m,g,D(f,b,c,e,g,a,k))});return m}function G(a,b,c){b=b(a);if(!ca(a)){a=c(a);c=-1;for(var e=a.length,f=b.length;++c<e;)b[f+c]=a[c]}return b}function L(a,b){if(b)return a.slice();b=new a.constructor(a.length);a.copy(b);return b}function K(a){var b=new a.constructor(a.byteLength);(new ka(b)).set(new ka(a));
return b}function u(a,b){var c=-1,e=a.length;for(b||(b=Array(e));++c<e;)b[c]=a[c];return b}function H(a,b,c,e){c||(c={});for(var f=-1,g=b.length;++f<g;){var k=b[f],m=e?e(c[k],a[k],k,c,a):void 0;y(c,k,void 0===m?a[k]:m)}return c}function C(a,b){return H(a,ja(a),b)}function F(a,b){a=a.__data__;var c=typeof b;return("string"==c||"number"==c||"symbol"==c||"boolean"==c?"__proto__"!==b:null===b)?a["string"==typeof b?"string":"hash"]:a.map}function I(a,b){a=null==a?void 0:a[b];b=!Q(a)||la&&la in a?!1:(ha(a)||
n(a)?ta:qa).test(M(a));return b?a:void 0}function O(a){var b=a.length,c=a.constructor(b);b&&"string"==typeof a[0]&&R.call(a,"index")&&(c.index=a.index,c.input=a.input);return c}function P(a){"function"!=typeof a.constructor||E(a)?a={}:(a=ua(a),a=Q(a)?va(a):{});return a}function Z(a,b,c,f){var l=a.constructor;switch(b){case "[object ArrayBuffer]":return K(a);case "[object Boolean]":case "[object Date]":return new l(+a);case "[object DataView]":return b=f?K(a.buffer):a.buffer,new a.constructor(b,a.byteOffset,
a.byteLength);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return b=f?K(a.buffer):a.buffer,new a.constructor(b,a.byteOffset,a.length);case "[object Map]":return b=f?c(m(a),!0):m(a),k(b,e,new a.constructor);case "[object Number]":case "[object String]":return new l(a);case "[object RegExp]":return b=
new a.constructor(a.source,pa.exec(a)),b.lastIndex=a.lastIndex,b;case "[object Set]":return b=f?c(p(a),!0):p(a),k(b,g,new a.constructor);case "[object Symbol]":return ma?Object(ma.call(a)):{}}}function E(a){var b=a&&a.constructor;return a===("function"==typeof b&&b.prototype||W)}function M(a){if(null!=a){try{return na.call(a)}catch(Ea){}return a+""}return""}function V(a){var b;if(b=null!=a)b=a.length,b="number"==typeof b&&-1<b&&0==b%1&&9007199254740991>=b;return b&&!ha(a)}function ha(a){a=Q(a)?aa.call(a):
"";return"[object Function]"==a||"[object GeneratorFunction]"==a}function Q(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function J(a){if(V(a)){var b;(b=ca(a))||(b=!!a&&"object"==typeof a&&V(a)&&R.call(a,"callee")&&(!wa.call(a,"callee")||"[object Arguments]"==aa.call(a)));if(b){b=a.length;for(var c=String,e=-1,f=Array(b);++e<b;)f[e]=c(e);b=f}else b=[];c=b.length;e=!!c;for(var g in a){if(!(f=!R.call(a,g))&&(f=e)&&!(f="length"==g)){f=g;var k=c;k=null==k?9007199254740991:k;f=!!k&&("number"==
typeof f||ra.test(f))&&-1<f&&0==f%1&&f<k}f||b.push(g)}a=b}else if(E(a)){g=[];for(b in Object(a))R.call(a,b)&&"constructor"!=b&&g.push(b);a=g}else a=xa(a);return a}function oa(){return[]}function ia(){return!1}var pa=/\w*$/,qa=/^\[object .+?Constructor\]$/,ra=/^(?:0|[1-9]\d*)$/,B={};B["[object Arguments]"]=B["[object Array]"]=B["[object ArrayBuffer]"]=B["[object DataView]"]=B["[object Boolean]"]=B["[object Date]"]=B["[object Float32Array]"]=B["[object Float64Array]"]=B["[object Int8Array]"]=B["[object Int16Array]"]=
B["[object Int32Array]"]=B["[object Map]"]=B["[object Number]"]=B["[object Object]"]=B["[object RegExp]"]=B["[object Set]"]=B["[object String]"]=B["[object Symbol]"]=B["[object Uint8Array]"]=B["[object Uint8ClampedArray]"]=B["[object Uint16Array]"]=B["[object Uint32Array]"]=!0;B["[object Error]"]=B["[object Function]"]=B["[object WeakMap]"]=!1;var N="object"==typeof self&&self&&self.Object===Object&&self;a="object"==typeof a&&a&&a.Object===Object&&a||N||Function("return this")();var S=(N="object"==
typeof b&&b&&!b.nodeType&&b)&&"object"==typeof c&&c&&!c.nodeType&&c;N=S&&S.exports===N;S=Array.prototype;var U=Function.prototype,W=Object.prototype,ba=a["__core-js_shared__"],la=function(){var a=/[^.]+$/.exec(ba&&ba.keys&&ba.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),na=U.toString,R=W.hasOwnProperty,aa=W.toString,ta=RegExp("^"+na.call(R).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");U=N?a.Buffer:void 0;N=a.Symbol;var ka=
a.Uint8Array,ua=r(Object.getPrototypeOf,Object),va=Object.create,wa=W.propertyIsEnumerable,ya=S.splice;S=Object.getOwnPropertySymbols;U=U?U.isBuffer:void 0;var xa=r(Object.keys,Object),da=I(a,"DataView"),X=I(a,"Map"),ea=I(a,"Promise"),fa=I(a,"Set");a=I(a,"WeakMap");var Y=I(Object,"create"),za=M(da),Aa=M(X),Ba=M(ea),Ca=M(fa),Da=M(a),ma=(N=N?N.prototype:void 0)?N.valueOf:void 0;q.prototype.clear=function(){this.__data__=Y?Y(null):{}};q.prototype["delete"]=function(a){return this.has(a)&&delete this.__data__[a]};
q.prototype.get=function(a){var b=this.__data__;return Y?(a=b[a],"__lodash_hash_undefined__"===a?void 0:a):R.call(b,a)?b[a]:void 0};q.prototype.has=function(a){var b=this.__data__;return Y?void 0!==b[a]:R.call(b,a)};q.prototype.set=function(a,b){this.__data__[a]=Y&&void 0===b?"__lodash_hash_undefined__":b;return this};t.prototype.clear=function(){this.__data__=[]};t.prototype["delete"]=function(a){var b=this.__data__;a=z(b,a);if(0>a)return!1;a==b.length-1?b.pop():ya.call(b,a,1);return!0};t.prototype.get=
function(a){var b=this.__data__;a=z(b,a);return 0>a?void 0:b[a][1]};t.prototype.has=function(a){return-1<z(this.__data__,a)};t.prototype.set=function(a,b){var c=this.__data__,e=z(c,a);0>e?c.push([a,b]):c[e][1]=b;return this};x.prototype.clear=function(){this.__data__={hash:new q,map:new (X||t),string:new q}};x.prototype["delete"]=function(a){return F(this,a)["delete"](a)};x.prototype.get=function(a){return F(this,a).get(a)};x.prototype.has=function(a){return F(this,a).has(a)};x.prototype.set=function(a,
b){F(this,a).set(a,b);return this};v.prototype.clear=function(){this.__data__=new t};v.prototype["delete"]=function(a){return this.__data__["delete"](a)};v.prototype.get=function(a){return this.__data__.get(a)};v.prototype.has=function(a){return this.__data__.has(a)};v.prototype.set=function(a,b){var c=this.__data__;if(c instanceof t){c=c.__data__;if(!X||199>c.length)return c.push([a,b]),this;c=this.__data__=new x(c)}c.set(a,b);return this};var ja=S?r(S,Object):oa,T=function(a){return aa.call(a)};
if(da&&"[object DataView]"!=T(new da(new ArrayBuffer(1)))||X&&"[object Map]"!=T(new X)||ea&&"[object Promise]"!=T(ea.resolve())||fa&&"[object Set]"!=T(new fa)||a&&"[object WeakMap]"!=T(new a))T=function(a){var b=aa.call(a);if(a=(a="[object Object]"==b?a.constructor:void 0)?M(a):void 0)switch(a){case za:return"[object DataView]";case Aa:return"[object Map]";case Ba:return"[object Promise]";case Ca:return"[object Set]";case Da:return"[object WeakMap]"}return b};var ca=Array.isArray,sa=U||ia;c.exports=
function(a){return D(a,!0,!0)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],37:[function(a,c,b){a="assert count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd time timeEnd trace warn".split(" ");b=a.length;for(var e=function(){},f={};b--;)f[a[b]]=e;c.exports=f},{}],38:[function(a,c,b){function e(a){if(a=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(a)){var b=
parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case "years":case "year":case "y":return b*l;case "days":case "day":case "d":return b*g;case "hours":case "hour":case "h":return 36E5*b;case "minutes":case "minute":case "m":return 6E4*b;case "seconds":case "second":case "s":return 1E3*b;case "ms":return b}}}function f(a,b,c){if(!(a<b))return a<1.5*b?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var g=864E5,l=365.25*g;c.exports=function(a,b){b=b||{};return"string"==typeof a?e(a):b.long?f(a,g,"day")||
f(a,36E5,"hour")||f(a,6E4,"minute")||f(a,1E3,"second")||a+" ms":a>=g?Math.round(a/g)+"d":36E5<=a?Math.round(a/36E5)+"h":6E4<=a?Math.round(a/6E4)+"m":1E3<=a?Math.round(a/1E3)+"s":a+"ms"}},{}],39:[function(a,c,b){var e=Object.prototype.hasOwnProperty;b.keys=Object.keys||function(a){var b=[],c;for(c in a)e.call(a,c)&&b.push(c);return b};b.values=function(a){var b=[],c;for(c in a)e.call(a,c)&&b.push(a[c]);return b};b.merge=function(a,b){for(var c in b)e.call(b,c)&&(a[c]=b[c]);return a};b.length=function(a){return b.keys(a).length};
b.isEmpty=function(a){return 0==b.length(a)}},{}],40:[function(a,c,b){(function(a){var b=/^[\],:{}\s]*$/,e=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,l=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,k=/(?:^|:|,)(?:\s*\[)+/g,n=/^\s+/,m=/\s+$/;c.exports=function(c){if("string"!=typeof c||!c)return null;c=c.replace(n,"").replace(m,"");if(a.JSON&&JSON.parse)return JSON.parse(c);if(b.test(c.replace(e,"@").replace(l,"]").replace(k,"")))return(new Function("return "+c))()}}).call(this,"undefined"!==
typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],41:[function(a,c,b){b.encode=function(a){var b="",c;for(c in a)a.hasOwnProperty(c)&&(b.length&&(b+="&"),b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b};b.decode=function(a){var b={};a=a.split("&");for(var c=0,e=a.length;c<e;c++){var k=a[c].split("=");b[decodeURIComponent(k[0])]=decodeURIComponent(k[1])}return b}},{}],42:[function(a,c,b){var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
f="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");c.exports=function(a){a=e.exec(a||"");for(var b={},c=14;c--;)b[f[c]]=a[c]||"";return b}},{}],43:[function(a,c,b){function e(){throw Error("setTimeout has not been defined");}function f(){throw Error("clearTimeout has not been defined");}function g(a){if(p===setTimeout)return setTimeout(a,0);if((p===e||!p)&&setTimeout)return p=setTimeout,setTimeout(a,0);try{return p(a,0)}catch(A){try{return p.call(null,
a,0)}catch(D){return p.call(this,a,0)}}}function l(a){if(q===clearTimeout)return clearTimeout(a);if((q===f||!q)&&clearTimeout)return q=clearTimeout,clearTimeout(a);try{return q(a)}catch(A){try{return q.call(null,a)}catch(D){return q.call(this,a)}}}function k(){x&&v&&(x=!1,v.length?t=v.concat(t):y=-1,t.length&&n())}function n(){if(!x){var a=g(k);x=!0;for(var b=t.length;b;){v=t;for(t=[];++y<b;)v&&v[y].run();y=-1;b=t.length}v=null;x=!1;l(a)}}function m(a,b){this.fun=a;this.array=b}function r(){}a=c.exports=
{};try{var p="function"===typeof setTimeout?setTimeout:e}catch(z){p=e}try{var q="function"===typeof clearTimeout?clearTimeout:f}catch(z){q=f}var t=[],x=!1,v,y=-1;a.nextTick=function(a){var b=Array(arguments.length-1);if(1<arguments.length)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];t.push(new m(a,b));1!==t.length||x||g(n)};m.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=r;a.addListener=r;a.once=
r;a.off=r;a.removeListener=r;a.removeAllListeners=r;a.emit=r;a.prependListener=r;a.prependOnceListener=r;a.listeners=function(a){return[]};a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},{}],44:[function(a,c,b){function e(a,b){var c=this,e;g.call(this);a=a||{};a.iceServers=a.iceServers||[];this.enableChromeNativeSimulcast=!1;b&&b.optional&&window.chrome&&
null===navigator.appVersion.match(/Chromium\//)&&b.optional.forEach(function(a){a.enableChromeNativeSimulcast&&(c.enableChromeNativeSimulcast=!0)});this.enableMultiStreamHacks=!1;b&&b.optional&&window.chrome&&b.optional.forEach(function(a){a.enableMultiStreamHacks&&(c.enableMultiStreamHacks=!0)});this.restrictBandwidth=0;b&&b.optional&&b.optional.forEach(function(a){a.andyetRestrictBandwidth&&(c.restrictBandwidth=a.andyetRestrictBandwidth)});this.batchIceCandidates=0;b&&b.optional&&b.optional.forEach(function(a){a.andyetBatchIce&&
(c.batchIceCandidates=a.andyetBatchIce)});this.batchedIceCandidates=[];b&&b.optional&&window.chrome&&b.optional.forEach(function(a){a.andyetFasterICE&&(c.eliminateDuplicateCandidates=a.andyetFasterICE)});b&&b.optional&&b.optional.forEach(function(a){a.andyetDontSignalCandidates&&(c.dontSignalCandidates=a.andyetDontSignalCandidates)});this.assumeSetLocalSuccess=!1;b&&b.optional&&b.optional.forEach(function(a){a.andyetAssumeSetLocalSuccess&&(c.assumeSetLocalSuccess=a.andyetAssumeSetLocalSuccess)});
window.navigator.mozGetUserMedia&&b&&b.optional&&(this.wtFirefox=0,b.optional.forEach(function(a){a.andyetFirefoxMakesMeSad&&(c.wtFirefox=a.andyetFirefoxMakesMeSad,0<c.wtFirefox&&(c.firefoxcandidatebuffer=[]))}));this.pc=new RTCPeerConnection(a,b);this.getLocalStreams="function"===typeof this.pc.getLocalStreams?this.pc.getLocalStreams.bind(this.pc):function(){return[]};this.getSenders="function"===typeof this.pc.getSenders?this.pc.getSenders.bind(this.pc):function(){return[]};this.getRemoteStreams=
"function"===typeof this.pc.getRemoteStreams?this.pc.getRemoteStreams.bind(this.pc):function(){return[]};this.getReceivers="function"===typeof this.pc.getReceivers?this.pc.getReceivers.bind(this.pc):function(){return[]};this.addStream=this.pc.addStream.bind(this.pc);this.removeStream=function(a){"function"===typeof c.pc.removeStream?c.pc.removeStream.apply(c.pc,arguments):"function"===typeof c.pc.removeTrack&&a.getTracks().forEach(function(a){c.pc.removeTrack(a)})};"function"===typeof this.pc.removeTrack&&
(this.removeTrack=this.pc.removeTrack.bind(this.pc));this.pc.onremovestream=this.emit.bind(this,"removeStream");this.pc.onremovetrack=this.emit.bind(this,"removeTrack");this.pc.onaddstream=this.emit.bind(this,"addStream");this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded");this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange");this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange");this.pc.onicecandidate=this._onIce.bind(this);this.pc.ondatachannel=
this._onDataChannel.bind(this);this.localDescription={contents:[]};this.remoteDescription={contents:[]};this.config={debug:!1,sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1};this.iceCredentials={local:{},remote:{}};for(e in a)this.config[e]=a[e];if(this.config.debug)this.on("*",function(){(a.logger||console).log("PeerConnection event:",arguments)});this.hadRemoteIPv6Candidate=this.hadLocalIPv6Candidate=this.hadRemoteRelayCandidate=this.hadLocalRelayCandidate=this.hadRemoteStunCandidate=
this.hadLocalStunCandidate=!1;this._remoteDataChannels=[];this._localDataChannels=[];this._candidateBuffer=[]}b=a("util");var f=a("sdp-jingle-json"),g=a("wildemitter"),l=a("lodash.clonedeep");b.inherits(e,g);Object.defineProperty(e.prototype,"signalingState",{get:function(){return this.pc.signalingState}});Object.defineProperty(e.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}});e.prototype._role=function(){return this.isInitiator?"initiator":"responder"};e.prototype.addStream=
function(a){this.localStream=a;this.pc.addStream(a)};e.prototype._checkLocalCandidate=function(a){a=f.toCandidateJSON(a);"srflx"==a.type?this.hadLocalStunCandidate=!0:"relay"==a.type&&(this.hadLocalRelayCandidate=!0);-1!=a.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)};e.prototype._checkRemoteCandidate=function(a){a=f.toCandidateJSON(a);"srflx"==a.type?this.hadRemoteStunCandidate=!0:"relay"==a.type&&(this.hadRemoteRelayCandidate=!0);-1!=a.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)};e.prototype.processIce=
function(a,b){b=b||function(){};var c=this;if("closed"===this.pc.signalingState)return b();if(a.contents||a.jingle&&a.jingle.contents){var e=this.remoteDescription.contents.map(function(a){return a.name});(a.contents||a.jingle.contents).forEach(function(a){var g=a.transport||{},k=g.candidates||[],m=e.indexOf(a.name),l=a.name,n=c.remoteDescription.contents.find(function(b){return b.name===a.name}),r=function(){k.forEach(function(a){a=f.toCandidateSDP(a);c.pc.addIceCandidate(new RTCIceCandidate({candidate:a,
sdpMLineIndex:m,sdpMid:l}),function(){},function(a){c.emit("error",a)});c._checkRemoteCandidate(a)});b()};c.iceCredentials.remote[a.name]&&g.ufrag&&c.iceCredentials.remote[a.name].ufrag!==g.ufrag?n?(n.transport.ufrag=g.ufrag,n.transport.pwd=g.pwd,g={type:"offer",jingle:c.remoteDescription},g.sdp=f.toSessionSDP(g.jingle,{sid:c.config.sdpSessionID,role:c._role(),direction:"incoming"}),c.pc.setRemoteDescription(new RTCSessionDescription(g),function(){r()},function(a){c.emit("error",a)})):c.emit("error",
"ice restart failed to find matching content"):r()})}else{a.candidate&&0!==a.candidate.candidate.indexOf("a=")&&(a.candidate.candidate="a="+a.candidate.candidate);if(this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(a.candidate),b();c.pc.addIceCandidate(new RTCIceCandidate(a.candidate),function(){},function(a){c.emit("error",a)});c._checkRemoteCandidate(a.candidate.candidate);b()}};e.prototype.offer=
function(a,b){var c=this,e=2===arguments.length,g=e&&a?a:{offerToReceiveAudio:1,offerToReceiveVideo:1};b=(b=e?b:a)||function(){};if("closed"===this.pc.signalingState)return b("Already closed");this.pc.createOffer(function(a){var e={type:"offer",sdp:a.sdp};c.assumeSetLocalSuccess&&(c.emit("offer",e),b(null,e));c._candidateBuffer=[];c.pc.setLocalDescription(a,function(){if(c.config.useJingle){var g=f.toSessionJSON(a.sdp,{role:c._role(),direction:"outgoing"});g.sid=c.config.sid;c.localDescription=g;
g.contents.forEach(function(a){var b=a.transport||{};b.ufrag&&(c.iceCredentials.local[a.name]={ufrag:b.ufrag,pwd:b.pwd})});e.jingle=g}e.sdp.split("\r\n").forEach(function(a){0===a.indexOf("a=candidate:")&&c._checkLocalCandidate(a)});c.assumeSetLocalSuccess||(c.emit("offer",e),b(null,e))},function(a){c.emit("error",a);b(a)})},function(a){c.emit("error",a);b(a)},g)};e.prototype.handleOffer=function(a,b){b=b||function(){};var c=this;a.type="offer";if(a.jingle){this.enableChromeNativeSimulcast&&a.jingle.contents.forEach(function(a){"video"===
a.name&&(a.application.googConferenceFlag=!0)});this.enableMultiStreamHacks&&a.jingle.contents.forEach(function(a){if("video"===a.name){var b=a.application.sources||[];if(0===b.length||"3735928559"!==b[0].ssrc)b.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),a.application.sources=b}});if(0<c.restrictBandwidth&&2<=a.jingle.contents.length&&"video"===a.jingle.contents[1].name){var e=a.jingle.contents[1];e.application&&e.application.bandwidth&&
e.application.bandwidth.bandwidth||(a.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:c.restrictBandwidth.toString()},a.sdp=f.toSessionSDP(a.jingle,{sid:c.config.sdpSessionID,role:c._role(),direction:"outgoing"}))}a.jingle.contents.forEach(function(a){var b=a.transport||{};b.ufrag&&(c.iceCredentials.remote[a.name]={ufrag:b.ufrag,pwd:b.pwd})});a.sdp=f.toSessionSDP(a.jingle,{sid:c.config.sdpSessionID,role:c._role(),direction:"incoming"});c.remoteDescription=a.jingle}a.sdp.split("\r\n").forEach(function(a){0===
a.indexOf("a=candidate:")&&c._checkRemoteCandidate(a)});c.pc.setRemoteDescription(new RTCSessionDescription(a),function(){b()},b)};e.prototype.answerAudioOnly=function(a){this._answer({mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},a)};e.prototype.answerBroadcastOnly=function(a){this._answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},a)};e.prototype.answer=function(a,b){var c=2===arguments.length;this._answer(c&&a?a:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},
c?b:a)};e.prototype.handleAnswer=function(a,b){b=b||function(){};var c=this;a.jingle&&(a.sdp=f.toSessionSDP(a.jingle,{sid:c.config.sdpSessionID,role:c._role(),direction:"incoming"}),c.remoteDescription=a.jingle,a.jingle.contents.forEach(function(a){var b=a.transport||{};b.ufrag&&(c.iceCredentials.remote[a.name]={ufrag:b.ufrag,pwd:b.pwd})}));a.sdp.split("\r\n").forEach(function(a){0===a.indexOf("a=candidate:")&&c._checkRemoteCandidate(a)});c.pc.setRemoteDescription(new RTCSessionDescription(a),function(){c.wtFirefox&&
window.setTimeout(function(){c.firefoxcandidatebuffer.forEach(function(a){c.pc.addIceCandidate(new RTCIceCandidate(a),function(){},function(a){c.emit("error",a)});c._checkRemoteCandidate(a.candidate)});c.firefoxcandidatebuffer=null},c.wtFirefox);b(null)},b)};e.prototype.close=function(){this.pc.close();this._localDataChannels=[];this._remoteDataChannels=[];this.emit("close")};e.prototype._answer=function(a,b){b=b||function(){};var c=this;if(!this.pc.remoteDescription)throw Error("remoteDescription not set");
if("closed"===this.pc.signalingState)return b("Already closed");c.pc.createAnswer(function(a){var e=[];if(c.enableChromeNativeSimulcast&&(a.jingle=f.toSessionJSON(a.sdp,{role:c._role(),direction:"outgoing"}),2<=a.jingle.contents.length&&"video"===a.jingle.contents[1].name)){var g=a.jingle.contents[1].application.sourceGroups||[],k=!1;g.forEach(function(a){"SIM"==a.semantics&&(k=!0)});if(!k&&a.jingle.contents[1].application.sources.length){var m=JSON.parse(JSON.stringify(a.jingle.contents[1].application.sources[0]));
m.ssrc=""+Math.floor(4294967295*Math.random());a.jingle.contents[1].application.sources.push(m);e.push(a.jingle.contents[1].application.sources[0].ssrc);e.push(m.ssrc);g.push({semantics:"SIM",sources:e});e=JSON.parse(JSON.stringify(m));e.ssrc=""+Math.floor(4294967295*Math.random());a.jingle.contents[1].application.sources.push(e);g.push({semantics:"FID",sources:[m.ssrc,e.ssrc]});a.jingle.contents[1].application.sourceGroups=g;a.sdp=f.toSessionSDP(a.jingle,{sid:c.config.sdpSessionID,role:c._role(),
direction:"outgoing"})}}var n={type:"answer",sdp:a.sdp};c.assumeSetLocalSuccess&&(g=l(n),c.emit("answer",g),b(null,g));c._candidateBuffer=[];c.pc.setLocalDescription(a,function(){if(c.config.useJingle){var e=f.toSessionJSON(a.sdp,{role:c._role(),direction:"outgoing"});e.sid=c.config.sid;c.localDescription=e;n.jingle=e}c.enableChromeNativeSimulcast&&(n.jingle||(n.jingle=f.toSessionJSON(a.sdp,{role:c._role(),direction:"outgoing"})),n.jingle.contents[1].application.sources.forEach(function(a,b){a.parameters=
a.parameters.map(function(a){"msid"===a.key&&(a.value+="-"+Math.floor(b/2));return a})}),n.sdp=f.toSessionSDP(n.jingle,{sid:c.sdpSessionID,role:c._role(),direction:"outgoing"}));n.sdp.split("\r\n").forEach(function(a){0===a.indexOf("a=candidate:")&&c._checkLocalCandidate(a)});c.assumeSetLocalSuccess||(e=l(n),c.emit("answer",e),b(null,e))},function(a){c.emit("error",a);b(a)})},function(a){c.emit("error",a);b(a)},a)};e.prototype._onIce=function(a){var b=this;if(a.candidate){if(!this.dontSignalCandidates){a=
a.candidate;var c={candidate:{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex}};this._checkLocalCandidate(a.candidate);var e=f.toCandidateJSON(a.candidate);if(this.eliminateDuplicateCandidates&&"relay"===e.type){var g=this._candidateBuffer.filter(function(a){return"relay"===a.type}).map(function(a){return a.foundation+":"+a.component});var k=g.indexOf(e.foundation+":"+e.component);if(-1<k&&e.priority>>24>=g[k].priority>>24)return}if("max-bundle"===this.config.bundlePolicy&&(g=
this._candidateBuffer.filter(function(a){return e.type===a.type}).map(function(a){return a.address+":"+a.port}),k=g.indexOf(e.address+":"+e.port),-1<k))return;if("require"!==this.config.rtcpMuxPolicy||"2"!==e.component){this._candidateBuffer.push(e);if(b.config.useJingle&&(a.sdpMid||(a.sdpMid=b.pc.remoteDescription&&"offer"===b.pc.remoteDescription.type?b.remoteDescription.contents[a.sdpMLineIndex].name:b.localDescription.contents[a.sdpMLineIndex].name),b.iceCredentials.local[a.sdpMid]||f.toSessionJSON(b.pc.localDescription.sdp,
{role:b._role(),direction:"outgoing"}).contents.forEach(function(a){var c=a.transport||{};c.ufrag&&(b.iceCredentials.local[a.name]={ufrag:c.ufrag,pwd:c.pwd})}),c.jingle={contents:[{name:a.sdpMid,creator:b._role(),transport:{transportType:"iceUdp",ufrag:b.iceCredentials.local[a.sdpMid].ufrag,pwd:b.iceCredentials.local[a.sdpMid].pwd,candidates:[e]}}]},0<b.batchIceCandidates)){0===b.batchedIceCandidates.length&&window.setTimeout(function(){var a={};b.batchedIceCandidates.forEach(function(b){b=b.contents[0];
a[b.name]||(a[b.name]=b);a[b.name].transport.candidates.push(b.transport.candidates[0])});var c={jingle:{contents:[]}};Object.keys(a).forEach(function(b){c.jingle.contents.push(a[b])});b.batchedIceCandidates=[];b.emit("ice",c)},b.batchIceCandidates);b.batchedIceCandidates.push(c.jingle);return}this.emit("ice",c)}}}else this.emit("endOfCandidates")};e.prototype._onDataChannel=function(a){a=a.channel;this._remoteDataChannels.push(a);this.emit("addChannel",a)};e.prototype.createDataChannel=function(a,
b){a=this.pc.createDataChannel(a,b);this._localDataChannels.push(a);return a};e.prototype.getStats=function(){if("function"===typeof arguments[0]){var a=arguments[0];this.pc.getStats().then(function(b){a(null,b)},function(b){a(b)})}else return this.pc.getStats.apply(this.pc,arguments)};c.exports=e},{"lodash.clonedeep":36,"sdp-jingle-json":45,util:63,wildemitter:65}],45:[function(a,c,b){var e=a("./lib/tosdp"),f=a("./lib/tojson");b.toIncomingSDPOffer=function(a){return e.toSessionSDP(a,{role:"responder",
direction:"incoming"})};b.toOutgoingSDPOffer=function(a){return e.toSessionSDP(a,{role:"initiator",direction:"outgoing"})};b.toIncomingSDPAnswer=function(a){return e.toSessionSDP(a,{role:"initiator",direction:"incoming"})};b.toOutgoingSDPAnswer=function(a){return e.toSessionSDP(a,{role:"responder",direction:"outgoing"})};b.toIncomingMediaSDPOffer=function(a){return e.toMediaSDP(a,{role:"responder",direction:"incoming"})};b.toOutgoingMediaSDPOffer=function(a){return e.toMediaSDP(a,{role:"initiator",
direction:"outgoing"})};b.toIncomingMediaSDPAnswer=function(a){return e.toMediaSDP(a,{role:"initiator",direction:"incoming"})};b.toOutgoingMediaSDPAnswer=function(a){return e.toMediaSDP(a,{role:"responder",direction:"outgoing"})};b.toCandidateSDP=e.toCandidateSDP;b.toMediaSDP=e.toMediaSDP;b.toSessionSDP=e.toSessionSDP;b.toIncomingJSONOffer=function(a,b){return f.toSessionJSON(a,{role:"responder",direction:"incoming",creators:b})};b.toOutgoingJSONOffer=function(a,b){return f.toSessionJSON(a,{role:"initiator",
direction:"outgoing",creators:b})};b.toIncomingJSONAnswer=function(a,b){return f.toSessionJSON(a,{role:"initiator",direction:"incoming",creators:b})};b.toOutgoingJSONAnswer=function(a,b){return f.toSessionJSON(a,{role:"responder",direction:"outgoing",creators:b})};b.toIncomingMediaJSONOffer=function(a,b){return f.toMediaJSON(a,{role:"responder",direction:"incoming",creator:b})};b.toOutgoingMediaJSONOffer=function(a,b){return f.toMediaJSON(a,{role:"initiator",direction:"outgoing",creator:b})};b.toIncomingMediaJSONAnswer=
function(a,b){return f.toMediaJSON(a,{role:"initiator",direction:"incoming",creator:b})};b.toOutgoingMediaJSONAnswer=function(a,b){return f.toMediaJSON(a,{role:"responder",direction:"outgoing",creator:b})};b.toCandidateJSON=f.toCandidateJSON;b.toMediaJSON=f.toMediaJSON;b.toSessionJSON=f.toSessionJSON},{"./lib/tojson":48,"./lib/tosdp":49}],46:[function(a,c,b){b.lines=function(a){return a.split("\r\n").filter(function(a){return 0<a.length})};b.findLine=function(a,b,c){for(var e=a.length,f=0;f<b.length;f++)if(b[f].substr(0,
e)===a)return b[f];if(!c)return!1;for(b=0;b<c.length;b++)if(c[b].substr(0,e)===a)return c[b];return!1};b.findLines=function(a,b,c){for(var e=[],f=a.length,g=0;g<b.length;g++)b[g].substr(0,f)===a&&e.push(b[g]);if(e.length||!c)return e;for(b=0;b<c.length;b++)c[b].substr(0,f)===a&&e.push(c[b]);return e};b.mline=function(a){a=a.substr(2).split(" ");for(var b={media:a[0],port:a[1],proto:a[2],formats:[]},c=3;c<a.length;c++)a[c]&&b.formats.push(a[c]);return b};b.rtpmap=function(a){a=a.substr(9).split(" ");
var b={id:a.shift()};a=a[0].split("/");b.name=a[0];b.clockrate=a[1];b.channels=3==a.length?a[2]:"1";return b};b.sctpmap=function(a){a=a.substr(10).split(" ");return{number:a.shift(),protocol:a.shift(),streams:a.shift()}};b.fmtp=function(a){for(var b,c=a.substr(a.indexOf(" ")+1).split(";"),e=[],k=0;k<c.length;k++)b=c[k].split("="),a=b[0].trim(),b=b[1],a&&b?e.push({key:a,value:b}):a&&e.push({key:"",value:a});return e};b.crypto=function(a){a=a.substr(9).split(" ");return{tag:a[0],cipherSuite:a[1],keyParams:a[2],
sessionParams:a.slice(3).join(" ")}};b.fingerprint=function(a){a=a.substr(14).split(" ");return{hash:a[0],value:a[1]}};b.extmap=function(a){a=a.substr(9).split(" ");var b={},c=a.shift(),e=c.indexOf("/");0<=e?(b.id=c.substr(0,e),b.senders=c.substr(e+1)):(b.id=c,b.senders="sendrecv");b.uri=a.shift()||"";return b};b.rtcpfb=function(a){a=a.substr(10).split(" ");var b={};b.id=a.shift();b.type=a.shift();"trr-int"===b.type?b.value=a.shift():b.subtype=a.shift()||"";b.parameters=a;return b};b.candidate=function(a){a=
0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var b={foundation:a[0],component:a[1],protocol:a[2].toLowerCase(),priority:a[3],ip:a[4],port:a[5],type:a[7],generation:"0"},c=8;c<a.length;c+=2)"raddr"===a[c]?b.relAddr=a[c+1]:"rport"===a[c]?b.relPort=a[c+1]:"generation"===a[c]?b.generation=a[c+1]:"tcptype"===a[c]&&(b.tcpType=a[c+1]);b.network="1";return b};b.sourceGroups=function(a){for(var b=[],c=0;c<a.length;c++){var e=a[c].substr(13).split(" ");b.push({semantics:e.shift(),
sources:e})}return b};b.sources=function(a){for(var b=[],c={},e=0;e<a.length;e++){var k=a[e].substr(7).split(" "),n=k.shift();if(!c[n]){var m={ssrc:n,parameters:[]};b.push(m);c[n]=m}k=k.join(" ").split(":");m=k.shift();k=k.join(":")||null;c[n].parameters.push({key:m,value:k})}return b};b.groups=function(a){for(var b=[],c,e=0;e<a.length;e++)c=a[e].substr(8).split(" "),b.push({semantics:c.shift(),contents:c});return b};b.bandwidth=function(a){a=a.substr(2).split(":");var b={};b.type=a.shift();b.bandwidth=
a.shift();return b};b.msid=function(a){a=a.substr(7);var b=a.split(" ");return{msid:a,mslabel:b[0],label:b[1]}}},{}],47:[function(a,c,b){c.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",
responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],48:[function(a,c,b){var e=a("./senders"),f=a("./parsers"),g=Math.random();b._setIdCounter=function(a){g=a};b.toSessionJSON=function(a,c){var e,g=c.creators||[],k=c.role||"initiator";c=c.direction||"outgoing";
var l=a.split("\r\nm=");for(e=1;e<l.length;e++)l[e]="m="+l[e],e!==l.length-1&&(l[e]+="\r\n");var q=l.shift()+"\r\n",t=f.lines(q);a={};var x=[];for(e=0;e<l.length;e++)x.push(b.toMediaJSON(l[e],q,{role:k,direction:c,creator:g[e]||"initiator"}));a.contents=x;g=f.findLines("a=group:",t);g.length&&(a.groups=f.groups(g));return a};b.toMediaJSON=function(a,c,g){var k=g.creator||"initiator",l=g.role||"initiator",p=g.direction||"outgoing",q=f.lines(a);a=f.lines(c);c=f.mline(q[0]);k={creator:k,name:c.media,
application:{applicationType:"rtp",media:c.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==c.media&&(k.application={applicationType:"datachannel"},k.transport.sctp=[]);var n=k.application,x=k.transport;if(c=f.findLine("a=mid:",q))k.name=c.substr(6);f.findLine("a=sendrecv",q,a)?k.senders="both":f.findLine("a=sendonly",q,a)?k.senders=e[l][p].sendonly:f.findLine("a=recvonly",q,a)?k.senders=e[l][p].recvonly:
f.findLine("a=inactive",q,a)&&(k.senders="none");if("rtp"==n.applicationType){if(c=f.findLine("b=",q))n.bandwidth=f.bandwidth(c);if(c=f.findLine("a=ssrc:",q))n.ssrc=c.substr(7).split(" ")[0];f.findLines("a=rtpmap:",q).forEach(function(a){var b=f.rtpmap(a);b.parameters=[];b.feedback=[];f.findLines("a=fmtp:"+b.id,q).forEach(function(a){b.parameters=f.fmtp(a)});f.findLines("a=rtcp-fb:"+b.id,q).forEach(function(a){b.feedback.push(f.rtcpfb(a))});n.payloads.push(b)});f.findLines("a=crypto:",q,a).forEach(function(a){n.encryption.push(f.crypto(a))});
f.findLine("a=rtcp-mux",q)&&(n.mux=!0);f.findLines("a=rtcp-fb:*",q).forEach(function(a){n.feedback.push(f.rtcpfb(a))});f.findLines("a=extmap:",q).forEach(function(a){a=f.extmap(a);a.senders=e[l][p][a.senders];n.headerExtensions.push(a)});c=f.findLines("a=ssrc-group:",q);n.sourceGroups=f.sourceGroups(c||[]);c=f.findLines("a=ssrc:",q);var v=n.sources=f.sources(c||[]);if(c=f.findLine("a=msid:",q)){var y=f.msid(c);["msid","mslabel","label"].forEach(function(a){for(var b=0;b<v.length;b++){for(var c=!1,
e=0;e<v[b].parameters.length;e++)v[b].parameters[e].key===a&&(c=!0);c||v[b].parameters.push({key:a,value:y[a]})}})}f.findLine("a=x-google-flag:conference",q,a)&&(n.googConferenceFlag=!0)}c=f.findLines("a=fingerprint:",q,a);var z=f.findLine("a=setup:",q,a);c.forEach(function(a){a=f.fingerprint(a);z&&(a.setup=z.substr(8));x.fingerprints.push(a)});c=f.findLine("a=ice-ufrag:",q,a);g=f.findLine("a=ice-pwd:",q,a);c&&g&&(x.ufrag=c.substr(12),x.pwd=g.substr(10),x.candidates=[],f.findLines("a=candidate:",
q,a).forEach(function(a){x.candidates.push(b.toCandidateJSON(a))}));"datachannel"==n.applicationType&&f.findLines("a=sctpmap:",q).forEach(function(a){a=f.sctpmap(a);x.sctp.push(a)});return k};b.toCandidateJSON=function(a){a=f.candidate(a.split("\r\n")[0]);a.id=(g++).toString(36).substr(0,12);return a}},{"./parsers":46,"./senders":47}],49:[function(a,c,b){var e=a("./senders");b.toSessionSDP=function(a,c){var e=c.sid||a.sid||Date.now(),f=c.time||Date.now(),g=["v=0","o=- "+e+" "+f+" IN IP4 0.0.0.0",
"s=-","t=0 0"];e=a.contents||[];var m=!1;e.forEach(function(a){a.application.sources&&a.application.sources.length&&(m=!0)});m&&g.push("a=msid-semantic: WMS *");(a.groups||[]).forEach(function(a){g.push("a=group:"+a.semantics+" "+a.contents.join(" "))});e.forEach(function(a){g.push(b.toMediaSDP(a,c))});return g.join("\r\n")+"\r\n"};b.toMediaSDP=function(a,c){var f=[],g=c.role||"initiator",n=c.direction||"outgoing",m=a.application;c=a.transport;var r=m.payloads||[],p=c&&c.fingerprints||[],q=[];"datachannel"==
m.applicationType?(q.push("application"),q.push("1"),q.push("DTLS/SCTP"),c.sctp&&c.sctp.forEach(function(a){q.push(a.number)})):(q.push(m.media),q.push("1"),0<p.length?q.push("UDP/TLS/RTP/SAVPF"):m.encryption&&0<m.encryption.length?q.push("RTP/SAVPF"):q.push("RTP/AVPF"),r.forEach(function(a){q.push(a.id)}));f.push("m="+q.join(" "));f.push("c=IN IP4 0.0.0.0");m.bandwidth&&m.bandwidth.type&&m.bandwidth.bandwidth&&f.push("b="+m.bandwidth.type+":"+m.bandwidth.bandwidth);"rtp"==m.applicationType&&f.push("a=rtcp:1 IN IP4 0.0.0.0");
c&&(c.ufrag&&f.push("a=ice-ufrag:"+c.ufrag),c.pwd&&f.push("a=ice-pwd:"+c.pwd),p.forEach(function(a){f.push("a=fingerprint:"+a.hash+" "+a.value);a.setup&&f.push("a=setup:"+a.setup)}),c.sctp&&c.sctp.forEach(function(a){f.push("a=sctpmap:"+a.number+" "+a.protocol+" "+a.streams)}));"rtp"==m.applicationType&&f.push("a="+(e[g][n][a.senders]||"sendrecv"));f.push("a=mid:"+a.name);m.sources&&m.sources.length&&(m.sources[0].parameters||[]).forEach(function(a){"msid"===a.key&&f.push("a=msid:"+a.value)});m.mux&&
f.push("a=rtcp-mux");(m.encryption||[]).forEach(function(a){f.push("a=crypto:"+a.tag+" "+a.cipherSuite+" "+a.keyParams+(a.sessionParams?" "+a.sessionParams:""))});m.googConferenceFlag&&f.push("a=x-google-flag:conference");r.forEach(function(a){var b="a=rtpmap:"+a.id+" "+a.name+"/"+a.clockrate;a.channels&&"1"!=a.channels&&(b+="/"+a.channels);f.push(b);if(a.parameters&&a.parameters.length){b=["a=fmtp:"+a.id];var c=[];a.parameters.forEach(function(a){c.push((a.key?a.key+"=":"")+a.value)});b.push(c.join(";"));
f.push(b.join(" "))}a.feedback&&a.feedback.forEach(function(b){"trr-int"===b.type?f.push("a=rtcp-fb:"+a.id+" trr-int "+(b.value?b.value:"0")):f.push("a=rtcp-fb:"+a.id+" "+b.type+(b.subtype?" "+b.subtype:""))})});m.feedback&&m.feedback.forEach(function(a){"trr-int"===a.type?f.push("a=rtcp-fb:* trr-int "+(a.value?a.value:"0")):f.push("a=rtcp-fb:* "+a.type+(a.subtype?" "+a.subtype:""))});(m.headerExtensions||[]).forEach(function(a){f.push("a=extmap:"+a.id+(a.senders?"/"+e[g][n][a.senders]:"")+" "+a.uri)});
(m.sourceGroups||[]).forEach(function(a){f.push("a=ssrc-group:"+a.semantics+" "+a.sources.join(" "))});(m.sources||[]).forEach(function(a){for(var b=0;b<a.parameters.length;b++){var c=a.parameters[b];f.push("a=ssrc:"+(a.ssrc||m.ssrc)+" "+c.key+(c.value?":"+c.value:""))}});(c.candidates||[]).forEach(function(a){f.push(b.toCandidateSDP(a))});return f.join("\r\n")};b.toCandidateSDP=function(a){var b=[];b.push(a.foundation);b.push(a.component);b.push(a.protocol.toUpperCase());b.push(a.priority);b.push(a.ip);
b.push(a.port);var c=a.type;b.push("typ");b.push(c);("srflx"===c||"prflx"===c||"relay"===c)&&a.relAddr&&a.relPort&&(b.push("raddr"),b.push(a.relAddr),b.push("rport"),b.push(a.relPort));a.tcpType&&"TCP"==a.protocol.toUpperCase()&&(b.push("tcptype"),b.push(a.tcpType));b.push("generation");b.push(a.generation||"0");return"a=candidate:"+b.join(" ")}},{"./senders":47}],50:[function(a,c,b){c.exports=a("./lib/")},{"./lib/":51}],51:[function(a,c,b){function e(a,b){"object"==typeof a&&(b=a,a=void 0);b=b||
{};a=f(a);var c=a.source,e=a.id;b.forceNew||b["force new connection"]||!1===b.multiplex?(k("ignoring socket cache for %s",c),b=l(c,b)):(n[e]||(k("new io instance for %s",c),n[e]=l(c,b)),b=n[e]);return b.socket(a.path)}var f=a("./url"),g=a("socket.io-parser"),l=a("./manager"),k=a("debug")("socket.io-client");c.exports=b=e;var n=b.managers={};b.protocol=g.protocol;b.connect=e;b.Manager=a("./manager");b.Socket=a("./socket")},{"./manager":52,"./socket":54,"./url":55,debug:10,"socket.io-parser":57}],52:[function(a,
c,b){function e(a,b){if(!(this instanceof e))return new e(a,b);a&&"object"==typeof a&&(b=a,a=void 0);b=b||{};b.path=b.path||"/socket.io";this.nsps={};this.subs=[];this.opts=b;this.reconnection(!1!==b.reconnection);this.reconnectionAttempts(b.reconnectionAttempts||Infinity);this.reconnectionDelay(b.reconnectionDelay||1E3);this.reconnectionDelayMax(b.reconnectionDelayMax||5E3);this.randomizationFactor(b.randomizationFactor||.5);this.backoff=new p({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),
jitter:this.randomizationFactor()});this.timeout(null==b.timeout?2E4:b.timeout);this.readyState="closed";this.uri=a;this.connected=[];this.encoding=!1;this.packetBuffer=[];this.encoder=new l.Encoder;this.decoder=new l.Decoder;(this.autoConnect=!1!==b.autoConnect)&&this.open()}a("./url");var f=a("engine.io-client"),g=a("./socket");b=a("component-emitter");var l=a("socket.io-parser"),k=a("./on"),n=a("component-bind");a("object-component");var m=a("debug")("socket.io-client:manager"),r=a("indexof"),
p=a("backo2");c.exports=e;e.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var a in this.nsps)this.nsps[a].emit.apply(this.nsps[a],arguments)};e.prototype.updateSocketIds=function(){for(var a in this.nsps)this.nsps[a].id=this.engine.id};b(e.prototype);e.prototype.reconnection=function(a){if(!arguments.length)return this._reconnection;this._reconnection=!!a;return this};e.prototype.reconnectionAttempts=function(a){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=
a;return this};e.prototype.reconnectionDelay=function(a){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=a;this.backoff&&this.backoff.setMin(a);return this};e.prototype.randomizationFactor=function(a){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=a;this.backoff&&this.backoff.setJitter(a);return this};e.prototype.reconnectionDelayMax=function(a){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=a;this.backoff&&
this.backoff.setMax(a);return this};e.prototype.timeout=function(a){if(!arguments.length)return this._timeout;this._timeout=a;return this};e.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};e.prototype.open=e.prototype.connect=function(a){m("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;m("opening %s",this.uri);var b=this.engine=f(this.uri,this.opts),c=this;this.readyState="opening";this.skipReconnect=
!1;var e=k(b,"open",function(){c.onopen();a&&a()}),g=k(b,"error",function(b){m("connect_error");c.cleanup();c.readyState="closed";c.emitAll("connect_error",b);if(a){var e=Error("Connection error");e.data=b;a(e)}else c.maybeReconnectOnOpen()});if(!1!==this._timeout){var q=this._timeout;m("connect attempt will timeout after %d",q);var l=setTimeout(function(){m("connect attempt timed out after %d",q);e.destroy();b.close();b.emit("error","timeout");c.emitAll("connect_timeout",q)},q);this.subs.push({destroy:function(){clearTimeout(l)}})}this.subs.push(e);
this.subs.push(g);return this};e.prototype.onopen=function(){m("open");this.cleanup();this.readyState="open";this.emit("open");var a=this.engine;this.subs.push(k(a,"data",n(this,"ondata")));this.subs.push(k(this.decoder,"decoded",n(this,"ondecoded")));this.subs.push(k(a,"error",n(this,"onerror")));this.subs.push(k(a,"close",n(this,"onclose")))};e.prototype.ondata=function(a){this.decoder.add(a)};e.prototype.ondecoded=function(a){this.emit("packet",a)};e.prototype.onerror=function(a){m("error",a);
this.emitAll("error",a)};e.prototype.socket=function(a){var b=this.nsps[a];if(!b){b=new g(this,a);this.nsps[a]=b;var c=this;b.on("connect",function(){b.id=c.engine.id;~r(c.connected,b)||c.connected.push(b)})}return b};e.prototype.destroy=function(a){a=r(this.connected,a);~a&&this.connected.splice(a,1);this.connected.length||this.close()};e.prototype.packet=function(a){m("writing packet %j",a);var b=this;b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(a){for(var c=0;c<
a.length;c++)b.engine.write(a[c]);b.encoding=!1;b.processPacketQueue()}))};e.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}};e.prototype.cleanup=function(){for(var a;a=this.subs.shift();)a.destroy();this.packetBuffer=[];this.encoding=!1;this.decoder.destroy()};e.prototype.close=e.prototype.disconnect=function(){this.skipReconnect=!0;this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};
e.prototype.onclose=function(a){m("close");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",a);this._reconnection&&!this.skipReconnect&&this.reconnect()};e.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)m("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();m("will wait %dms before reconnect attempt",
b);this.reconnecting=!0;var c=setTimeout(function(){a.skipReconnect||(m("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(b){b?(m("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(m("reconnect success"),a.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(c)}})}};e.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=
!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",a)}},{"./on":53,"./socket":54,"./url":55,backo2:4,"component-bind":7,"component-emitter":8,debug:10,"engine.io-client":11,indexof:32,"object-component":39,"socket.io-parser":57}],53:[function(a,c,b){c.exports=function(a,b,c){a.on(b,c);return{destroy:function(){a.removeListener(b,c)}}}},{}],54:[function(a,c,b){function e(a,b){this.io=a;this.nsp=b;this.json=this;this.ids=0;this.acks={};this.io.autoConnect&&this.open();this.receiveBuffer=
[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0}var f=a("socket.io-parser");b=a("component-emitter");var g=a("to-array"),l=a("./on"),k=a("component-bind"),n=a("debug")("socket.io-client:socket"),m=a("has-binary");c.exports=e;var r={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},p=b.prototype.emit;b(e.prototype);e.prototype.subEvents=function(){if(!this.subs){var a=this.io;this.subs=
[l(a,"open",k(this,"onopen")),l(a,"packet",k(this,"onpacket")),l(a,"close",k(this,"onclose"))]}};e.prototype.open=e.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==this.io.readyState)this.onopen();return this};e.prototype.send=function(){var a=g(arguments);a.unshift("message");this.emit.apply(this,a);return this};e.prototype.emit=function(a){if(r.hasOwnProperty(a))return p.apply(this,arguments),this;var b=g(arguments),c=f.EVENT;m(b)&&(c=f.BINARY_EVENT);
c={type:c,data:b};"function"==typeof b[b.length-1]&&(n("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),c.id=this.ids++);this.connected?this.packet(c):this.sendBuffer.push(c);return this};e.prototype.packet=function(a){a.nsp=this.nsp;this.io.packet(a)};e.prototype.onopen=function(){n("transport is open - connecting");"/"!=this.nsp&&this.packet({type:f.CONNECT})};e.prototype.onclose=function(a){n("close (%s)",a);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",
a)};e.prototype.onpacket=function(a){if(a.nsp==this.nsp)switch(a.type){case f.CONNECT:this.onconnect();break;case f.EVENT:this.onevent(a);break;case f.BINARY_EVENT:this.onevent(a);break;case f.ACK:this.onack(a);break;case f.BINARY_ACK:this.onack(a);break;case f.DISCONNECT:this.ondisconnect();break;case f.ERROR:this.emit("error",a.data)}};e.prototype.onevent=function(a){var b=a.data||[];n("emitting event %j",b);null!=a.id&&(n("attaching ack callback to event"),b.push(this.ack(a.id)));this.connected?
p.apply(this,b):this.receiveBuffer.push(b)};e.prototype.ack=function(a){var b=this,c=!1;return function(){if(!c){c=!0;var e=g(arguments);n("sending ack %j",e);var k=m(e)?f.BINARY_ACK:f.ACK;b.packet({type:k,id:a,data:e})}}};e.prototype.onack=function(a){n("calling ack %s with %j",a.id,a.data);this.acks[a.id].apply(this,a.data);delete this.acks[a.id]};e.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};e.prototype.emitBuffered=function(){var a;
for(a=0;a<this.receiveBuffer.length;a++)p.apply(this,this.receiveBuffer[a]);this.receiveBuffer=[];for(a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);this.sendBuffer=[]};e.prototype.ondisconnect=function(){n("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};e.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)};e.prototype.close=e.prototype.disconnect=function(){this.connected&&
(n("performing disconnect (%s)",this.nsp),this.packet({type:f.DISCONNECT}));this.destroy();if(this.connected)this.onclose("io client disconnect");return this}},{"./on":53,"component-bind":7,"component-emitter":8,debug:10,"has-binary":30,"socket.io-parser":57,"to-array":59}],55:[function(a,c,b){(function(b){var e=a("parseuri"),g=a("debug")("socket.io-client:url");c.exports=function(a,c){var f=a;c=c||b.location;null==a&&(a=c.protocol+"//"+c.host);"string"==typeof a&&("/"==a.charAt(0)&&(a="/"==a.charAt(1)?
c.protocol+a:c.hostname+a),/^(https?|wss?):\/\//.test(a)||(g("protocol-less url %s",a),a="undefined"!=typeof c?c.protocol+"//"+a:"https://"+a),g("parse %s",a),f=e(a));f.port||(/^(http|ws)$/.test(f.protocol)?f.port="80":/^(http|ws)s$/.test(f.protocol)&&(f.port="443"));f.path=f.path||"/";f.id=f.protocol+"://"+f.host+":"+f.port;f.href=f.protocol+"://"+f.host+(c&&c.port==f.port?"":":"+f.port);return f}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?
window:{})},{debug:10,parseuri:42}],56:[function(a,c,b){(function(c){var e=a("isarray"),g=a("./is-buffer");b.deconstructPacket=function(a){function b(a){if(!a)return a;if(g(a)){var f={_placeholder:!0,num:c.length};c.push(a);return f}if(e(a)){f=Array(a.length);for(var k=0;k<a.length;k++)f[k]=b(a[k]);return f}if("object"==typeof a&&!(a instanceof Date)){f={};for(k in a)f[k]=b(a[k]);return f}return a}var c=[];a.data=b(a.data);a.attachments=c.length;return{packet:a,buffers:c}};b.reconstructPacket=function(a,
b){function c(a){if(a&&a._placeholder)return b[a.num];if(e(a))for(var f=0;f<a.length;f++)a[f]=c(a[f]);else if(a&&"object"==typeof a)for(f in a)a[f]=c(a[f]);return a}a.data=c(a.data);a.attachments=void 0;return a};b.removeBlobs=function(a,b){function f(a,m,n){if(!a)return a;if(c.Blob&&a instanceof Blob||c.File&&a instanceof File){k++;var p=new FileReader;p.onload=function(){n?n[m]=this.result:l=this.result;--k||b(l)};p.readAsArrayBuffer(a)}else if(e(a))for(p=0;p<a.length;p++)f(a[p],p,a);else if(a&&
"object"==typeof a&&!g(a))for(p in a)f(a[p],p,a)}var k=0,l=a;f(l);k||b(l)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./is-buffer":58,isarray:33}],57:[function(a,c,b){function e(){}function f(a){var c=!1;var e=""+a.type;if(b.BINARY_EVENT==a.type||b.BINARY_ACK==a.type)e+=a.attachments,e+="-";a.nsp&&"/"!=a.nsp&&(c=!0,e+=a.nsp);null!=a.id&&(c&&(e+=",",c=!1),e+=a.id);null!=a.data&&(c&&(e+=","),e+=m.stringify(a.data));n("encoded %j as %s",
a,e);return e}function g(a,b){r.removeBlobs(a,function(a){var c=r.deconstructPacket(a);a=f(c.packet);c=c.buffers;c.unshift(a);b(c)})}function l(){this.reconstructor=null}function k(a){this.reconPack=a;this.buffers=[]}var n=a("debug")("socket.io-parser"),m=a("json3");a("isarray");c=a("component-emitter");var r=a("./binary"),p=a("./is-buffer");b.protocol=4;b.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" ");b.CONNECT=0;b.DISCONNECT=1;b.EVENT=2;b.ACK=3;b.ERROR=4;b.BINARY_EVENT=
5;b.BINARY_ACK=6;b.Encoder=e;b.Decoder=l;e.prototype.encode=function(a,c){n("encoding packet %j",a);b.BINARY_EVENT==a.type||b.BINARY_ACK==a.type?g(a,c):(a=f(a),c([a]))};c(l.prototype);l.prototype.add=function(a){if("string"==typeof a){a:{var c={},e=0;c.type=Number(a.charAt(0));if(null==b.types[c.type])a={type:b.ERROR,data:"parser error"};else{if(b.BINARY_EVENT==c.type||b.BINARY_ACK==c.type){for(var f="";"-"!=a.charAt(++e)&&(f+=a.charAt(e),e!=a.length););if(f!=Number(f)||"-"!=a.charAt(e))throw Error("Illegal attachments");
c.attachments=Number(f)}if("/"==a.charAt(e+1))for(c.nsp="";++e;){f=a.charAt(e);if(","==f)break;c.nsp+=f;if(e==a.length)break}else c.nsp="/";f=a.charAt(e+1);if(""!==f&&Number(f)==f){for(c.id="";++e;){f=a.charAt(e);if(null==f||Number(f)!=f){--e;break}c.id+=a.charAt(e);if(e==a.length)break}c.id=Number(c.id)}if(a.charAt(++e))try{c.data=m.parse(a.substr(e))}catch(y){a={type:b.ERROR,data:"parser error"};break a}n("decoded %s as %j",a,c);a=c}}b.BINARY_EVENT==a.type||b.BINARY_ACK==a.type?(this.reconstructor=
new k(a),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",a)):this.emit("decoded",a)}else if(p(a)||a.base64)if(this.reconstructor){if(a=this.reconstructor.takeBinaryData(a))this.reconstructor=null,this.emit("decoded",a)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+a);};l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};k.prototype.takeBinaryData=function(a){this.buffers.push(a);
return this.buffers.length==this.reconPack.attachments?(a=r.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),a):null};k.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},{"./binary":56,"./is-buffer":58,"component-emitter":8,debug:10,isarray:33,json3:34}],58:[function(a,c,b){(function(a){c.exports=function(b){return a.Buffer&&a.Buffer.isBuffer(b)||a.ArrayBuffer&&b instanceof ArrayBuffer}}).call(this,"undefined"!==typeof global?global:"undefined"!==
typeof self?self:"undefined"!==typeof window?window:{})},{}],59:[function(a,c,b){c.exports=function(a,b){for(var c=[],e=(b=b||0)||0;e<a.length;e++)c[e-b]=a[e];return c}},{}],60:[function(a,c,b){(function(a){(function(e){function f(a){for(var b=[],c=0,e=a.length,f,g;c<e;)f=a.charCodeAt(c++),55296<=f&&56319>=f&&c<e?(g=a.charCodeAt(c++),56320==(g&64512)?b.push(((f&1023)<<10)+(g&1023)+65536):(b.push(f),c--)):b.push(f);return b}function l(a){if(55296<=a&&57343>=a)throw Error("Lone surrogate U+"+a.toString(16).toUpperCase()+
" is not a scalar value");}function k(){if(v>=x)throw Error("Invalid byte index");var a=t[v]&255;v++;if(128==(a&192))return a&63;throw Error("Invalid continuation byte");}function n(){if(v>x)throw Error("Invalid byte index");if(v==x)return!1;var a=t[v]&255;v++;if(0==(a&128))return a;if(192==(a&224)){var b=k();a=(a&31)<<6|b;if(128<=a)return a;throw Error("Invalid continuation byte");}if(224==(a&240)){b=k();var c=k();a=(a&15)<<12|b<<6|c;if(2048<=a)return l(a),a;throw Error("Invalid continuation byte");
}if(240==(a&248)){b=k();c=k();var e=k();a=(a&15)<<18|b<<12|c<<6|e;if(65536<=a&&1114111>=a)return a}throw Error("Invalid UTF-8 detected");}var m="object"==typeof b&&b,r="object"==typeof c&&c&&c.exports==m&&c,p="object"==typeof a&&a;if(p.global===p||p.window===p)e=p;var q=String.fromCharCode,t,x,v;p={version:"2.0.0",encode:function(a){a=f(a);for(var b=a.length,c=-1,e,g="";++c<b;){e=a[c];if(0==(e&4294967168))e=q(e);else{var k="";0==(e&4294965248)?k=q(e>>6&31|192):0==(e&4294901760)?(l(e),k=q(e>>12&15|
224),k+=q(e>>6&63|128)):0==(e&4292870144)&&(k=q(e>>18&7|240),k+=q(e>>12&63|128),k+=q(e>>6&63|128));e=k+=q(e&63|128)}g+=e}return g},decode:function(a){t=f(a);x=t.length;v=0;a=[];for(var b;!1!==(b=n());)a.push(b);b=a.length;for(var c=-1,e,g="";++c<b;)e=a[c],65535<e&&(e-=65536,g+=q(e>>>10&1023|55296),e=56320|e&1023),g+=q(e);return g}};if(m&&!m.nodeType)if(r)r.exports=p;else{e={}.hasOwnProperty;for(var y in p)e.call(p,y)&&(m[y]=p[y])}else e.utf8=p})(this)}).call(this,"undefined"!==typeof global?global:
"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],61:[function(a,c,b){c.exports="function"===typeof Object.create?function(a,b){a.super_=b;a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a}},{}],62:[function(a,c,b){c.exports=function(a){return a&&"object"===typeof a&&"function"===typeof a.copy&&"function"===
typeof a.fill&&"function"===typeof a.readUInt8}},{}],63:[function(a,c,b){(function(c,f){function e(a,c){var e={seen:[],stylize:k};3<=arguments.length&&(e.depth=arguments[2]);4<=arguments.length&&(e.colors=arguments[3]);y(c)?e.showHidden=c:c&&b._extend(e,c);D(e.showHidden)&&(e.showHidden=!1);D(e.depth)&&(e.depth=2);D(e.colors)&&(e.colors=!1);D(e.customInspect)&&(e.customInspect=!0);e.colors&&(e.stylize=l);return m(e,a,e.depth)}function l(a,b){return(b=e.styles[b])?"\u001b["+e.colors[b][0]+"m"+a+"\u001b["+
e.colors[b][1]+"m":a}function k(a,b){return a}function n(a){var b={};a.forEach(function(a,c){b[a]=!0});return b}function m(a,c,e){if(a.customInspect&&c&&H(c.inspect)&&c.inspect!==b.inspect&&(!c.constructor||c.constructor.prototype!==c)){var f=c.inspect(e,a);A(f)||(f=m(a,f,e));return f}if(f=r(a,c))return f;var g=Object.keys(c),k=n(g);a.showHidden&&(g=Object.getOwnPropertyNames(c));if(u(c)&&(0<=g.indexOf("message")||0<=g.indexOf("description")))return p(c);if(0===g.length){if(H(c))return a.stylize("[Function"+
(c.name?": "+c.name:"")+"]","special");if(G(c))return a.stylize(RegExp.prototype.toString.call(c),"regexp");if(K(c))return a.stylize(Date.prototype.toString.call(c),"date");if(u(c))return p(c)}f="";var l=!1,E=["{","}"];v(c)&&(l=!0,E=["[","]"]);H(c)&&(f=" [Function"+(c.name?": "+c.name:"")+"]");G(c)&&(f=" "+RegExp.prototype.toString.call(c));K(c)&&(f=" "+Date.prototype.toUTCString.call(c));u(c)&&(f=" "+p(c));if(0===g.length&&(!l||0==c.length))return E[0]+f+E[1];if(0>e)return G(c)?a.stylize(RegExp.prototype.toString.call(c),
"regexp"):a.stylize("[Object]","special");a.seen.push(c);g=l?q(a,c,e,k,g):g.map(function(b){return t(a,c,e,k,b,l)});a.seen.pop();return x(g,f,E)}function r(a,b){if(D(b))return a.stylize("undefined","undefined");if(A(b))return b="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",a.stylize(b,"string");if(z(b))return a.stylize(""+b,"number");if(y(b))return a.stylize(""+b,"boolean");if(null===b)return a.stylize("null","null")}function p(a){return"["+Error.prototype.toString.call(a)+
"]"}function q(a,b,c,e,f){for(var g=[],k=0,m=b.length;k<m;++k)Object.prototype.hasOwnProperty.call(b,String(k))?g.push(t(a,b,c,e,String(k),!0)):g.push("");f.forEach(function(f){f.match(/^\d+$/)||g.push(t(a,b,c,e,f,!0))});return g}function t(a,b,c,e,f,g){var k,l;b=Object.getOwnPropertyDescriptor(b,f)||{value:b[f]};b.get?l=b.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):b.set&&(l=a.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(e,f)||(k="["+f+"]");l||
(0>a.seen.indexOf(b.value)?(l=null===c?m(a,b.value,null):m(a,b.value,c-1),-1<l.indexOf("\n")&&(l=g?l.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+l.split("\n").map(function(a){return"   "+a}).join("\n"))):l=a.stylize("[Circular]","special"));if(D(k)){if(g&&f.match(/^\d+$/))return l;k=JSON.stringify(""+f);k.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(k=k.substr(1,k.length-2),k=a.stylize(k,"name")):(k=k.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),k=a.stylize(k,
"string"))}return k+": "+l}function x(a,b,c){var e=0;return 60<a.reduce(function(a,b){e++;0<=b.indexOf("\n")&&e++;return a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function v(a){return Array.isArray(a)}function y(a){return"boolean"===typeof a}function z(a){return"number"===typeof a}function A(a){return"string"===typeof a}function D(a){return void 0===a}function G(a){return L(a)&&"[object RegExp]"===Object.prototype.toString.call(a)}
function L(a){return"object"===typeof a&&null!==a}function K(a){return L(a)&&"[object Date]"===Object.prototype.toString.call(a)}function u(a){return L(a)&&("[object Error]"===Object.prototype.toString.call(a)||a instanceof Error)}function H(a){return"function"===typeof a}function C(a){return 10>a?"0"+a.toString(10):a.toString(10)}function F(){var a=new Date,b=[C(a.getHours()),C(a.getMinutes()),C(a.getSeconds())].join(":");return[a.getDate(),Z[a.getMonth()],b].join(" ")}var I=/%[sdj%]/g;b.format=
function(a){if(!A(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}c=1;var f=arguments,g=f.length;b=String(a).replace(I,function(a){if("%%"===a)return"%";if(c>=g)return a;switch(a){case "%s":return String(f[c++]);case "%d":return Number(f[c++]);case "%j":try{return JSON.stringify(f[c++])}catch(ia){return"[Circular]"}default:return a}});for(var k=f[c];c<g;k=f[++c])b=null!==k&&L(k)?b+(" "+e(k)):b+(" "+k);return b};b.deprecate=function(a,e){if(D(f.process))return function(){return b.deprecate(a,
e).apply(this,arguments)};if(!0===c.noDeprecation)return a;var g=!1;return function(){if(!g){if(c.throwDeprecation)throw Error(e);c.traceDeprecation?console.trace(e):console.error(e);g=!0}return a.apply(this,arguments)}};var O={},P;b.debuglog=function(a){D(P)&&(P=c.env.NODE_DEBUG||"");a=a.toUpperCase();if(!O[a])if((new RegExp("\\b"+a+"\\b","i")).test(P)){var e=c.pid;O[a]=function(){var c=b.format.apply(b,arguments);console.error("%s %d: %s",a,e,c)}}else O[a]=function(){};return O[a]};b.inspect=e;
e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};b.isArray=v;b.isBoolean=y;b.isNull=function(a){return null===a};b.isNullOrUndefined=function(a){return null==a};b.isNumber=z;b.isString=A;b.isSymbol=function(a){return"symbol"===
typeof a};b.isUndefined=D;b.isRegExp=G;b.isObject=L;b.isDate=K;b.isError=u;b.isFunction=H;b.isPrimitive=function(a){return null===a||"boolean"===typeof a||"number"===typeof a||"string"===typeof a||"symbol"===typeof a||"undefined"===typeof a};b.isBuffer=a("./support/isBuffer");var Z="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");b.log=function(){console.log("%s - %s",F(),b.format.apply(b,arguments))};b.inherits=a("inherits");b._extend=function(a,b){if(!b||!L(b))return a;for(var c=Object.keys(b),
e=c.length;e--;)a[c[e]]=b[c[e]];return a}}).call(this,a("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":62,_process:43,inherits:61}],64:[function(a,c,b){if(window.mozRTCPeerConnection||navigator.mozGetUserMedia){var e="moz";var f=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)}else if(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)e="webkit",f=navigator.userAgent.match(/Chrom(e|ium)/)&&
parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10);a=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;b=window.mozRTCIceCandidate||window.RTCIceCandidate;var g=window.mozRTCSessionDescription||window.RTCSessionDescription,l=window.webkitMediaStream||window.MediaStream,k="https:"===window.location.protocol&&("webkit"===e&&26<=f||"moz"===e&&33<=f),n=window.AudioContext||window.webkitAudioContext,m=document.createElement("video");m=m&&m.canPlayType&&
"probably"===m.canPlayType('video/webm; codecs="vp8", vorbis');var r=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;c.exports={prefix:e,browserVersion:f,support:!!a&&!!r,supportRTCPeerConnection:!!a,supportVp8:m,supportGetUserMedia:!!r,supportDataChannel:!!(a&&a.prototype&&a.prototype.createDataChannel),supportWebAudio:!(!n||!n.prototype.createMediaStreamSource),supportMediaStream:!(!l||!l.prototype.removeTrack),supportScreenSharing:!!k,AudioContext:n,
PeerConnection:a,SessionDescription:g,IceCandidate:b,MediaStream:l,getUserMedia:r}},{}],65:[function(a,c,b){function e(){}c.exports=e;e.mixin=function(a){a=a.prototype||a;a.isWildEmitter=!0;a.on=function(a,b,c){this.callbacks=this.callbacks||{};var e=3===arguments.length,f=e?arguments[2]:arguments[1];f._groupName=e?arguments[1]:void 0;(this.callbacks[a]=this.callbacks[a]||[]).push(f);return this};a.once=function(a,b,c){function e(){f.off(a,e);k.apply(this,arguments)}var f=this,g=3===arguments.length,
k=g?arguments[2]:arguments[1];this.on(a,g?arguments[1]:void 0,e);return this};a.releaseGroup=function(a){this.callbacks=this.callbacks||{};var b,c;for(b in this.callbacks){var e=this.callbacks[b];var f=0;for(c=e.length;f<c;f++)e[f]._groupName===a&&(e.splice(f,1),f--,c--)}return this};a.off=function(a,b){this.callbacks=this.callbacks||{};var c=this.callbacks[a];if(!c)return this;if(1===arguments.length)return delete this.callbacks[a],this;var e=c.indexOf(b);c.splice(e,1);0===c.length&&delete this.callbacks[a];
return this};a.emit=function(a){this.callbacks=this.callbacks||{};var b=[].slice.call(arguments,1),c=this.callbacks[a],e=this.getWildcardCallbacks(a),f;if(c){var g=c.slice();c=0;for(f=g.length;c<f&&g[c];++c)g[c].apply(this,b)}if(e)for(g=e.slice(),c=0,f=g.length;c<f&&g[c];++c)g[c].apply(this,[a].concat(b));return this};a.getWildcardCallbacks=function(a){this.callbacks=this.callbacks||{};var b,c=[];for(b in this.callbacks){var e=b.split("*");if("*"===b||2===e.length&&a.slice(0,e[0].length)===e[0])c=
c.concat(this.callbacks[b])}return c}};e.mixin(e)},{}],66:[function(a,c,b){function e(a,b,c){return b?new f(a,b):new f(a)}a=window;var f=a.WebSocket||a.MozWebSocket;c.exports=f?e:null;f&&(e.prototype=f.prototype)},{}],67:[function(a,c,b){function e(a){var b=!0;a.getTracks().forEach(function(a){b="ended"===a.readyState&&b});return b}function f(a){var b=this;k.call(this);this.id=a.id;this.parent=a.parent;this.type=a.type||"video";this.oneway=a.oneway||!1;this.sharemyscreen=a.sharemyscreen||!1;this.browserPrefix=
a.prefix;this.stream=a.stream;this.enableDataChannels=void 0===a.enableDataChannels?this.parent.config.enableDataChannels:a.enableDataChannels;this.receiveMedia=a.receiveMedia||this.parent.config.receiveMedia;this.channels={};this.sid=a.sid||Date.now().toString();this.pc=new l(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints);this.pc.on("ice",this.onIceCandidate.bind(this));this.pc.on("endOfCandidates",function(a){b.send("endOfCandidates",a)});this.pc.on("offer",
function(a){b.parent.config.nick&&(a.nick=b.parent.config.nick);b.send("offer",a)});this.pc.on("answer",function(a){b.parent.config.nick&&(a.nick=b.parent.config.nick);b.send("answer",a)});this.pc.on("addStream",this.handleRemoteStreamAdded.bind(this));this.pc.on("addChannel",this.handleDataChannelAdded.bind(this));this.pc.on("removeStream",this.handleStreamRemoved.bind(this));this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded"));this.pc.on("iceConnectionStateChange",this.emit.bind(this,
"iceConnectionStateChange"));this.pc.on("iceConnectionStateChange",function(){switch(b.pc.iceConnectionState){case "failed":"offer"===b.pc.pc.localDescription.type&&(b.parent.emit("iceFailed",b),b.send("connectivityError"))}});this.pc.on("signalingStateChange",this.emit.bind(this,"signalingStateChange"));this.logger=this.parent.logger;"screen"===a.type?this.parent.localScreens&&this.parent.localScreens[0]&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),this.pc.addStream(this.parent.localScreens[0]),
this.broadcaster=a.broadcaster):this.parent.localStreams.forEach(function(a){b.pc.addStream(a)});this.on("channelOpen",function(a){"https://simplewebrtc.com/protocol/filetransfer#inband-v1"===a.protocol&&(a.onmessage=function(c){c=JSON.parse(c.data);var e=new n.Receiver;e.receive(c,a);b.emit("fileTransfer",c,e);e.on("receivedFile",function(a,b){e.channel.close()})})});this.on("*",function(){b.parent.emit.apply(b.parent,arguments)})}b=a("util");var g=a("webrtcsupport"),l=a("rtcpeerconnection"),k=a("wildemitter"),
n=a("filetransfer");b.inherits(f,k);f.prototype.handleMessage=function(a){var b=this;this.logger.log("getting",a.type,a);a.prefix&&(this.browserPrefix=a.prefix);"offer"===a.type?(this.nick||(this.nick=a.payload.nick),delete a.payload.nick,this.pc.handleOffer(a.payload,function(a){a||b.pc.answer(function(a,b){})})):"answer"===a.type?(this.nick||(this.nick=a.payload.nick),delete a.payload.nick,this.pc.handleAnswer(a.payload)):"candidate"===a.type?this.pc.processIce(a.payload):"connectivityError"===
a.type?this.parent.emit("connectivityError",b):"mute"===a.type?this.parent.emit("mute",{id:a.from,name:a.payload.name}):"unmute"===a.type&&this.parent.emit("unmute",{id:a.from,name:a.payload.name})};f.prototype.send=function(a,b){b={to:this.id,sid:this.sid,broadcaster:this.broadcaster,roomType:this.type,type:a,payload:b,prefix:g.prefix};this.logger.log("sending",a,b);this.parent.emit("message",b)};f.prototype.sendDirectly=function(a,b,c){this.logger.log("sending via datachannel",a,b,{type:b,payload:c});
a=this.getDataChannel(a);if("open"!=a.readyState)return!1;a.send(c);return!0};f.prototype._observeDataChannel=function(a){var b=this;a.binaryType="arraybuffer";a.onclose=this.emit.bind(this,"channelClose",a);a.onerror=this.emit.bind(this,"channelError",a);a.onmessage=function(c){var e=new Uint32Array(c.data);b.emit("channelMessage",b,a.label,e,a,c)};a.onopen=this.emit.bind(this,"channelOpen",a)};f.prototype.getDataChannel=function(a,b){if(!g.supportDataChannel)return this.emit("error",Error("createDataChannel not supported"));
var c=this.channels[a];b||(b={});if(c)return c;c=this.channels[a]=this.pc.createDataChannel(a,b);c.binaryType="arraybuffer";this._observeDataChannel(c);return c};f.prototype.onIceCandidate=function(a){if(!this.closed)if(a){var b=this.parent.config.peerConnectionConfig;"moz"===g.prefix&&b&&b.iceTransports&&a.candidate&&a.candidate.candidate&&0>a.candidate.candidate.indexOf(b.iceTransports)?this.logger.log("Ignoring ice candidate not matching pcConfig iceTransports type: ",b.iceTransports):this.send("candidate",
a)}else this.logger.log("End of candidates.")};f.prototype.start=function(){this.enableDataChannels&&this.getDataChannel("simplewebrtc");this.pc.offer(this.receiveMedia,function(a,b){})};f.prototype.icerestart=function(){var a=this.receiveMedia;a.mandatory.IceRestart=!0;this.pc.offer(a,function(a,b){})};f.prototype.end=function(){this.closed||(this.pc.close(),this.handleStreamRemoved())};f.prototype.handleRemoteStreamAdded=function(a){var b=this;this.stream?this.logger.warn("Already have a remote stream"):
(this.stream=a.stream,this.stream.getTracks().forEach(function(a){a.addEventListener("ended",function(){e(b.stream)&&b.end()})}),this.parent.emit("peerStreamAdded",this))};f.prototype.handleStreamRemoved=function(){var a=this.parent.peers.indexOf(this);-1<a&&(this.parent.peers.splice(a,1),this.closed=!0,this.parent.emit("peerStreamRemoved",this))};f.prototype.handleDataChannelAdded=function(a){this.channels[a.label]=a;this._observeDataChannel(a)};f.prototype.sendFile=function(a){var b=new n.Sender,
c=this.getDataChannel("filetransfer"+(new Date).getTime(),{protocol:"https://simplewebrtc.com/protocol/filetransfer#inband-v1"});c.onopen=function(){c.send(JSON.stringify({size:a.size,name:a.name}));b.send(a,c)};c.onclose=function(){console.log("sender received transfer");b.emit("complete")};return b};c.exports=f},{filetransfer:26,rtcpeerconnection:44,util:63,webrtcsupport:64,wildemitter:65}],68:[function(a,c,b){function e(a){var b=this,c=a||{},e=this.config={url:"https://sandbox.simplewebrtc.com:443/",
socketio:{},connection:null,debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!1,peerVolumeWhenSpeaking:.25,media:{video:!0,audio:!0},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},localVideo:{autoplay:!0,mirror:!0,muted:!0}},r;var v=a.debug?a.logger||console:a.logger||n;this.logger=v;for(r in c)c.hasOwnProperty(r)&&(this.config[r]=c[r]);this.capabilities=l;g.call(this);var y=null===this.config.connection?this.connection=
new m(this.config):this.connection=this.config.connection;y.on("connect",function(){b.emit("connectionReady",y.getSessionid());b.sessionReady=!0;b.testReadiness()});y.on("message",function(a){var c=b.webrtc.getPeers(a.from,a.roomType);if("offer"===a.type){c.length&&c.forEach(function(b){b.sid==a.sid&&(e=b)});if(!e){var e=b.webrtc.createPeer({id:a.from,sid:a.sid,type:a.roomType,enableDataChannels:b.config.enableDataChannels&&"screen"!==a.roomType,sharemyscreen:"screen"===a.roomType&&!a.broadcaster,
broadcaster:"screen"!==a.roomType||a.broadcaster?null:b.connection.getSessionid()});b.emit("createdPeer",e)}e.handleMessage(a)}else c.length&&c.forEach(function(b){a.sid?b.sid===a.sid&&b.handleMessage(a):b.handleMessage(a)})});y.on("remove",function(a){a.id!==b.connection.getSessionid()&&b.webrtc.removePeers(a.id,a.type)});a.logger=this.logger;a.debug=!1;this.webrtc=new f(a);"mute unmute pauseVideo resumeVideo pause resume sendToAll sendDirectlyToAll getPeers".split(" ").forEach(function(a){b[a]=
b.webrtc[a].bind(b.webrtc)});this.webrtc.on("*",function(){b.emit.apply(b,arguments)});if(e.debug)this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:"));this.webrtc.on("localStream",function(){b.testReadiness()});this.webrtc.on("message",function(a){b.connection.emit("message",a)});this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this));this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this));this.config.adjustPeerVolume&&(this.webrtc.on("speaking",
this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1)));y.on("stunservers",function(a){b.webrtc.config.peerConnectionConfig.iceServers=a;b.emit("stunservers",a)});y.on("turnservers",function(a){b.webrtc.config.peerConnectionConfig.iceServers=b.webrtc.config.peerConnectionConfig.iceServers.concat(a);b.emit("turnservers",a)});this.webrtc.on("iceFailed",function(a){});this.webrtc.on("connectivityError",function(a){});this.webrtc.on("audioOn",
function(){b.webrtc.sendToAll("unmute",{name:"audio"})});this.webrtc.on("audioOff",function(){b.webrtc.sendToAll("mute",{name:"audio"})});this.webrtc.on("videoOn",function(){b.webrtc.sendToAll("unmute",{name:"video"})});this.webrtc.on("videoOff",function(){b.webrtc.sendToAll("mute",{name:"video"})});this.webrtc.on("localScreen",function(a){var c=document.createElement("video"),e=b.getRemoteVideoContainer();c.oncontextmenu=function(){return!1};c.id="localScreen";k(a,c);e&&e.appendChild(c);b.emit("localScreenAdded",
c);b.connection.emit("shareScreen");b.webrtc.peers.forEach(function(a){"video"===a.type&&(a=b.webrtc.createPeer({id:a.id,type:"screen",sharemyscreen:!0,enableDataChannels:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},broadcaster:b.connection.getSessionid()}),b.emit("createdPeer",a),a.start())})});this.webrtc.on("localScreenStopped",function(a){b.getLocalScreen()&&b.stopScreenShare()});this.webrtc.on("channelMessage",function(a,c,e){"volume"==e.type&&b.emit("remoteVolumeChange",a,e.volume)});
this.config.autoRequestMedia&&this.startLocalVideo()}var f=a("./webrtc"),g=a("wildemitter"),l=a("webrtcsupport"),k=a("attachmediastream"),n=a("mockconsole"),m=a("./socketioconnection");e.prototype=Object.create(g.prototype,{constructor:{value:e}});e.prototype.leaveRoom=function(){if(this.roomName){for(this.connection.emit("leave");this.webrtc.peers.length;)this.webrtc.peers[0].end();this.getLocalScreen()&&this.stopScreenShare();this.emit("leftRoom",this.roomName);this.roomName=void 0}};e.prototype.disconnect=
function(){this.connection.disconnect();delete this.connection};e.prototype.handlePeerStreamAdded=function(a){var b=this,c=this.getRemoteVideoContainer(),e=k(a.stream);a.videoEl=e;e.id=this.getDomId(a);c&&c.appendChild(e);this.emit("videoAdded",e,a);window.setTimeout(function(){b.webrtc.isAudioEnabled()||a.send("mute",{name:"audio"});b.webrtc.isVideoEnabled()||a.send("mute",{name:"video"})},250)};e.prototype.handlePeerStreamRemoved=function(a){var b=this.getRemoteVideoContainer(),c=a.videoEl;this.config.autoRemoveVideos&&
b&&c&&b.removeChild(c);c&&this.emit("videoRemoved",c,a)};e.prototype.getDomId=function(a){return[a.id,a.type,a.broadcaster?"broadcasting":"incoming"].join("_")};e.prototype.setVolumeForAll=function(a){this.webrtc.peers.forEach(function(b){b.videoEl&&(b.videoEl.volume=a)})};e.prototype.joinRoom=function(a,b){var c=this;this.roomName=a;this.connection.emit("join",a,function(e,f){console.log("join CB",e);if(e)c.emit("error",e);else{if(!f.xtra)return commonErrorLoading();me.room=f.xtra;var g,k;for(g in f.clients){var l=
f.clients[g];for(k in l)if(l[k]){var m=c.webrtc.createPeer({id:g,type:k,enableDataChannels:c.config.enableDataChannels&&"screen"!==k,receiveMedia:{offerToReceiveAudio:"screen"!==k&&c.config.receiveMedia.offerToReceiveAudio?1:0,offerToReceiveVideo:c.config.receiveMedia.offerToReceiveVideo}});c.emit("createdPeer",m);m.start()}}}b&&b(e,f);c.emit("joinedRoom",a)})};e.prototype.getEl=function(a){return"string"===typeof a?document.getElementById(a):a};e.prototype.startLocalVideo=function(){var a=this;this.webrtc.start(this.config.media,
function(b,c){b?a.emit("localMediaError",b):k(c,a.getLocalVideoContainer(),a.config.localVideo)})};e.prototype.stopLocalVideo=function(){this.webrtc.stop()};e.prototype.getLocalVideoContainer=function(){var a=this.getEl(this.config.localVideoEl);if(a&&"VIDEO"===a.tagName)return a.oncontextmenu=function(){return!1},a;if(a){var b=document.createElement("video");b.oncontextmenu=function(){return!1};a.appendChild(b);return b}};e.prototype.getRemoteVideoContainer=function(){return this.getEl(this.config.remoteVideosEl)};
e.prototype.shareScreen=function(a){this.webrtc.startScreenShare(a)};e.prototype.getLocalScreen=function(){return this.webrtc.localScreens&&this.webrtc.localScreens[0]};e.prototype.stopScreenShare=function(){this.connection.emit("unshareScreen");var a=document.getElementById("localScreen"),b=this.getRemoteVideoContainer();this.config.autoRemoveVideos&&b&&a&&b.removeChild(a);a&&this.emit("videoRemoved",a);this.getLocalScreen()&&this.webrtc.stopScreenShare();this.webrtc.peers.forEach(function(a){a.broadcaster&&
a.end()})};e.prototype.testReadiness=function(){this.sessionReady&&(this.config.media.video||this.config.media.audio?0<this.webrtc.localStreams.length&&this.emit("readyToCall",this.connection.getSessionid()):this.emit("readyToCall",this.connection.getSessionid()))};e.prototype.createRoom=function(a,b){this.roomName=a;this.connection.emit("create",me.room,b)};e.prototype.sendFile=function(){if(!l.dataChannel)return this.emit("error",Error("DataChannelNotSupported"))};c.exports=e},{"./socketioconnection":69,
"./webrtc":70,attachmediastream:3,mockconsole:37,webrtcsupport:64,wildemitter:65}],69:[function(a,c,b){function e(a){this.connection=f.connect(a.url,a.socketio)}var f=a("socket.io-client");e.prototype.on=function(a,b){this.connection.on(a,b)};e.prototype.emit=function(){this.connection.emit.apply(this.connection,arguments)};e.prototype.getSessionid=function(){return this.connection.id};e.prototype.disconnect=function(){return this.connection.disconnect()};c.exports=e},{"socket.io-client":50}],70:[function(a,
c,b){function e(a){var b=this,c=a||{};this.config={debug:!1,peerConnectionConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[]},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},enableDataChannels:!0};var e;a=a.debug?a.logger||console:a.logger||g;this.logger=a;for(e in c)c.hasOwnProperty(e)&&(this.config[e]=c[e]);f.support||this.logger.error("Your browser doesn't seem to support WebRTC");this.peers=[];l.call(this,this.config);this.on("speaking",
function(){b.hardMuted||b.peers.forEach(function(a){a.enableDataChannels&&(a=a.getDataChannel("hark"),"open"==a.readyState&&a.send(JSON.stringify({type:"speaking"})))})});this.on("stoppedSpeaking",function(){b.hardMuted||b.peers.forEach(function(a){a.enableDataChannels&&(a=a.getDataChannel("hark"),"open"==a.readyState&&a.send(JSON.stringify({type:"stoppedSpeaking"})))})});this.on("volumeChange",function(a,c){b.hardMuted||b.peers.forEach(function(b){b.enableDataChannels&&(b=b.getDataChannel("hark"),
"open"==b.readyState&&b.send(JSON.stringify({type:"volume",volume:a})))})});if(this.config.debug)this.on("*",function(a,c,e){(b.config.logger===g?console:b.logger).log("event:",a,c,e)})}b=a("util");var f=a("webrtcsupport"),g=a("mockconsole"),l=a("localmedia"),k=a("./peer");b.inherits(e,l);e.prototype.createPeer=function(a){a.parent=this;a=new k(a);this.peers.push(a);return a};e.prototype.removePeers=function(a,b){this.getPeers(a,b).forEach(function(a){a.end()})};e.prototype.getPeers=function(a,b){return this.peers.filter(function(c){return(!a||
c.id===a)&&(!b||c.type===b)})};e.prototype.sendToAll=function(a,b){this.peers.forEach(function(c){c.send(a,b)})};e.prototype.sendDirectlyToAll=function(a,b,c){this.peers.forEach(function(e){e.enableDataChannels&&e.sendDirectly(a,b,c)})};c.exports=e},{"./peer":67,localmedia:35,mockconsole:37,util:63,webrtcsupport:64}]},{},[68])(68)})};var mapx,mapy,imagesLoad,waitingLoad,MSG,realUrl=location.protocol+"//"+location.host+"/",me={name:localStorage.name,color:localStorage.color||"#ff0000"},emptyFunction=function(){},cfunc=function(){};console.log("%c nehhon %c POWER ","background: #00ffd4; color: #000; font-size:20px","background: #000; color: #00ffd4; font-size:20px");console.log("%c webmaster@nehhon.com ","background: #00ffd4; color: #000; font-size:20px");console.log("%c @nehhon ","background: #000; color: #00ffd4; font-size:20px");
var ONDESKTOP=!1,gid=function(d){return document.getElementById(d)},storageDiv=function(d,a,c){void 0===localStorage[d]&&(localStorage[d]=a);c&&(gid(c).value=localStorage[d])};void 0===localStorage.fullscreen&&(localStorage.fullscreen=!0);storageDiv("favMusic","originalMusic");storageDiv("musicRange",36);storageDiv("soundRange",100);storageDiv("goldRes",400);storageDiv("foodRes",400);storageDiv("stoneRes",400);storageDiv("woodRes",400);storageDiv("nplayed",0);storageDiv("infinity","true");
storageDiv("mapx",256);storageDiv("terrainType","grass");storageDiv("terrain","grass");storageDiv("water","0");storageDiv("items","10");storageDiv("peons","3");storageDiv("gateways","1");storageDiv("freePop","1");storageDiv("zoomMult",70);storageDiv("scrollSpeed",50);var nehbugger=!1;console.log=emptyFunction,console.error=emptyFunction,console.warn=emptyFunction,console.info=emptyFunction;nehbugger||window.addEventListener("error",function(d){spAlert(d.lineno+":"+d.colno+" "+d.message,"error")});
var deleteDiv=function(d){d.parentNode.removeChild(d)},addNotify=function(d,a){var c=gid("notifybar"),b=document.createElement("div");b.innerHTML=d;a&&(b.style.background=a);c.appendChild(b);setTimeout(deleteDiv,11E3,b)},hexToRgb=function(d){d=parseInt(d.substr(1),16);return[d>>16&255,d>>8&255,d&255]},splcd=location;
(function(){var d=!!window.opr||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),a="undefined"!==typeof InstallTrigger,c=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),b=!!document.documentMode,e=!b&&!!window.StyleMedia,f=!!window.chrome&&!!window.chrome.webstore,g;d?g="Opera":a?g="Firefox":c?g="Safari":b?g="IE":e?g="Edge":f&&(g="Chrome");me.navLang=localStorage.language||navigator.language||navigator.userLanguage;d=me.navLang.substr(0,2);"es"==d?validArr=["Tzared",
"Juego de estrategia en tiempo real para navegadores web, juega solo o con amigos","tzared,jugar,multijugador,juego,online,navegador web,tzar"]:"it"==d?validArr=["Tzared","Gioco di strategia in tempo reale per browser web, giocare da soli o con gli amici","tzared,giocare,multigiocatore,gioco,online,navigatore,tzar,web"]:"it"==d?validArr=["Tzared","Gra strategiczna w czasie rzeczywistym dla przegl\u0105darek internetowych, bawi\u0107 si\u0119 samotnie lub z przyjaci\u00f3\u0142mi","tzared,gra,multiplayer,online,tzar,przegl\u0105darka internetowa"]:
"ru"==d?validArr=["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u043b\u044f \u0432\u0435\u0431-\u0431\u0440\u0430\u0443\u0437\u0435\u0440\u043e\u0432, \u0438\u0433\u0440\u0430\u0442\u044c \u0432 \u043e\u0434\u0438\u043d\u043e\u0447\u043a\u0443 \u0438\u043b\u0438 \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438","\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u044c\u0442\u0438\u043f\u043b\u0435\u0435\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u0435\u0440,\u043e\u0433\u043d\u0451\u043c \u0438 \u043c\u0435\u0447\u043e\u043c"]:
"pt"==d?validArr=["Tzared","Jogo de estrat\u00e9gia em tempo real para navegadores da web, jogar sozinho ou com amigos","tzared,jogar,multiplayer,jogo,online,navegador web,tzar"]:"bg"==d?validArr=["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0447\u0435\u0441\u043a\u0430 \u0438\u0433\u0440\u0430 \u0432 \u0440\u0435\u0430\u043b\u043d\u043e \u0432\u0440\u0435\u043c\u0435 \u0437\u0430 \u0443\u0435\u0431 \u0431\u0440\u0430\u0443\u0437\u044a\u0440\u0438, \u0438\u0433\u0440\u0430\u0439\u0442\u0435 \u0441\u0430\u043c\u0438 \u0438\u043b\u0438 \u0441 \u043f\u0440\u0438\u044f\u0442\u0435\u043b\u0438",
"\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u0442\u0438\u043f\u043b\u0435\u0439\u044a\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u044a\u0440"]:"de"==d?validArr=["Tzared","Echtzeit-Strategiespiel f\u00fcr Webbrowser, alleine oder mit Freunden spielen","tzared,multiplayer,spiel,online,Webbrowser,tzar"]:(validArr=["Tzared","Real-time strategy game for web browsers, play alone or with friends","tzared,play,multiplayer,game,online,browser,tzar,web"],
d="en");document.getElementsByTagName("html")[0].lang=d;document.title=validArr[0];nehbugger&&(document.title="127");me.title=validArr[0];document.getElementsByTagName("meta").description=validArr[1];document.getElementsByTagName("meta").keywords=validArr[2];me.versionInt=347;me.version="v"+me.versionInt/10;me.versionDate=Date.now()-1557340232430;localStorage.version!==me.version&&(localStorage.version=me.version,addNotify("Updated to "+me.version));gid("info").innerHTML="Work in progress - Beta "+
me.version+" - Updated "+~~(me.versionDate/864E5)+" days ago";me.lang="en es it pt ru pl bg de".split(" ").indexOf(d);0>me.lang&&(me.lang=0);me.langstr=d;me.team=0;me.race=0;me.navigator=g;me.mx=151;me.onlineID=null;me.temperature=0;me.cdn="nehhon/"})();
var langobjs=[],langsetupfile=function(){function d(a,b,c){a=new Blob([a],{type:c});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,b);else{var d=document.createElement("a"),e=URL.createObjectURL(a);d.href=e;d.download=b;document.body.appendChild(d);d.click();setTimeout(function(){document.body.removeChild(d);window.URL.revokeObjectURL(e)},0)}}for(var a="en es it pt ru pl bg de".split(" "),c=0,b={},e=0;e<a.length;b={$jscomp$loop$prop$url1$22:b.$jscomp$loop$prop$url1$22},e++){var f=
new XMLHttpRequest,g="langs/"+a[e]+".json";b.$jscomp$loop$prop$url1$22=a[e];f.onreadystatechange=function(b){return function(){if(4==this.readyState&&200==this.status&&(ms(b.$jscomp$loop$prop$url1$22),langobjs[b.$jscomp$loop$prop$url1$22]=JSON.parse(this.responseText),c++,c===a.length)){ms(langobjs);var e=langobjs.en,f="",g=Object.keys(e);ms(JSON.stringify(g));for(var l=0;l<g.length;l++){var p=g[l];f+="#define MSG_"+p.split(" ").join("_")+" "+l+"\n";for(var q=0;q<c;q++)e[p]||delete langobjs[a[q]][p],
langobjs[a[q]][p]||(langobjs[a[q]][p]=e[p])}ms(f);for(q=0;q<c;q++){e=langobjs[a[q]];g=Object.keys(e);for(l=0;l<g.length;l++)0;d(JSON.stringify(e),a[q]+".json","text")}}}}(b);f.open("GET",g,!0);f.send()}},__dirname,FS,tempDouble,tempI64,translate=function(d){d--;var a=new XMLHttpRequest;a.open("GET",me.cdn+me.langstr+".json",!0);a.onload=function(){msg=JSON.parse(a.response);buttonTranslate()};a.send()},buttonTranslate=function(){races=[msg.SP_SETUPMAP_RACE_1.split("|")[0],msg.SP_SETUPMAP_RACE_2.split("|")[0],
msg.SP_SETUPMAP_RACE_3.split("|")[0],msg.ORDERS_NAMES_E_COMMON.toLocaleUpperCase()];for(var d=["mult0",msg.MAINSCR_MULTI.split("|")[0],"rnd0",msg.MAINSCR_SINGLE.split("| ")[0],"load0",msg.SINGLESCR_LOAD.split("| ")[1],"editor0",msg.MAPEDITOR,"settings0",msg.MP_MPLAYER_SETTINGS,"about",msg.ABOUT,"multSection",msg.MAINSCR_MULTI.split("|")[0],"offlineSection",msg.MAINSCR_SINGLE.split("|")[0],"returnmenu",msg.CAMPAIGN_BACK,"savelocal",msg.SAVE_GAME_CONTENT],a=0,c=d.length;a<c;a+=2)gid(d[a])&&(gid(d[a]).innerHTML=
d[a+1])};nehbugger||translate(me.lang);translate.translated=!0;
var allLoad,ms=console.log,spAlert=function(d,a,c){var b=gid("alert");b||(bodyPut("alert"),b=gid("alert"),b.innerHTML='\n<div id="playingMenu" style=""></div>\n            <div id="alert" style="">\n                <div>\n                    <h3 id="alerttitle"></h3>\n                    <div id="alerttext"></div>\n                    <button id="alertok">'+msg.DLG_BTNS_OK+"</button>\n                </div>\n            </div>");var e=gid("alerttitle"),f=gid("alerttext");gid("alertok").onclick=function(){hdiv("alert");
filter0()};b.style.display="block";e.innerHTML=a||msg.TZAREDIT_S2;f.innerHTML=d;c?gid("alertok").style.display="none":gid("alertok").style.display="block";gid("basic").style.filter="blur(94px)"},parameters={msgDeletionTime:12E3,test:1,windowSpeed:1.2,version:3,localhost:0},gameParameters={textureSize:323,atlasSize:253036},textureSizes,cacheArr=function(d,a,c){for(var b=0,e={},f=0;f<d.length;e={$jscomp$loop$prop$url$24:e.$jscomp$loop$prop$url$24},f++)e.$jscomp$loop$prop$url$24=me.cdn+d[f],-1===a.indexOf(e.$jscomp$loop$prop$url$24)?
fetch(e.$jscomp$loop$prop$url$24).then(function(a){return a.arrayBuffer()}).then(function(a){return function(e){b++;c.innerHTML=100*b/d.length+"%";b==d.length&&(c.style.display="none");idbCache({url:a.$jscomp$loop$prop$url$24,buffer:e})}}(e)):b++},cacheList=function(){for(var d=[loadCDN.content.common,loadCDN.content.icons],a=Object.keys(terrainSelect),c=0;c<a.length;c++)d.put(terrainSelect[a[c]].url);return d},downloadALL=function(){var d=this;navigator.storage&&navigator.storage.persist&&navigator.storage.persist().then(function(a){a?
DBGET("basic",function(a){a=a.target.result;ms(this);cacheArr(cacheList(),a,d);d.innerHTML="0%";d.onclick=null;downloadALL.button=this}):spAlert("Storage may be cleared by the UA under storage pressure.")})},textureAtlas={size:512,load:0,xtra:[],common:1,xtraRes:[]},img,showProgress=function(d){d.target.loadedSize||(showProgress.total+=d.total,d.target.lastLoaded=0,d.target.loadedSize=!0);showProgress.progress+=d.loaded-d.target.lastLoaded;d.target.lastLoaded=d.loaded;gid("loadingtext").innerHTML=
msg.DOWNLOADING_GRAPHICS+~~(100*showProgress.progress/showProgress.total)+"%"};textureAtlas.check=function(){ms("txt",textureAtlas.load,textureAtlas.images);textureAtlas.load++;textureAtlas.load===textureAtlas.images&&(setupInfo(),setup3Dtexture(),iconsGL(),startGameStep0.check())};
var coordsbuffer,lastCache,loadContent=function(d){gid("loadingtext").innerHTML=msg.DOWNLOADING_GRAPHICS;DBGET("basic",function(a){lastCache=a.target.result;a=1048576*(gameParameters.textureSize+terrainSelect[Game.terrainType||"grass"].size);textureAtlas.common=wasmu8Array(WASM.crtStxt(a),a);textureAtlas.images=Object.keys(d).length+1;textureAtlas.load=0;showProgress.progress=0;showProgress.total=0;Date.now();actionMenu.icons?textureAtlas.check():fastXHR(me.cdn+d.icons,function(a){ms(a);a=new Uint8Array(a);
a=new Blob([a],{type:"image/png"});var b=new Image;b.src=URL.createObjectURL(a);actionMenu.icons=b;b.onload=textureAtlas.check},showProgress);fastXHR(me.cdn+d.common,setupCommontxt,showProgress);gid("terrainSelect")&&(localStorage.terrain=gid("terrainSelect").value);Game.terrainType=localStorage.terrain;a=terrainSelect[Game.terrainType||"grass"];ms(a);fastXHR(me.cdn+a.url,setupAddon,showProgress)})},loadCDN=function(){textureAtlas.started=!0;loadContent(loadCDN.content)};
loadCDN.content={icons:"icons.png",common:"common.neh2"};var terrainSelect={grass:{url:"grass.neh2",size:30,id:0},trenkorian:{url:"trenkorian.neh2",size:36,id:1}},terrainColor;
(function(){ONDESKTOP||("serviceWorker"in navigator?(console.log("CLIENT: service worker registration in progress."),navigator.serviceWorker.register("sworker.js").then(function(d){console.log("CLIENT: service worker registration complete.")},function(d){ms(d);console.log("CLIENT: service worker registration failure.")}),navigator.serviceWorker.oncontrollerchange=function(){console.log("page controlled by:",navigator.serviceWorker.controller);location.reload(!0)}):console.log("CLIENT: service worker is not supported."))})();
var varfuncRender=function(){},msgTranslator="GENERAL_DEFGAMENAME;GENERAL_GAMENAME;GENERAL_VERSION;GENERAL_NET_TITLE;GENERAL_CANCEL;GENERAL_OK;GENERAL_YES;GENERAL_NO;GENERAL_CLOSE;GENERAL_IGNORE;GENERAL_ABORT;GENERAL_YOUSURE;GENERAL_REFRESH;GENERAL_KICK;GENERAL_QLOAD;GENERAL_QSAVE;ADDS_MOREHOUSES;ADDS_AISEND;CHECK_INSERTCD;CHECK_INSERTCD2;CHECK_INSERTCD3;CHECK_NOCD;CHECK_BADEXE;ERR_CTFCANTSPAWN;ERR_DXFAILED;ERR_VMODE;ERR_OFFSCREEN;ERR_GPF;ERR_INCORRECTVER;ERR_GAMEFULL;ERR_BROWSEFAIL;ERR_NONET;ERR_SNDINIT;ERR_GAMECREATE;ERR_GAMELOAD;ERR_GAMELOAD2;ERR_DEMOVER;ERR_DEMORNDMAP;ERR_INVALIDCFG;ERR_INITMIDI;ERR_DSINIT;ERR_MCIINIT;ERR_BETACONNECT;ERR_SERVERCANCEL;ERR_SERVERKICK;ERR_ORDERROOM;ERR_MENUROOM;ERR_NETASYNC;ERR_NETASYNC2;ERR_NETASYNCBAD;ERR_NOTERRAIN;ERR_NOMAP;ERR_CLIENTSYNC;ERR_RULESLOAD;ERR_MAPWRONGVER;ERR_WRONGAI;ERR_WRONGOBJS;ERR_UNKNOWN;ERR_FATAL;ERR_NONFATAL;ERR_ERRORCODE;DEFMSG_MOVEDAVANCE;DEFMSG_MOVESNEAK;DEFMSG_ATTACK;DEFMSG_ATTACKTYPE;DEFMSG_ENTERHOLDER;DEFMSG_MINE;DEFMSG_BUILD;DEFMSG_REPAIR;DEFMSG_DIG;DEFMSG_CAPTURE;DEFMSG_CHOP;DEFMSG_ENTERSHIP;DEFMSG_FISHING;DEFMSG_PICKITEM;DEFMSG_PICKITEMINST;DEFMSG_GATHERRESITEMS;DEFMSG_TENDCOWS;DEFMSG_LEAVETRADE;DEFMSG_RETURNGOODS;DEFMSG_DUMMYTRAIN;DEFMSG_REMOVERALLYPOINT;DEFMSG_SETRALLYPOINT;DEFMSG_SETRALLYPOINTDA;DEFMSG_SETRALLYPOINTADV;DEFMSG_NOMAPTITLE;DEFMSG_NODECR;Q_QUIT_TITLE;Q_QUIT;Q_RESIGN;Q_DISCONNECT;MSG_CLIENT_QUIT;MSG_LOAD_OBJDEFS;MSG_LOAD_TERRAIN;MSG_LOAD_OBJECTS;MSG_LOAD_FINAL;MSG_LOAD_AI;MSG_LOAD_DONE;MSG_GAME_DESTROY;MSG_GAME_CREATE;MSG_GAME_RANDOM;MSG_GAME_RESTART;MSG_GAME_LOAD;MSG_GAME_LOAD_OBJ;MSG_GAME_INIT;MSG_RESADDED;MSG_NET_JOIN;MSG_NET_BROWSE;MSG_TREE;MSG_GAME_SPEED;MSG_GAME_SPEED_SLOWEST;MSG_GAME_SPEED_SLOW;MSG_GAME_SPEED_NORMAL;MSG_GAME_SPEED_FAST;MSG_GAME_SPEED_FASTEST;MSG_SYS_ERROR;MSG_SYS_TITLE;MSG_SYS_CONT;MSG_SYS_ABORT;MSG_SYS_YES;MSG_SYS_NO;MSG_SYS_IGNORE;MSG_DISCONNECT;VIEWMSG_POPLIMIT1;VIEWMSG_POPLIMIT2;VIEWMSG_NOTGOLD;VIEWMSG_NOTMANNA;VIEWMSG_NOTPOWER;VIEWMSG_MAGICGATEWAYCAP;VIEWMSG_QUICKSAVED;VIEWMSG_NOMPCHEAT;VIEWMSG_CHEATSENABLED;VIEWMSG_PLAYER_RESIGNED;VIEWMSG_PLAYER_DISCONECTED;VIEWMSG_PLAYER_DEFEATED;VIEWMSG_NEWQUEST;VIEWMSG_DEMO_END;VIEWMSG_NOTRES;VIEWMSG_GOLD;VIEWMSG_STONE;VIEWMSG_FOOD;VIEWMSG_WOOD;VIEWMSG_MANNA;VIEWMSG_SELL_ITEM;VIEWMSG_WAIT_PLAYERS;VIEWMSG_WAIT_RESPONSE;VIEWMSG_PLAYER_ENEMY;VIEWMSG_PLAYER_NEUTRAL;VIEWMSG_PLAYER_ALLY;VIEWMSG_PLAYER_WANT_ENEMY;VIEWMSG_PLAYER_WANT_NEUTRAL;VIEWMSG_PLAYER_WANT_ALLY;VIEWMSG_SPELL_LEARNED;VIEWMSG_PAUSE;NOTIFY_UNDER_ATTACK;NOTIFY_CAPTURED;NOTIFY_KILLED;NOTIFY_DESTROYED;NOTIFY_BUILT;NOTIFY_PRODUCED;NOTIFY_DISCOVERED;NOTIFY_UPGRADED;SELVIEW_UNITS;SELVIEW_BERSERKKINGDOM;MAINSCR_SINGLE;MAINSCR_MULTI;MAINSCR_PREF;MAINSCR_CREDITS;MAINSCR_QUIT;SINGLESCR_CAMPAIGN;SINGLESCR_CUSTOM;SINGLESCR_RANDOM;SINGLESCR_LOAD;SINGLESCR_BACK;SP_CHOOSEMAP_T_CUSTOMMAP;SP_CHOOSEMAP_T_MAP;SP_CHOOSEMAP_T_DESCRIPTION;SP_CHOOSEMAP_PLAY;SP_CHOOSEMAP_BACK;SP_SETUPMAP_T_NUM_PLAYERS;SP_SETUPMAP_T_GAME_TYPE;SP_SETUPMAP_T_VICT_COND;SP_SETUPMAP_T_SCORE_LIM;SP_SETUPMAP_T_TIME_LIM;SP_SETUPMAP_T_DIFF_LVL;SP_SETUPMAP_T_ST_RES;SP_SETUPMAP_T_MAP_DECR;SP_SETUPMAP_T_FOG;SP_SETUPMAP_T_EXPOLRE;SP_SETUPMAP_T_MAPDEF;SP_SETUPMAP_T_POPLIMIT;SP_SETUPMAP_BACK;SP_SETUPMAP_PLAY;SP_SETUPMAP_RACE_0;SP_SETUPMAP_RACE_1;SP_SETUPMAP_RACE_2;SP_SETUPMAP_RACE_3;SP_SETUPMAP_G_TYPE_0;SP_SETUPMAP_G_TYPE_1;SP_SETUPMAP_G_TYPE_2;SP_SETUPMAP_VCOND_0;SP_SETUPMAP_VCOND_1;SP_SETUPMAP_VCOND_2;SP_SETUPMAP_VCOND_3;SP_SETUPMAP_DIFFLVL_0;SP_SETUPMAP_DIFFLVL_1;SP_SETUPMAP_DIFFLVL_2;SP_SETUPMAP_RESURCS_0;SP_SETUPMAP_RESURCS_1;SP_SETUPMAP_RESURCS_2;SP_SETUPMAP_RESURCS_3;MP_SEARCH_T_PL_NAME;MP_SEARCH_T_IPX;MP_SEARCH_T_TCP;MP_SEARCH_T_IP;MP_SEARCH_T_LOBBY;MP_SEARCH_T_GAMES;MP_SEARCH_T_INFORM;MP_SEARCH_T_GAMENAME;MP_SEARCH_CREATE;MP_SEARCH_SEARCH;MP_SEARCH_JOIN;MP_SEARCH_BACK;MP_MPLAYER_PLAY;MP_MPLAYER_SETTINGS;MP_MPLAYER_DISCONNECT;MP_MPLAYER_RACE_0;MP_MPLAYER_RACE_1;MP_MPLAYER_RACE_2;MP_MPLAYER_RACE_3;MP_MPLAYER_NAME_0;MP_MPLAYER_NAME_1;MP_MPLAYER_NAME_2;MP_SETUPMAP_T_RANDOM;MP_SETUPMAP_T_CUSTOM;MP_SETUPMAP_T_CUSTOM_LIST;MP_SETUPMAP_T_MAP_DECR;MP_SETUPMAP_T_GAME_TYPE;MP_SETUPMAP_T_VICT_COND;MP_SETUPMAP_T_SCORE_LIM;MP_SETUPMAP_T_TIME_LIM;MP_SETUPMAP_T_DIFF_LVL;MP_SETUPMAP_T_ST_RES;MP_SETUPMAP_T_MAP_SIZE;MP_SETUPMAP_T_MAP_RES;MP_SETUPMAP_T_MAP_TYPE;MP_SETUPMAP_T_TERRAIN;MP_SETUPMAP_T_GSLOCATIONS;MP_SETUPMAP_T_ANIMALS;MP_SETUPMAP_T_RIVERS;MP_SETUPMAP_T_MITEMS;MP_SETUPMAP_T_CLIFFS;MP_SETUPMAP_T_FOG;MP_SETUPMAP_T_EXPOLRE;MP_SETUPMAP_T_WEATHER;MP_SETUPMAP_T_DAY;MP_SETUPMAP_T_POPLIMIT;MP_SETUPMAP_T_USEMAPSET;MP_SETUPMAP_T_GATEWAYS;MP_SETUPMAP_T_COMP;MP_SETUPMAP_T_OPEN;MP_SETUPMAP_T_DISABLE;MP_SETUPMAP_G_TYPE_0;MP_SETUPMAP_G_TYPE_1;MP_SETUPMAP_G_TYPE_2;MP_SETUPMAP_VCOND_0;MP_SETUPMAP_VCOND_1;MP_SETUPMAP_VCOND_2;MP_SETUPMAP_VCOND_3;MP_SETUPMAP_DIFFLVL_0;MP_SETUPMAP_DIFFLVL_1;MP_SETUPMAP_DIFFLVL_2;MP_SETUPMAP_RESURCS_0;MP_SETUPMAP_RESURCS_1;MP_SETUPMAP_RESURCS_2;MP_SETUPMAP_RESURCS_3;MP_SETUPMAP_CANCEL;MP_SETUPMAP_ACCEPT;MP_SETUPMAP_M_SIZE_0;MP_SETUPMAP_M_SIZE_1;MP_SETUPMAP_M_SIZE_2;MP_SETUPMAP_M_SIZE_3;MP_SETUPMAP_M_SIZE_4;MP_SETUPMAP_M_SIZE_5;MP_SETUPMAP_M_SIZE_6;MP_SETUPMAP_M_RES_0;MP_SETUPMAP_M_RES_1;MP_SETUPMAP_M_RES_2;MP_SETUPMAP_M_TYPE_0;MP_SETUPMAP_M_TYPE_1;MP_SETUPMAP_M_TYPE_2;MP_SETUPMAP_M_TYPE_3;MP_SETUPMAP_M_TYPE_4;MP_SETUPMAP_M_TYPE_5;MP_SETUPMAP_AI_ASSIST;GAME_SCR_MENU;GAME_SCR_DIPLOMACY;GAME_SCR_CHAT;DLG_BTNS_OK;DLG_BTNS_CANCEL;WND_QUESTS_CURQUEST;WND_QUESTS_CLOSE;WND_QUESTS_PAGE;WND_QUESTS_NONE;WND_MESSAGE_CLOSE;SP_SETUPRND_T_NUM_PLAYERS;SP_SETUPRND_T_GAME_TYPE;SP_SETUPRND_T_VICT_COND;SP_SETUPRND_T_SCORE_LIM;SP_SETUPRND_T_TIME_LIM;SP_SETUPRND_T_DIFF_LVL;SP_SETUPRND_T_ST_RES;SP_SETUPRND_T_FOG;SP_SETUPRND_T_EXPOLRE;SP_SETUPRND_T_MAP_SIZE;SP_SETUPRND_T_MAP_RES;SP_SETUPRND_T_MAP_TYPE;SP_SETUPRND_T_TERRAIN;SP_SETUPRND_T_GSLOCATIONS;SP_SETUPRND_T_ANIMALS;SP_SETUPRND_T_RIVERS;SP_SETUPRND_T_MITEMS;SP_SETUPRND_T_CLIFFS;SP_SETUPRND_T_POPLIMIT;SP_SETUPRND_T_GATEWAYS;SP_SETUPRND_BACK;SP_SETUPRND_PLAY;SP_SETUPRND_RACE_0;SP_SETUPRND_RACE_1;SP_SETUPRND_RACE_2;SP_SETUPRND_RACE_3;SP_SETUPRND_G_TYPE_0;SP_SETUPRND_G_TYPE_1;SP_SETUPRND_G_TYPE_2;SP_SETUPRND_VCOND_0;SP_SETUPRND_VCOND_1;SP_SETUPRND_VCOND_2;SP_SETUPRND_VCOND_3;SP_SETUPRND_DIFFLVL_0;SP_SETUPRND_DIFFLVL_1;SP_SETUPRND_DIFFLVL_2;SP_SETUPRND_RESURCS_0;SP_SETUPRND_RESURCS_1;SP_SETUPRND_RESURCS_2;SP_SETUPRND_RESURCS_3;SP_SETUPRND_M_SIZE_0;SP_SETUPRND_M_SIZE_1;SP_SETUPRND_M_SIZE_2;SP_SETUPRND_M_SIZE_3;SP_SETUPRND_M_SIZE_4;SP_SETUPRND_M_SIZE_5;SP_SETUPRND_M_SIZE_6;SP_SETUPRND_M_RES_0;SP_SETUPRND_M_RES_1;SP_SETUPRND_M_RES_2;SP_SETUPRND_M_TYPE_0;SP_SETUPRND_M_TYPE_1;SP_SETUPRND_M_TYPE_2;SP_SETUPRND_M_TYPE_3;SP_SETUPRND_M_TYPE_4;SP_SETUPRND_M_TYPE_5;OPTIONS_T_SOPT;OPTIONS_T_SVOL;OPTIONS_T_USP;OPTIONS_T_BS;OPTIONS_T_NS;OPTIONS_T_MOPT;OPTIONS_T_MV;OPTIONS_T_CD;OPTIONS_T_GOPT;OPTIONS_T_GS;OPTIONS_T_SS;OPTIONS_T_PD;OPTIONS_T_UINT;OPTIONS_T_HC;OPTIONS_T_ML;OPTIONS_T_WE;OPTIONS_T_DN;OPTIONS_OK;ENDGAMEDLG_QUIT;ENDGAMEDLG_LOAD;ENDGAMEDLG_SAVE;ENDGAMEDLG_NEXT;ENDGAMEDLG_STAT;ENDGAMEDLG_RESTART;ENDGAMEDLG_WIN1;ENDGAMEDLG_WIN2;ENDGAMEDLG_LOSE1;ENDGAMEDLG_LOSE2;PEONS_CHOP;PEONS_DIG;PEONS_MINE;PEONS_BUILD;PEONS_REPAIR;PEONS_TEND COWS;PEONS_EXPLORE;PEONS_CAPTURE;PEONS_ATTACK;PEONS_AI FAR BUILD;PEONS_GATHER RESOURCE ITEMS;PEONS_USE TRANSPORT;CHAT_T_CHAT;LOAD_T_LOAD;LOAD_TYPE_0;LOAD_TYPE_1;LOAD_TYPE_2;LOAD_LOAD;LOAD_DEL;LOAD_CANCEL;SAVE_T_SAVE;SAVE_NEW;SAVE_SAVE;SAVE_DEL;SAVE_CANCEL;CAMPAIGN_T_CAM;CAMPAIGN_T_DESCR;CAMPAIGN_T_EMISS;CAMPAIGN_T_EMISDES;CAMPAIGN_BACK;CAMPAIGN_PLAY;EDIT_T_GAMENAME;DIPLOMACY_T_TITLE;DIPLOMACY_TRIBUTE;DIPLOMACY_SHVICTORY;DIPLOMACY_ACCEPT;DIPLOMACY_CANCEL;TRIBUTE_T_TITLE;TRIBUTE_CANCEL;TRIBUTE_SEND;MENU_INST;MENU_LOAD;MENU_SAVE;MENU_OPTI;MENU_REST;MENU_QUIT;MENU_BACK;MENU_SURR;MENU_DISCONNECT;OBJECTS_ACADEMY;OBJECTS_ARCHER;OBJECTS_BALLISTA;OBJECTS_BARRACK;OBJECTS_BAT;OBJECTS_BEAR;OBJECTS_BIRD;OBJECTS_BLACKSMITH;OBJECTS_BRIDGE;OBJECTS_CARPET;OBJECTS_CASTLE;OBJECTS_CATAPULT;OBJECTS_CATHEDRAL;OBJECTS_CHARIOT;OBJECTS_CHURCH E;OBJECTS_CHURCH R;OBJECTS_CHURCH A;OBJECTS_COW;OBJECTS_CRUSADEANCHOR;OBJECTS_CRUSADER;OBJECTS_DRAGON;OBJECTS_DUMMY;OBJECTS_DWARF;OBJECTS_EAGLE;OBJECTS_ENICHAR;OBJECTS_FARM;OBJECTS_FIELD;OBJECTS_FISH;OBJECTS_FISHING_BOAT;OBJECTS_FISHPATCH;OBJECTS_FOOTMAN E;OBJECTS_FOOTMAN A;OBJECTS_FOOTMAN R;OBJECTS_GALLEON;OBJECTS_GATE_STONE;OBJECTS_GATE_WOOD;OBJECTS_GHOST;OBJECTS_GROUND_OBJECT;OBJECTS_GROUND_PATCH;OBJECTS_HARBOR;OBJECTS_HCATAPULT;OBJECTS_HEAVY_CAVALRY;OBJECTS_HORSE_ARCHER;OBJECTS_HORSE_SAMURAI;OBJECTS_HOUSE;OBJECTS_HULK;OBJECTS_ITEM;OBJECTS_ITEM_FLAG;OBJECTS_ITEM_HEALTH;OBJECTS_ITEM_MAGIC;OBJECTS_ITEM_PLUSPLUS;OBJECTS_ITEM_SCROLL;OBJECTS_ITEM_SOUL;OBJECTS_JIHAD_WARRIOR;OBJECTS_JINN;OBJECTS_KNIGHT;OBJECTS_LONGBOWMAN;OBJECTS_LUMBER;OBJECTS_MACEMAN E;OBJECTS_MACEMAN R;OBJECTS_MACEMAN A;OBJECTS_MAGE;OBJECTS_MAGETOWER;OBJECTS_MAGICWORKSHOP;OBJECTS_MARKET;OBJECTS_MONK;OBJECTS_MOSQUE;OBJECTS_NINJA;OBJECTS_ORK;OBJECTS_OUTPOST;OBJECTS_PEON;OBJECTS_PIKEMAN;OBJECTS_PRIEST;OBJECTS_RES_GOLD;OBJECTS_RES_STONE;OBJECTS_RESITEM;OBJECTS_RUIN;OBJECTS_SHAOLINN;OBJECTS_SKELETON;OBJECTS_SPY;OBJECTS_STABLE;OBJECTS_STORAGE;OBJECTS_TAVERN;OBJECTS_TCGUILD;OBJECTS_TOWER_STONE;OBJECTS_TOWER_STONE2;OBJECTS_TOWER_WOOD;OBJECTS_TOWER_WOOD2;OBJECTS_TOWER_ROCKET;OBJECTS_TRADER E;OBJECTS_TRADER R;OBJECTS_TROLL;OBJECTS_WALL_STONE;OBJECTS_WALL_WOOD;OBJECTS_WHIRLPOOL;OBJECTS_WORKSHOP;OBJECTS_XEBEC;OBJECTS_MAGICGATEWAY;OBJECTS_EVILCASTLE;ORDERS_NAMES_???;ORDERS_NAMES_FISHING_BOAT;ORDERS_NAMES_FISHING;ORDERS_NAMES_LOAN_RETURN;ORDERS_NAMES_LOAN;ORDERS_NAMES_LOAN_GOLD;ORDERS_NAMES_LOAN_STONE;ORDERS_NAMES_LOAN_IRON;ORDERS_NAMES_LOAN_FOOD;ORDERS_NAMES_LOAN_WOOD;ORDERS_NAMES_BRIBE;ORDERS_NAMES_REVEAL_SELF;ORDERS_NAMES_IMPERSONATE;ORDERS_NAMES_BECOME_JIHADW;ORDERS_NAMES_BECOME_PRIEST;ORDERS_NAMES_CLOAK;ORDERS_NAMES_UNCLOAK;ORDERS_NAMES_MURDER;ORDERS_NAMES_ITEM_USE;ORDERS_NAMES_ITEM_DROP;ORDERS_NAMES_ITEM_KILL;ORDERS_NAMES_ITEM_BERSERK;ORDERS_NAMES_MOVE;ORDERS_NAMES_REPAIR;ORDERS_NAMES_CAPTURE;ORDERS_NAMES_HARVEST;ORDERS_NAMES_ATTACK;ORDERS_NAMES_ATTACK_GROUND;ORDERS_NAMES_HOLD_STEADY;ORDERS_NAMES_SELECT_CRUSADERS;ORDERS_NAMES_STAND_GROUND;ORDERS_NAMES_ATTACK_TYPE;ORDERS_NAMES_EXORCISM;ORDERS_NAMES_PICK_ITEM;ORDERS_NAMES_GUARD;ORDERS_NAMES_PATROL;ORDERS_NAMES_GATEOPEN;ORDERS_NAMES_GATECLOSE;ORDERS_NAMES_GATE_SUBAI_ON;ORDERS_NAMES_GATE_SUBAI_OFF;ORDERS_NAMES_E_BARRACK;ORDERS_NAMES_DUMMY;ORDERS_NAMES_TCGUILD;ORDERS_NAMES_E_BLACKSMITH;ORDERS_NAMES_MAGETOWER;ORDERS_NAMES_WALL_STONE;ORDERS_NAMES_WALL_WOOD;ORDERS_NAMES_E_BUILD;ORDERS_NAMES_R_BUILD;ORDERS_NAMES_A_BUILD;ORDERS_NAMES_E_CASTLE;ORDERS_NAMES_MAGICWORKSHOP;ORDERS_NAMES_CATHEDRAL;ORDERS_NAMES_SHAOLINN;ORDERS_NAMES_MOSQUE;ORDERS_NAMES_E_CHURCH;ORDERS_NAMES_E_FARM;ORDERS_NAMES_E_FOOTMAN;ORDERS_NAMES_A_RHONIN;ORDERS_NAMES_R_JANISSARY;ORDERS_NAMES_ORK;ORDERS_NAMES_R_SATRAP;ORDERS_NAMES_R_FOOTMAN;ORDERS_NAMES_R_SPEARMAN;ORDERS_NAMES_JINN;ORDERS_NAMES_DWARF;ORDERS_NAMES_TROLL;ORDERS_NAMES_A_HORSEARCHER;ORDERS_NAMES_R_HORSEARCHER;ORDERS_NAMES_R_CAVALRY;ORDERS_NAMES_A_HORSESAMURAI;ORDERS_NAMES_E_ARCHER;ORDERS_NAMES_R_ARCHER;ORDERS_NAMES_A_ARCHER;ORDERS_NAMES_A_SAMURAI;ORDERS_NAMES_E_MAGE;ORDERS_NAMES_R_MAGE;ORDERS_NAMES_A_MAGE;ORDERS_NAMES_E_OUTPOST;ORDERS_NAMES_E_HARBOR;ORDERS_NAMES_E_LUMBER;ORDERS_NAMES_E_MARKET;ORDERS_NAMES_E_CARAVAN;ORDERS_NAMES_R_CARAVAN;ORDERS_NAMES_GATE_WOOD;ORDERS_NAMES_GATE_STONE;ORDERS_NAMES_FIELD;ORDERS_NAMES_E_PEON;ORDERS_NAMES_R_PEON;ORDERS_NAMES_A_PEON;ORDERS_NAMES_NINJA;ORDERS_NAMES_MONK;ORDERS_NAMES_E_MACEMAN;ORDERS_NAMES_E_PRIEST;ORDERS_NAMES_A_PRIEST;ORDERS_NAMES_R_PRIEST;ORDERS_NAMES_CHARIOT;ORDERS_NAMES_E_LONGBOWMAN;ORDERS_NAMES_E_KNIGHT;ORDERS_NAMES_E_STABLE;ORDERS_NAMES_STOP;ORDERS_NAMES_E_STORAGE;ORDERS_NAMES_E_TAVERN;ORDERS_NAMES_E_WORKSHOP;ORDERS_NAMES_EMERGE;ORDERS_NAMES_E_GALLEON;ORDERS_NAMES_E_HULK;ORDERS_NAMES_E_XEBEC;ORDERS_NAMES_BRIDGE;ORDERS_NAMES_E_ACADEMY;ORDERS_NAMES_E_TOWER_STONE;ORDERS_NAMES_E_TOWER_STONE2;ORDERS_NAMES_TOWER_ROCKET;ORDERS_NAMES_E_TOWER_WOOD;ORDERS_NAMES_E_TOWER_WOOD2;ORDERS_NAMES_VIEW_HEROES;ORDERS_NAMES_VIEW_SPYS;ORDERS_NAMES_VIEW_ITEMS;ORDERS_NAMES_E_HOUSE;ORDERS_NAMES_E_PIKEMAN;ORDERS_NAMES_E_SPY;ORDERS_NAMES_CATAPULT;ORDERS_NAMES_H_CATAPULT;ORDERS_NAMES_TO_WTOWER2;ORDERS_NAMES_TO_STOWER;ORDERS_NAMES_TO_STOWER2_1;ORDERS_NAMES_TO_STOWER2_2;ORDERS_NAMES_TO_SWALL;ORDERS_NAMES_TO_SGATE;ORDERS_NAMES_TE_ARROW_1;ORDERS_NAMES_TE_PLATEARMOR;ORDERS_NAMES_TE_FIELDS;ORDERS_NAMES_TE_LIVESTOCK;ORDERS_NAMES_TE_FEUDALISM;ORDERS_NAMES_TE_ARCHITECTURE;ORDERS_NAMES_TE_LONGBOW;ORDERS_NAMES_RAISEDEAD;ORDERS_NAMES_SPELL_HEAL;ORDERS_NAMES_SPELL_SPAWNDRAGON;ORDERS_NAMES_SPELL_RAISEEXP;ORDERS_NAMES_SPELL_FLAMEBOLT;ORDERS_NAMES_SPELL_BLESS;ORDERS_NAMES_SPELL_FREEZE;ORDERS_NAMES_SPELL_WHIRLPOOL;ORDERS_NAMES_SPELL_TURNTOSTONE;ORDERS_NAMES_SPELL_LIGHTNING;ORDERS_NAMES_SPELL_FIRERAIN;ORDERS_NAMES_SPELL_SPAWNBAT;ORDERS_NAMES_SPELL_SPAWNSTONEGOLEM;ORDERS_NAMES_SPELL_SPAWNCARPET;ORDERS_NAMES_SPELL_SPAWNJIN;ORDERS_NAMES_SPELL_MAGICVISION;ORDERS_NAMES_SPELL_RAISEDEAD;ORDERS_NAMES_SPELL_BERSERK;ORDERS_NAMES_SPELL_HYPNOTIZE;ORDERS_NAMES_SPELL_CLOAK;ORDERS_NAMES_UNLOAD;ORDERS_NAMES_TRADE;ORDERS_NAMES_BUILD_ITEM;ORDERS_NAMES_TRADE1;ORDERS_NAMES_TRADE_SHIP;ORDERS_NAMES_DIE;ORDERS_NAMES_DEFAULT;ORDERS_NAMES_MINE;ORDERS_NAMES_DIG;ORDERS_NAMES_CHOP;ORDERS_NAMES_SPELL;ORDERS_NAMES_PREACH_CRUSADE;ORDERS_NAMES_COW;ORDERS_NAMES_TO_SHIP_LEVEL2;ORDERS_NAMES_TO_SHIP_LEVEL3;ORDERS_NAMES_TO_SHIP_LEVEL4;ORDERS_NAMES_TO_SHIP_LEVEL5;ORDERS_NAMES_TO_SHIP_LEVEL6;ORDERS_NAMES_TO_CONVERTRES;ORDERS_NAMES_HOLDFIRE;ORDERS_NAMES_FIREATWILL;ORDERS_NAMES_EXPLORE;ORDERS_NAMES_BALLISTA;ORDERS_NAMES_TE_HALBERD;ORDERS_NAMES_TE_GOLDPLUS;ORDERS_NAMES_TE_STONEPLUS;ORDERS_NAMES_TE_WOODPLUS;ORDERS_NAMES_TE_LEARNING;ORDERS_NAMES_TE_TEMPERIRON;ORDERS_NAMES_TE_CROSSBOW;ORDERS_NAMES_TE_SCALEARMOR;ORDERS_NAMES_TE_CHAINMAIL;ORDERS_NAMES_TE_ENGINEERING;ORDERS_NAMES_TE_CANNONTOWER;ORDERS_NAMES_TE_HEROISM;ORDERS_NAMES_TE_NOBILITY;ORDERS_NAMES_TE_HONOR;ORDERS_NAMES_TE_WARFARE;ORDERS_NAMES_TE_TACTICS;ORDERS_NAMES_TE_MERCENARIES;ORDERS_NAMES_TE_HEROESQUEST;ORDERS_NAMES_TE_FAME;ORDERS_NAMES_TE_SIEGETACTICS;ORDERS_NAMES_TE_BODYBUILDING;ORDERS_NAMES_TE_FANATICISM;ORDERS_NAMES_TE_CRUSADE;ORDERS_NAMES_TE_ESPIONAGE;ORDERS_NAMES_TE_INQUISITION;ORDERS_NAMES_TE_HEALING;ORDERS_NAMES_TE_MEDICINE;ORDERS_NAMES_TE_TRADEROUTES;ORDERS_NAMES_TE_MAPMAKING;ORDERS_NAMES_TE_USURY;ORDERS_NAMES_TE_GAMBLING;ORDERS_NAMES_TE_SUPPLYSTORAGE;ORDERS_NAMES_TE_BRIBERY;ORDERS_NAMES_TE_BUDDHISM;ORDERS_NAMES_TE_TRADETAXES;ORDERS_NAMES_TE_BAT;ORDERS_NAMES_TE_STONEGOLEM;ORDERS_NAMES_TE_INVISIBILITY;ORDERS_NAMES_TE_LIGHTNING;ORDERS_NAMES_TE_FREEZE;ORDERS_NAMES_TE_BLESS;ORDERS_NAMES_TAVERN_MERC;ORDERS_NAMES_TAVERN_HERO;ORDERS_NAMES_MARKET_ITEMS;ORDERS_NAMES_MARKET_SELL;ORDERS_NAMES_TE_LANDINGTACTICS;ORDERS_NAMES_TE_COWPOACHING;ORDERS_NAMES_TE_SLAVERY;ORDERS_NAMES_TE_RIDINGHORSES;ORDERS_NAMES_TE_JANISSARY;ORDERS_NAMES_TE_JIHAD;ORDERS_NAMES_TE_MAGICCARPET;ORDERS_NAMES_TE_JIN;ORDERS_NAMES_TE_WITCHCRAFTS;ORDERS_NAMES_TE_RAINOFFIRE;ORDERS_NAMES_TE_MAGICVISION;ORDERS_NAMES_TE_NECROMANCY;ORDERS_NAMES_GAMBLE;ORDERS_NAMES_TE_HORSEMANSHIP;ORDERS_NAMES_TE_SCIMITAR;ORDERS_NAMES_TE_OREFLOATATION;ORDERS_NAMES_TE_JEWELRY;ORDERS_NAMES_TE_GREATWALL;ORDERS_NAMES_TE_BUDHISM;ORDERS_NAMES_TE_IRRIGATION;ORDERS_NAMES_TE_ARMOREDCHARIOT;ORDERS_NAMES_TE_BUSHIDO;ORDERS_NAMES_TE_SUNTZUBOOK;ORDERS_NAMES_TE_MEDITATION;ORDERS_NAMES_TE_PHILOSOPHY;ORDERS_NAMES_TE_KUNGFU;ORDERS_NAMES_TE_NINJAS;ORDERS_NAMES_TE_MASTERY;ORDERS_NAMES_TE_TOURNAMENTS;ORDERS_NAMES_TE_BANKING;ORDERS_NAMES_TE_CHEMISTRY;ORDERS_NAMES_TE_GUNPOWDER;ORDERS_NAMES_TE_ROCKETARROW;ORDERS_NAMES_TE_SEAFOOD;ORDERS_NAMES_TE_CONCENTRATION;ORDERS_NAMES_TE_BERSERK;ORDERS_NAMES_TE_WHIRLPOOL;ORDERS_NAMES_TE_DRAGON;ORDERS_NAMES_TE_TURNTOSTONE;ORDERS_NAMES_TE_FLAMEBOLT;ORDERS_NAMES_TE_ARTOFRIDING;ORDERS_NAMES_BUILD_ORC;ORDERS_NAMES_BUILD_DWARF;ORDERS_NAMES_BUILD_SKELETON;ORDERS_NAMES_BUILD_GHOST;ORDERS_NAMES_VIEW_QUESTS;ORDERS_NAMES_R_JIHAD_WARRIOR;ORDERS_NAMES_E_COMMON;ORDERS_NAMES_E_RARE;ORDERS_NAMES_E_GUILDS;ORDERS_NAMES_R_COMMON;ORDERS_NAMES_R_RARE;ORDERS_NAMES_R_GUILDS;ORDERS_NAMES_A_COMMON;ORDERS_NAMES_A_RARE;ORDERS_NAMES_A_GUILDS;ORDERS_NAMES_TR_TRADE;ORDERS_NAMES_TR_CANCEL;ORDERS_NAMES_TR_AMOUNT;ORDERS_NAMES_TR_SRCOBJ;ORDERS_NAMES_TR_SRCRES;ORDERS_NAMES_TR_DSTOBJ;ORDERS_NAMES_TR_DSTRES;ORDERS_NAMES_GM_RES;ORDERS_NAMES_GM_AMOUNT;ORDERS_NAMES_GM_PROP;ORDERS_NAMES_GM_GAMBLE;ORDERS_NAMES_GM_CANCEL;ORDERS_NAMES_BU_ITEM;ORDERS_NAMES_BU_AMOUNT;ORDERS_NAMES_BU_CANCEL;ORDERS_NAMES_BU_BUILD;ORDERS_NAMES_TR1_TRADE;ORDERS_NAMES_TR1_CANCEL;ORDERS_NAMES_TR1_AMOUNT1;ORDERS_NAMES_TR1_AMOUNT2;ORDERS_NAMES_TR1_SRCRES;ORDERS_NAMES_TR1_DSTRES;ORDERS_ADD_TE_SLAVERY;ORDERS_ADD_TE_STONEGOLEM;ORDERS_ADD_TE_FREEZE;ORDERS_ADD_TE_LIGHTNING;ORDERS_ADD_TE_INVISIBILITY;ORDERS_ADD_TE_BAT;ORDERS_ADD_TE_CRUSADE;ORDERS_ADD_TE_BLESS;ORDERS_ADD_TE_LONGBOW;ORDERS_ADD_TE_PLATEARMOR;ORDERS_ADD_TE_FIELDS;ORDERS_ADD_TE_LIVESTOCK;ORDERS_ADD_TE_FEUDALISM;ORDERS_ADD_TE_ARCHITECTURE;ORDERS_ADD_TE_LONGBOWMAN;ORDERS_ADD_TE_HALBERD;ORDERS_ADD_TE_GOLDPLUS;ORDERS_ADD_TE_STONEPLUS;ORDERS_ADD_TE_WOODPLUS;ORDERS_ADD_TE_LEARNING;ORDERS_ADD_TE_TEMPERIRON;ORDERS_ADD_TE_CROSSBOW;ORDERS_ADD_TE_SCALEARMOR;ORDERS_ADD_TE_CHAINMAIL;ORDERS_ADD_TE_ENGINEERING;ORDERS_ADD_TE_CANNONTOWER;ORDERS_ADD_TE_HEROISM;ORDERS_ADD_TE_NOBILITY;ORDERS_ADD_TE_HONOR;ORDERS_ADD_TE_WARFARE;ORDERS_ADD_TE_TACTICS;ORDERS_ADD_TE_MERCENARIES;ORDERS_ADD_TE_HEROESQUEST;ORDERS_ADD_TE_FAME;ORDERS_ADD_TE_SIEGETACTICS;ORDERS_ADD_TE_BODYBUILDING;ORDERS_ADD_TE_FANATICISM;ORDERS_ADD_TE_ESPIONAGE;ORDERS_ADD_TE_INQUISITION;ORDERS_ADD_TE_HEALING;ORDERS_ADD_TE_MEDICINE;ORDERS_ADD_TE_TRADETOUTES;ORDERS_ADD_TE_MAPMAKING;ORDERS_ADD_TE_PIRACY;ORDERS_ADD_TE_USURY;ORDERS_ADD_TE_SUPPLYSTORAGE;ORDERS_ADD_TE_BRIBERY;ORDERS_ADD_TE_BUDDHISM;ORDERS_ADD_TE_TRADETAXES;ORDERS_ADD_TE_LANDINGTACTICS;ORDERS_ADD_TE_BOARDINGRAM;ORDERS_ADD_TE_COWPOACHING;ORDERS_ADD_TE_RIDINGHORSES;ORDERS_ADD_TE_JANISSARY;ORDERS_ADD_TE_JIHAD;ORDERS_ADD_TE_MAGICCARPET;ORDERS_ADD_TE_JIN;ORDERS_ADD_TE_WITCHCRAFTS;ORDERS_ADD_TE_MAGICVISION;ORDERS_ADD_TE_NECROMANCY;ORDERS_ADD_TE_HORSEMANSHIP;ORDERS_ADD_TE_SCIMITAR;ORDERS_ADD_TE_OREFLOATATION;ORDERS_ADD_TE_JEWELRY;ORDERS_ADD_TE_GREATWALL;ORDERS_ADD_TE_BUDHISM;ORDERS_ADD_TE_IRRIGATION;ORDERS_ADD_TE_ARMOREDCHARIOT;ORDERS_ADD_TE_BUSHIDO;ORDERS_ADD_TE_SUNTZUBOOK;ORDERS_ADD_TE_MEDITATION;ORDERS_ADD_TE_PHILOSOPHY;ORDERS_ADD_TE_KUNGFU;ORDERS_ADD_TE_NINJAS;ORDERS_ADD_TE_MASTERY;ORDERS_ADD_TE_TOURNAMENTS;ORDERS_ADD_TE_BANKING;ORDERS_ADD_TE_CHEMISTRY;ORDERS_ADD_TE_GUNPOWDER;ORDERS_ADD_TE_ROCKETARROW;ORDERS_ADD_TE_SEAFOOD;ORDERS_ADD_TE_CONCENTRATION;ORDERS_ADD_TE_BERSERK;ORDERS_ADD_TE_WHIRLPOOL;ORDERS_ADD_TE_DRAGON;ORDERS_ADD_TE_TURNTOSTONE;ORDERS_ADD_TE_FLAMEBOLT;ORDERS_ADD_TE_ARTOFRIDING;ORDERS_ADD_TE_TRADEROUTES;ORDERS_ADD_TE_GAMBLE;SPELL_NAMES_SPELL_FIRERAIN;SPELL_NAMES_SPELL_LIGHTNING;SPELL_NAMES_SPELL_HEAL;SPELL_NAMES_SPELL_SPAWNCARPET;SPELL_NAMES_SPELL_SPAWNBAT;SPELL_NAMES_SPELL_BLESS;SPELL_NAMES_SPELL_FREEZE;SPELL_NAMES_SPELL_BERSERK;SPELL_NAMES_SPELL_SOULBIND;SPELL_NAMES_SPELL_CLOAK;SPELL_NAMES_SPELL_SPAWNSTONEGOLEM;SPELL_NAMES_SPELL_MAGICVISION;SPELL_NAMES_SPELL_RAISEDEAD;SPELL_NAMES_SPELL_TURNTOSTONE;SPELL_NAMES_SPELL_WHIRLPOOL;SPELL_NAMES_SPELL_SPAWNDRAGON;SPELL_NAMES_SPELL_FLAMEBOLT;SPELL_NAMES_SPELL_RAISEEXP;SPELL_NAMES_SPELL_SPAWNJIN;SPELL_NAMES_SPELL_CURSE;SPELL_NAMES_SPELL_HYPNOTIZE;IMAGES_FLAG_CAPTURE;IMAGES_ITEM_BOOK1;IMAGES_ITEM_BOOK2;IMAGES_ITEM_BOOK3;IMAGES_ITEM_BOW1;IMAGES_ITEM_BOW2;IMAGES_ITEM_BOW3;IMAGES_ITEM_FLAG;IMAGES_ITEM_FOOD;IMAGES_ITEM_GOLD;IMAGES_ITEM_IRON;IMAGES_ITEM_POTION1;IMAGES_ITEM_POTION2;IMAGES_ITEM_POTION3;IMAGES_ITEM_POTION4;IMAGES_ITEM_POTION5;IMAGES_ITEM_POTION6;IMAGES_ITEM_POTION7;IMAGES_ITEM_POTION8;IMAGES_ITEM_SCROLL1;IMAGES_ITEM_SHIELD1;IMAGES_ITEM_SHIELD2;IMAGES_ITEM_SHIELD3;IMAGES_ITEM_STONE;IMAGES_ITEM_SWORD;IMAGES_ITEM_SWORD1;IMAGES_ITEM_SWORD2;IMAGES_ITEM_SWORD3;IMAGES_ITEM_WOOD;TZAREDIT_S1;TZAREDIT_S2;HELP_???;HELP_SP_CAMPAIGN;HELP_SP_CUSTOM_MAP;HELP_SP_RANDOM_MAP;HELP_SP_LOAD_GAME;HELP_SP_BACK;HELP_CN_CAMPAIGNS;HELP_CN_CAMPAIGN_DESCRIPTION;HELP_CN_ENTRY_MISSONS;HELP_CN_ENTRY_MISSONS_DESCRIPTION;HELP_CN_BACK;HELP_CN_PLAY;HELP_CM_MAPS;HELP_CM_MAP_DECRIPTION;HELP_CM_PLAY;HELP_CM_BACK;HELP_RM_PLAYER_COLOR;HELP_RM_PLAYER_NAME;HELP_RM_PLAYER_CIVILIVIZATION;HELP_RM_PLAYER_TEAM;HELP_RM_NUMBER_OF_PLAYERS;HELP_RM_POP_LIMIT;HELP_RM_GAME_TYPE;HELP_RM_DIFFICULTY_LEVEL;HELP_RM_VICTORY_CONDITION;HELP_RM_STARTING_RESOURCES;HELP_RM_NO_FOG;HELP_RM_EXPLORE;HELP_RM_MAP_SIZE;HELP_RM_MAP_TYPE;HELP_RM_TERRAIN;HELP_RM_MAP_RESOURCES;HELP_RM_GUARDED_TOWN;HELP_RM_AMNIMALS;HELP_RM_MAGIC_ITEMS;HELP_RM_CLIFFS;HELP_RM_GATEWAYS;HELP_RM_PLAY;HELP_RM_BACK;HELP_RM_VALUE;HELP_LG_SELECT_GAME;HELP_LG_CHOOSE;HELP_LG_LOAD;HELP_LG_CANCEL;HELP_LG_DELETE;HELP_MP_PLAYER_NAME;HELP_MP_GAME_NAME;HELP_MP_IPX;HELP_MP_TCP/IP;HELP_MP_IP_ADDRESS;HELP_MP_CREATE;HELP_MP_SEARCH;HELP_MP_JOIN;HELP_MP_BACK;HELP_MP_GAMES_FOUND;HELP_MP_GAME_INFORMATION;HELP_MP_BETA;HELP_MPC_CHECK_BUTTON;HELP_MPC_PLAYER_COLOR;HELP_MPC_PLAYER_NAME;HELP_MPC_PLAYER_CIVILIVIZATION;HELP_MPC_PLAYER_TEAM;HELP_MPC_CHAT_BOX;HELP_MPC_CHAT_BOX_WRITE;HELP_MPC_SETTINGS;HELP_MPC_MAP;HELP_MPC_DISCONNECT;HELP_MPC_PLAY;HELP_MPS_RANDOM_MAP;HELP_MPS_CUSTOM_MAP;HELP_MPS_POP_LIMIT;HELP_MPS_GAME_TYPE;HELP_MPS_DIFFICULTY_LEVEL;HELP_MPS_VICTORY_CONDITION;HELP_MPS_STARTING_RESOURCES;HELP_MPS_MAP_SIZE;HELP_MPS_MAP_TYPE;HELP_MPS_TERRAIN;HELP_MPS_MAP_RESOURCES;HELP_MPS_TOWERS;HELP_MPS_AMNIMALS;HELP_MPS_MAGIC_ITEMS;HELP_MPS_CLIFFS;HELP_MPS_GATEWAYS;HELP_MPS_DAY_NIGTH;HELP_MPS_WEATHER;HELP_MPS_NO_FOG;HELP_MPS_EXPLORE;HELP_MPS_ACCEPT;HELP_MPS_CANCEL;HELP_MPS_MAPS_LIST;HELP_MPS_MAP_DECRIPTION;HELP_MPS_USE_MAP_SETTINGS;HELP_MPS_VALUE;HELP_SG_SAVE_GAME;HELP_SG_NEW;HELP_SG_SAVE;HELP_SG_DELETE;HELP_SG_CANCEL;HELP_SG_RESTART;HELP_SG_QUIT;HELP_SG_LIST;HELP_CH_BOX;HELP_CH_ALLIES;HELP_CH_ENEMIES;HELP_CH_ALL;HELP_CH_CUSTOM;HELP_CH_SELECT_PLAYER;HELP_CH_NAMES;HELP_CH_COLORS;HELP_D_ALLIES;HELP_D_ENEMIES;HELP_D_NEUTRAL;HELP_D_SHARED VISION;HELP_D_SHARED RESOURCES;HELP_D_SHARED UNIT CONTROL;HELP_D_SHARED_VICTORY;HELP_D_ACCEPT;HELP_D_CANCEL;HELP_D_TRIBUTE;HELP_T_AMOUNT;HELP_T_SEND;HELP_T_CANCEL;HELP_CM1_PLAYER_COLOR;HELP_CM1_PLAYER_NAME;HELP_CM1_PLAYER_CIVILIVIZATION;HELP_CM1_PLAYER_TEAM;HELP_CM1_NUMBER_OF_PLAYERS;HELP_CM1_POP_LIMIT;HELP_CM1_GAME_TYPE;HELP_CM1_DIFFICULTY_LEVEL;HELP_CM1_VICTORY_CONDITION;HELP_CM1_STARTING_RESOURCES;HELP_CM1_NO_FOG;HELP_CM1_EXPLORE;HELP_CM1_USE_MAP_SETTINGS;HELP_CM1_MAP_DECRIPTION;HELP_CM1_VALUE;HELP_CM1_BACK;HELP_CM1_PLAY;HELP_O_SOUND_VOLUME;HELP_O_CHK_VOLUME;HELP_O_UNIT_SPEECH;HELP_O_BUILDING_SOUND;HELP_O_NATURE_SOUND;HELP_O_GAME_SPEED;HELP_O_SCROLL_SPEED;HELP_O_PATH_DEPTH;HELP_O_DAY_NIGTH;HELP_O_WEATHER;HELP_O_MUSIC_VOLUME;HELP_O_CHK_MVOLUME;HELP_O_CD;HELP_O_H_CURS;HELP_O_MENU;HELP_O_OK;HELP_MPS_AI_ASSIST;HELP_MPS_SH_RES;HELP_MPS_TOWERS_POP;VM_LOC_SENT;VM_BOOKMARK_SET;VM_TIME_LIMIT_HIT;VM_TIME_LIMIT_REACHED;VM_SCORE_LIMIT_HIT;VM_SCORE_LIMIT_REACHED;VM_SAVING;VM_DISCON1;VM_DISCON2;TZAREDIT_DELETE;TZAREDIT_ANY;TZAREDIT_MILITARY_UNITS;TZAREDIT_DELAY;TZAREDIT_REMOVE;OBJECTS_MESSIAH;ERR_NOMAPS;ERR_FIRST;ERR_EXPLASYNC;ERR_OBJASYNC;ERR_BADKINGDOMSCRIPT;ORDERS_NAMES_TE_INVINSIBILITY;ORDERS_NAMES_TE_IRONPLUS;ORDERS_NAMES_TO_WALL_STONE;ORDERS_NAMES_TO_GATE_STONE;ORDERS_NAMES_VIEW_AI;ORDERS_NAMES_SET_AI_NONE;ORDERS_NAMES_SET_AI_FULL;ORDERS_NAMES_SET_AI_WAR;ORDERS_NAMES_SET_AI_ECO;CHOOSEAI_TITLE;CHOOSEAI_OK;CHOOSEAI_CANCEL;CHOOSEAI_DEFAULT;ENDGAMEDLG_HIDE;MISC_SELLITEM3;MISC_HERO3;MISC_KINGDOM3;MISC_QUICKSAVE3;MISC_AUTOSAVE3;MISC_NATURE3;MISC_RESCUE3;MISC_BUY3;MISC_PREVPAGE3;MISC_NEXTPAGE3;MISC_VIEW3;MISC_REQ3;MISC_INF3;MISC_HIRE3;MISC_RETLOAN3;MISC_GETLOAN3;MISC_WATOBJ3;MISC_RES3;MISC_TREES3;MISC_UNK3;MISC_RND3;MISC_UNKAUTHOR3;MISC_HEALTH3;MISC_EXP3;MISC_MANNA3;MISC_DEFENCE3;MISC_ATTACK3;MISC_SWORD3;MISC_SHIELD3;MISC_BOW3;MSG_GAME_CONNECT;MSG_GAME_SPEED_TURBO;MSG_AIFULL3;MSG_AIECO3;MSG_AIWAR3;MSG_AIOFF3;MSG_NET_JOIN_HEADOFF;MSG_GOLDREQ;MSG_GAME_SPEED2;ERR3_ERR_CONNECT;ERR3_RANKSLOST;ORDERS_NAMES_DESTROY;ORDERS_NAMES_ONLINEHELP;ORDERS_NAMES_NEXTIDLE;ORDERS_NAMES_BOOK_ITM;ORDERS_NAMES_POTION_ITM;ORDERS_NAMES_POWER_ITM;TZAREDIT_ANY_MAJOR_OBJECTS;DEFMSG_CAPTUREOWN;MP_SETUPMAP_SH_RES;MP_SETUPMAP_TOWERS_POP;VM_SENDRESULTS;VM_SENDRESULTS2;SYSTEM_LANGUAGE;DOWNLOADING_GRAPHICS;WEBAUDIO;CONNECTION_ERROR;DOWNLOAD_ALL;MAPEDITOR;TEAM;COLOUR;MAXHEALTH;PLAYING;WAITING;ADD;WATER;AUTOFULLSCREEN;FULLSCREEN;UP;DOWN;LANGUAGE;INITIAL_PEASANTS;ADD_AI;RACE;DATE;FREE_POP;ABOUT;PLAYED_TIME;ZOOMSPEED".split(";");var context,archerSound,arrowSoundTower,swordSound,catapultSound,handSound,hswordSound,orkSound,shipSound,ghostSound,mageSound,dieSoundBuild,siegeDieSound,hdieSound,normalDieSound,barracksSound,gameMusic,play,sound={},audioDir="ts1.mp3 ts2.mp3 ts3.mp3 ts4.mp3 ts5.mp3 ts6.mp3 ts7.mp3 ts8.mp3 ts9.mp3 ts10.mp3 sr1.mp3 sr2.mp3 sr3.mp3 sr4.mp3 sr5.mp3 sr6.mp3 sr7.mp3 sr8.mp3 sr9.mp3 sr10.mp3 o1.mp3 o2.mp3 o3.mp3 o4.mp3 o5.mp3 o6.mp3 o7.mp3 o8.mp3 o9.mp3 o10.mp3 INTRO.mp3 OUTRO.mp3 WIN1.mp3 WIN2.mp3 ATTACK.mp3 BALLISTA.mp3 BLDGDONE.mp3 CHAT%20LOCATION.mp3 TECHDONE.mp3 UNITDONE.mp3 CHAT.mp3 E_CASTLE1.mp3 E_CATHEDRAL1.mp3 E_CATHEDRAL2.mp3 E_FARM1.mp3 E_CHURCH1.mp3 E_FARM2.mp3 E_HARBOR1.mp3 E_LUMBER1.mp3 E_MAGETOWER1.mp3 E_MAGETOWER2.mp3 E_MAGETOWER3.mp3 E_MARKET1.mp3 E_SHIPYARD1.mp3 E_STABLES1.mp3 E_STORAGE1.mp3 E_OUTPOST1.mp3 E_STORAGE2.mp3 E_TAVERN1.mp3 E_WARACADEMY1.mp3 E_WORKSHOP1.mp3 EVILCASTLE.mp3 GATE1.mp3 GATE2.mp3 GATE3.mp3 GATE4.mp3 GATE5.mp3 GATE6.mp3 GATEWAY.mp3 HOUSE1.mp3 HOUSE2.mp3 HOUSE3.mp3 HOUSE4.mp3 HOUSE5.mp3 MERCHANT.mp3 MINE1.mp3 MONASTERY1.mp3 MONASTERY2.mp3 R_CATHEDRAL1.mp3 R_CHURCH1.mp3 SHAOLIN2.mp3 SHAOLIN.mp3 CHOP%201.mp3 CHOP%202.mp3 CHOP%203.mp3 CHOP%204.mp3 CHOP%205.mp3 CHOP%206.mp3 CHOP%207.mp3 CHOP%208.mp3 CHOP%209.mp3 CHOP%2010.mp3 CHOP%2011.mp3 DIG%201.mp3 DIG%202.mp3 DIG%203.mp3 MINE%201.mp3 MINE%202.mp3 MINE%203.mp3 HIT%201.mp3 HIT%202.mp3 HIT%203.mp3 HIT%204.mp3 HIT%205.mp3 HIT%206.mp3 HIT%207.mp3 GHOST1.mp3 GHOST2.mp3 GOLEM1.mp3 GOLEM2.mp3 H%20SWORD%201.mp3 H%20SWORD%202.mp3 H%20SWORD%203.mp3 H%20SWORD%204.mp3 H%20SWORD%205.mp3 H%20SWORD%206.mp3 H%20SWORD%207.mp3 H%20SWORD%207.mp3 H%20SWORD%208.mp3 H%20SWORD%209.mp3 H%20SWORD%2010.mp3 H%20SWORD%2011.mp3 H%20SWORD%2012.mp3 HAND1.mp3 HAND2.mp3 HAND3.mp3 HAND4.mp3 MAGE%20ATTACK.mp3 MESSIAH.mp3 ORC%20SWORD%201.mp3 ORC%20SWORD%202.mp3 ORC%20SWORD%203.mp3 ORC%20SWORD%204.mp3 ORC%20SWORD%205.mp3 ORC%20SWORD%206.mp3 ORC%20SWORD%20V1.mp3 ORC%20SWORD%20V2.mp3 ORC%20SWORD%20V3.mp3 SHIP%20CANNON%201.mp3 SHIP%20CANNON%202.mp3 SHIP%20CANNON%203.mp3 SHIP%20CANNON%204.mp3 SHIP%20CANNON%205.mp3 SHIP%20CANNON%206.mp3 SHIP%20CANNON%207.mp3 SIEGE.mp3 SWORD%201.mp3 SWORD%202.mp3 SWORD%203.mp3 SWORD%204.mp3 SWORD%205.mp3 SWORD%206.mp3 SWORD%207.mp3 SWORD%208.mp3 SWORD%209.mp3 SWORD%2010.mp3 SWORD%2011.mp3 SWORD%2012.mp3 SWORD%2013.mp3 SWORD%2014.mp3 SWORD%2015.mp3 SWORD%2016.mp3 V%20SWORD%201.mp3 V%20SWORD%202.mp3 V%20SWORD%203.mp3 V%20SWORD%204.mp3 V%20SWORD%205.mp3 V%20SWORD%206.mp3 V%20SWORD%207.mp3 ADRAGON2.mp3 ADRAGON3.mp3 ARROW%201.mp3 ARROW%202.mp3 ARROW%203.mp3 ARROW%204.mp3 ARROW%205.mp3 ARROW%206.mp3 ARROW%20V1.mp3 ARROW%20V2.mp3 ARROW%20V3.mp3 ARROW%20V4.mp3 BEAR1.mp3 BEAR2.mp3 BEAR3.mp3 BEAR4.mp3 BEAR5.mp3 MWORKSHOP.mp3 DESTROY%20BUILDING.mp3 DESTROY%20MINE.mp3 LIGHTING2.mp3 LIGHTING.mp3 METEOR.mp3 SMALL%20EXPLOSION.mp3 WATER%20BLOP.mp3 SPY%20KILL%201.mp3 SPY%20KILL%203.mp3 SPY%20KILL%202.mp3 PRIEST%20ATTACK.mp3 LIGHTNING.mp3 INVISIBLE.mp3 HEAL.mp3 FREEZE.mp3 FLAME%20BALL.mp3 CURSE.mp3 CRUSADE.mp3 CONFUSION.mp3 BLESS.mp3 WHIRLPOOL.mp3 TURN%20TO%20STONE.mp3 TEACH.mp3 SUMMON10.mp3 SUMMON9.mp3 SUMMON8.mp3 SUMMON7.mp3 SUMMON6.mp3 SUMMON5.mp3 SUMMON4.mp3 SUMMON3.mp3 SUMMON2.mp3 SUMMON1.mp3 REVEAL.mp3 RESSURECT.mp3 COWDIE1.mp3 COWDIE2.mp3 COWDIE1.mp3 COWDIE3.mp3 COWDIE4.mp3 DIE%201.mp3 DIE%202.mp3 DIE%203.mp3 DIE%204.mp3 DIE%205.mp3 DIE%206.mp3 DIE%207.mp3 DIE%208.mp3 DIE%209.mp3 DIE%2010.mp3 DRAGON%20DIE%201.mp3 DRAGON%20DIE%202.mp3 GHOST1.mp3 GHOST2.mp3 GOLEM.mp3 H%20DIE%201.mp3 H%20DIE%202.mp3 H%20DIE%203.mp3 H%20DIE%204.mp3 H%20DIE%205.mp3 H%20DIE%206.mp3 H%20DIE%207.mp3 H%20DIE%208.mp3 H%20DIE%209.mp3 H%20DIE%2010.mp3 MAGE.mp3 ORC%20DIE%201.mp3 ORC%20DIE%202.mp3 SHIP%20SINK.mp3 SIEGE%20DIE%201.mp3 SIEGE%20DIE%202.mp3 SIEGE%20DIE%203.mp3 SIEGE%20DIE%204.mp3 SKELETON%20DIE%201.mp3 SKELETON%20DIE%202.mp3 SKELETON%20DIE%203.mp3 SKELETON%20DIE%204.mp3 MESSIAH_ATTACK.mp3 C%20DIE%201.mp3 C%20DIE%202.mp3 C%20DIE%203.mp3 C%20DIE%204.mp3 C%20DIE%205.mp3 CAMELDIE1.mp3 CAMELDIE2.mp3 CAMELDIE3.mp3 BAT%20ATTACK.mp3 BAT%20CMD.mp3 BAT%20DIE.mp3".split(" "),
audioctx,gainNode,gainNodeVolume;function BufferLoader(d,a,c){this.context=d;this.urlList=a;this.onload=c;this.loadCount=0}
function setupSound(){window.AudioContext=window.AudioContext||window.webkitAudioContext;context=new AudioContext;gainNode=context.createGain();gainNodeVolume=context.createGain();audioctx=new BufferLoader(context,void 0,finishedLoading);ms("Sound: OK");gainNode.gain.value=parseInt(localStorage.musicRange)/100;gainNodeVolume.gain.value=parseInt(localStorage.soundRange)/100;gainNode.connect(context.destination);gainNodeVolume.connect(context.destination)}
function finishedLoading(d,a,c){a=a.split(".")[0].toLowerCase();sound[a]=d;!c||c.music&&c.mid!==gameMusic.id||(play(a,c.x,c.y,c.k,c.music,c.date),c.date=0)}
var iniSound=function(){if(!context){BufferLoader.prototype.loadBuffer=function(a,c){var b=this;fastXHR(me.cdn+a,function(d){b.context.decodeAudioData(d).then(function(b){b&&finishedLoading(b,a,c)})})};for(var d=0,a=audioDir.length;d<a;d++){var c=audioDir[d];sound[c.split(".")[0].toLowerCase()]=c}archerSound="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206 arrow%20v1 arrow%20v2 arrow%20v3 arrow%20v4".split(" ");arrowSoundTower="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206".split(" ");
swordSound="sword%201 sword%202 sword%203 sword%204 sword%205 sword%206 sword%207 sword%208 sword%209 sword%2010 sword%2011 sword%2012 sword%2013 sword%2014 sword%2015 sword%2016 v%20sword%201 v%20sword%202 v%20sword%203 v%20sword%204 v%20sword%205 v%20sword%206 v%20sword%207".split(" ");catapultSound=["siege"];handSound=["hand1","hand2","hand3","hand4"];hswordSound="h%20sword%201 h%20sword%202 h%20sword%203 h%20sword%204 h%20sword%205 h%20sword%206 h%20sword%207 h%20sword%208 h%20sword%209 h%20sword%2010 h%20sword%2011 h%20sword%2012".split(" ");
orkSound=["ork%20sword%20v1","ork%20sword%20v2","ork%20sword%20v3"];shipSound="ship%20cannon%201 ship%20cannon%202 ship%20cannon%203 ship%20cannon%204 ship%20cannon%205 ship%20cannon%206 ship%20cannon%207".split(" ");ghostSound=["ghost%201","ghost%202"];mageSound=["mage%20attack"];dieSoundBuild=["destroy%20building"];siegeDieSound=["siege%20die%201","siege%20die%202","siege%20die%203","siege%20die%204"];hdieSound="h%20die%201 h%20die%202 h%20die%203 h%20die%204 h%20die%205 h%20die%206 h%20die%207 h%20die%208 h%20die%209 h%20die%2010".split(" ");
normalDieSound="die%201 die%202 die%203 die%204 die%205 die%206 die%207 die%208 die%209 die%2010".split(" ");barracksSound=["e_barrack1"];"undefined"!==typeof AudioContext&&setupSound();gameMusic=function(){if(!Game.editor){gameMusic.id++;gid("musicSelect")&&(localStorage.favMusic=gid("musicSelect").mversion.value);var a=gameMusic.list[localStorage.favMusic];a&&play(a[~~(a.length*Math.random())],0,0,void 0,1,0,gameMusic.id)}};gameMusic.reset=function(){gameMusic.stop();gameMusic()};gameMusic.stop=
function(){gameMusic.active&&(gameMusic.active.stop(),clearTimeout(gameMusic.intv))};gameMusic.id=0;gameMusic.list={originalMusic1:"o1 o2 o3 o4 o5 o6 o7 o8 o9 o10 outro".split(" "),originalMusic:"ts1 ts2 ts3 ts4 ts5 ts6 ts7 ts8 ts9 ts10".split(" "),sharpRain:"sr1 sr2 sr3 sr4 sr5 sr6 sr7 sr8 sr9 sr10".split(" ")};play=function(a,c,d,g,l,k,n){"string"!==typeof a&&(a=audioDir[a].split(".")[0].toLowerCase());var b=a;if((a=sound[a])&&"loading"!==a&&!Game.canceled){var e=-screenX+(window.innerWidth-me.mx)/
2,f=-screenY+window.innerHeight/2;if(a.duration){if(Game.started)if(64<Game.now()-a.lastPlayed||!a.lastPlayed)a.lastPlayed=Game.now();else return;if(!(!l&&"attack"!=b&&k&&600<Date.now()-k)){if(c){c=-e+32*c;d=-f+32*d;f=zoomValor;if(c*c+d*d>Math.pow(2E3,2))return!1;c/=80;d/=80;f/=8}else f=d=c=0;void 0!==g&&g!==me.kingdom||Game.mute||(g=context.createBufferSource(),g.buffer=a,l?(g.connect(gainNode),gameMusic.active=g,gameMusic.intv=setTimeout(gameMusic,Math.floor(1E3*a.duration)+1E3)):(a=context.createPanner(),
a.panningModel="HRTF",a.setPosition(c,d,f),g.connect(a),a.connect(gainNodeVolume)),g.start(0))}}else sound[b]="loading",l={x:c,y:d,k:g,music:l,date:Date.now(),mid:n},audioctx.loadBuffer(a,l)}}}};var movInterval,timeFuncNoPause=function(){return Date.now()-lastCycleTime+25*WASM.gcycle()},pause=function(d){if(!(d&&Game.online||pause.bySystem&&d))if(0===Game.paused){Game.paused=1;void 0!=movInterval&&clearInterval(movInterval);var a=Game.now();Game.pausedTime+=Date.now();d||(pause.bySystem=1);Game.now=function(){return a}}else Game.pausedTime-=Date.now(),Game.paused=0,pause.bySystem=0,d&&gid("alert")&&hdiv("alert"),movInterval=setInterval(intvfunc,intvfunc.speed),Game.now=timeFuncNoPause};
pause.bySystem=0;pause.fast=!0;
var gametimestr=function(d){d/=1E3;var a=~~(d/60)%60,c=~~(d/3600);d=~~(d%60);1===(d+"").length&&(d="0"+d);0!=c?(c+=":",10>a&&(a="0"+a)):c="";return c+a+":"+d},lastCycleTime=0,lag=0,intvfunc=function(){if(!Game.editor){Game.cycle=WASM.gcycle();Game.now();lastCycleTime&&(lag+=Date.now()-lastCycleTime-intvfunc.speed);lastCycleTime=Date.now();var d=Date.now();WASM.movtablexe();Game.cycle=WASM.gcycle();itsnow(1E3,dayNight);perfCPU+=Date.now()-d;0===Game.cycle%40&&(gid("topinfo").innerHTML="<span>CPU:"+
(perfCPU/10).toFixed(2)+"%</span> <span>"+~~(perfGPUT/perfGPU+.5)+"FPS</span> <span>"+gametimestr(Game.now())+"</span>",perfGPUT=perfGPU=perfCPU=0);lag>=intvfunc.speed&&intvfunc()}},itsnow=function(d,a){0===Game.cycle%(d/25)&&a()};intvfunc.speed=25;
var perfCPU=0,perfGPU=0,perfGPUT=0,resourceInfo={meat:{icon:"food",img:"item_meat",url:"meat"},milk:{icon:"milk",img:"milk",url:"milk"},gold:{icon:"gold",img:"item_gold",url:"gold"},stone:{icon:"stone",img:"item_stone",url:"stone"},wood:{icon:"wood",img:"item_tree",url:"tree"},food2:{icon:"food",img:"item_food",url:"food"}},lastcursor=-1,cursor=function(d){d!==lastcursor&&(lastcursor=d,document.body.style.cursor='url("'+me.cdn+"cursor"+d+'.gif"),auto')},wasmplay=function(d,a,c){info[d]&&(d=info[d].attackSound)&&
d.length&&play(d[~~(d.length*Math.random())],a,c)};var minimap,attackmenu,defencemenu,levelmenu,kingdom,progressone,unitname,progressvalue,selectedobject,od,bottominfo,spValors,actionMenu,unitSpeed,mygold,mywood,myfood,mystone,daynighticon,chatul2,setupArrows=function(d,a){d&&(actionMenu.leftButton.className="");8*(d+1)<a&&(actionMenu.rightButton.className="")},setupMWmenu=function(){gid("magicworkshopmenu").style.display="block";MWdisplay()},MWdisplay=function(){gid("mgitem").style.backgroundPositionY=-48*WASM.mwicon()+"px";gid("mgamount").innerHTML=
WASM.amount()},setupMenuHTML=function(){if(!setupMenuHTML.setup){setupMenuHTML.setup=!0;gid("content").innerHTML='\n<ul id="msgs1"></ul>\n<div id="clicks" style="display:none;margin-top:0;margin-left:151px"></div>\n\n<div id="playersinfo"></div>\n<div id="resources" style="display:block">\n<div id="gold"></div>\n<div id="wood"></div>\n<div id="food"></div>\n<div id="stone"></div>\n<div id="pop"></div>\n<div id="temperature"></div>\n</div>\n<div id="enterwindow" class="displaynone">\n<h2 id="sendMessageH2">'+
msg.CHAT_T_CHAT+'</h2>\n<input id="msginputGame" />\n</div>\n\n<div id="statButton"></div>\n<div id="topinfo"></div>\n<div id="bottominfo"></div>\n<div id="mapeditorinfo">\n<div id="sButtons"><button id="selectUnits">'+msg.SELVIEW_UNITS+'</button><button id="selectBuilds">'+msg.builds+'</button><button id="selectItems">'+msg.items+'</button><button id="selectNature">'+msg.nature+'</button></div>\n<div id="mapeditorinfoUnits"></div>\n<div id="mapeditorinfoBuilds" style="display:none"></div>\n<div id="mapeditorinfoItems" style="display:none"></div>\n<div id="mapeditorinfoNature" style="display:none"></div>\n</div>\n<div id="mapeditorinfotop">\n<button id="menueditor">'+
msg.GAME_SCR_MENU+'</button>\n<button id="deleteUnit" style="color:#f00;font-weight:bold;font-size:19px">x</button>\n<button id="rotatebutton"></button>\n<button id="mapProps">'+msg.MENU_OPTI+'</button>\n<button id="mapRules">'+msg.rules+'</button>\n<span>Brush size: </span><input type="number" min="1" max="256" value="6" id="brushSize"/>\n<span>Active kingdom</span>\n<select id="selectKingdom">\n</select>\n</div>\n<div id="minimap" style="position:absolute;top:31px;left:4px;z-index:99"></div>\n<div id="menu" style="display:block">\n<button id="gameMenu">'+
msg.GAME_SCR_MENU+'</button>\n<div style="width:151px;height:calc(100% - 741px);top:645px;background:url(nehhon/menurepeat.gif) repeat" id="kingdomcolor"></div>\n<div id="daynighticon"></div>\n<div id="icons20">\n<div id="attackmenu" style="display:none"></div>\n<div id="defencemenu" style="display:none"></div>\n<div id="levelmenu" style="display:none"></div>\n<div id="manamenu" style="display:none"></div>\n<div id="manamenu1" style="display:none"></div>\n</div>\n<div id="progressvalue"></div>\n<div id="kingdom"></div>\n<div id="unitname" contenteditable="true"></div>\n<progress id="progressone" style="display:none"></progress>\n<progress id="progressmana" style="display:none" max="100"></progress>\n<input id="unitSpeed" min="1" max="100" type="range"/>\n<canvas width="48" height="48" id="selectedobject"></canvas>\n<div id="navigation">\n<button id="aleft"></button>\n<button id="stock"></button>\n<button id="aright"></button>\n</div>\n<div id="orders">\n<button id="order1"><progress class="loadingunit" style="display:none"></progress></button>\n<button id="order2"></button>\n<button id="order3"></button>\n<button id="order4"></button>\n<button id="order5"></button>\n<button id="order6"></button>\n<button id="order7"></button>\n<button id="order8"></button>\n</div>\n<div id="magicworkshopmenu" style="display:none">\n<button id="mgbook"></button>\n<button id="mgpotion"></button>\n<button id="mgsword"></button>\n<button id="mgamount"></button>\n<button id="mgitem"></button>\n<button id="mgdecline"></button>\n<button id="mgaccept"></button>\n<div id="mgbak"></div>\n</div>\n</div>\n\n\n        ';
chatul2=gid("msgs1");actionMenu={page:0,length:8,leftButton:gid("aleft"),rightButton:gid("aright"),stock:gid("stock")};actionMenu.leftButton.onclick=function(){WASM.changePage(-1)};minimap=gid("minimap");unitSpeed=gid("unitSpeed");mygold=gid("gold");mywood=gid("wood");myfood=gid("food");mystone=gid("stone");daynighticon=gid("daynighticon");actionMenu.rightButton.onclick=function(){WASM.changePage(1)};actionMenu.displayed=[];attackmenu=gid("attackmenu");defencemenu=gid("defencemenu");levelmenu=gid("levelmenu");
kingdom=gid("kingdom");progressone=gid("progressone");unitname=gid("unitname");progressvalue=gid("progressvalue");selectedobject=gid("selectedobject");gid("mgbook").onclick=function(){WASM.mwSelect(0);MWdisplay()};gid("mgpotion").onclick=function(){WASM.mwSelect(1);MWdisplay()};gid("mgsword").onclick=function(){WASM.mwSelect(2);MWdisplay()};gid("mgdecline").onclick=function(){gid("magicworkshopmenu").style.display="none"};gid("mgitem").onmousedown=function(a){var b=1;a.button&&(b*=-1);WASM.mwMore(b);
MWdisplay()};gid("mgaccept").onclick=function(){gid("magicworkshopmenu").style.display="none";WASM.createItems()};gid("mgamount").onmousedown=function(a){var b=1;a.button&&(b=-1);keyMap.shift&&(b*=5);WASM.mwamount(b);MWdisplay()};minimap.addEventListener("mousedown",function(a){var b=a.pageX-4,c=a.pageY-31;0===a.button?(document.addEventListener("mouseup",function l(a){document.removeEventListener("mouseup",l);document.removeEventListener("mousemove",mmfunc)}),mmClick=!0,mmfunc(a),document.addEventListener("mousemove",
mmfunc)):2===a.button&&(b=~~(mapx*(a.pageX-4)/mmW),c=~~(mapx*(a.pageY-31)/mmH),ms(b,c),WASM.mouseUp(b,c,2,!0))});od=[gid("order1"),gid("order2"),gid("order3"),gid("order4"),gid("order5"),gid("order6"),gid("order7"),gid("order8")];bottominfo=gid("bottominfo");for(var d=0,a=od.length;d<a;d++)od[d].addEventListener("mousedown",ordermousedown),od[d].addEventListener("mouseup",ordermouseup),od[d].ordid=d,od[d].addEventListener("mouseenter",ordermouseenter),od[d].addEventListener("mouseout",ordermouseout);
gid("stock").addEventListener("click",function(a){WASM.checkStock()});minimap.addEventListener("mousedown",function(a){});spValors={mana:{background:"0px -120px",progress:gid("progressmana")},food:{background:"0px -240px"},milk:{background:"0px -280px"},gold:{background:"0px -260px"},stone:{background:"0px -320px"},wood:{background:"0px -340px"}};gid("selectUnits").onclick=function(){gid("mapeditorinfoUnits").style.display="block";gid("mapeditorinfoBuilds").style.display="none";gid("mapeditorinfoItems").style.display=
"none";gid("mapeditorinfoNature").style.display="none"};gid("selectBuilds").onclick=function(){gid("mapeditorinfoUnits").style.display="none";gid("mapeditorinfoBuilds").style.display="block";gid("mapeditorinfoItems").style.display="none";gid("mapeditorinfoNature").style.display="none"};gid("selectItems").onclick=function(){gid("mapeditorinfoUnits").style.display="none";gid("mapeditorinfoBuilds").style.display="none";gid("mapeditorinfoItems").style.display="block";gid("mapeditorinfoNature").style.display=
"none"};gid("selectNature").onclick=function(){gid("mapeditorinfoUnits").style.display="none";gid("mapeditorinfoBuilds").style.display="none";gid("mapeditorinfoItems").style.display="none";gid("mapeditorinfoNature").style.display="block"};gid("selectKingdom").onchange;gid("mapProps").onclick=function(){gid("mapPropsWindow").style.display="block";filter1();if(""==gid("mapPropsWindow").innerHTML){var a=document.createElement("div");gid("mapPropsWindow").appendChild(a);var b=document.createElement("table");
a.appendChild(b);b=document.createElement("div");b.innerHTML=msg.mapName;var d=document.createElement("input");d.value=Game.name||msg.strcusMap;d.id="mapName";d.type="text";a.appendChild(b);a.appendChild(d);b=document.createElement("div");b.innerHTML=msg.description;d=document.createElement("textarea");d.type="text";d.value=Game.description||"";d.id="mapDescription";a.appendChild(b);a.appendChild(d);b=document.createElement("div");b.innerHTML=msg.author;d=document.createElement("input");d.id="mapAuthor";
d.value=Game.author||"";d.type="text";a.appendChild(b);a.appendChild(d);a.appendChild(document.createElement("p"));b=document.createElement("button");b.onclick=cancelMenu;b.innerHTML=msg.GENERAL_CLOSE;a.appendChild(b)}editorPlayerTable()};gid("mapRules").onclick=function(){gid("mapRulesWindow").style.display="block";filter1();if(""==gid("mapRulesWindow").innerHTML){var a=document.createElement("div");a.innerHTML='\n<div id="mapEvent">\n<h4>'+msg.events+'</h4>\n<select id="eventOptions" style="display:none">\n<option value="objAction">'+
msg.objAction+'</option>\n<option value="objZone">'+msg.objZone+'</option>\n</select>\n<div id="eventScreen">\n</div>\n<div id="eventLayout">\n</div>\n<button id="addEvent">+</button>\n</div>\n<div id="mapActions">\n<h4>'+msg.actions+'</h4>\n<select id="actionOptions" style="display:none">\n<option value="objOrder">'+msg.objOrder+'</option>\n</select>\n<div id="actionScreen">\n</div>\n<div id="actionLayout">\n</div>\n<button id="addAction">+</button>\n</div>\n<h4>'+msg.rules+"</h4>\n";var b=document.createElement("div");
b.id="rulist";a.appendChild(b);b=document.createElement("button");b.onclick=addRule;b.innerHTML="+";a.appendChild(b);b.id="addRule";a.appendChild(document.createElement("p"));b=document.createElement("button");b.onclick=cancelMenu;b.innerHTML=msg.GENERAL_CLOSE;a.appendChild(b);gid("mapRulesWindow").appendChild(a);gid("addEvent").onclick=addEvent;gid("addAction").onclick=addAction;gid("eventOptions").onchange=function(){var a=htmlOptions[this.value];showEvent.div=a.id;sdiv(showEvent.div);showEvent.active.name=
this.value;a.func&&a.func();a=gid("eventScreen").getElementsByTagName("button");for(var b=!1,c=0,d=a.length;c<d;c++){var e=a[c];if(e.sdiv)if("none"==e.style.display)e.sdiv.style.display="none";else{if(!b)e.onclick();b=!0}}updateEditorList(showRule.active,"eventLayout")};gid("actionOptions").onchange=function(){showAction.active.name=this.value;updateEditorList(showRule.active,"actionLayout")};a=document.createElement("div");a.id="edobjAction";var d=document.createElement("select");d.innerHTML='\n<option value="attack">'+
msg.MISC_ATTACK3+'</option>\n<option value="destroy">'+msg.destroy+'</option>\n<option value="moving">'+msg.moving+'</option>\n<option value="capture">'+msg.capture+"</option>\n";d.value="attack";d.id="selectionEvents";d.onchange=eventSubType;var f=document.createElement("section"),g=document.createElement("section"),l=document.createElement("section"),k=document.createElement("section"),n=document.createElement("section");b=document.createElement("button");b.innerHTML=msg.ADD;b.onclick=getZone;var m=
document.createElement("div");m.className="unitList";m.id="zoneList";l.appendChild(b);l.appendChild(m);m=document.createElement("div");m.className="unitList";m.id="unitListDiv";m.spType=showEvent;b=document.createElement("button");b.innerHTML=msg.ADD;b.onclick=function(){selectionAddUnit(this)};b.button=m;b.style.margin="10px";f.appendChild(b);b=document.createElement("button");b.innerHTML=msg.defined;b.onclick=showWindow;b.sdiv=f;a.appendChild(b);b.onclick();b=document.createElement("button");b.innerHTML=
msg.undefined;b.onclick=showWindow;b.sdiv=g;a.appendChild(b);f.appendChild(m);a.appendChild(f);a.appendChild(g);a.appendChild(document.createElement("p"));a.appendChild(d);a.appendChild(document.createElement("p"));m=document.createElement("div");m.className="unitList";m.id="unitListDiv2";m.spType=showEvent;b=document.createElement("button");b.innerHTML=msg.ADD;b.onclick=function(){selectionAddUnit(this)};b.button=m;b.style.margin="10px";k.appendChild(b);b=document.createElement("button");b.innerHTML=
msg.defined;b.onclick=showWindow;b.sdiv=k;b.id="byButton1";a.appendChild(b);b=document.createElement("button");b.innerHTML=msg.undefined;b.onclick=showWindow;b.id="byButton2";b.sdiv=n;a.appendChild(b);k.appendChild(m);b=document.createElement("button");b.innerHTML=msg.zone;b.onclick=showWindow;b.sdiv=l;b.id="eventZone";b.style.display="none";a.appendChild(b);a.appendChild(l);a.appendChild(k);a.appendChild(n);gid("eventScreen").appendChild(a);hdiv("mapEvent");hdiv("mapActions");a=document.createElement("div");
a.id="edobjOrder";d=document.createElement("select");d.innerHTML='\n<option value="move">'+msg.move+'</option>\n<option value="attack">'+msg.MISC_ATTACK3+"</option>\n";d.value="move";d.id="selectionActions";d.onchange=eventSubTypeAction;f=document.createElement("section");g=document.createElement("section");k=document.createElement("section");n=document.createElement("section");m=document.createElement("div");m.className="unitList";m.id="unitListDivAction";m.spType=showAction;b=document.createElement("button");
b.innerHTML=msg.ADD;b.onclick=function(){selectionAddUnit(this)};b.button=m;b.style.margin="10px";f.appendChild(b);b=document.createElement("button");b.innerHTML=msg.defined;b.onclick=showWindow;b.sdiv=f;a.appendChild(b);b=document.createElement("button");b.innerHTML=msg.undefined;b.onclick=showWindow;b.sdiv=g;a.appendChild(b);f.appendChild(m);a.appendChild(f);a.appendChild(g);b.onclick();a.appendChild(document.createElement("p"));a.appendChild(d);a.appendChild(document.createElement("p"));m=document.createElement("div");
m.className="unitList";m.id="unitListDivAction2";m.spType=showAction;b=document.createElement("button");b.innerHTML=msg.ADD;b.onclick=function(){selectionAddUnit(this)};b.button=m;b.style.margin="10px";k.appendChild(b);b=document.createElement("button");b.innerHTML=msg.defined;b.onclick=showWindow;b.sdiv=k;b.id="toButton1";a.appendChild(b);b=document.createElement("button");b.innerHTML=msg.undefined;b.onclick=showWindow;b.id="toButton2";b.sdiv=n;a.appendChild(b);k.appendChild(m);a.appendChild(k);
a.appendChild(n);b.onclick();gid("actionScreen").appendChild(a);hdiv("mapEvent");hdiv("mapActions")}};gid("gameMenu").onclick=showPlayingMenu;gid("menueditor").onclick=showPlayingMenu}},writeProps=function(d,a,c,b,e,f,g,l){var k="";f&&(k+="<span>"+msg[msgTranslator[f]]+"</span>");g&&(k+="<span>"+msg[msgTranslator[g]]+"</span>");ms(l);if(l){k+='<span class="red">'+msg.MISC_REQ3+": ";f=wasmi32Array(WASM.shapoint(),l);for(g=0;g<l;g++)k+=msg[msgTranslator[f[g]]],g+1<l&&(k+=", ");k+="</span>"}k+="<span>";
d&&(k+=d+"<img class='resource' src='nehhon/gold.gif' /> ");a&&(k+=a+"<img class='resource' src='nehhon/wood.gif' /> ");c&&(k+=c+"<img class='resource' src='nehhon/food.gif' /> ");b&&(k+=b+"<img class='resource' src='nehhon/stone.gif' /> ");k+="</span>";e&&(k+="<span class='shotcut'>"+String.fromCharCode(e).toUpperCase()+"</span>");bottominfo.innerHTML=k};setupMenuHTML.setup=!1;
var ordermouseenter=function(){WASM.mouseEnter(this.ordid)},ordermouseout=function(){actionMenu.stockActive&&selectionOne(selectionlist[0],1,1);bottominfo.innerHTML=""},ordermouseup=function(d){clickButton=d.button;WASM.executeOrder(this.ordid,d.button);this.style.transform="translate(0px,0px)"},ordermousedown=function(){this.style.transform="translate(2px,2px)"},action=[0,0,0,0,0,0,0,0],selection,w,h,clickButton,mmClick,deletehash=function(){history.pushState("",document.title,window.location.pathname)},
returnMenu=function(){Game.online=0;location.hash="";gid("index").style.display="block";gid("returnmenu").style.display="none";setTimeout(deletehash,200)},weather=function(){Date.now()},lightmap=[.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.27,.3,1,.5,.5,.5,1,.62,.62,.62,1,.74,.74,.74,1,.88,.88,.88,1,.94,.94,.94,1,1,1,1,1,1.06,1.06,1.06,1,1.12,1.12,1.12,1,1.08,1.08,1.08,1,1.04,1.04,1.04,1,1,1,1,1,.95,.95,.95,1,.88,.8,.7,1,.84,.72,.6,1,.7,.62,.5,1,.6,.55,.45,1,.5,.44,.42,1,.4,.37,
.35,1],dayNight=function(){var d=(.025*Game.cycle/Game.daylength*24+Game.initialhour)%24,a=~~d;d-=a;daynighticon.style.backgroundPosition="0 -"+36*a+"px";var c=new Float32Array([lightmap[4*a],lightmap[4*a+1],lightmap[4*a+2],lightmap[4*a+3]]);a=(a+1)%24;c[0]+=(-c[0]+lightmap[4*a])*d;c[1]+=(-c[1]+lightmap[4*a+1])*d;c[2]+=(-c[2]+lightmap[4*a+2])*d;c[3]+=(-c[3]+lightmap[4*a+3])*d;nehbugger&&(c=new Float32Array([1,1,1,1]));ambientFunc(c)},screenX=0,screenY=0,scrPhysics={vx:0,vy:0,speed:1280,time:0},screenX0=
0,screenY0=0,lx2=0,ly2=0,minimapLimiter=function(d,a){var c=gid("tzar").width,b=gid("tzar").height,e=me.mx/32;d/=32;a/=32;var f=zoomValor*c*.03125,g=zoomValor*b*.03125,l=.03125*c,k=.03125*b,n=d+.5*(l-f),m=a+.5*(k-g);0>n?d=.5*-(l-f):n+f-e*zoomValor>mapx&&(d=mapx-f-.5*(l-f)+e*zoomValor);0>m?a=.5*-(k-g):m+g>mapy&&(a=mapy-g-.5*(k-g));f-me.mx>mapx&&(zoomValor=mapx/(.03125*c),ms(zoomValor));g>mapy&&(zoomValor=mapy/(.03125*b),ms(zoomValor));screenX=32*-d;screenY=32*-a},mmfunc=function(d){var a=d.pageX-parseInt(minimap.style.left);
d=d.pageY-parseInt(minimap.style.top);var c=gid("tzar").width,b=gid("tzar").height*mmH/(32*mapy);a=~~(.5+(a-c*mmW/(32*mapx)*.5)*mapx/mmW);d=~~(.5+(d-.5*b)*mapy/mmH);minimapLimiter(32*a,32*d);0==mmClick&&document.removeEventListener("mousemove",mmfunc)},windowinterval=null,keypress=!1,keyMap={control:0,shift:0,esc:0},enterFunc=function(d){d&&!Game.editor&&("displaynone"==gid("enterwindow").className?(gid("enterwindow").className="displayblock",gid("msginputGame").focus(),keyFunc.blocked=13):(sendMsg(),
gid("enterwindow").className="displaynone",keyFunc.blocked=null))},keyFunc={37:function(d){scrPhysics.vx=d},40:function(d){scrPhysics.vy=-d},39:function(d){scrPhysics.vx=-d},38:function(d){scrPhysics.vy=d},16:function(d){keyMap.shift=d;WASM.shiftONOFF(d)},17:function(d){keyMap.control=d},27:function(d){keyMap.esc=d},13:enterFunc,19:function(d){},48:function(d){d&&keyMap.control&&(zoomValor=1,zoomFunc({deltaY:0}))},219:function(d){d&&changeBrushSize(-1)},221:function(d){d&&changeBrushSize(1)}};
nehbugger&&(keyFunc[19]=function(d){WASM.dbgspd(2400)});keyFunc.blocked=null;document.oncontextmenu=function(){return!1};function unblocked(){for(var d=0,a=od.length;d<a;od[d++].className="");}
var menuDefect=function(){hdiv("magicworkshopmenu");attackmenu.style.display="none";defencemenu.style.display="none";levelmenu.style.display="none";progressone.style.display="none";gid("manamenu").style.display="none";gid("manamenu1").style.display="none";gid("progressmana").style.display="none";unitname.innerHTML="";attackmenu.innerHTML="";defencemenu.innerHTML="";gid("manamenu").innerHTML="";levelmenu.innerHTML="";kingdom.innerHTML="";progressvalue.innerHTML="";progressone.value="";progressvalue.maxLength=
"";unitSpeed.style.display="none";for(var d=0;d<od.length;od[d++].innerHTML="");cleanMenuIcons();setupIconNone()};var atmosphere,atm,drag,startX,startY,mouseaction,selectedenemy,wid,sclass,y1b,actionObj,menuSelected={},objarrayPush=function(d,a){ms(d);d[a]=1;d.arrList||(d.arrList=[]);d.arrList.put(a)},selectionlist=[];selectionlist.change=1;var dblclick,rect,dragrect;drag=!1;document.onkeydown=function(d){if(!nehbugger){if(d.ctrlKey&&d.shiftKey)return!1;var a=!0;({116:1,115:1,123:1})[d.keyCode]&&(a=!1);return a}};
var keydownFunction=function(d){if(keyFunc[d.keyCode])keyFunc[d.keyCode](1);d.target!=gid("msginputGame")&&WASM.runKey(d.keyCode,!0)},keyupFunction=function(d){if(keyFunc[d.keyCode])keyFunc[d.keyCode](0);d.target!=gid("msginputGame")&&WASM.runKey(d.keyCode,!1)},touchX,touchY,tOriX,tOriY,touchActive=!1,despStart=function(d,a){tOriX=screenX;tOriY=screenY;touchX=d;touchY=a},despMove=function(d,a){screenX=tOriX-(touchX-d);screenY=tOriY-(touchY-a);move2()},touchStart=function(d){despStart(d.changedTouches[0].screenX,
d.changedTouches[0].screenY)},touchMove=function(d){despMove(d.changedTouches[0].screenX,d.changedTouches[0].screenY)},touchEnd=function(d){},mouseisilegal=function(d){return!(d.target==gid("tzar")||d.target==gid("resources")||d.target==gid("playersinfo")||d.target==gid("msgs1"))},mousemoveFunction=function(d){var a=window.innerWidth,c=window.innerHeight,b=d.pageX,e=d.pageY;if(!mouseisilegal(d)){if(touchActive)return despMove(b,e);WASM.mouseMove(d.pageX,d.pageY)}if(screen.height-10<=c){d=parameters.windowSpeed;
if(Math.abs(scrPhysics.vx)===d||0===scrPhysics.vx)scrPhysics.vx=((10>b)-(b>a-10))*d;if(Math.abs(scrPhysics.vy)===d||0===scrPhysics.vy)scrPhysics.vy=((10>e)-(e>c-10))*d}},mousedownFunction=function(d){if(!mouseisilegal(d)){if(d.altKey&&d.pageX>me.mx)return touchActive=!0,despStart(d.pageX,d.pageY);touchActive=!1;WASM.mouseDown(d.pageX,d.pageY,d.button)}},clickOut=!1,selectX,selectY,selectXf,selectYf,mouseupFunction=function(d){if(!mouseisilegal(d))if(touchActive)touchActive=!1;else return WASM.mouseUp(d.pageX,
d.pageY,d.button)},eventListeners=function(){window.addEventListener("keydown",keydownFunction);window.addEventListener("keyup",keyupFunction);window.addEventListener("mousemove",mousemoveFunction);window.addEventListener("touchstart",touchStart);window.addEventListener("touchmove",touchMove);window.addEventListener("touchend",touchEnd);window.addEventListener("wheel",zoomFunc,!1);window.addEventListener("mousedown",mousedownFunction);window.addEventListener("mouseup",mouseupFunction)},spValors0123=
["nehhon/gold.gif","nehhon/wood.gif","nehhon/food.gif","nehhon/stone.gif","nehhon/mana.gif"],uOBJ=function(d){return{attack:WASM.gAttack(d),defence:WASM.gDefence(d),level:WASM.glevel(d),health:WASM.ghealth(d),maxHealth:WASM.gmaxHealth(d),mana:WASM.gMana(d),item:WASM.gItem(d),build:WASM.gBuild(d),kingdom:WASM.gKingdom(d),c:WASM.gCval(d),manaMax:WASM.gManaMax(d),utype:WASM.giType(d),inventoryLength:WASM.gInventory(d),control:WASM.gControl(d),iconID:WASM.gIconID(d),type:WASM.gType(d),helper:WASM.gHelper(d),
name:msg[msgTranslator[WASM.gName(d)]]}},selectMulp=function(d,a,c){progressone.value=a;progressone.max=c;progressvalue.innerHTML=a+"/"+c;progressone.style.display="block";gid("kingdom").innerHTML=d+" "+msg.SELVIEW_UNITS;setupIconMultiple()},selectionOne=function(d,a){d=uOBJ(d);gid("manamenu").style.display="none";gid("manamenu1").style.display="none";gid("progressmana").style.display="none";d.sound&&!a&&(a=d.sound,play(a[~~(a.length*Math.random())]));d.inventoryLength&&d.control?(gid("stock").className=
"",gid("manamenu1").style.display="block",gid("manamenu1").style.backgroundPosition="0px -80px",gid("manamenu1").innerHTML=d.inventoryLength):gid("stock").className="blocked";d.build&&d.c&&(a=Math.floor(25*(d.c-Game.cycle)/1E3),gid("manamenu").style.display="block",gid("manamenu").style.backgroundPosition="0px -200px",gid("manamenu").innerHTML=a+"s");kingdom.style.display="block";unitname.innerHTML=d.name;d.attack||0==d.utype?(attackmenu.innerHTML=d.attack,sdiv("attackmenu")):hdiv("attackmenu");0==
d.utype||2==d.utype&&d.defence?(defencemenu.innerHTML=d.defence,sdiv("defencemenu")):hdiv("defencemenu");d.manaMax&&(gid("manamenu").style.display="block",gid("manamenu").innerHTML=d.mana,27===d.type?(gid("manamenu").style.backgroundPosition="0px -280px",sdiv("manamenu1"),gid("manamenu").style.backgroundPosition="0px -240px",gid("manamenu").innerHTML=d.helper):(gid("progressmana").value=~~(100*d.mana/d.manaMax),sdiv("progressmana"),gid("manamenu").style.backgroundPosition="0px -120px"));levelmenu.innerHTML=
d.level;levelmenu.style.display="block";0===d.level&&(d.item||d.build)&&(levelmenu.style.display="none");kingdom.innerHTML=str16(wasmu16Array(WASM.empName(d.kingdom),17));progressone.style.display="block";showHealthOne(d);setupIcon(d.iconID)},str16=function(d){for(var a,c="",b=0;a=d[b++];)c+=String.fromCharCode(a);return c},showHealthOne=function(d){var a=d.health;d=d.maxHealth;-1===a?(progressone.value=100,progressone.max=100,progressvalue.innerHTML=msg.MISC_INF3):(progressone.value=a,-1===d?(progressone.max=
100,progressone.value=1):progressone.max=d,progressvalue.innerHTML=~~a+"/"+d)};var receivedIndex=1,move2=function(){},float32Array=new Float32Array(8),setupTriangles,kingdomBuffer,texCoordBuffer,positionBuffer,physicsbuffer,marginsbuffer,bufferLimit,zoomValor=1,f32xyz=new Float32Array(12),gl,posCoords32,kingdomCoords32,texCoords32,zoomLocation,terrainIndex,uView={},wasmu32Array=function(d,a){return new Uint32Array(Module.buffer,d,a)},wasmFloat32Array=function(d,a){return new Float32Array(Module.buffer,d,a)},wasmi32Array=function(d,a){return new Int32Array(Module.buffer,d,a)},
wasmi8Array=function(d,a){return new Int8Array(Module.buffer,d,a)},wasmu16Array=function(d,a){return new Uint16Array(Module.buffer,d,a)},wasmu8Array=function(d,a){return new Uint8Array(Module.buffer,d,a)},cleanMenuIcons=function(){for(var d=actionMenu.displayed.length=0,a=actionMenu.length;d<a;d++){var c=od[d];c.className="blocked";c.style.backgroundPosition="48px 96px";c.innerHTML="";action[d]=emptyFunction}actionMenu.rightButton.className="blocked";actionMenu.leftButton.className="blocked";actionMenu.stock.className=
"blocked";actionMenu.rightBlocked=1},buttonSetup=function(d,a,c,b,e){d=od[d];d.style.backgroundPosition=48*e+"px "+48*a+"px";c&&(d.className="");0<b&&(d.innerHTML=b)},ambientLight,program,programT,Uint32Index,noText,ambientLightT,nowUniform,resolutionLocation,fpsLocationT,fpsLocation,resolutionLocationT,minimapLocationT,minimapLocation,translationLocation,translationLocationT,zoomLocationT,vaoTerrain,vao,fb,stepBuffer,vsize,BufferSetup=function(d,a){var c=4*bufferLimit,b=gl.createBuffer();b.size=
a;b.len=c;gl.bindBuffer(gl.ARRAY_BUFFER,b);gl.enableVertexAttribArray(d);gl.vertexAttribPointer(d,a,gl.FLOAT,!1,0,0);gl.bufferData(gl.ARRAY_BUFFER,c*a,gl.STATIC_DRAW);webgl1?ANGLEEXT.vertexAttribDivisorANGLE(d,1):gl.vertexAttribDivisor(d,1);return b};BufferSetup.jump=4E3;
var resizeBuffer=function(d,a){var c=gl.createBuffer(),b=a+1E4;a*=4;b*=4;gl.bindBuffer(gl.COPY_READ_BUFFER,d);gl.bindBuffer(gl.ARRAY_BUFFER,c);gl.bufferData(gl.ARRAY_BUFFER,a*d.size,gl.STATIC_DRAW);gl.copyBufferSubData(gl.COPY_READ_BUFFER,gl.ARRAY_BUFFER,0,0,a*d.size);gl.bindBuffer(gl.COPY_READ_BUFFER,c);gl.bindBuffer(gl.ARRAY_BUFFER,d);gl.bufferData(gl.ARRAY_BUFFER,b*d.size,gl.STATIC_DRAW);gl.copyBufferSubData(gl.COPY_READ_BUFFER,gl.ARRAY_BUFFER,0,0,a*d.size);gl.bindBuffer(gl.COPY_READ_BUFFER,null);
gl.deleteBuffer(c)},webgl1;
function setupGL(){gl.getError()===gl.CONTEXT_LOST_WEBGL&&(gl=gid("tzar").getContext("webgl2",{antialias:!1,alpha:!1}),ms("restored"));if(!engineOn){var d=webgl1?"precision highp float;\nattribute vec3 a_position;\nattribute vec3 a_texCoord;\nattribute vec4 a_physic;\nattribute vec3 a_margins;\nattribute float a_step;\n\nuniform float kingdoms;\nuniform float zoom;\nuniform mediump int miniMap;\nuniform float now;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform sampler2D u_image1;\nuniform sampler2D delay;\nuniform sampler2D colorArray;\n\nuniform float zMax;\nvarying highp vec2 vTextureCoord;\nvarying vec4 v_kcolor;\nvarying float height;\nvarying float rColor;\n\nvec4 superArray(highp float position) {\nhighp vec2 xy = vec2(mod(position,512.0) ,   floor(position/512.0) )/512.0;\nreturn (texture2D(u_image1, xy));\n}\n\nfloat delayr(float pos){\nhighp vec2 xy = vec2(mod(pos,128.0) ,   floor(pos/128.0) )/128.0;\nreturn (texture2D(delay, xy).r);\n}\n\n\nvoid main() {\n\n\n\n    highp float  x;\n    float t;\n\thighp float pos;\n    highp float jump=0.0;\n    pos=a_texCoord.x;\n\n   // pos=260840u/4u;\n\n\n\nvec4 imgInfo=superArray(pos);\n\nfloat frames=imgInfo[0];\nfloat fps=imgInfo[1];\nfloat dirs=imgInfo[2];\nfloat recolor=imgInfo[3];\n\nrColor=recolor;\n\n\nif(fps!=0.0&&miniMap==0){\nif(a_texCoord.y>=0.0){\nt=(now-a_texCoord.y);\nif(fps>0.0){\njump=floor(t * fps*0.001);         \n}else{\n\n//fps=12.0;\n//jump=floor(t * fps*0.001);  \n\n\n\nfloat index=-fps;\n\nfloat spt= mod(t,delayr(frames-1.0+index));\nbool stop=false;\nfor(int i=0;i<55;i++){\nif(!stop){\njump=float(i);\nif(jump<frames) \nif(delayr(jump+index)>spt)\nstop=true;\n}\n\n}\n\n\n\n\n\n}\n\njump=mod(jump,frames)*2.0;\npos=(pos+jump);\n}\n}\n\npos+=1.0;\n   \n    vec4 coord = superArray(pos);\n    vec2 mxy=coord.xy;\n    highp vec2 txtcord = coord.zw;\n   // txtcord=vec2(0.0,0.0);\n    \n    vec2 sizes = superArray(pos+1.0).xy;\n    //sizes=vec2(50.0);\n    if(a_step==1.0||a_step==3.0){\n    mxy.x+=sizes.x;\n    txtcord.x+=sizes.x;\n    }\n\n    if(a_step==2.0||a_step==3.0){\n    mxy.y+=sizes.y;\n    txtcord.y+=sizes.y;\n    }\n\n\theight = sizes.y;\n\n\tfloat z=a_position.z;\n\n\n    \nif(a_margins.x!=0.0&&(a_step==1.0||a_step==3.0)){\nmxy.x+=a_margins.x-sizes.x;\n}\n\n\nif(a_margins.y!=0.0&&(a_step==2.0||a_step==3.0)){\nmxy.y+=a_margins.y-sizes.y;\n}\n\n\n\tif(z<0.0){\n\tz*=-1.0;\nif(miniMap<2) mxy*=0.0;\n\t}\n\n\n\n\n\n\nif(a_margins.z!=0.0){\n\tfloat s = sin(a_margins.z);\n\tfloat c = cos(a_margins.z);\n\tmat2 m = mat2(c, -s, s, c);\n\tmxy.xy*=m;\n}\n\n\n\n    t = (now - a_physic.w) * 0.001;\n    mxy.x+=a_physic.x * t;\n\n\tfloat physicY=a_physic.y * t + a_physic.z * .5 * t * t;\n\n    mxy.y+=physicY;\n\n\nif(miniMap!=0){\n\tz=0.0;\n}else{\n\tz=(1.0 - (physicY+z)/ zMax)*.9;\n}\n\n\n   gl_Position = vec4((((a_position.xy+mxy) + u_translation) / u_resolution * 2.0 - 1.0) * vec2(zoom, -zoom), (z), 1.0);\n   vTextureCoord=txtcord;\n\n\nvec4 outColor=texture2D(colorArray,vec2(a_texCoord.z/64.0,0));\n//outColor=vec4(1.0);\n\nif(a_texCoord.z>=kingdoms) outColor.a+=1.0;\n\n\n   v_kcolor=outColor;\n}\n":"#version 300 es\nprecision highp float;\n\nin vec3 a_position;\nin vec3 a_texCoord;\nin vec4 a_physic;\nin vec3 a_margins;\nin uint a_step;\n\nuniform float kingdoms;\nuniform float zoom;\nuniform mediump int miniMap;\nuniform float now;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform sampler2D u_image1;\nuniform sampler2D delay;\nuniform sampler2D colorArray;\n\nuniform float zMax;\nout highp vec2 vTextureCoord;\nout vec4 v_kcolor;\nout float height;\nflat out int rColor;\n\nvec4 superArray(in highp int position) {\n     return(texelFetch(u_image1, ivec2(\t\t(position%512)\t\t,\tposition/512\t), 0));\n}\n\nvoid main() {\n\n\n\n    highp float  x;\n    float t;\n\thighp int pos;\n    int jump=0;\n    pos=int(a_texCoord.x);\n   // pos=260840u/4u;\n\n\n\nvec4 imgInfo=superArray(pos);\n\nint frames=int(imgInfo[0]);\nfloat fps=imgInfo[1];\nfloat dirs=imgInfo[2];\nfloat recolor=imgInfo[3];\n\nrColor=int(recolor);\n\n\nif(fps!=0.0&&miniMap==0){\nif(a_texCoord.y>=0.0){\nt=(now-a_texCoord.y);\nif(fps>0.0){\njump=int(floor(t * fps*0.001));         \n}else{\n\n\nint index=int(-fps);\n\nfloat spt= mod(t,texelFetch(delay, ivec2(frames-1+index, 0), 0).r);\n\nfor(jump=0;jump<frames;jump++)\nif(texelFetch(delay, ivec2(jump+index, 0), 0).r>spt){ \nbreak;\n}\n\n\n\n\n}\n\njump=(jump%frames)*2;\npos=(pos+jump);\n}\n}\n\npos+=1;\n   \n    vec4 coord = superArray(pos);\n    vec2 mxy=coord.xy;\n    vec2 txtcord = coord.zw/512.0;\n\n    \n    vec2 sizes = superArray(pos+1).xy;\n\n    if(a_step==1u||a_step==3u){\n    mxy.x+=sizes.x;\n    txtcord.x+=sizes.x/512.0;\n    }\n\n    if(a_step==2u||a_step==3u){\n    mxy.y+=sizes.y;\n    txtcord.y+=sizes.y/512.0;\n    }\n\n\n\n\theight = sizes.y/512.0;\n\n\tfloat z=a_position.z;\n\n\n    \nif(a_margins.x!=0.0&&(a_step==1u||a_step==3u)){\nmxy.x+=a_margins.x-sizes.x;\n}\n\n\nif(a_margins.y!=0.0&&(a_step==2u||a_step==3u)){\nmxy.y+=a_margins.y-sizes.y;\n}\n\n\n\tif(z<0.0){\n\tz*=-1.0;\nif(miniMap<2) mxy*=0.0;\n\t}\n\n\n\n\n\n\nif(a_margins.z!=0.0){\n\tfloat s = sin(a_margins.z);\n\tfloat c = cos(a_margins.z);\n\tmat2 m = mat2(c, -s, s, c);\n\tmxy.xy*=m;\n}\n\n\n\n    t = (now - a_physic.w) * 0.001;\n    mxy.x+=a_physic.x * t;\n\n\tfloat physicY=a_physic.y * t + a_physic.z * .5 * t * t;\n\n    mxy.y+=physicY;\n\n\nif(miniMap!=0){\n\tz=0.0;\n}else{\n\tz=(1.0 - (physicY+z)/ zMax)*.9;\n}\n\n\n   gl_Position = vec4((((a_position.xy+mxy) + u_translation) / u_resolution * 2.0 - 1.0) * vec2(zoom, -zoom), (z), 1.0);\n   vTextureCoord=txtcord;\n\nvec4 outColor=texelFetch(colorArray, ivec2(a_texCoord.z, 0), 0);\n\nif(a_texCoord.z>=kingdoms) outColor.a+=1.0;\n\n\n   v_kcolor=outColor;\n}\n";
var a=gl.createShader(gl.VERTEX_SHADER);gl.shaderSource(a,d);gl.compileShader(a);var c=webgl1?"precision highp float;\n\nuniform sampler2D lightmap;\nuniform vec2 u_resolution;\nuniform sampler2D img_common[7];\nuniform vec4 u_ambient;\nuniform mediump int miniMap;\nvarying vec4 v_kcolor;\nvarying highp vec2 vTextureCoord;\nvarying float height;\nvarying float rColor;\n\nvec4 getPixel(){\nhighp vec2 txtFinal=vTextureCoord;\nif(txtFinal.x>=512.0){\ntxtFinal.y+=height*floor((txtFinal.x)/512.0);\ntxtFinal.x=mod(txtFinal.x,512.0);\n}\n\n//if(txtFinal.x<1.0) return vec4(1.0,0.0,0.0,1.0);\n//if(txtFinal.y<1.0) return vec4(1.0,0.0,0.0,1.0);\n\n\n\ntxtFinal.x=txtFinal.x+floor(mod(txtFinal.y,8.0))*512.0;\n\n//if(txtFinal.x<1.0) return vec4(0.0,1.0,0.0,1.0);\n\ntxtFinal.y=floor(txtFinal.y/8.0);\n\ntxtFinal/=4096.0;\n\nif(txtFinal.y<1.0)\nreturn texture2D(img_common[0], txtFinal);\nelse if(txtFinal.y<2.0)\nreturn texture2D(img_common[1], txtFinal);\nelse if(txtFinal.y<3.0)\nreturn texture2D(img_common[2], txtFinal);\nelse if(txtFinal.y<4.0)\nreturn texture2D(img_common[3], txtFinal);\nelse if(txtFinal.y<5.0)\nreturn texture2D(img_common[4], txtFinal);\nelse if(txtFinal.y<6.0)\nreturn texture2D(img_common[5], txtFinal);\nelse if(txtFinal.y<7.0)\nreturn texture2D(img_common[6], txtFinal);\n}\n\n\nvoid main() {\n\n\nif(miniMap==0){\n\n\n\n\nvec4 color=getPixel();\n\n\n\n//vec4 color=vec4(1.0);\n \n\nif(color.a<0.5) discard;\n\n\nif(rColor==1.0 &&color.r==color.g&&color.r==color.b){\ncolor.rgb*=v_kcolor.rgb;\n}\n\nif(v_kcolor.a>1.0)\n{\ncolor*=v_kcolor-vec4(0.0,0.0,0.0,1.0);\n}\n\n\n\n\nvec4 light=vec4(1.0);\n\ngl_FragColor=color*light;\n}else{\n\nif(v_kcolor.a>1.0)\ngl_FragColor=v_kcolor-vec4(0.0,0.0,0.0,1.0);\nelse\ngl_FragColor=v_kcolor;\n}\n\n}":
"#version 300 es\nprecision highp float;\n\n\n\nuniform sampler2D lightmap;\nuniform vec2 u_resolution;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\nuniform mediump int miniMap;\nin vec4 v_kcolor;\nin highp vec2 vTextureCoord;\nin float height;\nflat in int rColor;\nout vec4 COLOR;\n\n\nbool v4no(vec4 color,int r){\nif(color.r==float(r)/255.0) return false;\nreturn true;\n}\n\n\nvoid main() {\n\n\nif(miniMap==0){\n\n\n\n\nvec2 txtFinal=vTextureCoord;\n\nif(txtFinal.x>=1.0){\ntxtFinal.y+=height*floor(txtFinal.x);\n}\n\n\nvec4 color=texture(img_common, vec3(txtFinal, int(txtFinal.y)));\n \n\nif(color.a<0.5) discard;\n\n\nif(rColor==1 &&color.r==color.g&&color.r==color.b\n&&v4no(color,68)\n&&v4no(color,95)\n&&v4no(color,96)\n&&v4no(color,98)\n&&v4no(color,101)\n&&v4no(color,103)\n&&v4no(color,107)\n&&v4no(color,108)\n&&v4no(color,109)\n&&v4no(color,118)\n&&v4no(color,121)\n&&v4no(color,124)\n&&v4no(color,134)\n&&v4no(color,135)\n&&v4no(color,139)\n&&v4no(color,148)\n&&v4no(color,150)\n&&v4no(color,151)\n&&v4no(color,156)\n&&v4no(color,163)\n&&v4no(color,164)\n&&v4no(color,165)\n&&v4no(color,166)\n&&v4no(color,167)\n&&v4no(color,173)\n&&v4no(color,177)\n&&v4no(color,180)\n&&v4no(color,183)\n&&v4no(color,185)\n&&v4no(color,186)\n&&v4no(color,195)\n&&v4no(color,196)\n&&v4no(color,198)\n&&v4no(color,200)\n&&v4no(color,203)\n&&v4no(color,210)\n&&v4no(color,214)\n&&v4no(color,215)\n&&v4no(color,223)\n&&v4no(color,225)\n&&v4no(color,230)\n&&v4no(color,231)\n&&v4no(color,241)\n&&v4no(color,251)\n&&v4no(color,252)\n&&v4no(color,253)\n&&v4no(color,254)\n){\ncolor.rgb*=v_kcolor.rgb;\n}\n\nif(v_kcolor.a>1.0)\n{\ncolor*=v_kcolor-vec4(0.0,0.0,0.0,1.0);\n}\n\n\n\n\nvec4 light=vec4(1.0);\nlight = texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+vec4(1.0,1.0,1.0,0.0)*u_ambient;\n\nCOLOR=color*light;\n}else{\n\nif(v_kcolor.a>1.0)\nCOLOR=v_kcolor-vec4(0.0,0.0,0.0,1.0);\nelse\nCOLOR=v_kcolor;\n}\n\n}";
d=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(d,c);gl.compileShader(d);program=gl.createProgram();gl.attachShader(program,a);gl.attachShader(program,d);gl.linkProgram(program);gl.useProgram(program);(a=gl.getShaderInfoLog(a))&&console.log("Shader compiler log1: "+a);(a=gl.getShaderInfoLog(d))&&console.log("Shader compiler log1: "+a);d=webgl1?"precision highp float;\nattribute vec3 a_position;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform mediump int miniMap;\nuniform float zoom;\n\nvoid main() {\nfloat depth;\nif(miniMap==1){\ndepth=.03;\n}else{\ndepth=1.0;\n}\ngl_Position = vec4(a_position.x, a_position.y, depth, 1.0);\n\n}":
"#version 300 es\nprecision highp float;\nin vec3 a_position;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform mediump int miniMap;\nuniform float zoom;\n\nvoid main() {\nfloat depth;\nif(miniMap==1){\ndepth=.03;\n}else{\ndepth=1.0;\n}\ngl_Position = vec4(a_position.x, a_position.y, depth, 1.0);\n\n}";a=gl.createShader(gl.VERTEX_SHADER);gl.shaderSource(a,d);gl.compileShader(a);c=webgl1?"precision highp float;\n\nuniform float u_fps;\nuniform mediump int miniMap;\nuniform sampler2D img_common[7];\nuniform vec4 u_ambient;\n\nuniform vec2 u_translation;\nuniform vec2 u_light;\nuniform vec2 u_resolution;\nuniform vec2 minimapMargin;\nuniform sampler2D img_data;\nuniform sampler2D lightmap;\nuniform float zoom;\nuniform float mx;\nuniform float mapSize;\n\nuniform sampler2D u_image1;\n\nvec4 superArray(highp float position) {\nhighp vec2 xy = vec2(mod(position,512.0) ,   floor(position/512.0) )/512.0;\nreturn (texture2D(u_image1, xy));\n}\n\nvec4 sptexture3D(vec2 txtFinal,float height) {\n\nif(txtFinal.x>=512.0){\ntxtFinal.y+=height*floor((txtFinal.x)/512.0);\ntxtFinal.x=mod(txtFinal.x,512.0);\n}\n\n//if(txtFinal.x<1.0) return vec4(1.0,0.0,0.0,1.0);\n//if(txtFinal.y<1.0) return vec4(1.0,0.0,0.0,1.0);\n\n\n\ntxtFinal.x=txtFinal.x+floor(mod(txtFinal.y,8.0))*512.0;\n\n//if(txtFinal.x<1.0) return vec4(0.0,1.0,0.0,1.0);\n\ntxtFinal.y=floor(txtFinal.y/8.0);\n\ntxtFinal/=4096.0;\n\nif(txtFinal.y<1.0)\nreturn texture2D(img_common[0], txtFinal);\nelse if(txtFinal.y<2.0)\nreturn texture2D(img_common[1], txtFinal);\nelse if(txtFinal.y<3.0)\nreturn texture2D(img_common[2], txtFinal);\nelse if(txtFinal.y<4.0)\nreturn texture2D(img_common[3], txtFinal);\nelse if(txtFinal.y<5.0)\nreturn texture2D(img_common[4], txtFinal);\nelse if(txtFinal.y<6.0)\nreturn texture2D(img_common[5], txtFinal);\nelse if(txtFinal.y<7.0)\nreturn texture2D(img_common[6], txtFinal);\n\n}\n\nvoid main() {\nvec4 color;\n\nvec2 xy =  vec2(gl_FragCoord.x,u_resolution.y-gl_FragCoord.y)/zoom;\n\nif(miniMap==1){\nxy+=minimapMargin/zoom;\n}else{\nxy+=-u_translation+vec2(mx,0.0)/zoom+0.5*(u_resolution-u_resolution/zoom);\n}\n\n\nvec4 coords=texture2D(img_data,xy/(mapSize*32.0));\n\n\n//gl_FragColor=vec4(coords[0]);\n\n\nvec2 xy32=xy/32.0;\nvec2 floorxy32=floor(xy32);\nvec2 xyr=xy32-floorxy32;\nfloat pos;\n\nvec4 nrgb;\n\nif(coords.q!=0.0) nrgb=sptexture3D((coords.pq*512.0)+xyr*32.0,448.0);\n\n\n\nif(nrgb==vec4(1.0,0.0,1.0,1.0)) \npos=(coords[1]);\nelse\npos=(coords[0]);\n\n\n\nif(nrgb!=vec4(0.0,0.0,0.0,0.0)&&nrgb!=vec4(1.0,0.0,1.0,1.0)){\ncolor=nrgb;\n}else{\n\nvec4 frames=superArray(pos);\n\nfloat fps=frames[1];\n\nfloat jump=mod(floor(u_fps * fps*0.001),(frames[0])) * 2.0+1.0;  \njump=1.0;\nvec4 info=superArray(pos+jump);\n\n\n\n\n\nvec2 wh=superArray(pos+1.0+jump).xy;\n\nvec2 nxy=vec2(mod(xy.x,wh.x),mod(xy.y,wh.y));\n\n\ncolor=sptexture3D((info.pq+nxy),wh.t);\n//color=sptexture3D(vec2(500.0,240.0),50.0);\n\n//if(miniMap==0) light = (texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+1.0);\n\n}\n\n\nvec4 tlight=sptexture3D(  (u_light+vec2(mod(xy.x,512.0),mod(xy.y,512.0))),512.0    );\n\n\ngl_FragColor=color*u_ambient*(vec4(.5)+tlight*.75);\n}":
"#version 300 es\nprecision highp float;\n\nuniform float u_fps;\nuniform mediump int miniMap;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\n\nuniform vec2 u_translation;\nuniform vec2 u_light;\nuniform vec2 u_resolution;\nuniform vec2 minimapMargin;\nuniform sampler2D img_data;\nuniform sampler2D lightmap;\nout vec4 COLOR;\nuniform float zoom;\nuniform float mx;\nuniform float mapSize;\n\n\nuniform sampler2D u_image1;\nvec4 superArray(in highp int position) {\n     return(texelFetch(u_image1, ivec2(\t\t(position%512)\t\t,\tposition/512\t), 0));\n}\n\nvec4 sptexture3D(in vec2 coords,float h) {\nif(coords.x>=1.0){\ncoords.y+=h*floor(coords.x)/512.0;\n}\n    return(\ttexture(img_common, vec3(coords,int(coords.y)))\t);\n}\n\nvoid main() {\nvec4 color;\n\nvec2 xy =  vec2(gl_FragCoord.x,u_resolution.y-gl_FragCoord.y)/zoom;\n\nif(miniMap==1){\nxy+=minimapMargin/zoom;\n}else{\nxy+=-u_translation+vec2(mx,0.0)/zoom+0.5*(u_resolution-u_resolution/zoom);\n}\n\n\nvec4 coords=texture(img_data,xy/(mapSize*32.0));\nvec2 xy32=xy/32.0;\nvec2 floorxy32=floor(xy32);\nvec2 xyr=xy32-floorxy32;\nhighp int pos;\n\nvec4 nrgb;\n\nif(coords.q!=0.0) nrgb=sptexture3D((coords.pq)+xyr/16.0,448.0);\n\n\nif(nrgb==vec4(1.0,0.0,1.0,1.0)) \npos=int(coords[1]);\nelse\npos=int(coords[0]);\n\n\n\nif(nrgb!=vec4(0.0,0.0,0.0,0.0)&&nrgb!=vec4(1.0,0.0,1.0,1.0)){\ncolor=nrgb;\n}else{\n\nvec4 frames=superArray(pos);\n\nfloat fps=frames[1];\n\nhighp int jump=(int(floor(u_fps * fps*0.001))%int(frames[0])) * 2+1;  \n//jump=1;\nvec4 info=superArray(pos+jump);\n\n\n\n\n\nvec2 wh=superArray(pos+1+jump).xy;\n\nvec2 nxy=vec2(mod(xy.x,wh.x),mod(xy.y,wh.y));\n\n\ncolor=sptexture3D((info.pq+nxy)/512.0,wh.t);\n\n\n//if(miniMap==0) light = (texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+1.0);\n\n}\n\n\nvec4 tlight=sptexture3D(  (u_light+vec2(mod(xy.x,512.0),mod(xy.y,512.0)))/512.0,512.0    );\n\n\n\n//\nCOLOR=color*u_ambient*(vec4(.5)+tlight*.75);\n}";
d=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(d,c);gl.compileShader(d);programT=gl.createProgram();gl.attachShader(programT,a);gl.attachShader(programT,d);gl.linkProgram(programT);(a=gl.getShaderInfoLog(a))&&console.log("Shader1 compiler log T: "+a);(a=gl.getShaderInfoLog(d))&&console.log("Shader compiler log T: "+a)}a=gl.getAttribLocation(program,"a_position");d=gl.getAttribLocation(program,"a_texCoord");c=gl.getAttribLocation(program,"a_step");var b=gl.getAttribLocation(program,"a_physic"),
e=gl.getAttribLocation(program,"a_margins");gl.useProgram(programT);var f=gl.getUniformLocation(programT,"minimapMargin");translationLocationT=gl.getUniformLocation(programT,"u_translation");resolutionLocationT=gl.getUniformLocation(programT,"u_resolution");fpsLocationT=gl.getUniformLocation(programT,"u_fps");ambientLightT=gl.getUniformLocation(programT,"u_ambient");zoomLocationT=gl.getUniformLocation(programT,"zoom");var g=gl.getUniformLocation(programT,"mx"),l=gl.getUniformLocation(programT,"mapSize");
gl.getUniformLocation(programT,"borderCoords");gl.getUniformLocation(programT,"waterBorder");minimapLocationT=gl.getUniformLocation(programT,"miniMap");gl.uniform1i(minimapLocationT,0);gl.uniform2fv(translationLocationT,[0,0]);gl.uniform1f(fpsLocationT,-1);gl.uniform1f(zoomLocationT,1);gl.uniform1f(g,-me.mx);gl.uniform1f(l,mapx);gl.uniform2fv(gl.getUniformLocation(programT,"u_light"),terrainlight);Game.editor?gl.uniform2fv(f,[0,-60]):gl.uniform2fv(f,[-4,-31]);f=gl.getAttribLocation(programT,"a_position");
g=new Uint32Array(256);g[68]=1;g[95]=1;g[96]=1;g[98]=1;g[101]=1;g[103]=1;g[107]=1;g[108]=1;g[109]=1;g[118]=1;g[121]=1;g[124]=1;g[134]=1;g[135]=1;g[139]=1;g[148]=1;g[150]=1;g[151]=1;g[156]=1;g[163]=1;g[164]=1;g[165]=1;g[166]=1;g[167]=1;g[173]=1;g[177]=1;g[180]=1;g[183]=1;g[185]=1;g[186]=1;g[195]=1;g[196]=1;g[198]=1;g[200]=1;g[203]=1;g[210]=1;g[214]=1;g[215]=1;g[223]=1;g[225]=1;g[230]=1;g[231]=1;g[241]=1;g[251]=1;g[252]=1;g[253]=1;g[254]=1;vaoTerrain=createVAO();bindVAO(vaoTerrain);g=gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER,g);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,-1,1,1,-1,1]),gl.STATIC_DRAW);gl.enableVertexAttribArray(f);gl.vertexAttribPointer(f,2,gl.FLOAT,!1,0,0);bindVAO(null);gl.useProgram(program);gl.bindBuffer(gl.ARRAY_BUFFER,null);vao=createVAO();bindVAO(vao);stepBuffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,stepBuffer);gl.enableVertexAttribArray(c);webgl1?(ANGLEEXT=gl.getExtension("ANGLE_instanced_arrays"),gl.vertexAttribPointer(c,1,gl.FLOAT,
!1,0,0),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([0,1,2,1,2,3]),gl.STATIC_DRAW),ANGLEEXT.vertexAttribDivisorANGLE(c,0)):(gl.vertexAttribIPointer(c,1,gl.UNSIGNED_BYTE,0,0),gl.bufferData(gl.ARRAY_BUFFER,new Uint8Array([0,1,2,1,2,3]),gl.STATIC_DRAW),gl.vertexAttribDivisor(c,0));bufferLimit=Math.floor(mapx*mapy/2);kingdomBuffer&&(gl.deleteBuffer(texCoordBuffer),gl.deleteBuffer(positionBuffer),gl.deleteBuffer(physicsbuffer),gl.deleteBuffer(marginsbuffer));texCoordBuffer=BufferSetup(d,3);positionBuffer=
BufferSetup(a,3);physicsbuffer=BufferSetup(b,4);marginsbuffer=BufferSetup(e,3);bindVAO(null);resolutionLocation=gl.getUniformLocation(program,"u_resolution");ambientLight=gl.getUniformLocation(program,"u_ambient");translationLocation=gl.getUniformLocation(program,"u_translation");zoomLocation=gl.getUniformLocation(program,"zoom");nowUniform=gl.getUniformLocation(program,"now");minimapLocation=gl.getUniformLocation(program,"miniMap");a=gl.getUniformLocation(program,"zMax");gl.uniform1f(a,Game.zMax);
gl.uniform1i(minimapLocation,0);gl.useProgram(program);a=wasmFloat32Array(WASM.sharedDelayID(),1323);Game.daylength||(Game.daylength=2880);Game.initialhour||(Game.initialhour=12);d=0;for(c=lightmap.length;d<c;d++).55>lightmap[d]&&(lightmap[d]=.55);dayNight();gl.uniform1f(zoomLocation,1);gl.uniform2fv(translationLocation,[0,0]);fb=gl.createFramebuffer();resizeFunc.changed=0;window.addEventListener("resize",resizeFunc,!1);resizeFunc();gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA);
gl.disable(gl.DITHER);gl.disable(gl.BLEND);performance.now();setupTerrainTXT(1);if(!engineOn){gl.uniform1f(gl.getUniformLocation(program,"kingdoms"),WASM.nkingdom());b=wasmu8Array(WASM.getColorTexture(),4*(WASM.nkingdom()+7));gl.activeTexture(gl.TEXTURE4);c=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,c);if(webgl1){e=new Uint8Array(4*Math.pow(64,2));for(d=0;d<e.length;d++)e[d]=b[d];gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,64,64,0,gl.RGBA,gl.UNSIGNED_BYTE,e);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,
gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);ms(b,e)}else gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,b.length/4,1,0,gl.RGBA,gl.UNSIGNED_BYTE,b),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT),gl.texParameteri(gl.TEXTURE_2D,
gl.TEXTURE_WRAP_T,gl.REPEAT);gl.bindTexture(gl.TEXTURE_2D,null);gl.bindTexture(gl.TEXTURE_2D,c);gl.uniform1i(gl.getUniformLocation(program,"colorArray"),4);gl.activeTexture(gl.TEXTURE3);c=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,c);if(webgl1){OES_TFLOAT=gl.getExtension("OES_texture_float");b=new Float32Array(65536);for(d=0;d<b.length;d++)b[4*d]=a[d];gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,128,128,0,gl.RGBA,gl.FLOAT,b);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,
gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST)}else gl.texImage2D(gl.TEXTURE_2D,0,gl.R16F,a.length,1,0,gl.RED,gl.FLOAT,a),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT);gl.bindTexture(gl.TEXTURE_2D,
null);gl.bindTexture(gl.TEXTURE_2D,c);gl.uniform1i(gl.getUniformLocation(program,"delay"),3);gl.activeTexture(gl.TEXTURE2);noText=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,noText);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,new Uint8Array([255,255,255,255]));gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT);gl.texParameteri(gl.TEXTURE_2D,
gl.TEXTURE_WRAP_T,gl.REPEAT);gl.clearColor(0,0,0,1)}gl.bindFramebuffer(gl.FRAMEBUFFER,fb);fb.width=1;fb.height=1;gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,Lighttexture,0);gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);gl.bindFramebuffer(gl.FRAMEBUFFER,null);new Float32Array(8);WASM.setupGL();gl.enable(gl.DEPTH_TEST);gl.depthFunc(gl.LEQUAL);rndr.fp1000=1E3;rndr.delta=0;rndr.now=0;rndr.frameCount=0;gl.bindTexture(gl.TEXTURE_2D,Lighttexture);engineOn=textureAtlas.setup=
!0}
var rndr=function(){if(!Game.canceled){performance.now();requestAnimationFrame(rndr);var d=rndr.fp1000,a=rndr.delta,c=rndr.now,b=rndr.realnow,e=rndr.delta,f=c;rndr.frameCount++;c=Date.now()-lastCycleTime+25*Game.cycle;rndr.now=c;a=(a+(c-f))/1E3;rndr.delta=a;f=b;b=Date.now();rndr.realnow=b;e=(e+(b-f))/1E3;rndr.realdelta=e;perfGPU+=a;perfGPUT++;rndr.fp1000=d+a;if(0!=scrPhysics.vx||0!=scrPhysics.vy)d=parseInt(localStorage.scrollSpeed)/100,screenX+=scrPhysics.vx*e*scrPhysics.speed*zoomValor*d,screenY+=scrPhysics.vy*
e*scrPhysics.speed*zoomValor*d,screenX=Math.floor(screenX),screenY=Math.floor(screenY),minimapLimiter(-screenX,-screenY);gl.useProgram(program);varfuncRender(c);move2();gl.uniform1f(nowUniform,c);gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);drawTerrain(c);bindVAO(vao);drawUnits(WASM.getBufferID());drawMiniMap();setupTerrainTXT.update&&setupTerrainTXT(1)}},drawLights=function(d){},drawUnits=function(d){d&&(gl.enable(gl.BLEND),gl.blendEquation(gl.FUNC_ADD),gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA),
webgl1?ANGLEEXT.drawArraysInstancedANGLE(gl.TRIANGLES,0,6,d):gl.drawArraysInstanced(gl.TRIANGLES,0,6,d),gl.disable(gl.BLEND))},drawMiniMap=function(){var d=gid("tzar").width,a=gid("tzar").height;gl.viewport(me.marx,a-mmH-me.mary,mmW,mmH);gl.uniform2f(resolutionLocation,32*mapx,32*mapy);gl.uniform2fv(translationLocation,[0,0]);gl.uniform1i(minimapLocation,1);gl.uniform1f(zoomLocation,1);drawUnits(WASM.getBufferID());gl.uniform1i(minimapLocation,2);drawUnits(1);gl.uniform1i(minimapLocation,0);gl.uniform2f(resolutionLocation,
d,a);gl.uniform2fv(translationLocation,[screenX,screenY]);gl.uniform1f(zoomLocation,1/zoomValor);gl.viewport(me.mx,0,d,a)},drawTerrain=function(d){var a=window.innerWidth,c=window.innerHeight;gl.useProgram(programT);bindVAO(vaoTerrain);gl.uniform1f(fpsLocationT,d);gl.drawArrays(gl.TRIANGLES,0,6);gl.viewport(me.marx,c-mmH-me.mary,mmW,mmH);gl.uniform1i(minimapLocationT,1);gl.uniform2fv(translationLocationT,[0,0]);gl.uniform1f(zoomLocationT,mmW/32/mapx);gl.drawArrays(gl.TRIANGLES,0,6);gl.uniform1i(minimapLocationT,
0);gl.uniform2f(resolutionLocationT,a,c);gl.uniform2fv(translationLocationT,[screenX,screenY]);gl.uniform1f(zoomLocationT,1/zoomValor);gl.viewport(me.mx,0,a,c);gl.useProgram(program)},engineOn=!1,setupViewArray,zoomFunc=function(d){if(!disableGameClick&&(d.clientX>me.menumx||mmClick||!d.clientX)){var a=d.deltaY;d=gid("tzar").width;var c=gid("tzar").height;a=Math.sign(a)*parseFloat(localStorage.zoomMult)/1E3*zoomValor;c=(zoomValor+a)*c*.03125;(zoomValor+a)*d*.03125-(zoomValor+a)*me.mx/32>mapx||c>mapy||
(zoomValor+=a,.08>zoomValor&&(zoomValor=.08),minimapLimiter(-screenX,-screenY),gl.useProgram(programT),gl.uniform1f(zoomLocationT,1/zoomValor),gl.useProgram(program),gl.uniform1f(zoomLocation,1/zoomValor),WASM.setupZoom(zoomValor),minimaprect())}},minimaprect=function(){var d=gid("tzar").width,a=gid("tzar").height,c=-screenY+.5*(a-zoomValor*a),b=zoomValor*(d-me.mx);a*=zoomValor;sharedFloat[0]=-screenX+.5*(d-zoomValor*d);sharedFloat[1]=c;sharedFloat[2]=-999999999;sharedFloat[3]=0;sharedFloat[4]=0;
bufferPos();sharedFloat[0]=b;sharedFloat[1]=a;sharedFloat[2]=0;sharedFloat[3]=0;sharedFloat[4]=0;bufferMargin()},ambientFunc=function(d){gl.useProgram(programT);gl.uniform4fv(ambientLightT,d);gl.useProgram(program);gl.uniform4fv(ambientLight,d)},lscreenx,lscreeny;
move2=function(){var d=[screenX,screenY];if(screenX!=lscreenx||screenY!=lscreeny)lscreenx=screenX,lscreeny=screenY,WASM.setupTranslation(-screenX,-screenY),gl.useProgram(programT),gl.uniform2fv(translationLocationT,d),gl.useProgram(program),gl.uniform2fv(translationLocation,d),minimaprect()};
var glsubarr=function(d,a){var c=textureAtlas.size;gl.texSubImage3D(gl.TEXTURE_2D_ARRAY,0,0,0,a,c,c,d.length/(c*c*4),gl.RGBA,gl.UNSIGNED_BYTE,d)},standardParameters=function(){gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT)},setup3Dtexture=function(){var d=wasmFloat32Array(WASM.atlasLoc(),1048576);
gl.activeTexture(gl.TEXTURE0);var a=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,a);webgl1?gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,512,512,0,gl.RGBA,gl.FLOAT,d):gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA32F,512,512,0,gl.RGBA,gl.FLOAT,d);standardParameters();gl.uniform1i(gl.getUniformLocation(program,"u_image1"),0);var c=performance.now();d=textureAtlas.common;if(webgl1){c=4*Math.pow(4096,2);for(var b=Math.ceil(d.length/c),e=0;e<b;e++){gl.activeTexture(gl.TEXTURE6+e);var f=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,
f);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT);f=new Uint8Array(d.buffer,d.byteOffset+c*e,c);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,4096,4096,0,gl.RGBA,gl.UNSIGNED_BYTE,f);gl.uniform1i(gl.getUniformLocation(program,"img_common["+e+"]"),6+e);gl.useProgram(programT);gl.uniform1i(gl.getUniformLocation(programT,
"img_common["+e+"]"),6+e);gl.useProgram(program)}gl.useProgram(programT)}else gl.activeTexture(gl.TEXTURE1),f=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D_ARRAY,f),gl.texParameteri(gl.TEXTURE_2D_ARRAY,gl.TEXTURE_MAG_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D_ARRAY,gl.TEXTURE_MIN_FILTER,gl.NEAREST),gl.texImage3D(gl.TEXTURE_2D_ARRAY,0,gl.RGBA,textureAtlas.size,textureAtlas.size,d.length/(textureAtlas.size*textureAtlas.size*4),0,gl.RGBA,gl.UNSIGNED_BYTE,d),gl.uniform1i(gl.getUniformLocation(program,
"img_common"),1),ms("3dtex",performance.now()-c),gl.useProgram(programT),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D_ARRAY,f),gl.uniform1i(gl.getUniformLocation(programT,"img_common"),0);gl.activeTexture(gl.TEXTURE5);gl.bindTexture(gl.TEXTURE_2D,a);gl.uniform1i(gl.getUniformLocation(programT,"u_image1"),5);WASM.delTexs();gl.activeTexture(gl.TEXTURE2)},terrainlight,stpLIGHT=function(d,a){terrainlight=[d,a]},Lighttexture,resizeFunc=function(){var d=window.innerWidth,a=window.innerHeight;
gl.canvas.width=d;gl.canvas.height=a;WASM.canvasSize(d,a);gl.useProgram(programT);gl.uniform2f(resolutionLocationT,d,a);gl.useProgram(program);fb.width=d;fb.height=a;gl.activeTexture(gl.TEXTURE2);Lighttexture||(Lighttexture=gl.createTexture());gl.bindTexture(gl.TEXTURE_2D,Lighttexture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,d,a,0,gl.RGBA,gl.UNSIGNED_BYTE,null);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,
gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.bindFramebuffer(gl.FRAMEBUFFER,fb);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,Lighttexture,0);gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);gl.bindFramebuffer(gl.FRAMEBUFFER,null);gl.uniform1f(zoomLocation,1);gl.uniform1i(gl.getUniformLocation(program,"lightmap"),2);gl.useProgram(programT);gl.uniform1i(gl.getUniformLocation(programT,"lightmap"),2);gl.uniform1f(zoomLocationT,
1);gl.useProgram(program);gl.uniform2f(resolutionLocation,d,a);gl.viewport(me.mx,0,d,a);resizeFunc.changed=1;minimapLimiter(-screenX,-screenY)},bindVAO=function(d){if(webgl1)return VAOEXT.bindVertexArrayOES(d);gl.bindVertexArray(d)},VAOEXT,ANGLEEXT,OES_TFLOAT,createVAO=function(){return webgl1?(VAOEXT||(VAOEXT=gl.getExtension("OES_vertex_array_object")),VAOEXT.createVertexArrayOES()):gl.createVertexArray()};Array.prototype.put=function(d){this[this.length]=d};Array.prototype.quit=function(d){d=this.indexOf(d);return-1<d?(this.splice(d,1),!0):!1};Array.prototype.add=function(d){0>this.indexOf(d)&&(this[this.length]=d)};
var Game={},SetupGame=function(){Game.cycle?Game.deltaTime=25*Game.cycle:(Game.date=Date.now(),Game.cycle=0,Game.deltaTime=0);Game.loadDate=Date.now()},info,setupInfo=function(){info=[{name:"Footman",attack:6,defence:3,health:65,maxHealth:65,img:NaN.euro_footman,attackSound:swordSound,invType:0,invMax:8,validator:null,human:12,iconID:36,time:12,sight:5,url:NaN.euro_footman,icons:null,cost:[0,0,50,0],attDist:1,spd:50,dieSound:normalDieSound,clss:"footman",size:1,standardFunc:null,radix:0,zLevel:1,
strID:"e_footman",race:"euro"},{name:"Pikeman",radix:0,attackSound:swordSound,attack:8,defence:4,health:75,maxHealth:75,img:NaN.euro_pikeman,invType:0,dieSound:normalDieSound,invMax:8,validator:null,human:1,iconID:39,time:18,sight:5,url:NaN.euro_pikeman,icons:null,cost:[40,0,60,0],attDist:1,spd:50,standardFunc:null,clss:"e_pikeman",zLevel:1,size:1,strID:"e_pikeman",nu:NaN.createPikeman,race:"euro"},{name:"Spy",radix:0,attack:20,defence:0,mana:100,manaMax:100,health:50,maxHealth:50,img:NaN.euro_spy,
attackSound:["spy%20kill%201","spy%20kill%202","spy%20kill%203"],invType:0,invMax:8,validator:null,human:1,dieSound:normalDieSound,iconID:41,time:30,sight:12,url:NaN.euro_spy,icons:[NaN.move,NaN.attack,NaN.guard,NaN.patrol,NaN.pickUp,NaN.explore,NaN.stop,NaN.stand,NaN.impersonate,NaN.revealSelf],zLevel:1,cost:[120,0,0,0],attDist:1,spd:50,clss:"spy",standardFunc:null,size:1,update:["mana","manaSpeed",gameParameters.manaRechargeTime],isSpy:1,strID:"spy",nu:NaN.createSpy,race:"common"},{name:"Maceman",
radix:0,attack:8,defence:0,health:120,maxHealth:120,img:NaN.euro_maceman,attackSound:swordSound,invType:0,invMax:8,validator:null,human:1,iconID:37,time:14,dieSound:normalDieSound,sight:5,zLevel:1,url:NaN.euro_maceman,icons:null,cost:[0,0,120,0],attDist:1,spd:50,clss:"maceman",standardFunc:null,size:1,strID:"e_maceman",nu:NaN.createMaceman,race:"euro"},{radix:0,name:"Archer",attack:5,defence:0,health:50,maxHealth:50,img:NaN.euro_archer1,invType:0,invMax:8,validator:null,human:1,sight:10,dieSound:normalDieSound,
arrow:!0,iconID:38,zLevel:1,time:12,url:NaN.euro_archer1,icons:null,cost:[0,20,40,0],attDist:7,spd:50,clss:"archer",standardFunc:null,attimg:NaN.arrow1,attackSound:archerSound,size:1,strID:"e_archer",nu:NaN.createArcher,race:"euro"},{radix:0,name:"Wizard",attackSound:mageSound,dieSound:["mage"],attack:5,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:NaN.euro_mage,zLevel:1,invType:0,invMax:8,validator:null,human:1,iconID:42,time:30,sight:15,url:NaN.euro_mage,icons:[NaN.stop,NaN.pickUp,NaN.explore,
NaN.lightning,NaN.createBat,NaN.freeze,NaN.createGolem,NaN.invisibility,NaN.stand,NaN.attack,NaN.move],cost:[150,0,0,0],attDist:10,attimg:NaN.flame_bolt,ball:1,spd:50,clss:"mage",standardFunc:null,size:1,update:["mana","manaSpeed",gameParameters.manaRechargeTime],strID:"e_mage",nu:NaN.createMage,race:"euro"},{radix:0,name:"Longbowman",attack:6,defence:2,health:50,maxHealth:50,img:NaN.euro_longbowman,zLevel:1,invType:0,invMax:8,dieSound:normalDieSound,attackSound:archerSound,arrow:!0,validator:null,
race:"euro",human:1,iconID:35,time:18,sight:18,url:NaN.euro_longbowman,icons:null,cost:[50,0,90,0],attDist:12,spd:50,standardFunc:null,clss:"longbowman",size:1,d2attack:2,strID:"e_longbowman",attimg:NaN.arrow1,nu:NaN.createLongbowman},{radix:0,clss:"tree",name:"Tree",health:100,maxHealth:100,img:NaN.terrain_tree,invType:0,invMax:8,zLevel:1,mMapcolor:[11,131,11],validator:null,child:[{img:NaN.terrain_tree_s,rgb:[0,0,0,.5],alpha:1,x:0,y:0}],iconID:23,url:NaN.terrain_tree,dimgInfinity:NaN.terrain_tree,
dimgRND:3,icons:[],res:1,race:"common",build:!0,size:1,zolotoy:1,strID:"tree"},{radix:0,name:"Crusader",zLevel:1,dieSound:hdieSound,attackSound:hswordSound,attack:14,defence:8,health:180,maxHealth:180,img:NaN.crus,invType:0,invMax:8,validator:null,human:1,race:"euro",iconID:100,time:19,sight:5,url:NaN.crus,icons:null,cost:[0,0,0,0],attDist:1,spd:85,standardFunc:null,clss:"crusader",size:1,strID:"crusader"},{radix:0,name:"Priest",attack:20,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:NaN.euro_priest,
invType:0,zLevel:1,invMax:8,validator:null,human:1,iconID:40,time:30,ball:1,sight:21,dieSound:normalDieSound,url:NaN.euro_priest,icons:null,cost:[150,0,0,0],attDist:18,race:"euro",spd:50,standardFunc:null,clss:"priest",size:1,update:["mana","manaSpeed",gameParameters.manaRechargeTime],strID:"e_priest",nu:NaN.createPriest,attimg:NaN.flame_bolt},{radix:0,name:"Peasant",attackSound:handSound,attack:5,defence:0,health:50,maxHealth:50,img:NaN.euro_peasant,invType:0,invMax:8,dieSound:normalDieSound,zLevel:1,
validator:null,human:1,race:"euro",iconID:33,time:8,sight:5,url:NaN.euro_peasant,icons:[NaN.move,NaN.menuBuilds,NaN.repair,NaN.conquest,NaN.dcm,NaN.pickUp,NaN.explore,NaN.stop,NaN.stand,NaN.attack,NaN.bribe,NaN.sameSpeed,NaN.restoreSpeed],cost:[0,0,50,0],attDist:1,spd:50,clss:"peon",size:1,peon:1,strID:"e_peon",nu:NaN.createPeon,nocapture:1},{radix:0,clss:"cathedral",name:"Cathedral",dieSound:dieSoundBuild,sound:["e_cathedral1","e_cathedral2"],resistance:700,health:5E3,maxHealth:5E3,img:NaN.euro_cathedral,
invType:0,invMax:8,race:"euro",zLevel:1,validator:null,bimg:NaN.build5x5,dimg:NaN.des_5x5,iconID:60,icons:[NaN.createCrusaders,NaN.techFanaticism,NaN.techEspionage,NaN.techInquisition,NaN.techHealing,NaN.techBless,NaN.techCrusade,NaN.techMedicine],time:90,sight:8,child:[{img:NaN.euro_cathedral_c,x:0,y:0},{img:NaN.euro_cathedral_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,5]),url:NaN.euro_cathedral,build:!0,cost:[2E3,0,0,2E3],onbuild:[NaN.buildChurch],
size:1,strID:"cathedral"},{radix:0,name:"Castle",clss:"castle",dieSound:dieSoundBuild,sound:["e_castle1"],resistance:700,health:8E3,maxHealth:8E3,img:NaN.euro_castle,invType:1,invMax:50,race:"euro",zLevel:1,validator:null,bimg:NaN.build6x6,dimg:NaN.des_6x6,iconID:59,time:120,sight:12,child:[{img:NaN.euro_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:NaN.euro_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[NaN.createPeon,NaN.createSpy,NaN.emergeAllUnits,NaN.techFeudalism,NaN.techArchitecture,NaN.techLearning],space:new Uint8Array([0,
1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,0,1,1,7]),url:NaN.euro_castle,build:!0,cost:[0,1500,0,1500],storage:4,castle:!0,population:20,size:1,strID:"e_castle"},{radix:0,name:"Wooden Wall",clss:"wall_wood",resistance:700,health:2E3,maxHealth:2E3,img:NaN.wood_tower,time:6,sight:1,zLevel:1,dieSound:dieSoundBuild,validator:null,bimg:NaN.wood_build,dimgInfinity:NaN.wood_debris,iconID:49,icons:[],mx:0,race:"common",my:0,hframe:71,url:NaN.wood_tower,space:new Uint8Array([1,
1]),wall:1,build:!0,cost:[0,20,0,0],size:1,strID:"woodwall",child:[{img:NaN.wood_tower_c,x:0,y:0}]},{radix:0,name:"Barracks",clss:"barracks",strID:"e_barrack",sound:barracksSound,generator:1,resistance:500,health:1400,maxHealth:1400,img:NaN.euro_barrack,invType:1,invMax:0,dieSound:dieSoundBuild,time:60,sight:6,zLevel:1,race:"euro",validator:null,bimg:NaN.build5x5,dimg:NaN.des_5x5,child:[{img:NaN.euro_barracks_c,mv:!0},{img:NaN.euro_barrack_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:57,icons:[NaN.createFootman,
NaN.createArcher,NaN.createMaceman,NaN.createPikeman,NaN.createLongbowman,NaN.createKnight],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:NaN.euro_barrack,build:!0,cost:[0,0,200,200],size:1},{radix:0,strID:"e_lumber",name:"Lumber Mill",sound:["e_lumber1"],clss:"lumber_mill",resistance:500,health:800,maxHealth:800,img:NaN.euro_lumbermill,invType:1,invMax:0,time:30,race:"euro",sight:4,dieSound:dieSoundBuild,zLevel:1,validator:null,bimg:NaN.build2x2,dimg:NaN.des_2x2,
iconID:64,child:[{img:NaN.euro_lumbermill_c,x:0,y:0},{alpha:!0,img:NaN.euro_lumbermill_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[NaN.techLongbow,NaN.techWoodCutting,NaN.techCrossbow],space:new Uint8Array([1,1,1,1,2]),hframe:98,url:NaN.euro_lumbermill,build:!0,cost:[0,100,0,0],storage:1,size:1},{radix:0,name:"Mage Tower",strID:"e_magetower",sound:["e_magetower1","e_magetower2","e_magetower3"],clss:"magictower",resistance:700,health:5E3,maxHealth:5E3,img:NaN.euro_magetower,invType:1,invMax:0,time:90,race:"euro",
dieSound:dieSoundBuild,sight:8,validator:null,bimg:NaN.build5x5,dimg:NaN.des_5x5,zLevel:1,child:[{img:NaN.euro_magetower_c,x:0,y:0},{img:NaN.euro_magetower_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:71,icons:[NaN.createMage,NaN.techBat,NaN.techInvisibility,NaN.techLightning,NaN.techFreeze,NaN.techGolem],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:NaN.euro_magetower,build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,strID:"e_waracademy",name:"Warriors Guild",sound:["e_waracademy1"],clss:"academy",
resistance:700,health:5E3,maxHealth:5E3,img:NaN.euro_waracademy,invType:1,invMax:0,race:"euro",time:90,sight:8,dieSound:dieSoundBuild,zLevel:1,validator:null,bimg:NaN.build6x6,dimg:NaN.des_6x6,iconID:56,child:[{img:NaN.euro_waracademy_c,x:0,y:0,mv:!0},{img:NaN.euro_waracademy_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],icons:[NaN.techHeroism,NaN.techWarfare,NaN.techMercenaries,NaN.techSiegeTactics,NaN.techBodyBuilding,NaN.techLeadership,NaN.techTactics,NaN.techHeroes,NaN.techHonor,NaN.techFame],space:new Uint8Array([0,
1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,0,5]),url:NaN.euro_waracademy,build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,name:"Storage",strID:"e_storage",sound:["e_storage1","e_storage2"],clss:"storage",resistance:80,health:800,maxHealth:800,img:NaN.euro_storage,invType:1,invMax:0,time:30,dieSound:dieSoundBuild,zLevel:1,sight:5,validator:null,bimg:NaN.build4x4,dimg:NaN.des_4x4,iconID:69,race:"euro",icons:[NaN.techGoldMining,NaN.techStoneMining],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
1,4]),url:NaN.euro_storage,storage:0,build:!0,cost:[0,200,0,0],size:1,child:[{img:NaN.euro_storage_c,x:0,y:0},{img:NaN.euro_storage_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Knight",strID:"e_knight",dieSound:hdieSound,clss:"knight",attackSound:hswordSound,attack:12,defence:6,health:120,maxHealth:120,img:NaN.euro_knight,invType:0,zLevel:1,race:"euro",invMax:8,validator:null,human:1,iconID:43,d2attack:2,time:22,sight:5,url:NaN.euro_knight,icons:null,cost:[120,0,70,0],attDist:1,spd:85,nu:NaN.createKnight,
standardFunc:null,size:1},{radix:0,name:"Field",clss:"field",strID:"field",instantBuild:1,resistance:80,health:100,maxHealth:100,img:NaN.fields,invMax:0,validator:null,zLevel:0,iconID:104,race:"common",icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:NaN.fields,build:!0,field:1,res:2,cost:[0,200,0,0],rndDirection:9,time:0,sight:1,z32:.5,size:1},{radix:0,name:"Golden rocks",mMapcolor:[148,148,0],strID:"gold",sound:["mine1"],clss:"golden_rocks",resistance:0,health:8E3,maxHealth:8E3,img:NaN.res_gold,
invMax:0,validator:null,iconID:20,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:NaN.res_gold,build:!0,zLevel:1,race:"common",res:0,cost:[0,0,0,0],time:0,sight:2,dieSound:["destroy%20mine"],size:1,zolotoy:1,child:[{img:NaN.res_gold_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:NaN.res_gold},{radix:0,name:"Rocks",strID:"stone",mMapcolor:[132,132,132],sound:["mine1"],clss:"rocks",dieSound:["destroy%20mine"],resistance:0,health:8E3,maxHealth:8E3,img:NaN.res_stone,invMax:0,
validator:null,zLevel:1,iconID:22,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:NaN.res_stone,build:!0,res:3,cost:[0,0,0,0],race:"common",time:0,sight:2,size:1,zolotoy:1,child:[{img:NaN.res_stone_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:NaN.res_stone},{radix:0,name:"Farm",strID:"e_farm",sound:["e_farm1","e_farm2"],clss:"farm",resistance:0,health:800,maxHealth:800,img:NaN.euro_farm,invType:1,invMax:0,zLevel:1,validator:null,bimg:NaN.build4x4,dimg:NaN.des_4x4,iconID:61,
dieSound:dieSoundBuild,race:"euro",icons:[NaN.createCow,NaN.techCropRotation,NaN.techDomestication],space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:NaN.euro_farm,build:!0,cost:[0,200,0,0],time:30,sight:5,storage:2,size:1,child:[{img:NaN.euro_farm_c,x:0,y:0}]},{radix:0,name:"Merchants Guild",strID:"e_merchant",sound:["merchant"],clss:"merchants_guild",resistance:0,health:5E3,maxHealth:5E3,img:NaN.euro_tcguild,invType:1,invMax:0,validator:null,bimg:NaN.build6x6,zLevel:1,dimg:NaN.des_6x6,
race:"euro",iconID:62,dieSound:dieSoundBuild,icons:[NaN.techMapMaking,NaN.techTradeRoutes,NaN.techUsury,NaN.techSupplyStorage,NaN.techBribery,NaN.techTradeTaxes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),url:NaN.euro_tcguild,build:!0,time:90,sight:8,cost:[2E3,0,0,2E3],onbuild:[NaN.buildMarket],size:1,child:[{img:NaN.euro_tcguild_c,x:0,y:0},{img:NaN.euro_tcguild_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Church",clss:"church",strID:"e_church",sound:["e_church1"],
resistance:0,health:800,maxHealth:800,img:NaN.euro_church,invType:1,invMax:0,dieSound:dieSoundBuild,validator:null,bimg:NaN.build3x3,race:"euro",zLevel:1,dimg:NaN.des_3x3,iconID:139,icons:[NaN.createPriest],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:NaN.euro_church,build:!0,cost:[0,0,200,200],time:40,sight:6,size:1,child:[{img:NaN.euro_church_c,x:0,y:0},{img:NaN.euro_church_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Blacksmith",clss:"blacksmith",strID:"e_blacksmith",resistance:0,health:800,
maxHealth:800,img:NaN.euro_blacksmith,invType:1,invMax:0,time:40,zLevel:1,sight:5,dieSound:dieSoundBuild,validator:null,bimg:NaN.build4x4,race:"euro",dimg:NaN.des_4x4,child:[{img:NaN.euro_blacksmith_c,x:0,y:0}],iconID:58,icons:[NaN.techPlateArmor,NaN.techTemperIron,NaN.techScaleArmor,NaN.techHalberd,NaN.techChainMail],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:NaN.euro_blacksmith,build:!0,cost:[0,0,200,200],size:1},{radix:0,name:"Cow",clss:"cow",nu:NaN.createCow,race:"common",strID:"cow",
attack:0,defence:3,health:50,maxHealth:50,img:NaN.cow,invType:0,invMax:8,zLevel:1,validator:null,iconID:99,time:20,dieSound:["cowdie1","cowdie2","cowdie3","cowdie4"],url:NaN.cow,icons:[NaN.move,NaN.stop],sight:3,cost:[0,0,300,0],attDist:0,spd:32,res:2,food:300,milk:50,milkMax:gameParameters.milkMax,foodMax:gameParameters.foodMax,size:1,cow:1,update:["milk","milkSpeed",gameParameters.milkRechargeTime,"food","cowSpeed",gameParameters.cowRechargeTime]},{radix:0,name:"Stable",sound:["e_stables1"],clss:"stable",
strID:"e_stable",onlyRequired:1,resistance:0,health:800,maxHealth:800,invType:1,invMax:0,race:"euro",zLevel:1,validator:null,bimg:NaN.build4x4,dimg:NaN.des_4x4,iconID:68,dieSound:dieSoundBuild,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,4]),url:NaN.euro_stables,build:!0,cost:[0,200,0,0],onbuild:null,size:1,time:40,sight:5,img:NaN.euro_stables,nu:NaN.createCow,child:[{img:NaN.euro_stable_c,x:0,y:0}]},{radix:0,name:"Workshop",sound:["e_workshop1"],clss:"workshop",strID:"e_workshop",zLevel:1,
resistance:0,health:800,maxHealth:800,img:NaN.euro_workshop,invType:1,invMax:0,dieSound:dieSoundBuild,validator:null,bimg:NaN.build4x4,race:"euro",dimg:NaN.des_4x4,iconID:75,icons:[NaN.createCatapult,NaN.createHeavyCatapult,NaN.createBallist,NaN.techEngineering,NaN.techCannonTower],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,4]),url:NaN.euro_workshop,build:!0,cost:[0,200,200,0],size:1,time:40,sight:5,child:[{img:NaN.euro_workshop_c,x:0,y:0}]},{radix:0,name:"Tavern",sound:["e_tavern1"],clss:"tavern",
strID:"e_tavern",dieSound:dieSoundBuild,resistance:0,health:1E3,maxHealth:1E3,img:NaN.euro_tavern,invType:1,invMax:0,validator:null,race:"euro",bimg:NaN.build4x4,dimg:NaN.des_4x4,zLevel:1,iconID:70,icons:[NaN.createMercenaries,NaN.createHeroes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,4]),url:NaN.euro_tavern,build:1,cost:[0,200,200,0],onbuild:null,actvintv:[NaN.iniMercenaries,NaN.iniHeroes],size:1,time:40,sight:5,child:[{img:NaN.euro_tavern_c,x:0,y:0}]},{name:"House",sound:["house1",
"house2","house3","house4","house5"],clss:"house",strID:"e_house",resistance:0,health:500,maxHealth:500,img:NaN.euro_houses,invType:1,invMax:0,validator:null,bimg:NaN.build3x3,dimg:NaN.des_3x3,race:"euro",iconID:73,zLevel:1,dieSound:dieSoundBuild,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:NaN.euro_houses,build:!0,cost:[0,75,0,0],population:10,size:1,time:20,sight:4,child:[{img:NaN.euro_houses_c,x:0,y:0}]},{name:"Watch Tower",attackSound:arrowSoundTower,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),
clss:"watch_tower",strID:"watch_tower",attack:7,health:400,maxHealth:400,img:NaN.euro_tower_wood_2,state:0,invType:1,race:"common",invMax:0,zLevel:1,dieSound:dieSoundBuild,level:0,validator:null,child:[{img:NaN.euro_tower_wood_2_c,x:0,y:0},{alpha:!0,img:NaN.euro_tower_wood_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attimg:NaN.arrow1,attDist:8,bimg:NaN.build2x2,dimg:NaN.des_2x2,iconID:53,icons:[NaN.attack,NaN.stop,NaN.upgradeGuildTower],space:new Uint8Array([1,1,1,1,2]),url:NaN.euro_tower_wood_2,build:!0,cost:[0,
300,0,0],size:1,arrow:!0,time:10,sight:15,standardFunc:null},{name:"Market",sound:["e_market1"],clss:"market",strID:"e_market",resistance:0,health:1400,maxHealth:1400,img:NaN.euro_market,invType:1,invMax:0,dieSound:dieSoundBuild,zLevel:1,validator:null,bimg:NaN.build4x4,dimg:NaN.des_4x4,iconID:65,race:"euro",icons:[NaN.createCaravan],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,4]),url:NaN.euro_market,build:!0,cost:[0,200,200,0],size:1,time:60,sight:8,child:[{img:NaN.euro_market_c,x:0,y:0}]},
{name:"Outpost",sound:["e_outpost1"],clss:"outpost",strID:"e_outpost",zLevel:1,resistance:0,health:2E3,maxHealth:2E3,img:NaN.euro_outpost,invType:1,dieSound:dieSoundBuild,invMax:50,validator:null,race:"euro",bimg:NaN.build4x4,dimg:NaN.des_4x4,iconID:66,icons:[NaN.emergeAllUnits],space:new Uint8Array([0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,4]),url:NaN.euro_outpost,build:!0,cost:[0,200,0,400],size:1,child:[{img:NaN.euro_outpost_c,x:0,y:0},{img:NaN.euro_outpost_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:60,sight:8},
{name:"Bridge",clss:"bridge",strID:"bridge",resistance:0,health:1E4,maxHealth:1E4,img:NaN.bridge_horz,invMax:0,valid2:!0,validator:null,bimg:NaN.bridge_horz_build,race:"common",zLevel:1,dieSound:dieSoundBuild,child:[{alpha:!0,img:NaN.bridge_horz_s,x:0,y:0,rgb:[0,0,0,.5]},{img:NaN.bridge_horz1,x:0,y:0,z:6}],time:22,sight:1,dimg:NaN.bridge_horz_demol,iconID:44,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,11]),url:NaN.bridge_horz,build:!0,cost:[0,200,0,400],size:1},{name:"Dummy",clss:"dummy",strID:"dummy",resistance:0,health:5E3,maxHealth:5E3,img:NaN.dummy1,invMax:0,validator:null,bimg:NaN.dummy1_b,iconID:165,icons:[],mx:0,zLevel:1,my:16,hframe:65,race:"common",url:NaN.dummy1,dimg:NaN.dummy1_d,build:!0,cost:[0,300,0,0],dummy:!0,child:[{img:NaN.dummy1_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:10,sight:1},{name:"Catapult",strID:"catapult",dieSound:siegeDieSound,
clss:"catapult",attackSound:catapultSound,defence:0,attack:10,health:110,maxHealth:110,img:NaN.catapult,invMax:0,radix:0,validator:null,iconID:30,time:30,sight:20,race:"common",url:NaN.catapult,level:0,zLevel:1,icons:null,cost:[0,600,0,0],nofreeze:1,arrow:!1,attDist:17,spd:40,standardFunc:null,size:1,attimg:NaN.cat_stone,space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:NaN.createCatapult},{name:"Ballista",radix:0,strID:"ballista",attackSound:catapultSound,dieSound:siegeDieSound,clss:"ballista",defence:0,
attack:60,health:75,maxHealth:75,img:NaN.ballista,invMax:0,validator:null,iconID:31,time:30,sight:16,nofreeze:1,race:"common",zLevel:1,url:NaN.ballista,icons:null,cost:[0,800,0,0],attDist:13,spd:40,standardFunc:null,size:1,attimg:NaN.arrow_ballista1,space:new Uint8Array([1,1,1,1,2]),attackDeg:30,nu:NaN.createBallist},{name:"Heavy Catapult",strID:"heavy_catapult",attackSound:catapultSound,defence:0,attack:25,health:250,maxHealth:250,img:NaN.h_catapult,invMax:0,radix:0,validator:null,iconID:45,time:60,
dieSound:siegeDieSound,sight:26,race:"common",url:NaN.h_catapult,zLevel:1,icons:null,standardFunc:null,cost:[0,1200,0,0],attDist:22,spd:40,nofreeze:1,clss:"heavy_catapult",size:1,attimg:NaN.cb_metal,space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:NaN.createHeavyCatapult},{radix:0,name:"Ghost",strID:"ghost",defence:0,attack:8,health:60,maxHealth:60,img:NaN.euro_ghost,invType:0,invMax:8,dieSound:["ghost1","ghost2"],validator:null,iconID:178,zLevel:1,race:"common",time:15,attackSound:ghostSound,sight:5,
standardFunc:null,url:NaN.euro_ghost,icons:null,w:1,cost:[40,0,0,0],attDist:1,spd:80,clss:"ghost",size:1,nu:NaN.createGhost},{name:"Harbor",strID:"e_harbor",resistance:80,health:800,maxHealth:800,img:NaN.euro_harbor,invType:1,invMax:0,validator:null,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:NaN.build_harbor,dimg:NaN.des_harbor,zLevel:1,race:"euro",dieSound:dieSoundBuild,iconID:63,icons:[NaN.createFishingBoat,NaN.createXebec,NaN.createHulk,NaN.createGalleon,NaN.techLandingTactics],clss:"harbor",
url:NaN.euro_harbor,storage:4,build:!0,cost:[0,200,200,0],child:[{img:NaN.euro_harbor_c,x:0,y:0},{img:NaN.euro_harbor_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:60,sight:8},{radix:0,name:"Messiah",strID:"messiah",attack:50,defence:10,mana:1E3,manaMax:1E3,health:1E3,maxHealth:1E3,img:NaN.messiah,invType:0,invMax:0,race:"common",validator:null,human:1,iconID:169,zLevel:1,attackSound:["messiah_attack"],dieSound:["messiah"],time:300,sight:26,url:NaN.messiah,standardFunc:null,icons:null,cost:[2E3,0,0,0],
attDist:10,spd:50,clss:"messiah",size:1,update:["mana","manaSpeed",gameParameters.manaRechargeTime]},{name:"Magic Gateway",sound:["gateway"],strID:"gateway",magicGateway:1,resistance:0,health:Infinity,maxHealth:Infinity,img:NaN.teleport,invMax:0,validator:null,bimg:NaN.build4x4,zLevel:1,dieSound:dieSoundBuild,race:"common",iconID:180,clss:"magic_gateway",icons:[NaN.createOrk,NaN.createDwarf,NaN.createGhost,NaN.createSkeleton],space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,
5]),url:NaN.teleport,build:!0,cost:[0,0,0,0],size:1,time:10,sight:10,zolotoy:1,child:[{img:NaN.teleport_c,x:0,y:0},{alpha:!0,img:NaN.teleport_s,x:0,y:0,rgb:[0,0,0,.5]}],standardFunc:null},{name:"Guard Tower",strID:"guard_tower",race:"common",clss:"guard_tower",attackSound:arrowSoundTower,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:12,health:1E3,maxHealth:1E3,img:NaN.euro_tower_wood,state:0,invType:1,invMax:0,dieSound:dieSoundBuild,zLevel:1,validator:null,child:[{img:NaN.euro_tower_wood_c,
x:0,y:0},{alpha:!0,img:NaN.euro_tower_wood_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:12,bimg:NaN.build2x2,dimg:NaN.des_2x2,iconID:52,icons:[NaN.attack,NaN.stop,NaN.upgradeStoneTower,NaN.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:NaN.euro_tower_wood,build:!0,cost:[0,600,0,0],size:1,arrow:!0,attimg:NaN.arrow1,time:35,sight:16,standardFunc:null},{name:"Sword",attack:0,defence:0,health:25,maxHealth:25,img:NaN.items1,state:0,invMax:0,validator:null,iconID:16,url:NaN.items1,icons:[],cost:[0,0,0,
0],size:1,zLevel:0,z32:.5,radix:0,race:"common",item:1},{name:"Bow",attack:0,defence:0,health:25,maxHealth:25,img:NaN.items1,state:0,invMax:0,validator:null,iconID:4,url:NaN.items1,icons:[],cost:[0,0,0,0],size:1,z32:.5,zLevel:0,radix:0,race:"common",item:1},{name:"Shield",attack:0,defence:0,health:25,maxHealth:25,img:NaN.items1,state:0,invMax:0,validator:null,iconID:1,url:NaN.items1,icons:[],cost:[0,0,0,0],zLevel:0,race:"common",radix:0,size:1,z32:.5,item:1},{name:"Potion",attack:0,defence:0,health:25,
maxHealth:25,img:NaN.potions,state:0,invMax:0,validator:null,iconID:11,url:NaN.potions,icons:[],radix:0,race:"common",zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Book",attack:0,defence:0,health:25,maxHealth:25,img:NaN.book1,state:0,invMax:0,validator:null,iconID:9,zLevel:0,race:"common",radix:0,url:NaN.books,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Gold",health:1,maxHealth:1,img:NaN.item_gold,invMax:0,validator:null,iconID:20,radix:0,race:"common",zLevel:0,url:NaN.item_gold,icons:[],
cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Stone",health:1,maxHealth:1,img:NaN.item_stone,invMax:0,validator:null,iconID:22,race:"common",radix:0,url:NaN.item_stone,zLevel:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Food",health:15,maxHealth:15,img:NaN.item_food,invMax:0,mMapcolor:[0,255,255],validator:null,iconID:14,url:NaN.item_food,radix:0,race:"common",icons:[],zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{ignore:1,name:"Wood",health:1,maxHealth:1,img:NaN.item_wood,invMax:0,validator:null,
iconID:15,url:NaN.item_wood,icons:[],race:"common",radix:0,zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Iron",health:1,maxHealth:1,img:NaN.item_iron,invMax:0,validator:null,iconID:21,zLevel:0,race:"common",url:NaN.item_iron,radix:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Keep Tower",strID:"keep_tower",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:16,health:2E3,maxHealth:2E3,img:NaN.euro_tower_stone,state:0,invType:1,zLevel:1,attackSound:arrowSoundTower,invMax:0,
dieSound:dieSoundBuild,validator:null,clss:"keep_tower",race:"common",child:[{alpha:!0,img:NaN.euro_tower_stone_s,x:0,y:0,rgb:[0,0,0,.5]},{img:NaN.euro_tower_stone_c,x:0,y:0}],attDist:14,bimg:NaN.build2x2,dimg:NaN.des_2x2,standardFunc:null,iconID:54,icons:[NaN.attack,NaN.stop,NaN.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:NaN.euro_tower_stone,build:!0,cost:[0,600,0,0],size:1,arrow:!0,attimg:NaN.arrow_big1,time:40,sight:18},{name:"Cannon Tower",clss:"tower_stone2",strID:"tower_stone2",
attackSound:shipSound,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:40,health:2500,maxHealth:2500,img:NaN.euro_tower_stone_2,state:0,invType:1,invMax:0,dieSound:dieSoundBuild,race:"common",validator:null,zLevel:1,child:[{img:NaN.euro_tower_stone_2_c,x:0,y:0},{alpha:!0,img:NaN.euro_tower_stone_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:10,bimg:NaN.build2x2,dimg:NaN.des_2x2,iconID:54,icons:[NaN.attack,NaN.stop],space:new Uint8Array([1,1,1,1,2]),url:NaN.euro_tower_stone_2,build:!0,cost:[0,
600,0,0],standardFunc:null,size:1,arrow:!1,attimg:NaN.hot_cannon,time:45,sight:18,attackDeg:30},{name:"Rocket Tower",strID:"tower_rocket",race:"asia",clss:"tower_rocket",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),zLevel:1,attack:30,health:1400,maxHealth:1400,img:NaN.rocket_tower,state:0,invType:1,invMax:0,dieSound:dieSoundBuild,validator:null,child:[{img:NaN.rocket_tower_c},{alpha:!0,img:NaN.rocket_tower_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:20,bimg:NaN.build2x2,dimg:NaN.des_2x2,iconID:186,
icons:[],space:new Uint8Array([1,1,1,1,2]),url:NaN.rocket_tower,build:!0,cost:[0,600,0,0],standardFunc:null,size:1,arrow:!0,attimg:NaN.arrow_big1,time:60,sight:26},{radix:0,name:"Ork",race:"common",strID:"ork",dieSound:["orc%20die%201","orc%20die%202"],attackSound:orkSound,attack:18,defence:2,health:75,maxHealth:75,img:NaN.ork,invType:0,invMax:8,validator:null,zLevel:1,iconID:143,time:12,sight:5,url:NaN.ork,standardFunc:null,icons:null,cost:[60,0,0,0],attDist:1,spd:50,clss:"ork",size:1,nu:NaN.createOrk},
{radix:0,name:"Dwarf",race:"common",attack:7,defence:7,health:120,maxHealth:120,img:NaN.dwarf,invType:0,strID:"dwarf",invMax:8,zLevel:1,dieSound:normalDieSound,validator:null,iconID:185,time:12,sight:3,url:NaN.dwarf,standardFunc:null,icons:null,cost:[80,0,0,0],attDist:1,spd:50,clss:"dwarf",size:1,nu:NaN.createDwarf},{radix:0,name:"Skeleton",strID:"skeleton",race:"common",dieSound:["skeleton%20die%201","skeleton%20die%202","skeleton%20die%203","skeleton%20die%204"],attack:4,defence:0,health:40,maxHealth:40,
img:NaN.skeleton,invType:0,zLevel:1,attackSound:swordSound,invMax:8,nofreeze:1,validator:null,iconID:167,time:12,sight:3,url:NaN.skeleton,standardFunc:null,icons:null,cost:[0,0,30,0],attDist:1,spd:50,clss:"skeleton",size:1,nu:NaN.createSkeleton},{radix:0,name:"Caravan",race:"euro",strID:"e_caravan",attack:0,defence:0,health:350,maxHealth:350,img:NaN.caravan,invType:1,invMax:8,validator:null,iconID:34,zLevel:1,time:50,sight:7,url:NaN.caravan,icons:[NaN.move,NaN.trade,NaN.explore,NaN.stop,NaN.stand,
NaN.unload],cost:[0,200,400,0],attDist:1,spd:75,clss:"caravan",size:1,nu:NaN.createCaravan},{name:"Castle",health:8E3,maxHealth:8E3,img:NaN.asia_castle,invType:1,strID:"a_castle",zLevel:1,race:"asia",invMax:50,validator:null,bimg:NaN.build6x6,dimg:NaN.des_6x6,iconID:164,time:120,sight:12,dieSound:dieSoundBuild,clss:"castle",child:[{img:NaN.asia_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:NaN.asia_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[NaN.createPeon1,NaN.createNinja,NaN.emergeAllUnits,NaN.techFeudalism,
NaN.techArchitecture,NaN.techLearning,NaN.techBuddhism,NaN.techGreatWall],space:new Uint8Array([0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,0,0,8]),url:NaN.asia_castle,build:!0,cost:[0,1500,0,1500],storage:4,castle:!0,population:20,size:1},{name:"Castle",dieSound:dieSoundBuild,clss:"castle",strID:"r_castle",race:"arab",health:8E3,maxHealth:8E3,img:NaN.arab_castle,invType:1,invMax:50,validator:null,bimg:NaN.build6x6,dimg:NaN.des_6x6,
zLevel:1,iconID:97,time:120,sight:12,child:[{img:NaN.arab_castle_c}],icons:[NaN.createPeon2,NaN.createSpy,NaN.emergeAllUnits,NaN.techFeudalism,NaN.techArchitecture,NaN.techLearning,NaN.techSlavery],space:new Uint8Array([0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,0,0,0,1,0,0,0,,8]),url:NaN.arab_castle,build:!0,cost:[0,1500,0,1500],storage:4,castle:!0,population:20,size:1},{radix:0,name:"Peasant",attack:5,defence:0,health:50,maxHealth:50,
img:NaN.asian_peasant,invType:0,invMax:8,attackSound:handSound,race:"asia",validator:null,human:1,strID:"a_peon",iconID:132,dieSound:normalDieSound,zLevel:1,time:8,peon:1,sight:5,url:NaN.asian_peasant,icons:[NaN.move,NaN.menuBuilds1,NaN.repair,NaN.conquest,NaN.dcm,NaN.pickUp,NaN.explore,NaN.stop,NaN.stand,NaN.attack,NaN.sameSpeed,NaN.restoreSpeed],cost:[0,0,40,0],attDist:1,spd:50,clss:"peon",nocapture:1,size:1},{radix:0,name:"Ninja",race:"asia",attack:12,defence:5,mana:100,manaMax:100,health:90,maxHealth:90,
img:NaN.asian_ninja,invType:0,invMax:8,attackSound:swordSound,validator:null,human:1,iconID:133,strID:"ninja",dieSound:normalDieSound,zLevel:1,time:20,standardFunc:null,sight:10,url:NaN.asian_ninja,icons:[NaN.guard,NaN.patrol,NaN.pickUp,NaN.explore,NaN.stop,NaN.stand,NaN.invisibility,NaN.murder,NaN.move,NaN.attack,NaN.sameSpeed,NaN.restoreSpeed],cost:[120,0,0,0],attDist:1,spd:85,clss:"ninja",size:1,update:["mana","manaSpeed",gameParameters.manaRechargeTime]},{radix:0,name:"Ronin",attack:7,defence:0,
health:45,maxHealth:45,img:NaN.asian_ronin,invType:0,invMax:8,race:"asia",validator:null,human:1,standardFunc:null,iconID:141,strID:"ronin",dieSound:normalDieSound,zLevel:1,time:8,sight:5,url:NaN.asian_ronin,icons:null,cost:[0,0,40,0],attDist:1,spd:50,attackSound:swordSound,clss:"a_footman",size:1},{radix:0,name:"Archer",attack:5,defence:0,health:50,maxHealth:50,img:NaN.asian_archer,invType:0,invMax:8,race:"asia",validator:null,human:1,strID:"a_archer",dieSound:normalDieSound,zLevel:1,attimg:NaN.arrow1,
iconID:136,arrow:1,attackSound:archerSound,time:12,sight:10,url:NaN.asian_archer,icons:null,cost:[0,20,40,0],standardFunc:null,spd:50,clss:"archer",size:1,attDist:6},{radix:0,name:"Samurai",attack:10,defence:4,health:90,maxHealth:90,img:NaN.asian_samurai,invType:0,race:"asia",strID:"samurai",invMax:8,attackSound:swordSound,validator:null,human:1,iconID:142,time:20,standardFunc:null,zLevel:1,dieSound:normalDieSound,sight:6,url:NaN.asian_samurai,icons:null,cost:[50,0,150,0],attDist:1,spd:50,clss:"a_maceman",
size:1},{radix:0,name:"Horse Archer",attack:7,defence:0,health:75,maxHealth:75,img:NaN.asian_horsarcher,invType:0,race:"asia",invMax:8,validator:null,human:1,attackSound:archerSound,iconID:183,strID:"a_horse_archer",dieSound:hdieSound,time:20,standardFunc:null,sight:12,url:NaN.asian_horsarcher,zLevel:1,icons:null,arrow:1,attimg:NaN.arrow1,cost:[40,0,120,0],spd:85,clss:"horse_archer",size:1,attDist:7},{radix:0,name:"Horse Samurai",attack:14,defence:4,health:160,maxHealth:160,img:NaN.asian_horsamurai,
invType:0,invMax:8,validator:null,human:1,iconID:135,race:"asia",standardFunc:null,attackSound:hswordSound,time:22,zLevel:1,strID:"horse_samurai",dieSound:hdieSound,sight:5,url:NaN.asian_horsamurai,icons:null,cost:[75,0,120,0],attDist:1,spd:85,clss:"horse_samurai",size:1},{name:"Barracks",resistance:500,health:1400,maxHealth:1400,img:NaN.asia_barracks,invType:1,sound:barracksSound,invMax:0,time:60,dieSound:dieSoundBuild,radix:0,sight:6,race:"asia",strID:"a_barrack",validator:null,zLevel:1,bimg:NaN.build5x5,
dimg:NaN.des_5x5,child:[{img:NaN.asia_barracks_c,x:0,y:0,mv:!0},{img:NaN.asia_barracks_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:146,icons:[NaN.createRonin,NaN.createArcher1,NaN.createSamurai,NaN.createHorseArcher1,NaN.createHorseSamurai,NaN.createChariot],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:NaN.asia_barracks,build:!0,cost:[0,200,0,200],size:1,clss:"barracks"},{name:"Chariot",attack:4,defence:3,health:180,maxHealth:180,img:NaN.asian_charriot,invType:0,
radix:0,race:"asia",invMax:8,strID:"chariot",dieSound:["c%20die%201","c%20die%202","c%20die%203","c%20die%204","c%20die%205"],attackSound:hswordSound,validator:null,human:1,zLevel:1,iconID:175,standardFunc:null,time:8,sight:5,url:NaN.asian_charriot,icons:null,cost:[0,200,150,0],attDist:1,spd:85,clss:"chariot",size:1},{radix:1,name:"Galleon",attackSound:shipSound,attack:35,attDist:12,race:"common",defence:0,health:1200,attackTime:2E3,maxHealth:1200,strID:"galleon",nu:NaN.createGalleon,img:NaN.galleon,
invType:1,invMax:24,dieSound:["ship%20sink"],zLevel:0,validator:null,iconID:32,time:50,boat:!0,attimg:NaN.cb_metal,attackDeg:20,sight:16,url:NaN.galleon,icons:[NaN.move,NaN.explore,NaN.unload,NaN.attack,NaN.attackGround,NaN.stop,NaN.stand,NaN.stop,NaN.stand,NaN.attack,NaN.steady,NaN.upgradeShip],cost:[0,1200,800,0],spd:50,nofreeze:1,clss:"galleon",standardFunc:null,size:1,peon:1},{radix:1,name:"Fishing Boat",attackSound:shipSound,attack:0,attDist:8,race:"common",defence:0,health:50,boat:!0,nu:NaN.createFishingBoat,
maxHealth:50,img:NaN.boat,invType:1,invMax:0,strID:"fishing_boat",dieSound:["ship%20sink"],zLevel:0,validator:null,iconID:184,nofreeze:1,time:50,sight:16,url:NaN.boat,icons:[NaN.move,NaN.explore,NaN.stop,NaN.stand,NaN.fishing],cost:[0,200,100,0],spd:65,clss:"fishing_boat",size:1},{radix:1,name:"Hulk",attackSound:shipSound,attack:18,attDist:10,race:"common",defence:0,health:700,maxHealth:700,strID:"hulk",img:NaN.hulk,invType:1,attackTime:2E3,boat:!0,nu:NaN.createHulk,attackDeg:20,invMax:16,dieSound:["ship%20sink"],
zLevel:0,validator:null,iconID:128,time:30,sight:14,attimg:NaN.cb_metal,url:NaN.hulk,icons:[NaN.move,NaN.explore,NaN.unload,NaN.attack,NaN.attackGround,NaN.stop,NaN.stand,NaN.stop,NaN.stand,NaN.attack,NaN.steady,NaN.upgradeShip],cost:[0,500,300,0],spd:65,nofreeze:1,clss:"hulk",standardFunc:null,size:1},{radix:1,name:"Pinque",attackSound:archerSound,attack:10,race:"common",attDist:8,defence:0,health:300,boat:!0,maxHealth:300,img:NaN.xebec,attimg:NaN.arrow1,arrow:!0,strID:"pinque",invType:1,invMax:8,
dieSound:["ship%20sink"],zLevel:0,validator:null,iconID:129,time:20,nofreeze:1,sight:12,url:NaN.xebec,icons:[NaN.move,NaN.explore,NaN.unload,NaN.attack,NaN.attackGround,NaN.stop,NaN.stand,NaN.stop,NaN.stand,NaN.attack,NaN.steady,NaN.upgradeShip],cost:[0,300,200,0],spd:80,clss:"xebec",size:1,standardFunc:null,nu:NaN.createXebec},{radix:0,name:"Stone Golem",strID:"troll",defence:3,attack:25,health:400,maxHealth:400,img:NaN.troll,invType:0,invMax:0,dieSound:["golem"],validator:null,iconID:144,race:"common",
zLevel:1,nofreeze:1,attackSound:["golem1","golem2"],sight:10,standardFunc:null,url:NaN.troll,icons:null,w:1,cost:[120,0,0,0,600],attDist:1,spd:56,clss:"troll",size:1},{radix:0,name:"Bat",strID:"bat",defence:0,attack:3,health:20,maxHealth:20,img:NaN.bat,invType:0,invMax:0,race:"common",bat:1,dieSound:["bat%20die"],validator:null,iconID:105,zLevel:2,attackSound:["bat%20attack"],sight:10,standardFunc:null,url:NaN.bat,icons:null,w:1,cost:[0,0,0,0,25],attDist:1,spd:128,clss:"bat",size:1,z32:1.5},{race:"arab",
invType:0,invMax:8,iconID:138,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:NaN.arab_peasant,img:NaN.arab_peasant,spd:50,validator:null,human:1,icons:[NaN.move,NaN.menuBuilds2,NaN.repair,NaN.conquest,NaN.dcm,NaN.pickUp,NaN.explore,NaN.stop,NaN.stand,NaN.attack,NaN.convertJihad,NaN.bribe,NaN.sameSpeed,NaN.restoreSpeed],name:"Peasant",clss:"peon",cost:[0,0,50,0],attDist:1,time:8,nocapture:1,peon:1,sight:5,health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:172,zLevel:1,dieSound:[],
attackSound:[],size:1,radix:0,url:NaN.arab_footman,img:NaN.arab_footman,standardFunc:null,spd:50,validator:null,human:1,attDist:1,icons:null,name:"Footman",clss:"footman",cost:[0,0,50,0],time:12,sight:5,health:50,attack:6,defence:1},{race:"arab",invType:0,invMax:8,iconID:170,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:NaN.arab_archer,img:NaN.arab_archer,spd:50,validator:null,standardFunc:null,human:1,attimg:NaN.arrow1,arrow:1,icons:null,name:"Archer",clss:"archer",cost:[0,20,40,0],time:12,
sight:10,attDist:6,health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:173,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:NaN.arab_spearman,img:NaN.arab_spearman,spd:50,validator:null,standardFunc:null,human:1,icons:null,name:"Spearman",clss:"pikeman",attDist:1,cost:[40,0,60,0],time:14,sight:5,health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:174,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,standardFunc:null,url:NaN.arab_satrap,img:NaN.arab_satrap,
spd:50,validator:null,human:1,icons:null,name:"Satrap",attDist:1,clss:"maceman",cost:[0,0,120,0],time:14,sight:5,health:120,attack:8,defence:0},{race:"arab",invType:0,invMax:8,iconID:171,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:NaN.arab_cavalry,standardFunc:null,img:NaN.arab_cavalry,spd:85,validator:null,human:1,attDist:1,icons:null,name:"Cavalry",clss:"heavy_cavalry",cost:[60,0,100,0],time:14,sight:5,health:90,attack:10,defence:4},{race:"arab",invType:0,invMax:8,iconID:168,zLevel:1,
dieSound:[],attackSound:[],size:1,radix:0,url:NaN.arab_horse_archer,img:NaN.arab_horse_archer,spd:85,validator:null,human:1,standardFunc:null,icons:null,name:"Horse Archer",clss:"horse_archer",cost:[50,0,100,0],time:14,attimg:NaN.arrow1,arrow:1,sight:12,attDist:7,health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:179,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:NaN.arab_jwarrior,img:NaN.arab_jwarrior,spd:50,validator:null,human:1,standardFunc:null,icons:null,name:"Jihad warrior",
attDist:1,clss:"jihad_warrior",cost:[0,0,100,0],time:8,sight:5,health:75,attack:10,defence:2},{race:"arab",invType:0,invMax:8,iconID:176,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:NaN.arab_priest,img:NaN.arab_priest,standardFunc:null,spd:50,mana:100,validator:null,human:1,icons:null,name:"Priest",clss:"priest",cost:[150,0,0,0],time:30,sight:21,attDist:18,health:60,attack:20,update:["mana","manaSpeed",gameParameters.manaRechargeTime],manaMax:100,defence:0,attimg:NaN.flame_bolt,ball:1,attackOnly:NaN.magic_creatures},
{race:"arab",invType:0,invMax:0,iconID:105,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:0,img:0,testing:1,illegal:1,spd:50,validator:null,human:1,icons:[],name:"Spy",clss:"spy",cost:150,time:30,sight:12,health:50,attack:20,defence:0},{race:"arab",invType:0,invMax:8,iconID:188,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,attimg:NaN.flame_bolt,url:NaN.arab_mage,img:NaN.arab_mage,spd:50,validator:null,human:1,icons:[NaN.stop,NaN.pickUp,NaN.explore,NaN.createCarpet,NaN.createJinn,NaN.fireRain,
NaN.magicVision,NaN.raiseDead,NaN.attack,NaN.stand,NaN.move],standardFunc:null,name:"Mage",clss:"mage",ball:1,mana:100,manaMax:100,update:["mana","manaSpeed",gameParameters.manaRechargeTime],cost:[150,0,0,0],time:30,sight:15,attDist:10,health:60,attack:8,defence:0},{race:"arab",invType:1,invMax:8,iconID:126,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:NaN.arab_caravan,img:NaN.arab_caravan,spd:75,validator:null,human:1,icons:[],name:"Caravan",clss:"trader",cost:[0,0,500,0],time:30,sight:5,
health:150},{race:"arab",invType:0,invMax:8,iconID:177,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:NaN.arab_enichar,img:NaN.arab_enichar,spd:85,validator:null,human:1,standardFunc:null,icons:null,name:"Enichar",attDist:1,clss:"enichar",cost:[80,0,120,0],time:25,sight:5,health:130,attack:18,defence:4},{race:"arab",invType:1,invMax:0,iconID:82,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:NaN.build3x3,dimg:NaN.des_3x3,radix:0,population:10,url:NaN.arab_houses,
validator:null,build:1,icons:[],child:[{img:NaN.arab_houses_c}],name:"House",clss:"house",cost:[0,75,0,0],time:20,sight:4,resistance:50,health:500},{race:"arab",invType:1,invMax:0,iconID:85,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:NaN.build3x3,dimg:NaN.des_3x3,radix:0,url:NaN.arab_lumbermill,validator:null,build:1,icons:[NaN.techWoodCutting,NaN.techCrossbow],child:[{img:NaN.arab_lumbermill_c}],name:"Lumber Mill",clss:"lumber",cost:[0,100,0,0],storage:1,time:30,
sight:4,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:96,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,url:NaN.arab_storage,validator:null,build:1,storage:0,icons:[NaN.techGoldMining,NaN.techStoneMining],child:[{img:NaN.arab_storage_c},{alpha:!0,img:NaN.arab_storage_s,rgb:[0,0,0,.5]}],name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,
invMax:0,iconID:80,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,url:NaN.arab_farm,validator:null,build:1,icons:[NaN.createCow,NaN.techCropRotation,NaN.techDomestication,NaN.techCowPoaching,NaN.ridingHorses,NaN.techHorseManShip],child:[{img:NaN.arab_farm_c}],name:"Farm",storage:2,clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:81,zLevel:1,dieSound:dieSoundBuild,
validator:null,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:NaN.build_harbor,dimg:NaN.des_harbor,radix:0,url:NaN.arab_harbour,build:1,icons:[NaN.createFishingBoat,NaN.createXebec,NaN.createHulk,NaN.techLandingTactics],child:[{img:NaN.arab_harbour_c},{alpha:!0,img:NaN.arab_harbour_s,rgb:[0,0,0,.5]}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,iconID:79,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,
1,1,1,1,1,1,1,3]),bimg:NaN.build3x3,dimg:NaN.des_3x3,radix:0,url:NaN.arab_blacksmith,validator:null,build:1,icons:[NaN.techTemperIron,NaN.techScaleArmor,NaN.techScimitar,NaN.techChainMail,NaN.techHalberd],child:[{img:NaN.arab_blacksmith_c},{alpha:!0,img:NaN.arab_blacksmith_s,rgb:[0,0,0,.5]}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,150,0],onbuild:null,time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:95,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,url:NaN.arab_workshop,validator:null,build:1,icons:[NaN.createCatapult,NaN.createBallist,NaN.techEngineering,NaN.techCannonTower],child:[{img:NaN.arab_workshop_c},{alpha:!0,img:NaN.arab_workshop_s,rgb:[0,0,0,.5]}],name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:140,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),
bimg:NaN.build3x3,dimg:NaN.des_3x3,radix:0,url:NaN.arab_church,validator:null,build:1,icons:[NaN.createPriest2],child:[{img:NaN.arab_church_c},{alpha:!0,img:NaN.arab_church_s,rgb:[0,0,0,.5]}],name:"Church",clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"arab",invType:1,invMax:0,iconID:92,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,url:NaN.arab_tavern,validator:null,build:1,icons:[NaN.createMercenaries,
NaN.createHeroes],child:[{img:NaN.arab_tavern_c}],name:"Tavern",clss:"tavern",cost:[0,200,200,0],onbuild:null,actvintv:[NaN.iniMercenaries,NaN.iniHeroes],time:40,sight:5,resistance:150,health:1E3},{race:"arab",invType:1,invMax:0,iconID:87,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,url:NaN.arab_market,validator:null,build:1,icons:[NaN.createCaravan2],child:[{img:NaN.arab_market_c}],name:"Market",clss:"market",
cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,iconID:98,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:NaN.build5x5,dimg:NaN.des_5x5,radix:0,url:NaN.arab_barracks,validator:null,build:1,icons:[NaN.createFootman2,NaN.createArcher2,NaN.createSatrap,NaN.createPikeman2,NaN.createHorseArcher2,NaN.createCavalry,NaN.createEnichar,NaN.createJihad],child:[{img:NaN.arab_barracks_c},{alpha:!0,img:NaN.arab_barracks_s,
rgb:[0,0,0,.5]}],name:"Barracks",clss:"barrack",cost:[0,0,200,200],time:60,sight:6,resistance:500,health:1400},{race:"arab",invType:1,invMax:0,iconID:91,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,url:NaN.arab_stables,validator:null,build:1,icons:[],child:[{img:NaN.arab_stables_c}],name:"Stable",clss:"stable",cost:[0,200,200,0],time:40,onbuild:null,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:50,
iconID:89,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,url:NaN.arab_outpost,validator:null,build:1,icons:[NaN.emergeAllUnits],child:[{img:NaN.arab_outpost_c,mv:1},{alpha:!0,img:NaN.arab_outpost_s,rgb:[0,0,0,.5]}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},{race:"arab",invType:1,invMax:0,iconID:105,zLevel:1,dieSound:dieSoundBuild,bimg:NaN.build3x3,dimg:NaN.des_3x3,
radix:0,url:0,img:0,validator:null,build:1,icons:[],child:[{img:3213123}],name:"NULL",testing:1,clss:"castle",cost:[0,1500,0,1500],time:120,sight:12,resistance:1E3,health:8E3},{race:"arab",invType:1,invMax:0,iconID:88,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([0,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,0,6]),bimg:NaN.build5x5,dimg:NaN.des_5x5,radix:0,url:NaN.arab_mosque,validator:null,build:1,icons:[NaN.techFanaticism,NaN.techEspionage,NaN.techHealing,NaN.techBless,
NaN.techJihad],child:[{img:NaN.arab_mosque_c},{alpha:!0,img:NaN.arab_mosque_s,rgb:[0,0,0,.5]}],name:"Mosque",onbuild:[NaN.buildChurch2],clss:"mosque",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:86,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,url:NaN.arab_magetower,validator:null,build:1,icons:[NaN.createMage2,NaN.techCarpet,NaN.techMagicWorkshop,NaN.techFireRain,
NaN.techMagicVision,NaN.techNecromancy,NaN.techJinn],child:[{img:NaN.arab_magetower_c},{alpha:!0,img:NaN.arab_magetower_s,rgb:[0,0,0,.5]}],name:"Mage Guild",clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:93,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,5]),bimg:NaN.build5x5,dimg:NaN.des_5x5,radix:0,url:NaN.arab_tc_guild,validator:null,build:1,icons:[NaN.techUsury,NaN.techTradeRoutes,
NaN.techSupplyStorage,NaN.techBribery,NaN.techOreFloatation],child:[{img:NaN.arab_tcguild_c},{alpha:!0,img:NaN.arab_tc_guild_s,rgb:[0,0,0,.5]}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,0,2E3],time:90,onbuild:[NaN.buildMarket2],sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:94,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:NaN.build5x5,dimg:NaN.des_5x5,radix:0,url:NaN.arab_waracademy,validator:null,
build:1,icons:[NaN.techHeroism,NaN.techWarfare,NaN.techMercenaries,NaN.techRiddingHorses,NaN.techBodyBuilding,NaN.techLeadership,NaN.techHeroes,NaN.techJanissary,NaN.techHonor,NaN.techFame],child:[{img:NaN.arab_waracademy_c},{alpha:!0,img:NaN.arab_waracademy_s,rgb:[0,0,0,.5]}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:158,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:NaN.build3x3,
dimg:NaN.des_3x3,radix:0,url:NaN.arab_magicworkshop,validator:null,build:1,icons:[NaN.createObjects],child:[{img:NaN.arab_magicworkshop_c},{alpha:!0,img:NaN.arab_magicworkshop_s,rgb:[0,0,0,.5]}],name:"Magic Workshop",disallowPoint:!0,clss:"magicworkshop",cost:[0,0,0,300],time:20,sight:5,resistance:200,health:1200},{race:"asia",invType:1,invMax:0,iconID:161,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,0,1,3]),bimg:NaN.build3x3,dimg:NaN.des_3x3,radix:0,url:NaN.asia_houses,validator:null,
build:1,icons:[],child:[{img:NaN.asia_houses_c}],name:"House",clss:"house",cost:[0,75,0,0],population:10,time:20,sight:4,resistance:50,health:500},{race:"asia",invType:1,invMax:0,iconID:149,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([0,1,1,1,1,1,1,1,1,3]),bimg:NaN.build3x3,dimg:NaN.des_3x3,radix:0,storage:1,url:NaN.asia_lumbermill,validator:null,build:1,icons:[NaN.techWoodCutting,NaN.techCrossbow],child:[{img:NaN.asia_lumbermill_c},{img:NaN.asia_lumbermill_s,rgb:[0,0,0,.5],alpha:!0}],name:"Lumber Mill",
clss:"lumber",cost:[0,100,0,0],time:30,sight:4,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:154,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,url:NaN.asia_storage,storage:0,validator:null,build:1,icons:[NaN.techGoldMining,NaN.techStoneMining],child:[{img:NaN.asia_storage_s,rgb:[0,0,0,.5],alpha:!0},{img:NaN.asia_storage_c}],name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,sight:5,resistance:80,
health:800},{race:"asia",invType:1,invMax:0,iconID:147,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,storage:2,url:NaN.asia_farm,validator:null,build:1,icons:[NaN.techCropRotation,NaN.ridingHorses,NaN.irrigation],child:[{img:NaN.asia_farm_c}],name:"Farm",clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:148,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([0,
1,1,1,1,1,1,1,1,3]),validator:null,bimg:NaN.build_harbor,dimg:NaN.des_harbor,radix:0,url:NaN.asia_harbor,build:1,icons:[NaN.createFishingBoat,NaN.createXebec,NaN.createHulk,NaN.techLandingTactics],child:[{img:NaN.asia_harbor_c},{img:NaN.asia_harbor_s,rgb:[0,0,0,.5],alpha:!0}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:145,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,0,1,1,1,0,5]),bimg:NaN.build5x5,dimg:NaN.des_5x5,radix:0,url:NaN.asia_blacksmith,validator:null,build:1,icons:[NaN.techTemperIron,NaN.techScaleArmor,NaN.techArmoredChariot,NaN.techChainMail],child:[{img:NaN.asia_blacksmith_c},{img:NaN.asia_blacksmith_s,rgb:[0,0,0,.5],alpha:!0}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,150,0],time:40,sight:5,onbuild:null,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:157,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,url:NaN.asia_workshop,validator:null,build:1,icons:[NaN.createCatapult,NaN.createBallist,NaN.techEngineering,NaN.techCannonTower],child:[{img:NaN.asia_workshop_c,x:0,y:0},{img:NaN.asia_workshop_s,rgb:[0,0,0,.5],alpha:!0}],name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:162,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([0,1,1,0,0,0,1,1,1,0,1,
1,1,1,1,0,1,1,1,1,0,0,1,1,0,5]),bimg:NaN.build5x5,dimg:NaN.des_5x5,radix:0,url:NaN.asian_monastery,validator:null,build:1,icons:[NaN.createMonk,NaN.createPriest1],child:[{img:NaN.asian_monastery_c},{img:NaN.asian_monastery_s,rgb:[0,0,0,.5],alpha:!0}],name:"Monastery",clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"asia",invType:1,invMax:0,iconID:155,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,
radix:0,url:NaN.asia_tavern,validator:null,build:1,icons:[NaN.createMercenaries,NaN.createHeroes],child:[{img:NaN.asia_tavern_c},{img:NaN.asia_tavern_s,rgb:[0,0,0,.5],alpha:!0}],onbuild:null,name:"Tavern",clss:"tavern",actvintv:[NaN.iniMercenaries,NaN.iniHeroes],cost:[0,200,200,0],time:40,sight:5,resistance:150,health:1E3},{race:"asia",invType:1,invMax:0,iconID:150,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,
url:NaN.asia_market,validator:null,build:1,icons:[],child:[{img:NaN.asia_market_c}],name:"Market",clss:"market",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:153,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:NaN.build4x4,dimg:NaN.des_4x4,radix:0,url:NaN.asia_stables,validator:null,build:1,icons:[],child:[{img:NaN.asia_stables_c,mv:!0},{img:NaN.asia_stables_s,rgb:[0,0,0,.5],alpha:!0}],name:"Stable",
clss:"stable",onbuild:null,cost:[0,200,200,0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:151,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:NaN.build3x3,dimg:NaN.des_3x3,radix:0,url:NaN.asia_outpost,validator:null,build:1,icons:[NaN.emergeAllUnits],child:[{img:NaN.asia_outpost_c,mv:1},{img:NaN.asia_outpost_s,rgb:[0,0,0,.5],alpha:!0}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},{race:"asia",
invType:1,invMax:0,iconID:163,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([0,0,1,1,0,0,0,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,0,6]),bimg:NaN.build6x6,dimg:NaN.des_6x6,radix:0,url:NaN.asia_shao_lin,validator:null,build:1,icons:[NaN.techMeditation,NaN.techKungFu,NaN.techHealing,NaN.techPhilosophy,NaN.techNinjas,NaN.techMastery,NaN.techTournaments,NaN.techMedicine],child:[{img:NaN.asia_shao_lin_c},{img:NaN.asia_shao_lin_s,rgb:[0,0,0,.5],alpha:!0}],name:"Shao Linn",onbuild:[NaN.buildChurch1],
clss:"shaolinn",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:152,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:NaN.build5x5,dimg:NaN.des_5x5,radix:0,url:NaN.asia_wizardguild,validator:null,build:1,icons:[NaN.createMage1,NaN.techConcentration,NaN.techWhirlpool,NaN.techFlameBolt,NaN.techTurnToStone,NaN.techConfusion,NaN.techDragon],child:[{img:NaN.asia_wizardguild_c},{img:NaN.asia_wizardguild_s,
rgb:[0,0,0,.5],alpha:!0}],name:"Mage Guild",clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:159,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:NaN.build5x5,dimg:NaN.des_5x5,radix:0,url:NaN.asia_tcguild,validator:null,build:1,icons:[NaN.techTradeRoutes,NaN.techUsury,NaN.techJewelry,NaN.techSupplyStorage,NaN.techBanking,NaN.techChemistry,NaN.techSeaFood,NaN.techGunPowder,
NaN.techRocketArrow],child:[{img:NaN.asia_tcguild_c,mv:!0},{img:NaN.asia_tcguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,0,2E3],time:90,onbuild:[NaN.buildMarket1],sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:156,zLevel:1,dieSound:dieSoundBuild,space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:NaN.build5x5,dimg:NaN.des_5x5,radix:0,url:NaN.asia_warguild,validator:null,build:1,icons:[NaN.techBushido,NaN.techHeroism,
NaN.techWarfare,NaN.techMercenaries,NaN.techLeadership,NaN.techTactics,NaN.techHeroes,NaN.techHonor,NaN.techSunTzu],child:[{img:NaN.asia_warguild_c,mv:!0},{img:NaN.asia_warguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:0,invMax:0,iconID:166,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:NaN.asian_priest,img:NaN.asian_priest,spd:50,validator:null,human:1,icons:[NaN.attack,NaN.stop,NaN.stand,
NaN.pickUp,NaN.explore,NaN.healing,NaN.teach,NaN.move],name:"Priest",clss:"priest",cost:[170,0,0,0],time:30,sight:21,health:120,standardFunc:null,attDist:1,attack:10,defence:10,mana:100,update:["mana","manaSpeed",gameParameters.manaRechargeTime],manaMax:100},{race:"asia",invType:0,invMax:0,iconID:187,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:NaN.asian_monk,img:NaN.asian_monk,spd:50,validator:null,human:1,icons:null,name:"Monk",standardFunc:null,clss:"monk",cost:[0,0,200,0],time:20,sight:5,
health:90,attack:6,defence:6,attDist:1},{race:"asia",invType:0,invMax:0,iconID:134,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:NaN.asian_mage,img:NaN.asian_mage,spd:50,attimg:NaN.flame_bolt,validator:null,standardFunc:null,human:1,icons:[NaN.stop,NaN.pickUp,NaN.explore,NaN.confusion,NaN.turnToStone,NaN.whirlpool,NaN.flameBolt,NaN.createDragon,NaN.attack,NaN.stand,NaN.move],name:"Mage",clss:"mage",cost:[150,0,0,0],ball:1,time:30,sight:15,mana:100,attDist:10,health:60,attack:8,defence:0,
update:["mana","manaSpeed",gameParameters.manaRechargeTime],manaMax:100},{radix:0,name:"Dragon",strID:"dragon",defence:0,attack:25,health:300,maxHealth:300,img:NaN.dragon,invType:0,invMax:0,dieSound:[],sSizex:2,sSizey:2,dragon:1,iconID:160,race:"common",zLevel:2,nofreeze:1,attackSound:[],sight:12,standardFunc:null,url:NaN.dragon,icons:null,cost:[80,0,0,0,800],attDist:2,spd:128,clss:"drg",size:1,z32:1.5,validator:null},{radix:0,name:"Carpet",strID:"carpet",defence:0,attack:0,health:90,maxHealth:90,
img:NaN.carpet,invType:1,invMax:8,dieSound:[],iconID:131,race:"common",zLevel:2,nofreeze:1,attackSound:[],sight:8,url:NaN.carpet,icons:[NaN.move,NaN.unload,NaN.explore,NaN.stop,NaN.stand],cost:[80,0,0,0,500],attDist:2,spd:120,clss:"carpet",size:1,z32:1.5,validator:null},{radix:0,name:"Jinn",strID:"jinn",defence:5,attack:20,health:300,maxHealth:300,img:NaN.arab_jinn,invType:0,invMax:0,dieSound:[],validator:null,iconID:182,race:"common",zLevel:1,nofreeze:1,attackSound:[],sight:8,standardFunc:null,url:NaN.arab_jinn,
icons:null,w:1,cost:[80,0,0,0,300],attDist:1,spd:85,clss:"jinn",size:1}];Game.editor?(hdiv("statButton"),hdiv("menu"),hdiv("resources"),sdiv("mapeditorinfotop"),sdiv("mapeditorinfo"),gid("mapeditorinfoUnits").style.display="block"):(sdiv("menu"),sdiv("statButton"),sdiv("resources"),hdiv("mapeditorinfo"),hdiv("mapeditorinfotop"));commonStart()},bufferPos=function(){gl.bindBuffer(gl.ARRAY_BUFFER,positionBuffer);gl.bufferSubData(gl.ARRAY_BUFFER,12*sharedFloat[4],sharedFloat3)},bufferPhysics=function(){gl.bindBuffer(gl.ARRAY_BUFFER,
physicsbuffer);gl.bufferSubData(gl.ARRAY_BUFFER,16*sharedFloat[4],sharedFloat4)},bufferIMG=function(){gl.bindBuffer(gl.ARRAY_BUFFER,texCoordBuffer);gl.bufferSubData(gl.ARRAY_BUFFER,12*sharedFloat[4],sharedFloat3)},bufferMargin=function(){gl.bindBuffer(gl.ARRAY_BUFFER,marginsbuffer);gl.bufferSubData(gl.ARRAY_BUFFER,12*sharedFloat[4],sharedFloat3)},sresizeBuffer=function(d){ms(d);resizeBuffer(texCoordBuffer,d);resizeBuffer(positionBuffer,d);resizeBuffer(physicsbuffer,d);resizeBuffer(marginsbuffer,d)},
races=["European","Arab","Asian"],pool=function(d,a,c){c&&(d=d.replace("%d",c));return d.replace("%s",a)};nehbugger&&translate(me.lang);translate.translated=!0;var starfunc,mines,bits,kingdomsCopy,setupMap,loadTime={},SetupGameConfig=function(d){Game.infinity=void 0;if(gid("mapconfiguration")&&""!==gid("mapconfiguration").innerHTML){d="mapx mapwidth goldRes goldValue woodRes woodValue foodRes foodValue stoneRes stoneValue infinity infiniteValue water waterValue terrainType terrainSelect peons peonValue freePop freePopValue".split(" ");for(var a=0,c=d.length;a<c;a+=2){var b=gid(d[a+1]).value;"infinity"===d[a]?(b=gid(d[a+1]).checked,Game[d[a]]=b):parseInt(b)?
Game[d[a]]=parseInt(b):Game[d[a]]=b;localStorage[d[a]]=b}}else"true"===localStorage.infinity&&(Game.infinity=!0),Game.goldRes=parseInt(localStorage.goldRes),Game.foodRes=parseInt(localStorage.foodRes),Game.woodRes=parseInt(localStorage.woodRes),Game.stoneRes=parseInt(localStorage.stoneRes),Game.mapx=parseInt(localStorage.mapx),Game.water=parseInt(localStorage.water),Game.terrainType=localStorage.terrainType,Game.items=parseInt(localStorage.items),Game.peons=parseInt(localStorage.peons),Game.gateways=
parseInt(localStorage.gateways),Game.freePop=parseInt(localStorage.freePop);Game.daylength=2880;Game.initialhour=12;Game.infinity&&(Game.goldRes=Math.pow(2,31)-1,Game.foodRes=Math.pow(2,31)-1,Game.woodRes=Math.pow(2,31)-1,Game.stoneRes=Math.pow(2,31)-1);Game.mapy=Game.mapx;Game.gravity=580.9/9.8*9.8;Game.name="";Game.arje=~~(555555*Math.random()+1);WASM.setupGame(Game.peons,Game.freePop,Game.goldRes,Game.woodRes,Game.foodRes,Game.stoneRes,Game.water,terrainSelect[Game.terrainType].id,Game.items,Game.gateways,
Game.mapx,Game.arje);return Game},commonStart=function(){chatul2.innerHTML="";hdiv("notifybottom");gid("loadingtext").innerHTML=msg.MSG_GAME_LOAD;me.kingdom||(me.kingdom=1);Game.online&&(navigatorNotify(msg.MSG_GAME_CREATE),Game.editor=0);ms(WASM.mapWidth(),"width");WASM.mapWidth()?(Game.mapx=WASM.mapWidth(),Game.mapy=Game.mapx):SetupGameConfig();Game.pausedTime=0;Game.canceled=0;loadTime={full:performance.now()};chatul=gid("msgs1");Game.online||(location.hash="");hdiv("playermenu");hdiv("index");
SetupGame();Game.online||deletehash();Game.now=timeFuncNoPause;Game.paused=0;Game.pausedTime=0;Game.zMax=96*Game.mapy;pause();performance.now();Game.allow14=!0;mapx=Game.mapx;mapy=Game.mapy;Game.temperature=25;temperatureUpdate();zoomValor=1;gid("loadingtext").innerHTML="Loading terrain";ms("arje",Game.arje);WASM.preldd()?(setupMap=wasmi8Array(WASM.trradd()),ms(setupMap)):(WASM.configRandomMap(),setupMap=wasmi8Array(WASM.randomTerrain(mapx),mapx*mapy));sdiv("content");gid("loadingtext").innerHTML=
"Loading textures";setupGL();WASM.preldd()||WASM.randomMap();ms(screenX,screenY);startGameStep0.check()},startGameStep0=function(){hideElements(["loading","playermenu","index"]);gid("playersinfo").innerHTML="";menuDefect();startpoint();eventListeners();loadTime.full=performance.now()-loadTime.full;ms("FULL: ",loadTime.full);trChanged=!1;Game.online?WASM.plready():startMovement();Game.allow14=!1};startGameStep0.check=function(){startGameStep0.load++;startGameStep0.load===startGameStep0.target&&startGameStep0()};
startGameStep0.target=2;var temperatureUpdate=function(){var d=Game.temperature;0===me.temperature&&(d+="&deg;C");gid("temperature").innerHTML=d},waitList=function(){for(var d=peer.length,a=peer,c="",b=0;b<d;b++){var e=a[b];waitList.obj[e.id]||e.id===me.onlineID||(c+="<br>"+e.nhinfo.name)}return c};waitList.obj={};
var werrorbGL=function(){return me.gl?!1:(spAlert("You can't run WEBGL 2<br>More info <a href='http://webglreport.com/?v=2'>here</a>","Error"),returnMenu(),!0)},autofullscreen=function(){var d=document.documentElement;d.requestFullscreen?d.requestFullscreen():d.msRequestFullscreen?d.msRequestFullscreen():d.mozRequestFullScreen?d.mozRequestFullScreen():d.webkitRequestFullscreen&&d.webkitRequestFullscreen()},bodyPut=function(d){var a=document.createElement("div");a.id=d;document.body.appendChild(a)},
trChanged=!1,startGame=function(d){werrorbGL()||(setupMenuHTML(),iniSound(),nehbugger||(window.onbeforeunload=function(){return"Are you sure you want to quit?"}),startGameStep0.load=0,d&&"true"==localStorage.fullscreen&&autofullscreen(),Game.editor?(me.marx=0,me.mary=60,me.menumy=60,mmH=mmW=171,me.mx=171,me.menumx=171):(me.mx=151,mmH=mmW=128,me.menumx=151,me.menumy=0,me.marx=4,me.mary=31),minimap.style.width=mmW+"px",minimap.style.height=mmH+"px",minimap.style.left=me.marx+"px",minimap.style.top=
me.mary+"px",bodyPut("loading"),""==gid("loading").innerHTML&&(gid("loading").innerHTML='<p id="loadingtext"></p>\n<div>\n<div id=\'logo\' class="svgnehhon"></div>\n<span id="netral">NEHHON NETRAL-H ENGINE</span>\n</div>'),WASM.mapWidth()||SetupGameConfig(),loadCDN(),trChanged=!0)},setupPlayerInfo=function(d,a,c,b,e){gid("playersinfo").innerHTML+=str16(wasmu16Array(d,17))+"<span>"+a+"</span><div class='playercolor' style='background:rgb("+c+","+b+","+e+")'></div><span class='ping'></span><br>"};
function hideElements(d){for(var a=d.length,c=0;c<a;gid(d[c++]).style.display="none");}
var startpoint=function(){var d=window.innerWidth-me.mx,a=window.innerHeight,c=WASM.empXY(),b=c%mapx,e=~~(c/mapx);c?(d=32*b-.5*d,a=32*e-.5*a):a=d=0;minimapLimiter(~~d,~~a)},setupIcon,setupIconMultiple,setupIconNone,iconsGL=function(){var d=gid("selectedobject").getContext("webgl",{antialias:!1,depth:!1}),a=d.createShader(d.VERTEX_SHADER);d.shaderSource(a,"void main() {\ngl_Position = vec4(0 ,0, 0, 1);\ngl_PointSize=48.0;\n}");d.compileShader(a);var c=d.createShader(d.FRAGMENT_SHADER);d.shaderSource(c,
"precision mediump float;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nuniform float txtCoord;\nvoid main() {\ngl_FragColor = texture2D(u_image, (vec2(\tmod(txtCoord,21.0) ,floor(txtCoord/21.0) ) + gl_PointCoord)*(0.046875));\nif(gl_FragColor.r==gl_FragColor.g&&gl_FragColor.r==gl_FragColor.b) gl_FragColor*=u_color;\n}");d.compileShader(c);var b=d.createProgram();d.attachShader(b,a);d.attachShader(b,c);d.linkProgram(b);d.useProgram(b);a=d.createTexture();d.bindTexture(d.TEXTURE_2D,a);d.texParameteri(d.TEXTURE_2D,
d.TEXTURE_WRAP_S,d.REPEAT);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST);d.texImage2D(d.TEXTURE_2D,0,d.RGB,d.RGB,d.UNSIGNED_BYTE,actionMenu.icons);var e=d.getUniformLocation(b,"u_color"),f=d.getUniformLocation(b,"txtCoord");setupIcon=function(a){d.uniform4f(e,1,1,1,1);d.uniform1f(f,a);d.drawArrays(d.POINTS,0,1)};setupIconMultiple=function(){d.uniform4f(e,1,1,1,1);d.uniform1f(f,
189);d.drawArrays(d.POINTS,0,1)};setupIconNone=function(){d.uniform1f(f,0);d.uniform4f(e,0,0,0,0);d.drawArrays(d.POINTS,0,1)}},mmW=128,mmH=128,minimapTXT,setupRect,popInfo=function(d,a){gid("pop").innerHTML=d+"/"+a};var myGame,deletePeer,closeGame,gameIDS,peer=[],error=function(d){},commonErrorLoading=function(){filter0();hdiv("game");returnMenu();addNotify(msg.ERR_GAMELOAD,"#ff0000")},roomFull=function(){returnMenu();addNotify(msg.ERR_GAMEFULL,"#ff0000")};window.addEventListener("offline",function(d){addNotify("Offline","#ff0000")});window.addEventListener("online",function(d){addNotify("Online","#00ff00")});
error.json={880:function(){returnMenu();spAlert("db error")},881:commonErrorLoading,882:commonErrorLoading,883:roomFull};var closeConnection=function(){webrtc.leaveRoom();peer.length=0},d0={};(function(){for(var d=["returnmenu","index","Account","accountIframe"],a=0,c=d.length;a<c;d0[d[a]]=gid(d[a++]));})();
var connectClick=!1,connectList=function(){connectClick=!0;location.replace("#"+this.gameID+"Room");connect(this.gameID)},connectToAll=function(d){for(var a=0;a<d.length;a++)d[a]!=me.p2p.id&&(ms("connecting to:",d[a]),me.p2p.connect(d[a]))},connect=function(d){peer=[];onlScreen();ms("connecting to",d,msg.MSG_GAME_LOAD);gid("game").style.display="block";gid("gameName").innerHTML=msg.MSG_GAME_LOAD;gid("returnmenu").style.display="none";gid("index").style.display="none";chatul.innerHTML="";pOrdList=
[];me.p2p?(webrtc.joinRoom(d,onLoginRoom),iniSound()):(webrtc||createP2Pconnection(),createP2Pconnection.func=function(){connect(d)})},solcd={6400900:".",28462225:"a",29052100:"b",29648025:"c",3025E4:"d",30858025:"e",31472100:"f",32092225:"g",32718400:"h",33350625:"i",33988900:"j",34633225:"k",35283600:"l",35940025:"m",36602500:"n",37271025:"o",37945600:"p",38626225:"q",39312900:"r",40005625:"s",40704400:"t",41409225:"u",42120100:"v",42837025:"w",4356E4:"x",44289025:"y",45024100:"z"},quitGame=function(d){hdiv("game");
playersList.length=0;Game.online=0;cusMap=Game.id=void 0;closeConnection();returnMenu();WASM.closeRoom();d.constructor==String&&spAlert(d)};
function showPlayingMenu(){gid("playingMenu")||bodyPut("playingMenu");if(""==gid("playingMenu").innerHTML){gid("playingMenu").innerHTML='<div>\n<ul>\n<li id="backToGame">'+msg.MENU_BACK+'</li>\n<li id="saveGame">'+msg.ENDGAMEDLG_SAVE+'</li>\n<li id="fullscreenmenu">'+msg.FULLSCREEN+'</li>\n<li id="quitButton1">'+msg.MENU_QUIT+"</li>\n</ul>\n<div>\n<span>"+msg.ZOOMSPEED+' </span> <input type="range" id="zoomRange" value="'+localStorage.zoomMult+'"/><br/>\n<span>'+msg.OPTIONS_T_SS+' </span> <input type="range" id="scrollRange" value="'+
localStorage.scrollSpeed+'"/>\n</div>\n<div>\n<span>'+msg.OPTIONS_T_MV+'</span><br/><input type="range" id="musicRange" value="'+localStorage.musicRange+'"/><br/><br/>\n<form id="musicSelect">\n<input type="radio" name="mversion" value="originalMusic" checked /> Original<br/>\n<input type="radio" name="mversion" value="sharpRain" /> Original - <a href="https://www.youtube.com/user/rainheart666787/featured" target="_blank" rel="noopener noreferrer">Sharp Rain</a> Version<br/>\n<input type="radio" name="mversion" value="originalMusic1" /> Original - Alternative One<br/>\n<input type="radio" name="mversion" value="mute" /> Mute\n</form>\n<br />\n<span>'+
msg.OPTIONS_T_SVOL+'</span><br/><input type="range" id="soundRange" value="'+localStorage.soundRange+'"/><br/>\n</div>\n</div>\n';gid("quitButton1").onclick=closeEngine;gid("saveGame").onclick=saveGame;gid("backToGame").onclick=function(){hdiv("playingMenu");filter0()};gid("fullscreenmenu").onclick=autofullscreen;gid("musicRange").oninput=function(){gainNode.gain.value=parseInt(gid("musicRange").value)/100;localStorage.musicRange=gid("musicRange").value};gid("zoomRange").oninput=function(){localStorage.zoomMult=
gid("zoomRange").value};gid("scrollRange").oninput=function(){localStorage.scrollSpeed=gid("scrollRange").value};gid("soundRange").oninput=function(){gainNodeVolume.gain.value=parseInt(gid("soundRange").value)/100;localStorage.soundRange=gid("soundRange").value};localStorage.favMusic&&(gid("musicSelect").mversion.value=localStorage.favMusic);for(var d=gid("musicSelect").getElementsByTagName("input"),a=0,c=d.length;a<c;a++)d[a].onchange=gameMusic.reset}Game.demo&&hdiv("saveGame")||sdiv("saveGame");
gid("playingMenu").style.display="block";filter1()}var playingWith={euro:0,arab:0,asia:0};function closeEngine(){location.href=""}var createOrderList=function(){var d=[me.onlineID];d.length=peer.length+1;for(var a=0,c=peer.length;a<c;d[a+1]=peer[a++].id);return d},pOrdList,idassign=1,decimalColor=function(){return parseInt(me.color.substr(1),16)};
function setupPeer(d){ms("setup:",d);d.toSend=[];d.orderList=[];var a=webrtc.roomName;a=a.substr(0,a.length-1);d.id==a&&(d.admin=!0);d.superID=onlID(d.id);d.sendDirectly("channelMessage","nehhof",{});ms(d.channels.channelMessage);d.channels.channelMessage.onopen=function(){peer.put(d);play("attack");onLoginRoom(1);ms("DATACHANNEL OPEN");setTimeout(function(){ms(d);me.admin?(writeWASMtext(WASM.onlADD(0,0,decimalColor(),d.superID,0),17,"connecting..."),WASM.onlineKingdoms(),SetupGameConfig()):d.admin&&
(writeWASMtext(WASM.mnameadd(),17,me.name),WASM.shareName(d.superID))},500)};d.channels.channelMessage.onerror=function(a){ms(a)}}
var searchPeer=function(d){for(var a=0,c=peer.length;a<c;a++){var b=peer[a];if(b.id==d)return b}},webrtc,userNameGet=function(d){me.name=htmlEntities(gid("usernameVal").value);me.color=gid("usernameColor").value;localStorage.color=me.color;localStorage.name=me.name;document.body.removeChild(gid("usernameForm"));writeWASMtext(WASM.userConfig(decimalColor()),17,me.name||"Guest");d();filter0()},nameRequest=function(d){if(!gid("usernameForm")){filter1();var a=localStorage.name||"Guest",c=localStorage.color;
if(!c){for(c=Math.floor(16777215*Math.random()).toString(16);6>c.length;)c="0"+c;c="#"+c}var b=document.createElement("div");b.id="usernameForm";b.innerHTML="\n            <div>\n            <h2>"+msg.MP_SEARCH_T_PL_NAME+'</h2>\n            <div>\n<input type="color" id=\'usernameColor\' value="'+c+'" /><input id=\'usernameVal\' type="text" value="'+ihtmlEntities(a)+'" />\n</div>\n<br />\n</div>';a=document.createElement("button");a.innerHTML=msg.MSG_SYS_CONT;a.onclick=function(){userNameGet(d)};
b.children[0].appendChild(a);document.body.appendChild(b)}},onlID=function(d){for(var a=0,c=0;c<d.length;c++)a+=d.charCodeAt(c)*c+(a&c);ms(a,"id");return a%4294967295},temparrWrite=function(d){for(var a=wasmu32Array(WASM.tempointeradd(d.length),d.length),c=0;c<d.length;c++)a[c]=d[c]},createP2Pconnection=function(){werrorbGL()||(me.name?(setupP2PEngine(),webrtc=new SimpleWebRTC({localVideoEl:"",remoteVideosEl:"",autoRequestMedia:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},url:"https://gthsolar0.herokuapp.com"}),
webrtc.on("channelMessage",function(d,a,c){temparrWrite(c);WASM.onldata(d.superID)}),webrtc.on("error",function(d){"full"==d&&roomFull()}),webrtc.on("connectionReady",function(d){var a=webrtc.connection.connection;me.p2p=a;me.superID=onlID(a.id);WASM.setupOnlID(me.superID);a.username=me.name;a.color=me.color;a.on("getRooms",function(a){var b=a.date,c=Object.keys(a),d=gid("gameList");if(1<c.length){d.innerHTML="";for(var g=0,l=c.length;g<l;g++){var k=c[g],n=a[k];if("date"!=k){var m=n.len;if(m){var r=
document.createElement("tr"),p="";p=n.playing?p+("<td><div class='redCircle'></div>"+msg.PLAYING+"</td>"):p+("<td><div class='redCircle' style=\"background:rgba(0,255,0,.8); box-shadow:0px 0px 20px rgba(0,255,0,.8)\"></div>"+msg.WAITING+"</td></td>");p+="<td>"+htmlEntities(n.description)+"</td><td>"+~~((b-n.date)/6E4)+" min ago</td><td>"+htmlEntities(m)+"/"+htmlEntities(n.max)+"</td>";r.innerHTML=p;r.gameID=k;n.playing||(r.onclick=connectList);d.appendChild(r)}}}}else d.innerHTML="<tr><td>"+msg.NO_GAMES_FOUND+
"</td></tr>"});me.onlineID=d;createP2Pconnection.func&&createP2Pconnection.func()}),webrtc.on("createdPeer",function(d){Game.started||setupPeer(d)})):nameRequest(createP2Pconnection))},publishGame=function(){iniSound();filter0();onlScreen();sdiv("game");hdiv("returnmenu");hdiv("index");gid("gameName").innerHTML=msg.MSG_GAME_LOAD;chatul.innerHTML="";peer=[];resetmenu();me.admin=1;me.room={description:gid("gameFormName").value,max:parseInt(gid("gameMax").value),public:!0};2>me.room.max&&(me.room.max=
2);14<me.room.max&&(me.room.max=14);localStorage.gameDescription=me.room.description;webrtc.createRoom(me.onlineID+"b",onLoginRoom);Game.online=1;document.body.removeChild(gid("gameForm"));pOrdList=[me.onlineID];SetupGameConfig();WASM.setupOnlTable(me.room.max+1);writeWASMtext(WASM.onlADD(0,0,decimalColor(),me.superID,0),17,me.name);setupPlayermenu()},startconection=function(){webrtc||createP2Pconnection();if(me.onlineID){filter1();var d=localStorage.gameDescription||me.name+"'s room",a=document.createElement("div");
a.id="gameForm";a.innerHTML="<div>\n<h2>"+msg.OPTIONS_T_GOPT+"</h2>\n"+msg.EDIT_T_GAMENAME+': <input id=\'gameFormName\' type="text" value="'+d+'" maxlength="29" /><br />\n'+msg.SP_SETUPMAP_T_NUM_PLAYERS+': <input id="gameMax" type="number" value="6" max="14" min="2"/><br />\n</div>';d=document.createElement("button");d.innerHTML=msg.MSG_SYS_CONT;d.onclick=publishGame;a.children[0].appendChild(d);document.body.appendChild(a)}else setTimeout(function(){location.hash=""},200),createP2Pconnection.func=
startconection},saveGame=function(){var d=WASM.savegame(),a=wasmu8Array(d,sharedArr[0]),c=sharedArr[1];ms(a,d);d=new Blob([new Uint32Array([c]),a],{type:"application/octet-binary"});indbSaveMap({name:"Savegame",played:25*WASM.gcycle(),date:Date.now()},d);gid("saveGame").innerHTML="Done";setTimeout(function(){gid("saveGame").innerHTML=msg.ENDGAMEDLG_SAVE},800)},saveBlob=function(d){d=URL.createObjectURL(d);var a=document.createElement("a");document.body.appendChild(a);a.style="display: none";a.href=
d;a.download="savegame.tzared";a.click()},startEngine=function(){peer.length&&(SetupGameConfig(),WASM.strOnl(),me.p2p.emit("gameStarted"))},peersid=function(d){for(var a=0,c=peer.length;a<c;a++){var b=peer[a];if(b.superID===d)return b}},peerSend=function(d,a,c){c=peersid(c);d=wasmu32Array(d,a);c&&c.sendDirectly("channelMessage","nehhof",d)},startMovement=function(){filter0();gid("alert")&&hdiv("alert");Game.started=1;Game.date=Date.now();pause();gameMusic();WASM.startMovement();rndr()};
startMovement.fast=!0;var startOnlineGame=function(d,a,c){Game.started=1;startGame()},disableGameClick=!1,filter0=function(){disableGameClick=!1;gid("basic").style.filter=""},filter1=function(){disableGameClick=!0;gid("basic").style.filter="blur(94px)"};closeGame=function(){hdiv("game");playersList.length=0;Game.id=void 0;Game.online=0;cusMap=void 0;Game.compressed=void 0;Game.arje=void 0;closeConnection();returnMenu();me.admin=0;WASM.closeRoom()};
var updateMax=function(d){d=parseInt(d);if(2>d||!d)d=2;14<d&&(d=14);d!==me.room.max&&me.p2p.emit("maxPlayers",d-(pOrdList.length-peer.length-1))},updateMaxUsers=function(d){me.room.max=d;setupPlayermenu()},setupDivScreen=function(d,a){if(null==gid(d)){var c=document.createElement("div");c.innerHTML=a;c.id=d;gid("playermenu").appendChild(c);return!0}return!1},onlScreen=function(){setupDivScreen("game",'<h2 id="gameName"></h2>\n<p id="onlineTopInfo"></p>\n<div id="multi21">\n<table class="players" >\n<tbody id="multiplayertable">\n</tbody>\n</table>\n<div id="chat">\n<ul id="msgs">\n</ul>\n<input id="msginput" type="text" autocomplete="off" />\n<input id="sendmsg" type="submit" value="" />\n</div>\n</div>\n<div id="showGameInfo"></div>\n<div id="buttons"></div>')&&
(chatul=gid("msgs"),chatinput=gid("msginput"),chatinput.addEventListener("keyup",function(d){13===d.keyCode&&sendMsg()}),gid("sendmsg").onclick=sendMsg)},onLoginRoom=function(d){if((me.admin||d)&&!Game.id)if(sdiv("game"),d=webrtc.roomName,d+="Room",ms("login"),filter0(),0!==webrtc.getPeers().length||me.admin){var a=me.room||NaN;ms(a);Game.id=d;Game.online=1;resetmenu();me.admin&&(gid("onlineTopInfo").innerHTML=' <button id="addAI" style="padding: 6px;">'+msg.ADD_AI+'</button><span style="float:right">'+
msg.SP_SETUPMAP_T_NUM_PLAYERS+'<input id="nplayersO" min="2" type="number" max="14" value="'+me.room.max+'" /></span>',gid("nplayersO").onchange=function(){var a=this.value;a<pOrdList.length&&(a=pOrdList.length);ms(pOrdList.length,a);pOrdList.length!=a||peer.length||a++;updateMax(a);this.value=me.room.max},gid("addAI").onclick=function(){WASM.onlCount()<me.room.max&&(writeWASMtext(WASM.onlADD(0,0,16777216*Math.random(),0,1),17,"AI"),me.p2p.emit("maxPlayers",me.room.max-WASM.nAIs()),WASM.sndNfo())});
gid("copyButton")&&(gid("copyButton").onclick=function(){gid("onlineID").select();document.execCommand("Copy")},gid("onlineID").value=location.origin+"/#"+Game.id);gid("gameName").innerHTML=htmlEntities(a.description)||"Online Game";hdiv("returnmenu");me.admin?(location.replace("#"+Game.id),gid("buttons").innerHTML='<button id="startbutton">'+msg.MP_MPLAYER_PLAY+'</button><button id="optionbutton">'+msg.MENU_OPTI+'</button><button id="closebutton">'+msg.GENERAL_CLOSE+'</button><br><input id="maploadOnline" type="file" /> <label style="display:none" for= "maploadOnline">'+
msg.strcusMap+'</label> <button id="deleteCusMap">'+msg.randomMap+"</button>",gid("startbutton").onclick=startEngine,gid("optionbutton").onclick=showOptions,gid("closebutton").onclick=closeGame,gid("maploadOnline").accept=".tzared",hdiv("deleteCusMap")):(gid("buttons").innerHTML='<button id="quitbutton">'+msg.MSG_DISCONNECT+"</button>",gid("quitbutton").onclick=quitGame);webrtc.connection.on("remove",removeFunc)}else location.hash="",returnMenu()},removeFunc=function(d){if(d=searchPeer(d.id)){var a=
str16(wasmu16Array(WASM.empName(WASM.pidkingdom(d.superID)),17));chat(pool(msg.VIEWMSG_PLAYER_DISCONECTED,a),0,5);peer.quit(d);WASM.deletePlayer(d.superID);d.admin&&!Game.started&&quitGame(msg.ERR_SERVERCANCEL)}};function resetmenu(){gid("buttons").innerHTML="";gid("gameName").innerHTML=""}function cleanPlayers(){for(var d=document.getElementsByClassName("ucolor"),a=0;a<d.length;a++)ucolor[a].style.background="none",username[a].innerHTML=msg.open,race[a].innerHTML=races[0],team[a].innerHTML=0}
var thereIsAnIdiot=function(d){ms(d);if(me.superID==d)return spAlert(msg.ERR_SERVERKICK),closeGame();(d=searchPeer(d))&&d.end()};
function searchGame(){""==gid("Multiplayer").innerHTML&&(gid("Multiplayer").innerHTML="<h2>"+msg.MAINSCR_MULTI.split("|")[0]+'</h2>\n<button id="createbutton">'+msg.MP_SEARCH_CREATE.split("| ")[1]+'</button>\n<button id="refreshButton1" class="refreshButton">'+msg.GENERAL_REFRESH+'</button>\n<table id="gameList">\n<tbody>\n<tr><td></td></tr>\n</tbody>\n</table>',gid("refreshButton1").onclick=searchGame,gid("createbutton").onclick=startconection);me.p2p?(filter0(),me.p2p.emit("getRooms"),gid("returnmenu").style.display=
"block"):(webrtc||createP2Pconnection(),createP2Pconnection.func=searchGame)}
var ucolor=document.getElementsByClassName("ucolor"),username=document.getElementsByClassName("username"),race=document.getElementsByClassName("race"),team=document.getElementsByClassName("team"),peerlistid,manageUserOnline=function(d){if(me.admin){manageUserOnline.div&&(document.body.removeChild(manageUserOnline.div),manageUserOnline.div=void 0);var a=d.pageX;d=d.pageY;var c=this.i2,b=document.createElement("div");b.style.top=d+"px";b.style.left=a+"px";b.className="onlPlayer";manageUserOnline.div=
b;ms(this.peer,this.i2);if(this.peer.name)a=document.createElement("button"),a.onclick=function(){WASM.userKick(c);me.p2p.emit("maxPlayers",WASM.onlCount());document.body.removeChild(b);manageUserOnline.div=void 0},a.innerHTML=msg.GENERAL_KICK,b.appendChild(a);else{var e=this.peer;a=document.createElement("button");a.onclick=function(){WASM.updown(c,-1);document.body.removeChild(b);manageUserOnline.div=void 0};a.innerHTML=msg.UP;b.appendChild(a);a=document.createElement("button");a.onclick=function(){WASM.updown(c,
1);document.body.removeChild(b);manageUserOnline.div=void 0};a.innerHTML=msg.DOWN;b.appendChild(a);me.onlineID!=e&&(a=document.createElement("button"),a.onclick=function(){ms(22222,e);WASM.userKick(c);me.p2p.emit("maxPlayers",WASM.onlCount());document.body.removeChild(b);manageUserOnline.div=void 0},a.innerHTML=msg.GENERAL_KICK,b.appendChild(a))}a=document.createElement("button");a.onclick=function(){document.body.removeChild(b);manageUserOnline.div=void 0};a.innerHTML=msg.GENERAL_CLOSE;b.appendChild(a);
document.body.appendChild(b)}},setupPlayermenu=function(){var d=gid("multiplayertable"),a='<tr style="text-transform:uppercase"><td></td><td>'+msg.MP_SEARCH_T_PL_NAME+"</td><td>"+msg.RACE+"</td><td>"+msg.TEAM+"</td></tr>",c=pOrdList,b=WASM.nkingdom()-1||14;ms("LENGTH",b);c&&b<c.length&&(b=c.length);for(c=0;c<b;c++)a+='<tr><td class="ucolor"></td><td class="username">'+msg.MP_MPLAYER_NAME_2+'</td><td class="race"></td><td class="team"></td></tr>';6>b&&(a+='<tr style="height: '+(260-46*b)+'px"></tr>');
d.innerHTML=a;gid("multiplayertable").getElementsByTagName("tr");WASM.onlineKingdoms();gid("msgs").style.height=d.clientHeight-87+"px"},multiOptions=function(d,a,c,b,e,f,g,l,k,n,m){if(gid("showGameInfo")){g="<table><tbody>";d==Math.pow(2,31)-1&&(d="***");c==Math.pow(2,31)-1&&(c="***");a==Math.pow(2,31)-1&&(a="***");b==Math.pow(2,31)-1&&(b="***");d=[msg.VIEWMSG_GOLD,d,msg.MP_SETUPMAP_T_MAP_SIZE,k,msg.VIEWMSG_WOOD,c,msg.MP_SETUPMAP_T_TERRAIN,f,msg.VIEWMSG_FOOD,a,msg.INITIAL_PEASANTS,n,msg.VIEWMSG_STONE,
b,msg.WATER,e,msg.FREE_POP,m];a=d.length;for(c=0;c<a;c+=2)c%4||(c&&(g+="</tr>"),g+="<tr>"),g+="<td>"+d[c]+":</td><td>"+d[c+1]+"</td>";g+="</tbody></table>";return gid("showGameInfo").innerHTML=g}};var playersList=[],waitingHash=emptyFunction,clicktoconnect=function(){iniSound();document.body.removeChild(gid("connectConfirm"));var d=location.hash.substr(1);connect(d.substr(0,d.length-4))},connecthashroom=function(){if(connectClick)connectClick=!1;else if(!me.admin){var d=document.createElement("div");document.body.appendChild(d);d.id="connectConfirm";d.innerHTML="<button>"+msg.CLICKJOIN+"</button>";d.onclick=clicktoconnect;createP2Pconnection()}};
function locationhash(){var d=location,a=d.hash.substr(1);""===a&&(gid("returnmenu").style.display="none");if("Room"===d.hash.substr(-4))WASMready?connecthashroom():waitingHash=connecthashroom;else if(hashFunc[a])if(WASMready)hashFunc[a]();else waitingHash=hashFunc[a];else d.hash=""}window.onhashchange=locationhash;
var chatul,chatinput,chat=function(d,a,c,b){play("chat");c&&(a=WASM.gstarted()?chatul2:chatul,a.innerHTML=5!==c?a.innerHTML+("<li><span>"+str16(wasmu16Array(c,17))+" \u2014</span> "+str16(wasmu16Array(d,b))+"</li>"):a.innerHTML+("<li>"+d+"</li>"),a.scrollTop=a.scrollHeight,WASM.gstarted()&&deleteFirstElement())};chat.fast=!0;
var deleteFirstElement=function(){11==chatul.children.length&&gid("msgs1").removeChild(gid("msgs1").children[0]);1==chatul.children.length&&(deleteFirstElement.intv=setInterval(deletestepf,16E3))},deletestepf=function(){gid("msgs1").children[0]&&gid("msgs1").removeChild(gid("msgs1").children[0]);chatul&&0==chatul.children.length&&clearInterval(deleteFirstElement.intv)},htmlEntities=function(d){return String(d).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},ihtmlEntities=function(d){return String(d).replace(/&lt;/g,
"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},sendMsg=function(){if(Game.started){var d=chatul2;var a=gid("msginputGame").value;gid("msginputGame").value=""}else d=chatul,a=chatinput.value,chatinput.value="";""!==a&&(a=htmlEntities(a),d.innerHTML+="<li><span>"+me.name+" \u2014</span> "+a+"</li>",writeWASMtext(WASM.tempstradd(),1024,a),WASM.liveChat(a.length),d.scrollTop=d.scrollHeight,Game.started&&deleteFirstElement())},confirmAlert=function(d,a,c,b){var e=document.createElement("div");e.className=
"confirmDiv";e.innerHTML="\n<h2>"+d+"</h2>\n<p>"+a+"</p>";d=document.createElement("button");d.innerHTML=msg.GENERAL_YES;a=document.createElement("button");a.innerHTML=msg.GENERAL_NO;d.onclick=function(){c();e.parentNode.removeChild(e)};a.onclick=function(){e.parentNode.removeChild(e)};e.appendChild(d);e.appendChild(a);b&&(e.id=b);document.body.appendChild(e)};function hideElement(d){d=gid(d);d.style.display="none"===d.style.display?"block":"none"}
function hideElementDir(d){d.style.display="none"===d.style.display?"block":"none"}
var ucolor1=document.getElementsByClassName("ucolor1"),username1=document.getElementsByClassName("username1"),race1=document.getElementsByClassName("race1"),team1=document.getElementsByClassName("team1"),changeTeam=function(d){var a=1;2===d.button&&(a=-1);this.innerHTML=WASM.changeTeam(this.iteam,a)},changeRace=function(d){var a=1;2===d.button&&(a=-1);this.innerHTML=races[WASM.changeRace(this.iteam,a)]},changeColor=function(){this.parentElement.style.background=this.value;WASM.changeColor(this.iteam,
parseInt(this.value.substr(1),16))},addPlayer=function(){WASM.randomKingdoms(1)},removePlayer=function(){WASM.randomKingdoms(-1)},racetr={0:"euro",1:"arab",2:"asia"},NameAvailable=[["a","e","i","o","u"],"bcdfghjklmnpqrstvwxyz".split("")],randomName=function(){var d=~~(9*Math.random())+2,a=NameAvailable[1],c=a[~~(Math.random()*a.length)].toUpperCase();.85<Math.random()&&(c+=a[~~(Math.random()*a.length)]);for(a=0;a<d;a++){var b=NameAvailable[a%2];c+=b[~~(Math.random()*b.length)];.8<Math.random()&&(c+=
b[~~(Math.random()*b.length)])}return c},presetuprndtable=function(){sdiv("returnmenu");gid("oneplayertbody").innerHTML='<tr><td></td><td id="addremove"><button id="addPlayer">+</button><button id="removePlayer">-</button></td><td></td><td></td></tr>';for(var d=0,a=WASM.nkingdom()-1;d<a;d++)gid("oneplayertbody").innerHTML+='<tr><td class="ucolor1"></td><td class="username1"></td><td class="race1"><button></button></td><td class="team1"><button></button></td></tr>';gid("addPlayer").onclick=addPlayer;
gid("removePlayer").onclick=removePlayer},onlineTable=function(d,a,c,b,e,f,g){var l="#"+b.toString(16);d=str16(wasmu16Array(d,17));var k=gid("multiplayertable").getElementsByTagName("tr"),n=f==me.superID,m=e+1;b=hexToRgb(l);ucolor[e].style.background="rgb("+b[0]+","+b[1]+","+b[2]+")";username[e].innerHTML=d;g&&(username[e].style.color="#fff900");n||g&&me.admin?(team[e].innerHTML="",d=document.createElement("button"),d.onmousedown=changeTeam,d.iteam=m,d.innerHTML=a,team[e].appendChild(d),g&&(d.style.color=
"#fff900"),d=document.createElement("button"),d.onmousedown=changeRace,d.iteam=m,d.innerHTML=races[c],race[e].appendChild(d),g&&(d.style.color="#fff900"),a=document.createElement("input"),a.type="color",a.iteam=m,a.value=l,ucolor[e].appendChild(a),a.onchange=changeColor):(team[e].innerHTML=a,race[e].innerHTML=races[c]);me.admin&&!n&&(k[e+1].onclick=manageUserOnline,k[e+1].peer=f,k[e+1].i2=e+1)},randomMapTable=function(d,a,c,b,e){for(b=b.toString(16);6>b.length;)b="0"+b;b="#"+b;ucolor1[e].style.background=
b;username1[e].innerHTML=str16(wasmu16Array(d,20));d=team1[e].getElementsByTagName("button")[0];d.iteam=e+1;d.onmousedown=changeTeam;d.innerHTML=a;a=race1[e].getElementsByTagName("button")[0];a.iteam=e+1;a.onmousedown=changeRace;a.innerHTML=races[c];c=document.createElement("input");c.type="color";c.iteam=e+1;c.value=b;ucolor1[e].appendChild(c);c.onchange=changeColor},oneplayertable=function(){if(!me.name)return nameRequest(oneplayertable);""===gid("RandomMap").innerHTML&&(gid("RandomMap").innerHTML=
"<h2>"+msg.MP_SETUPMAP_T_RANDOM+'</h2><div>\n            <table class="players" id="oneplayertable">\n                <tbody id="oneplayertbody">\n                </tbody>\n            </table>\n            <button style="margin-left:40px" id="start2" class="start startButton">'+msg.MP_MPLAYER_PLAY+'</button>\n            <button class="start optionsButton" id="start1">'+msg.MENU_OPTI+"</button>\n        </div>",gid("start1").onclick=showOptions,gid("start2").onclick=startGame);sdiv("returnmenu");
WASM.randomKingdoms()},custommap=function(){""==gid("CustomMap").innerHTML&&(gid("CustomMap").innerHTML="<h2>"+msg.SINGLESCR_LOAD.split("| ")[0]+'</h2>\n<input id="mapload" type="file" />\n<label for="mapload" id="maploadlabel">Choose a file</label>\n<table id="mapcache"></table>\n<div id="customMapcont" style="display:none">\n<table class="players" id="customaptable">\n<tbody id="custombody">\n</tbody>\n</table>\n<button style="margin-left:40px" id="startCustom" class="start startButton">'+msg.MP_MPLAYER_PLAY+
'</button>\n\n<button style="margin-left:40px" id="closeCustom" class="start">'+msg.GENERAL_CLOSE+"</button>\n</div>",gid("closeCustom").onclick=function(){hdiv("customMapcont");gid("maploadlabel").style.display="inline-block";gid("mapcache").style.display="table"},gid("startCustom").onclick=function(){hdiv("customMapcont");gid("closeCustom").onclick();startGame()},gid("mapload").accept=".tzared",gid("mapload").onchange=function(d){d=gid("mapload").files[0];ms(d);d.name.split(".");var a=new FileReader;
a.onload=openMapArray;a.readAsArrayBuffer(d)});sdiv("returnmenu");indbRead()},openMapArray=function(d){d=d.target.result;var a=new Uint8Array(d,4);d=(new Uint32Array(d,0,1))[0];ms(d,a);for(var c=a.length,b=WASM.readSavegame0(c),e=0;e<c;e++)HEAPU8[b+e]=a[e];WASM.readSVG(4*d,c,!0);sdiv("customMapcont");gid("closeCustom").style.display="inline-table";gid("custombody").innerHTML="";WASM.customMapTable()},gnrtcomparray=function(d,a,c){var b=WASM.nh19add(a);b=wasmu8Array(b,a);for(var e=0;e<a;e++)b[e]=d[e+
c];b=WASM.nhcomp();d=WASM.nhlen();return wasmu8Array(b,d)},wcomp=function(){var d=new XMLHttpRequest;d.open("GET","common0.neh2",!0);d.responseType="arraybuffer";d.onload=function(){var a=d.response,c=new Uint8Array(a,12),b=new Uint32Array(a);a=b[0];var e=4*b[1];b=4*b[2];var f=gnrtcomparray(c,a,0).slice(0),g=gnrtcomparray(c,e,a).slice(0);c=gnrtcomparray(c,b,a+e).slice(0);ms(f,g,c);(function(){var a=document.createElement("a");document.body.appendChild(a);a.style="display: none";return function(b,
c){b=new Blob(b,{type:"application/octet-binary"});b=window.URL.createObjectURL(b);console.log(b);a.href=b;a.download=c;a.click();window.URL.revokeObjectURL(b)}})()([new Uint32Array([a,e,b,f.length,g.length,c.length]),f,g,c],"common.neh2")};d.send(1)},setupAddon=function(d){textureAtlas.terrain=readnh2019(d,gameParameters.textureSize,gameParameters.atlasSize);textureAtlas.check()},setupCommontxt=function(d){readnh2019(d,0,0);textureAtlas.check()},readnh2019=function(d,a,c){var b=new Uint8Array(d,
24),e=WASM.nh19add(b.length);e=wasmu8Array(e,b.length);for(var f=0;f<b.length;f++)e[f]=b[f];d=new Uint32Array(d,0,6);b=performance.now();WASM.rdnh19(d[0],d[1],d[2],d[3],d[4],d[5],a,c);ms(performance.now()-b)},fastXHR=function(d,a,c){if(!ONDESKTOP&&localDB&&lastCache&&-1<lastCache.indexOf(d))return lastCache.push(d),ms("cache:",d),DBGETID("basic",a,d);var b=new XMLHttpRequest;b.open("GET",d,!0);b.responseType="arraybuffer";b.onload=function(b){b=b.target.response;idbCache({url:d,buffer:b});a(b)};c&&
(b.onprogress=c);b.send()},navigatorNotify=function(d,a,c){"granted"!=Notification.permission&&Notification.requestPermission(function(a){});var b=new Notification(d,{icon:"nehhon/807.png",body:a,requireInteraction:!1});c||(c=5550);setTimeout(function(){b.close()},c)};var arrayToText=function(d){for(var a=d.length,c="",b=0;b<a;b++)c+=String.fromCharCode(d[b]);return c},acdrt=function(d){for(var a="",c=0,b=d.length;c<b;c++)a+=solcd[d[c]];return a};(function(){})();
var setupTerrainTXT=function(d){if(d){setupTerrainTXT.update=!1;var a=performance.now();d=wasmFloat32Array(WASM.configTerrain(),mapx*mapx*4);ms(performance.now()-a);gl.useProgram(programT);gl.activeTexture(gl.TEXTURE1);a=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,a);gl.pixelStorei(gl.UNPACK_ALIGNMENT,1);webgl1?(gl.getExtension("OES_texture_float"),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,mapx,mapy,0,gl.RGBA,gl.FLOAT,d)):gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA32F,mapx,mapy,0,gl.RGBA,gl.FLOAT,d);gl.texParameteri(gl.TEXTURE_2D,
gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT);gl.bindTexture(gl.TEXTURE_2D,null);gl.bindTexture(gl.TEXTURE_2D,a);gl.uniform1i(gl.getUniformLocation(programT,"img_data"),1);gl.useProgram(program);gl.activeTexture(gl.TEXTURE2)}else setupTerrainTXT.update=!0};setupTerrainTXT.update=!1;var searchPOS=function(d,a){var c=a.length,b=d.length,e=0;a:for(;e<c;e++){for(var f=0;f<b;f++)if(a[e+f]!==d[f])continue a;return e}return!1},toCode=function(d){for(var a=d.length,c=new Uint16Array(d.length),b=0;b<a;b++)c[b]=d.charCodeAt(b);return c},searchString=function(d,a){return searchPOS(toCode(d),a)+d.length},searchString2=function(d,a){d+=String.fromCharCode(0);return searchPOS(toCode(d),a)},createString=function(d,a,c){var b="";for(a+=d;d<a&&c[d];d++)b+=String.fromCharCode(c[d]);return b},
stringFromProp=function(d,a){return createString(512*(a[searchString("."+d,a)]-1),512,a)},wmp=function(d){d=new Uint8Array(d);var a=searchPOS([50,109,122,116],d)+6,c=d[a]+256*d[a+1];a=d[a+2]+(d[a+3]<<8)+(d[a+4]<<16);ms("mapx:",c,"units",a);ms("header",d[searchString(".header",d)],"description",d[searchString(".description",d)],"kingdominfo",d[searchString(".kingdominfo",d)],"diplomacy",d[searchString(".diplomacy",d)],"forbidden.upgrades",d[searchString(".forbidden.upgrades",d)],"tiles",d[searchString(".tiles",
d)]);ms(d);var b=2*c;c={mapx:c,mapy:c,arje:!1};c.allunits=showUnits(d,b);c.allunits.length>a&&(c.allunits.length=a);c.terrain=showTerrain(d,b,c.allunits);b=(a="grass",searchString2("grass",d))||(a="summer",searchString2("summer",d))||(a="desert",searchString2("desert",d))||(a="snow",searchString2("snow",d));if("summer"==a||a)if("summer"==a||"desert"==a)a="grass";c.description=stringFromProp("description",d);c.author=createString(b-64,64,d);c.name=createString(b-128,64,d);c.terrainType=a;c.kingdoms=
wmp.getKingdoms(d,c);wmp.getDiplomacy(d,c.kingdoms);ms(c);return c};
wmp.getKingdoms=function(d,a){for(var c=searchPOS([192,4],d)+50;!d[c];)c++;var b="name tzar active resGold resStone resFood resWood x6 race x8 x9 x10 x11 x12 x13 x14 AI x16 x17 x18 x19 x20".split(" "),e=b.length,f=[],g,l=[[0,0,189],[206,25,25],[49,181,0],[173,0,197],[255,222,0],[0,181,181],[255,156,33],[90,90,90]];ms("kingdoms:",c);a.tr={0:0,9:0,10:0};for(var k=0;8>k;k++){for(var n={color:l[k]},m=!0,r=0;r<e;r++){var p=b[r];if("name"==p||"tzar"==p){for(n[p]="";!d[c];)c++;for(g=c+32;d[c];)n[p]+=String.fromCharCode(d[c]),
c++;c=g}else n[p]=d[c]+(d[c+1]<<8)+(d[c+2]<<16)+(d[c+3]<<24),"race"==p&&(n[p]=d[c],n.racestr=racetr[d[c]-1]),2!=r||d[c]||(m=!1),c+=4}m&&(f.push(n),a.tr[k+1]=f.length);1<f.length&&(n.IA=1);n.resources=[n.resGold,n.resWood,n.resFood,n.resStone];n.race--}ms(f);return f};wmp.getDiplomacy=function(d,a){for(var c=512*(d[searchString(".diplomacy",d)]-1),b=a.length,e=0;e<b;e++){var f=[0];if(a[e]){a[e].diplomacy=f;for(var g=1;9>g;g++){if(a[g-1]){var l=d[c];l=60>l&&g-1!=e?1:0;f.push(l)}c+=4}}else c+=32}};
var toCanvas=function(d,a){if(d&&d.length){a/=2;var c=~~(d.length/a);if(a){for(var b=document.createElement("canvas"),e=b.getContext("2d"),f=new ImageData(a,c),g=f.data,l=0,k=g.length;l<k;l+=4){var n=d[l/4];g[l]=n;g[l+1]=n;g[l+2]=n;g[l+3]=255}b.width=a;b.height=c;e.putImageData(f,0,0);document.body.appendChild(b)}}},showTerrain=function(d,a,c){a/=2;for(var b=[],e=0,f=[],g=d[searchString(".forbidden.upgrades",d)]+1,l=g,k=g*=512,n=d.length;k<n;k+=2){for(var m=d[k],r=~~(k/512),p=8;p<a&&d[p+k]===(m+p/
4)%256;p+=4);20<p&&(k=512*r,1==b.length&&(k=512*(r-(2-(r-l)%2))),p=d.slice(g,k),g-k&&(b[e++]=[g,k],f.push(p)),k+=512,2==b.length&&(k-=512),g=k)}b[e++]=[g,d.length];f={64:[b[0]],96:[b[0]],128:[b[0]],192:[b[1],b[0],b[2],b[3]],256:[b[1],b[0],b[2],b[3]],384:[b[1],b[0],b[2],b[3],b[4],b[5],b[6]],512:[b[1],b[0],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9]]}[a];ms(b);b=new Uint8Array(a*a);g=new Uint8Array(a*a);p=e=0;for(l=f.length;p<l;p++)if(n=f[p],e<a*a)for(k=n[0],n=n[1];k<n;k+=2)b[e]=terrainTranslate[d[k]]||
0,g[e]=d[k+1],10<g[e]&&c.push({type:7,d:g[e]%31,x32:e%a,y32:~~(e/a)}),e++;return b},showUnits=function(d,a){var c="utype xx56 xx2 xx562 type xx3 xxtra x32 y32 kingdom race id d health maxHealth attack defence xx8 level xx9 resistance xx11 mana xx12".split(" "),b="utype xx56 xx2 xx562 type xx3 xxtra x32 y32 kingdom race id d health maxHealth attack defence xx8 level xx9 resistance xx11 mana xx12 xx13 xx14 xx15 xx16 xx17 xx18 xx19 xx20 xx21 resource".split(" ");a/=2;var e=20480+2*a*a,f={};a=0;for(var g=
d.length;a<g;a++){var l=d[a];f[l]||(f[l]=[]);f[l].push(a)}f=[];var k={56:!0,58:!0,88:!0,72:!0};a=e+1;for(g=d.length;a<g;a++)if(l=d[a],k[l]&&k[d[a+4]]){e={};l=72!==l?c:b;for(var n=a-2,m=0,r=l.length;m<r;m++){var p=l[m];"kingdom"==p||"race"==p?(e[p]=d[n],n++):(e[p]=d[n]+256*d[n+1],n+=2)}a+=2*r-3;f.push(e)}return f},objpush=function(d){d.sort(function(a,b){return a.y32-b.y32});ms(d);for(var a=0;a<d.length;a++)eqobj[d[a].type+256*d[a].race]=a+111;ms(eqobj)},eqobj={},terrainTranslateSummer={0:3,32:0,144:1,
240:2},terrainTranslate={0:3,32:0,144:1,240:2,64:2},translateWMP={15:78,16:77,19:37,20:39,21:38,22:131,23:73,24:75,25:76,27:59,28:58,30:132,31:40,32:130,36:60,38:42,39:55,40:32,41:44,42:56,43:57,61:13,62:13,63:20,64:35,72:43,110:27,133:36,136:74,257:10,258:61,259:0,260:4,261:3,262:6,263:1,264:19,267:8,270:2,273:5,274:9,300:12,301:14,302:15,303:23,304:30,305:25,306:28,307:18,308:34,309:33,310:41,311:11,312:17,314:26,315:29,316:16,321:24,322:31,513:79,514:90,515:80,516:81,517:83,519:82,522:85,529:89,
530:87,541:91,545:86,547:84,556:63,557:102,558:93,559:95,560:100,561:99,562:103,563:94,564:104,565:101,566:96,568:109,570:97,571:98,572:107,577:108,578:92,581:110,583:106,769:64,771:66,772:67,773:68,778:69,780:128,781:65,785:129,786:127,802:70,805:72,812:62,813:71,814:112,815:114,816:119,817:118,818:121,819:113,820:122,821:120,822:115,824:126,826:116,827:117,828:124,833:125,834:111,838:123,76:21,78:22};var Module="undefined"!==typeof Module?Module:{},moduleOverrides={},key;for(key in Module)Module.hasOwnProperty(key)&&(moduleOverrides[key]=Module[key]);Module.arguments=[];Module.thisProgram="./this.program";Module.quit=function(d,a){throw a;};Module.preRun=[];Module.postRun=[];var ENVIRONMENT_IS_WEB=!1,ENVIRONMENT_IS_WORKER=!1,ENVIRONMENT_IS_NODE=!1,ENVIRONMENT_IS_SHELL=!1;ENVIRONMENT_IS_WEB="object"===typeof window;ENVIRONMENT_IS_WORKER="function"===typeof importScripts;
ENVIRONMENT_IS_NODE="object"===typeof process&&"function"===typeof require&&!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER;ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;var scriptDirectory="";function locateFile(d){return Module.locateFile?Module.locateFile(d,scriptDirectory):scriptDirectory+d}
if(ENVIRONMENT_IS_NODE){scriptDirectory=__dirname+"/";var nodeFS,nodePath;Module.read=function(d,a){nodeFS||(nodeFS=require("fs"));nodePath||(nodePath=require("path"));d=nodePath.normalize(d);d=nodeFS.readFileSync(d);return a?d:d.toString()};Module.readBinary=function(d){d=Module.read(d,!0);d.buffer||(d=new Uint8Array(d));assert(d.buffer);return d};1<process.argv.length&&(Module.thisProgram=process.argv[1].replace(/\\/g,"/"));Module.arguments=process.argv.slice(2);"undefined"!==typeof module&&(module.exports=
Module);process.on("uncaughtException",function(d){if(!(d instanceof ExitStatus))throw d;});process.on("unhandledRejection",abort);Module.quit=function(d){process.exit(d)};Module.inspect=function(){return"[Emscripten Module object]"}}else if(ENVIRONMENT_IS_SHELL)"undefined"!=typeof read&&(Module.read=function(d){return read(d)}),Module.readBinary=function(d){if("function"===typeof readbuffer)return new Uint8Array(readbuffer(d));d=read(d,"binary");assert("object"===typeof d);return d},"undefined"!=
typeof scriptArgs?Module.arguments=scriptArgs:"undefined"!=typeof arguments&&(Module.arguments=arguments),"function"===typeof quit&&(Module.quit=function(d){quit(d)});else if(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)ENVIRONMENT_IS_WORKER?scriptDirectory=self.location.href:document.currentScript&&(scriptDirectory=document.currentScript.src),scriptDirectory=0!==scriptDirectory.indexOf("blob:")?scriptDirectory.substr(0,scriptDirectory.lastIndexOf("/")+1):"",Module.read=function(d){var a=new XMLHttpRequest;
a.open("GET",d,!1);a.send(null);return a.responseText},ENVIRONMENT_IS_WORKER&&(Module.readBinary=function(d){var a=new XMLHttpRequest;a.open("GET",d,!1);a.responseType="arraybuffer";a.send(null);return new Uint8Array(a.response)}),Module.readAsync=function(d,a,c){var b=new XMLHttpRequest;b.open("GET",d,!0);b.responseType="arraybuffer";b.onload=function(){200==b.status||0==b.status&&b.response?a(b.response):c()};b.onerror=c;b.send(null)},Module.setWindowTitle=function(d){document.title=d};
var out=Module.print||("undefined"!==typeof console?console.log.bind(console):"undefined"!==typeof print?print:null),err=Module.printErr||("undefined"!==typeof printErr?printErr:"undefined"!==typeof console&&console.warn.bind(console)||out);for(key in moduleOverrides)moduleOverrides.hasOwnProperty(key)&&(Module[key]=moduleOverrides[key]);moduleOverrides=void 0;var STACK_ALIGN=16;
function dynamicAlloc(d){var a=HEAP32[DYNAMICTOP_PTR>>2];d=a+d+15&-16;if(d<=_emscripten_get_heap_size())HEAP32[DYNAMICTOP_PTR>>2]=d;else if(!_emscripten_resize_heap(d))return 0;return a}
function getNativeTypeSize(d){switch(d){case "i1":case "i8":return 1;case "i16":return 2;case "i32":return 4;case "i64":return 8;case "float":return 4;case "double":return 8;default:if("*"===d[d.length-1])return 4;if("i"===d[0]){var a=parseInt(d.substr(1));assert(0===a%8,"getNativeTypeSize invalid bits "+a+", type "+d);return a/8}return 0}}function warnOnce(d){warnOnce.shown||(warnOnce.shown={});warnOnce.shown[d]||(warnOnce.shown[d]=1,err(d))}
var asm2wasmImports={"f64-rem":function(d,a){return d%a},"debugger":function(){debugger}},jsCallStartIndex=1,functionPointers=[],funcWrappers={};function dynCall(d,a,c){return c&&c.length?Module["dynCall_"+d].apply(null,[a].concat(c)):Module["dynCall_"+d].call(null,a)}var tempRet0=0,setTempRet0=function(d){tempRet0=d},getTempRet0=function(){return tempRet0};"object"!==typeof WebAssembly&&err("no native wasm support detected");var wasmMemory,wasmTable,ABORT=!1,EXITSTATUS=0;
function assert(d,a){d||abort("Assertion failed: "+a)}function getCFunc(d){var a=Module["_"+d];assert(a,"Cannot call unknown function "+d+", make sure it is exported");return a}
function ccall(d,a,c,b,e){e={string:function(a){var b=0;if(null!==a&&void 0!==a&&0!==a){var c=(a.length<<2)+1;b=stackAlloc(c);stringToUTF8(a,b,c)}return b},array:function(a){var b=stackAlloc(a.length);writeArrayToMemory(a,b);return b}};var f=getCFunc(d),g=[];d=0;if(b)for(var l=0;l<b.length;l++){var k=e[c[l]];k?(0===d&&(d=stackSave()),g[l]=k(b[l])):g[l]=b[l]}c=f.apply(null,g);c=function(b){return"string"===a?UTF8ToString(b):"boolean"===a?!!b:b}(c);0!==d&&stackRestore(d);return c}
function setValue(d,a,c,b){c=c||"i8";"*"===c.charAt(c.length-1)&&(c="i32");switch(c){case "i1":HEAP8[d>>0]=a;break;case "i8":HEAP8[d>>0]=a;break;case "i16":HEAP16[d>>1]=a;break;case "i32":HEAP32[d>>2]=a;break;case "i64":tempI64=[a>>>0,(tempDouble=a,1<=+Math_abs(tempDouble)?0<tempDouble?(Math_min(+Math_floor(tempDouble/4294967296),4294967295)|0)>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)];HEAP32[d>>2]=tempI64[0];HEAP32[d+4>>2]=tempI64[1];break;case "float":HEAPF32[d>>2]=a;
break;case "double":HEAPF64[d>>3]=a;break;default:abort("invalid type for setValue: "+c)}}var ALLOC_NONE=3,UTF8Decoder="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;
function UTF8ArrayToString(d,a,c){var b=a+c;for(c=a;d[c]&&!(c>=b);)++c;if(16<c-a&&d.subarray&&UTF8Decoder)return UTF8Decoder.decode(d.subarray(a,c));for(b="";a<c;){var e=d[a++];if(e&128){var f=d[a++]&63;if(192==(e&224))b+=String.fromCharCode((e&31)<<6|f);else{var g=d[a++]&63;e=224==(e&240)?(e&15)<<12|f<<6|g:(e&7)<<18|f<<12|g<<6|d[a++]&63;65536>e?b+=String.fromCharCode(e):(e-=65536,b+=String.fromCharCode(55296|e>>10,56320|e&1023))}}else b+=String.fromCharCode(e)}return b}
function UTF8ToString(d,a){return d?UTF8ArrayToString(HEAPU8,d,a):""}
function stringToUTF8Array(d,a,c,b){if(!(0<b))return 0;var e=c;b=c+b-1;for(var f=0;f<d.length;++f){var g=d.charCodeAt(f);if(55296<=g&&57343>=g){var l=d.charCodeAt(++f);g=65536+((g&1023)<<10)|l&1023}if(127>=g){if(c>=b)break;a[c++]=g}else{if(2047>=g){if(c+1>=b)break;a[c++]=192|g>>6}else{if(65535>=g){if(c+2>=b)break;a[c++]=224|g>>12}else{if(c+3>=b)break;a[c++]=240|g>>18;a[c++]=128|g>>12&63}a[c++]=128|g>>6&63}a[c++]=128|g&63}}a[c]=0;return c-e}
function stringToUTF8(d,a,c){return stringToUTF8Array(d,HEAPU8,a,c)}function lengthBytesUTF8(d){for(var a=0,c=0;c<d.length;++c){var b=d.charCodeAt(c);55296<=b&&57343>=b&&(b=65536+((b&1023)<<10)|d.charCodeAt(++c)&1023);127>=b?++a:a=2047>=b?a+2:65535>=b?a+3:a+4}return a}var UTF16Decoder="undefined"!==typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function allocateUTF8OnStack(d){var a=lengthBytesUTF8(d)+1,c=stackAlloc(a);stringToUTF8Array(d,HEAP8,c,a);return c}
function writeArrayToMemory(d,a){HEAP8.set(d,a)}function writeAsciiToMemory(d,a,c){for(var b=0;b<d.length;++b)HEAP8[a++>>0]=d.charCodeAt(b);c||(HEAP8[a>>0]=0)}function demangle(d){return d}function demangleAll(d){return d.replace(/__Z[\w\d_]+/g,function(a){var c=demangle(a);return a===c?a:c+" ["+a+"]"})}function jsStackTrace(){var d=Error();if(!d.stack){try{throw Error(0);}catch(a){d=a}if(!d.stack)return"(no stack trace available)"}return d.stack.toString()}var WASM_PAGE_SIZE=65536;
function alignUp(d,a){0<d%a&&(d+=a-d%a);return d}var buffer,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateGlobalBuffer(d){Module.buffer=buffer=d}
function updateGlobalBufferViews(){Module.HEAP8=HEAP8=new Int8Array(buffer);Module.HEAP16=HEAP16=new Int16Array(buffer);Module.HEAP32=HEAP32=new Int32Array(buffer);Module.HEAPU8=HEAPU8=new Uint8Array(buffer);Module.HEAPU16=HEAPU16=new Uint16Array(buffer);Module.HEAPU32=HEAPU32=new Uint32Array(buffer);Module.HEAPF32=HEAPF32=new Float32Array(buffer);Module.HEAPF64=HEAPF64=new Float64Array(buffer)}
var STACK_BASE=5459040,DYNAMIC_BASE=10701920,DYNAMICTOP_PTR=5458784,TOTAL_STACK=5242880,TOTAL_MEMORY=Module.TOTAL_MEMORY||471859200;TOTAL_MEMORY<TOTAL_STACK&&err("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+TOTAL_MEMORY+"! (TOTAL_STACK="+TOTAL_STACK+")");
Module.buffer?buffer=Module.buffer:("object"===typeof WebAssembly&&"function"===typeof WebAssembly.Memory?(wasmMemory=new WebAssembly.Memory({initial:TOTAL_MEMORY/WASM_PAGE_SIZE}),buffer=wasmMemory.buffer):buffer=new ArrayBuffer(TOTAL_MEMORY),Module.buffer=buffer);updateGlobalBufferViews();HEAP32[DYNAMICTOP_PTR>>2]=DYNAMIC_BASE;
function callRuntimeCallbacks(d){for(;0<d.length;){var a=d.shift();if("function"==typeof a)a();else{var c=a.func;"number"===typeof c?void 0===a.arg?Module.dynCall_v(c):Module.dynCall_vi(c,a.arg):c(void 0===a.arg?null:a.arg)}}}var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATPOSTRUN__=[],runtimeInitialized=!1,runtimeExited=!1;
function preRun(){if(Module.preRun)for("function"==typeof Module.preRun&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){runtimeInitialized||(runtimeInitialized=!0,callRuntimeCallbacks(__ATINIT__))}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){runtimeExited=!0}
function postRun(){if(Module.postRun)for("function"==typeof Module.postRun&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(d){__ATPRERUN__.unshift(d)}function addOnPostRun(d){__ATPOSTRUN__.unshift(d)}var Math_abs=Math.abs,Math_ceil=Math.ceil,Math_floor=Math.floor,Math_min=Math.min,runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;
function addRunDependency(d){runDependencies++;Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies)}function removeRunDependency(d){runDependencies--;Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies);0==runDependencies&&(null!==runDependencyWatcher&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled&&(d=dependenciesFulfilled,dependenciesFulfilled=null,d()))}Module.preloadedImages={};Module.preloadedAudios={};
var dataURIPrefix="data:application/octet-stream;base64,";function isDataURI(d){return String.prototype.startsWith?d.startsWith(dataURIPrefix):0===d.indexOf(dataURIPrefix)}var wasmBinaryFile="a.out.wasm";isDataURI(wasmBinaryFile)||(wasmBinaryFile=locateFile(wasmBinaryFile));function getBinary(){try{if(Module.wasmBinary)return new Uint8Array(Module.wasmBinary);if(Module.readBinary)return Module.readBinary(wasmBinaryFile);throw"both async and sync fetching of the wasm failed";}catch(d){abort(d)}}
function getBinaryPromise(){return Module.wasmBinary||!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER||"function"!==typeof fetch?new Promise(function(d,a){d(getBinary())}):fetch(wasmBinaryFile,{credentials:"same-origin"}).then(function(d){if(!d.ok)throw"failed to load wasm binary file at '"+wasmBinaryFile+"'";return d.arrayBuffer()}).catch(function(){return getBinary()})}
function createWasm(d){function a(a,b){Module.asm=a.exports;removeRunDependency("wasm-instantiate")}function c(b){a(b.instance)}function b(a){getBinaryPromise().then(function(a){return WebAssembly.instantiate(a,e)}).then(a,function(a){err("failed to asynchronously prepare wasm: "+a);abort(a)})}var e={env:d,global:{NaN:NaN,Infinity:Infinity},"global.Math":Math,asm2wasm:asm2wasmImports};addRunDependency("wasm-instantiate");if(Module.instantiateWasm)try{return Module.instantiateWasm(e,a)}catch(f){return err("Module.instantiateWasm callback failed with error: "+
f),!1}Module.wasmBinary||"function"!==typeof WebAssembly.instantiateStreaming||isDataURI(wasmBinaryFile)||"function"!==typeof fetch?b(c):WebAssembly.instantiateStreaming(fetch(wasmBinaryFile,{credentials:"same-origin"}),e).then(c,function(a){err("wasm streaming compile failed: "+a);err("falling back to ArrayBuffer instantiation");b(c)});return{}}
Module.asm=function(d,a,c){a.memory=wasmMemory;a.table=wasmTable=new WebAssembly.Table({initial:157,maximum:157,element:"anyfunc"});a.__memory_base=1024;a.__table_base=0;return createWasm(a)};
var ASM_CONSTS=[function(d){cursor(d)},function(){setupMWmenu()},function(d){sresizeBuffer(d)},function(){bufferMargin()},function(){bufferPos()},function(){bufferPhysics()},function(){bufferIMG()},function(d,a,c){peerSend(d,a,c)},function(d,a,c,b,e,f,g){onlineTable(d,a,c,b,e,f,g)},function(d,a,c,b,e,f){onlineTable(d,a,c,b,e,f)},function(){setupPlayermenu()},function(d,a,c){chat(d,0,a,c)},function(d){thereIsAnIdiot(d)},function(){presetuprndtable()},function(d,a,c,b,e){randomMapTable(d,a,c,b,e)},
function(){cleanMenuIcons()},function(d,a,c,b,e){buttonSetup(d,a,c,b,e)},function(d,a){setupArrows(d,a)},function(d,a){selectionOne(d,a)},function(d,a,c){selectMulp(d,a,c)},function(){menuDefect()},function(d,a,c,b){changeresources(d,a,c,b)},function(d,a){popInfo(d,a)},function(d,a,c,b,e,f){addRNDOBJ(d,a,c,b,e,f)},function(d,a,c,b,e,f,g,l,k,n,m){multiOptions(d,a,c,b,e,f,g,l,k,n,m)},function(){startMovement()},function(){startGame()},function(d,a,c){wasmplay(d,a,c)},function(d,a,c){play(d,a,c)},function(d,
a,c,b){console.log(d,a,c,b)},function(){spAlert(55)},function(d,a,c,b,e,f){customMapTable(d,a,c,b,e,f)},function(){menuDefect()},function(d,a,c,b,e,f,g,l){writeProps(d,a,c,b,e,f,g,l)},function(d,a){stpLIGHT(d,a)}];function _emscripten_asm_const_i(d){return ASM_CONSTS[d]()}function _emscripten_asm_const_ii(d,a){return ASM_CONSTS[d](a)}function _emscripten_asm_const_iiiiii(d,a,c,b,e,f){return ASM_CONSTS[d](a,c,b,e,f)}function _emscripten_asm_const_iiiii(d,a,c,b,e){return ASM_CONSTS[d](a,c,b,e)}
function _emscripten_asm_const_idddd(d,a,c,b,e){return ASM_CONSTS[d](a,c,b,e)}function _emscripten_asm_const_iiiiiii(d,a,c,b,e,f,g){return ASM_CONSTS[d](a,c,b,e,f,g)}function _emscripten_asm_const_iiiiiiii(d,a,c,b,e,f,g,l){return ASM_CONSTS[d](a,c,b,e,f,g,l)}function _emscripten_asm_const_iiii(d,a,c,b){return ASM_CONSTS[d](a,c,b)}function _emscripten_asm_const_iii(d,a,c){return ASM_CONSTS[d](a,c)}function _emscripten_asm_const_iiiiiiiii(d,a,c,b,e,f,g,l,k){return ASM_CONSTS[d](a,c,b,e,f,g,l,k)}
function _emscripten_asm_const_iiiiiiiiiiii(d,a,c,b,e,f,g,l,k,n,m,r){return ASM_CONSTS[d](a,c,b,e,f,g,l,k,n,m,r)}function _emscripten_asm_const_idd(d,a,c){return ASM_CONSTS[d](a,c)}__ATINIT__.push({func:function(){__GLOBAL__sub_I_nh_cpp()}});var tempDoublePtr=5459024;function __ZSt18uncaught_exceptionv(){return!!__ZSt18uncaught_exceptionv.uncaught_exception}function ___cxa_free_exception(d){try{return _free(d)}catch(a){}}
var EXCEPTIONS={last:0,caught:[],infos:{},deAdjust:function(d){if(!d||EXCEPTIONS.infos[d])return d;for(var a in EXCEPTIONS.infos)for(var c=+a,b=EXCEPTIONS.infos[c].adjusted,e=b.length,f=0;f<e;f++)if(b[f]===d)return c;return d},addRef:function(d){d&&EXCEPTIONS.infos[d].refcount++},decRef:function(d){if(d){var a=EXCEPTIONS.infos[d];assert(0<a.refcount);a.refcount--;0!==a.refcount||a.rethrown||(a.destructor&&Module.dynCall_vi(a.destructor,d),delete EXCEPTIONS.infos[d],___cxa_free_exception(d))}},clearRef:function(d){d&&
(EXCEPTIONS.infos[d].refcount=0)}};function ___resumeException(d){EXCEPTIONS.last||(EXCEPTIONS.last=d);throw d;}
function ___cxa_find_matching_catch(){var d=EXCEPTIONS.last;if(!d)return(setTempRet0(0),0)|0;var a=EXCEPTIONS.infos[d],c=a.type;if(!c)return(setTempRet0(0),d)|0;var b=Array.prototype.slice.call(arguments);Module.___cxa_is_pointer_type(c);___cxa_find_matching_catch.buffer||(___cxa_find_matching_catch.buffer=_malloc(4));HEAP32[___cxa_find_matching_catch.buffer>>2]=d;d=___cxa_find_matching_catch.buffer;for(var e=0;e<b.length;e++)if(b[e]&&Module.___cxa_can_catch(b[e],c,d))return d=HEAP32[d>>2],a.adjusted.push(d),
(setTempRet0(b[e]),d)|0;d=HEAP32[d>>2];return(setTempRet0(c),d)|0}function ___gxx_personality_v0(){}var SYSCALLS={buffers:[null,[],[]],printChar:function(d,a){var c=SYSCALLS.buffers[d];0===a||10===a?((1===d?out:err)(UTF8ArrayToString(c,0)),c.length=0):c.push(a)},varargs:0,get:function(d){SYSCALLS.varargs+=4;return HEAP32[SYSCALLS.varargs-4>>2]},getStr:function(){return UTF8ToString(SYSCALLS.get())},get64:function(){var d=SYSCALLS.get();SYSCALLS.get();return d},getZero:function(){SYSCALLS.get()}};
function ___syscall140(d,a){SYSCALLS.varargs=a;try{var c=SYSCALLS.getStreamFromFD();SYSCALLS.get();var b=SYSCALLS.get(),e=SYSCALLS.get(),f=SYSCALLS.get();FS.llseek(c,b,f);HEAP32[e>>2]=c.position;c.getdents&&0===b&&0===f&&(c.getdents=null);return 0}catch(g){return"undefined"!==typeof FS&&g instanceof FS.ErrnoError||abort(g),-g.errno}}function flush_NO_FILESYSTEM(){var d=Module._fflush;d&&d(0);d=SYSCALLS.buffers;d[1].length&&SYSCALLS.printChar(1,10);d[2].length&&SYSCALLS.printChar(2,10)}
function ___syscall146(d,a){SYSCALLS.varargs=a;try{var c=SYSCALLS.get(),b=SYSCALLS.get(),e=SYSCALLS.get();for(a=d=0;a<e;a++){for(var f=HEAP32[b+8*a>>2],g=HEAP32[b+(8*a+4)>>2],l=0;l<g;l++)SYSCALLS.printChar(c,HEAPU8[f+l]);d+=g}return d}catch(k){return"undefined"!==typeof FS&&k instanceof FS.ErrnoError||abort(k),-k.errno}}function ___syscall54(d,a){SYSCALLS.varargs=a;return 0}
function ___syscall6(d,a){SYSCALLS.varargs=a;try{var c=SYSCALLS.getStreamFromFD();FS.close(c);return 0}catch(b){return"undefined"!==typeof FS&&b instanceof FS.ErrnoError||abort(b),-b.errno}}function _emscripten_get_heap_size(){return TOTAL_MEMORY}function _emscripten_get_now(){abort()}function abortOnCannotGrowMemory(d){abort("OOM")}
function emscripten_realloc_buffer(d){d=alignUp(d,65536);var a=Module.buffer.byteLength;try{return-1!==wasmMemory.grow((d-a)/65536)?Module.buffer=wasmMemory.buffer:null}catch(c){return null}}
function _emscripten_resize_heap(d){var a=_emscripten_get_heap_size();if(2147418112<d)return!1;for(a=Math.max(a,16777216);a<d;)a=536870912>=a?alignUp(2*a,65536):Math.min(alignUp((3*a+2147483648)/4,65536),2147418112);var c=emscripten_realloc_buffer(a);if(!c||c.byteLength!=a)return!1;updateGlobalBuffer(c);updateGlobalBufferViews();TOTAL_MEMORY=a;HEAPU32[DYNAMICTOP_PTR>>2]=d;return!0}function _emscripten_memcpy_big(d,a,c){HEAPU8.set(HEAPU8.subarray(a,a+c),d)}
function ___setErrNo(d){Module.___errno_location&&(HEAP32[Module.___errno_location()>>2]=d);return d}_emscripten_get_now=ENVIRONMENT_IS_NODE?function(){var d=process.hrtime();return 1E3*d[0]+d[1]/1E6}:"undefined"!==typeof dateNow?dateNow:"object"===typeof self&&self.performance&&"function"===typeof self.performance.now?function(){return self.performance.now()}:"object"===typeof performance&&"function"===typeof performance.now?function(){return performance.now()}:Date.now;
var ASSERTIONS=!1,asmGlobalArg={},asmLibraryArg={abort:abort,setTempRet0:setTempRet0,getTempRet0:getTempRet0,__ZSt18uncaught_exceptionv:__ZSt18uncaught_exceptionv,___cxa_find_matching_catch:___cxa_find_matching_catch,___cxa_free_exception:___cxa_free_exception,___gxx_personality_v0:___gxx_personality_v0,___resumeException:___resumeException,___setErrNo:___setErrNo,___syscall140:___syscall140,___syscall146:___syscall146,___syscall54:___syscall54,___syscall6:___syscall6,_emscripten_asm_const_i:_emscripten_asm_const_i,
_emscripten_asm_const_idd:_emscripten_asm_const_idd,_emscripten_asm_const_idddd:_emscripten_asm_const_idddd,_emscripten_asm_const_ii:_emscripten_asm_const_ii,_emscripten_asm_const_iii:_emscripten_asm_const_iii,_emscripten_asm_const_iiii:_emscripten_asm_const_iiii,_emscripten_asm_const_iiiii:_emscripten_asm_const_iiiii,_emscripten_asm_const_iiiiii:_emscripten_asm_const_iiiiii,_emscripten_asm_const_iiiiiii:_emscripten_asm_const_iiiiiii,_emscripten_asm_const_iiiiiiii:_emscripten_asm_const_iiiiiiii,_emscripten_asm_const_iiiiiiiii:_emscripten_asm_const_iiiiiiiii,
_emscripten_asm_const_iiiiiiiiiiii:_emscripten_asm_const_iiiiiiiiiiii,_emscripten_get_heap_size:_emscripten_get_heap_size,_emscripten_get_now:_emscripten_get_now,_emscripten_memcpy_big:_emscripten_memcpy_big,_emscripten_resize_heap:_emscripten_resize_heap,abortOnCannotGrowMemory:abortOnCannotGrowMemory,emscripten_realloc_buffer:emscripten_realloc_buffer,flush_NO_FILESYSTEM:flush_NO_FILESYSTEM,tempDoublePtr:tempDoublePtr,DYNAMICTOP_PTR:DYNAMICTOP_PTR},asm=Module.asm(asmGlobalArg,asmLibraryArg,buffer);
Module.asm=asm;
var __GLOBAL__sub_I_nh_cpp=Module.__GLOBAL__sub_I_nh_cpp=function(){return Module.asm.__GLOBAL__sub_I_nh_cpp.apply(null,arguments)},__Z10Uint8Arrayj=Module.__Z10Uint8Arrayj=function(){return Module.asm.__Z10Uint8Arrayj.apply(null,arguments)},__Z10canvasSizejj=Module.__Z10canvasSizejj=function(){return Module.asm.__Z10canvasSizejj.apply(null,arguments)},__Z10changePagei=Module.__Z10changePagei=function(){return Module.asm.__Z10changePagei.apply(null,arguments)},__Z10changeRaceji=Module.__Z10changeRaceji=function(){return Module.asm.__Z10changeRaceji.apply(null,
arguments)},__Z10changeTeamji=Module.__Z10changeTeamji=function(){return Module.asm.__Z10changeTeamji.apply(null,arguments)},__Z10checkStockv=Module.__Z10checkStockv=function(){return Module.asm.__Z10checkStockv.apply(null,arguments)},__Z10gInventoryj=Module.__Z10gInventoryj=function(){return Module.asm.__Z10gInventoryj.apply(null,arguments)},__Z10gmaxHealthj=Module.__Z10gmaxHealthj=function(){return Module.asm.__Z10gmaxHealthj.apply(null,arguments)},__Z10mouseEnterj=Module.__Z10mouseEnterj=function(){return Module.asm.__Z10mouseEnterj.apply(null,
arguments)},__Z10movtablexev=Module.__Z10movtablexev=function(){return Module.asm.__Z10movtablexev.apply(null,arguments)},__Z10nameSharedPjS_j=Module.__Z10nameSharedPjS_j=function(){return Module.asm.__Z10nameSharedPjS_j.apply(null,arguments)},__Z10pidkingdomj=Module.__Z10pidkingdomj=function(){return Module.asm.__Z10pidkingdomj.apply(null,arguments)},__Z10searchUnitth=Module.__Z10searchUnitth=function(){return Module.asm.__Z10searchUnitth.apply(null,arguments)},__Z10setupOnlIDj=Module.__Z10setupOnlIDj=
function(){return Module.asm.__Z10setupOnlIDj.apply(null,arguments)},__Z10shiftONOFFb=Module.__Z10shiftONOFFb=function(){return Module.asm.__Z10shiftONOFFb.apply(null,arguments)},__Z10tempstraddv=Module.__Z10tempstraddv=function(){return Module.asm.__Z10tempstraddv.apply(null,arguments)},__Z10touchStartjj=Module.__Z10touchStartjj=function(){return Module.asm.__Z10touchStartjj.apply(null,arguments)},__Z10unitActionj=Module.__Z10unitActionj=function(){return Module.asm.__Z10unitActionj.apply(null,arguments)},
__Z10userConfigj=Module.__Z10userConfigj=function(){return Module.asm.__Z10userConfigj.apply(null,arguments)},__Z11Uint16Arrayj=Module.__Z11Uint16Arrayj=function(){return Module.asm.__Z11Uint16Arrayj.apply(null,arguments)},__Z11Uint32Arrayt=Module.__Z11Uint32Arrayt=function(){return Module.asm.__Z11Uint32Arrayt.apply(null,arguments)},__Z11changeColorjj=Module.__Z11changeColorjj=function(){return Module.asm.__Z11changeColorjj.apply(null,arguments)},__Z11createItemsv=Module.__Z11createItemsv=function(){return Module.asm.__Z11createItemsv.apply(null,
arguments)},__Z11getBufferIDv=Module.__Z11getBufferIDv=function(){return Module.asm.__Z11getBufferIDv.apply(null,arguments)},__Z11movtableADDjjjj=Module.__Z11movtableADDjjjj=function(){return Module.asm.__Z11movtableADDjjjj.apply(null,arguments)},__Z11setupRandomi=Module.__Z11setupRandomi=function(){return Module.asm.__Z11setupRandomi.apply(null,arguments)},__Z11showrndobjsv=Module.__Z11showrndobjsv=function(){return Module.asm.__Z11showrndobjsv.apply(null,arguments)},__Z11synchroHashv=Module.__Z11synchroHashv=
function(){return Module.asm.__Z11synchroHashv.apply(null,arguments)},__Z12bufferMarginfffj=Module.__Z12bufferMarginfffj=function(){return Module.asm.__Z12bufferMarginfffj.apply(null,arguments)},__Z12deletePlayerj=Module.__Z12deletePlayerj=function(){return Module.asm.__Z12deletePlayerj.apply(null,arguments)},__Z12executeOrderjj=Module.__Z12executeOrderjj=function(){return Module.asm.__Z12executeOrderjj.apply(null,arguments)},__Z12setupIMGinfojjjjjjjjjjjjjjjjjjj=Module.__Z12setupIMGinfojjjjjjjjjjjjjjjjjjj=
function(){return Module.asm.__Z12setupIMGinfojjjjjjjjjjjjjjjjjjj.apply(null,arguments)},__Z12setupKingdomjjjjhbjjj=Module.__Z12setupKingdomjjjjhbjjj=function(){return Module.asm.__Z12setupKingdomjjjjhbjjj.apply(null,arguments)},__Z12unitObjetivej=Module.__Z12unitObjetivej=function(){return Module.asm.__Z12unitObjetivej.apply(null,arguments)},__Z13configTerrainv=Module.__Z13configTerrainv=function(){return Module.asm.__Z13configTerrainv.apply(null,arguments)},__Z13randomTerraini=Module.__Z13randomTerraini=
function(){return Module.asm.__Z13randomTerraini.apply(null,arguments)},__Z13readSavegame0j=Module.__Z13readSavegame0j=function(){return Module.asm.__Z13readSavegame0j.apply(null,arguments)},__Z13setupOnlTablej=Module.__Z13setupOnlTablej=function(){return Module.asm.__Z13setupOnlTablej.apply(null,arguments)},__Z13sharedDelayIDv=Module.__Z13sharedDelayIDv=function(){return Module.asm.__Z13sharedDelayIDv.apply(null,arguments)},__Z13sharedFloatIDv=Module.__Z13sharedFloatIDv=function(){return Module.asm.__Z13sharedFloatIDv.apply(null,
arguments)},__Z13startMovementv=Module.__Z13startMovementv=function(){return Module.asm.__Z13startMovementv.apply(null,arguments)},__Z13tempointeraddj=Module.__Z13tempointeraddj=function(){return Module.asm.__Z13tempointeraddj.apply(null,arguments)},__Z13updateRNDtypejj=Module.__Z13updateRNDtypejj=function(){return Module.asm.__Z13updateRNDtypejj.apply(null,arguments)},__Z14customMapTablev=Module.__Z14customMapTablev=function(){return Module.asm.__Z14customMapTablev.apply(null,arguments)},__Z14finishSavegamev=
Module.__Z14finishSavegamev=function(){return Module.asm.__Z14finishSavegamev.apply(null,arguments)},__Z14onlineKingdomsv=Module.__Z14onlineKingdomsv=function(){return Module.asm.__Z14onlineKingdomsv.apply(null,arguments)},__Z14randomKingdomsi=Module.__Z14randomKingdomsi=function(){return Module.asm.__Z14randomKingdomsi.apply(null,arguments)},__Z14setupResourcesjjjjt=Module.__Z14setupResourcesjjjjt=function(){return Module.asm.__Z14setupResourcesjjjjt.apply(null,arguments)},__Z15configRandomMapv=
Module.__Z15configRandomMapv=function(){return Module.asm.__Z15configRandomMapv.apply(null,arguments)},__Z15getColorTexturev=Module.__Z15getColorTexturev=function(){return Module.asm.__Z15getColorTexturev.apply(null,arguments)},__Z15setupOnlineGamePjS_j=Module.__Z15setupOnlineGamePjS_j=function(){return Module.asm.__Z15setupOnlineGamePjS_j.apply(null,arguments)},__Z15updateRNDnumberjj=Module.__Z15updateRNDnumberjj=function(){return Module.asm.__Z15updateRNDnumberjj.apply(null,arguments)},__Z16setupTranslationjj=
Module.__Z16setupTranslationjj=function(){return Module.asm.__Z16setupTranslationjj.apply(null,arguments)},__Z16updateRNDeach256jj=Module.__Z16updateRNDeach256jj=function(){return Module.asm.__Z16updateRNDeach256jj.apply(null,arguments)},__Z16updateRNDkingdomjj=Module.__Z16updateRNDkingdomjj=function(){return Module.asm.__Z16updateRNDkingdomjj.apply(null,arguments)},__Z3rndi=Module.__Z3rndi=function(){return Module.asm.__Z3rndi.apply(null,arguments)},__Z4nAIsv=Module.__Z4nAIsv=function(){return Module.asm.__Z4nAIsv.apply(null,
arguments)},__Z4testjj=Module.__Z4testjj=function(){return Module.asm.__Z4testjj.apply(null,arguments)},__Z5empXYv=Module.__Z5empXYv=function(){return Module.asm.__Z5empXYv.apply(null,arguments)},__Z5gCvalj=Module.__Z5gCvalj=function(){return Module.asm.__Z5gCvalj.apply(null,arguments)},__Z5gItemj=Module.__Z5gItemj=function(){return Module.asm.__Z5gItemj.apply(null,arguments)},__Z5gManaj=Module.__Z5gManaj=function(){return Module.asm.__Z5gManaj.apply(null,arguments)},__Z5gNamej=Module.__Z5gNamej=
function(){return Module.asm.__Z5gNamej.apply(null,arguments)},__Z5gTypej=Module.__Z5gTypej=function(){return Module.asm.__Z5gTypej.apply(null,arguments)},__Z5nhlenv=Module.__Z5nhlenv=function(){return Module.asm.__Z5nhlenv.apply(null,arguments)},__Z5test2jj=Module.__Z5test2jj=function(){return Module.asm.__Z5test2jj.apply(null,arguments)},__Z5test3jj=Module.__Z5test3jj=function(){return Module.asm.__Z5test3jj.apply(null,arguments)},__Z6amountv=Module.__Z6amountv=function(){return Module.asm.__Z6amountv.apply(null,
arguments)},__Z6dbgspdj=Module.__Z6dbgspdj=function(){return Module.asm.__Z6dbgspdj.apply(null,arguments)},__Z6gBuildj=Module.__Z6gBuildj=function(){return Module.asm.__Z6gBuildj.apply(null,arguments)},__Z6gcyclev=Module.__Z6gcyclev=function(){return Module.asm.__Z6gcyclev.apply(null,arguments)},__Z6giTypej=Module.__Z6giTypej=function(){return Module.asm.__Z6giTypej.apply(null,arguments)},__Z6glevelj=Module.__Z6glevelj=function(){return Module.asm.__Z6glevelj.apply(null,arguments)},__Z6mapLocv=Module.__Z6mapLocv=
function(){return Module.asm.__Z6mapLocv.apply(null,arguments)},__Z6mwMorei=Module.__Z6mwMorei=function(){return Module.asm.__Z6mwMorei.apply(null,arguments)},__Z6mwiconv=Module.__Z6mwiconv=function(){return Module.asm.__Z6mwiconv.apply(null,arguments)},__Z6nfolenv=Module.__Z6nfolenv=function(){return Module.asm.__Z6nfolenv.apply(null,arguments)},__Z6nhcompv=Module.__Z6nhcompv=function(){return Module.asm.__Z6nhcompv.apply(null,arguments)},__Z6onlADDjjjjb=Module.__Z6onlADDjjjjb=function(){return Module.asm.__Z6onlADDjjjjb.apply(null,
arguments)},__Z6prelddv=Module.__Z6prelddv=function(){return Module.asm.__Z6prelddv.apply(null,arguments)},__Z6rdnh19mmmmmmjj=Module.__Z6rdnh19mmmmmmjj=function(){return Module.asm.__Z6rdnh19mmmmmmjj.apply(null,arguments)},__Z6runKeyjb=Module.__Z6runKeyjb=function(){return Module.asm.__Z6runKeyjb.apply(null,arguments)},__Z6sndNfov=Module.__Z6sndNfov=function(){return Module.asm.__Z6sndNfov.apply(null,arguments)},__Z6strOnlv=Module.__Z6strOnlv=function(){return Module.asm.__Z6strOnlv.apply(null,arguments)},
__Z6trraddv=Module.__Z6trraddv=function(){return Module.asm.__Z6trraddv.apply(null,arguments)},__Z6unitXFj=Module.__Z6unitXFj=function(){return Module.asm.__Z6unitXFj.apply(null,arguments)},__Z6unitYFj=Module.__Z6unitYFj=function(){return Module.asm.__Z6unitYFj.apply(null,arguments)},__Z6updownji=Module.__Z6updownji=function(){return Module.asm.__Z6updownji.apply(null,arguments)},__Z7crtStxtm=Module.__Z7crtStxtm=function(){return Module.asm.__Z7crtStxtm.apply(null,arguments)},__Z7delTexsv=Module.__Z7delTexsv=
function(){return Module.asm.__Z7delTexsv.apply(null,arguments)},__Z7empNamej=Module.__Z7empNamej=function(){return Module.asm.__Z7empNamej.apply(null,arguments)},__Z7gAttackj=Module.__Z7gAttackj=function(){return Module.asm.__Z7gAttackj.apply(null,arguments)},__Z7gHelperj=Module.__Z7gHelperj=function(){return Module.asm.__Z7gHelperj.apply(null,arguments)},__Z7gIconIDj=Module.__Z7gIconIDj=function(){return Module.asm.__Z7gIconIDj.apply(null,arguments)},__Z7getPagev=Module.__Z7getPagev=function(){return Module.asm.__Z7getPagev.apply(null,
arguments)},__Z7ghealthj=Module.__Z7ghealthj=function(){return Module.asm.__Z7ghealthj.apply(null,arguments)},__Z7mouseUpiijb=Module.__Z7mouseUpiijb=function(){return Module.asm.__Z7mouseUpiijb.apply(null,arguments)},__Z7nh19addj=Module.__Z7nh19addj=function(){return Module.asm.__Z7nh19addj.apply(null,arguments)},__Z7onldataj=Module.__Z7onldataj=function(){return Module.asm.__Z7onldataj.apply(null,arguments)},__Z7plreadyv=Module.__Z7plreadyv=function(){return Module.asm.__Z7plreadyv.apply(null,arguments)},
__Z7readSVGmmb=Module.__Z7readSVGmmb=function(){return Module.asm.__Z7readSVGmmb.apply(null,arguments)},__Z7setupGLv=Module.__Z7setupGLv=function(){return Module.asm.__Z7setupGLv.apply(null,arguments)},__Z8atlasLocv=Module.__Z8atlasLocv=function(){return Module.asm.__Z8atlasLocv.apply(null,arguments)},__Z8gControlj=Module.__Z8gControlj=function(){return Module.asm.__Z8gControlj.apply(null,arguments)},__Z8gDefencej=Module.__Z8gDefencej=function(){return Module.asm.__Z8gDefencej.apply(null,arguments)},
__Z8gKingdomj=Module.__Z8gKingdomj=function(){return Module.asm.__Z8gKingdomj.apply(null,arguments)},__Z8gManaMaxj=Module.__Z8gManaMaxj=function(){return Module.asm.__Z8gManaMaxj.apply(null,arguments)},__Z8gstartedv=Module.__Z8gstartedv=function(){return Module.asm.__Z8gstartedv.apply(null,arguments)},__Z8liveChatj=Module.__Z8liveChatj=function(){return Module.asm.__Z8liveChatj.apply(null,arguments)},__Z8mapWidthv=Module.__Z8mapWidthv=function(){return Module.asm.__Z8mapWidthv.apply(null,arguments)},
__Z8mnameaddv=Module.__Z8mnameaddv=function(){return Module.asm.__Z8mnameaddv.apply(null,arguments)},__Z8mwSelectj=Module.__Z8mwSelectj=function(){return Module.asm.__Z8mwSelectj.apply(null,arguments)},__Z8mwamounti=Module.__Z8mwamounti=function(){return Module.asm.__Z8mwamounti.apply(null,arguments)},__Z8nkingdomv=Module.__Z8nkingdomv=function(){return Module.asm.__Z8nkingdomv.apply(null,arguments)},__Z8onlCountv=Module.__Z8onlCountv=function(){return Module.asm.__Z8onlCountv.apply(null,arguments)},
__Z8savegamev=Module.__Z8savegamev=function(){return Module.asm.__Z8savegamev.apply(null,arguments)},__Z8shapointv=Module.__Z8shapointv=function(){return Module.asm.__Z8shapointv.apply(null,arguments)},__Z8touchEndjj=Module.__Z8touchEndjj=function(){return Module.asm.__Z8touchEndjj.apply(null,arguments)},__Z8userKickj=Module.__Z8userKickj=function(){return Module.asm.__Z8userKickj.apply(null,arguments)},__Z9RNDdeletej=Module.__Z9RNDdeletej=function(){return Module.asm.__Z9RNDdeletej.apply(null,arguments)},
__Z9addRNDobjv=Module.__Z9addRNDobjv=function(){return Module.asm.__Z9addRNDobjv.apply(null,arguments)},__Z9boolArrayt=Module.__Z9boolArrayt=function(){return Module.asm.__Z9boolArrayt.apply(null,arguments)},__Z9closeRoomv=Module.__Z9closeRoomv=function(){return Module.asm.__Z9closeRoomv.apply(null,arguments)},__Z9createMapi=Module.__Z9createMapi=function(){return Module.asm.__Z9createMapi.apply(null,arguments)},__Z9ginfonamejj=Module.__Z9ginfonamejj=function(){return Module.asm.__Z9ginfonamejj.apply(null,
arguments)},__Z9mouseDowniij=Module.__Z9mouseDowniij=function(){return Module.asm.__Z9mouseDowniij.apply(null,arguments)},__Z9mouseMoveii=Module.__Z9mouseMoveii=function(){return Module.asm.__Z9mouseMoveii.apply(null,arguments)},__Z9onLimits2ii=Module.__Z9onLimits2ii=function(){return Module.asm.__Z9onLimits2ii.apply(null,arguments)},__Z9randomMapv=Module.__Z9randomMapv=function(){return Module.asm.__Z9randomMapv.apply(null,arguments)},__Z9setupGamejjjjjjjjjjjj=Module.__Z9setupGamejjjjjjjjjjjj=function(){return Module.asm.__Z9setupGamejjjjjjjjjjjj.apply(null,
arguments)},__Z9setupInfojjjjjjjjjjcchhhhhhbbPjhbPbS_hthS_hth=Module.__Z9setupInfojjjjjjjjjjcchhhhhhbbPjhbPbS_hthS_hth=function(){return Module.asm.__Z9setupInfojjjjjjjjjjcchhhhhhbbPjhbPbS_hthS_hth.apply(null,arguments)},__Z9setupOdinj=Module.__Z9setupOdinj=function(){return Module.asm.__Z9setupOdinj.apply(null,arguments)},__Z9setupZoomf=Module.__Z9setupZoomf=function(){return Module.asm.__Z9setupZoomf.apply(null,arguments)},__Z9shareNamej=Module.__Z9shareNamej=function(){return Module.asm.__Z9shareNamej.apply(null,
arguments)},__Z9touchMovejj=Module.__Z9touchMovejj=function(){return Module.asm.__Z9touchMovejj.apply(null,arguments)},___errno_location=Module.___errno_location=function(){return Module.asm.___errno_location.apply(null,arguments)},_emscripten_replace_memory=Module._emscripten_replace_memory=function(){return Module.asm._emscripten_replace_memory.apply(null,arguments)},_free=Module._free=function(){return Module.asm._free.apply(null,arguments)},_llvm_bswap_i32=Module._llvm_bswap_i32=function(){return Module.asm._llvm_bswap_i32.apply(null,
arguments)},_main=Module._main=function(){return Module.asm._main.apply(null,arguments)},_malloc=Module._malloc=function(){return Module.asm._malloc.apply(null,arguments)},_memcpy=Module._memcpy=function(){return Module.asm._memcpy.apply(null,arguments)},_memset=Module._memset=function(){return Module.asm._memset.apply(null,arguments)},_sbrk=Module._sbrk=function(){return Module.asm._sbrk.apply(null,arguments)},establishStackSpace=Module.establishStackSpace=function(){return Module.asm.establishStackSpace.apply(null,
arguments)},stackAlloc=Module.stackAlloc=function(){return Module.asm.stackAlloc.apply(null,arguments)},stackRestore=Module.stackRestore=function(){return Module.asm.stackRestore.apply(null,arguments)},stackSave=Module.stackSave=function(){return Module.asm.stackSave.apply(null,arguments)},dynCall_ii=Module.dynCall_ii=function(){return Module.asm.dynCall_ii.apply(null,arguments)},dynCall_iii=Module.dynCall_iii=function(){return Module.asm.dynCall_iii.apply(null,arguments)},dynCall_iiii=Module.dynCall_iiii=
function(){return Module.asm.dynCall_iiii.apply(null,arguments)},dynCall_iiiii=Module.dynCall_iiiii=function(){return Module.asm.dynCall_iiiii.apply(null,arguments)},dynCall_v=Module.dynCall_v=function(){return Module.asm.dynCall_v.apply(null,arguments)},dynCall_vi=Module.dynCall_vi=function(){return Module.asm.dynCall_vi.apply(null,arguments)},dynCall_vii=Module.dynCall_vii=function(){return Module.asm.dynCall_vii.apply(null,arguments)},dynCall_viii=Module.dynCall_viii=function(){return Module.asm.dynCall_viii.apply(null,
arguments)};Module.asm=asm;function ExitStatus(d){this.name="ExitStatus";this.message="Program terminated with exit("+d+")";this.status=d}ExitStatus.prototype=Error();ExitStatus.prototype.constructor=ExitStatus;var calledMain=!1;dependenciesFulfilled=function runCaller(){Module.calledRun||run();Module.calledRun||(dependenciesFulfilled=runCaller)};
Module.callMain=function(d){d=d||[];ensureInitRuntime();var a=d.length+1,c=stackAlloc(4*(a+1));HEAP32[c>>2]=allocateUTF8OnStack(Module.thisProgram);for(var b=1;b<a;b++)HEAP32[(c>>2)+b]=allocateUTF8OnStack(d[b-1]);HEAP32[(c>>2)+a]=0;try{var e=Module._main(a,c,0);exit(e,!0)}catch(f){f instanceof ExitStatus||("SimulateInfiniteLoop"==f?Module.noExitRuntime=!0:((d=f)&&"object"===typeof f&&f.stack&&(d=[f,f.stack]),err("exception thrown: "+d),Module.quit(1,f)))}finally{calledMain=!0}};
function run(d){function a(){if(!Module.calledRun&&(Module.calledRun=!0,!ABORT)){ensureInitRuntime();preMain();if(Module.onRuntimeInitialized)Module.onRuntimeInitialized();Module._main&&shouldRunNow&&Module.callMain(d);postRun()}}d=d||Module.arguments;0<runDependencies||(preRun(),0<runDependencies||Module.calledRun||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1);a()},1)):a()))}Module.run=run;
function exit(d,a){if(!a||!Module.noExitRuntime||0!==d){if(!Module.noExitRuntime&&(ABORT=!0,EXITSTATUS=d,exitRuntime(),Module.onExit))Module.onExit(d);Module.quit(d,new ExitStatus(d))}}function abort(d){if(Module.onAbort)Module.onAbort(d);void 0!==d?(out(d),err(d),d=JSON.stringify(d)):d="";ABORT=!0;EXITSTATUS=1;throw"abort("+d+"). Build with -s ASSERTIONS=1 for more info.";}Module.abort=abort;if(Module.preInit)for("function"==typeof Module.preInit&&(Module.preInit=[Module.preInit]);0<Module.preInit.length;)Module.preInit.pop()();
var shouldRunNow=!0;Module.noInitialRun&&(shouldRunNow=!1);Module.noExitRuntime=!0;run();var setupLoadingWorker,loadWorker,WASMready=!1,WASM={};waitingHash=emptyFunction;
var msg,sharedArr,sharedFloat3,sharedFloat4,sharedFloat,moduleLoaded=function(){WASMready=!0;for(var d=Module.asm,a=Object.keys(d),c=a.length,b="inspector71017 newUnit radar createMap falseunit synchroHash rnd setupRandom randomTerrain unitMovement test setupInfo setupKingdom shapoint Uint16Array setupTech setupRequirements boolArray AIobjetive test2 searchUnit killUnit investigateTech AIprocess setupResources unitWorking movtablexe test3 unitParameter setupGL bufferColor getBufferID setupIMGinfo atlasLoc randomMap gAttack gDefence glevel ghealth gmaxHealth gMana gItem gBuild gKingdom executeOrder shiftONOFF gType IMGdata Uint32Array getColorTexture canvasSize setupZoom setupTranslation mouseDown mouseUp sharedFloatID setupGame mouseMove gCval gManaMax giType setupOdin empXY nkingdom empName changePage gInventory gControl checkStock runKey sharedDelayID amount mwicon mwSelect mwMore mwamount createItems gIconID mouseEnter gHelper startMovement savegame finishSavegame readSavegame0 readSVG customMapTable mapWidth gcycle dbgspd randomKingdoms changeTeam changeRace userConfig onlineKingdoms setupOnlTable onlADD changeColor sndNfo tempointeradd onldata shareName mnameadd configRandomMap strOnl plready setupOnlID preldd nAIs closeRoom onlCount userKick pidkingdom deletePlayer updown tempstradd liveChat gstarted trradd nh19add nhcomp nhlen rdnh19 crtStxt configTerrain delTexs gName touchStart touchMove touchEnd showrndobjs ginfoname nfolen updateRNDtype updateRNDkingdom updateRNDnumber updateRNDeach256 addRNDobj RNDdelete".split(" "),e=
0,f=b.length;e<f;e++)for(var g=b[e],l=0;l<c;l++){var k=a[l];if(-1<k.indexOf(g)){WASM[b[e]]=d[k];break}}sharedArr=wasmi32Array(WASM.shapoint(),1024);sharedFloat=wasmFloat32Array(WASM.sharedFloatID(),5);sharedFloat3=wasmFloat32Array(WASM.sharedFloatID(),3);sharedFloat4=wasmFloat32Array(WASM.sharedFloatID(),4);writeWASMtext(WASM.userConfig(decimalColor()),17,me.name||"Guest");localStorage.webgl&&"2"!=localStorage.webgl||(gl=document.getElementById("tzar").getContext("webgl2",{antialias:!1}));gl||(gl=
gid("tzar").getContext("webgl",{antialias:!1}),webgl1=!0);me.gl=gl;moduleLoaded.waiting&&startGame();waitingHash()},writeWASMtext=function(d,a,c){d=wasmu16Array(d,a);for(var b=0;b<a;b++)d[b]=c.charCodeAt(b)},passArray=function(d){for(var a=0,c=d.length;a<c;sharedArr[a]=d[a++]);};moduleLoaded.waiting=!1;Module.postRun[0]=moduleLoaded;var inxDB=window.indexedDB.open("nh2019",me.versionInt),localDB;
inxDB.onsuccess=function(d){localDB=inxDB.result;ONDESKTOP||DBGET("basic",function(a){a=a.target.result;for(var c=cacheList(),b=0;b<c.length;b++)if(-1===a.indexOf(me.cdn+c[b])){a=document.createElement("li");gid("topLinks").appendChild(a);msg&&(a.innerHTML=msg.SAVE_GAME_CONTENT);a.onclick=downloadALL;a.id="savelocal";break}})};
inxDB.onupgradeneeded=function(d){localDB=inxDB.result;ms(localDB);localDB.objectStoreNames.contains("basic")&&localDB.deleteObjectStore("basic");localDB.objectStoreNames.contains("maps")||localDB.createObjectStore("maps",{keyPath:"id",autoIncrement:!0});localDB.objectStoreNames.contains("mapsBlobs")||localDB.createObjectStore("mapsBlobs",{keyPath:"id2",autoIncrement:!0});localDB.objectStoreNames.contains("basic")||localDB.createObjectStore("basic",{keyPath:"url"})};
var idbCache=function(d){localDB&&(localDB.transaction(["basic"],"readwrite").objectStore("basic").add(d).onsuccess=function(){})},indbSaveMap=function(d,a){var c=localDB.transaction(["maps"],"readwrite");c.objectStore("maps").add(d).onsuccess=function(){ms("done")};c=localDB.transaction(["mapsBlobs"],"readwrite");c.objectStore("mapsBlobs").add(a).onsuccess=function(){ms("done")}},DBGET=function(d,a){if(localDB){var c=localDB.transaction([d],"readonly");if(c.objectStore(d).getAllKeys)d=c.objectStore(d).getAllKeys();
else return a({target:{result:[]}});d.onsuccess=a}else a({target:{result:[]}})},DBGETID=function(d,a,c){localDB.transaction([d],"readonly").objectStore(d).get(c).onsuccess=function(b){a(b.target.result.buffer)}},DBSHOW=function(d){ms(d)},indbRead=function(){localDB&&(localDB.transaction(["maps"],"readwrite").objectStore("maps").getAll().onsuccess=showSavedMaps)},showSavedMaps=function(d){d=d.target.result;var a=d.length;if(a){var c=gid("mapcache");c.innerHTML='<tr style="font-size:23px"><td>Name</td><td>Date</td><td>'+
msg.PLAYED_TIME+"</td></tr>";for(--a;-1<a;a--){var b=d[a],e=document.createElement("tr");e.cid=b.id;var f=new Date(b.date),g=f.getHours(),l="0"+f.getMinutes();f.getSeconds();var k=f.getDate(),n=f.getMonth()+1;f=f.getFullYear();g=g+":"+l.substr(-2)+" &nbsp; &nbsp;"+k+"/"+n+"/"+f;e.onclick=loadcachemap;e.innerHTML="<td>"+(b.name||"savegame")+"</td><td>"+g+"</td><td>"+gametimestr(b.played)+"</td>";c.appendChild(e)}ms(d)}},loadcachemap=function(){var d=this.cid;localDB.transaction(["mapsBlobs"],"readwrite").objectStore("mapsBlobs").get(d).onsuccess=
loadcachemap.step2};loadcachemap.step2=function(d){d=d.target.result;var a=new FileReader;a.onload=openMapArray;a.readAsArrayBuffer(d)};var changeresources=function(d,a,c,b){d==Math.pow(2,31)-1&&(d="***");a==Math.pow(2,31)-1&&(a="***");c==Math.pow(2,31)-1&&(c="***");b==Math.pow(2,31)-1&&(b="***");mygold.innerHTML=d;mywood.innerHTML=a;myfood.innerHTML=c;mystone.innerHTML=b};var checkRules=function(d,a,c,b){},exeRuleArray=function(d,a){},mapEditor={start:function(){}},cancelAction=function(){location.hash="";setTimeout(deletehash,200);document.body.removeChild(this.parentElement.parentElement);filter0()};
mapEditor.func=function(){ms(Game.arje);if(void 0==Game.arje){filter0();gid("editorRandom").checked?Game.arje=555555*Math.random()+1:Game.arje=!1;Game.mapx=parseInt(gid("editorSize").value);Game.mapy=Game.mapx;Game.goldRes=Infinity;Game.foodRes=Infinity;Game.woodRes=Infinity;Game.stoneRes=Infinity;Game.gravity=580.9/9.8*9.8;Game.terrainType="grass";playersList=[];for(var d=0,a=parseInt(gid("editorPlayers").value);d<a;d++){for(var c="#"+(~~(16777216*Math.random())).toString(16);7>c.length;)c+="0";
playersList[d]={color:c,IA:!1,name:"Tzar "+(d+1),race:0,team:0}}document.body.removeChild(gid("mapForm"))}Game.editor=1;startGame()};
var editProps=function(d){filter1();var a=document.createElement("div"),c=document.createElement("div");a.id="unitProps";var b="<table>"+('\n<tr><td>Name </td><td><input data-prop="name" type="text" value="'+d.name+'" /></td></tr>\n<tr><td>'+msg.MISC_HEALTH3+' </td><td><input data-prop="health" type="number" value="'+d.health+'" /></td></tr>\n<tr><td>'+msg.MAXHEALTH+'</td> <td><input data-prop="maxHealth" type="number" value="'+d.maxHealth+'" /></td></tr>\n');if(d.build||d.item)if(d.item){if(d.sword||
d.shield)b+="\n<tr><td>"+msg.MISC_ATTACK3+'</td><td><input data-prop="attack" type="number" value="'+(d.attack||0)+'" /></td></tr>\n<tr><td>'+msg.MISC_DEFENCE3+'</td> <td><input data-prop="defence" type="number" value="'+(d.defence||0)+'" /></td></tr>\n'}else d.kingdom&&(b+="<tr><td>"+msg.MISC_KINGDOM3+' </td><td><select id="selectKingdom2">'+gid("selectKingdom").innerHTML+"</select></td></tr>");else b+="\n<tr><td>"+msg.MISC_ATTACK3+'</td><td><input data-prop="attack" type="number" value="'+(d.attack||
0)+'" /></td></tr>\n<tr><td>'+msg.MISC_DEFENCE3+'</td> <td><input data-prop="defence" type="number" value="'+(d.defence||0)+'" /></td></tr>\n<tr><td>'+msg.VIEWMSG_MANNA+' <td><input data-prop="mana" type="number" value="'+(d.mana||0)+'" /></td></tr>\n<tr><td>'+msg.MISC_KINGDOM3+' </td><td><select id="selectKingdom2">'+gid("selectKingdom").innerHTML+"</select></td></tr>\n";c.innerHTML=b+"</table>";b=document.createElement("button");b.innerHTML=msg.DLG_BTNS_OK;b.onclick=function(){saveProps(d)};c.appendChild(b);
a.appendChild(c);document.body.appendChild(a);ms(d.kingdom);gid("selectKingdom2")&&(gid("selectKingdom2").value=d.kingdom)},saveProps=function(d){for(var a=gid("unitProps").getElementsByTagName("input"),c=0,b=a.length;c<b;c++)if(a[c]){var e=a[c].value;"number"==a[c].type&&(e=parseInt(e));var f=a[c].dataset.prop;d.__proto__[f]!=e&&(d[f]=e)}d.kingdom&&gid("selectKingdom2")&&(a=parseInt(gid("selectKingdom2").value),a!=d.kingdom&&d.changeKingdom(a));document.body.removeChild(gid("unitProps"));filter0()},
hdiv=function(d){gid(d).style.display="none"},sdiv=function(d){gid(d).style.display="block"},nodrag,setupSelectProcess=function(d){},changeBrushSize=function(d){Game.editor&&(d=parseInt(gid("brushSize").value)+d,d>gid("brushSize").max?gid("brushSize").value=gid("brushSize").max:1>d?gid("brushSize").value=1:gid("brushSize").value=d)},brushSize=function(){return parseInt(gid("brushSize").value)},cancelMenu=function(){ms(this);this.parentElement.parentElement.style.display="none";filter0()},htmlOptions=
{objAction:{id:"edobjAction",msg:"",func:function(){showEvent.active.type="attack";sdiv("selectionEvents");hdiv("eventZone");sdiv("unitListDiv2");gid("byButton2").style.display="inline-block";gid("byButton1").style.display="inline-block";showEvent.active.zone=void 0}},objZone:{id:"edobjAction",msg:0,func:function(){showEvent.active.type="zone";showEvent.active.to.length=0;hdiv("selectionEvents");gid("eventZone").style.display="inline-block";hdiv("byButton2");hdiv("byButton1");hdiv("unitListDiv2");
showZoneList()}}},getZone=function(d){if(d)hdiv("mapRulesWindow"),filter0(),getZone.actived=!0;else if(getZone.actived){sdiv("mapRulesWindow");filter1();d=~~(rect[0]/32);var a=~~(rect[1]/32),c=~~(rect[9]/32),b=~~(rect[10]/32);if(d<c)var e=d,f=c;else e=c,f=d;if(a<b)var g=a,l=b;else g=b,l=a;showEvent.active.zone||(showEvent.active.zone=[]);showEvent.active.zone.put([e,g,f,l]);ms(d,a,c,b);showZoneList();getZone.actived=!1}},showZoneList=function(){var d=gid("zoneList");d.innerHTML="";var a=showEvent.active.zone;
if(a)for(var c=a.length,b=0;b<c;b++){var e=a[b],f=document.createElement("div"),g=document.createElement("button");g.innerHTML="x";g.obj=e;g.pObj=a;g.spObj=!0;g.onclick=deleteParent;f.innerHTML=e[0]+"x "+e[1]+"y -> "+e[2]+"x "+e[3]+"y";f.appendChild(g);d.appendChild(f)}},spAction={moving:1},eventSubType=function(){spAction[this.value]?(hdiv("byButton2"),hdiv("byButton1"),hdiv("unitListDiv2")):(sdiv("unitListDiv2"),gid("byButton2").style.display="inline-block",gid("byButton1").style.display="inline-block");
showEvent.active.type=this.value},eventSubTypeAction=function(){spAction[this.value]?(hdiv("toButton2"),hdiv("toButton1"),hdiv("unitListDivAction2")):(sdiv("unitListDivAction2"),gid("toButton2").style.display="inline-block",gid("toButton1").style.display="inline-block");showAction.active.type=this.value},selectionAddUnit=function(d){if(d)hdiv("mapRulesWindow"),filter0(),selectionAddUnit.actived=d.button;else if(selectionAddUnit.actived){sdiv("mapRulesWindow");filter1();d=selectionAddUnit.actived.spType.active;
d="unitListDiv2"==selectionAddUnit.actived.id||"unitListDivAction2"==selectionAddUnit.actived.id?d.to:d.list;for(var a={},c=0,b=d.length;c<b;c++)a[d[c]]=1;c=0;for(b=selectionlist.length;c<b;c++)a[selectionlist[c]]||d.put(selectionlist[c]);showSelected(selectionAddUnit.actived,d);selectionAddUnit.actived=!1}},showSelected=function(d,a){d.innerHTML="";for(var c=0,b=a.length;c<b;c++){var e=document.createElement("div"),f=document.createElement("button");f.onclick=deleteParent;f.innerHTML="x";f.pObj=
a;f.spObj=!0;f.obj=a[c];e.appendChild(f);d.appendChild(e)}},showWindow=function(){showWindow.active&&(showWindow.active.className="");showWindow.active=this;this.className="spSelect";for(var d=this.parentElement.getElementsByTagName("section"),a=0,c=d.length;a<c;a++)d[a].style.display="none";this.sdiv.style.display="block"},showRule=function(){var d=this.editorRule;d.deleted||(sdiv("mapEvent"),sdiv("mapActions"),hdiv("eventOptions"),showRule.active&&(showRule.div.className=""),this.className="spSelect",
showRule.active=d,showRule.div=this,updateEditorList(d,"eventLayout"),updateEditorList(d,"actionLayout"),showEvent.div&&hdiv(showEvent.div),showEvent.div1=void 0)},showEvent=function(){var d=this.editorRule;d.deleted||(sdiv("eventOptions"),showEvent.div1&&(showEvent.div1.className=""),this.className="spSelect",showEvent.active=d,gid("selectionEvents").value=d.type,showEvent.div1=this,gid("eventOptions").value=d.name,showEvent.div=htmlOptions[d.name].id,sdiv(showEvent.div),showSelected(gid("unitListDiv"),
d.list),showSelected(gid("unitListDiv2"),d.to))},showAction=function(){var d=this.editorRule;d.deleted||(sdiv("actionOptions"),showAction.div1&&(showAction.div1.className=""),this.className="spSelect",showAction.active=d,gid("selectionActions").value=d.type,showAction.div1=this,gid("actionOptions").value=d.name,showAction.div="ed"+d.name,sdiv(showAction.div),showSelected(gid("unitListDivAction"),d.list),showSelected(gid("unitListDivAction2"),d.to))},updateEditorList=function(d,a){gid(a).innerHTML=
"";if("eventLayout"==a){d=d.events;var c=showEvent,b=showRule.active.events}else d=d.actions,c=showAction,b=showRule.active.actions;for(var e=0,f=d.length;e<f;e++){var g=document.createElement("div");showEditorList(g,d[e],c,b);gid(a).appendChild(g)}},addEvent=function(){var d=showRule.active,a={name:"objAction",list:[],to:[],type:"attack"};d.events.put(a);var c=document.createElement("div");showEditorList(c,a,showEvent,d.events);gid("eventLayout").appendChild(c);if(showEvent.div1)showEvent.div1.onclick()},
addAction=function(){var d=showRule.active,a={name:"objOrder",list:[],to:[],type:"move"};d.actions.put(a);var c=document.createElement("div");showEditorList(c,a,showAction,d.actions);gid("actionLayout").appendChild(c);if(showAction.div1)showAction.div1.onclick()},showEditorList=function(d,a,c,b){d.innerHTML=a.events?a.name:msg[a.name];d.onclick=c;d.editorRule=a;c=document.createElement("button");c.innerHTML="x";c.obj=a;c.pObj=b;c.onclick=deleteParent;d.appendChild(c)},addRule=function(){Game.rules||
(Game.rules=[]);var d={name:"Rule"+Game.rules.length,events:[],actions:[]};Game.rules.put(d);var a=document.createElement("div");showEditorList(a,d,showRule,Game.rules);gid("rulist").appendChild(a)},deleteParent=function(){this.pObj.quit(this.obj);this.obj.deleted=!0;this.parentElement.parentElement.removeChild(this.parentElement);if(!this.spObj)if(this.pObj!==Game.rules)showRule.div.onclick();else hdiv("mapEvent"),hdiv("mapActions")},editorPlayerTable=function(){var d=gid("mapPropsWindow").getElementsByTagName("table")[0];
d.innerHTML="";d.innerHTML+="<tr><td>"+msg.color+"</td><td>"+msg.MP_SEARCH_T_PL_NAME+"</td><td>"+msg.VIEWMSG_GOLD+"</td><td>"+msg.VIEWMSG_WOOD+"</td><td>"+msg.VIEWMSG_FOOD+"</td><td>"+msg.VIEWMSG_STONE+"</td><td>"+msg.AI+"</td><td>"+msg.TEAM+"</td></tr>";d.innerHTML+="<tr><td><button id='editorAdd'>+</button><button id='editorDelete'>-</button></td></tr>";gid("editorAdd").onclick=EDaddplayer;gid("editorDelete").onclick=EDdeletePlayer;d=d.getElementsByTagName("input");for(var a=0;1>a;a++){var c=8*
a;d[c].onchange=editorColor;d[c+1].onchange=editorName;d[c+2].onchange=resOnChange;d[c+3].onchange=resOnChange;d[c+4].onchange=resOnChange;d[c+5].onchange=resOnChange;d[c+2].res=0;d[c+3].res=1;d[c+4].res=2;d[c+5].res=3;d[c+6].onchange=editorAI;d[c+6].checked=NaN.IA;d[c+7].onchange=editorTeam;d[c].team=a+1;d[c+1].team=a+1;d[c+2].team=a+1;d[c+3].team=a+1;d[c+4].team=a+1;d[c+5].team=a+1;d[c+6].team=a+1;d[c+7].team=a+1}},resOnChange=function(){},EDaddplayer=function(){},EDdeletePlayer=function(){},editorColor=
function(){},editorName=function(){},editorAI=function(){},editorTeam=function(){},rgbatorgb=function(d){for(var a=d.length,c=new Uint8Array(.75*a),b=0;b<a;b+=4){var e=.75*b;c[e]=d[b];c[e+1]=d[b+1];c[e+2]=d[b+2]}return c},cusMap,readMap=function(d){sdiv("customMapcont");gid("editCustom").style.display="inline-table";gid("closeCustom").style.display="inline-table";cusMap=d;cusMap.kingdomStart?(gid("seeStats").style.display="inline-table",gid("playrecord").style.display="inline-table"):(gid("seeStats").style.display=
"none",gid("playrecord").style.display="none");null===cusMap.goldRes&&(cusMap.goldRes=Infinity);null===cusMap.stoneRes&&(cusMap.stoneRes=Infinity);null===cusMap.foodRes&&(cusMap.foodRes=Infinity);null===cusMap.woodRes&&(cusMap.woodRes=Infinity);customMapTable();hdiv("maploadlabel");hdiv("mapcache")},customMapTable=function(d,a,c,b,e,f){ms(wasmu16Array(d,20));gid("custombody").innerHTML+="<tr>\n<td style='background:rgb("+b+","+e+","+f+')\' class="ucolor1"></td>\n<td class="username1">'+str16(wasmu16Array(d,
20))+'</td>\n<td style="display:none" class="race1">'+c+'</td>\n<td class="team1">'+a+"</td></tr>"};function sortNumberInnerHTML(d,a){return d.innerHTML-a.innerHTML}
var sumType=function(d,a){for(var c=0,b=0,e=d.length;b<e;b++)c+=a[d[b]];return c},sdecodeURI=function(d){return htmlEntities(decodeURIComponent(d))},onreadyXMR=function(d,a){d.onreadystatechange=function(){4===d.readyState&&(200===d.status?a(d):alert("Error: "+d.status))}},raceRNDchange=function(){this.types.innerHTML=optText[this.value];this.types.value=""},typeRNDchange=function(){WASM.updateRNDtype(this.rndid,this.value)},kingdomRNDchange=function(){WASM.updateRNDkingdom(this.rndid,this.value)},
numberRNDchange=function(){WASM.updateRNDnumber(this.rndid,this.value)},each256RNDchange=function(){WASM.updateRNDeach256(this.rndid,this.checked)},RNDdelete=function(){WASM.RNDdelete(this.rndid);showCustomObjs()},addRNDOBJ=function(d,a,c,b,e,f){var g=gid("rndtable"),l=document.createElement("tr");g.appendChild(l);g=document.createElement("td");var k=document.createElement("select"),n=k;k.innerHTML='<option value="0">'+races[0]+'</option><option value="1">'+races[1]+'</option><option value="2">'+
races[2]+'</option><option value="3">'+races[3]+"</option>";k.value=d;g.appendChild(k);l.appendChild(g);g=document.createElement("td");k=document.createElement("select");k.innerHTML=optText[d];k.value=a;k.rndid=f;k.onchange=typeRNDchange;n.types=k;n.onchange=raceRNDchange;g.appendChild(k);l.appendChild(g);g=document.createElement("td");k=document.createElement("input");k.value=c;k.onchange=numberRNDchange;k.type="number";k.rndid=f;g.appendChild(k);l.appendChild(g);g=document.createElement("td");d=
document.createElement("label");d.className="container";a=document.createElement("input");a.type="checkbox";a.rndid=f;a.checked=b;a.onchange=each256RNDchange;b=document.createElement("span");b.className="checkmark";d.appendChild(a);d.appendChild(b);g.appendChild(d);l.appendChild(g);b="<option value='"+(Math.pow(2,31)-1)+"'>Capturable</option>";g=0;for(d=WASM.nkingdom();g<d;g++)a=g?str16(wasmu16Array(WASM.empName(g),17)):msg.MISC_NATURE3,b+='<option value="'+g+'">'+a+"</option>";g=document.createElement("td");
k=document.createElement("select");k.innerHTML=b;k.rndid=f;k.value=e;k.onchange=kingdomRNDchange;g.appendChild(k);l.appendChild(g);g=document.createElement("td");e=document.createElement("button");e.className="closeIcon";e.onclick=RNDdelete;e.rndid=f;g.appendChild(e);l.appendChild(g)},addrndobj=function(){WASM.addRNDobj();showCustomObjs()},showCustomObjs=function(){gid("rndtable").innerHTML='<tr style="height: 57px"><td>Type</td><td>Object</td><td>Amount</td><td>Each 256\u00b2</td><td>'+msg.MISC_KINGDOM3+
"</td><td></td></tr>";WASM.showrndobjs();var d=document.createElement("tr"),a=document.createElement("td"),c=document.createElement("button");c.innerHTML=msg.ADD;c.onclick=addrndobj;a.appendChild(c);d.appendChild(a);gid("rndtable").appendChild(d)},optText,showOptions=function(){gid("mapconfiguration")||bodyPut("mapconfiguration");gid("mapconfiguration").style.display="block";gid("basic").style.filter="blur(94px)";if(""==gid("mapconfiguration").innerHTML){optText=["","","",""];for(var d=0;4>d;d++){for(var a=
"",c=0,b=WASM.nfolen();c<b;c++){var e=WASM.ginfoname(c,d);e&&(a+='<option value="'+c+'">'+msg[msgTranslator[e]].toUpperCase()+"</option>")}optText[d]=a}d="";a=["grass","trenkorian"];c=0;for(b=a.length;c<b;c++)d+='<option value="'+a[c]+'" '+(a[c]==localStorage.terrain?"selected":"")+">"+(msg[a[c]]||a[c])+"</option>";c="";"true"==localStorage.infinity&&(c="checked");gid("mapconfiguration").innerHTML='<div><button id="closeButton1" class="closeIcon"></button><table>\n<tbody>\n<tr><td>'+msg.MP_SETUPMAP_T_MAP_SIZE+
'</td><td><input id="mapwidth" type="number" value="'+localStorage.mapx+'" step="32" min="32" max="1024" /></td></tr>\n<tr><td><hr></td></tr>\n<tr><td>'+msg.MP_SETUPMAP_T_ST_RES+"</td></tr>\n<tr><td><hr></td></tr>\n<tr><td>"+msg.MISC_INF3+'</td><td><label class="container">\n  <input id="infiniteValue" type="checkbox" '+c+'>\n  <span class="checkmark"></span>\n</label></td></tr>\n<tr><td>'+msg.VIEWMSG_GOLD+'</td><td><input id="goldValue" type="number" value="'+localStorage.goldRes+'" step="250" /></td></tr>\n<tr><td>'+
msg.VIEWMSG_WOOD+'</td><td><input id="woodValue" type="number" value="'+localStorage.woodRes+'" step="250" /></td></tr>\n<tr><td>'+msg.VIEWMSG_FOOD+'</td><td><input id="foodValue" type="number" value="'+localStorage.foodRes+'" step="250" /></td></tr>\n<tr><td>'+msg.VIEWMSG_STONE+'</td><td><input id="stoneValue" type="number" value="'+localStorage.stoneRes+'" step="250" /></td></tr>\n<tr><td><hr></td></tr>\n<tr><td>'+msg.MP_SETUPMAP_T_TERRAIN+'</td></tr>\n<tr><td><select name="terrain" id="terrainSelect">\n'+
d+"\n<tr><td>"+msg.WATER+'</td><td><input type="number" value="'+localStorage.water+'" id="waterValue" min="0"/></td></tr>\n<tr><td>'+msg.INITIAL_PEASANTS+'</td><td><input type="number" value="'+localStorage.peons+'" id="peonValue" min="0"/></td></tr>\n<tr><td>'+msg.FREE_POP+'</td><td><input type="number" value="'+localStorage.freePop+'" id="freePopValue" /></td></tr>\n</select>\n</td>\n</tr>\n</tbody>\n</table>\n<hr style="margin: 25px">\n<table>\n<tbody id="rndtable">\n</tbody>\n</div>';showCustomObjs();
gid("infiniteValue").onchange=function(){var a=this.checked;gid("goldValue").disabled=a;gid("stoneValue").disabled=a;gid("woodValue").disabled=a;gid("foodValue").disabled=a};gid("infiniteValue").onchange();gid("closeButton1").onclick=function(){Game.online&&SetupGameConfig();gid("mapconfiguration").style.display="none";filter0()}}};gid("returnmenu").onclick=returnMenu;
var setupSettings=function(){var d=gid("Settings");if(""==d.innerHTML){var a=document.createElement("h2");a.innerHTML=msg.MP_MPLAYER_SETTINGS;d.appendChild(a);a=document.createElement("div");var c=document.createElement("span");c.innerHTML=msg.COLOUR;a.appendChild(c);var b=document.createElement("input");b.type="color";b.value=localStorage.color;b.onchange=localStorageInput;b.localProp="color";b.style.backgroundColor=localStorage.color;a.appendChild(b);c=document.createElement("span");c.innerHTML=
msg.MP_SEARCH_T_PL_NAME;a.appendChild(c);b=document.createElement("input");b.type="text";b.value=ihtmlEntities(localStorage.name);b.onchange=localStorageInput;b.localProp="name";a.appendChild(b);c=document.createElement("span");c.innerHTML=msg.LANGUAGE;a.appendChild(c);c=document.createElement("select");c.innerHTML='<option value="en">English</option>\n<option value="es">Espa\u00f1ol</option>\n<option value="it">Italiano</option>\n<option value="pt">Portugu\u00eas</option>\n<option value="pl">Polski</option>\n<option value="de">Deutsch</option>\n<option value="ru">\u0420\u0443\u0441\u0441\u043a\u0438\u0439</option>\n<option value="bg">\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438</option>\n';
c.value=me.langstr;c.onchange=function(){localStorage.language=this.value;location.href=""};a.appendChild(c);c=document.createElement("span");c.innerHTML=msg.AUTOFULLSCREEN;a.appendChild(c);var e=document.createElement("label");e.className="container";c=document.createElement("span");c.className="checkmark";b=document.createElement("input");b.type="checkbox";b.checked="true"==localStorage.fullscreen?!0:!1;b.onchange=localStorageCheck;b.localProp="fullscreen";e.appendChild(b);e.appendChild(c);a.appendChild(e);
c=document.createElement("span");c.innerHTML="GPU";a.appendChild(c);c.style.marginTop="65px";c=document.createElement("select");c.innerHTML='<option value="1">WebGL 1</option>\n<option value="2">WebGL 2 (recommended)</option>\n';c.value=webgl1?1:2;c.onchange=function(){localStorage.webgl=this.value;location.href=""};a.appendChild(c);d.appendChild(a)}sdiv("returnmenu")},setupAbout=function(){var d=gid("About");""==d.innerHTML&&(d.innerHTML='<div style="text-align:center;    user-select: text;"><div class="svgnehhon" style="background-repeat: no-repeat;height:342px;background-position: center;"></div>\nFully programmed by Donov from <a href="https://nehhon.com" target="_blank">nehhon</a><p>\n<a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=ABHGGGQ4TZFA2&source=url" target="_blank"><img src="nehhon/donate.gif" /></a><p>\nContact:</p>\n<a href=\'mailto:webmaster@nehhon.com\' target="_blank">webmaster@nehhon.com</a> <br> <a href="https://twitter.com/TzaredGame" target="_blank">@TzaredGame</a>\n<p>Graphics, sound and game concept (Tzar) by Haemimont</p>\n<hr>\n<p>Special thanks to:</p>\n<img style="max-width:422px" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgODc0LjMgMzkzLjciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDg3NC4zIDM5My43OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHN0eWxlIHR5cGU9InRleHQvY3NzIj4uc3Qwe2ZpbGw6I0ZGRkZGRjt9LnN0MXtmaWxsOiNGMzgwMjA7fS5zdDJ7ZmlsbDojRkFBRTQwO308L3N0eWxlPjxnPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik03OTAuNiwyNzEuOWMtMy40LDAtNi4xLTIuNy02LjEtNi4xYzAtMy4zLDIuNy02LjEsNi4xLTYuMWMzLjMsMCw2LjEsMi43LDYuMSw2LjFDNzk2LjcsMjY5LjEsNzkzLjksMjcxLjksNzkwLjYsMjcxLjkgTTc5MC42LDI2MC45Yy0yLjcsMC00LjksMi4yLTQuOSw0LjljMCwyLjcsMi4yLDQuOSw0LjksNC45YzIuNywwLDQuOS0yLjIsNC45LTQuOUM3OTUuNSwyNjMuMSw3OTMuMywyNjAuOSw3OTAuNiwyNjAuOSBNNzkzLjcsMjY5aC0xLjRsLTEuMi0yLjNoLTEuNnYyLjNoLTEuM3YtNi43aDMuMmMxLjQsMCwyLjMsMC45LDIuMywyLjJjMCwxLTAuNiwxLjctMS40LDJMNzkzLjcsMjY5eiBNNzkxLjMsMjY1LjVjMC41LDAsMS0wLjMsMS0xYzAtMC44LTAuNC0xLTEtMWgtMnYyTDc5MS4zLDI2NS41TDc5MS4zLDI2NS41eiIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iMTU1LjEsMjU5LjEgMTcwLjcsMjU5LjEgMTcwLjcsMzAxLjYgMTk3LjgsMzAxLjYgMTk3LjgsMzE1LjIgMTU1LjEsMzE1LjIgIi8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTIxMy45LDI4Ny4zdi0wLjJjMC0xNi4xLDEzLTI5LjIsMzAuMy0yOS4yczMwLjEsMTIuOSwzMC4xLDI5djAuMmMwLDE2LjEtMTMsMjkuMi0zMC4zLDI5LjJDMjI2LjcsMzE2LjMsMjEzLjksMzAzLjQsMjEzLjksMjg3LjMgTTI1OC41LDI4Ny4zdi0wLjJjMC04LjEtNS44LTE1LjEtMTQuNC0xNS4xYy04LjUsMC0xNC4yLDYuOS0xNC4yLDE1djAuMmMwLDguMSw1LjgsMTUuMSwxNC4zLDE1LjFDMjUyLjgsMzAyLjMsMjU4LjUsMjk1LjQsMjU4LjUsMjg3LjMiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjkzLjQsMjkwLjZ2LTMxLjVoMTUuOHYzMS4yYzAsOC4xLDQuMSwxMS45LDEwLjMsMTEuOXMxMC4zLTMuNywxMC4zLTExLjV2LTMxLjZoMTUuOHYzMS4xYzAsMTguMS0xMC4zLDI2LTI2LjMsMjZDMzAzLjQsMzE2LjIsMjkzLjQsMzA4LjIsMjkzLjQsMjkwLjYiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzY5LjQsMjU5LjFIMzkxYzIwLDAsMzEuNywxMS41LDMxLjcsMjcuN3YwLjJjMCwxNi4yLTExLjgsMjguMi0zMiwyOC4yaC0yMS4zTDM2OS40LDI1OS4xTDM2OS40LDI1OS4xeiBNMzkxLjMsMzAxLjRjOS4zLDAsMTUuNS01LjEsMTUuNS0xNC4ydi0wLjJjMC05LTYuMi0xNC4yLTE1LjUtMTQuMkgzODV2MjguNUgzOTEuM3oiLz48cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjQ0NS4zLDI1OS4xIDQ5MC4yLDI1OS4xIDQ5MC4yLDI3Mi43IDQ2MC44LDI3Mi43IDQ2MC44LDI4Mi4zIDQ4Ny40LDI4Mi4zIDQ4Ny40LDI5NS4yIDQ2MC44LDI5NS4yIDQ2MC44LDMxNS4yIDQ0NS4zLDMxNS4yICIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNTExLjgsMjU5LjEgNTI3LjMsMjU5LjEgNTI3LjMsMzAxLjYgNTU0LjUsMzAxLjYgNTU0LjUsMzE1LjIgNTExLjgsMzE1LjIgIi8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTU5NS4xLDI1OC43aDE1bDIzLjksNTYuNWgtMTYuN2wtNC4xLTEwaC0yMS42bC00LDEwaC0xNi4zTDU5NS4xLDI1OC43eiBNNjA4LjgsMjkzLjFsLTYuMi0xNS45bC02LjMsMTUuOUg2MDguOHoiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNNjU0LDI1OS4xaDI2LjVjOC42LDAsMTQuNSwyLjIsMTguMyw2LjFjMy4zLDMuMiw1LDcuNSw1LDEzLjF2MC4yYzAsOC42LTQuNiwxNC4zLTExLjUsMTcuMmwxMy40LDE5LjZoLTE4bC0xMS4zLTE3aC02Ljh2MTdINjU0TDY1NCwyNTkuMUw2NTQsMjU5LjF6IE02NzkuOCwyODZjNS4zLDAsOC4zLTIuNiw4LjMtNi42di0wLjJjMC00LjQtMy4yLTYuNi04LjQtNi42aC0xMC4yVjI4Nkw2NzkuOCwyODZMNjc5LjgsMjg2eiIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNzI2LjIsMjU5LjEgNzcxLjMsMjU5LjEgNzcxLjMsMjcyLjMgNzQxLjYsMjcyLjMgNzQxLjYsMjgwLjggNzY4LjUsMjgwLjggNzY4LjUsMjkzLjEgNzQxLjYsMjkzLjEgNzQxLjYsMzAyIDc3MS43LDMwMiA3NzEuNywzMTUuMiA3MjYuMiwzMTUuMiAiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTIxLjEsMjkzLjljLTIuMiw0LjktNi44LDguNC0xMi44LDguNGMtOC41LDAtMTQuMy03LjEtMTQuMy0xNS4xVjI4N2MwLTguMSw1LjctMTUsMTQuMi0xNWM2LjQsMCwxMS4zLDMuOSwxMy4zLDkuM2gxNi40Yy0yLjYtMTMuNC0xNC40LTIzLjMtMjkuNi0yMy4zYy0xNy4zLDAtMzAuMywxMy4xLTMwLjMsMjkuMnYwLjJjMCwxNi4xLDEyLjgsMjksMzAuMSwyOWMxNC44LDAsMjYuNC05LjYsMjkuNC0yMi40TDEyMS4xLDI5My45TDEyMS4xLDI5My45eiIvPjxnPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNzUyLjksMTY5LjYgNzEwLDE0NSA3MDIuNiwxNDEuOCA1MjcuMSwxNDMgNTI3LjEsMjMyLjEgNzUyLjksMjMyLjEgIi8+PHBhdGggY2xhc3M9InN0MSIgZD0iTTY3NC44LDIyMy45YzIuMS03LjIsMS4zLTEzLjgtMi4yLTE4LjdjLTMuMi00LjUtOC42LTcuMS0xNS4xLTcuNGwtMTIzLjEtMS42Yy0wLjgsMC0xLjUtMC40LTEuOS0xYy0wLjQtMC42LTAuNS0xLjQtMC4zLTIuMmMwLjQtMS4yLDEuNi0yLjEsMi45LTIuMmwxMjQuMi0xLjZjMTQuNy0wLjcsMzAuNy0xMi42LDM2LjMtMjcuMmw3LjEtMTguNWMwLjMtMC44LDAuNC0xLjYsMC4yLTIuNGMtOC0zNi4yLTQwLjMtNjMuMi03OC45LTYzLjJjLTM1LjYsMC02NS44LDIzLTc2LjYsNTQuOWMtNy01LjItMTUuOS04LTI1LjUtNy4xYy0xNy4xLDEuNy0zMC44LDE1LjQtMzIuNSwzMi41Yy0wLjQsNC40LTAuMSw4LjcsMC45LDEyLjdjLTI3LjksMC44LTUwLjIsMjMuNi01MC4yLDUxLjdjMCwyLjUsMC4yLDUsMC41LDcuNWMwLjIsMS4yLDEuMiwyLjEsMi40LDIuMWwyMjcuMiwwYzEuMywwLDIuNS0wLjksMi45LTIuMkw2NzQuOCwyMjMuOXoiLz48cGF0aCBjbGFzcz0ic3QyIiBkPSJNNzE0LDE0NC44Yy0xLjEsMC0yLjMsMC0zLjQsMC4xYy0wLjgsMC0xLjUsMC42LTEuOCwxLjRsLTQuOCwxNi43Yy0yLjEsNy4yLTEuMywxMy44LDIuMiwxOC43YzMuMiw0LjUsOC42LDcuMSwxNS4xLDcuNGwyNi4yLDEuNmMwLjgsMCwxLjUsMC40LDEuOSwxYzAuNCwwLjYsMC41LDEuNSwwLjMsMi4yYy0wLjQsMS4yLTEuNiwyLjEtMi45LDIuMmwtMjcuMywxLjZjLTE0LjgsMC43LTMwLjcsMTIuNi0zNi4zLDI3LjJsLTIsNS4xYy0wLjQsMSwwLjMsMiwxLjQsMmg5My44YzEuMSwwLDIuMS0wLjcsMi40LTEuOGMxLjYtNS44LDIuNS0xMS45LDIuNS0xOC4yQzc4MS4zLDE3NSw3NTEuMSwxNDQuOCw3MTQsMTQ0LjgiLz48L2c+PC9nPjwvc3ZnPg==" alt="cloudflare">\n</div>');
sdiv("returnmenu")},localStorageCheck=function(){ms(this,this.checked);localStorage[this.localProp]=this.checked},localStorageInput=function(){var d=this.value;"color"==this.type?this.style.backgroundColor=d:"name"==this.localProp&&(d=htmlEntities(d));me[this.localProp]=d;localStorage[this.localProp]=d},hashFunc={Multiplayer:searchGame,RandomMap:oneplayertable,MapEditor:mapEditor.start,CustomMap:custommap,Settings:setupSettings,About:setupAbout};gid("about").onclick=function(){location.hash="About"};
gid("discord").onclick=function(){window.open("https://discord.gg/ndxJHxT","_blank")};gid("mult0").onclick=function(){location.hash="Multiplayer"};gid("rnd0").onclick=function(){location.hash="RandomMap"};gid("load0").onclick=function(){location.hash="CustomMap"};gid("editor0").onclick=function(){location.hash="MapEditor"};gid("settings0").onclick=function(){location.hash="Settings"};locationhash();
