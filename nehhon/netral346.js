var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(q,T,ia){q!=Array.prototype&&q!=Object.prototype&&(q[T]=ia.value)};$jscomp.getGlobal=function(q){return"undefined"!=typeof window&&window===q?q:"undefined"!=typeof global&&null!=global?global:q};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var q=0;return function(T){return $jscomp.SYMBOL_PREFIX+(T||"")+q++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var q=$jscomp.global.Symbol.iterator;q||(q=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[q]&&$jscomp.defineProperty(Array.prototype,q,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(q){var T=0;return $jscomp.iteratorPrototype(function(){return T<q.length?{done:!1,value:q[T++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(q){$jscomp.initSymbolIterator();q={next:q};q[$jscomp.global.Symbol.iterator]=function(){return this};return q};$jscomp.iteratorFromArray=function(q,T){$jscomp.initSymbolIterator();q instanceof String&&(q+="");var ia=0,x={next:function(){if(ia<q.length){var R=ia++;return{value:T(R,q[R]),done:!1}}x.next=function(){return{done:!0,value:void 0}};return x.next()}};x[Symbol.iterator]=function(){return x};return x};
$jscomp.polyfill=function(q,T,ia,x){if(T){ia=$jscomp.global;q=q.split(".");for(x=0;x<q.length-1;x++){var R=q[x];R in ia||(ia[R]={});ia=ia[R]}q=q[q.length-1];x=ia[q];T=T(x);T!=x&&null!=T&&$jscomp.defineProperty(ia,q,{configurable:!0,writable:!0,value:T})}};$jscomp.polyfill("Array.prototype.keys",function(q){return q?q:function(){return $jscomp.iteratorFromArray(this,function(q){return q})}},"es6","es3");
$jscomp.polyfill("Object.getOwnPropertySymbols",function(q){return q?q:function(){return[]}},"es6","es5");$jscomp.findInternal=function(q,T,ia){q instanceof String&&(q=String(q));for(var x=q.length,R=0;R<x;R++){var za=q[R];if(T.call(ia,za,R,q))return{i:R,v:za}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(q){return q?q:function(q,ia){return $jscomp.findInternal(this,q,ia).v}},"es6","es3");$jscomp.owns=function(q,T){return Object.prototype.hasOwnProperty.call(q,T)};
$jscomp.polyfill("Object.assign",function(q){return q?q:function(q,ia){for(var x=1;x<arguments.length;x++){var T=arguments[x];if(T)for(var za in T)$jscomp.owns(T,za)&&(q[za]=T[za])}return q}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(q){return q?q:function(){return $jscomp.iteratorFromArray(this,function(q,ia){return ia})}},"es8","es3");$jscomp.polyfill("Math.sign",function(q){return q?q:function(q){q=Number(q);return 0===q||isNaN(q)?q:0<q?1:-1}},"es6","es3");
$jscomp.polyfill("Number.isFinite",function(q){return q?q:function(q){return"number"!==typeof q?!1:!isNaN(q)&&Infinity!==q&&-Infinity!==q}},"es6","es3");$jscomp.polyfill("Number.isInteger",function(q){return q?q:function(q){return Number.isFinite(q)?q===Math.floor(q):!1}},"es6","es3");$jscomp.makeIterator=function(q){$jscomp.initSymbolIterator();var T=q[Symbol.iterator];return T?T.call(q):$jscomp.arrayIterator(q)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(q){function T(){this.batch_=null}function ia(q){return q instanceof R?q:new R(function(x,zb){x(q)})}if(q&&!$jscomp.FORCE_POLYFILL_PROMISE)return q;T.prototype.asyncExecute=function(q){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(q);return this};T.prototype.asyncExecuteBatch_=function(){var q=this;this.asyncExecuteFunction(function(){q.executeBatch_()})};var x=$jscomp.global.setTimeout;T.prototype.asyncExecuteFunction=function(q){x(q,
0)};T.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var q=this.batch_;this.batch_=[];for(var x=0;x<q.length;++x){var R=q[x];delete q[x];try{R()}catch(Hb){this.asyncThrow_(Hb)}}}this.batch_=null};T.prototype.asyncThrow_=function(q){this.asyncExecuteFunction(function(){throw q;})};var R=function(q){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var x=this.createResolveAndReject_();try{q(x.resolve,x.reject)}catch(Nc){x.reject(Nc)}};R.prototype.createResolveAndReject_=
function(){function q(q){return function(zb){R||(R=!0,q.call(x,zb))}}var x=this,R=!1;return{resolve:q(this.resolveTo_),reject:q(this.reject_)}};R.prototype.resolveTo_=function(q){if(q===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(q instanceof R)this.settleSameAsPromise_(q);else{a:switch(typeof q){case "object":var x=null!=q;break a;case "function":x=!0;break a;default:x=!1}x?this.resolveToNonPromiseObj_(q):this.fulfill_(q)}};R.prototype.resolveToNonPromiseObj_=function(q){var x=
void 0;try{x=q.then}catch(Nc){this.reject_(Nc);return}"function"==typeof x?this.settleSameAsThenable_(x,q):this.fulfill_(q)};R.prototype.reject_=function(q){this.settle_(2,q)};R.prototype.fulfill_=function(q){this.settle_(1,q)};R.prototype.settle_=function(q,x){if(0!=this.state_)throw Error("Cannot settle("+q+", "+x|"): Promise already settled in state"+this.state_);this.state_=q;this.result_=x;this.executeOnSettledCallbacks_()};R.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var q=
this.onSettledCallbacks_,x=0;x<q.length;++x)q[x].call(),q[x]=null;this.onSettledCallbacks_=null}};var za=new T;R.prototype.settleSameAsPromise_=function(q){var x=this.createResolveAndReject_();q.callWhenSettled_(x.resolve,x.reject)};R.prototype.settleSameAsThenable_=function(q,x){var R=this.createResolveAndReject_();try{q.call(x,R.resolve,R.reject)}catch(Hb){R.reject(Hb)}};R.prototype.then=function(q,x){function T(q,x){return"function"==typeof q?function(x){try{ia(q(x))}catch(se){zb(se)}}:x}var ia,
zb,za=new R(function(q,x){ia=q;zb=x});this.callWhenSettled_(T(q,ia),T(x,zb));return za};R.prototype.catch=function(q){return this.then(void 0,q)};R.prototype.callWhenSettled_=function(q,x){function R(){switch(T.state_){case 1:q(T.result_);break;case 2:x(T.result_);break;default:throw Error("Unexpected state: "+T.state_);}}var T=this;null==this.onSettledCallbacks_?za.asyncExecute(R):this.onSettledCallbacks_.push(function(){za.asyncExecute(R)})};R.resolve=ia;R.reject=function(q){return new R(function(x,
R){R(q)})};R.race=function(q){return new R(function(x,R){for(var T=$jscomp.makeIterator(q),za=T.next();!za.done;za=T.next())ia(za.value).callWhenSettled_(x,R)})};R.all=function(q){var x=$jscomp.makeIterator(q),T=x.next();return T.done?ia([]):new R(function(q,R){function za(x){return function(R){zb[x]=R;Hb--;0==Hb&&q(zb)}}var zb=[],Hb=0;do zb.push(void 0),Hb++,ia(T.value).callWhenSettled_(za(zb.length-1),R),T=x.next();while(!T.done)})};return R},"es6","es3");
(function(){function q(k,c,e){this.context=k;this.urlList=c;this.onload=e;this.loadCount=0}function T(k,c,e){c=c.split(".")[0].toLowerCase();te[c]=k;!e||e.music&&e.mid!=Ha.id||(na(c,e.x,e.y,e.k,e.music,e.date),e.date=0)}function ia(k,c){var e=H,d;for(d=2;60>=d;d+=2){k--;c--;for(var b=0;b<=d;){if(2<Y[k+b+e*c]&&1==A[Y[k+b+e*c]].res&&fa(k+b,c))return Y[k+b+e*c];if(2<Y[k+b+e*(c+d)]&&1==A[Y[k+b+e*(c+d)]].res&&fa(k+b,c+d))return Y[k+b+e*(c+d)];b++}for(b=0;b<d-1;){b++;if(2<Y[k+e*(c+b)]&&1==A[Y[k+e*(c+b)]].res&&
fa(k,c+b))return Y[k+e*(c+b)];if(2<Y[k+d+e*(c+b)]&&1==A[Y[k+d+e*(c+b)]].res&&fa(k+d,c+b))return Y[k+d+e*(c+b)]}}return!1}function x(k,c){if(!Oc(k)){var b=k.x32,d=k.y32,h=k.sight;k.build&&(h=k.attDist);var l=H,n=2*h+1,y=n*n,E=k.id,K={};k.callList||(k.callList=[]);for(var L=0;L<y;L++){var v=L%n-h,Ca=~~(L/n)-h;if(Math.sqrt(Math.pow(v,2)+Math.pow(Ca,2))<=h){v+=b;Ca+=d;var Z=v+Ca*l;fa(v,Ca)&&(uc[Z]?(v=A[uc[Z]],K[v.id]||c||(v.callList||C(v),v.callList.put(k.id),v.callList.put(k.x32+k.y32*l),K[v.id]=1)):
uc[Z]=E)}}}}function R(){for(var k=0,c=Aa.length;k<c;Aa[k++].className="");}function za(){p("playingMenu")||ue("playingMenu");if(""==p("playingMenu").innerHTML){p("playingMenu").innerHTML='<div>\n<ul>\n<li id="backToGame">'+r.MENU_BACK+'</li>\n<li style="display:none" id="saveGameCache">'+r.save+' (cache)</li>\n<li id="saveGame">'+r.ENDGAMEDLG_SAVE+'</li>\n<li id="fullscreenmenu">'+r.FULLSCREEN+'</li>\n<li id="quitButton1">'+r.MENU_QUIT+"</li>\n</ul>\n<div>\n<span>"+r.ZOOMSPEED+' </span> <input type="range" id="zoomRange" value="'+
localStorage.zoomMult+'"/><br/>\n<span>'+r.OPTIONS_T_SS+' </span> <input type="range" id="scrollRange" value="'+localStorage.scrollSpeed+'"/>\n</div>\n<div>\n<span>'+r.OPTIONS_T_MV+'</span><br/><input type="range" id="musicRange" value="'+localStorage.musicRange+'"/><br/><br/>\n<form id="musicSelect">\n<input type="radio" name="mversion" value="originalMusic" checked /> Original<br/>\n<input type="radio" name="mversion" value="sharpRain" /> Original - <a href="https://www.youtube.com/user/rainheart666787/featured" target="_blank" rel="noopener noreferrer">Sharp Rain</a> Version<br/>\n<input type="radio" name="mversion" value="originalMusic1" /> Original - Alternative One<br/>\n<input type="radio" name="mversion" value="mute" /> Mute\n</form>\n<br />\n<span>'+
r.OPTIONS_T_SVOL+'</span><br/><input type="range" id="soundRange" value="'+localStorage.soundRange+'"/><br/>\n</div>\n</div>\n';p("quitButton1").onclick=zb;p("saveGame").onclick=Nl;p("saveGameCache").onclick=saveGameCache;p("backToGame").onclick=function(){M("playingMenu");Ab()};p("fullscreenmenu").onclick=si;p("musicRange").oninput=function(){sd.gain.value=parseInt(p("musicRange").value)/100;localStorage.musicRange=p("musicRange").value};p("zoomRange").oninput=function(){localStorage.zoomMult=p("zoomRange").value};
p("scrollRange").oninput=function(){localStorage.scrollSpeed=p("scrollRange").value};p("soundRange").oninput=function(){td.gain.value=parseInt(p("soundRange").value)/100;localStorage.soundRange=p("soundRange").value};localStorage.favMusic&&(p("musicSelect").mversion.value=localStorage.favMusic);for(var k=p("musicSelect").getElementsByTagName("input"),c=0,b=k.length;c<b;c++)k[c].onchange=Ha.reset}t.demo&&M("saveGame")||ka("saveGame");p("playingMenu").style.display="block";vc()}function zb(){location.href=
""}function Ll(k){C("setup:",k);k.toSend=[];k.orderList=[];var c=Ia.roomName;c=c.substr(0,c.length-1);k.id==c&&(k.admin=!0);k.superID=ti(k.id);k.sendDirectly("channelMessage","nehhof",{});C(k.channels.channelMessage);k.channels.channelMessage.onopen=function(){Za.put(k);na("attack");Ag(1);C("DATACHANNEL OPEN");setTimeout(function(){C(k);w.admin?(Pc(z.onlADD(0,0,parseInt(w.color.substr(1),16),k.superID,0),17,"connecting..."),z.onlineKingdoms(),Qc()):k.admin&&(Pc(z.mnameadd(),17,w.name),z.shareName(k.superID))},
500)};k.channels.channelMessage.onerror=function(k){C(k)}}function Nc(){p("buttons").innerHTML="";p("gameName").innerHTML=""}function Hb(){""==p("Multiplayer").innerHTML&&(p("Multiplayer").innerHTML="<h2>"+r.MAINSCR_MULTI.split("|")[0]+'</h2>\n<button id="createbutton">'+r.MP_SEARCH_CREATE.split("| ")[1]+'</button>\n<button id="refreshButton1" class="refreshButton">'+r.GENERAL_REFRESH+'</button>\n<table id="gameList">\n<tbody>\n<tr><td></td></tr>\n</tbody>\n</table>',p("refreshButton1").onclick=Hb,
p("createbutton").onclick=ui);w.p2p?(Ab(),w.p2p.emit("getRooms"),p("returnmenu").style.display="block"):(Ia||Bb(),Bb.func=Hb)}function qi(){var k=location,c=k.hash.substr(1);""==c&&(p("returnmenu").style.display="none");if("MatchX"==c.substr(0,6))6<c.length&&getStats(c.substr(6-c.length));else if("Room"==k.hash.substr(-4))Bg?vi():ve=vi;else if(Cg[c])if(Bg)Cg[c]();else ve=Cg[c];else k.hash=""}function zg(k){k.style.display="none"==k.style.display?"block":"none"}function Ml(k){return g.locateFile?g.locateFile(k,
Nb):Nb+k}function yg(k,c){k||Ra("Assertion failed: "+c)}function ri(k,c,b){var d=c+b;for(b=c;k[b]&&!(b>=d);)++b;if(16<b-c&&k.subarray&&wi)return wi.decode(k.subarray(c,b));for(d="";c<b;){var e=k[c++];if(e&128){var l=k[c++]&63;if(192==(e&224))d+=String.fromCharCode((e&31)<<6|l);else{var n=k[c++]&63;e=224==(e&240)?(e&15)<<12|l<<6|n:(e&7)<<18|l<<12|n<<6|k[c++]&63;65536>e?d+=String.fromCharCode(e):(e-=65536,d+=String.fromCharCode(55296|e>>10,56320|e&1023))}}else d+=String.fromCharCode(e)}return d}function se(k){for(var c=
0,b=0;b<k.length;++b){var d=k.charCodeAt(b);55296<=d&&57343>=d&&(d=65536+((d&1023)<<10)|k.charCodeAt(++b)&1023);127>=d?++c:c=2047>=d?c+2:65535>=d?c+3:c+4}var h=c+1;c=xi(h);b=yi;d=c;if(0<h){h=d+h-1;for(var l=0;l<k.length;++l){var n=k.charCodeAt(l);if(55296<=n&&57343>=n){var y=k.charCodeAt(++l);n=65536+((n&1023)<<10)|y&1023}if(127>=n){if(d>=h)break;b[d++]=n}else{if(2047>=n){if(d+1>=h)break;b[d++]=192|n>>6}else{if(65535>=n){if(d+2>=h)break;b[d++]=224|n>>12}else{if(d+3>=h)break;b[d++]=240|n>>18;b[d++]=
128|n>>12&63}b[d++]=128|n>>6&63}b[d++]=128|n&63}}b[d]=0}return c}function Dg(k,c){0<k%c&&(k+=c-k%c);return k}function zi(){g.HEAP8=yi=new Int8Array(Wa);g.HEAP16=new Int16Array(Wa);g.HEAP32=gb=new Int32Array(Wa);g.HEAPU8=Rc=new Uint8Array(Wa);g.HEAPU16=new Uint16Array(Wa);g.HEAPU32=Ai=new Uint32Array(Wa);g.HEAPF32=new Float32Array(Wa);g.HEAPF64=new Float64Array(Wa)}function ud(k){for(;0<k.length;){var c=k.shift();if("function"==typeof c)c();else{var b=c.func;"number"===typeof b?void 0===c.arg?g.dynCall_v(b):
g.dynCall_vi(b,c.arg):b(void 0===c.arg?null:c.arg)}}}function Bi(k){return String.prototype.startsWith?k.startsWith("data:application/octet-stream;base64,"):0===k.indexOf("data:application/octet-stream;base64,")}function Ci(){try{if(g.wasmBinary)return new Uint8Array(g.wasmBinary);if(g.readBinary)return g.readBinary(dc);throw"both async and sync fetching of the wasm failed";}catch(k){Ra(k)}}function Ol(){return g.wasmBinary||!vd&&!wc||"function"!==typeof fetch?new Promise(function(k,c){k(Ci())}):
fetch(dc,{credentials:"same-origin"}).then(function(k){if(!k.ok)throw"failed to load wasm binary file at '"+dc+"'";return k.arrayBuffer()}).catch(function(){return Ci()})}function Pl(k){function c(k,c){g.asm=k.exports;xc--;g.monitorRunDependencies&&g.monitorRunDependencies(xc);0==xc&&(null!==Eg&&(clearInterval(Eg),Eg=null),wd&&(k=wd,wd=null,k()))}function b(k){c(k.instance)}function d(k){Ol().then(function(k){return WebAssembly.instantiate(k,h)}).then(k,function(k){Ob("failed to asynchronously prepare wasm: "+
k);Ra(k)})}var h={env:k,global:{NaN:NaN,Infinity:Infinity},"global.Math":Math,asm2wasm:Ql};xc++;g.monitorRunDependencies&&g.monitorRunDependencies(xc);if(g.instantiateWasm)try{return g.instantiateWasm(h,c)}catch(l){return Ob("Module.instantiateWasm callback failed with error: "+l),!1}g.wasmBinary||"function"!==typeof WebAssembly.instantiateStreaming||Bi(dc)||"function"!==typeof fetch?d(b):WebAssembly.instantiateStreaming(fetch(dc,{credentials:"same-origin"}),h).then(b,function(k){Ob("wasm streaming compile failed: "+
k);Ob("falling back to ArrayBuffer instantiation");d(b)});return{}}function Di(){return!!Di.uncaught_exception}function Ei(k){try{return Rl(k)}catch(c){}}function xd(){var k=$a.last;if(!k)return Sc=0;var c=$a.infos[k],b=c.type;if(!b)return Sc=0,k|0;var d=Array.prototype.slice.call(arguments);g.___cxa_is_pointer_type(b);xd.buffer||(xd.buffer=Sl(4));gb[xd.buffer>>2]=k;k=xd.buffer;for(var h=0;h<d.length;h++)if(d[h]&&g.___cxa_can_catch(d[h],b,k))return k=gb[k>>2],c.adjusted.push(k),Sc=d[h],k|0;k=gb[k>>
2];Sc=b;return k|0}function Fi(){Ra()}function Gi(k){k=Dg(k,65536);var c=g.buffer.byteLength;try{return-1!==we.grow((k-c)/65536)?g.buffer=we.buffer:null}catch(e){return null}}function Tc(k){this.name="ExitStatus";this.message="Program terminated with exit("+k+")";this.status=k}function Fg(k){function c(){if(!g.calledRun&&(g.calledRun=!0,!Gg)){xe||(xe=!0,ud(Hg));ud(Tl);if(g.onRuntimeInitialized)g.onRuntimeInitialized();g._main&&Hi&&g.callMain(k);if(g.postRun)for("function"==typeof g.postRun&&(g.postRun=
[g.postRun]);g.postRun.length;)Ii.unshift(g.postRun.shift());ud(Ii)}}k=k||g.arguments;if(!(0<xc)){if(g.preRun)for("function"==typeof g.preRun&&(g.preRun=[g.preRun]);g.preRun.length;)Ji.unshift(g.preRun.shift());ud(Ji);0<xc||g.calledRun||(g.setStatus?(g.setStatus("Running..."),setTimeout(function(){setTimeout(function(){g.setStatus("")},1);c()},1)):c())}}function Ra(k){if(g.onAbort)g.onAbort(k);void 0!==k?(Ig(k),Ob(k),k=JSON.stringify(k)):k="";Gg=!0;throw"abort("+k+"). Build with -s ASSERTIONS=1 for more info.";
}function Ul(){for(var k=Q,c=0,b=k.length;c<b;c++){var d=A[k[c]];d.build||(d.d=(d.d+1)%8,ba(d,d.img))}}function Ki(k){Pb=!1;var c=ja;c.d=k.d;ba(c,k.img);c.active=!0;hb=B[52];ye=k;document.addEventListener("mousemove",Jg);document.addEventListener("mousedown",yd)}var Xl=function(){(function(k){"object"===typeof exports&&"undefined"!==typeof module?module.exports=k():"function"===typeof define&&define.amd?define([],k):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==
typeof self?self:this).SimpleWebRTC=k()})(function(){return function h(c,b,d){function e(l,y){if(!b[l]){if(!c[l]){var E="function"==typeof require&&require;if(!y&&E)return E(l,!0);if(n)return n(l,!0);y=Error("Cannot find module '"+l+"'");throw y.code="MODULE_NOT_FOUND",y;}y=b[l]={exports:{}};c[l][0].call(y.exports,function(b){var d=c[l][1][b];return e(d?d:b)},y,y.exports,h,c,b,d)}return b[l].exports}for(var n="function"==typeof require&&require,y=0;y<d.length;y++)e(d[y]);return e}({1:[function(c,
b,d){function e(){}b.exports=function(c,b,d){function h(c,e){if(0>=h.count)throw Error("after called too many times");--h.count;c?(l=!0,b(c),b=d):0!==h.count||l||b(null,e)}var l=!1;d=d||e;h.count=c;return 0===c?b():h}},{}],2:[function(c,b,d){b.exports=function(c,b,d){var e=c.byteLength;b=b||0;d=d||e;if(c.slice)return c.slice(b,d);0>b&&(b+=e);0>d&&(d+=e);d>e&&(d=e);if(b>=e||b>=d||0===e)return new ArrayBuffer(0);c=new Uint8Array(c);e=new Uint8Array(d-b);for(var h=0;b<d;b++,h++)e[h]=c[b];return e.buffer}},
{}],3:[function(c,b,d){b.exports=function(c,b,d){var e,h=b;b={autoplay:!0,mirror:!1,muted:!1,audio:!1,disableContextMenu:!1};if(d)for(e in d)b[e]=d[e];h?"audio"===h.tagName.toLowerCase()&&(b.audio=!0):h=document.createElement(b.audio?"audio":"video");b.disableContextMenu&&(h.oncontextmenu=function(c){c.preventDefault()});b.autoplay&&(h.autoplay="autoplay");b.muted&&(h.muted=!0);!b.audio&&b.mirror&&["","moz","webkit","o","ms"].forEach(function(c){h.style[c?c+"Transform":"transform"]="scaleX(-1)"});
h.srcObject=c;return h}},{}],4:[function(c,b,d){function e(c){c=c||{};this.ms=c.min||100;this.max=c.max||1E4;this.factor=c.factor||2;this.jitter=0<c.jitter&&1>=c.jitter?c.jitter:0;this.attempts=0}b.exports=e;e.prototype.duration=function(){var c=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),d=Math.floor(b*this.jitter*c);c=0==(Math.floor(10*b)&1)?c-d:c+d}return Math.min(c,this.max)|0};e.prototype.reset=function(){this.attempts=0};e.prototype.setMin=function(c){this.ms=
c};e.prototype.setMax=function(c){this.max=c};e.prototype.setJitter=function(c){this.jitter=c}},{}],5:[function(c,b,d){(function(c){d.encode=function(b){b=new Uint8Array(b);var d,e=b.length,h="";for(d=0;d<e;d+=3)h+=c[b[d]>>2],h+=c[(b[d]&3)<<4|b[d+1]>>4],h+=c[(b[d+1]&15)<<2|b[d+2]>>6],h+=c[b[d+2]&63];2===e%3?h=h.substring(0,h.length-1)+"=":1===e%3&&(h=h.substring(0,h.length-2)+"==");return h};d.decode=function(b){var d=.75*b.length,e=b.length,h=0;"="===b[b.length-1]&&(d--,"="===b[b.length-2]&&d--);
var l=new ArrayBuffer(d),L=new Uint8Array(l);for(d=0;d<e;d+=4){var v=c.indexOf(b[d]);var Ca=c.indexOf(b[d+1]);var Z=c.indexOf(b[d+2]);var ze=c.indexOf(b[d+3]);L[h++]=v<<2|Ca>>4;L[h++]=(Ca&15)<<4|Z>>2;L[h++]=(Z&3)<<6|ze&63}return l}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],6:[function(c,b,d){(function(c){function d(c){for(var b=0;b<c.length;b++){var d=c[b];if(d.buffer instanceof ArrayBuffer){var e=d.buffer;if(d.byteLength!==e.byteLength){var h=new Uint8Array(d.byteLength);
h.set(new Uint8Array(e,d.byteOffset,d.byteLength));e=h.buffer}c[b]=e}}}function e(c,b){b=b||{};var e=new E;d(c);for(var h=0;h<c.length;h++)e.append(c[h]);return b.type?e.getBlob(b.type):e.getBlob()}function h(c,b){d(c);return new Blob(c,b||{})}var E=c.BlobBuilder||c.WebKitBlobBuilder||c.MSBlobBuilder||c.MozBlobBuilder;try{var K=2===(new Blob(["hi"])).size}catch(Ca){K=!1}var L;if(L=K)try{L=2===(new Blob([new Uint8Array([1,2])])).size}catch(Ca){L=!1}var v=E&&E.prototype.append&&E.prototype.getBlob;
c=K?L?c.Blob:h:v?e:void 0;b.exports=c}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],7:[function(c,b,d){var e=[].slice;b.exports=function(c,b){"string"==typeof b&&(b=c[b]);if("function"!=typeof b)throw Error("bind() requires a function");var d=e.call(arguments,2);return function(){return b.apply(c,d.concat(e.call(arguments)))}}},{}],8:[function(c,b,d){function e(c){if(c){for(var b in e.prototype)c[b]=e.prototype[b];return c}}
b.exports=e;e.prototype.on=e.prototype.addEventListener=function(c,b){this._callbacks=this._callbacks||{};(this._callbacks[c]=this._callbacks[c]||[]).push(b);return this};e.prototype.once=function(c,b){function d(){e.off(c,d);b.apply(this,arguments)}var e=this;this._callbacks=this._callbacks||{};d.fn=b;this.on(c,d);return this};e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(c,b){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks=
{},this;var d=this._callbacks[c];if(!d)return this;if(1==arguments.length)return delete this._callbacks[c],this;for(var e,h=0;h<d.length;h++)if(e=d[h],e===b||e.fn===b){d.splice(h,1);break}return this};e.prototype.emit=function(c){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),d=this._callbacks[c];if(d){d=d.slice(0);for(var e=0,h=d.length;e<h;++e)d[e].apply(this,b)}return this};e.prototype.listeners=function(c){this._callbacks=this._callbacks||{};return this._callbacks[c]||[]};
e.prototype.hasListeners=function(c){return!!this.listeners(c).length}},{}],9:[function(c,b,d){b.exports=function(c,b){var d=function(){};d.prototype=b.prototype;c.prototype=new d;c.prototype.constructor=c}},{}],10:[function(c,b,d){function e(c){return e.enabled(c)?function(b){b instanceof Error&&(b=b.stack||b.message);var d=new Date,h=d-(e[c]||d);e[c]=d;b=c+" "+b+" +"+e.humanize(h);window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}b.exports=e;
e.names=[];e.skips=[];e.enable=function(c){try{localStorage.debug=c}catch(K){}for(var b=(c||"").split(/[\s,]+/),d=b.length,h=0;h<d;h++)c=b[h].replace("*",".*?"),"-"===c[0]?e.skips.push(new RegExp("^"+c.substr(1)+"$")):e.names.push(new RegExp("^"+c+"$"))};e.disable=function(){e.enable("")};e.humanize=function(c){return 36E5<=c?(c/36E5).toFixed(1)+"h":6E4<=c?(c/6E4).toFixed(1)+"m":1E3<=c?(c/1E3|0)+"s":c+"ms"};e.enabled=function(c){for(var b=0,d=e.skips.length;b<d;b++)if(e.skips[b].test(c))return!1;
b=0;for(d=e.names.length;b<d;b++)if(e.names[b].test(c))return!0;return!1};try{window.localStorage&&e.enable(localStorage.debug)}catch(l){}},{}],11:[function(c,b,d){b.exports=c("./lib/")},{"./lib/":12}],12:[function(c,b,d){b.exports=c("./socket");b.exports.parser=c("engine.io-parser")},{"./socket":13,"engine.io-parser":24}],13:[function(c,b,d){(function(d){function e(c,b){if(!(this instanceof e))return new e(c,b);b=b||{};c&&"object"==typeof c&&(b=c,c=null);c&&(c=v(c),b.host=c.host,b.secure="https"==
c.protocol||"wss"==c.protocol,b.port=c.port,c.query&&(b.query=c.query));this.secure=null!=b.secure?b.secure:d.location&&"https:"==location.protocol;b.host&&(c=b.host.split(":"),b.hostname=c.shift(),c.length?b.port=c.pop():b.port||(b.port=this.secure?"443":"80"));this.agent=b.agent||!1;this.hostname=b.hostname||(d.location?location.hostname:"localhost");this.port=b.port||(d.location&&location.port?location.port:this.secure?443:80);this.query=b.query||{};"string"==typeof this.query&&(this.query=Z.decode(this.query));
this.upgrade=!1!==b.upgrade;this.path=(b.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!b.forceJSONP;this.jsonp=!1!==b.jsonp;this.forceBase64=!!b.forceBase64;this.enablesXDR=!!b.enablesXDR;this.timestampParam=b.timestampParam||"t";this.timestampRequests=b.timestampRequests;this.transports=b.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.callbackBuffer=[];this.policyPort=b.policyPort||843;this.rememberUpgrade=b.rememberUpgrade||!1;this.binaryType=null;
this.onlyBinaryUpgrades=b.onlyBinaryUpgrades;this.pfx=b.pfx||null;this.key=b.key||null;this.passphrase=b.passphrase||null;this.cert=b.cert||null;this.ca=b.ca||null;this.ciphers=b.ciphers||null;this.rejectUnauthorized=b.rejectUnauthorized||null;this.open()}var h=c("./transports"),y=c("component-emitter"),E=c("debug")("engine.io-client:socket"),K=c("indexof"),L=c("engine.io-parser"),v=c("parseuri"),Ca=c("parsejson"),Z=c("parseqs");b.exports=e;e.priorWebsocketSuccess=!1;y(e.prototype);e.protocol=L.protocol;
e.Socket=e;e.Transport=c("./transport");e.transports=c("./transports");e.parser=c("engine.io-parser");e.prototype.createTransport=function(c){E('creating transport "%s"',c);var b=this.query,d={},e;for(e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);d.EIO=L.protocol;d.transport=c;this.id&&(d.sid=this.id);return new h[c]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:d,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,
timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})};e.prototype.open=function(){if(this.rememberUpgrade&&e.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))var c="websocket";else{if(0==this.transports.length){var b=this;setTimeout(function(){b.emit("error","No transports available")},
0);return}c=this.transports[0]}this.readyState="opening";try{c=this.createTransport(c)}catch(Kg){this.transports.shift();this.open();return}c.open();this.setTransport(c)};e.prototype.setTransport=function(c){E("setting transport %s",c.name);var b=this;this.transport&&(E("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=c;c.on("drain",function(){b.onDrain()}).on("packet",function(c){b.onPacket(c)}).on("error",function(c){b.onError(c)}).on("close",
function(){b.onClose("transport close")})};e.prototype.probe=function(c){function b(){if(Z.onlyBinaryUpgrades){var b=!this.supportsBinary&&Z.transport.supportsBinary;K=K||b}K||(E('probe transport "%s" opened',c),v.send([{type:"ping",data:"probe"}]),v.once("packet",function(b){K||("pong"==b.type&&"probe"==b.data?(E('probe transport "%s" pong',c),Z.upgrading=!0,Z.emit("upgrading",v),v&&(e.priorWebsocketSuccess="websocket"==v.name,E('pausing current transport "%s"',Z.transport.name),Z.transport.pause(function(){K||
"closed"==Z.readyState||(E("changing transport and sending upgrade packet"),L(),Z.setTransport(v),v.send([{type:"upgrade"}]),Z.emit("upgrade",v),v=null,Z.upgrading=!1,Z.flush())}))):(E('probe transport "%s" failed',c),b=Error("probe error"),b.transport=v.name,Z.emit("upgradeError",b)))}))}function d(){K||(K=!0,L(),v.close(),v=null)}function h(b){var e=Error("probe error: "+b);e.transport=v.name;d();E('probe transport "%s" failed because of error: %s',c,b);Z.emit("upgradeError",e)}function l(){h("transport closed")}
function n(){h("socket closed")}function y(c){v&&c.name!=v.name&&(E('"%s" works - aborting "%s"',c.name,v.name),d())}function L(){v.removeListener("open",b);v.removeListener("error",h);v.removeListener("close",l);Z.removeListener("close",n);Z.removeListener("upgrading",y)}E('probing transport "%s"',c);var v=this.createTransport(c,{probe:1}),K=!1,Z=this;e.priorWebsocketSuccess=!1;v.once("open",b);v.once("error",h);v.once("close",l);this.once("close",n);this.once("upgrading",y);v.open()};e.prototype.onOpen=
function(){E("socket open");this.readyState="open";e.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){E("starting upgrade probes");for(var c=0,b=this.upgrades.length;c<b;c++)this.probe(this.upgrades[c])}};e.prototype.onPacket=function(c){if("opening"==this.readyState||"open"==this.readyState)switch(E('socket receive: type "%s", data "%s"',c.type,c.data),this.emit("packet",c),this.emit("heartbeat"),
c.type){case "open":this.onHandshake(Ca(c.data));break;case "pong":this.setPing();break;case "error":var b=Error("server error");b.code=c.data;this.emit("error",b);break;case "message":this.emit("data",c.data),this.emit("message",c.data)}else E('packet received with socket readyState "%s"',this.readyState)};e.prototype.onHandshake=function(c){this.emit("handshake",c);this.id=c.sid;this.transport.query.sid=c.sid;this.upgrades=this.filterUpgrades(c.upgrades);this.pingInterval=c.pingInterval;this.pingTimeout=
c.pingTimeout;this.onOpen();"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};e.prototype.onHeartbeat=function(c){clearTimeout(this.pingTimeoutTimer);var b=this;b.pingTimeoutTimer=setTimeout(function(){if("closed"!=b.readyState)b.onClose("ping timeout")},c||b.pingInterval+b.pingTimeout)};e.prototype.setPing=function(){var c=this;clearTimeout(c.pingIntervalTimer);c.pingIntervalTimer=setTimeout(function(){E("writing ping packet - expecting pong within %sms",
c.pingTimeout);c.ping();c.onHeartbeat(c.pingTimeout)},c.pingInterval)};e.prototype.ping=function(){this.sendPacket("ping")};e.prototype.onDrain=function(){for(var c=0;c<this.prevBufferLen;c++)if(this.callbackBuffer[c])this.callbackBuffer[c]();this.writeBuffer.splice(0,this.prevBufferLen);this.callbackBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0==this.writeBuffer.length?this.emit("drain"):this.flush()};e.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&
this.writeBuffer.length&&(E("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};e.prototype.write=e.prototype.send=function(c,b){this.sendPacket("message",c,b);return this};e.prototype.sendPacket=function(c,b,d){"closing"!=this.readyState&&"closed"!=this.readyState&&(c={type:c,data:b},this.emit("packetCreate",c),this.writeBuffer.push(c),this.callbackBuffer.push(d),this.flush())};e.prototype.close=
function(){if("opening"==this.readyState||"open"==this.readyState){var c=function(){e.once("upgrade",b);e.once("upgradeError",b)},b=function(){e.removeListener("upgrade",b);e.removeListener("upgradeError",b);d()},d=function(){e.onClose("forced close");E("socket closing - telling transport to close");e.transport.close()};this.readyState="closing";var e=this;if(this.writeBuffer.length)this.once("drain",function(){this.upgrading?c():d()});else this.upgrading?c():d()}return this};e.prototype.onError=
function(c){E("socket error %j",c);e.priorWebsocketSuccess=!1;this.emit("error",c);this.onClose("transport error",c)};e.prototype.onClose=function(c,b){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){E('socket close with reason: "%s"',c);var d=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);setTimeout(function(){d.writeBuffer=[];d.callbackBuffer=[];d.prevBufferLen=0},0);this.transport.removeAllListeners("close");this.transport.close();
this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",c,b)}};e.prototype.filterUpgrades=function(c){for(var b=[],d=0,e=c.length;d<e;d++)~K(this.transports,c[d])&&b.push(c[d]);return b}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":8,debug:21,"engine.io-parser":24,indexof:32,parsejson:40,parseqs:41,parseuri:23}],14:[function(c,b,d){function e(c){this.path=
c.path;this.hostname=c.hostname;this.port=c.port;this.secure=c.secure;this.query=c.query;this.timestampParam=c.timestampParam;this.timestampRequests=c.timestampRequests;this.readyState="";this.agent=c.agent||!1;this.socket=c.socket;this.enablesXDR=c.enablesXDR;this.pfx=c.pfx;this.key=c.key;this.passphrase=c.passphrase;this.cert=c.cert;this.ca=c.ca;this.ciphers=c.ciphers;this.rejectUnauthorized=c.rejectUnauthorized}var l=c("engine.io-parser");c=c("component-emitter");b.exports=e;c(e.prototype);e.timestamps=
0;e.prototype.onError=function(c,b){c=Error(c);c.type="TransportError";c.description=b;this.emit("error",c);return this};e.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this};e.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this};e.prototype.send=function(c){if("open"==this.readyState)this.write(c);else throw Error("Transport not open");};e.prototype.onOpen=
function(){this.readyState="open";this.writable=!0;this.emit("open")};e.prototype.onData=function(c){c=l.decodePacket(c,this.socket.binaryType);this.onPacket(c)};e.prototype.onPacket=function(c){this.emit("packet",c)};e.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":8,"engine.io-parser":24}],15:[function(c,b,d){(function(b){var e=c("xmlhttprequest"),h=c("./polling-xhr"),y=c("./polling-jsonp"),E=c("./websocket");d.polling=function(c){var d=!1,l=!1,n=
!1!==c.jsonp;b.location&&(l="https:"==location.protocol,(d=location.port)||(d=l?443:80),d=c.hostname!=location.hostname||d!=c.port,l=c.secure!=l);c.xdomain=d;c.xscheme=l;if("open"in new e(c)&&!c.forceJSONP)return new h(c);if(!n)throw Error("JSONP disabled");return new y(c)};d.websocket=E}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(c,b,
d){(function(d){function e(){}function h(c){y.call(this,c);this.query=this.query||{};v||(d.___eio||(d.___eio=[]),v=d.___eio);this.index=v.length;var b=this;v.push(function(c){b.onData(c)});this.query.j=this.index;d.document&&d.addEventListener&&d.addEventListener("beforeunload",function(){b.script&&(b.script.onerror=e)},!1)}var y=c("./polling"),E=c("component-inherit");b.exports=h;var K=/\n/g,L=/\\n/g,v;E(h,y);h.prototype.supportsBinary=!1;h.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),
this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.iframe=this.form=null);y.prototype.doClose.call(this)};h.prototype.doPoll=function(){var c=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);b.async=!0;b.src=this.uri();b.onerror=function(b){c.onError("jsonp poll error",b)};var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(b,d);this.script=b;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&
setTimeout(function(){var c=document.createElement("iframe");document.body.appendChild(c);document.body.removeChild(c)},100)};h.prototype.doWrite=function(c,b){function d(){e();b()}function e(){if(h.iframe)try{h.form.removeChild(h.iframe)}catch(Mg){h.onError("jsonp polling iframe removal error",Mg)}try{E=document.createElement('<iframe src="javascript:0" name="'+h.iframeId+'">')}catch(Mg){E=document.createElement("iframe"),E.name=h.iframeId,E.src="javascript:0"}E.id=h.iframeId;h.form.appendChild(E);
h.iframe=E}var h=this;if(!this.form){var l=document.createElement("form"),n=document.createElement("textarea"),y=this.iframeId="eio_iframe_"+this.index,E;l.className="socketio";l.style.position="absolute";l.style.top="-1000px";l.style.left="-1000px";l.target=y;l.method="POST";l.setAttribute("accept-charset","utf-8");n.name="d";l.appendChild(n);document.body.appendChild(l);this.form=l;this.area=n}this.form.action=this.uri();e();c=c.replace(L,"\\\n");this.area.value=c.replace(K,"\\n");try{this.form.submit()}catch(Mg){}this.iframe.attachEvent?
this.iframe.onreadystatechange=function(){"complete"==h.iframe.readyState&&d()}:this.iframe.onload=d}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-inherit":9}],17:[function(c,b,d){(function(d){function e(){}function h(c){L.call(this,c);if(d.location){var b="https:"==location.protocol,e=location.port;e||(e=b?443:80);this.xd=c.hostname!=d.location.hostname||e!=c.port;this.xs=c.secure!=b}}function y(c){this.method=
c.method||"GET";this.uri=c.uri;this.xd=!!c.xd;this.xs=!!c.xs;this.async=!1!==c.async;this.data=void 0!=c.data?c.data:null;this.agent=c.agent;this.isBinary=c.isBinary;this.supportsBinary=c.supportsBinary;this.enablesXDR=c.enablesXDR;this.pfx=c.pfx;this.key=c.key;this.passphrase=c.passphrase;this.cert=c.cert;this.ca=c.ca;this.ciphers=c.ciphers;this.rejectUnauthorized=c.rejectUnauthorized;this.create()}function E(){for(var c in y.requests)y.requests.hasOwnProperty(c)&&y.requests[c].abort()}var K=c("xmlhttprequest"),
L=c("./polling"),v=c("component-emitter"),Ca=c("component-inherit"),Z=c("debug")("engine.io-client:polling-xhr");b.exports=h;b.exports.Request=y;Ca(h,L);h.prototype.supportsBinary=!0;h.prototype.request=function(c){c=c||{};c.uri=this.uri();c.xd=this.xd;c.xs=this.xs;c.agent=this.agent||!1;c.supportsBinary=this.supportsBinary;c.enablesXDR=this.enablesXDR;c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;
return new y(c)};h.prototype.doWrite=function(c,b){c=this.request({method:"POST",data:c,isBinary:"string"!==typeof c&&void 0!==c});var d=this;c.on("success",b);c.on("error",function(c){d.onError("xhr post error",c)});this.sendXhr=c};h.prototype.doPoll=function(){Z("xhr poll");var c=this.request(),b=this;c.on("data",function(c){b.onData(c)});c.on("error",function(c){b.onError("xhr poll error",c)});this.pollXhr=c};v(y.prototype);y.prototype.create=function(){var c={agent:this.agent,xdomain:this.xd,
xscheme:this.xs,enablesXDR:this.enablesXDR};c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;var b=this.xhr=new K(c),e=this;try{Z("xhr open %s: %s",this.method,this.uri);b.open(this.method,this.uri,this.async);this.supportsBinary&&(b.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?b.setRequestHeader("Content-type","application/octet-stream"):b.setRequestHeader("Content-type",
"text/plain;charset=UTF-8")}catch(Lg){}"withCredentials"in b&&(b.withCredentials=!0);this.hasXDR()?(b.onload=function(){e.onLoad()},b.onerror=function(){e.onError(b.responseText)}):b.onreadystatechange=function(){if(4==b.readyState)if(200==b.status||1223==b.status)e.onLoad();else setTimeout(function(){e.onError(b.status)},0)};Z("xhr data %s",this.data);b.send(this.data)}catch(Lg){setTimeout(function(){e.onError(Lg)},0);return}d.document&&(this.index=y.requestsCount++,y.requests[this.index]=this)};
y.prototype.onSuccess=function(){this.emit("success");this.cleanup()};y.prototype.onData=function(c){this.emit("data",c);this.onSuccess()};y.prototype.onError=function(c){this.emit("error",c);this.cleanup(!0)};y.prototype.cleanup=function(c){if("undefined"!=typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=this.xhr.onerror=e:this.xhr.onreadystatechange=e;if(c)try{this.xhr.abort()}catch(Ae){}d.document&&delete y.requests[this.index];this.xhr=null}};y.prototype.onLoad=function(){try{try{var c=
this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(Kg){}var b="application/octet-stream"===c?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(Kg){this.onError(Kg)}if(null!=b)this.onData(b)};y.prototype.hasXDR=function(){return"undefined"!==typeof d.XDomainRequest&&!this.xs&&this.enablesXDR};y.prototype.abort=function(){this.cleanup()};d.document&&(y.requestsCount=0,y.requests={},d.attachEvent?d.attachEvent("onunload",E):d.addEventListener&&d.addEventListener("beforeunload",
E,!1))}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-emitter":8,"component-inherit":9,debug:21,xmlhttprequest:20}],18:[function(c,b,d){function e(c){var b=c&&c.forceBase64;if(!K||b)this.supportsBinary=!1;l.call(this,c)}var l=c("../transport"),n=c("parseqs"),y=c("engine.io-parser");d=c("component-inherit");var E=c("debug")("engine.io-client:polling");b.exports=e;var K=null!=(new (c("xmlhttprequest"))({xdomain:!1})).responseType;
d(e,l);e.prototype.name="polling";e.prototype.doOpen=function(){this.poll()};e.prototype.pause=function(c){function b(){E("paused");d.readyState="paused";c()}var d=this;this.readyState="pausing";if(this.polling||!this.writable){var e=0;this.polling&&(E("we are currently polling - waiting to pause"),e++,this.once("pollComplete",function(){E("pre-pause polling complete");--e||b()}));this.writable||(E("we are currently writing - waiting to pause"),e++,this.once("drain",function(){E("pre-pause writing complete");
--e||b()}))}else b()};e.prototype.poll=function(){E("polling");this.polling=!0;this.doPoll();this.emit("poll")};e.prototype.onData=function(c){var b=this;E("polling got data %s",c);y.decodePayload(c,this.socket.binaryType,function(c,d,e){if("opening"==b.readyState)b.onOpen();if("close"==c.type)return b.onClose(),!1;b.onPacket(c)});"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():E('ignoring poll - transport state "%s"',this.readyState))};e.prototype.doClose=
function(){function c(){E("writing close packet");b.write([{type:"close"}])}var b=this;"open"==this.readyState?(E("transport open - closing"),c()):(E("transport not open - deferring close"),this.once("open",c))};e.prototype.write=function(c){var b=this;this.writable=!1;var d=function(){b.writable=!0;b.emit("drain")};b=this;y.encodePayload(c,this.supportsBinary,function(c){b.doWrite(c,d)})};e.prototype.uri=function(){var c=this.query||{},b=this.secure?"https":"http",d="";!1!==this.timestampRequests&&
(c[this.timestampParam]=+new Date+"-"+l.timestamps++);this.supportsBinary||c.sid||(c.b64=1);c=n.encode(c);this.port&&("https"==b&&443!=this.port||"http"==b&&80!=this.port)&&(d=":"+this.port);c.length&&(c="?"+c);return b+"://"+this.hostname+d+this.path+c}},{"../transport":14,"component-inherit":9,debug:21,"engine.io-parser":24,parseqs:41,xmlhttprequest:20}],19:[function(c,b,d){function e(c){c&&c.forceBase64&&(this.supportsBinary=!1);l.call(this,c)}var l=c("../transport"),n=c("engine.io-parser"),y=
c("parseqs");d=c("component-inherit");var E=c("debug")("engine.io-client:websocket"),K=c("ws");b.exports=e;d(e,l);e.prototype.name="websocket";e.prototype.supportsBinary=!0;e.prototype.doOpen=function(){if(this.check()){var c=this.uri(),b={agent:this.agent};b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;this.ws=new K(c,void 0,b);void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.binaryType=
"arraybuffer";this.addEventListeners()}};e.prototype.addEventListeners=function(){var c=this;this.ws.onopen=function(){c.onOpen()};this.ws.onclose=function(){c.onClose()};this.ws.onmessage=function(b){c.onData(b.data)};this.ws.onerror=function(b){c.onError("websocket error",b)}};"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(e.prototype.onData=function(c){var b=this;setTimeout(function(){l.prototype.onData.call(b,c)},0)});e.prototype.write=function(c){var b=this;this.writable=
!1;for(var d=0,e=c.length;d<e;d++)n.encodePacket(c[d],this.supportsBinary,function(c){try{b.ws.send(c)}catch(Ae){E("websocket closed before onclose event")}});setTimeout(function(){b.writable=!0;b.emit("drain")},0)};e.prototype.onClose=function(){l.prototype.onClose.call(this)};e.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()};e.prototype.uri=function(){var c=this.query||{},b=this.secure?"wss":"ws",d="";this.port&&("wss"==b&&443!=this.port||"ws"==b&&80!=this.port)&&(d=
":"+this.port);this.timestampRequests&&(c[this.timestampParam]=+new Date);this.supportsBinary||(c.b64=1);c=y.encode(c);c.length&&(c="?"+c);return b+"://"+this.hostname+d+this.path+c};e.prototype.check=function(){return!!K&&!("__initialize"in K&&this.name===e.prototype.name)}},{"../transport":14,"component-inherit":9,debug:21,"engine.io-parser":24,parseqs:41,ws:66}],20:[function(c,b,d){var e=c("has-cors");b.exports=function(c){var b=c.xdomain,d=c.xscheme;c=c.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&
(!b||e))return new XMLHttpRequest}catch(E){}try{if("undefined"!=typeof XDomainRequest&&!d&&c)return new XDomainRequest}catch(E){}if(!b)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(E){}}},{"has-cors":31}],21:[function(c,b,d){function e(){try{var c=localStorage.debug}catch(n){}return c}d=b.exports=c("./debug");d.log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)};d.formatArgs=function(){var c=arguments,
b=this.useColors;c[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+c[0]+(b?"%c ":" ")+"+"+d.humanize(this.diff);if(!b)return c;b="color: "+this.color;c=[c[0],b,"color: inherit"].concat(Array.prototype.slice.call(c,1));var e=0,h=0;c[0].replace(/%[a-z%]/g,function(c){"%%"!==c&&(e++,"%c"===c&&(h=e))});c.splice(h,0,b);return c};d.save=function(c){try{null==c?localStorage.removeItem("debug"):localStorage.debug=c}catch(n){}};d.load=e;d.useColors=function(){return"WebkitAppearance"in document.documentElement.style||
window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)};d.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");d.formatters.j=function(c){return JSON.stringify(c)};d.enable(e())},{"./debug":22}],22:[function(c,b,d){d=b.exports=function(c){function b(){}function h(){var c=+new Date;h.diff=c-(l||c);h.prev=l;l=h.curr=c;null==h.useColors&&(h.useColors=d.useColors());null==
h.color&&h.useColors&&(h.color=d.colors[e++%d.colors.length]);var b=Array.prototype.slice.call(arguments);b[0]=d.coerce(b[0]);"string"!==typeof b[0]&&(b=["%o"].concat(b));var n=0;b[0]=b[0].replace(/%([a-z%])/g,function(c,e){if("%%"===c)return c;n++;e=d.formatters[e];"function"===typeof e&&(c=e.call(h,b[n]),b.splice(n,1),n--);return c});"function"===typeof d.formatArgs&&(b=d.formatArgs.apply(h,b));(h.log||d.log||console.log.bind(console)).apply(h,b)}b.enabled=!1;h.enabled=!0;var n=d.enabled(c)?h:b;
n.namespace=c;return n};d.coerce=function(c){return c instanceof Error?c.stack||c.message:c};d.disable=function(){d.enable("")};d.enable=function(c){d.save(c);for(var b=(c||"").split(/[\s,]+/),e=b.length,h=0;h<e;h++)b[h]&&(c=b[h].replace(/\*/g,".*?"),"-"===c[0]?d.skips.push(new RegExp("^"+c.substr(1)+"$")):d.names.push(new RegExp("^"+c+"$")))};d.enabled=function(c){var b;var e=0;for(b=d.skips.length;e<b;e++)if(d.skips[e].test(c))return!1;e=0;for(b=d.names.length;e<b;e++)if(d.names[e].test(c))return!0;
return!1};d.humanize=c("ms");d.names=[];d.skips=[];d.formatters={};var e=0,l},{ms:38}],23:[function(c,b,d){var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,l="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");b.exports=function(c){var b=c,d=c.indexOf("["),
h=c.indexOf("]");-1!=d&&-1!=h&&(c=c.substring(0,d)+c.substring(d,h).replace(/:/g,";")+c.substring(h,c.length));c=e.exec(c||"");for(var n={},v=14;v--;)n[l[v]]=c[v]||"";-1!=d&&-1!=h&&(n.source=b,n.host=n.host.substring(1,n.host.length-1).replace(/;/g,":"),n.authority=n.authority.replace("[","").replace("]","").replace(/;/g,":"),n.ipv6uri=!0);return n}},{}],24:[function(c,b,d){(function(b){function e(c,b,e){if(!b)return d.encodeBase64Packet(c,e);var h=new FileReader;h.onload=function(){c.data=h.result;
d.encodePacket(c,b,!0,e)};return h.readAsArrayBuffer(c.data)}function h(c,b,d){var e=Array(c.length);d=v(c.length,d);for(var h=function(c,d,h){b(d,function(b,d){e[c]=d;h(b,e)})},l=0;l<c.length;l++)h(l,c[l],d)}var y=c("./keys"),E=c("has-binary"),K=c("arraybuffer.slice"),L=c("base64-arraybuffer"),v=c("after"),Ca=c("utf8"),Z=navigator.userAgent.match(/Android/i),f=/PhantomJS/i.test(navigator.userAgent),m=Z||f;d.protocol=3;var g=d.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},p=y(g),
t={type:"error",data:"parser error"},r=c("blob");d.encodePacket=function(c,h,l,n){"function"==typeof h&&(n=h,h=!1);"function"==typeof l&&(n=l,l=null);var y=void 0===c.data?void 0:c.data.buffer||c.data;if(b.ArrayBuffer&&y instanceof ArrayBuffer){if(h){l=c.data;h=new Uint8Array(l);l=new Uint8Array(1+l.byteLength);l[0]=g[c.type];for(c=0;c<h.length;c++)l[c+1]=h[c];c=n(l.buffer)}else c=d.encodeBase64Packet(c,n);return c}if(r&&y instanceof b.Blob)return h?m?c=e(c,h,n):(h=new Uint8Array(1),h[0]=g[c.type],
c=new r([h.buffer,c.data]),c=n(c)):c=d.encodeBase64Packet(c,n),c;if(y&&y.base64)return n("b"+d.packets[c.type]+c.data.data);h=g[c.type];void 0!==c.data&&(h+=l?Ca.encode(String(c.data)):String(c.data));return n(""+h)};d.encodeBase64Packet=function(c,e){var h="b"+d.packets[c.type];if(r&&c.data instanceof r){var l=new FileReader;l.onload=function(){var c=l.result.split(",")[1];e(h+c)};return l.readAsDataURL(c.data)}try{var n=String.fromCharCode.apply(null,new Uint8Array(c.data))}catch(Mn){c=new Uint8Array(c.data);
n=Array(c.length);for(var y=0;y<c.length;y++)n[y]=c[y];n=String.fromCharCode.apply(null,n)}h+=b.btoa(n);return e(h)};d.decodePacket=function(c,b,e){if("string"==typeof c||void 0===c){if("b"==c.charAt(0))return d.decodeBase64Packet(c.substr(1),b);if(e)try{c=Ca.decode(c)}catch(Ln){return t}e=c.charAt(0);return Number(e)==e&&p[e]?1<c.length?{type:p[e],data:c.substring(1)}:{type:p[e]}:t}e=(new Uint8Array(c))[0];c=K(c,1);r&&"blob"===b&&(c=new r([c]));return{type:p[e],data:c}};d.decodeBase64Packet=function(c,
d){var e=p[c.charAt(0)];if(!b.ArrayBuffer)return{type:e,data:{base64:!0,data:c.substr(1)}};c=L.decode(c.substr(1));"blob"===d&&r&&(c=new r([c]));return{type:e,data:c}};d.encodePayload=function(c,b,e){"function"==typeof b&&(e=b,b=null);var l=E(c);if(b&&l)return r&&!m?d.encodePayloadAsBlob(c,e):d.encodePayloadAsArrayBuffer(c,e);if(!c.length)return e("0:");h(c,function(c,e){d.encodePacket(c,l?b:!1,!0,function(c){e(null,c.length+":"+c)})},function(c,b){return e(b.join(""))})};d.decodePayload=function(c,
b,e){if("string"!=typeof c)return d.decodePayloadAsBinary(c,b,e);"function"===typeof b&&(e=b,b=null);if(""==c)return e(t,0,1);var h="";for(var l,n,y=0,E=c.length;y<E;y++)if(n=c.charAt(y),":"!=n)h+=n;else{if(""==h||h!=(l=Number(h)))return e(t,0,1);n=c.substr(y+1,l);if(h!=n.length)return e(t,0,1);if(n.length){h=d.decodePacket(n,b,!0);if(t.type==h.type&&t.data==h.data)return e(t,0,1);if(!1===e(h,y+l,E))return}y+=l;h=""}if(""!=h)return e(t,0,1)};d.encodePayloadAsArrayBuffer=function(c,b){if(!c.length)return b(new ArrayBuffer(0));
h(c,function(c,b){d.encodePacket(c,!0,!0,function(c){return b(null,c)})},function(c,d){c=d.reduce(function(c,b){b="string"===typeof b?b.length:b.byteLength;return c+b.toString().length+b+2},0);var e=new Uint8Array(c),h=0;d.forEach(function(c){var b="string"===typeof c,d=c;if(b){d=new Uint8Array(c.length);for(var l=0;l<c.length;l++)d[l]=c.charCodeAt(l);d=d.buffer}b?e[h++]=0:e[h++]=1;c=d.byteLength.toString();for(l=0;l<c.length;l++)e[h++]=parseInt(c[l]);e[h++]=255;d=new Uint8Array(d);for(l=0;l<d.length;l++)e[h++]=
d[l]});return b(e.buffer)})};d.encodePayloadAsBlob=function(c,b){h(c,function(c,b){d.encodePacket(c,!0,!0,function(c){var d=new Uint8Array(1);d[0]=1;if("string"===typeof c){for(var e=new Uint8Array(c.length),h=0;h<c.length;h++)e[h]=c.charCodeAt(h);c=e.buffer;d[0]=0}e=(c instanceof ArrayBuffer?c.byteLength:c.size).toString();var l=new Uint8Array(e.length+1);for(h=0;h<e.length;h++)l[h]=parseInt(e[h]);l[e.length]=255;r&&(c=new r([d.buffer,l.buffer,c]),b(null,c))})},function(c,d){return b(new r(d))})};
d.decodePayloadAsBinary=function(c,b,e){"function"===typeof b&&(e=b,b=null);for(var h=[],l=!1;0<c.byteLength;){for(var n=new Uint8Array(c),y=0===n[0],E="",L=1;255!=n[L];L++){if(310<E.length){l=!0;break}E+=n[L]}if(l)return e(t,0,1);c=K(c,2+E.length);E=parseInt(E);n=K(c,0,E);if(y)try{n=String.fromCharCode.apply(null,new Uint8Array(n))}catch(Nn){for(y=new Uint8Array(n),n="",L=0;L<y.length;L++)n+=String.fromCharCode(y[L])}h.push(n);c=K(c,E)}var v=h.length;h.forEach(function(c,h){e(d.decodePacket(c,b,
!0),h,v)})}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./keys":25,after:1,"arraybuffer.slice":2,"base64-arraybuffer":5,blob:6,"has-binary":30,utf8:60}],25:[function(c,b,d){b.exports=Object.keys||function(c){var b=[],d=Object.prototype.hasOwnProperty,e;for(e in c)d.call(c,e)&&b.push(e);return b}},{}],26:[function(c,b,d){function e(c){n.call(this);c=c||{};this.config={chunksize:16384,pacing:0};for(var b in c)this.config[b]=
c[b];this.channel=this.file=null}function l(){n.call(this);this.receiveBuffer=[];this.received=0;this.metadata={};this.channel=null}var n=c("wildemitter");c=c("util");c.inherits(e,n);e.prototype.send=function(c,b){var d=this;this.file=c;this.channel=b;var e="number"!==typeof b.bufferedAmountLowThreshold,h=0,l=function(){var n=new window.FileReader;n.onload=function(){return function(n){d.channel.send(n.target.result);d.emit("progress",h,c.size,n.target.result);c.size>h+n.target.result.byteLength?
e?window.setTimeout(l,d.config.pacing):b.bufferedAmount<=b.bufferedAmountLowThreshold&&window.setTimeout(l,0):(d.emit("progress",c.size,c.size,null),d.emit("sentFile"));h+=d.config.chunksize}}(c);var y=c.slice(h,h+d.config.chunksize);n.readAsArrayBuffer(y)};e||(b.bufferedAmountLowThreshold=8*this.config.chunksize,b.addEventListener("bufferedamountlow",l));window.setTimeout(l,0)};c.inherits(l,n);l.prototype.receive=function(c,b){var d=this;c&&(this.metadata=c);this.channel=b;b.binaryType="arraybuffer";
this.channel.onmessage=function(c){d.received+=c.data.byteLength;d.receiveBuffer.push(c.data);d.emit("progress",d.received,d.metadata.size,c.data);d.received===d.metadata.size?(d.emit("receivedFile",new window.Blob(d.receiveBuffer),d.metadata),d.receiveBuffer=[]):d.received>d.metadata.size&&(console.error("received more than expected, discarding..."),d.receiveBuffer=[])}};b.exports={};b.exports.support="undefined"!==typeof window&&window&&window.File&&window.FileReader&&window.Blob;b.exports.Sender=
e;b.exports.Receiver=l},{util:63,wildemitter:65}],27:[function(c,b,d){var e={};b.exports=function(c,b){var d=2===arguments.length,h=d?b:c;if("undefined"===typeof window||"http:"===window.location.protocol){var l=Error("NavigatorUserMediaError");l.name="HTTPS_REQUIRED";return h(l)}if(window.navigator.userAgent.match("Chrome")){var n=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),v=33,f=!window.chrome.webstore;window.navigator.userAgent.match("Linux")&&(v=35);sessionStorage.getScreenMediaJSExtensionId?
chrome.runtime.sendMessage(sessionStorage.getScreenMediaJSExtensionId,{type:"getScreen",id:1},null,function(b){b&&""!==b.sourceId?(c=d&&c||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3}}},c.video.mandatory.chromeMediaSourceId=b.sourceId,window.navigator.mediaDevices.getUserMedia(c).then(function(c){h(null,c)}).catch(function(c){h(c)})):(b=Error("NavigatorUserMediaError"),b.name="NotAllowedError",h(b))}):window.cefGetScreenMedia?
window.cefGetScreenMedia(function(b){b?(c=d&&c||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},c.video.mandatory.chromeMediaSourceId=b,window.navigator.mediaDevices.getUserMedia(c).then(function(c){h(null,c)}).catch(function(c){h(c)})):(b=Error("cefGetScreenMediaError"),b.name="CEF_GETSCREENMEDIA_CANCELED",h(b))}):f||26<=n&&n<=v?(c=d&&c||{video:{mandatory:{googLeakyBucket:!0,
maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3,chromeMediaSource:"screen"}}},window.navigator.mediaDevices.getUserMedia(c).then(function(c){h(null,c)}).catch(function(c){h(c)})):(n=window.setTimeout(function(){l=Error("NavigatorUserMediaError");l.name="EXTENSION_UNAVAILABLE";return h(l)},1E3),e[n]=[h,d?c:null],window.postMessage({type:"getScreen",id:n},"*"))}else window.navigator.userAgent.match("Firefox")&&(33<=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],
10)?(c=d&&c||{video:{mozMediaSource:"window",mediaSource:"window"}},window.navigator.mediaDevices.getUserMedia(c).then(function(c){h(null,c);var b=c.currentTime,d=window.setInterval(function(){c||window.clearInterval(d);if(c.currentTime==b&&(window.clearInterval(d),c.onended))c.onended();b=c.currentTime},500)}).catch(function(c){h(c)})):(l=Error("NavigatorUserMediaError"),l.name="EXTENSION_UNAVAILABLE"))};"undefined"!==typeof window&&window.addEventListener("message",function(c){if(c.origin==window.location.origin)if("gotScreen"==
c.data.type&&e[c.data.id]){var b=e[c.data.id],d=b[1],h=b[0];delete e[c.data.id];""===c.data.sourceId?(c=Error("NavigatorUserMediaError"),c.name="NotAllowedError",h(c)):(d=d||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},d.video.mandatory.chromeMediaSourceId=c.data.sourceId,window.navigator.mediaDevices.getUserMedia(d).then(function(c){h(null,c)}).catch(function(c){h(c)}))}else"getScreenPending"==
c.data.type&&window.clearTimeout(c.data.id)})},{}],28:[function(c,b,d){b.exports=function(){return this}()},{}],29:[function(c,b,d){var e=c("wildemitter"),l;"undefined"!==typeof window&&(l=window.AudioContext||window.webkitAudioContext);var n=null;b.exports=function(c,b){var d=new e;if(!l)return d;b=b||{};var h=b.smoothing||.1,y=b.interval||50,E=b.threshold,Z=b.play;b=b.history||10;var f=!0;n||(n=new l);var m=n.createAnalyser();m.fftSize=512;m.smoothingTimeConstant=h;var g=new Float32Array(m.frequencyBinCount);
c.jquery&&(c=c[0]);if(c instanceof HTMLAudioElement||c instanceof HTMLVideoElement){var p=n.createMediaElementSource(c);"undefined"===typeof Z&&(Z=!0)}else p=n.createMediaStreamSource(c);E=E||-50;p.connect(m);Z&&m.connect(n.destination);d.speaking=!1;d.setThreshold=function(c){E=c};d.setInterval=function(c){y=c};d.stop=function(){f=!1;d.emit("volume_change",-100,E);d.speaking&&(d.speaking=!1,d.emit("stopped_speaking"));m.disconnect();p.disconnect()};d.speakingHistory=[];for(c=0;c<b;c++)d.speakingHistory.push(0);
var t=function(){setTimeout(function(){if(f){var c=-Infinity;m.getFloatFrequencyData(g);for(var b=4,e=g.length;b<e;b++)g[b]>c&&0>g[b]&&(c=g[b]);d.emit("volume_change",c,E);b=0;if(c>E&&!d.speaking){for(e=d.speakingHistory.length-3;e<d.speakingHistory.length;e++)b+=d.speakingHistory[e];2<=b&&(d.speaking=!0,d.emit("speaking"))}else if(c<E&&d.speaking){for(e=0;e<d.speakingHistory.length;e++)b+=d.speakingHistory[e];0==b&&(d.speaking=!1,d.emit("stopped_speaking"))}d.speakingHistory.shift();d.speakingHistory.push(0+
(c>E));t()}},y)};t();return d}},{wildemitter:65}],30:[function(c,b,d){(function(d){var e=c("isarray");b.exports=function(c){function b(c){if(!c)return!1;if(d.Buffer&&d.Buffer.isBuffer(c)||d.ArrayBuffer&&c instanceof ArrayBuffer||d.Blob&&c instanceof Blob||d.File&&c instanceof File)return!0;if(e(c))for(var h=0;h<c.length;h++){if(b(c[h]))return!0}else if(c&&"object"==typeof c)for(h in c.toJSON&&(c=c.toJSON()),c)if(Object.prototype.hasOwnProperty.call(c,h)&&b(c[h]))return!0;return!1}return b(c)}}).call(this,
"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{isarray:33}],31:[function(c,b,d){c=c("global");try{b.exports="XMLHttpRequest"in c&&"withCredentials"in new c.XMLHttpRequest}catch(h){b.exports=!1}},{global:28}],32:[function(c,b,d){var e=[].indexOf;b.exports=function(c,b){if(e)return c.indexOf(b);for(var d=0;d<c.length;++d)if(c[d]===b)return d;return-1}},{}],33:[function(c,b,d){b.exports=Array.isArray||function(c){return"[object Array]"==Object.prototype.toString.call(c)}},
{}],34:[function(c,b,d){(function(c){function b(c){if(b[c]!==E)return b[c];if("bug-string-char-index"==c)var d=!1;else if("json"==c)d=b("json-stringify")&&b("json-parse");else{var h;if("json-stringify"==c){d=L.stringify;var l="function"==typeof d&&v;if(l){(h=function(){return 1}).toJSON=h;try{l="0"===d(0)&&"0"===d(new Number)&&'""'==d(new String)&&d(e)===E&&d(E)===E&&d()===E&&"1"===d(h)&&"[1]"==d([h])&&"[null]"==d([E])&&"null"==d(null)&&"[null,null,null]"==d([E,e,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==
d({a:[h,!0,!1,null,"\x00\b\n\f\r\t"]})&&"1"===d(null,h)&&"[\n 1,\n 2\n]"==d([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==d(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==d(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==d(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==d(new Date(-1))}catch(Be){l=!1}}d=l}if("json-parse"==c){d=L.parse;if("function"==typeof d)try{if(0===d("0")&&!d(!1)){h=d('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var n=5==h.a.length&&1===h.a[0];if(n){try{n=
!d('"\t"')}catch(Be){}if(n)try{n=1!==d("01")}catch(Be){}if(n)try{n=1!==d("1.")}catch(Be){}}}}catch(Be){n=!1}d=n}}return b[c]=!!d}var e={}.toString,h,E,K="object"==typeof JSON&&JSON,L="object"==typeof d&&d&&!d.nodeType&&d;L&&K?(L.stringify=K.stringify,L.parse=K.parse):L=c.JSON=K||{};var v=new Date(-0xc782b5b800cec);try{v=-109252==v.getUTCFullYear()&&0===v.getUTCMonth()&&1===v.getUTCDate()&&10==v.getUTCHours()&&37==v.getUTCMinutes()&&6==v.getUTCSeconds()&&708==v.getUTCMilliseconds()}catch(On){}if(!b("json")){var f=
b("bug-string-char-index");if(!v)var Z=Math.floor,m=[0,31,59,90,120,151,181,212,243,273,304,334],g=function(c,b){return m[b]+365*(c-1970)+Z((c-1969+(b=+(1<b)))/4)-Z((c-1901+b)/100)+Z((c-1601+b)/400)};(h={}.hasOwnProperty)||(h=function(c){var b={};if((b.__proto__=null,b.__proto__={toString:1},b).toString!=e)h=function(c){var b=this.__proto__;c=c in(this.__proto__=null,this);this.__proto__=b;return c};else{var d=b.constructor;h=function(c){var b=(this.constructor||d).prototype;return c in this&&!(c in
b&&this[c]===b[c])}}b=null;return h.call(this,c)});var p={"boolean":1,number:1,string:1,undefined:1};var t=function(c,b){var d=0,l,n;(l=function(){this.valueOf=0}).prototype.valueOf=0;var y=new l;for(n in y)h.call(y,n)&&d++;l=y=null;d?t=2==d?function(c,b){var d={},l="[object Function]"==e.call(c),n;for(n in c)l&&"prototype"==n||h.call(d,n)||!(d[n]=1)||!h.call(c,n)||b(n)}:function(c,b){var d="[object Function]"==e.call(c),l,n;for(l in c)d&&"prototype"==l||!h.call(c,l)||(n="constructor"===l)||b(l);
(n||h.call(c,l="constructor"))&&b(l)}:(y="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),t=function(c,b){var d="[object Function]"==e.call(c),l,n;if(n=!d&&"function"!=typeof c.constructor)n=typeof c.hasOwnProperty,n="object"==n?!!c.hasOwnProperty:!p[n];n=n?c.hasOwnProperty:h;for(l in c)d&&"prototype"==l||!n.call(c,l)||b(l);for(d=y.length;l=y[--d];n.call(c,l)&&b(l));});return t(c,b)};if(!b("json-stringify")){var r={92:"\\\\",34:'\\"',8:"\\b",
12:"\\f",10:"\\n",13:"\\r",9:"\\t"},q=function(c,b){return("000000"+(b||0)).slice(-c)},A=function(c){var b='"',d=0,e=c.length,h=10<e&&f,l;for(h&&(l=c.split(""));d<e;d++){var n=c.charCodeAt(d);switch(n){case 8:case 9:case 10:case 12:case 13:case 34:case 92:b+=r[n];break;default:b=32>n?b+("\\u00"+q(2,n.toString(16))):b+(h?l[d]:f?c.charAt(d):c[d])}}return b+'"'},B=function(c,b,d,l,n,y,L){var v;try{var K=b[c]}catch(Qn){}if("object"==typeof K&&K){var f=e.call(K);if("[object Date]"!=f||h.call(K,"toJSON"))"function"==
typeof K.toJSON&&("[object Number]"!=f&&"[object String]"!=f&&"[object Array]"!=f||h.call(K,"toJSON"))&&(K=K.toJSON(c));else if(K>-1/0&&K<1/0){if(g){var Ca=Z(K/864E5);for(f=Z(Ca/365.2425)+1970-1;g(f+1,0)<=Ca;f++);for(v=Z((Ca-g(f,0))/30.42);g(f,v+1)<=Ca;v++);Ca=1+Ca-g(f,v);var m=(K%864E5+864E5)%864E5;var ze=Z(m/36E5)%24;var p=Z(m/6E4)%60;var Ae=Z(m/1E3)%60;m%=1E3}else f=K.getUTCFullYear(),v=K.getUTCMonth(),Ca=K.getUTCDate(),ze=K.getUTCHours(),p=K.getUTCMinutes(),Ae=K.getUTCSeconds(),m=K.getUTCMilliseconds();
K=(0>=f||1E4<=f?(0>f?"-":"+")+q(6,0>f?-f:f):q(4,f))+"-"+q(2,v+1)+"-"+q(2,Ca)+"T"+q(2,ze)+":"+q(2,p)+":"+q(2,Ae)+"."+q(3,m)+"Z"}else K=null}d&&(K=d.call(b,c,K));if(null===K)return"null";f=e.call(K);if("[object Boolean]"==f)return""+K;if("[object Number]"==f)return K>-1/0&&K<1/0?""+K:"null";if("[object String]"==f)return A(""+K);if("object"==typeof K){for(c=L.length;c--;)if(L[c]===K)throw TypeError();L.push(K);var r=[];b=y;y+=n;if("[object Array]"==f){v=0;for(c=K.length;v<c;v++)f=B(v,K,d,l,n,y,L),r.push(f===
E?"null":f);c=r.length?n?"[\n"+y+r.join(",\n"+y)+"\n"+b+"]":"["+r.join(",")+"]":"[]"}else t(l||K,function(c){var b=B(c,K,d,l,n,y,L);b!==E&&r.push(A(c)+":"+(n?" ":"")+b)}),c=r.length?n?"{\n"+y+r.join(",\n"+y)+"\n"+b+"}":"{"+r.join(",")+"}":"{}";L.pop();return c}};L.stringify=function(c,b,d){var h;if("function"==typeof b||"object"==typeof b&&b)if("[object Function]"==(h=e.call(b)))var l=b;else if("[object Array]"==h){var n={};for(var y=0,E=b.length,L;y<E;L=b[y++],(h=e.call(L),"[object String]"==h||
"[object Number]"==h)&&(n[L]=1));}if(d)if("[object Number]"==(h=e.call(d))){if(0<(d-=d%1)){var v="";for(10<d&&(d=10);v.length<d;v+=" ");}}else"[object String]"==h&&(v=10>=d.length?d:d.slice(0,10));return B("",(L={},L[""]=c,L),l,n,v,"",[])}}if(!b("json-parse")){var w=String.fromCharCode,z={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},x,H,C=function(){x=H=null;throw SyntaxError();},D=function(){for(var c=H,b=c.length,d,e,h,l,n;x<b;)switch(n=c.charCodeAt(x),n){case 9:case 10:case 13:case 32:x++;
break;case 123:case 125:case 91:case 93:case 58:case 44:return d=f?c.charAt(x):c[x],x++,d;case 34:d="@";for(x++;x<b;)if(n=c.charCodeAt(x),32>n)C();else if(92==n)switch(n=c.charCodeAt(++x),n){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:d+=z[n];x++;break;case 117:e=++x;for(h=x+4;x<h;x++)n=c.charCodeAt(x),48<=n&&57>=n||97<=n&&102>=n||65<=n&&70>=n||C();d+=w("0x"+c.slice(e,x));break;default:C()}else{if(34==n)break;n=c.charCodeAt(x);for(e=x;32<=n&&92!=n&&34!=n;)n=c.charCodeAt(++x);
d+=c.slice(e,x)}if(34==c.charCodeAt(x))return x++,d;C();default:e=x;45==n&&(l=!0,n=c.charCodeAt(++x));if(48<=n&&57>=n){for(48==n&&(n=c.charCodeAt(x+1),48<=n&&57>=n)&&C();x<b&&(n=c.charCodeAt(x),48<=n&&57>=n);x++);if(46==c.charCodeAt(x)){for(h=++x;h<b&&(n=c.charCodeAt(h),48<=n&&57>=n);h++);h==x&&C();x=h}n=c.charCodeAt(x);if(101==n||69==n){n=c.charCodeAt(++x);43!=n&&45!=n||x++;for(h=x;h<b&&(n=c.charCodeAt(h),48<=n&&57>=n);h++);h==x&&C();x=h}return+c.slice(e,x)}l&&C();if("true"==c.slice(x,x+4))return x+=
4,!0;if("false"==c.slice(x,x+5))return x+=5,!1;if("null"==c.slice(x,x+4))return x+=4,null;C()}return"$"},I=function(c){var b,d;"$"==c&&C();if("string"==typeof c){if("@"==(f?c.charAt(0):c[0]))return c.slice(1);if("["==c){for(b=[];;d||(d=!0)){c=D();if("]"==c)break;d&&(","==c?(c=D(),"]"==c&&C()):C());","==c&&C();b.push(I(c))}return b}if("{"==c){for(b={};;d||(d=!0)){c=D();if("}"==c)break;d&&(","==c?(c=D(),"}"==c&&C()):C());","!=c&&"string"==typeof c&&"@"==(f?c.charAt(0):c[0])&&":"==D()||C();b[c.slice(1)]=
I(D())}return b}C()}return c},G=function(c,b,d){d=N(c,b,d);d===E?delete c[b]:c[b]=d},N=function(c,b,d){var h=c[b],l;if("object"==typeof h&&h)if("[object Array]"==e.call(h))for(l=h.length;l--;)G(h,l,d);else t(h,function(c){G(h,c,d)});return d.call(c,b,h)};L.parse=function(c,b){var d;x=0;H=""+c;c=I(D());"$"!=D()&&C();x=H=null;return b&&"[object Function]"==e.call(b)?N((d={},d[""]=c,d),"",b):c}}}})(this)},{}],35:[function(c,b,d){function e(c){var b=!0;c.getTracks().forEach(function(c){b="ended"===c.readyState&&
b});return b}function l(){if("undefined"===typeof window||!window.navigator.mozGetUserMedia)return!1;var c=window.navigator.userAgent.match(/Firefox\/(\d+)\./);return 50>(c&&1<=c.length&&parseInt(c[1],10))}function n(c){K.call(this);var b=this.config={detectSpeakingEvents:!1,audioFallback:!1,media:{audio:!0,video:!0},harkOptions:null,logger:L},d;for(d in c)c.hasOwnProperty(d)&&(this.config[d]=c[d]);this.logger=b.logger;this._log=this.logger.log.bind(this.logger,"LocalMedia:");this._logerror=this.logger.error.bind(this.logger,
"LocalMedia:");this.localStreams=[];this.localScreens=[];navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||this._logerror("Your browser does not support local media capture.");this._audioMonitors=[];this.on("localStreamStopped",this._stopAudioMonitor.bind(this));this.on("localScreenStopped",this._stopAudioMonitor.bind(this))}d=c("util");var y=c("hark"),E=c("getscreenmedia"),K=c("wildemitter"),L=c("mockconsole");d.inherits(n,K);n.prototype.start=function(c,b){var d=this,h=c||this.config.media;
this.emit("localStreamRequested",h);navigator.mediaDevices.getUserMedia(h).then(function(c){h.audio&&d.config.detectSpeakingEvents&&d._setupAudioMonitor(c,d.config.harkOptions);d.localStreams.push(c);c.getTracks().forEach(function(b){b.addEventListener("ended",function(){e(c)&&d._removeStream(c)})});d.emit("localStream",c);if(b)return b(null,c)}).catch(function(c){if(d.config.audioFallback&&"NotFoundError"===c.name&&!1!==h.video)h.video=!1,d.start(h,b);else if(d.emit("localStreamRequestFailed",h),
b)return b(c,null)})};n.prototype.stop=function(c){this.stopStream(c);this.stopScreenShare(c)};n.prototype.stopStream=function(c){var b=this;c?-1<this.localStreams.indexOf(c)&&(c.getTracks().forEach(function(c){c.stop()}),l()&&this._removeStream(c)):this.localStreams.forEach(function(c){c.getTracks().forEach(function(c){c.stop()});l()&&b._removeStream(c)})};n.prototype.startScreenShare=function(c,b){var d=this;this.emit("localScreenRequested");"function"!==typeof c||b||(b=c,c=null);E(c,function(c,
e){c?d.emit("localScreenRequestFailed"):(d.localScreens.push(e),e.getTracks().forEach(function(c){c.addEventListener("ended",function(){var c=!0;e.getTracks().forEach(function(b){c="ended"===b.readyState&&c});c&&d._removeStream(e)})}),d.emit("localScreen",e));if(b)return b(c,e)})};n.prototype.stopScreenShare=function(c){var b=this;c?-1<this.localScreens.indexOf(c)&&(c.getTracks().forEach(function(c){c.stop()}),l()&&this._removeStream(c)):this.localScreens.forEach(function(c){c.getTracks().forEach(function(c){c.stop()});
l()&&b._removeStream(c)})};n.prototype.mute=function(){this._audioEnabled(!1);this.emit("audioOff")};n.prototype.unmute=function(){this._audioEnabled(!0);this.emit("audioOn")};n.prototype.pauseVideo=function(){this._videoEnabled(!1);this.emit("videoOff")};n.prototype.resumeVideo=function(){this._videoEnabled(!0);this.emit("videoOn")};n.prototype.pause=function(){this.mute();this.pauseVideo()};n.prototype.resume=function(){this.unmute();this.resumeVideo()};n.prototype._audioEnabled=function(c){this.localStreams.forEach(function(b){b.getAudioTracks().forEach(function(b){b.enabled=
!!c})})};n.prototype._videoEnabled=function(c){this.localStreams.forEach(function(b){b.getVideoTracks().forEach(function(b){b.enabled=!!c})})};n.prototype.isAudioEnabled=function(){var c=!0;this.localStreams.forEach(function(b){b.getAudioTracks().forEach(function(b){c=c&&b.enabled})});return c};n.prototype.isVideoEnabled=function(){var c=!0;this.localStreams.forEach(function(b){b.getVideoTracks().forEach(function(b){c=c&&b.enabled})});return c};n.prototype._removeStream=function(c){var b=this.localStreams.indexOf(c);
-1<b?(this.localStreams.splice(b,1),this.emit("localStreamStopped",c)):(b=this.localScreens.indexOf(c),-1<b&&(this.localScreens.splice(b,1),this.emit("localScreenStopped",c)))};n.prototype._setupAudioMonitor=function(c,b){this._log("Setup audio");b=y(c,b);var d=this,e;b.on("speaking",function(){d.emit("speaking")});b.on("stopped_speaking",function(){e&&clearTimeout(e);e=setTimeout(function(){d.emit("stoppedSpeaking")},1E3)});b.on("volume_change",function(c,b){d.emit("volumeChange",c,b)});this._audioMonitors.push({audio:b,
stream:c})};n.prototype._stopAudioMonitor=function(c){var b=-1;this._audioMonitors.forEach(function(d,e){d.stream===c&&(b=e)});-1<b&&(this._audioMonitors[b].audio.stop(),this._audioMonitors.splice(b,1))};b.exports=n},{getscreenmedia:27,hark:29,mockconsole:37,util:63,wildemitter:65}],36:[function(c,b,d){(function(c){function e(c,b){c.set(b[0],b[1]);return c}function h(c,b){c.add(b);return c}function y(c,b){for(var d=-1,e=c?c.length:0;++d<e&&!1!==b(c[d],d,c););return c}function E(c,b,d,e){var h=-1,
l=c?c.length:0;for(e&&l&&(d=c[++h]);++h<l;)d=b(d,c[h],h,c);return d}function K(c){var b=!1;if(null!=c&&"function"!=typeof c.toString)try{b=!!(c+"")}catch(Sn){}return b}function L(c){var b=-1,d=Array(c.size);c.forEach(function(c,e){d[++b]=[e,c]});return d}function v(c,b){return function(d){return c(b(d))}}function f(c){var b=-1,d=Array(c.size);c.forEach(function(c){d[++b]=c});return d}function m(c){var b=-1,d=c?c.length:0;for(this.clear();++b<d;){var e=c[b];this.set(e[0],e[1])}}function g(c){var b=
-1,d=c?c.length:0;for(this.clear();++b<d;){var e=c[b];this.set(e[0],e[1])}}function p(c){var b=-1,d=c?c.length:0;for(this.clear();++b<d;){var e=c[b];this.set(e[0],e[1])}}function t(c){this.__data__=new g(c)}function r(c,b,d){var e=c[b];ba.call(c,b)&&(e===d||e!==e&&d!==d)&&(void 0!==d||b in c)||(c[b]=d)}function Uc(c,b){for(var d=c.length;d--;){var e=c[d][0];if(e===b||e!==e&&b!==b)return d}return-1}function q(c,b){return c&&C(b,R(b),c)}function x(c,b,d,e,h,l,n){var E;e&&(E=l?e(c,h,l,n):e(c));if(void 0!==
E)return E;if(!F(c))return c;if(h=Ea(c)){if(E=G(c),!b)return z(c,E)}else{var L=sa(c),v="[object Function]"==L||"[object GeneratorFunction]"==L;if(Fa(c))return A(c,b);if("[object Object]"==L||"[object Arguments]"==L||v&&!l){if(K(c))return l?c:{};E=N(v?{}:c);if(!b)return H(c,q(E,c))}else{if(!J[L])return l?c:{};E=O(c,L,x,b)}}n||(n=new t);if(l=n.get(c))return l;n.set(c,E);if(!h)var f=d?B(c,R,Ha):R(c);y(f||c,function(h,l){f&&(l=h,h=c[l]);r(E,l,x(h,b,d,e,l,c,n))});return E}function B(c,b,d){b=b(c);if(!Ea(c)){c=
d(c);d=-1;for(var e=c.length,h=b.length;++d<e;)b[h+d]=c[d]}return b}function A(c,b){if(b)return c.slice();b=new c.constructor(c.length);c.copy(b);return b}function w(c){var b=new c.constructor(c.byteLength);(new ka(b)).set(new ka(c));return b}function z(c,b){var d=-1,e=c.length;for(b||(b=Array(e));++d<e;)b[d]=c[d];return b}function C(c,b,d,e){d||(d={});for(var h=-1,l=b.length;++h<l;){var n=b[h],y=e?e(d[n],c[n],n,d,c):void 0;r(d,n,void 0===y?c[n]:y)}return d}function H(c,b){return C(c,Ha(c),b)}function D(c,
b){c=c.__data__;var d=typeof b;return("string"==d||"number"==d||"symbol"==d||"boolean"==d?"__proto__"!==b:null===b)?c["string"==typeof b?"string":"hash"]:c.map}function I(c,b){c=null==c?void 0:c[b];b=!F(c)||ja&&ja in c?!1:(P(c)||K(c)?da:V).test(yc(c));return b?c:void 0}function G(c){var b=c.length,d=c.constructor(b);b&&"string"==typeof c[0]&&ba.call(c,"index")&&(d.index=c.index,d.input=c.input);return d}function N(c){"function"!=typeof c.constructor||Li(c)?c={}:(c=ia(c),c=F(c)?na(c):{});return c}
function O(c,b,d,l){var n=c.constructor;switch(b){case "[object ArrayBuffer]":return w(c);case "[object Boolean]":case "[object Date]":return new n(+c);case "[object DataView]":return b=l?w(c.buffer):c.buffer,new c.constructor(b,c.byteOffset,c.byteLength);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return b=
l?w(c.buffer):c.buffer,new c.constructor(b,c.byteOffset,c.length);case "[object Map]":return b=l?d(L(c),!0):L(c),E(b,e,new c.constructor);case "[object Number]":case "[object String]":return new n(c);case "[object RegExp]":return b=new c.constructor(c.source,Y.exec(c)),b.lastIndex=c.lastIndex,b;case "[object Set]":return b=l?d(f(c),!0):f(c),E(b,h,new c.constructor);case "[object Symbol]":return xa?Object(xa.call(c)):{}}}function Li(c){var b=c&&c.constructor;return c===("function"==typeof b&&b.prototype||
fa)}function yc(c){if(null!=c){try{return ea.call(c)}catch(Rn){}return c+""}return""}function Mi(c){var b;if(b=null!=c)b=c.length,b="number"==typeof b&&-1<b&&0==b%1&&9007199254740991>=b;return b&&!P(c)}function P(c){c=F(c)?aa.call(c):"";return"[object Function]"==c||"[object GeneratorFunction]"==c}function F(c){var b=typeof c;return!!c&&("object"==b||"function"==b)}function R(c){if(Mi(c)){var b;(b=Ea(c))||(b=!!c&&"object"==typeof c&&Mi(c)&&ba.call(c,"callee")&&(!ra.call(c,"callee")||"[object Arguments]"==
aa.call(c)));if(b){b=c.length;for(var d=String,e=-1,h=Array(b);++e<b;)h[e]=d(e);b=h}else b=[];d=b.length;e=!!d;for(var l in c){if(!(h=!ba.call(c,l))&&(h=e)&&!(h="length"==l)){h=l;var n=d;n=null==n?9007199254740991:n;h=!!n&&("number"==typeof h||W.test(h))&&-1<h&&0==h%1&&h<n}h||b.push(l)}c=b}else if(Li(c)){l=[];for(b in Object(c))ba.call(c,b)&&"constructor"!=b&&l.push(b);c=l}else c=wa(c);return c}function T(){return[]}function U(){return!1}var Y=/\w*$/,V=/^\[object .+?Constructor\]$/,W=/^(?:0|[1-9]\d*)$/,
J={};J["[object Arguments]"]=J["[object Array]"]=J["[object ArrayBuffer]"]=J["[object DataView]"]=J["[object Boolean]"]=J["[object Date]"]=J["[object Float32Array]"]=J["[object Float64Array]"]=J["[object Int8Array]"]=J["[object Int16Array]"]=J["[object Int32Array]"]=J["[object Map]"]=J["[object Number]"]=J["[object Object]"]=J["[object RegExp]"]=J["[object Set]"]=J["[object String]"]=J["[object Symbol]"]=J["[object Uint8Array]"]=J["[object Uint8ClampedArray]"]=J["[object Uint16Array]"]=J["[object Uint32Array]"]=
!0;J["[object Error]"]=J["[object Function]"]=J["[object WeakMap]"]=!1;var M="object"==typeof self&&self&&self.Object===Object&&self;c="object"==typeof c&&c&&c.Object===Object&&c||M||Function("return this")();var S=(M="object"==typeof d&&d&&!d.nodeType&&d)&&"object"==typeof b&&b&&!b.nodeType&&b;M=S&&S.exports===M;S=Array.prototype;var X=Function.prototype,fa=Object.prototype,Q=c["__core-js_shared__"],ja=function(){var c=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),
ea=X.toString,ba=fa.hasOwnProperty,aa=fa.toString,da=RegExp("^"+ea.call(ba).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");X=M?c.Buffer:void 0;M=c.Symbol;var ka=c.Uint8Array,ia=v(Object.getPrototypeOf,Object),na=Object.create,ra=fa.propertyIsEnumerable,ca=S.splice;S=Object.getOwnPropertySymbols;X=X?X.isBuffer:void 0;var wa=v(Object.keys,Object),qa=I(c,"DataView"),ta=I(c,"Map"),la=I(c,"Promise"),va=I(c,"Set");c=I(c,"WeakMap");var oa=
I(Object,"create"),Ja=yc(qa),ha=yc(ta),ya=yc(la),za=yc(va),Da=yc(c),xa=(M=M?M.prototype:void 0)?M.valueOf:void 0;m.prototype.clear=function(){this.__data__=oa?oa(null):{}};m.prototype["delete"]=function(c){return this.has(c)&&delete this.__data__[c]};m.prototype.get=function(c){var b=this.__data__;return oa?(c=b[c],"__lodash_hash_undefined__"===c?void 0:c):ba.call(b,c)?b[c]:void 0};m.prototype.has=function(c){var b=this.__data__;return oa?void 0!==b[c]:ba.call(b,c)};m.prototype.set=function(c,b){this.__data__[c]=
oa&&void 0===b?"__lodash_hash_undefined__":b;return this};g.prototype.clear=function(){this.__data__=[]};g.prototype["delete"]=function(c){var b=this.__data__;c=Uc(b,c);if(0>c)return!1;c==b.length-1?b.pop():ca.call(b,c,1);return!0};g.prototype.get=function(c){var b=this.__data__;c=Uc(b,c);return 0>c?void 0:b[c][1]};g.prototype.has=function(c){return-1<Uc(this.__data__,c)};g.prototype.set=function(c,b){var d=this.__data__,e=Uc(d,c);0>e?d.push([c,b]):d[e][1]=b;return this};p.prototype.clear=function(){this.__data__=
{hash:new m,map:new (ta||g),string:new m}};p.prototype["delete"]=function(c){return D(this,c)["delete"](c)};p.prototype.get=function(c){return D(this,c).get(c)};p.prototype.has=function(c){return D(this,c).has(c)};p.prototype.set=function(c,b){D(this,c).set(c,b);return this};t.prototype.clear=function(){this.__data__=new g};t.prototype["delete"]=function(c){return this.__data__["delete"](c)};t.prototype.get=function(c){return this.__data__.get(c)};t.prototype.has=function(c){return this.__data__.has(c)};
t.prototype.set=function(c,b){var d=this.__data__;if(d instanceof g){d=d.__data__;if(!ta||199>d.length)return d.push([c,b]),this;d=this.__data__=new p(d)}d.set(c,b);return this};var Ha=S?v(S,Object):T,sa=function(c){return aa.call(c)};if(qa&&"[object DataView]"!=sa(new qa(new ArrayBuffer(1)))||ta&&"[object Map]"!=sa(new ta)||la&&"[object Promise]"!=sa(la.resolve())||va&&"[object Set]"!=sa(new va)||c&&"[object WeakMap]"!=sa(new c))sa=function(c){var b=aa.call(c);if(c=(c="[object Object]"==b?c.constructor:
void 0)?yc(c):void 0)switch(c){case Ja:return"[object DataView]";case ha:return"[object Map]";case ya:return"[object Promise]";case za:return"[object Set]";case Da:return"[object WeakMap]"}return b};var Ea=Array.isArray,Fa=X||U;b.exports=function(c){return x(c,!0,!0)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],37:[function(c,b,d){c="assert count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd time timeEnd trace warn".split(" ");
d=c.length;for(var e=function(){},l={};d--;)l[c[d]]=e;b.exports=l},{}],38:[function(c,b,d){function e(c){if(c=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(c)){var b=parseFloat(c[1]);switch((c[2]||"ms").toLowerCase()){case "years":case "year":case "y":return b*n;case "days":case "day":case "d":return 864E5*b;case "hours":case "hour":case "h":return 36E5*b;case "minutes":case "minute":case "m":return 6E4*b;case "seconds":case "second":case "s":return 1E3*b;case "ms":return b}}}
function l(c,b,d){if(!(c<b))return c<1.5*b?Math.floor(c/b)+" "+d:Math.ceil(c/b)+" "+d+"s"}var n=315576E5;b.exports=function(c,b){b=b||{};return"string"==typeof c?e(c):b.long?l(c,864E5,"day")||l(c,36E5,"hour")||l(c,6E4,"minute")||l(c,1E3,"second")||c+" ms":864E5<=c?Math.round(c/864E5)+"d":36E5<=c?Math.round(c/36E5)+"h":6E4<=c?Math.round(c/6E4)+"m":1E3<=c?Math.round(c/1E3)+"s":c+"ms"}},{}],39:[function(c,b,d){var e=Object.prototype.hasOwnProperty;d.keys=Object.keys||function(c){var b=[],d;for(d in c)e.call(c,
d)&&b.push(d);return b};d.values=function(c){var b=[],d;for(d in c)e.call(c,d)&&b.push(c[d]);return b};d.merge=function(c,b){for(var d in b)e.call(b,d)&&(c[d]=b[d]);return c};d.length=function(c){return d.keys(c).length};d.isEmpty=function(c){return 0==d.length(c)}},{}],40:[function(c,b,d){(function(c){var d=/^[\],:{}\s]*$/,e=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,h=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,E=/(?:^|:|,)(?:\s*\[)+/g,K=/^\s+/,L=/\s+$/;b.exports=function(b){if("string"!=
typeof b||!b)return null;b=b.replace(K,"").replace(L,"");if(c.JSON&&JSON.parse)return JSON.parse(b);if(d.test(b.replace(e,"@").replace(h,"]").replace(E,"")))return(new Function("return "+b))()}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],41:[function(c,b,d){d.encode=function(c){var b="",d;for(d in c)c.hasOwnProperty(d)&&(b.length&&(b+="&"),b+=encodeURIComponent(d)+"="+encodeURIComponent(c[d]));return b};d.decode=function(c){var b=
{};c=c.split("&");for(var d=0,e=c.length;d<e;d++){var h=c[d].split("=");b[decodeURIComponent(h[0])]=decodeURIComponent(h[1])}return b}},{}],42:[function(c,b,d){var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,l="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");
b.exports=function(c){c=e.exec(c||"");for(var b={},d=14;d--;)b[l[d]]=c[d]||"";return b}},{}],43:[function(c,b,d){function e(){throw Error("setTimeout has not been defined");}function l(){throw Error("clearTimeout has not been defined");}function n(c){if(f===setTimeout)return setTimeout(c,0);if((f===e||!f)&&setTimeout)return f=setTimeout,setTimeout(c,0);try{return f(c,0)}catch(Vl){try{return f.call(null,c,0)}catch(Wl){return f.call(this,c,0)}}}function y(c){if(m===clearTimeout)return clearTimeout(c);
if((m===l||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(c);try{return m(c)}catch(Vl){try{return m.call(null,c)}catch(Wl){return m.call(this,c)}}}function E(){p&&t&&(p=!1,t.length?g=t.concat(g):r=-1,g.length&&K())}function K(){if(!p){var c=n(E);p=!0;for(var b=g.length;b;){t=g;for(g=[];++r<b;)t&&t[r].run();r=-1;b=g.length}t=null;p=!1;y(c)}}function L(c,b){this.fun=c;this.array=b}function v(){}c=b.exports={};try{var f="function"===typeof setTimeout?setTimeout:e}catch(Uc){f=e}try{var m="function"===
typeof clearTimeout?clearTimeout:l}catch(Uc){m=l}var g=[],p=!1,t,r=-1;c.nextTick=function(c){var b=Array(arguments.length-1);if(1<arguments.length)for(var d=1;d<arguments.length;d++)b[d-1]=arguments[d];g.push(new L(c,b));1!==g.length||p||n(K)};L.prototype.run=function(){this.fun.apply(null,this.array)};c.title="browser";c.browser=!0;c.env={};c.argv=[];c.version="";c.versions={};c.on=v;c.addListener=v;c.once=v;c.off=v;c.removeListener=v;c.removeAllListeners=v;c.emit=v;c.prependListener=v;c.prependOnceListener=
v;c.listeners=function(c){return[]};c.binding=function(c){throw Error("process.binding is not supported");};c.cwd=function(){return"/"};c.chdir=function(c){throw Error("process.chdir is not supported");};c.umask=function(){return 0}},{}],44:[function(c,b,d){function e(c,b){var d=this,e;n.call(this);c=c||{};c.iceServers=c.iceServers||[];this.enableChromeNativeSimulcast=!1;b&&b.optional&&window.chrome&&null===navigator.appVersion.match(/Chromium\//)&&b.optional.forEach(function(c){c.enableChromeNativeSimulcast&&
(d.enableChromeNativeSimulcast=!0)});this.enableMultiStreamHacks=!1;b&&b.optional&&window.chrome&&b.optional.forEach(function(c){c.enableMultiStreamHacks&&(d.enableMultiStreamHacks=!0)});this.restrictBandwidth=0;b&&b.optional&&b.optional.forEach(function(c){c.andyetRestrictBandwidth&&(d.restrictBandwidth=c.andyetRestrictBandwidth)});this.batchIceCandidates=0;b&&b.optional&&b.optional.forEach(function(c){c.andyetBatchIce&&(d.batchIceCandidates=c.andyetBatchIce)});this.batchedIceCandidates=[];b&&b.optional&&
window.chrome&&b.optional.forEach(function(c){c.andyetFasterICE&&(d.eliminateDuplicateCandidates=c.andyetFasterICE)});b&&b.optional&&b.optional.forEach(function(c){c.andyetDontSignalCandidates&&(d.dontSignalCandidates=c.andyetDontSignalCandidates)});this.assumeSetLocalSuccess=!1;b&&b.optional&&b.optional.forEach(function(c){c.andyetAssumeSetLocalSuccess&&(d.assumeSetLocalSuccess=c.andyetAssumeSetLocalSuccess)});window.navigator.mozGetUserMedia&&b&&b.optional&&(this.wtFirefox=0,b.optional.forEach(function(c){c.andyetFirefoxMakesMeSad&&
(d.wtFirefox=c.andyetFirefoxMakesMeSad,0<d.wtFirefox&&(d.firefoxcandidatebuffer=[]))}));this.pc=new RTCPeerConnection(c,b);this.getLocalStreams="function"===typeof this.pc.getLocalStreams?this.pc.getLocalStreams.bind(this.pc):function(){return[]};this.getSenders="function"===typeof this.pc.getSenders?this.pc.getSenders.bind(this.pc):function(){return[]};this.getRemoteStreams="function"===typeof this.pc.getRemoteStreams?this.pc.getRemoteStreams.bind(this.pc):function(){return[]};this.getReceivers=
"function"===typeof this.pc.getReceivers?this.pc.getReceivers.bind(this.pc):function(){return[]};this.addStream=this.pc.addStream.bind(this.pc);this.removeStream=function(c){"function"===typeof d.pc.removeStream?d.pc.removeStream.apply(d.pc,arguments):"function"===typeof d.pc.removeTrack&&c.getTracks().forEach(function(c){d.pc.removeTrack(c)})};"function"===typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc));this.pc.onremovestream=this.emit.bind(this,"removeStream");this.pc.onremovetrack=
this.emit.bind(this,"removeTrack");this.pc.onaddstream=this.emit.bind(this,"addStream");this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded");this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange");this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange");this.pc.onicecandidate=this._onIce.bind(this);this.pc.ondatachannel=this._onDataChannel.bind(this);this.localDescription={contents:[]};this.remoteDescription={contents:[]};this.config={debug:!1,
sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1};this.iceCredentials={local:{},remote:{}};for(e in c)this.config[e]=c[e];if(this.config.debug)this.on("*",function(){(c.logger||console).log("PeerConnection event:",arguments)});this.hadRemoteIPv6Candidate=this.hadLocalIPv6Candidate=this.hadRemoteRelayCandidate=this.hadLocalRelayCandidate=this.hadRemoteStunCandidate=this.hadLocalStunCandidate=!1;this._remoteDataChannels=[];this._localDataChannels=[];this._candidateBuffer=[]}d=c("util");var l=
c("sdp-jingle-json"),n=c("wildemitter"),y=c("lodash.clonedeep");d.inherits(e,n);Object.defineProperty(e.prototype,"signalingState",{get:function(){return this.pc.signalingState}});Object.defineProperty(e.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}});e.prototype._role=function(){return this.isInitiator?"initiator":"responder"};e.prototype.addStream=function(c){this.localStream=c;this.pc.addStream(c)};e.prototype._checkLocalCandidate=function(c){c=l.toCandidateJSON(c);
"srflx"==c.type?this.hadLocalStunCandidate=!0:"relay"==c.type&&(this.hadLocalRelayCandidate=!0);-1!=c.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)};e.prototype._checkRemoteCandidate=function(c){c=l.toCandidateJSON(c);"srflx"==c.type?this.hadRemoteStunCandidate=!0:"relay"==c.type&&(this.hadRemoteRelayCandidate=!0);-1!=c.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)};e.prototype.processIce=function(c,b){b=b||function(){};var d=this;if("closed"===this.pc.signalingState)return b();if(c.contents||
c.jingle&&c.jingle.contents){var e=this.remoteDescription.contents.map(function(c){return c.name});(c.contents||c.jingle.contents).forEach(function(c){var h=c.transport||{},n=h.candidates||[],y=e.indexOf(c.name),E=c.name,L=d.remoteDescription.contents.find(function(b){return b.name===c.name}),K=function(){n.forEach(function(c){c=l.toCandidateSDP(c);d.pc.addIceCandidate(new RTCIceCandidate({candidate:c,sdpMLineIndex:y,sdpMid:E}),function(){},function(c){d.emit("error",c)});d._checkRemoteCandidate(c)});
b()};d.iceCredentials.remote[c.name]&&h.ufrag&&d.iceCredentials.remote[c.name].ufrag!==h.ufrag?L?(L.transport.ufrag=h.ufrag,L.transport.pwd=h.pwd,h={type:"offer",jingle:d.remoteDescription},h.sdp=l.toSessionSDP(h.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"incoming"}),d.pc.setRemoteDescription(new RTCSessionDescription(h),function(){K()},function(c){d.emit("error",c)})):d.emit("error","ice restart failed to find matching content"):K()})}else{c.candidate&&0!==c.candidate.candidate.indexOf("a=")&&
(c.candidate.candidate="a="+c.candidate.candidate);if(this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(c.candidate),b();d.pc.addIceCandidate(new RTCIceCandidate(c.candidate),function(){},function(c){d.emit("error",c)});d._checkRemoteCandidate(c.candidate.candidate);b()}};e.prototype.offer=function(c,b){var d=this,e=2===arguments.length,h=e&&c?c:{offerToReceiveAudio:1,offerToReceiveVideo:1};
b=(b=e?b:c)||function(){};if("closed"===this.pc.signalingState)return b("Already closed");this.pc.createOffer(function(c){var e={type:"offer",sdp:c.sdp};d.assumeSetLocalSuccess&&(d.emit("offer",e),b(null,e));d._candidateBuffer=[];d.pc.setLocalDescription(c,function(){if(d.config.useJingle){var h=l.toSessionJSON(c.sdp,{role:d._role(),direction:"outgoing"});h.sid=d.config.sid;d.localDescription=h;h.contents.forEach(function(c){var b=c.transport||{};b.ufrag&&(d.iceCredentials.local[c.name]={ufrag:b.ufrag,
pwd:b.pwd})});e.jingle=h}e.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&d._checkLocalCandidate(c)});d.assumeSetLocalSuccess||(d.emit("offer",e),b(null,e))},function(c){d.emit("error",c);b(c)})},function(c){d.emit("error",c);b(c)},h)};e.prototype.handleOffer=function(c,b){b=b||function(){};var d=this;c.type="offer";if(c.jingle){this.enableChromeNativeSimulcast&&c.jingle.contents.forEach(function(c){"video"===c.name&&(c.application.googConferenceFlag=!0)});this.enableMultiStreamHacks&&
c.jingle.contents.forEach(function(c){if("video"===c.name){var b=c.application.sources||[];if(0===b.length||"3735928559"!==b[0].ssrc)b.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),c.application.sources=b}});if(0<d.restrictBandwidth&&2<=c.jingle.contents.length&&"video"===c.jingle.contents[1].name){var e=c.jingle.contents[1];e.application&&e.application.bandwidth&&e.application.bandwidth.bandwidth||(c.jingle.contents[1].application.bandwidth=
{type:"AS",bandwidth:d.restrictBandwidth.toString()},c.sdp=l.toSessionSDP(c.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"outgoing"}))}c.jingle.contents.forEach(function(c){var b=c.transport||{};b.ufrag&&(d.iceCredentials.remote[c.name]={ufrag:b.ufrag,pwd:b.pwd})});c.sdp=l.toSessionSDP(c.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"incoming"});d.remoteDescription=c.jingle}c.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&d._checkRemoteCandidate(c)});
d.pc.setRemoteDescription(new RTCSessionDescription(c),function(){b()},b)};e.prototype.answerAudioOnly=function(c){this._answer({mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},c)};e.prototype.answerBroadcastOnly=function(c){this._answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},c)};e.prototype.answer=function(c,b){var d=2===arguments.length;this._answer(d&&c?c:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},d?b:c)};e.prototype.handleAnswer=function(c,b){b=
b||function(){};var d=this;c.jingle&&(c.sdp=l.toSessionSDP(c.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"incoming"}),d.remoteDescription=c.jingle,c.jingle.contents.forEach(function(c){var b=c.transport||{};b.ufrag&&(d.iceCredentials.remote[c.name]={ufrag:b.ufrag,pwd:b.pwd})}));c.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&d._checkRemoteCandidate(c)});d.pc.setRemoteDescription(new RTCSessionDescription(c),function(){d.wtFirefox&&window.setTimeout(function(){d.firefoxcandidatebuffer.forEach(function(c){d.pc.addIceCandidate(new RTCIceCandidate(c),
function(){},function(c){d.emit("error",c)});d._checkRemoteCandidate(c.candidate)});d.firefoxcandidatebuffer=null},d.wtFirefox);b(null)},b)};e.prototype.close=function(){this.pc.close();this._localDataChannels=[];this._remoteDataChannels=[];this.emit("close")};e.prototype._answer=function(c,b){b=b||function(){};var d=this;if(!this.pc.remoteDescription)throw Error("remoteDescription not set");if("closed"===this.pc.signalingState)return b("Already closed");d.pc.createAnswer(function(c){var e=[];if(d.enableChromeNativeSimulcast&&
(c.jingle=l.toSessionJSON(c.sdp,{role:d._role(),direction:"outgoing"}),2<=c.jingle.contents.length&&"video"===c.jingle.contents[1].name)){var h=c.jingle.contents[1].application.sourceGroups||[],n=!1;h.forEach(function(c){"SIM"==c.semantics&&(n=!0)});if(!n&&c.jingle.contents[1].application.sources.length){var E=JSON.parse(JSON.stringify(c.jingle.contents[1].application.sources[0]));E.ssrc=""+Math.floor(4294967295*Math.random());c.jingle.contents[1].application.sources.push(E);e.push(c.jingle.contents[1].application.sources[0].ssrc);
e.push(E.ssrc);h.push({semantics:"SIM",sources:e});e=JSON.parse(JSON.stringify(E));e.ssrc=""+Math.floor(4294967295*Math.random());c.jingle.contents[1].application.sources.push(e);h.push({semantics:"FID",sources:[E.ssrc,e.ssrc]});c.jingle.contents[1].application.sourceGroups=h;c.sdp=l.toSessionSDP(c.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"outgoing"})}}var f={type:"answer",sdp:c.sdp};d.assumeSetLocalSuccess&&(h=y(f),d.emit("answer",h),b(null,h));d._candidateBuffer=[];d.pc.setLocalDescription(c,
function(){if(d.config.useJingle){var e=l.toSessionJSON(c.sdp,{role:d._role(),direction:"outgoing"});e.sid=d.config.sid;d.localDescription=e;f.jingle=e}d.enableChromeNativeSimulcast&&(f.jingle||(f.jingle=l.toSessionJSON(c.sdp,{role:d._role(),direction:"outgoing"})),f.jingle.contents[1].application.sources.forEach(function(c,b){c.parameters=c.parameters.map(function(c){"msid"===c.key&&(c.value+="-"+Math.floor(b/2));return c})}),f.sdp=l.toSessionSDP(f.jingle,{sid:d.sdpSessionID,role:d._role(),direction:"outgoing"}));
f.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&d._checkLocalCandidate(c)});d.assumeSetLocalSuccess||(e=y(f),d.emit("answer",e),b(null,e))},function(c){d.emit("error",c);b(c)})},function(c){d.emit("error",c);b(c)},c)};e.prototype._onIce=function(c){var b=this;if(c.candidate){if(!this.dontSignalCandidates){c=c.candidate;var d={candidate:{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex}};this._checkLocalCandidate(c.candidate);var e=l.toCandidateJSON(c.candidate);
if(this.eliminateDuplicateCandidates&&"relay"===e.type){var h=this._candidateBuffer.filter(function(c){return"relay"===c.type}).map(function(c){return c.foundation+":"+c.component});var n=h.indexOf(e.foundation+":"+e.component);if(-1<n&&e.priority>>24>=h[n].priority>>24)return}if("max-bundle"===this.config.bundlePolicy&&(h=this._candidateBuffer.filter(function(c){return e.type===c.type}).map(function(c){return c.address+":"+c.port}),n=h.indexOf(e.address+":"+e.port),-1<n))return;if("require"!==this.config.rtcpMuxPolicy||
"2"!==e.component){this._candidateBuffer.push(e);if(b.config.useJingle&&(c.sdpMid||(c.sdpMid=b.pc.remoteDescription&&"offer"===b.pc.remoteDescription.type?b.remoteDescription.contents[c.sdpMLineIndex].name:b.localDescription.contents[c.sdpMLineIndex].name),b.iceCredentials.local[c.sdpMid]||l.toSessionJSON(b.pc.localDescription.sdp,{role:b._role(),direction:"outgoing"}).contents.forEach(function(c){var d=c.transport||{};d.ufrag&&(b.iceCredentials.local[c.name]={ufrag:d.ufrag,pwd:d.pwd})}),d.jingle=
{contents:[{name:c.sdpMid,creator:b._role(),transport:{transportType:"iceUdp",ufrag:b.iceCredentials.local[c.sdpMid].ufrag,pwd:b.iceCredentials.local[c.sdpMid].pwd,candidates:[e]}}]},0<b.batchIceCandidates)){0===b.batchedIceCandidates.length&&window.setTimeout(function(){var c={};b.batchedIceCandidates.forEach(function(b){b=b.contents[0];c[b.name]||(c[b.name]=b);c[b.name].transport.candidates.push(b.transport.candidates[0])});var d={jingle:{contents:[]}};Object.keys(c).forEach(function(b){d.jingle.contents.push(c[b])});
b.batchedIceCandidates=[];b.emit("ice",d)},b.batchIceCandidates);b.batchedIceCandidates.push(d.jingle);return}this.emit("ice",d)}}}else this.emit("endOfCandidates")};e.prototype._onDataChannel=function(c){c=c.channel;this._remoteDataChannels.push(c);this.emit("addChannel",c)};e.prototype.createDataChannel=function(c,b){c=this.pc.createDataChannel(c,b);this._localDataChannels.push(c);return c};e.prototype.getStats=function(){if("function"===typeof arguments[0]){var c=arguments[0];this.pc.getStats().then(function(b){c(null,
b)},function(b){c(b)})}else return this.pc.getStats.apply(this.pc,arguments)};b.exports=e},{"lodash.clonedeep":36,"sdp-jingle-json":45,util:63,wildemitter:65}],45:[function(c,b,d){var e=c("./lib/tosdp"),l=c("./lib/tojson");d.toIncomingSDPOffer=function(c){return e.toSessionSDP(c,{role:"responder",direction:"incoming"})};d.toOutgoingSDPOffer=function(c){return e.toSessionSDP(c,{role:"initiator",direction:"outgoing"})};d.toIncomingSDPAnswer=function(c){return e.toSessionSDP(c,{role:"initiator",direction:"incoming"})};
d.toOutgoingSDPAnswer=function(c){return e.toSessionSDP(c,{role:"responder",direction:"outgoing"})};d.toIncomingMediaSDPOffer=function(c){return e.toMediaSDP(c,{role:"responder",direction:"incoming"})};d.toOutgoingMediaSDPOffer=function(c){return e.toMediaSDP(c,{role:"initiator",direction:"outgoing"})};d.toIncomingMediaSDPAnswer=function(c){return e.toMediaSDP(c,{role:"initiator",direction:"incoming"})};d.toOutgoingMediaSDPAnswer=function(c){return e.toMediaSDP(c,{role:"responder",direction:"outgoing"})};
d.toCandidateSDP=e.toCandidateSDP;d.toMediaSDP=e.toMediaSDP;d.toSessionSDP=e.toSessionSDP;d.toIncomingJSONOffer=function(c,b){return l.toSessionJSON(c,{role:"responder",direction:"incoming",creators:b})};d.toOutgoingJSONOffer=function(c,b){return l.toSessionJSON(c,{role:"initiator",direction:"outgoing",creators:b})};d.toIncomingJSONAnswer=function(c,b){return l.toSessionJSON(c,{role:"initiator",direction:"incoming",creators:b})};d.toOutgoingJSONAnswer=function(c,b){return l.toSessionJSON(c,{role:"responder",
direction:"outgoing",creators:b})};d.toIncomingMediaJSONOffer=function(c,b){return l.toMediaJSON(c,{role:"responder",direction:"incoming",creator:b})};d.toOutgoingMediaJSONOffer=function(c,b){return l.toMediaJSON(c,{role:"initiator",direction:"outgoing",creator:b})};d.toIncomingMediaJSONAnswer=function(c,b){return l.toMediaJSON(c,{role:"initiator",direction:"incoming",creator:b})};d.toOutgoingMediaJSONAnswer=function(c,b){return l.toMediaJSON(c,{role:"responder",direction:"outgoing",creator:b})};
d.toCandidateJSON=l.toCandidateJSON;d.toMediaJSON=l.toMediaJSON;d.toSessionJSON=l.toSessionJSON},{"./lib/tojson":48,"./lib/tosdp":49}],46:[function(c,b,d){d.lines=function(c){return c.split("\r\n").filter(function(c){return 0<c.length})};d.findLine=function(c,b,d){for(var e=c.length,h=0;h<b.length;h++)if(b[h].substr(0,e)===c)return b[h];if(!d)return!1;for(b=0;b<d.length;b++)if(d[b].substr(0,e)===c)return d[b];return!1};d.findLines=function(c,b,d){for(var e=[],h=c.length,l=0;l<b.length;l++)b[l].substr(0,
h)===c&&e.push(b[l]);if(e.length||!d)return e;for(b=0;b<d.length;b++)d[b].substr(0,h)===c&&e.push(d[b]);return e};d.mline=function(c){c=c.substr(2).split(" ");for(var b={media:c[0],port:c[1],proto:c[2],formats:[]},d=3;d<c.length;d++)c[d]&&b.formats.push(c[d]);return b};d.rtpmap=function(c){c=c.substr(9).split(" ");var b={id:c.shift()};c=c[0].split("/");b.name=c[0];b.clockrate=c[1];b.channels=3==c.length?c[2]:"1";return b};d.sctpmap=function(c){c=c.substr(10).split(" ");return{number:c.shift(),protocol:c.shift(),
streams:c.shift()}};d.fmtp=function(c){for(var b,d=c.substr(c.indexOf(" ")+1).split(";"),e=[],h=0;h<d.length;h++)b=d[h].split("="),c=b[0].trim(),b=b[1],c&&b?e.push({key:c,value:b}):c&&e.push({key:"",value:c});return e};d.crypto=function(c){c=c.substr(9).split(" ");return{tag:c[0],cipherSuite:c[1],keyParams:c[2],sessionParams:c.slice(3).join(" ")}};d.fingerprint=function(c){c=c.substr(14).split(" ");return{hash:c[0],value:c[1]}};d.extmap=function(c){c=c.substr(9).split(" ");var b={},d=c.shift(),e=
d.indexOf("/");0<=e?(b.id=d.substr(0,e),b.senders=d.substr(e+1)):(b.id=d,b.senders="sendrecv");b.uri=c.shift()||"";return b};d.rtcpfb=function(c){c=c.substr(10).split(" ");var b={};b.id=c.shift();b.type=c.shift();"trr-int"===b.type?b.value=c.shift():b.subtype=c.shift()||"";b.parameters=c;return b};d.candidate=function(c){c=0===c.indexOf("a=candidate:")?c.substring(12).split(" "):c.substring(10).split(" ");for(var b={foundation:c[0],component:c[1],protocol:c[2].toLowerCase(),priority:c[3],ip:c[4],
port:c[5],type:c[7],generation:"0"},d=8;d<c.length;d+=2)"raddr"===c[d]?b.relAddr=c[d+1]:"rport"===c[d]?b.relPort=c[d+1]:"generation"===c[d]?b.generation=c[d+1]:"tcptype"===c[d]&&(b.tcpType=c[d+1]);b.network="1";return b};d.sourceGroups=function(c){for(var b=[],d=0;d<c.length;d++){var e=c[d].substr(13).split(" ");b.push({semantics:e.shift(),sources:e})}return b};d.sources=function(c){for(var b=[],d={},e=0;e<c.length;e++){var h=c[e].substr(7).split(" "),f=h.shift();if(!d[f]){var L={ssrc:f,parameters:[]};
b.push(L);d[f]=L}h=h.join(" ").split(":");L=h.shift();h=h.join(":")||null;d[f].parameters.push({key:L,value:h})}return b};d.groups=function(c){for(var b=[],d,e=0;e<c.length;e++)d=c[e].substr(8).split(" "),b.push({semantics:d.shift(),contents:d});return b};d.bandwidth=function(c){c=c.substr(2).split(":");var b={};b.type=c.shift();b.bandwidth=c.shift();return b};d.msid=function(c){c=c.substr(7);var b=c.split(" ");return{msid:c,mslabel:b[0],label:b[1]}}},{}],47:[function(c,b,d){b.exports={initiator:{incoming:{initiator:"recvonly",
responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",
both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],48:[function(c,b,d){var e=c("./senders"),l=c("./parsers"),n=Math.random();d._setIdCounter=function(c){n=c};d.toSessionJSON=function(c,b){var e,h=b.creators||[],n=b.role||"initiator";b=b.direction||"outgoing";var y=c.split("\r\nm=");for(e=1;e<y.length;e++)y[e]="m="+y[e],e!==y.length-1&&(y[e]+="\r\n");var E=y.shift()+"\r\n",f=l.lines(E);c={};var m=[];for(e=0;e<y.length;e++)m.push(d.toMediaJSON(y[e],
E,{role:n,direction:b,creator:h[e]||"initiator"}));c.contents=m;h=l.findLines("a=group:",f);h.length&&(c.groups=l.groups(h));return c};d.toMediaJSON=function(c,b,h){var n=h.creator||"initiator",y=h.role||"initiator",E=h.direction||"outgoing",f=l.lines(c);c=l.lines(b);b=l.mline(f[0]);n={creator:n,name:b.media,application:{applicationType:"rtp",media:b.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==b.media&&
(n.application={applicationType:"datachannel"},n.transport.sctp=[]);var m=n.application,K=n.transport;if(b=l.findLine("a=mid:",f))n.name=b.substr(6);l.findLine("a=sendrecv",f,c)?n.senders="both":l.findLine("a=sendonly",f,c)?n.senders=e[y][E].sendonly:l.findLine("a=recvonly",f,c)?n.senders=e[y][E].recvonly:l.findLine("a=inactive",f,c)&&(n.senders="none");if("rtp"==m.applicationType){if(b=l.findLine("b=",f))m.bandwidth=l.bandwidth(b);if(b=l.findLine("a=ssrc:",f))m.ssrc=b.substr(7).split(" ")[0];l.findLines("a=rtpmap:",
f).forEach(function(c){var b=l.rtpmap(c);b.parameters=[];b.feedback=[];l.findLines("a=fmtp:"+b.id,f).forEach(function(c){b.parameters=l.fmtp(c)});l.findLines("a=rtcp-fb:"+b.id,f).forEach(function(c){b.feedback.push(l.rtcpfb(c))});m.payloads.push(b)});l.findLines("a=crypto:",f,c).forEach(function(c){m.encryption.push(l.crypto(c))});l.findLine("a=rtcp-mux",f)&&(m.mux=!0);l.findLines("a=rtcp-fb:*",f).forEach(function(c){m.feedback.push(l.rtcpfb(c))});l.findLines("a=extmap:",f).forEach(function(c){c=
l.extmap(c);c.senders=e[y][E][c.senders];m.headerExtensions.push(c)});b=l.findLines("a=ssrc-group:",f);m.sourceGroups=l.sourceGroups(b||[]);b=l.findLines("a=ssrc:",f);var g=m.sources=l.sources(b||[]);if(b=l.findLine("a=msid:",f)){var p=l.msid(b);["msid","mslabel","label"].forEach(function(c){for(var b=0;b<g.length;b++){for(var d=!1,e=0;e<g[b].parameters.length;e++)g[b].parameters[e].key===c&&(d=!0);d||g[b].parameters.push({key:c,value:p[c]})}})}l.findLine("a=x-google-flag:conference",f,c)&&(m.googConferenceFlag=
!0)}b=l.findLines("a=fingerprint:",f,c);var t=l.findLine("a=setup:",f,c);b.forEach(function(c){c=l.fingerprint(c);t&&(c.setup=t.substr(8));K.fingerprints.push(c)});b=l.findLine("a=ice-ufrag:",f,c);h=l.findLine("a=ice-pwd:",f,c);b&&h&&(K.ufrag=b.substr(12),K.pwd=h.substr(10),K.candidates=[],l.findLines("a=candidate:",f,c).forEach(function(c){K.candidates.push(d.toCandidateJSON(c))}));"datachannel"==m.applicationType&&l.findLines("a=sctpmap:",f).forEach(function(c){c=l.sctpmap(c);K.sctp.push(c)});return n};
d.toCandidateJSON=function(c){c=l.candidate(c.split("\r\n")[0]);c.id=(n++).toString(36).substr(0,12);return c}},{"./parsers":46,"./senders":47}],49:[function(c,b,d){var e=c("./senders");d.toSessionSDP=function(c,b){var e=b.sid||c.sid||Date.now(),h=b.time||Date.now(),l=["v=0","o=- "+e+" "+h+" IN IP4 0.0.0.0","s=-","t=0 0"];e=c.contents||[];var n=!1;e.forEach(function(c){c.application.sources&&c.application.sources.length&&(n=!0)});n&&l.push("a=msid-semantic: WMS *");(c.groups||[]).forEach(function(c){l.push("a=group:"+
c.semantics+" "+c.contents.join(" "))});e.forEach(function(c){l.push(d.toMediaSDP(c,b))});return l.join("\r\n")+"\r\n"};d.toMediaSDP=function(c,b){var h=[],l=b.role||"initiator",n=b.direction||"outgoing",f=c.application;b=c.transport;var m=f.payloads||[],g=b&&b.fingerprints||[],Z=[];"datachannel"==f.applicationType?(Z.push("application"),Z.push("1"),Z.push("DTLS/SCTP"),b.sctp&&b.sctp.forEach(function(c){Z.push(c.number)})):(Z.push(f.media),Z.push("1"),0<g.length?Z.push("UDP/TLS/RTP/SAVPF"):f.encryption&&
0<f.encryption.length?Z.push("RTP/SAVPF"):Z.push("RTP/AVPF"),m.forEach(function(c){Z.push(c.id)}));h.push("m="+Z.join(" "));h.push("c=IN IP4 0.0.0.0");f.bandwidth&&f.bandwidth.type&&f.bandwidth.bandwidth&&h.push("b="+f.bandwidth.type+":"+f.bandwidth.bandwidth);"rtp"==f.applicationType&&h.push("a=rtcp:1 IN IP4 0.0.0.0");b&&(b.ufrag&&h.push("a=ice-ufrag:"+b.ufrag),b.pwd&&h.push("a=ice-pwd:"+b.pwd),g.forEach(function(c){h.push("a=fingerprint:"+c.hash+" "+c.value);c.setup&&h.push("a=setup:"+c.setup)}),
b.sctp&&b.sctp.forEach(function(c){h.push("a=sctpmap:"+c.number+" "+c.protocol+" "+c.streams)}));"rtp"==f.applicationType&&h.push("a="+(e[l][n][c.senders]||"sendrecv"));h.push("a=mid:"+c.name);f.sources&&f.sources.length&&(f.sources[0].parameters||[]).forEach(function(c){"msid"===c.key&&h.push("a=msid:"+c.value)});f.mux&&h.push("a=rtcp-mux");(f.encryption||[]).forEach(function(c){h.push("a=crypto:"+c.tag+" "+c.cipherSuite+" "+c.keyParams+(c.sessionParams?" "+c.sessionParams:""))});f.googConferenceFlag&&
h.push("a=x-google-flag:conference");m.forEach(function(c){var b="a=rtpmap:"+c.id+" "+c.name+"/"+c.clockrate;c.channels&&"1"!=c.channels&&(b+="/"+c.channels);h.push(b);if(c.parameters&&c.parameters.length){b=["a=fmtp:"+c.id];var d=[];c.parameters.forEach(function(c){d.push((c.key?c.key+"=":"")+c.value)});b.push(d.join(";"));h.push(b.join(" "))}c.feedback&&c.feedback.forEach(function(b){"trr-int"===b.type?h.push("a=rtcp-fb:"+c.id+" trr-int "+(b.value?b.value:"0")):h.push("a=rtcp-fb:"+c.id+" "+b.type+
(b.subtype?" "+b.subtype:""))})});f.feedback&&f.feedback.forEach(function(c){"trr-int"===c.type?h.push("a=rtcp-fb:* trr-int "+(c.value?c.value:"0")):h.push("a=rtcp-fb:* "+c.type+(c.subtype?" "+c.subtype:""))});(f.headerExtensions||[]).forEach(function(c){h.push("a=extmap:"+c.id+(c.senders?"/"+e[l][n][c.senders]:"")+" "+c.uri)});(f.sourceGroups||[]).forEach(function(c){h.push("a=ssrc-group:"+c.semantics+" "+c.sources.join(" "))});(f.sources||[]).forEach(function(c){for(var b=0;b<c.parameters.length;b++){var d=
c.parameters[b];h.push("a=ssrc:"+(c.ssrc||f.ssrc)+" "+d.key+(d.value?":"+d.value:""))}});(b.candidates||[]).forEach(function(c){h.push(d.toCandidateSDP(c))});return h.join("\r\n")};d.toCandidateSDP=function(c){var b=[];b.push(c.foundation);b.push(c.component);b.push(c.protocol.toUpperCase());b.push(c.priority);b.push(c.ip);b.push(c.port);var d=c.type;b.push("typ");b.push(d);("srflx"===d||"prflx"===d||"relay"===d)&&c.relAddr&&c.relPort&&(b.push("raddr"),b.push(c.relAddr),b.push("rport"),b.push(c.relPort));
c.tcpType&&"TCP"==c.protocol.toUpperCase()&&(b.push("tcptype"),b.push(c.tcpType));b.push("generation");b.push(c.generation||"0");return"a=candidate:"+b.join(" ")}},{"./senders":47}],50:[function(c,b,d){b.exports=c("./lib/")},{"./lib/":51}],51:[function(c,b,d){function e(c,b){"object"==typeof c&&(b=c,c=void 0);b=b||{};c=l(c);var d=c.source,e=c.id;b.forceNew||b["force new connection"]||!1===b.multiplex?(E("ignoring socket cache for %s",d),b=y(d,b)):(f[e]||(E("new io instance for %s",d),f[e]=y(d,b)),
b=f[e]);return b.socket(c.path)}var l=c("./url"),n=c("socket.io-parser"),y=c("./manager"),E=c("debug")("socket.io-client");b.exports=d=e;var f=d.managers={};d.protocol=n.protocol;d.connect=e;d.Manager=c("./manager");d.Socket=c("./socket")},{"./manager":52,"./socket":54,"./url":55,debug:10,"socket.io-parser":57}],52:[function(c,b,d){function e(c,b){if(!(this instanceof e))return new e(c,b);c&&"object"==typeof c&&(b=c,c=void 0);b=b||{};b.path=b.path||"/socket.io";this.nsps={};this.subs=[];this.opts=
b;this.reconnection(!1!==b.reconnection);this.reconnectionAttempts(b.reconnectionAttempts||Infinity);this.reconnectionDelay(b.reconnectionDelay||1E3);this.reconnectionDelayMax(b.reconnectionDelayMax||5E3);this.randomizationFactor(b.randomizationFactor||.5);this.backoff=new g({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==b.timeout?2E4:b.timeout);this.readyState="closed";this.uri=c;this.connected=[];this.encoding=!1;this.packetBuffer=
[];this.encoder=new y.Encoder;this.decoder=new y.Decoder;(this.autoConnect=!1!==b.autoConnect)&&this.open()}c("./url");var l=c("engine.io-client"),n=c("./socket");d=c("component-emitter");var y=c("socket.io-parser"),E=c("./on"),f=c("component-bind");c("object-component");var m=c("debug")("socket.io-client:manager"),v=c("indexof"),g=c("backo2");b.exports=e;e.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var c in this.nsps)this.nsps[c].emit.apply(this.nsps[c],arguments)};e.prototype.updateSocketIds=
function(){for(var c in this.nsps)this.nsps[c].id=this.engine.id};d(e.prototype);e.prototype.reconnection=function(c){if(!arguments.length)return this._reconnection;this._reconnection=!!c;return this};e.prototype.reconnectionAttempts=function(c){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=c;return this};e.prototype.reconnectionDelay=function(c){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=c;this.backoff&&this.backoff.setMin(c);return this};
e.prototype.randomizationFactor=function(c){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=c;this.backoff&&this.backoff.setJitter(c);return this};e.prototype.reconnectionDelayMax=function(c){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=c;this.backoff&&this.backoff.setMax(c);return this};e.prototype.timeout=function(c){if(!arguments.length)return this._timeout;this._timeout=c;return this};e.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&
this._reconnection&&0===this.backoff.attempts&&this.reconnect()};e.prototype.open=e.prototype.connect=function(c){m("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;m("opening %s",this.uri);var b=this.engine=l(this.uri,this.opts),d=this;this.readyState="opening";this.skipReconnect=!1;var e=E(b,"open",function(){d.onopen();c&&c()}),h=E(b,"error",function(b){m("connect_error");d.cleanup();d.readyState="closed";d.emitAll("connect_error",b);if(c){var e=Error("Connection error");
e.data=b;c(e)}else d.maybeReconnectOnOpen()});if(!1!==this._timeout){var n=this._timeout;m("connect attempt will timeout after %d",n);var y=setTimeout(function(){m("connect attempt timed out after %d",n);e.destroy();b.close();b.emit("error","timeout");d.emitAll("connect_timeout",n)},n);this.subs.push({destroy:function(){clearTimeout(y)}})}this.subs.push(e);this.subs.push(h);return this};e.prototype.onopen=function(){m("open");this.cleanup();this.readyState="open";this.emit("open");var c=this.engine;
this.subs.push(E(c,"data",f(this,"ondata")));this.subs.push(E(this.decoder,"decoded",f(this,"ondecoded")));this.subs.push(E(c,"error",f(this,"onerror")));this.subs.push(E(c,"close",f(this,"onclose")))};e.prototype.ondata=function(c){this.decoder.add(c)};e.prototype.ondecoded=function(c){this.emit("packet",c)};e.prototype.onerror=function(c){m("error",c);this.emitAll("error",c)};e.prototype.socket=function(c){var b=this.nsps[c];if(!b){b=new n(this,c);this.nsps[c]=b;var d=this;b.on("connect",function(){b.id=
d.engine.id;~v(d.connected,b)||d.connected.push(b)})}return b};e.prototype.destroy=function(c){c=v(this.connected,c);~c&&this.connected.splice(c,1);this.connected.length||this.close()};e.prototype.packet=function(c){m("writing packet %j",c);var b=this;b.encoding?b.packetBuffer.push(c):(b.encoding=!0,this.encoder.encode(c,function(c){for(var d=0;d<c.length;d++)b.engine.write(c[d]);b.encoding=!1;b.processPacketQueue()}))};e.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var c=
this.packetBuffer.shift();this.packet(c)}};e.prototype.cleanup=function(){for(var c;c=this.subs.shift();)c.destroy();this.packetBuffer=[];this.encoding=!1;this.decoder.destroy()};e.prototype.close=e.prototype.disconnect=function(){this.skipReconnect=!0;this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};e.prototype.onclose=function(c){m("close");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",c);this._reconnection&&!this.skipReconnect&&this.reconnect()};
e.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var c=this;if(this.backoff.attempts>=this._reconnectionAttempts)m("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();m("will wait %dms before reconnect attempt",b);this.reconnecting=!0;var d=setTimeout(function(){c.skipReconnect||(m("attempting reconnect"),c.emitAll("reconnect_attempt",c.backoff.attempts),c.emitAll("reconnecting",c.backoff.attempts),
c.skipReconnect||c.open(function(b){b?(m("reconnect attempt error"),c.reconnecting=!1,c.reconnect(),c.emitAll("reconnect_error",b.data)):(m("reconnect success"),c.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(d)}})}};e.prototype.onreconnect=function(){var c=this.backoff.attempts;this.reconnecting=!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",c)}},{"./on":53,"./socket":54,"./url":55,backo2:4,"component-bind":7,"component-emitter":8,debug:10,"engine.io-client":11,
indexof:32,"object-component":39,"socket.io-parser":57}],53:[function(c,b,d){b.exports=function(c,b,d){c.on(b,d);return{destroy:function(){c.removeListener(b,d)}}}},{}],54:[function(c,b,d){function e(c,b){this.io=c;this.nsp=b;this.json=this;this.ids=0;this.acks={};this.io.autoConnect&&this.open();this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0}var l=c("socket.io-parser");d=c("component-emitter");var n=c("to-array"),y=c("./on"),E=c("component-bind"),f=c("debug")("socket.io-client:socket"),
m=c("has-binary");b.exports=e;var v={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},g=d.prototype.emit;d(e.prototype);e.prototype.subEvents=function(){if(!this.subs){var c=this.io;this.subs=[y(c,"open",E(this,"onopen")),y(c,"packet",E(this,"onpacket")),y(c,"close",E(this,"onclose"))]}};e.prototype.open=e.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==
this.io.readyState)this.onopen();return this};e.prototype.send=function(){var c=n(arguments);c.unshift("message");this.emit.apply(this,c);return this};e.prototype.emit=function(c){if(v.hasOwnProperty(c))return g.apply(this,arguments),this;var b=n(arguments),d=l.EVENT;m(b)&&(d=l.BINARY_EVENT);d={type:d,data:b};"function"==typeof b[b.length-1]&&(f("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),d.id=this.ids++);this.connected?this.packet(d):this.sendBuffer.push(d);return this};
e.prototype.packet=function(c){c.nsp=this.nsp;this.io.packet(c)};e.prototype.onopen=function(){f("transport is open - connecting");"/"!=this.nsp&&this.packet({type:l.CONNECT})};e.prototype.onclose=function(c){f("close (%s)",c);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",c)};e.prototype.onpacket=function(c){if(c.nsp==this.nsp)switch(c.type){case l.CONNECT:this.onconnect();break;case l.EVENT:this.onevent(c);break;case l.BINARY_EVENT:this.onevent(c);break;case l.ACK:this.onack(c);
break;case l.BINARY_ACK:this.onack(c);break;case l.DISCONNECT:this.ondisconnect();break;case l.ERROR:this.emit("error",c.data)}};e.prototype.onevent=function(c){var b=c.data||[];f("emitting event %j",b);null!=c.id&&(f("attaching ack callback to event"),b.push(this.ack(c.id)));this.connected?g.apply(this,b):this.receiveBuffer.push(b)};e.prototype.ack=function(c){var b=this,d=!1;return function(){if(!d){d=!0;var e=n(arguments);f("sending ack %j",e);var h=m(e)?l.BINARY_ACK:l.ACK;b.packet({type:h,id:c,
data:e})}}};e.prototype.onack=function(c){f("calling ack %s with %j",c.id,c.data);this.acks[c.id].apply(this,c.data);delete this.acks[c.id]};e.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};e.prototype.emitBuffered=function(){var c;for(c=0;c<this.receiveBuffer.length;c++)g.apply(this,this.receiveBuffer[c]);this.receiveBuffer=[];for(c=0;c<this.sendBuffer.length;c++)this.packet(this.sendBuffer[c]);this.sendBuffer=[]};e.prototype.ondisconnect=
function(){f("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};e.prototype.destroy=function(){if(this.subs){for(var c=0;c<this.subs.length;c++)this.subs[c].destroy();this.subs=null}this.io.destroy(this)};e.prototype.close=e.prototype.disconnect=function(){this.connected&&(f("performing disconnect (%s)",this.nsp),this.packet({type:l.DISCONNECT}));this.destroy();if(this.connected)this.onclose("io client disconnect");return this}},{"./on":53,"component-bind":7,"component-emitter":8,
debug:10,"has-binary":30,"socket.io-parser":57,"to-array":59}],55:[function(c,b,d){(function(d){var e=c("parseuri"),h=c("debug")("socket.io-client:url");b.exports=function(c,b){var l=c;b=b||d.location;null==c&&(c=b.protocol+"//"+b.host);"string"==typeof c&&("/"==c.charAt(0)&&(c="/"==c.charAt(1)?b.protocol+c:b.hostname+c),/^(https?|wss?):\/\//.test(c)||(h("protocol-less url %s",c),c="undefined"!=typeof b?b.protocol+"//"+c:"https://"+c),h("parse %s",c),l=e(c));l.port||(/^(http|ws)$/.test(l.protocol)?
l.port="80":/^(http|ws)s$/.test(l.protocol)&&(l.port="443"));l.path=l.path||"/";l.id=l.protocol+"://"+l.host+":"+l.port;l.href=l.protocol+"://"+l.host+(b&&b.port==l.port?"":":"+l.port);return l}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{debug:10,parseuri:42}],56:[function(c,b,d){(function(b){var e=c("isarray"),h=c("./is-buffer");d.deconstructPacket=function(c){function b(c){if(!c)return c;if(h(c)){var l={_placeholder:!0,
num:d.length};d.push(c);return l}if(e(c)){l=Array(c.length);for(var n=0;n<c.length;n++)l[n]=b(c[n]);return l}if("object"==typeof c&&!(c instanceof Date)){l={};for(n in c)l[n]=b(c[n]);return l}return c}var d=[];c.data=b(c.data);c.attachments=d.length;return{packet:c,buffers:d}};d.reconstructPacket=function(c,b){function d(c){if(c&&c._placeholder)return b[c.num];if(e(c))for(var h=0;h<c.length;h++)c[h]=d(c[h]);else if(c&&"object"==typeof c)for(h in c)c[h]=d(c[h]);return c}c.data=d(c.data);c.attachments=
void 0;return c};d.removeBlobs=function(c,d){function l(c,E,f){if(!c)return c;if(b.Blob&&c instanceof Blob||b.File&&c instanceof File){n++;var m=new FileReader;m.onload=function(){f?f[E]=this.result:y=this.result;--n||d(y)};m.readAsArrayBuffer(c)}else if(e(c))for(m=0;m<c.length;m++)l(c[m],m,c);else if(c&&"object"==typeof c&&!h(c))for(m in c)l(c[m],m,c)}var n=0,y=c;l(y);n||d(y)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./is-buffer":58,
isarray:33}],57:[function(c,b,d){function e(){}function l(c){var b=!1;var e=""+c.type;if(d.BINARY_EVENT==c.type||d.BINARY_ACK==c.type)e+=c.attachments,e+="-";c.nsp&&"/"!=c.nsp&&(b=!0,e+=c.nsp);null!=c.id&&(b&&(e+=",",b=!1),e+=c.id);null!=c.data&&(b&&(e+=","),e+=L.stringify(c.data));m("encoded %j as %s",c,e);return e}function n(c,b){v.removeBlobs(c,function(c){var d=v.deconstructPacket(c);c=l(d.packet);d=d.buffers;d.unshift(c);b(d)})}function y(){this.reconstructor=null}function f(c){this.reconPack=
c;this.buffers=[]}var m=c("debug")("socket.io-parser"),L=c("json3");c("isarray");b=c("component-emitter");var v=c("./binary"),g=c("./is-buffer");d.protocol=4;d.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" ");d.CONNECT=0;d.DISCONNECT=1;d.EVENT=2;d.ACK=3;d.ERROR=4;d.BINARY_EVENT=5;d.BINARY_ACK=6;d.Encoder=e;d.Decoder=y;e.prototype.encode=function(c,b){m("encoding packet %j",c);d.BINARY_EVENT==c.type||d.BINARY_ACK==c.type?n(c,b):(c=l(c),b([c]))};b(y.prototype);y.prototype.add=
function(c){if("string"==typeof c){a:{var b={},e=0;b.type=Number(c.charAt(0));if(null==d.types[b.type])c={type:d.ERROR,data:"parser error"};else{if(d.BINARY_EVENT==b.type||d.BINARY_ACK==b.type){for(var h="";"-"!=c.charAt(++e)&&(h+=c.charAt(e),e!=c.length););if(h!=Number(h)||"-"!=c.charAt(e))throw Error("Illegal attachments");b.attachments=Number(h)}if("/"==c.charAt(e+1))for(b.nsp="";++e;){h=c.charAt(e);if(","==h)break;b.nsp+=h;if(e==c.length)break}else b.nsp="/";h=c.charAt(e+1);if(""!==h&&Number(h)==
h){for(b.id="";++e;){h=c.charAt(e);if(null==h||Number(h)!=h){--e;break}b.id+=c.charAt(e);if(e==c.length)break}b.id=Number(b.id)}if(c.charAt(++e))try{b.data=L.parse(c.substr(e))}catch(Lg){c={type:d.ERROR,data:"parser error"};break a}m("decoded %s as %j",c,b);c=b}}d.BINARY_EVENT==c.type||d.BINARY_ACK==c.type?(this.reconstructor=new f(c),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",c)):this.emit("decoded",c)}else if(g(c)||c.base64)if(this.reconstructor){if(c=this.reconstructor.takeBinaryData(c))this.reconstructor=
null,this.emit("decoded",c)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+c);};y.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};f.prototype.takeBinaryData=function(c){this.buffers.push(c);return this.buffers.length==this.reconPack.attachments?(c=v.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),c):null};f.prototype.finishedReconstruction=function(){this.reconPack=null;
this.buffers=[]}},{"./binary":56,"./is-buffer":58,"component-emitter":8,debug:10,isarray:33,json3:34}],58:[function(c,b,d){(function(c){b.exports=function(b){return c.Buffer&&c.Buffer.isBuffer(b)||c.ArrayBuffer&&b instanceof ArrayBuffer}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],59:[function(c,b,d){b.exports=function(c,b){for(var d=[],e=(b=b||0)||0;e<c.length;e++)d[e-b]=c[e];return d}},{}],60:[function(c,b,d){(function(c){(function(e){function h(c){for(var b=
[],d=0,e=c.length,h,l;d<e;)h=c.charCodeAt(d++),55296<=h&&56319>=h&&d<e?(l=c.charCodeAt(d++),56320==(l&64512)?b.push(((h&1023)<<10)+(l&1023)+65536):(b.push(h),d--)):b.push(h);return b}function l(c){if(55296<=c&&57343>=c)throw Error("Lone surrogate U+"+c.toString(16).toUpperCase()+" is not a scalar value");}function f(){if(q>=r)throw Error("Invalid byte index");var c=t[q]&255;q++;if(128==(c&192))return c&63;throw Error("Invalid continuation byte");}function m(){if(q>r)throw Error("Invalid byte index");
if(q==r)return!1;var c=t[q]&255;q++;if(0==(c&128))return c;if(192==(c&224)){var b=f();c=(c&31)<<6|b;if(128<=c)return c;throw Error("Invalid continuation byte");}if(224==(c&240)){b=f();var d=f();c=(c&15)<<12|b<<6|d;if(2048<=c)return l(c),c;throw Error("Invalid continuation byte");}if(240==(c&248)){b=f();d=f();var e=f();c=(c&15)<<18|b<<12|d<<6|e;if(65536<=c&&1114111>=c)return c}throw Error("Invalid UTF-8 detected");}var L="object"==typeof d&&d,v="object"==typeof b&&b&&b.exports==L&&b,g="object"==typeof c&&
c;if(g.global===g||g.window===g)e=g;var p=String.fromCharCode,t,r,q;g={version:"2.0.0",encode:function(c){c=h(c);for(var b=c.length,d=-1,e,n="";++d<b;){e=c[d];if(0==(e&4294967168))e=p(e);else{var y="";0==(e&4294965248)?y=p(e>>6&31|192):0==(e&4294901760)?(l(e),y=p(e>>12&15|224),y+=p(e>>6&63|128)):0==(e&4292870144)&&(y=p(e>>18&7|240),y+=p(e>>12&63|128),y+=p(e>>6&63|128));e=y+=p(e&63|128)}n+=e}return n},decode:function(c){t=h(c);r=t.length;q=0;c=[];for(var b;!1!==(b=m());)c.push(b);b=c.length;for(var d=
-1,e,l="";++d<b;)e=c[d],65535<e&&(e-=65536,l+=p(e>>>10&1023|55296),e=56320|e&1023),l+=p(e);return l}};if(L&&!L.nodeType)if(v)v.exports=g;else{e={}.hasOwnProperty;for(var x in g)e.call(g,x)&&(L[x]=g[x])}else e.utf8=g})(this)}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],61:[function(c,b,d){b.exports="function"===typeof Object.create?function(c,b){c.super_=b;c.prototype=Object.create(b.prototype,{constructor:{value:c,enumerable:!1,
writable:!0,configurable:!0}})}:function(c,b){c.super_=b;var d=function(){};d.prototype=b.prototype;c.prototype=new d;c.prototype.constructor=c}},{}],62:[function(c,b,d){b.exports=function(c){return c&&"object"===typeof c&&"function"===typeof c.copy&&"function"===typeof c.fill&&"function"===typeof c.readUInt8}},{}],63:[function(c,b,d){(function(b,e){function h(c,b){var e={seen:[],stylize:f};3<=arguments.length&&(e.depth=arguments[2]);4<=arguments.length&&(e.colors=arguments[3]);x(b)?e.showHidden=
b:b&&d._extend(e,b);w(e.showHidden)&&(e.showHidden=!1);w(e.depth)&&(e.depth=2);w(e.colors)&&(e.colors=!1);w(e.customInspect)&&(e.customInspect=!0);e.colors&&(e.stylize=l);return L(e,c,e.depth)}function l(c,b){return(b=h.styles[b])?"\u001b["+h.colors[b][0]+"m"+c+"\u001b["+h.colors[b][1]+"m":c}function f(c,b){return c}function m(c){var b={};c.forEach(function(c,d){b[c]=!0});return b}function L(c,b,e){if(c.customInspect&&b&&I(b.inspect)&&b.inspect!==d.inspect&&(!b.constructor||b.constructor.prototype!==
b)){var h=b.inspect(e,c);A(h)||(h=L(c,h,e));return h}if(h=v(c,b))return h;var l=Object.keys(b),n=m(l);c.showHidden&&(l=Object.getOwnPropertyNames(b));if(D(b)&&(0<=l.indexOf("message")||0<=l.indexOf("description")))return g(b);if(0===l.length){if(I(b))return c.stylize("[Function"+(b.name?": "+b.name:"")+"]","special");if(z(b))return c.stylize(RegExp.prototype.toString.call(b),"regexp");if(H(b))return c.stylize(Date.prototype.toString.call(b),"date");if(D(b))return g(b)}h="";var y=!1,f=["{","}"];q(b)&&
(y=!0,f=["[","]"]);I(b)&&(h=" [Function"+(b.name?": "+b.name:"")+"]");z(b)&&(h=" "+RegExp.prototype.toString.call(b));H(b)&&(h=" "+Date.prototype.toUTCString.call(b));D(b)&&(h=" "+g(b));if(0===l.length&&(!y||0==b.length))return f[0]+h+f[1];if(0>e)return z(b)?c.stylize(RegExp.prototype.toString.call(b),"regexp"):c.stylize("[Object]","special");c.seen.push(b);l=y?p(c,b,e,n,l):l.map(function(d){return t(c,b,e,n,d,y)});c.seen.pop();return r(l,h,f)}function v(c,b){if(w(b))return c.stylize("undefined",
"undefined");if(A(b))return b="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",c.stylize(b,"string");if(B(b))return c.stylize(""+b,"number");if(x(b))return c.stylize(""+b,"boolean");if(null===b)return c.stylize("null","null")}function g(c){return"["+Error.prototype.toString.call(c)+"]"}function p(c,b,d,e,h){for(var l=[],n=0,y=b.length;n<y;++n)Object.prototype.hasOwnProperty.call(b,String(n))?l.push(t(c,b,d,e,String(n),!0)):l.push("");h.forEach(function(h){h.match(/^\d+$/)||
l.push(t(c,b,d,e,h,!0))});return l}function t(c,b,d,e,h,l){var n,y;b=Object.getOwnPropertyDescriptor(b,h)||{value:b[h]};b.get?y=b.set?c.stylize("[Getter/Setter]","special"):c.stylize("[Getter]","special"):b.set&&(y=c.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(e,h)||(n="["+h+"]");y||(0>c.seen.indexOf(b.value)?(y=null===d?L(c,b.value,null):L(c,b.value,d-1),-1<y.indexOf("\n")&&(y=l?y.split("\n").map(function(c){return"  "+c}).join("\n").substr(2):"\n"+y.split("\n").map(function(c){return"   "+
c}).join("\n"))):y=c.stylize("[Circular]","special"));if(w(n)){if(l&&h.match(/^\d+$/))return y;n=JSON.stringify(""+h);n.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=c.stylize(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=c.stylize(n,"string"))}return n+": "+y}function r(c,b,d){var e=0;return 60<c.reduce(function(c,b){e++;0<=b.indexOf("\n")&&e++;return c+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)?d[0]+(""===b?"":b+"\n ")+" "+c.join(",\n  ")+
" "+d[1]:d[0]+b+" "+c.join(", ")+" "+d[1]}function q(c){return Array.isArray(c)}function x(c){return"boolean"===typeof c}function B(c){return"number"===typeof c}function A(c){return"string"===typeof c}function w(c){return void 0===c}function z(c){return C(c)&&"[object RegExp]"===Object.prototype.toString.call(c)}function C(c){return"object"===typeof c&&null!==c}function H(c){return C(c)&&"[object Date]"===Object.prototype.toString.call(c)}function D(c){return C(c)&&("[object Error]"===Object.prototype.toString.call(c)||
c instanceof Error)}function I(c){return"function"===typeof c}function G(c){return 10>c?"0"+c.toString(10):c.toString(10)}function J(){var c=new Date,b=[G(c.getHours()),G(c.getMinutes()),G(c.getSeconds())].join(":");return[c.getDate(),O[c.getMonth()],b].join(" ")}var N=/%[sdj%]/g;d.format=function(c){if(!A(c)){for(var b=[],d=0;d<arguments.length;d++)b.push(h(arguments[d]));return b.join(" ")}d=1;var e=arguments,l=e.length;b=String(c).replace(N,function(c){if("%%"===c)return"%";if(d>=l)return c;switch(c){case "%s":return String(e[d++]);
case "%d":return Number(e[d++]);case "%j":try{return JSON.stringify(e[d++])}catch(Pn){return"[Circular]"}default:return c}});for(var n=e[d];d<l;n=e[++d])b=null!==n&&C(n)?b+(" "+h(n)):b+(" "+n);return b};d.deprecate=function(c,h){if(w(e.process))return function(){return d.deprecate(c,h).apply(this,arguments)};if(!0===b.noDeprecation)return c;var l=!1;return function(){if(!l){if(b.throwDeprecation)throw Error(h);b.traceDeprecation?console.trace(h):console.error(h);l=!0}return c.apply(this,arguments)}};
var F={},P;d.debuglog=function(c){w(P)&&(P=b.env.NODE_DEBUG||"");c=c.toUpperCase();if(!F[c])if((new RegExp("\\b"+c+"\\b","i")).test(P)){var e=b.pid;F[c]=function(){var b=d.format.apply(d,arguments);console.error("%s %d: %s",c,e,b)}}else F[c]=function(){};return F[c]};d.inspect=h;h.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};h.styles={special:"cyan",number:"yellow",
"boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};d.isArray=q;d.isBoolean=x;d.isNull=function(c){return null===c};d.isNullOrUndefined=function(c){return null==c};d.isNumber=B;d.isString=A;d.isSymbol=function(c){return"symbol"===typeof c};d.isUndefined=w;d.isRegExp=z;d.isObject=C;d.isDate=H;d.isError=D;d.isFunction=I;d.isPrimitive=function(c){return null===c||"boolean"===typeof c||"number"===typeof c||"string"===typeof c||"symbol"===typeof c||"undefined"===
typeof c};d.isBuffer=c("./support/isBuffer");var O="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");d.log=function(){console.log("%s - %s",J(),d.format.apply(d,arguments))};d.inherits=c("inherits");d._extend=function(c,b){if(!b||!C(b))return c;for(var d=Object.keys(b),e=d.length;e--;)c[d[e]]=b[d[e]];return c}}).call(this,c("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":62,_process:43,inherits:61}],
64:[function(c,b,d){if(window.mozRTCPeerConnection||navigator.mozGetUserMedia){var e="moz";var l=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)}else if(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)e="webkit",l=navigator.userAgent.match(/Chrom(e|ium)/)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10);c=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;d=window.mozRTCIceCandidate||window.RTCIceCandidate;var n=
window.mozRTCSessionDescription||window.RTCSessionDescription,y=window.webkitMediaStream||window.MediaStream,f="https:"===window.location.protocol&&("webkit"===e&&26<=l||"moz"===e&&33<=l),m=window.AudioContext||window.webkitAudioContext,g=document.createElement("video");g=g&&g.canPlayType&&"probably"===g.canPlayType('video/webm; codecs="vp8", vorbis');var v=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;b.exports={prefix:e,browserVersion:l,
support:!!c&&!!v,supportRTCPeerConnection:!!c,supportVp8:g,supportGetUserMedia:!!v,supportDataChannel:!!(c&&c.prototype&&c.prototype.createDataChannel),supportWebAudio:!(!m||!m.prototype.createMediaStreamSource),supportMediaStream:!(!y||!y.prototype.removeTrack),supportScreenSharing:!!f,AudioContext:m,PeerConnection:c,SessionDescription:n,IceCandidate:d,MediaStream:y,getUserMedia:v}},{}],65:[function(c,b,d){function e(){}b.exports=e;e.mixin=function(c){c=c.prototype||c;c.isWildEmitter=!0;c.on=function(c,
b,d){this.callbacks=this.callbacks||{};var e=3===arguments.length,h=e?arguments[2]:arguments[1];h._groupName=e?arguments[1]:void 0;(this.callbacks[c]=this.callbacks[c]||[]).push(h);return this};c.once=function(c,b,d){function e(){h.off(c,e);n.apply(this,arguments)}var h=this,l=3===arguments.length,n=l?arguments[2]:arguments[1];this.on(c,l?arguments[1]:void 0,e);return this};c.releaseGroup=function(c){this.callbacks=this.callbacks||{};var b,d;for(b in this.callbacks){var e=this.callbacks[b];var h=
0;for(d=e.length;h<d;h++)e[h]._groupName===c&&(e.splice(h,1),h--,d--)}return this};c.off=function(c,b){this.callbacks=this.callbacks||{};var d=this.callbacks[c];if(!d)return this;if(1===arguments.length)return delete this.callbacks[c],this;var e=d.indexOf(b);d.splice(e,1);0===d.length&&delete this.callbacks[c];return this};c.emit=function(c){this.callbacks=this.callbacks||{};var b=[].slice.call(arguments,1),d=this.callbacks[c],e=this.getWildcardCallbacks(c),h;if(d){var l=d.slice();d=0;for(h=l.length;d<
h&&l[d];++d)l[d].apply(this,b)}if(e)for(l=e.slice(),d=0,h=l.length;d<h&&l[d];++d)l[d].apply(this,[c].concat(b));return this};c.getWildcardCallbacks=function(c){this.callbacks=this.callbacks||{};var b,d=[];for(b in this.callbacks){var e=b.split("*");if("*"===b||2===e.length&&c.slice(0,e[0].length)===e[0])d=d.concat(this.callbacks[b])}return d}};e.mixin(e)},{}],66:[function(c,b,d){function e(c,b,d){return b?new l(c,b):new l(c)}c=window;var l=c.WebSocket||c.MozWebSocket;b.exports=l?e:null;l&&(e.prototype=
l.prototype)},{}],67:[function(c,b,d){function e(c){var b=!0;c.getTracks().forEach(function(c){b="ended"===c.readyState&&b});return b}function l(c){var b=this;f.call(this);this.id=c.id;this.parent=c.parent;this.type=c.type||"video";this.oneway=c.oneway||!1;this.sharemyscreen=c.sharemyscreen||!1;this.browserPrefix=c.prefix;this.stream=c.stream;this.enableDataChannels=void 0===c.enableDataChannels?this.parent.config.enableDataChannels:c.enableDataChannels;this.receiveMedia=c.receiveMedia||this.parent.config.receiveMedia;
this.channels={};this.sid=c.sid||Date.now().toString();this.pc=new y(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints);this.pc.on("ice",this.onIceCandidate.bind(this));this.pc.on("endOfCandidates",function(c){b.send("endOfCandidates",c)});this.pc.on("offer",function(c){b.parent.config.nick&&(c.nick=b.parent.config.nick);b.send("offer",c)});this.pc.on("answer",function(c){b.parent.config.nick&&(c.nick=b.parent.config.nick);b.send("answer",c)});this.pc.on("addStream",
this.handleRemoteStreamAdded.bind(this));this.pc.on("addChannel",this.handleDataChannelAdded.bind(this));this.pc.on("removeStream",this.handleStreamRemoved.bind(this));this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded"));this.pc.on("iceConnectionStateChange",this.emit.bind(this,"iceConnectionStateChange"));this.pc.on("iceConnectionStateChange",function(){switch(b.pc.iceConnectionState){case "failed":"offer"===b.pc.pc.localDescription.type&&(b.parent.emit("iceFailed",b),b.send("connectivityError"))}});
this.pc.on("signalingStateChange",this.emit.bind(this,"signalingStateChange"));this.logger=this.parent.logger;"screen"===c.type?this.parent.localScreens&&this.parent.localScreens[0]&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),this.pc.addStream(this.parent.localScreens[0]),this.broadcaster=c.broadcaster):this.parent.localStreams.forEach(function(c){b.pc.addStream(c)});this.on("channelOpen",function(c){"https://simplewebrtc.com/protocol/filetransfer#inband-v1"===
c.protocol&&(c.onmessage=function(d){d=JSON.parse(d.data);var e=new m.Receiver;e.receive(d,c);b.emit("fileTransfer",d,e);e.on("receivedFile",function(c,b){e.channel.close()})})});this.on("*",function(){b.parent.emit.apply(b.parent,arguments)})}d=c("util");var n=c("webrtcsupport"),y=c("rtcpeerconnection"),f=c("wildemitter"),m=c("filetransfer");d.inherits(l,f);l.prototype.handleMessage=function(c){var b=this;this.logger.log("getting",c.type,c);c.prefix&&(this.browserPrefix=c.prefix);"offer"===c.type?
(this.nick||(this.nick=c.payload.nick),delete c.payload.nick,this.pc.handleOffer(c.payload,function(c){c||b.pc.answer(function(c,b){})})):"answer"===c.type?(this.nick||(this.nick=c.payload.nick),delete c.payload.nick,this.pc.handleAnswer(c.payload)):"candidate"===c.type?this.pc.processIce(c.payload):"connectivityError"===c.type?this.parent.emit("connectivityError",b):"mute"===c.type?this.parent.emit("mute",{id:c.from,name:c.payload.name}):"unmute"===c.type&&this.parent.emit("unmute",{id:c.from,name:c.payload.name})};
l.prototype.send=function(c,b){b={to:this.id,sid:this.sid,broadcaster:this.broadcaster,roomType:this.type,type:c,payload:b,prefix:n.prefix};this.logger.log("sending",c,b);this.parent.emit("message",b)};l.prototype.sendDirectly=function(c,b,d){this.logger.log("sending via datachannel",c,b,{type:b,payload:d});c=this.getDataChannel(c);if("open"!=c.readyState)return!1;c.send(d);return!0};l.prototype._observeDataChannel=function(c){var b=this;c.binaryType="arraybuffer";c.onclose=this.emit.bind(this,"channelClose",
c);c.onerror=this.emit.bind(this,"channelError",c);c.onmessage=function(d){var e=new Uint32Array(d.data);b.emit("channelMessage",b,c.label,e,c,d)};c.onopen=this.emit.bind(this,"channelOpen",c)};l.prototype.getDataChannel=function(c,b){if(!n.supportDataChannel)return this.emit("error",Error("createDataChannel not supported"));var d=this.channels[c];b||(b={});if(d)return d;d=this.channels[c]=this.pc.createDataChannel(c,b);d.binaryType="arraybuffer";this._observeDataChannel(d);return d};l.prototype.onIceCandidate=
function(c){if(!this.closed)if(c){var b=this.parent.config.peerConnectionConfig;"moz"===n.prefix&&b&&b.iceTransports&&c.candidate&&c.candidate.candidate&&0>c.candidate.candidate.indexOf(b.iceTransports)?this.logger.log("Ignoring ice candidate not matching pcConfig iceTransports type: ",b.iceTransports):this.send("candidate",c)}else this.logger.log("End of candidates.")};l.prototype.start=function(){this.enableDataChannels&&this.getDataChannel("simplewebrtc");this.pc.offer(this.receiveMedia,function(c,
b){})};l.prototype.icerestart=function(){var c=this.receiveMedia;c.mandatory.IceRestart=!0;this.pc.offer(c,function(c,b){})};l.prototype.end=function(){this.closed||(this.pc.close(),this.handleStreamRemoved())};l.prototype.handleRemoteStreamAdded=function(c){var b=this;this.stream?this.logger.warn("Already have a remote stream"):(this.stream=c.stream,this.stream.getTracks().forEach(function(c){c.addEventListener("ended",function(){e(b.stream)&&b.end()})}),this.parent.emit("peerStreamAdded",this))};
l.prototype.handleStreamRemoved=function(){var c=this.parent.peers.indexOf(this);-1<c&&(this.parent.peers.splice(c,1),this.closed=!0,this.parent.emit("peerStreamRemoved",this))};l.prototype.handleDataChannelAdded=function(c){this.channels[c.label]=c;this._observeDataChannel(c)};l.prototype.sendFile=function(c){var b=new m.Sender,d=this.getDataChannel("filetransfer"+(new Date).getTime(),{protocol:"https://simplewebrtc.com/protocol/filetransfer#inband-v1"});d.onopen=function(){d.send(JSON.stringify({size:c.size,
name:c.name}));b.send(c,d)};d.onclose=function(){console.log("sender received transfer");b.emit("complete")};return b};b.exports=l},{filetransfer:26,rtcpeerconnection:44,util:63,webrtcsupport:64,wildemitter:65}],68:[function(c,b,d){function e(c){var b=this,d=c||{},e=this.config={url:"https://sandbox.simplewebrtc.com:443/",socketio:{},connection:null,debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!1,peerVolumeWhenSpeaking:.25,
media:{video:!0,audio:!0},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},localVideo:{autoplay:!0,mirror:!0,muted:!0}},h;var E=c.debug?c.logger||console:c.logger||m;this.logger=E;for(h in d)d.hasOwnProperty(h)&&(this.config[h]=d[h]);this.capabilities=y;n.call(this);var K=null===this.config.connection?this.connection=new g(this.config):this.connection=this.config.connection;K.on("connect",function(){b.emit("connectionReady",K.getSessionid());b.sessionReady=!0;b.testReadiness()});K.on("message",
function(c){var d=b.webrtc.getPeers(c.from,c.roomType);if("offer"===c.type){d.length&&d.forEach(function(b){b.sid==c.sid&&(e=b)});if(!e){var e=b.webrtc.createPeer({id:c.from,sid:c.sid,type:c.roomType,enableDataChannels:b.config.enableDataChannels&&"screen"!==c.roomType,sharemyscreen:"screen"===c.roomType&&!c.broadcaster,broadcaster:"screen"!==c.roomType||c.broadcaster?null:b.connection.getSessionid()});b.emit("createdPeer",e)}e.handleMessage(c)}else d.length&&d.forEach(function(b){c.sid?b.sid===c.sid&&
b.handleMessage(c):b.handleMessage(c)})});K.on("remove",function(c){c.id!==b.connection.getSessionid()&&b.webrtc.removePeers(c.id,c.type)});c.logger=this.logger;c.debug=!1;this.webrtc=new l(c);"mute unmute pauseVideo resumeVideo pause resume sendToAll sendDirectlyToAll getPeers".split(" ").forEach(function(c){b[c]=b.webrtc[c].bind(b.webrtc)});this.webrtc.on("*",function(){b.emit.apply(b,arguments)});if(e.debug)this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:"));this.webrtc.on("localStream",
function(){b.testReadiness()});this.webrtc.on("message",function(c){b.connection.emit("message",c)});this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this));this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this));this.config.adjustPeerVolume&&(this.webrtc.on("speaking",this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1)));K.on("stunservers",function(c){b.webrtc.config.peerConnectionConfig.iceServers=
c;b.emit("stunservers",c)});K.on("turnservers",function(c){b.webrtc.config.peerConnectionConfig.iceServers=b.webrtc.config.peerConnectionConfig.iceServers.concat(c);b.emit("turnservers",c)});this.webrtc.on("iceFailed",function(c){});this.webrtc.on("connectivityError",function(c){});this.webrtc.on("audioOn",function(){b.webrtc.sendToAll("unmute",{name:"audio"})});this.webrtc.on("audioOff",function(){b.webrtc.sendToAll("mute",{name:"audio"})});this.webrtc.on("videoOn",function(){b.webrtc.sendToAll("unmute",
{name:"video"})});this.webrtc.on("videoOff",function(){b.webrtc.sendToAll("mute",{name:"video"})});this.webrtc.on("localScreen",function(c){var d=document.createElement("video"),e=b.getRemoteVideoContainer();d.oncontextmenu=function(){return!1};d.id="localScreen";f(c,d);e&&e.appendChild(d);b.emit("localScreenAdded",d);b.connection.emit("shareScreen");b.webrtc.peers.forEach(function(c){"video"===c.type&&(c=b.webrtc.createPeer({id:c.id,type:"screen",sharemyscreen:!0,enableDataChannels:!1,receiveMedia:{offerToReceiveAudio:0,
offerToReceiveVideo:0},broadcaster:b.connection.getSessionid()}),b.emit("createdPeer",c),c.start())})});this.webrtc.on("localScreenStopped",function(c){b.getLocalScreen()&&b.stopScreenShare()});this.webrtc.on("channelMessage",function(c,d,e){"volume"==e.type&&b.emit("remoteVolumeChange",c,e.volume)});this.config.autoRequestMedia&&this.startLocalVideo()}var l=c("./webrtc"),n=c("wildemitter"),y=c("webrtcsupport"),f=c("attachmediastream"),m=c("mockconsole"),g=c("./socketioconnection");e.prototype=Object.create(n.prototype,
{constructor:{value:e}});e.prototype.leaveRoom=function(){if(this.roomName){for(this.connection.emit("leave");this.webrtc.peers.length;)this.webrtc.peers[0].end();this.getLocalScreen()&&this.stopScreenShare();this.emit("leftRoom",this.roomName);this.roomName=void 0}};e.prototype.disconnect=function(){this.connection.disconnect();delete this.connection};e.prototype.handlePeerStreamAdded=function(c){var b=this,d=this.getRemoteVideoContainer(),e=f(c.stream);c.videoEl=e;e.id=this.getDomId(c);d&&d.appendChild(e);
this.emit("videoAdded",e,c);window.setTimeout(function(){b.webrtc.isAudioEnabled()||c.send("mute",{name:"audio"});b.webrtc.isVideoEnabled()||c.send("mute",{name:"video"})},250)};e.prototype.handlePeerStreamRemoved=function(c){var b=this.getRemoteVideoContainer(),d=c.videoEl;this.config.autoRemoveVideos&&b&&d&&b.removeChild(d);d&&this.emit("videoRemoved",d,c)};e.prototype.getDomId=function(c){return[c.id,c.type,c.broadcaster?"broadcasting":"incoming"].join("_")};e.prototype.setVolumeForAll=function(c){this.webrtc.peers.forEach(function(b){b.videoEl&&
(b.videoEl.volume=c)})};e.prototype.joinRoom=function(c,b){var d=this;this.roomName=c;this.connection.emit("join",c,function(e,h){console.log("join CB",e);if(e)d.emit("error",e);else{if(!h.xtra){Ab();M("game");ec();zd(r.ERR_GAMELOAD,"#ff0000");return}w.room=h.xtra;var l,n;for(l in h.clients){var y=h.clients[l];for(n in y)if(y[n]){var f=d.webrtc.createPeer({id:l,type:n,enableDataChannels:d.config.enableDataChannels&&"screen"!==n,receiveMedia:{offerToReceiveAudio:"screen"!==n&&d.config.receiveMedia.offerToReceiveAudio?
1:0,offerToReceiveVideo:d.config.receiveMedia.offerToReceiveVideo}});d.emit("createdPeer",f);f.start()}}}b&&b(e,h);d.emit("joinedRoom",c)})};e.prototype.getEl=function(c){return"string"===typeof c?document.getElementById(c):c};e.prototype.startLocalVideo=function(){var c=this;this.webrtc.start(this.config.media,function(b,d){b?c.emit("localMediaError",b):f(d,c.getLocalVideoContainer(),c.config.localVideo)})};e.prototype.stopLocalVideo=function(){this.webrtc.stop()};e.prototype.getLocalVideoContainer=
function(){var c=this.getEl(this.config.localVideoEl);if(c&&"VIDEO"===c.tagName)return c.oncontextmenu=function(){return!1},c;if(c){var b=document.createElement("video");b.oncontextmenu=function(){return!1};c.appendChild(b);return b}};e.prototype.getRemoteVideoContainer=function(){return this.getEl(this.config.remoteVideosEl)};e.prototype.shareScreen=function(c){this.webrtc.startScreenShare(c)};e.prototype.getLocalScreen=function(){return this.webrtc.localScreens&&this.webrtc.localScreens[0]};e.prototype.stopScreenShare=
function(){this.connection.emit("unshareScreen");var c=document.getElementById("localScreen"),b=this.getRemoteVideoContainer();this.config.autoRemoveVideos&&b&&c&&b.removeChild(c);c&&this.emit("videoRemoved",c);this.getLocalScreen()&&this.webrtc.stopScreenShare();this.webrtc.peers.forEach(function(c){c.broadcaster&&c.end()})};e.prototype.testReadiness=function(){this.sessionReady&&(this.config.media.video||this.config.media.audio?0<this.webrtc.localStreams.length&&this.emit("readyToCall",this.connection.getSessionid()):
this.emit("readyToCall",this.connection.getSessionid()))};e.prototype.createRoom=function(c,b){this.roomName=c;this.connection.emit("create",w.room,b)};e.prototype.sendFile=function(){if(!y.dataChannel)return this.emit("error",Error("DataChannelNotSupported"))};b.exports=e},{"./socketioconnection":69,"./webrtc":70,attachmediastream:3,mockconsole:37,webrtcsupport:64,wildemitter:65}],69:[function(c,b,d){function e(c){this.connection=l.connect(c.url,c.socketio)}var l=c("socket.io-client");e.prototype.on=
function(c,b){this.connection.on(c,b)};e.prototype.emit=function(){this.connection.emit.apply(this.connection,arguments)};e.prototype.getSessionid=function(){return this.connection.id};e.prototype.disconnect=function(){return this.connection.disconnect()};b.exports=e},{"socket.io-client":50}],70:[function(c,b,d){function e(c){var b=this,d=c||{};this.config={debug:!1,peerConnectionConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[]},receiveMedia:{offerToReceiveAudio:1,
offerToReceiveVideo:1},enableDataChannels:!0};var e;c=c.debug?c.logger||console:c.logger||n;this.logger=c;for(e in d)d.hasOwnProperty(e)&&(this.config[e]=d[e]);l.support||this.logger.error("Your browser doesn't seem to support WebRTC");this.peers=[];y.call(this,this.config);this.on("speaking",function(){b.hardMuted||b.peers.forEach(function(c){c.enableDataChannels&&(c=c.getDataChannel("hark"),"open"==c.readyState&&c.send(JSON.stringify({type:"speaking"})))})});this.on("stoppedSpeaking",function(){b.hardMuted||
b.peers.forEach(function(c){c.enableDataChannels&&(c=c.getDataChannel("hark"),"open"==c.readyState&&c.send(JSON.stringify({type:"stoppedSpeaking"})))})});this.on("volumeChange",function(c,d){b.hardMuted||b.peers.forEach(function(b){b.enableDataChannels&&(b=b.getDataChannel("hark"),"open"==b.readyState&&b.send(JSON.stringify({type:"volume",volume:c})))})});if(this.config.debug)this.on("*",function(c,d,e){(b.config.logger===n?console:b.logger).log("event:",c,d,e)})}d=c("util");var l=c("webrtcsupport"),
n=c("mockconsole"),y=c("localmedia"),f=c("./peer");d.inherits(e,y);e.prototype.createPeer=function(c){c.parent=this;c=new f(c);this.peers.push(c);return c};e.prototype.removePeers=function(c,b){this.getPeers(c,b).forEach(function(c){c.end()})};e.prototype.getPeers=function(c,b){return this.peers.filter(function(d){return(!c||d.id===c)&&(!b||d.type===b)})};e.prototype.sendToAll=function(c,b){this.peers.forEach(function(d){d.send(c,b)})};e.prototype.sendDirectlyToAll=function(c,b,d){this.peers.forEach(function(e){e.enableDataChannels&&
e.sendDirectly(c,b,d)})};b.exports=e},{"./peer":67,localmedia:35,mockconsole:37,util:63,webrtcsupport:64}]},{},[68])(68)})},H,Da,w={name:localStorage.name,color:localStorage.color||"#ff0000"},Xb=function(){};console.log("%c nehhon %c POWER ","background: #00ffd4; color: #000; font-size:20px","background: #000; color: #00ffd4; font-size:20px");console.log("%c webmaster@nehhon.com ","background: #00ffd4; color: #000; font-size:20px");console.log("%c @nehhon ","background: #000; color: #00ffd4; font-size:20px");
var r,p=function(b){return document.getElementById(b)},sa=function(b,c,e){void 0===localStorage[b]&&(localStorage[b]=c);e&&(p(e).value=localStorage[b])};void 0===localStorage.fullscreen&&(localStorage.fullscreen=!0);sa("favMusic","originalMusic");sa("musicRange",36);sa("soundRange",100);sa("goldRes",400);sa("foodRes",400);sa("stoneRes",400);sa("woodRes",400);sa("nplayed",0);sa("infinity","true");sa("mapx",256);sa("terrainType","grass");sa("terrain","grass");sa("water","0");sa("items","10");sa("peons",
"3");sa("gateways","1");sa("freePop","1");sa("zoomMult",70);sa("scrollSpeed",50);console.log=Xb;console.error=Xb;console.warn=Xb;console.info=Xb;"tza.red"!==location.hostname&&(location.href="https://tza.red");window.addEventListener("error",function(b){Cb(b.lineno+":"+b.colno+" "+b.message,"error")});var Yl=function(b){b.parentNode.removeChild(b)},zd=function(b,c){var k=p("notifybar"),d=document.createElement("div");d.innerHTML=b;c&&(d.style.background=c);k.appendChild(d);setTimeout(Yl,11E3,d)},
Zl=location;(function(){var b=!!window.opr||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),c="undefined"!==typeof InstallTrigger,e=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),d=!!document.documentMode,h=!d&&!!window.StyleMedia,l=!!window.chrome&&!!window.chrome.webstore,n;b?n="Opera":c?n="Firefox":e?n="Safari":d?n="IE":h?n="Edge":l&&(n="Chrome");w.navLang=localStorage.language||navigator.language||navigator.userLanguage;b=w.navLang.substr(0,2);c={es:["Tzared",
"Juego de estrategia en tiempo real para navegadores web, juega solo o con amigos","tzared,jugar,multijugador,juego,online,navegador web,tzar"],it:["Tzared","Gioco di strategia in tempo reale per browser web, giocare da soli o con gli amici","tzared,giocare,multigiocatore,gioco,online,navigatore,tzar,web"],pl:["Tzared","Gra strategiczna w czasie rzeczywistym dla przegl\u0105darek internetowych, bawi\u0107 si\u0119 samotnie lub z przyjaci\u00f3\u0142mi","tzared,gra,multiplayer,online,tzar,przegl\u0105darka internetowa"],
ru:["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u043b\u044f \u0432\u0435\u0431-\u0431\u0440\u0430\u0443\u0437\u0435\u0440\u043e\u0432, \u0438\u0433\u0440\u0430\u0442\u044c \u0432 \u043e\u0434\u0438\u043d\u043e\u0447\u043a\u0443 \u0438\u043b\u0438 \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438","\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u044c\u0442\u0438\u043f\u043b\u0435\u0435\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u0435\u0440,\u043e\u0433\u043d\u0451\u043c \u0438 \u043c\u0435\u0447\u043e\u043c"],
pt:["Tzared","Jogo de estrat\u00e9gia em tempo real para navegadores da web, jogar sozinho ou com amigos","tzared,jogar,multiplayer,jogo,online,navegador web,tzar"],bg:["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0447\u0435\u0441\u043a\u0430 \u0438\u0433\u0440\u0430 \u0432 \u0440\u0435\u0430\u043b\u043d\u043e \u0432\u0440\u0435\u043c\u0435 \u0437\u0430 \u0443\u0435\u0431 \u0431\u0440\u0430\u0443\u0437\u044a\u0440\u0438, \u0438\u0433\u0440\u0430\u0439\u0442\u0435 \u0441\u0430\u043c\u0438 \u0438\u043b\u0438 \u0441 \u043f\u0440\u0438\u044f\u0442\u0435\u043b\u0438",
"\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u0442\u0438\u043f\u043b\u0435\u0439\u044a\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u044a\u0440"],de:["Tzared","Echtzeit-Strategiespiel f\u00fcr Webbrowser, alleine oder mit Freunden spielen","tzared,multiplayer,spiel,online,Webbrowser,tzar"],en:["Tzared","Real-time strategy game for web browsers, play alone or with friends","tzared,play,multiplayer,game,online,browser,tzar,web"]};c[b]||(b=
"en");document.getElementsByTagName("html")[0].lang=b;c=c[location.search.split("lang=")[1]||"en"];document.title=c[0];w.title=c[0];document.getElementsByTagName("meta").description=c[1];document.getElementsByTagName("meta").keywords=c[2];w.versionInt=346;w.version="v"+w.versionInt/10;w.versionDate=Date.now()-1556648496591;localStorage.version!==w.version&&(localStorage.version=w.version,zd("Updated to "+w.version));p("info").innerHTML="Work in progress - Beta "+w.version+" - Updated "+~~(w.versionDate/
864E5)+" days ago";w.lang="en es it pt ru pl bg de".split(" ").indexOf(b);0>w.lang&&(w.lang=0);w.langstr=b;w.team=0;w.race=0;w.navigator=n;w.mx=151;w.onlineID=null;w.temperature=0;w.cdn="/nehhon/"})();window.onload=function(){};var Ni=function(b){b--;var c=new XMLHttpRequest;c.open("GET","/nehhon/"+w.langstr+".json",!0);c.onload=function(){r=JSON.parse(c.response);La=[r.SP_SETUPMAP_RACE_1.split("|")[0],r.SP_SETUPMAP_RACE_2.split("|")[0],r.SP_SETUPMAP_RACE_3.split("|")[0],r.ORDERS_NAMES_E_COMMON.toLocaleUpperCase()];
for(var b=["refreshButton",r.GENERAL_REFRESH,"optionsButton",r.MENU_OPTI,"startButton",r.MP_MPLAYER_PLAY,"backButton",r.CAMPAIGN_BACK,"closeButton",r.GENERAL_CLOSE,"quitButton",r.MENU_QUIT,"continueButton",r.MSG_SYS_CONT],k=0,h=b.length;k<h;k+=2)for(var l=document.getElementsByClassName(b[k]),n=0,y=l.length;n<y;n++)l[n].innerHTML=b[k+1];b=["mult0",r.MAINSCR_MULTI.split("|")[0],"rnd0",r.MAINSCR_SINGLE.split("| ")[0],"load0",r.SINGLESCR_LOAD.split("| ")[1],"editor0",r.MAPEDITOR,"settings0",r.MP_MPLAYER_SETTINGS,
"about",r.ABOUT,"multSection",r.MAINSCR_MULTI.split("|")[0],"offlineSection",r.MAINSCR_SINGLE.split("|")[0],"savelocal",r.SAVE_GAME_CONTENT];k=0;for(h=b.length;k<h;k+=2)p(b[k])&&(p(b[k]).innerHTML=b[k+1])};c.send()};Ni(w.lang);Ni.translated=!0;var C=console.log,Cb=function(b,c,e){var k=p("alert");k||(ue("alert"),k=p("alert"),k.innerHTML='\n<div id="playingMenu" style=""></div>\n            <div id="alert" style="">\n                <div>\n                    <h3 id="alerttitle"></h3>\n                    <div id="alerttext"></div>\n                    <button id="alertok">'+
r.DLG_BTNS_OK+"</button>\n                </div>\n            </div>");var h=p("alerttitle"),l=p("alerttext");p("alertok").onclick=function(){M("alert");Ab()};k.style.display="block";h.innerHTML=c||r.TZAREDIT_S2;l.innerHTML=b;e?p("alertok").style.display="none":p("alertok").style.display="block";p("basic").style.filter="blur(94px)"},$l=[1E3,0,2E3,0],am=function(b,c,e){for(var k=0,h={},l=0;l<b.length;h={url:h.url},l++)h.url=w.cdn+b[l],-1===c.indexOf(h.url)&&fetch(h.url).then(function(c){return c.arrayBuffer()}).then(function(c){return function(d){k++;
e.innerHTML=100*k/b.length+"%";k==b.length&&(e.style.display="none");Oi({url:c.url,buffer:d})}}(h))},Pi=function(){for(var b=[Ad.content.common,Ad.content.icons],c=Object.keys(Bd),e=0;e<c.length;e++)b.put(Bd[c[e]].url);return b},Og=function(){var b=this;navigator.storage&&navigator.storage.persist&&navigator.storage.persist().then(function(c){c?Ng("basic",function(c){c=c.target.result;C(this);am(Pi(),c,b);b.innerHTML="0%";b.onclick=null;Og.button=this}):Cb("Storage may be cleared by the UA under storage pressure.")})};
Og.loaded=0;var ca={size:512,load:0,xtra:[],common:1,xtraRes:[]},m,ab=function(b){b.target.loadedSize||(ab.total+=b.total,b.target.lastLoaded=0,b.target.loadedSize=!0);ab.progress+=b.loaded-b.target.lastLoaded;b.target.lastLoaded=b.loaded;p("loadingtext").innerHTML=r.DOWNLOADING_GRAPHICS+~~(100*ab.progress/ab.total)+"%"};ca.check=function(){C("asdasd",ca.load,ca.images);ca.load++;if(ca.load===ca.images){bm();f.activeTexture(f.TEXTURE0);var b=f.createTexture();f.bindTexture(f.TEXTURE_2D,b);Ba?f.texImage2D(f.TEXTURE_2D,
0,f.RGBA,512,512,0,f.RGBA,f.FLOAT,ca.info):f.texImage2D(f.TEXTURE_2D,0,f.RGBA32F,512,512,0,f.RGBA,f.FLOAT,ca.info);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT);f.uniform1i(f.getUniformLocation(ea,"u_image1"),0);var c=performance.now(),e=ca.common;if(Ba){c=4*Math.pow(4096,2);for(var d=Math.ceil(e.length/c),h=0;h<
d;h++){f.activeTexture(f.TEXTURE6+h);var l=f.createTexture();f.bindTexture(f.TEXTURE_2D,l);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT);l=new Uint8Array(e.buffer,e.byteOffset+c*h,c);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,4096,4096,0,f.RGBA,f.UNSIGNED_BYTE,l);f.uniform1i(f.getUniformLocation(ea,"img_common["+h+"]"),
6+h);f.useProgram(aa);f.uniform1i(f.getUniformLocation(aa,"img_common["+h+"]"),6+h);f.useProgram(ea)}f.useProgram(aa)}else f.activeTexture(f.TEXTURE1),l=f.createTexture(),f.bindTexture(f.TEXTURE_2D_ARRAY,l),f.texParameteri(f.TEXTURE_2D_ARRAY,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D_ARRAY,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texImage3D(f.TEXTURE_2D_ARRAY,0,f.RGBA,ca.size,ca.size,e.length/(ca.size*ca.size*4),0,f.RGBA,f.UNSIGNED_BYTE,e),f.uniform1i(f.getUniformLocation(ea,"img_common"),
1),C("3dtex",performance.now()-c),f.useProgram(aa),f.activeTexture(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D_ARRAY,l),f.uniform1i(f.getUniformLocation(aa,"img_common"),0);f.activeTexture(f.TEXTURE5);f.bindTexture(f.TEXTURE_2D,b);f.uniform1i(f.getUniformLocation(aa,"u_image1"),5);z.delTexs();f.activeTexture(f.TEXTURE2);cm();Db.check()}};var Ce,fm=function(b){p("loadingtext").innerHTML=r.DOWNLOADING_GRAPHICS;Ng("basic",function(c){Ce=c.target.result;c=1048576*(323+Bd[t.terrainType||"grass"].size);ca.common=
De(z.crtStxt(c),c);ca.images=Object.keys(b).length+1;ca.load=0;ab.progress=0;ab.total=0;Date.now();qa.icons?ca.check():Ee(w.cdn+b.icons,function(c){C(c);c=new Uint8Array(c);c=new Blob([c],{type:"image/png"});var b=new Image;b.src=URL.createObjectURL(c);qa.icons=b;b.onload=ca.check},ab);Ee(w.cdn+b.common,dm,ab);p("terrainSelect")&&(localStorage.terrain=p("terrainSelect").value);t.terrainType=localStorage.terrain;c=Bd[t.terrainType||"grass"];C(c);Ee(w.cdn+c.url,em,ab)})},Ad=function(){ca.started=!0;
fm(Ad.content)};Ad.content={icons:"icons.png",common:"common.neh2"};var Bd={grass:{url:"grass.neh2",size:30,id:0},trenkorian:{url:"trenkorian.neh2",size:36,id:1}};(function(){"serviceWorker"in navigator?(console.log("CLIENT: service worker registration in progress."),navigator.serviceWorker.register("/sworker.js").then(function(b){console.log("CLIENT: service worker registration complete.")},function(b){C(b);console.log("CLIENT: service worker registration failure.")}),navigator.serviceWorker.oncontrollerchange=
function(){console.log("page controlled by:",navigator.serviceWorker.controller);location.reload(!0)}):console.log("CLIENT: service worker is not supported.")})();var Cd="GENERAL_DEFGAMENAME;GENERAL_GAMENAME;GENERAL_VERSION;GENERAL_NET_TITLE;GENERAL_CANCEL;GENERAL_OK;GENERAL_YES;GENERAL_NO;GENERAL_CLOSE;GENERAL_IGNORE;GENERAL_ABORT;GENERAL_YOUSURE;GENERAL_REFRESH;GENERAL_KICK;GENERAL_QLOAD;GENERAL_QSAVE;ADDS_MOREHOUSES;ADDS_AISEND;CHECK_INSERTCD;CHECK_INSERTCD2;CHECK_INSERTCD3;CHECK_NOCD;CHECK_BADEXE;ERR_CTFCANTSPAWN;ERR_DXFAILED;ERR_VMODE;ERR_OFFSCREEN;ERR_GPF;ERR_INCORRECTVER;ERR_GAMEFULL;ERR_BROWSEFAIL;ERR_NONET;ERR_SNDINIT;ERR_GAMECREATE;ERR_GAMELOAD;ERR_GAMELOAD2;ERR_DEMOVER;ERR_DEMORNDMAP;ERR_INVALIDCFG;ERR_INITMIDI;ERR_DSINIT;ERR_MCIINIT;ERR_BETACONNECT;ERR_SERVERCANCEL;ERR_SERVERKICK;ERR_ORDERROOM;ERR_MENUROOM;ERR_NETASYNC;ERR_NETASYNC2;ERR_NETASYNCBAD;ERR_NOTERRAIN;ERR_NOMAP;ERR_CLIENTSYNC;ERR_RULESLOAD;ERR_MAPWRONGVER;ERR_WRONGAI;ERR_WRONGOBJS;ERR_UNKNOWN;ERR_FATAL;ERR_NONFATAL;ERR_ERRORCODE;DEFMSG_MOVEDAVANCE;DEFMSG_MOVESNEAK;DEFMSG_ATTACK;DEFMSG_ATTACKTYPE;DEFMSG_ENTERHOLDER;DEFMSG_MINE;DEFMSG_BUILD;DEFMSG_REPAIR;DEFMSG_DIG;DEFMSG_CAPTURE;DEFMSG_CHOP;DEFMSG_ENTERSHIP;DEFMSG_FISHING;DEFMSG_PICKITEM;DEFMSG_PICKITEMINST;DEFMSG_GATHERRESITEMS;DEFMSG_TENDCOWS;DEFMSG_LEAVETRADE;DEFMSG_RETURNGOODS;DEFMSG_DUMMYTRAIN;DEFMSG_REMOVERALLYPOINT;DEFMSG_SETRALLYPOINT;DEFMSG_SETRALLYPOINTDA;DEFMSG_SETRALLYPOINTADV;DEFMSG_NOMAPTITLE;DEFMSG_NODECR;Q_QUIT_TITLE;Q_QUIT;Q_RESIGN;Q_DISCONNECT;MSG_CLIENT_QUIT;MSG_LOAD_OBJDEFS;MSG_LOAD_TERRAIN;MSG_LOAD_OBJECTS;MSG_LOAD_FINAL;MSG_LOAD_AI;MSG_LOAD_DONE;MSG_GAME_DESTROY;MSG_GAME_CREATE;MSG_GAME_RANDOM;MSG_GAME_RESTART;MSG_GAME_LOAD;MSG_GAME_LOAD_OBJ;MSG_GAME_INIT;MSG_RESADDED;MSG_NET_JOIN;MSG_NET_BROWSE;MSG_TREE;MSG_GAME_SPEED;MSG_GAME_SPEED_SLOWEST;MSG_GAME_SPEED_SLOW;MSG_GAME_SPEED_NORMAL;MSG_GAME_SPEED_FAST;MSG_GAME_SPEED_FASTEST;MSG_SYS_ERROR;MSG_SYS_TITLE;MSG_SYS_CONT;MSG_SYS_ABORT;MSG_SYS_YES;MSG_SYS_NO;MSG_SYS_IGNORE;MSG_DISCONNECT;VIEWMSG_POPLIMIT1;VIEWMSG_POPLIMIT2;VIEWMSG_NOTGOLD;VIEWMSG_NOTMANNA;VIEWMSG_NOTPOWER;VIEWMSG_MAGICGATEWAYCAP;VIEWMSG_QUICKSAVED;VIEWMSG_NOMPCHEAT;VIEWMSG_CHEATSENABLED;VIEWMSG_PLAYER_RESIGNED;VIEWMSG_PLAYER_DISCONECTED;VIEWMSG_PLAYER_DEFEATED;VIEWMSG_NEWQUEST;VIEWMSG_DEMO_END;VIEWMSG_NOTRES;VIEWMSG_GOLD;VIEWMSG_STONE;VIEWMSG_FOOD;VIEWMSG_WOOD;VIEWMSG_MANNA;VIEWMSG_SELL_ITEM;VIEWMSG_WAIT_PLAYERS;VIEWMSG_WAIT_RESPONSE;VIEWMSG_PLAYER_ENEMY;VIEWMSG_PLAYER_NEUTRAL;VIEWMSG_PLAYER_ALLY;VIEWMSG_PLAYER_WANT_ENEMY;VIEWMSG_PLAYER_WANT_NEUTRAL;VIEWMSG_PLAYER_WANT_ALLY;VIEWMSG_SPELL_LEARNED;VIEWMSG_PAUSE;NOTIFY_UNDER_ATTACK;NOTIFY_CAPTURED;NOTIFY_KILLED;NOTIFY_DESTROYED;NOTIFY_BUILT;NOTIFY_PRODUCED;NOTIFY_DISCOVERED;NOTIFY_UPGRADED;SELVIEW_UNITS;SELVIEW_BERSERKKINGDOM;MAINSCR_SINGLE;MAINSCR_MULTI;MAINSCR_PREF;MAINSCR_CREDITS;MAINSCR_QUIT;SINGLESCR_CAMPAIGN;SINGLESCR_CUSTOM;SINGLESCR_RANDOM;SINGLESCR_LOAD;SINGLESCR_BACK;SP_CHOOSEMAP_T_CUSTOMMAP;SP_CHOOSEMAP_T_MAP;SP_CHOOSEMAP_T_DESCRIPTION;SP_CHOOSEMAP_PLAY;SP_CHOOSEMAP_BACK;SP_SETUPMAP_T_NUM_PLAYERS;SP_SETUPMAP_T_GAME_TYPE;SP_SETUPMAP_T_VICT_COND;SP_SETUPMAP_T_SCORE_LIM;SP_SETUPMAP_T_TIME_LIM;SP_SETUPMAP_T_DIFF_LVL;SP_SETUPMAP_T_ST_RES;SP_SETUPMAP_T_MAP_DECR;SP_SETUPMAP_T_FOG;SP_SETUPMAP_T_EXPOLRE;SP_SETUPMAP_T_MAPDEF;SP_SETUPMAP_T_POPLIMIT;SP_SETUPMAP_BACK;SP_SETUPMAP_PLAY;SP_SETUPMAP_RACE_0;SP_SETUPMAP_RACE_1;SP_SETUPMAP_RACE_2;SP_SETUPMAP_RACE_3;SP_SETUPMAP_G_TYPE_0;SP_SETUPMAP_G_TYPE_1;SP_SETUPMAP_G_TYPE_2;SP_SETUPMAP_VCOND_0;SP_SETUPMAP_VCOND_1;SP_SETUPMAP_VCOND_2;SP_SETUPMAP_VCOND_3;SP_SETUPMAP_DIFFLVL_0;SP_SETUPMAP_DIFFLVL_1;SP_SETUPMAP_DIFFLVL_2;SP_SETUPMAP_RESURCS_0;SP_SETUPMAP_RESURCS_1;SP_SETUPMAP_RESURCS_2;SP_SETUPMAP_RESURCS_3;MP_SEARCH_T_PL_NAME;MP_SEARCH_T_IPX;MP_SEARCH_T_TCP;MP_SEARCH_T_IP;MP_SEARCH_T_LOBBY;MP_SEARCH_T_GAMES;MP_SEARCH_T_INFORM;MP_SEARCH_T_GAMENAME;MP_SEARCH_CREATE;MP_SEARCH_SEARCH;MP_SEARCH_JOIN;MP_SEARCH_BACK;MP_MPLAYER_PLAY;MP_MPLAYER_SETTINGS;MP_MPLAYER_DISCONNECT;MP_MPLAYER_RACE_0;MP_MPLAYER_RACE_1;MP_MPLAYER_RACE_2;MP_MPLAYER_RACE_3;MP_MPLAYER_NAME_0;MP_MPLAYER_NAME_1;MP_MPLAYER_NAME_2;MP_SETUPMAP_T_RANDOM;MP_SETUPMAP_T_CUSTOM;MP_SETUPMAP_T_CUSTOM_LIST;MP_SETUPMAP_T_MAP_DECR;MP_SETUPMAP_T_GAME_TYPE;MP_SETUPMAP_T_VICT_COND;MP_SETUPMAP_T_SCORE_LIM;MP_SETUPMAP_T_TIME_LIM;MP_SETUPMAP_T_DIFF_LVL;MP_SETUPMAP_T_ST_RES;MP_SETUPMAP_T_MAP_SIZE;MP_SETUPMAP_T_MAP_RES;MP_SETUPMAP_T_MAP_TYPE;MP_SETUPMAP_T_TERRAIN;MP_SETUPMAP_T_GSLOCATIONS;MP_SETUPMAP_T_ANIMALS;MP_SETUPMAP_T_RIVERS;MP_SETUPMAP_T_MITEMS;MP_SETUPMAP_T_CLIFFS;MP_SETUPMAP_T_FOG;MP_SETUPMAP_T_EXPOLRE;MP_SETUPMAP_T_WEATHER;MP_SETUPMAP_T_DAY;MP_SETUPMAP_T_POPLIMIT;MP_SETUPMAP_T_USEMAPSET;MP_SETUPMAP_T_GATEWAYS;MP_SETUPMAP_T_COMP;MP_SETUPMAP_T_OPEN;MP_SETUPMAP_T_DISABLE;MP_SETUPMAP_G_TYPE_0;MP_SETUPMAP_G_TYPE_1;MP_SETUPMAP_G_TYPE_2;MP_SETUPMAP_VCOND_0;MP_SETUPMAP_VCOND_1;MP_SETUPMAP_VCOND_2;MP_SETUPMAP_VCOND_3;MP_SETUPMAP_DIFFLVL_0;MP_SETUPMAP_DIFFLVL_1;MP_SETUPMAP_DIFFLVL_2;MP_SETUPMAP_RESURCS_0;MP_SETUPMAP_RESURCS_1;MP_SETUPMAP_RESURCS_2;MP_SETUPMAP_RESURCS_3;MP_SETUPMAP_CANCEL;MP_SETUPMAP_ACCEPT;MP_SETUPMAP_M_SIZE_0;MP_SETUPMAP_M_SIZE_1;MP_SETUPMAP_M_SIZE_2;MP_SETUPMAP_M_SIZE_3;MP_SETUPMAP_M_SIZE_4;MP_SETUPMAP_M_SIZE_5;MP_SETUPMAP_M_SIZE_6;MP_SETUPMAP_M_RES_0;MP_SETUPMAP_M_RES_1;MP_SETUPMAP_M_RES_2;MP_SETUPMAP_M_TYPE_0;MP_SETUPMAP_M_TYPE_1;MP_SETUPMAP_M_TYPE_2;MP_SETUPMAP_M_TYPE_3;MP_SETUPMAP_M_TYPE_4;MP_SETUPMAP_M_TYPE_5;MP_SETUPMAP_AI_ASSIST;GAME_SCR_MENU;GAME_SCR_DIPLOMACY;GAME_SCR_CHAT;DLG_BTNS_OK;DLG_BTNS_CANCEL;WND_QUESTS_CURQUEST;WND_QUESTS_CLOSE;WND_QUESTS_PAGE;WND_QUESTS_NONE;WND_MESSAGE_CLOSE;SP_SETUPRND_T_NUM_PLAYERS;SP_SETUPRND_T_GAME_TYPE;SP_SETUPRND_T_VICT_COND;SP_SETUPRND_T_SCORE_LIM;SP_SETUPRND_T_TIME_LIM;SP_SETUPRND_T_DIFF_LVL;SP_SETUPRND_T_ST_RES;SP_SETUPRND_T_FOG;SP_SETUPRND_T_EXPOLRE;SP_SETUPRND_T_MAP_SIZE;SP_SETUPRND_T_MAP_RES;SP_SETUPRND_T_MAP_TYPE;SP_SETUPRND_T_TERRAIN;SP_SETUPRND_T_GSLOCATIONS;SP_SETUPRND_T_ANIMALS;SP_SETUPRND_T_RIVERS;SP_SETUPRND_T_MITEMS;SP_SETUPRND_T_CLIFFS;SP_SETUPRND_T_POPLIMIT;SP_SETUPRND_T_GATEWAYS;SP_SETUPRND_BACK;SP_SETUPRND_PLAY;SP_SETUPRND_RACE_0;SP_SETUPRND_RACE_1;SP_SETUPRND_RACE_2;SP_SETUPRND_RACE_3;SP_SETUPRND_G_TYPE_0;SP_SETUPRND_G_TYPE_1;SP_SETUPRND_G_TYPE_2;SP_SETUPRND_VCOND_0;SP_SETUPRND_VCOND_1;SP_SETUPRND_VCOND_2;SP_SETUPRND_VCOND_3;SP_SETUPRND_DIFFLVL_0;SP_SETUPRND_DIFFLVL_1;SP_SETUPRND_DIFFLVL_2;SP_SETUPRND_RESURCS_0;SP_SETUPRND_RESURCS_1;SP_SETUPRND_RESURCS_2;SP_SETUPRND_RESURCS_3;SP_SETUPRND_M_SIZE_0;SP_SETUPRND_M_SIZE_1;SP_SETUPRND_M_SIZE_2;SP_SETUPRND_M_SIZE_3;SP_SETUPRND_M_SIZE_4;SP_SETUPRND_M_SIZE_5;SP_SETUPRND_M_SIZE_6;SP_SETUPRND_M_RES_0;SP_SETUPRND_M_RES_1;SP_SETUPRND_M_RES_2;SP_SETUPRND_M_TYPE_0;SP_SETUPRND_M_TYPE_1;SP_SETUPRND_M_TYPE_2;SP_SETUPRND_M_TYPE_3;SP_SETUPRND_M_TYPE_4;SP_SETUPRND_M_TYPE_5;OPTIONS_T_SOPT;OPTIONS_T_SVOL;OPTIONS_T_USP;OPTIONS_T_BS;OPTIONS_T_NS;OPTIONS_T_MOPT;OPTIONS_T_MV;OPTIONS_T_CD;OPTIONS_T_GOPT;OPTIONS_T_GS;OPTIONS_T_SS;OPTIONS_T_PD;OPTIONS_T_UINT;OPTIONS_T_HC;OPTIONS_T_ML;OPTIONS_T_WE;OPTIONS_T_DN;OPTIONS_OK;ENDGAMEDLG_QUIT;ENDGAMEDLG_LOAD;ENDGAMEDLG_SAVE;ENDGAMEDLG_NEXT;ENDGAMEDLG_STAT;ENDGAMEDLG_RESTART;ENDGAMEDLG_WIN1;ENDGAMEDLG_WIN2;ENDGAMEDLG_LOSE1;ENDGAMEDLG_LOSE2;PEONS_CHOP;PEONS_DIG;PEONS_MINE;PEONS_BUILD;PEONS_REPAIR;PEONS_TEND COWS;PEONS_EXPLORE;PEONS_CAPTURE;PEONS_ATTACK;PEONS_AI FAR BUILD;PEONS_GATHER RESOURCE ITEMS;PEONS_USE TRANSPORT;CHAT_T_CHAT;LOAD_T_LOAD;LOAD_TYPE_0;LOAD_TYPE_1;LOAD_TYPE_2;LOAD_LOAD;LOAD_DEL;LOAD_CANCEL;SAVE_T_SAVE;SAVE_NEW;SAVE_SAVE;SAVE_DEL;SAVE_CANCEL;CAMPAIGN_T_CAM;CAMPAIGN_T_DESCR;CAMPAIGN_T_EMISS;CAMPAIGN_T_EMISDES;CAMPAIGN_BACK;CAMPAIGN_PLAY;EDIT_T_GAMENAME;DIPLOMACY_T_TITLE;DIPLOMACY_TRIBUTE;DIPLOMACY_SHVICTORY;DIPLOMACY_ACCEPT;DIPLOMACY_CANCEL;TRIBUTE_T_TITLE;TRIBUTE_CANCEL;TRIBUTE_SEND;MENU_INST;MENU_LOAD;MENU_SAVE;MENU_OPTI;MENU_REST;MENU_QUIT;MENU_BACK;MENU_SURR;MENU_DISCONNECT;OBJECTS_ACADEMY;OBJECTS_ARCHER;OBJECTS_BALLISTA;OBJECTS_BARRACK;OBJECTS_BAT;OBJECTS_BEAR;OBJECTS_BIRD;OBJECTS_BLACKSMITH;OBJECTS_BRIDGE;OBJECTS_CARPET;OBJECTS_CASTLE;OBJECTS_CATAPULT;OBJECTS_CATHEDRAL;OBJECTS_CHARIOT;OBJECTS_CHURCH E;OBJECTS_CHURCH R;OBJECTS_CHURCH A;OBJECTS_COW;OBJECTS_CRUSADEANCHOR;OBJECTS_CRUSADER;OBJECTS_DRAGON;OBJECTS_DUMMY;OBJECTS_DWARF;OBJECTS_EAGLE;OBJECTS_ENICHAR;OBJECTS_FARM;OBJECTS_FIELD;OBJECTS_FISH;OBJECTS_FISHING_BOAT;OBJECTS_FISHPATCH;OBJECTS_FOOTMAN E;OBJECTS_FOOTMAN A;OBJECTS_FOOTMAN R;OBJECTS_GALLEON;OBJECTS_GATE_STONE;OBJECTS_GATE_WOOD;OBJECTS_GHOST;OBJECTS_GROUND_OBJECT;OBJECTS_GROUND_PATCH;OBJECTS_HARBOR;OBJECTS_HCATAPULT;OBJECTS_HEAVY_CAVALRY;OBJECTS_HORSE_ARCHER;OBJECTS_HORSE_SAMURAI;OBJECTS_HOUSE;OBJECTS_HULK;OBJECTS_ITEM;OBJECTS_ITEM_FLAG;OBJECTS_ITEM_HEALTH;OBJECTS_ITEM_MAGIC;OBJECTS_ITEM_PLUSPLUS;OBJECTS_ITEM_SCROLL;OBJECTS_ITEM_SOUL;OBJECTS_JIHAD_WARRIOR;OBJECTS_JINN;OBJECTS_KNIGHT;OBJECTS_LONGBOWMAN;OBJECTS_LUMBER;OBJECTS_MACEMAN E;OBJECTS_MACEMAN R;OBJECTS_MACEMAN A;OBJECTS_MAGE;OBJECTS_MAGETOWER;OBJECTS_MAGICWORKSHOP;OBJECTS_MARKET;OBJECTS_MONK;OBJECTS_MOSQUE;OBJECTS_NINJA;OBJECTS_ORK;OBJECTS_OUTPOST;OBJECTS_PEON;OBJECTS_PIKEMAN;OBJECTS_PRIEST;OBJECTS_RES_GOLD;OBJECTS_RES_STONE;OBJECTS_RESITEM;OBJECTS_RUIN;OBJECTS_SHAOLINN;OBJECTS_SKELETON;OBJECTS_SPY;OBJECTS_STABLE;OBJECTS_STORAGE;OBJECTS_TAVERN;OBJECTS_TCGUILD;OBJECTS_TOWER_STONE;OBJECTS_TOWER_STONE2;OBJECTS_TOWER_WOOD;OBJECTS_TOWER_WOOD2;OBJECTS_TOWER_ROCKET;OBJECTS_TRADER E;OBJECTS_TRADER R;OBJECTS_TROLL;OBJECTS_WALL_STONE;OBJECTS_WALL_WOOD;OBJECTS_WHIRLPOOL;OBJECTS_WORKSHOP;OBJECTS_XEBEC;OBJECTS_MAGICGATEWAY;OBJECTS_EVILCASTLE;ORDERS_NAMES_???;ORDERS_NAMES_FISHING_BOAT;ORDERS_NAMES_FISHING;ORDERS_NAMES_LOAN_RETURN;ORDERS_NAMES_LOAN;ORDERS_NAMES_LOAN_GOLD;ORDERS_NAMES_LOAN_STONE;ORDERS_NAMES_LOAN_IRON;ORDERS_NAMES_LOAN_FOOD;ORDERS_NAMES_LOAN_WOOD;ORDERS_NAMES_BRIBE;ORDERS_NAMES_REVEAL_SELF;ORDERS_NAMES_IMPERSONATE;ORDERS_NAMES_BECOME_JIHADW;ORDERS_NAMES_BECOME_PRIEST;ORDERS_NAMES_CLOAK;ORDERS_NAMES_UNCLOAK;ORDERS_NAMES_MURDER;ORDERS_NAMES_ITEM_USE;ORDERS_NAMES_ITEM_DROP;ORDERS_NAMES_ITEM_KILL;ORDERS_NAMES_ITEM_BERSERK;ORDERS_NAMES_MOVE;ORDERS_NAMES_REPAIR;ORDERS_NAMES_CAPTURE;ORDERS_NAMES_HARVEST;ORDERS_NAMES_ATTACK;ORDERS_NAMES_ATTACK_GROUND;ORDERS_NAMES_HOLD_STEADY;ORDERS_NAMES_SELECT_CRUSADERS;ORDERS_NAMES_STAND_GROUND;ORDERS_NAMES_ATTACK_TYPE;ORDERS_NAMES_EXORCISM;ORDERS_NAMES_PICK_ITEM;ORDERS_NAMES_GUARD;ORDERS_NAMES_PATROL;ORDERS_NAMES_GATEOPEN;ORDERS_NAMES_GATECLOSE;ORDERS_NAMES_GATE_SUBAI_ON;ORDERS_NAMES_GATE_SUBAI_OFF;ORDERS_NAMES_E_BARRACK;ORDERS_NAMES_DUMMY;ORDERS_NAMES_TCGUILD;ORDERS_NAMES_E_BLACKSMITH;ORDERS_NAMES_MAGETOWER;ORDERS_NAMES_WALL_STONE;ORDERS_NAMES_WALL_WOOD;ORDERS_NAMES_E_BUILD;ORDERS_NAMES_R_BUILD;ORDERS_NAMES_A_BUILD;ORDERS_NAMES_E_CASTLE;ORDERS_NAMES_MAGICWORKSHOP;ORDERS_NAMES_CATHEDRAL;ORDERS_NAMES_SHAOLINN;ORDERS_NAMES_MOSQUE;ORDERS_NAMES_E_CHURCH;ORDERS_NAMES_E_FARM;ORDERS_NAMES_E_FOOTMAN;ORDERS_NAMES_A_RHONIN;ORDERS_NAMES_R_JANISSARY;ORDERS_NAMES_ORK;ORDERS_NAMES_R_SATRAP;ORDERS_NAMES_R_FOOTMAN;ORDERS_NAMES_R_SPEARMAN;ORDERS_NAMES_JINN;ORDERS_NAMES_DWARF;ORDERS_NAMES_TROLL;ORDERS_NAMES_A_HORSEARCHER;ORDERS_NAMES_R_HORSEARCHER;ORDERS_NAMES_R_CAVALRY;ORDERS_NAMES_A_HORSESAMURAI;ORDERS_NAMES_E_ARCHER;ORDERS_NAMES_R_ARCHER;ORDERS_NAMES_A_ARCHER;ORDERS_NAMES_A_SAMURAI;ORDERS_NAMES_E_MAGE;ORDERS_NAMES_R_MAGE;ORDERS_NAMES_A_MAGE;ORDERS_NAMES_E_OUTPOST;ORDERS_NAMES_E_HARBOR;ORDERS_NAMES_E_LUMBER;ORDERS_NAMES_E_MARKET;ORDERS_NAMES_E_CARAVAN;ORDERS_NAMES_R_CARAVAN;ORDERS_NAMES_GATE_WOOD;ORDERS_NAMES_GATE_STONE;ORDERS_NAMES_FIELD;ORDERS_NAMES_E_PEON;ORDERS_NAMES_R_PEON;ORDERS_NAMES_A_PEON;ORDERS_NAMES_NINJA;ORDERS_NAMES_MONK;ORDERS_NAMES_E_MACEMAN;ORDERS_NAMES_E_PRIEST;ORDERS_NAMES_A_PRIEST;ORDERS_NAMES_R_PRIEST;ORDERS_NAMES_CHARIOT;ORDERS_NAMES_E_LONGBOWMAN;ORDERS_NAMES_E_KNIGHT;ORDERS_NAMES_E_STABLE;ORDERS_NAMES_STOP;ORDERS_NAMES_E_STORAGE;ORDERS_NAMES_E_TAVERN;ORDERS_NAMES_E_WORKSHOP;ORDERS_NAMES_EMERGE;ORDERS_NAMES_E_GALLEON;ORDERS_NAMES_E_HULK;ORDERS_NAMES_E_XEBEC;ORDERS_NAMES_BRIDGE;ORDERS_NAMES_E_ACADEMY;ORDERS_NAMES_E_TOWER_STONE;ORDERS_NAMES_E_TOWER_STONE2;ORDERS_NAMES_TOWER_ROCKET;ORDERS_NAMES_E_TOWER_WOOD;ORDERS_NAMES_E_TOWER_WOOD2;ORDERS_NAMES_VIEW_HEROES;ORDERS_NAMES_VIEW_SPYS;ORDERS_NAMES_VIEW_ITEMS;ORDERS_NAMES_E_HOUSE;ORDERS_NAMES_E_PIKEMAN;ORDERS_NAMES_E_SPY;ORDERS_NAMES_CATAPULT;ORDERS_NAMES_H_CATAPULT;ORDERS_NAMES_TO_WTOWER2;ORDERS_NAMES_TO_STOWER;ORDERS_NAMES_TO_STOWER2_1;ORDERS_NAMES_TO_STOWER2_2;ORDERS_NAMES_TO_SWALL;ORDERS_NAMES_TO_SGATE;ORDERS_NAMES_TE_ARROW_1;ORDERS_NAMES_TE_PLATEARMOR;ORDERS_NAMES_TE_FIELDS;ORDERS_NAMES_TE_LIVESTOCK;ORDERS_NAMES_TE_FEUDALISM;ORDERS_NAMES_TE_ARCHITECTURE;ORDERS_NAMES_TE_LONGBOW;ORDERS_NAMES_RAISEDEAD;ORDERS_NAMES_SPELL_HEAL;ORDERS_NAMES_SPELL_SPAWNDRAGON;ORDERS_NAMES_SPELL_RAISEEXP;ORDERS_NAMES_SPELL_FLAMEBOLT;ORDERS_NAMES_SPELL_BLESS;ORDERS_NAMES_SPELL_FREEZE;ORDERS_NAMES_SPELL_WHIRLPOOL;ORDERS_NAMES_SPELL_TURNTOSTONE;ORDERS_NAMES_SPELL_LIGHTNING;ORDERS_NAMES_SPELL_FIRERAIN;ORDERS_NAMES_SPELL_SPAWNBAT;ORDERS_NAMES_SPELL_SPAWNSTONEGOLEM;ORDERS_NAMES_SPELL_SPAWNCARPET;ORDERS_NAMES_SPELL_SPAWNJIN;ORDERS_NAMES_SPELL_MAGICVISION;ORDERS_NAMES_SPELL_RAISEDEAD;ORDERS_NAMES_SPELL_BERSERK;ORDERS_NAMES_SPELL_HYPNOTIZE;ORDERS_NAMES_SPELL_CLOAK;ORDERS_NAMES_UNLOAD;ORDERS_NAMES_TRADE;ORDERS_NAMES_BUILD_ITEM;ORDERS_NAMES_TRADE1;ORDERS_NAMES_TRADE_SHIP;ORDERS_NAMES_DIE;ORDERS_NAMES_DEFAULT;ORDERS_NAMES_MINE;ORDERS_NAMES_DIG;ORDERS_NAMES_CHOP;ORDERS_NAMES_SPELL;ORDERS_NAMES_PREACH_CRUSADE;ORDERS_NAMES_COW;ORDERS_NAMES_TO_SHIP_LEVEL2;ORDERS_NAMES_TO_SHIP_LEVEL3;ORDERS_NAMES_TO_SHIP_LEVEL4;ORDERS_NAMES_TO_SHIP_LEVEL5;ORDERS_NAMES_TO_SHIP_LEVEL6;ORDERS_NAMES_TO_CONVERTRES;ORDERS_NAMES_HOLDFIRE;ORDERS_NAMES_FIREATWILL;ORDERS_NAMES_EXPLORE;ORDERS_NAMES_BALLISTA;ORDERS_NAMES_TE_HALBERD;ORDERS_NAMES_TE_GOLDPLUS;ORDERS_NAMES_TE_STONEPLUS;ORDERS_NAMES_TE_WOODPLUS;ORDERS_NAMES_TE_LEARNING;ORDERS_NAMES_TE_TEMPERIRON;ORDERS_NAMES_TE_CROSSBOW;ORDERS_NAMES_TE_SCALEARMOR;ORDERS_NAMES_TE_CHAINMAIL;ORDERS_NAMES_TE_ENGINEERING;ORDERS_NAMES_TE_CANNONTOWER;ORDERS_NAMES_TE_HEROISM;ORDERS_NAMES_TE_NOBILITY;ORDERS_NAMES_TE_HONOR;ORDERS_NAMES_TE_WARFARE;ORDERS_NAMES_TE_TACTICS;ORDERS_NAMES_TE_MERCENARIES;ORDERS_NAMES_TE_HEROESQUEST;ORDERS_NAMES_TE_FAME;ORDERS_NAMES_TE_SIEGETACTICS;ORDERS_NAMES_TE_BODYBUILDING;ORDERS_NAMES_TE_FANATICISM;ORDERS_NAMES_TE_CRUSADE;ORDERS_NAMES_TE_ESPIONAGE;ORDERS_NAMES_TE_INQUISITION;ORDERS_NAMES_TE_HEALING;ORDERS_NAMES_TE_MEDICINE;ORDERS_NAMES_TE_TRADEROUTES;ORDERS_NAMES_TE_MAPMAKING;ORDERS_NAMES_TE_USURY;ORDERS_NAMES_TE_GAMBLING;ORDERS_NAMES_TE_SUPPLYSTORAGE;ORDERS_NAMES_TE_BRIBERY;ORDERS_NAMES_TE_BUDDHISM;ORDERS_NAMES_TE_TRADETAXES;ORDERS_NAMES_TE_BAT;ORDERS_NAMES_TE_STONEGOLEM;ORDERS_NAMES_TE_INVISIBILITY;ORDERS_NAMES_TE_LIGHTNING;ORDERS_NAMES_TE_FREEZE;ORDERS_NAMES_TE_BLESS;ORDERS_NAMES_TAVERN_MERC;ORDERS_NAMES_TAVERN_HERO;ORDERS_NAMES_MARKET_ITEMS;ORDERS_NAMES_MARKET_SELL;ORDERS_NAMES_TE_LANDINGTACTICS;ORDERS_NAMES_TE_COWPOACHING;ORDERS_NAMES_TE_SLAVERY;ORDERS_NAMES_TE_RIDINGHORSES;ORDERS_NAMES_TE_JANISSARY;ORDERS_NAMES_TE_JIHAD;ORDERS_NAMES_TE_MAGICCARPET;ORDERS_NAMES_TE_JIN;ORDERS_NAMES_TE_WITCHCRAFTS;ORDERS_NAMES_TE_RAINOFFIRE;ORDERS_NAMES_TE_MAGICVISION;ORDERS_NAMES_TE_NECROMANCY;ORDERS_NAMES_GAMBLE;ORDERS_NAMES_TE_HORSEMANSHIP;ORDERS_NAMES_TE_SCIMITAR;ORDERS_NAMES_TE_OREFLOATATION;ORDERS_NAMES_TE_JEWELRY;ORDERS_NAMES_TE_GREATWALL;ORDERS_NAMES_TE_BUDHISM;ORDERS_NAMES_TE_IRRIGATION;ORDERS_NAMES_TE_ARMOREDCHARIOT;ORDERS_NAMES_TE_BUSHIDO;ORDERS_NAMES_TE_SUNTZUBOOK;ORDERS_NAMES_TE_MEDITATION;ORDERS_NAMES_TE_PHILOSOPHY;ORDERS_NAMES_TE_KUNGFU;ORDERS_NAMES_TE_NINJAS;ORDERS_NAMES_TE_MASTERY;ORDERS_NAMES_TE_TOURNAMENTS;ORDERS_NAMES_TE_BANKING;ORDERS_NAMES_TE_CHEMISTRY;ORDERS_NAMES_TE_GUNPOWDER;ORDERS_NAMES_TE_ROCKETARROW;ORDERS_NAMES_TE_SEAFOOD;ORDERS_NAMES_TE_CONCENTRATION;ORDERS_NAMES_TE_BERSERK;ORDERS_NAMES_TE_WHIRLPOOL;ORDERS_NAMES_TE_DRAGON;ORDERS_NAMES_TE_TURNTOSTONE;ORDERS_NAMES_TE_FLAMEBOLT;ORDERS_NAMES_TE_ARTOFRIDING;ORDERS_NAMES_BUILD_ORC;ORDERS_NAMES_BUILD_DWARF;ORDERS_NAMES_BUILD_SKELETON;ORDERS_NAMES_BUILD_GHOST;ORDERS_NAMES_VIEW_QUESTS;ORDERS_NAMES_R_JIHAD_WARRIOR;ORDERS_NAMES_E_COMMON;ORDERS_NAMES_E_RARE;ORDERS_NAMES_E_GUILDS;ORDERS_NAMES_R_COMMON;ORDERS_NAMES_R_RARE;ORDERS_NAMES_R_GUILDS;ORDERS_NAMES_A_COMMON;ORDERS_NAMES_A_RARE;ORDERS_NAMES_A_GUILDS;ORDERS_NAMES_TR_TRADE;ORDERS_NAMES_TR_CANCEL;ORDERS_NAMES_TR_AMOUNT;ORDERS_NAMES_TR_SRCOBJ;ORDERS_NAMES_TR_SRCRES;ORDERS_NAMES_TR_DSTOBJ;ORDERS_NAMES_TR_DSTRES;ORDERS_NAMES_GM_RES;ORDERS_NAMES_GM_AMOUNT;ORDERS_NAMES_GM_PROP;ORDERS_NAMES_GM_GAMBLE;ORDERS_NAMES_GM_CANCEL;ORDERS_NAMES_BU_ITEM;ORDERS_NAMES_BU_AMOUNT;ORDERS_NAMES_BU_CANCEL;ORDERS_NAMES_BU_BUILD;ORDERS_NAMES_TR1_TRADE;ORDERS_NAMES_TR1_CANCEL;ORDERS_NAMES_TR1_AMOUNT1;ORDERS_NAMES_TR1_AMOUNT2;ORDERS_NAMES_TR1_SRCRES;ORDERS_NAMES_TR1_DSTRES;ORDERS_ADD_TE_SLAVERY;ORDERS_ADD_TE_STONEGOLEM;ORDERS_ADD_TE_FREEZE;ORDERS_ADD_TE_LIGHTNING;ORDERS_ADD_TE_INVISIBILITY;ORDERS_ADD_TE_BAT;ORDERS_ADD_TE_CRUSADE;ORDERS_ADD_TE_BLESS;ORDERS_ADD_TE_LONGBOW;ORDERS_ADD_TE_PLATEARMOR;ORDERS_ADD_TE_FIELDS;ORDERS_ADD_TE_LIVESTOCK;ORDERS_ADD_TE_FEUDALISM;ORDERS_ADD_TE_ARCHITECTURE;ORDERS_ADD_TE_LONGBOWMAN;ORDERS_ADD_TE_HALBERD;ORDERS_ADD_TE_GOLDPLUS;ORDERS_ADD_TE_STONEPLUS;ORDERS_ADD_TE_WOODPLUS;ORDERS_ADD_TE_LEARNING;ORDERS_ADD_TE_TEMPERIRON;ORDERS_ADD_TE_CROSSBOW;ORDERS_ADD_TE_SCALEARMOR;ORDERS_ADD_TE_CHAINMAIL;ORDERS_ADD_TE_ENGINEERING;ORDERS_ADD_TE_CANNONTOWER;ORDERS_ADD_TE_HEROISM;ORDERS_ADD_TE_NOBILITY;ORDERS_ADD_TE_HONOR;ORDERS_ADD_TE_WARFARE;ORDERS_ADD_TE_TACTICS;ORDERS_ADD_TE_MERCENARIES;ORDERS_ADD_TE_HEROESQUEST;ORDERS_ADD_TE_FAME;ORDERS_ADD_TE_SIEGETACTICS;ORDERS_ADD_TE_BODYBUILDING;ORDERS_ADD_TE_FANATICISM;ORDERS_ADD_TE_ESPIONAGE;ORDERS_ADD_TE_INQUISITION;ORDERS_ADD_TE_HEALING;ORDERS_ADD_TE_MEDICINE;ORDERS_ADD_TE_TRADETOUTES;ORDERS_ADD_TE_MAPMAKING;ORDERS_ADD_TE_PIRACY;ORDERS_ADD_TE_USURY;ORDERS_ADD_TE_SUPPLYSTORAGE;ORDERS_ADD_TE_BRIBERY;ORDERS_ADD_TE_BUDDHISM;ORDERS_ADD_TE_TRADETAXES;ORDERS_ADD_TE_LANDINGTACTICS;ORDERS_ADD_TE_BOARDINGRAM;ORDERS_ADD_TE_COWPOACHING;ORDERS_ADD_TE_RIDINGHORSES;ORDERS_ADD_TE_JANISSARY;ORDERS_ADD_TE_JIHAD;ORDERS_ADD_TE_MAGICCARPET;ORDERS_ADD_TE_JIN;ORDERS_ADD_TE_WITCHCRAFTS;ORDERS_ADD_TE_MAGICVISION;ORDERS_ADD_TE_NECROMANCY;ORDERS_ADD_TE_HORSEMANSHIP;ORDERS_ADD_TE_SCIMITAR;ORDERS_ADD_TE_OREFLOATATION;ORDERS_ADD_TE_JEWELRY;ORDERS_ADD_TE_GREATWALL;ORDERS_ADD_TE_BUDHISM;ORDERS_ADD_TE_IRRIGATION;ORDERS_ADD_TE_ARMOREDCHARIOT;ORDERS_ADD_TE_BUSHIDO;ORDERS_ADD_TE_SUNTZUBOOK;ORDERS_ADD_TE_MEDITATION;ORDERS_ADD_TE_PHILOSOPHY;ORDERS_ADD_TE_KUNGFU;ORDERS_ADD_TE_NINJAS;ORDERS_ADD_TE_MASTERY;ORDERS_ADD_TE_TOURNAMENTS;ORDERS_ADD_TE_BANKING;ORDERS_ADD_TE_CHEMISTRY;ORDERS_ADD_TE_GUNPOWDER;ORDERS_ADD_TE_ROCKETARROW;ORDERS_ADD_TE_SEAFOOD;ORDERS_ADD_TE_CONCENTRATION;ORDERS_ADD_TE_BERSERK;ORDERS_ADD_TE_WHIRLPOOL;ORDERS_ADD_TE_DRAGON;ORDERS_ADD_TE_TURNTOSTONE;ORDERS_ADD_TE_FLAMEBOLT;ORDERS_ADD_TE_ARTOFRIDING;ORDERS_ADD_TE_TRADEROUTES;ORDERS_ADD_TE_GAMBLE;SPELL_NAMES_SPELL_FIRERAIN;SPELL_NAMES_SPELL_LIGHTNING;SPELL_NAMES_SPELL_HEAL;SPELL_NAMES_SPELL_SPAWNCARPET;SPELL_NAMES_SPELL_SPAWNBAT;SPELL_NAMES_SPELL_BLESS;SPELL_NAMES_SPELL_FREEZE;SPELL_NAMES_SPELL_BERSERK;SPELL_NAMES_SPELL_SOULBIND;SPELL_NAMES_SPELL_CLOAK;SPELL_NAMES_SPELL_SPAWNSTONEGOLEM;SPELL_NAMES_SPELL_MAGICVISION;SPELL_NAMES_SPELL_RAISEDEAD;SPELL_NAMES_SPELL_TURNTOSTONE;SPELL_NAMES_SPELL_WHIRLPOOL;SPELL_NAMES_SPELL_SPAWNDRAGON;SPELL_NAMES_SPELL_FLAMEBOLT;SPELL_NAMES_SPELL_RAISEEXP;SPELL_NAMES_SPELL_SPAWNJIN;SPELL_NAMES_SPELL_CURSE;SPELL_NAMES_SPELL_HYPNOTIZE;IMAGES_FLAG_CAPTURE;IMAGES_ITEM_BOOK1;IMAGES_ITEM_BOOK2;IMAGES_ITEM_BOOK3;IMAGES_ITEM_BOW1;IMAGES_ITEM_BOW2;IMAGES_ITEM_BOW3;IMAGES_ITEM_FLAG;IMAGES_ITEM_FOOD;IMAGES_ITEM_GOLD;IMAGES_ITEM_IRON;IMAGES_ITEM_POTION1;IMAGES_ITEM_POTION2;IMAGES_ITEM_POTION3;IMAGES_ITEM_POTION4;IMAGES_ITEM_POTION5;IMAGES_ITEM_POTION6;IMAGES_ITEM_POTION7;IMAGES_ITEM_POTION8;IMAGES_ITEM_SCROLL1;IMAGES_ITEM_SHIELD1;IMAGES_ITEM_SHIELD2;IMAGES_ITEM_SHIELD3;IMAGES_ITEM_STONE;IMAGES_ITEM_SWORD;IMAGES_ITEM_SWORD1;IMAGES_ITEM_SWORD2;IMAGES_ITEM_SWORD3;IMAGES_ITEM_WOOD;TZAREDIT_S1;TZAREDIT_S2;HELP_???;HELP_SP_CAMPAIGN;HELP_SP_CUSTOM_MAP;HELP_SP_RANDOM_MAP;HELP_SP_LOAD_GAME;HELP_SP_BACK;HELP_CN_CAMPAIGNS;HELP_CN_CAMPAIGN_DESCRIPTION;HELP_CN_ENTRY_MISSONS;HELP_CN_ENTRY_MISSONS_DESCRIPTION;HELP_CN_BACK;HELP_CN_PLAY;HELP_CM_MAPS;HELP_CM_MAP_DECRIPTION;HELP_CM_PLAY;HELP_CM_BACK;HELP_RM_PLAYER_COLOR;HELP_RM_PLAYER_NAME;HELP_RM_PLAYER_CIVILIVIZATION;HELP_RM_PLAYER_TEAM;HELP_RM_NUMBER_OF_PLAYERS;HELP_RM_POP_LIMIT;HELP_RM_GAME_TYPE;HELP_RM_DIFFICULTY_LEVEL;HELP_RM_VICTORY_CONDITION;HELP_RM_STARTING_RESOURCES;HELP_RM_NO_FOG;HELP_RM_EXPLORE;HELP_RM_MAP_SIZE;HELP_RM_MAP_TYPE;HELP_RM_TERRAIN;HELP_RM_MAP_RESOURCES;HELP_RM_GUARDED_TOWN;HELP_RM_AMNIMALS;HELP_RM_MAGIC_ITEMS;HELP_RM_CLIFFS;HELP_RM_GATEWAYS;HELP_RM_PLAY;HELP_RM_BACK;HELP_RM_VALUE;HELP_LG_SELECT_GAME;HELP_LG_CHOOSE;HELP_LG_LOAD;HELP_LG_CANCEL;HELP_LG_DELETE;HELP_MP_PLAYER_NAME;HELP_MP_GAME_NAME;HELP_MP_IPX;HELP_MP_TCP/IP;HELP_MP_IP_ADDRESS;HELP_MP_CREATE;HELP_MP_SEARCH;HELP_MP_JOIN;HELP_MP_BACK;HELP_MP_GAMES_FOUND;HELP_MP_GAME_INFORMATION;HELP_MP_BETA;HELP_MPC_CHECK_BUTTON;HELP_MPC_PLAYER_COLOR;HELP_MPC_PLAYER_NAME;HELP_MPC_PLAYER_CIVILIVIZATION;HELP_MPC_PLAYER_TEAM;HELP_MPC_CHAT_BOX;HELP_MPC_CHAT_BOX_WRITE;HELP_MPC_SETTINGS;HELP_MPC_MAP;HELP_MPC_DISCONNECT;HELP_MPC_PLAY;HELP_MPS_RANDOM_MAP;HELP_MPS_CUSTOM_MAP;HELP_MPS_POP_LIMIT;HELP_MPS_GAME_TYPE;HELP_MPS_DIFFICULTY_LEVEL;HELP_MPS_VICTORY_CONDITION;HELP_MPS_STARTING_RESOURCES;HELP_MPS_MAP_SIZE;HELP_MPS_MAP_TYPE;HELP_MPS_TERRAIN;HELP_MPS_MAP_RESOURCES;HELP_MPS_TOWERS;HELP_MPS_AMNIMALS;HELP_MPS_MAGIC_ITEMS;HELP_MPS_CLIFFS;HELP_MPS_GATEWAYS;HELP_MPS_DAY_NIGTH;HELP_MPS_WEATHER;HELP_MPS_NO_FOG;HELP_MPS_EXPLORE;HELP_MPS_ACCEPT;HELP_MPS_CANCEL;HELP_MPS_MAPS_LIST;HELP_MPS_MAP_DECRIPTION;HELP_MPS_USE_MAP_SETTINGS;HELP_MPS_VALUE;HELP_SG_SAVE_GAME;HELP_SG_NEW;HELP_SG_SAVE;HELP_SG_DELETE;HELP_SG_CANCEL;HELP_SG_RESTART;HELP_SG_QUIT;HELP_SG_LIST;HELP_CH_BOX;HELP_CH_ALLIES;HELP_CH_ENEMIES;HELP_CH_ALL;HELP_CH_CUSTOM;HELP_CH_SELECT_PLAYER;HELP_CH_NAMES;HELP_CH_COLORS;HELP_D_ALLIES;HELP_D_ENEMIES;HELP_D_NEUTRAL;HELP_D_SHARED VISION;HELP_D_SHARED RESOURCES;HELP_D_SHARED UNIT CONTROL;HELP_D_SHARED_VICTORY;HELP_D_ACCEPT;HELP_D_CANCEL;HELP_D_TRIBUTE;HELP_T_AMOUNT;HELP_T_SEND;HELP_T_CANCEL;HELP_CM1_PLAYER_COLOR;HELP_CM1_PLAYER_NAME;HELP_CM1_PLAYER_CIVILIVIZATION;HELP_CM1_PLAYER_TEAM;HELP_CM1_NUMBER_OF_PLAYERS;HELP_CM1_POP_LIMIT;HELP_CM1_GAME_TYPE;HELP_CM1_DIFFICULTY_LEVEL;HELP_CM1_VICTORY_CONDITION;HELP_CM1_STARTING_RESOURCES;HELP_CM1_NO_FOG;HELP_CM1_EXPLORE;HELP_CM1_USE_MAP_SETTINGS;HELP_CM1_MAP_DECRIPTION;HELP_CM1_VALUE;HELP_CM1_BACK;HELP_CM1_PLAY;HELP_O_SOUND_VOLUME;HELP_O_CHK_VOLUME;HELP_O_UNIT_SPEECH;HELP_O_BUILDING_SOUND;HELP_O_NATURE_SOUND;HELP_O_GAME_SPEED;HELP_O_SCROLL_SPEED;HELP_O_PATH_DEPTH;HELP_O_DAY_NIGTH;HELP_O_WEATHER;HELP_O_MUSIC_VOLUME;HELP_O_CHK_MVOLUME;HELP_O_CD;HELP_O_H_CURS;HELP_O_MENU;HELP_O_OK;HELP_MPS_AI_ASSIST;HELP_MPS_SH_RES;HELP_MPS_TOWERS_POP;VM_LOC_SENT;VM_BOOKMARK_SET;VM_TIME_LIMIT_HIT;VM_TIME_LIMIT_REACHED;VM_SCORE_LIMIT_HIT;VM_SCORE_LIMIT_REACHED;VM_SAVING;VM_DISCON1;VM_DISCON2;TZAREDIT_DELETE;TZAREDIT_ANY;TZAREDIT_MILITARY_UNITS;TZAREDIT_DELAY;TZAREDIT_REMOVE;OBJECTS_MESSIAH;ERR_NOMAPS;ERR_FIRST;ERR_EXPLASYNC;ERR_OBJASYNC;ERR_BADKINGDOMSCRIPT;ORDERS_NAMES_TE_INVINSIBILITY;ORDERS_NAMES_TE_IRONPLUS;ORDERS_NAMES_TO_WALL_STONE;ORDERS_NAMES_TO_GATE_STONE;ORDERS_NAMES_VIEW_AI;ORDERS_NAMES_SET_AI_NONE;ORDERS_NAMES_SET_AI_FULL;ORDERS_NAMES_SET_AI_WAR;ORDERS_NAMES_SET_AI_ECO;CHOOSEAI_TITLE;CHOOSEAI_OK;CHOOSEAI_CANCEL;CHOOSEAI_DEFAULT;ENDGAMEDLG_HIDE;MISC_SELLITEM3;MISC_HERO3;MISC_KINGDOM3;MISC_QUICKSAVE3;MISC_AUTOSAVE3;MISC_NATURE3;MISC_RESCUE3;MISC_BUY3;MISC_PREVPAGE3;MISC_NEXTPAGE3;MISC_VIEW3;MISC_REQ3;MISC_INF3;MISC_HIRE3;MISC_RETLOAN3;MISC_GETLOAN3;MISC_WATOBJ3;MISC_RES3;MISC_TREES3;MISC_UNK3;MISC_RND3;MISC_UNKAUTHOR3;MISC_HEALTH3;MISC_EXP3;MISC_MANNA3;MISC_DEFENCE3;MISC_ATTACK3;MISC_SWORD3;MISC_SHIELD3;MISC_BOW3;MSG_GAME_CONNECT;MSG_GAME_SPEED_TURBO;MSG_AIFULL3;MSG_AIECO3;MSG_AIWAR3;MSG_AIOFF3;MSG_NET_JOIN_HEADOFF;MSG_GOLDREQ;MSG_GAME_SPEED2;ERR3_ERR_CONNECT;ERR3_RANKSLOST;ORDERS_NAMES_DESTROY;ORDERS_NAMES_ONLINEHELP;ORDERS_NAMES_NEXTIDLE;ORDERS_NAMES_BOOK_ITM;ORDERS_NAMES_POTION_ITM;ORDERS_NAMES_POWER_ITM;TZAREDIT_ANY_MAJOR_OBJECTS;DEFMSG_CAPTUREOWN;MP_SETUPMAP_SH_RES;MP_SETUPMAP_TOWERS_POP;VM_SENDRESULTS;VM_SENDRESULTS2;SYSTEM_LANGUAGE;DOWNLOADING_GRAPHICS;WEBAUDIO;CONNECTION_ERROR;DOWNLOAD_ALL;MAPEDITOR;TEAM;COLOUR;MAXHEALTH;PLAYING;WAITING;ADD;WATER;AUTOFULLSCREEN;FULLSCREEN;UP;DOWN;LANGUAGE;INITIAL_PEASANTS;ADD_AI;RACE;DATE;FREE_POP;ABOUT;PLAYED_TIME;ZOOMSPEED".split(";"),
Qb,Vc,Fe,Yb,Ge,Pg,Dd,Qi,Ed,Ri,Si,N,He,Fd,bb,Qg,Ha,na,te={},Rg="ts1.mp3 ts2.mp3 ts3.mp3 ts4.mp3 ts5.mp3 ts6.mp3 ts7.mp3 ts8.mp3 ts9.mp3 ts10.mp3 sr1.mp3 sr2.mp3 sr3.mp3 sr4.mp3 sr5.mp3 sr6.mp3 sr7.mp3 sr8.mp3 sr9.mp3 sr10.mp3 o1.mp3 o2.mp3 o3.mp3 o4.mp3 o5.mp3 o6.mp3 o7.mp3 o8.mp3 o9.mp3 o10.mp3 INTRO.mp3 OUTRO.mp3 WIN1.mp3 WIN2.mp3 ATTACK.WAV BALLISTA.WAV BLDGDONE.WAV CHAT%20LOCATION.WAV TECHDONE.WAV UNITDONE.WAV CHAT.WAV E_CASTLE1.WAV E_CATHEDRAL1.WAV E_CATHEDRAL2.WAV E_FARM1.WAV E_CHURCH1.WAV E_FARM2.WAV E_HARBOR1.WAV E_LUMBER1.WAV E_MAGETOWER1.WAV E_MAGETOWER2.WAV E_MAGETOWER3.WAV E_MARKET1.WAV E_SHIPYARD1.WAV E_STABLES1.WAV E_STORAGE1.WAV E_OUTPOST1.WAV E_STORAGE2.WAV E_TAVERN1.WAV E_WARACADEMY1.WAV E_WORKSHOP1.WAV EVILCASTLE.WAV GATE1.WAV GATE2.WAV GATE3.WAV GATE4.WAV GATE5.WAV GATE6.WAV GATEWAY.WAV HOUSE1.WAV HOUSE2.WAV HOUSE3.WAV HOUSE4.WAV HOUSE5.WAV MERCHANT.WAV MINE1.WAV MONASTERY1.WAV MONASTERY2.WAV R_CATHEDRAL1.WAV R_CHURCH1.WAV SHAOLIN2.WAV SHAOLIN.WAV CHOP%201.WAV CHOP%202.WAV CHOP%203.WAV CHOP%204.WAV CHOP%205.WAV CHOP%206.WAV CHOP%207.WAV CHOP%208.WAV CHOP%209.WAV CHOP%2010.WAV CHOP%2011.WAV DIG%201.WAV DIG%202.WAV DIG%203.WAV MINE%201.WAV MINE%202.WAV MINE%203.WAV HIT%201.WAV HIT%202.WAV HIT%203.WAV HIT%204.WAV HIT%205.WAV HIT%206.WAV HIT%207.WAV GHOST1.WAV GHOST2.WAV GOLEM1.WAV GOLEM2.WAV H%20SWORD%201.WAV H%20SWORD%202.WAV H%20SWORD%203.WAV H%20SWORD%204.WAV H%20SWORD%205.WAV H%20SWORD%206.WAV H%20SWORD%207.WAV H%20SWORD%207.WAV H%20SWORD%208.WAV H%20SWORD%209.WAV H%20SWORD%2010.WAV H%20SWORD%2011.WAV H%20SWORD%2012.WAV HAND1.WAV HAND2.WAV HAND3.WAV HAND4.WAV MAGE%20ATTACK.WAV MESSIAH.WAV ORC%20SWORD%201.WAV ORC%20SWORD%202.WAV ORC%20SWORD%203.WAV ORC%20SWORD%204.WAV ORC%20SWORD%205.WAV ORC%20SWORD%206.WAV ORC%20SWORD%20V1.WAV ORC%20SWORD%20V2.WAV ORC%20SWORD%20V3.WAV SHIP%20CANNON%201.WAV SHIP%20CANNON%202.WAV SHIP%20CANNON%203.WAV SHIP%20CANNON%204.WAV SHIP%20CANNON%205.WAV SHIP%20CANNON%206.WAV SHIP%20CANNON%207.WAV SIEGE.WAV SWORD%201.WAV SWORD%202.WAV SWORD%203.WAV SWORD%204.WAV SWORD%205.WAV SWORD%206.WAV SWORD%207.WAV SWORD%208.WAV SWORD%209.WAV SWORD%2010.WAV SWORD%2011.WAV SWORD%2012.WAV SWORD%2013.WAV SWORD%2014.WAV SWORD%2015.WAV SWORD%2016.WAV V%20SWORD%201.WAV V%20SWORD%202.WAV V%20SWORD%203.WAV V%20SWORD%204.WAV V%20SWORD%205.WAV V%20SWORD%206.WAV V%20SWORD%207.WAV ADRAGON2.WAV ADRAGON3.WAV ARROW%201.WAV ARROW%202.WAV ARROW%203.WAV ARROW%204.WAV ARROW%205.WAV ARROW%206.WAV ARROW%20V1.WAV ARROW%20V2.WAV ARROW%20V3.WAV ARROW%20V4.WAV BEAR1.WAV BEAR2.WAV BEAR3.WAV BEAR4.WAV BEAR5.WAV MWORKSHOP.WAV DESTROY%20BUILDING.WAV DESTROY%20MINE.WAV LIGHTING2.WAV LIGHTING.WAV METEOR.WAV SMALL%20EXPLOSION.WAV WATER%20BLOP.WAV SPY%20KILL%201.WAV SPY%20KILL%203.WAV SPY%20KILL%202.WAV PRIEST%20ATTACK.WAV LIGHTNING.WAV INVISIBLE.WAV HEAL.WAV FREEZE.WAV FLAME%20BALL.WAV CURSE.WAV CRUSADE.WAV CONFUSION.WAV BLESS.WAV WHIRLPOOL.WAV TURN%20TO%20STONE.WAV TEACH.WAV SUMMON10.WAV SUMMON9.WAV SUMMON8.WAV SUMMON7.WAV SUMMON6.WAV SUMMON5.WAV SUMMON4.WAV SUMMON3.WAV SUMMON2.WAV SUMMON1.WAV REVEAL.WAV RESSURECT.WAV COWDIE1.WAV COWDIE2.WAV COWDIE1.WAV COWDIE3.WAV COWDIE4.WAV DIE%201.WAV DIE%202.WAV DIE%203.WAV DIE%204.WAV DIE%205.WAV DIE%206.WAV DIE%207.WAV DIE%208.WAV DIE%209.WAV DIE%2010.WAV DRAGON%20DIE%201.WAV DRAGON%20DIE%202.WAV GHOST1.WAV GHOST2.WAV GOLEM.WAV H%20DIE%201.WAV H%20DIE%202.WAV H%20DIE%203.WAV H%20DIE%204.WAV H%20DIE%205.WAV H%20DIE%206.WAV H%20DIE%207.WAV H%20DIE%208.WAV H%20DIE%209.WAV H%20DIE%2010.WAV MAGE.WAV ORC%20DIE%201.WAV ORC%20DIE%202.WAV SHIP%20SINK.WAV SIEGE%20DIE%201.WAV SIEGE%20DIE%202.WAV SIEGE%20DIE%203.WAV SIEGE%20DIE%204.WAV SKELETON%20DIE%201.WAV SKELETON%20DIE%202.WAV SKELETON%20DIE%203.WAV SKELETON%20DIE%204.WAV MESSIAH_ATTACK.WAV C%20DIE%201.WAV C%20DIE%202.WAV C%20DIE%203.WAV C%20DIE%204.WAV C%20DIE%205.WAV CAMELDIE1.WAV CAMELDIE2.WAV CAMELDIE3.WAV BAT%20ATTACK.WAV BAT%20CMD.WAV BAT%20DIE.WAV".split(" "),
Ti,sd,td,Ie=function(){if(!Qb){q.prototype.loadBuffer=function(c,b){var k=this;Ee(w.cdn+c,function(d){k.context.decodeAudioData(d).then(function(k){k&&T(k,c,b)})})};for(var b=0,c=Rg.length;b<c;b++){var e=Rg[b];te[e.split(".")[0].toLowerCase()]=e}Vc="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206 arrow%20v1 arrow%20v2 arrow%20v3 arrow%20v4".split(" ");Fe="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206".split(" ");Yb="sword%201 sword%202 sword%203 sword%204 sword%205 sword%206 sword%207 sword%208 sword%209 sword%2010 sword%2011 sword%2012 sword%2013 sword%2014 sword%2015 sword%2016 v%20sword%201 v%20sword%202 v%20sword%203 v%20sword%204 v%20sword%205 v%20sword%206 v%20sword%207".split(" ");
Ge=["siege"];Pg=["hand1","hand2","hand3","hand4"];Dd="h%20sword%201 h%20sword%202 h%20sword%203 h%20sword%204 h%20sword%205 h%20sword%206 h%20sword%207 h%20sword%208 h%20sword%209 h%20sword%2010 h%20sword%2011 h%20sword%2012".split(" ");Qi=["ork%20sword%20v1","ork%20sword%20v2","ork%20sword%20v3"];Ed="ship%20cannon%201 ship%20cannon%202 ship%20cannon%203 ship%20cannon%204 ship%20cannon%205 ship%20cannon%206 ship%20cannon%207".split(" ");Ri=["ghost%201","ghost%202"];Si=["mage%20attack"];N=["destroy%20building"];
He=["siege%20die%201","siege%20die%202","siege%20die%203","siege%20die%204"];Fd="h%20die%201 h%20die%202 h%20die%203 h%20die%204 h%20die%205 h%20die%206 h%20die%207 h%20die%208 h%20die%209 h%20die%2010".split(" ");bb="die%201 die%202 die%203 die%204 die%205 die%206 die%207 die%208 die%209 die%2010".split(" ");Qg=["e_barrack1"];"undefined"!==typeof AudioContext&&(window.AudioContext=window.AudioContext||window.webkitAudioContext,Qb=new AudioContext,sd=Qb.createGain(),td=Qb.createGain(),Ti=new q(Qb,
void 0,T),C("Sound: OK"),sd.gain.value=parseInt(localStorage.musicRange)/100,td.gain.value=parseInt(localStorage.soundRange)/100);Ha=function(){if(!t.editor){Ha.id++;p("musicSelect")&&(localStorage.favMusic=p("musicSelect").mversion.value);var c=Ha.list[localStorage.favMusic];c&&na(c[~~(c.length*Math.random())],0,0,void 0,1,0,Ha.id)}};Ha.reset=function(){Ha.stop();Ha()};Ha.stop=function(){Ha.active&&(Ha.active.stop(),clearTimeout(Ha.intv))};Ha.id=0;Ha.list={originalMusic1:"o1 o2 o3 o4 o5 o6 o7 o8 o9 o10 outro".split(" "),
originalMusic:"ts1 ts2 ts3 ts4 ts5 ts6 ts7 ts8 ts9 ts10".split(" "),sharpRain:"sr1 sr2 sr3 sr4 sr5 sr6 sr7 sr8 sr9 sr10".split(" ")};na=function(c,b,k,e,y,f,m){"string"!==typeof c&&(c=Rg[c].split(".")[0].toLowerCase());var d=c;if((c=te[c])&&"loading"!==c&&!t.canceled){var h=-oa+(window.innerWidth-w.mx)/2,l=-ha+window.innerHeight/2;if(c.duration){if(t.started)if(64<t.now()-c.lastPlayed||!c.lastPlayed)c.lastPlayed=t.now();else return;if(!(!y&&"attack"!=d&&f&&600<Date.now()-f)){if(b){b=-h+32*b;k=-l+
32*k;l=S;if(b*b+k*k>Math.pow(2E3,2))return!1;b/=80;k/=80;l/=8}else l=k=b=0;void 0!==e&&e!==w.kingdom||t.mute||(e=Qb.createBufferSource(),e.buffer=c,y?(e.connect(sd),sd.connect(Qb.destination),Ha.active=e,Ha.intv=setTimeout(Ha,~~(1E3*c.duration)+1E3)):(c=Qb.createPanner(),c.panningModel="HRTF",c.setPosition(b,k,l),e.connect(c),c.connect(td),td.connect(Qb.destination)),e.start(0))}}else te[d]="loading",y={x:b,y:k,k:e,music:y,date:Date.now(),mid:m},Ti.loadBuffer(c,y)}}}},Gd=function(b,c,e,d){b.img===
d.url&&(na(c+~~(Math.random()*e+1),b.x32,b.y32),setTimeout(Gd,Xa(d),b,c,e,d))};"use strict";var gm=function(b){for(var c=[],k=0,d=[b.icons],h=0,l=d.length;h<l;h++)for(var n=d[h],y=0,f=n.length;y<f;y++)if(n[y]){var m=n[y];m.doneBy||(m.doneBy=[]);m.doneBy.put(b);c[k++]=m;m.xtra&&(d.put(m.xtra),l++)}b.habilities=c},hm=function(b,c){return c.balanceTotal-b.balanceTotal},Sg=function(b,c){var k=b.slice(0),d={};d[c]=Infinity;for(var h=k.length,l=0;l<h;l++){var n=d;for(var y=0;y<h;y++)if(k[y]&&k[y][c]<n[c]){n=
k[y];var f=y}n==d&&(n=void 0);b[l]=n;k[f]=d}return b},Je=function(b,c){if(!b.url.attack||b.attackOnly&&!b.attackOnly[c.type])return 0;var k=25*~~(Xa(b.url.attack)/25);b=b.attack*((Hd[b.type][c.type]||0)+1);b-=c.defence;1>b&&(b=1);return~~(c.health/b)*k},rb=function(b){this.kingdom=b.k;this.aggressive=this.perfection=1;this.cantBuild={};this.houseLoading=0;this.mineGroup={};b.IAD=rb.arr.length;rb.arr.put(this)};rb.prototype.valorateLost=function(b){this.script&&this.script.put({order:b.nu,obj:b,priority:1})};
var Tg=function(b,c,e,d,h){var k=e.obj.cost;d[0]+=k[0];d[1]+=k[1];d[2]+=k[2];d[3]+=k[3];b[b.length]={order:e,priority:c.priority,name:e.obj.name,obj:e.obj,pTime:c.obj.time,required:1,doner:h};b.changed=!0},Ug=function(b,c,e,d){var k=[b],l=[],n={},y=d.target;l.put(b);for(var f=0;f<k.length;f++){var m=k[f];m.availables&&(m.availables=void 0);if((b=m.order)&&!n[m.order.id]){n[m.order.id]=1;var g=b.requireObj;if(g)for(var v=0,p=g.length;v<p;v++)if(b=g[v],b.tech)c[b.nu.id]||Tg(k,m,b.nu,y);else{var t=e[b.type];
t.length||Tg(k,m,b.nu,y)}if(g=b.doneBy)for(v=0,p=g.length;v<p;v++)b=g[v],t=e[b.type],t.length||b.race!=d.racestr||Tg(k,m,b.nu,y,1);f&&!m.doner&&l.put(m)}}return l},Vg={food:2,wood:1,gold:0,stone:3},gc=function(b,c){b=b.order;var k=b.obj,d=gc.tech;k.build?d=gc.build:k.tech||(d=gc.unit);return d(b,c)};gc.unit=function(b,c){b=b.doneBy;if(c.pop<c.popMax)for(var k=0,d=b.length;k<d;k++)for(var h=c[b[k].type],l=0,n=h.length;l<n;l++){var y=h[l];if(y.free)return[y]}return!1};gc.tech=function(b,c){b=b.doneBy;
for(var k=0,d=b.length;k<d;k++)for(var h=c[b[k].type],l=0,n=h.length;l<n;l++){var y=h[l];if(y.free)return[y]}return!1};gc.build=function(b,c,e){b=b.doneBy;e=0;for(var k=b.length;e<k;e++)for(var h=c[b[e].type],l=0,n=h.length;l<n;l++){var y=h[l];if(y.free)return[y]}return!1};gc.sPeasant=function(b){for(var c=[10,79,64],k=[],d=0,h=0,l=c.length;h<l;h++)for(var n=b[c[h]],y=0,f=n.length;y<f;y++)n[y].free&&(k[d++]=n[y]);return k};var ib=function(b,c,e){if(b){b=b.order;var k=b.obj,h=ib.unit;k.tech?h=ib.tech:
k.build&&(h=ib.build);return h(b,c,e)}};ib.build=function(b,c,e){var k=rb.arr[c.IAD];if(4<=k.cantBuild[b.obj.type]&&c.stats.buildsLosed==k.buildsLosed)return!1;for(var h=[],l=b.doneBy,n=ta[c.k],y=0,f=l.length;y<f;y++)for(var m=n[l[y].type],g=0,v=m.length;g<v;g++){var p=A[m[g]];if(!p.func&&!p.in||e){h.put(p.id);break}}if(!h.length)return!1;e=H;p=b.obj;b=c.origin[0];h=c.origin[1];l=h-1;n=b-1;y=rb.arr[c.IAD].reserved;if(f=y.added[p.type]){g=p.space;m=p.rbase();var t=f%e,r=~~(f/e),q=g[g.length-1];v=(g.length-
1)/q*q;for(g=0;g<v&&!m(t+g%q+(~~(g/q)+r)*e);g++);if(g==v)for(y.added[p.type]=!1,g=0;g<v;g++)y[t+g%q+(~~(g/q)+r)*e]=0;else f=-1}else f=-1;0>f&&(f=Ke(b,h,80,l,n,c,p,900));if(0>f)return k.cantBuild[p.type]||(k.cantBuild[p.type]=0),k.cantBuild[p.type]++,k.buildsLosed=c.stats.buildsLosed,!1;k.cantBuild[p.type]&&(k.cantBuild[p.type]=0);C(999999999,44444);return!0};var Ke=function(b,c,e,d,h,l,n,y){var k=rb.arr[l.IAD].reserved,f=H,m=n.space;n=n.validator.check;if(!n)return-1;for(var g=-1,p=e/2*(e/2),t=1,
r=b,q=c;0>g&&b-r<e/2;){--r;--q;for(var x=2*t+1,w=2*t+1,A=0,B=x*w;A<B;A++){var z=A%x,C=~~(A/x);if(!z||!C||z==x-1||C==w-1){z+=r;C+=q;var D=(z-b)*(z-b)+(C-c)*(C-c);if(D<p&&n(z,C,m,d,h,D<y,l.k,k)){g=z+C*f;break}}}t++}return g};ib.tech=function(b,c,e){b=b.doneBy;c=ta[c.k];e=[];for(var k=0,h=b.length;k<h;k++)for(var l=c[b[k].type],n=0,y=l.length;n<y;n++){var f=A[l[n]];f.working||f.techStart||!f.built||e.put(f.id)}if(!e.length)return!1;C(999999999,44444);return!0};ib.unit=function(b,c,e){b=b.doneBy;c=ta[c.k];
e=[];for(var k=0,h=b.length;k<h;k++)for(var l=c[b[k].type],n=0,y=l.length;n<y;n++){var f=A[l[n]];f.working||f.techStart||!1===f.built||e.put(f.id)}if(!e.length)return!1;C(999999999,44444);return!0};rb.prototype.leaveMeAloneIKnowWhatToDo=function(){performance.now();var b=I[this.kingdom],c=b.resources,e=ta[this.kingdom],d=H;if(b.origin){var h=b.origin[0],l=b.origin[1],n=b.race+"-"+c[0]+""+c[1]+""+c[2]+""+c[3];if(rb.precooked[n])pa=rb.precooked[n].slice(0);else{for(var y=l-1,f=h-1,m=h-40,g=l-40,v=0,
p=-1,r=6400,q=0;q<r;q++){var x=q%80+m,w=~~(q/80)+g;1600>(h-x)*(h-x)+(l-w)*(l-w)&&(!(x>=f&&x<=f+2)||w>=y&&w<=y+2)&&0===Y[x+w*d]&&fa(x,w)&&v++}var z=[];performance.now();for(var G=0,J=0,N=B.length;J<N;J++){var F=B[J];if(!F.build&&!F.item&&!F.boat&&F.url.attack&&F.race==b.racestr&&8!=F.type&&void 0==F.res){z.put(F);F.balanceSum=0;F.bestBalance=-1;F.balanceDefence={};for(var P=Infinity,O=F.attDist,R=0;R<N;R++){var M=B[R];if(!M.build&&!M.item&&!M.boat&&M.race==b.racestr&&M.url.attack&&8!=M.type&&void 0==
F.res&&(G=Je(M,F))){var T=Je(F,M);T&&(G-=T,G+=2E3*O,G<P&&(P=G,F.bestBalance=M),F.balanceSum+=G)}}F.balanceTotal=F.balanceSum}}z.sort(hm);F=z[0];for(var U=1E3,W={},S=[],X=0,ba=U;!W[F.type];)W[F.type]=1,S[X++]=F,S[X++]=U,M=F.bestBalance,U=~~(U*Je(M,F)/Je(F,M)+.5),ba+=U,F=M;S.nu=ba-U;C(S);for(var Q=b.target,ja=D,ea=ja.length,aa=[],ka=0;ka<ea;ka++){var da=ja[ka],ia;if(!(ia=!da.type||da.upgrade||da.type==V||void 0!==Vg[da.value]&&b.resources[da.value]>=Q[da.value])){a:{for(var na=da.nu.doneBy,oa=0,ra=
na.length;oa<ra;oa++)if(na[oa].race==b.racestr){var qa=!0;break a}qa=!1}ia=!qa}ia||aa.put({order:da.nu,obj:da,original:1,priority:1E-10})}var la=[];q=0;r=S.length;for(var va=S.nu;q<r;q+=2){var sa=~~(.5+S[q+1]/va*250)-e[S[q].type].length,ca=S[q],wa=ca.type;ca=ca.nu;for(var ha=0;ha<sa;ha++)aa.put({order:ca,priority:1-ha/sa,obj:ca.obj,original:1})}var ya=0,Ea=0,xa=b.target,za={};Ea++;xa[0]=0;xa[1]=0;xa[2]=0;xa[3]=0;q=ya=la.length=0;for(r=aa.length;q<r;q++){var Ha=aa[q].priority,Da=Ug(aa[q],b.technology.investigated,
e,b);ha=0;for(var Fa=Da.length;ha<Fa;ha++){ca=Da[ha];ca.original||(ca.priority=Ha);var Ga=1;void 0!==ca.priority&&(Ga=ca.priority);var Ia=ca.obj;Ia.increase&&void 0!==Vg[Ia.value]&&(Ga=Ia.increase*Ga/c[Vg[Ia.value]]);Ga/=Ia.time;ca.priority=Ga;if(!(0>=ca.priority)){var La=ca.order.id;!za[La]||ca.original?(za[La]=ya,la[ya++]=ca):la[za[La]].priority+=ca.priority}}}var Na=!1;Sg(la,"priority");var Pa={},Ta={},Aa={},pa=[],Za=B.length;for(q=0;q<Za;Aa[q++]=0);for(q=0;q<la.length;q++){var Ja=la[q];ca=Ja.order;
var Ba=Ja.obj;if(Ja.original||Ja.required)Ja.obj.tech||Aa[Ja.obj.type]++,pa.put(Ja);var bb=ca.doneBy,Xa=Ba.time;ha=0;for(r=bb.length;ha<r;ha++){var ua=bb[ha],kb=ua.time;if(ua.race===b.racestr){if(Ba){for(var qb=ua,fb=e[ua.type],ob=rb.process,zb=Xa,Ab=fb.length,Wa=!1,gb=Infinity,hb=0;hb<Ab;hb++){var Sa=A[fb[hb]],Oa=0;Sa.build&&(Sa.working||Sa.techStart||!Sa.built)&&(Sa.built?(Oa=(Sa.c-t.cycle)*zc.speed,Oa/=1E3):(Oa=Sa.time*(Sa.maxHealth-Sa.health)/Sa.maxHealth,Sa.workers&&Sa.workers.length&&(Oa/=Sa.workers.length)));
Sa.build||!Sa.func&&!Sa.in||(Oa=Infinity);Sa.nato!=ob?(Sa.nato=ob,Sa.natoTime=0):Oa+=Sa.natoTime;Oa<gb&&(gb=Oa,Wa=Sa)}Wa&&gb<=qb.time?(Wa.natoTime+=zb,Na=Wa):Na=!1}if(!Na){Pa[ua.type]||(Pa[ua.type]=[],Ta[ua.type]=[]);var Ua=Pa[ua.type],nb=Ta[ua.type];Aa[ua.type]||(Aa[ua.type]=0);var vb=!1,Ma=0;for(Fa=Ua.length+1;Ma<Fa;Ma++){if(void 0==Ua[Ma]){var ub={order:ua.nu,priority:0,obj:ua};la.put(ub);pa.put(ub);Ua[Ma]=0;nb[Ma]=ub;Aa[ua.type]++;vb=!0}if(Ua[Ma]+Xa<=kb||vb){Ua[Ma]+=Xa;nb[Ma].priority+=Ja.priority;
break}}}}}}Sg(pa,"priority");var pb=0;q=0;for(r=pa.length;q<r;q++)if(Ja=pa[q].obj,Ja.build){var Va=Ja.space[Ja.space.length-1]+2,yb=(Ja.space.length-1)/Va+2;pb+=Va*yb}C(pb,v);if(pb>v){var Hb=v/pb*.7;q=0;for(r=B.length;q<r;q++)B[q].build&&(Ja=Aa[q])&&((Ja=~~(Ja*Hb))||(Ja=1),Aa[q]=Ja)}q=0;for(r=pa.length;q<r;q++)Ja=pa[q].obj,Ja.build&&(Aa[Ja.type]?Aa[Ja.type]--:pa[q]=0);for(var Ra=pa,$a=new Uint32Array(14),ab=new Uint32Array(7),cb=new Uint32Array(7),eb=new Uint32Array(7),Fb=6.25,wb=b.resources,Gb=[ab,
eb,$a,cb],ma=0,Qa=0,Bb=0;3>Bb;Bb++){var sb=wb[0],lb=wb[1],tb=wb[2],xb=wb[3];Infinity==sb&&Infinity==lb&&Infinity==tb&&Infinity==xb&&(Fb=-1);var Lb=0,Mb=0,Nb=0,Ob=0;ma=0;for(Qa=Ra.length;ma<Qa;ma++)if(Ra[ma]){var Cb=Ra[ma].obj.cost;Lb+=Cb[0];Mb+=Cb[1];Nb+=Cb[2];Ob+=Cb[3]}if(Bb){for(ma=0;ma<$a.length;$a[ma++]=0);for(ma=0;ma<ab.length;ab[ma++]=0);for(ma=0;ma<cb.length;cb[ma++]=0);for(ma=0;ma<eb.length;eb[ma++]=0);}var Db=[],Qb={},Tb={},db={pop:0,popMax:2E3},Eb=[[]];ma=0;for(Qa=e.length;ma<Qa;ma++){Ka=
e[ma];var Vb=[];db[ma]=Vb;for(var mb=0,Kb=Ka.length;mb<Kb;mb++)Vb[mb]={free:1,type:ma}}for(var Ya=0;9E3>Ya;){var bc=10*Le(ab)/7,cc=10*Le(eb)/7,Wb=10*Le($a)/14,dc=10*Le(cb)/7;sb+=10*ab[Ya%ab.length];lb+=10*eb[Ya%eb.length];tb+=10*$a[Ya%$a.length];xb+=10*cb[Ya%cb.length];var Pb=Eb[Ya];if(Pb)for(ma=0,Qa=Pb.length;ma<Qa;ma++){var Zb=Pb[ma],hc=Zb.list;mb=0;for(Kb=hc.length;mb<Kb;mb++){var Ka=hc[mb];Ka.used||(Ka.used=!0,Db.put(Ka.action));Ka.free=1}var ec=Zb.action&&(Zb.action.original||Zb.action.required)?
!0:!1;if(Zb.obj.tech){Qb[Zb.obj.nu.id]=1;var Xb=Zb.obj;"popLimit"==Xb.value&&(db.popMax+=Xb.increase)}else Zb.obj.build||db.pop++,db[Zb.obj.type].put({free:1,type:Zb.obj.type,action:Zb.action,used:ec})}ma=0;for(Qa=Ra.length;ma<Qa;ma++)if(Ka=Ra[ma]){var Yb=Ka.obj;if(Yb.peon||!(Wb<Fb)){var ib=Yb.cost;if(!(ib[0]>sb||ib[1]>lb||ib[2]>tb||ib[3]>xb)&&1===Ug(Ka,Qb,db,b).length&&(hc=gc(Ka,db))){var Rb=Ka.obj.time+Ya;Eb[Rb]||(Eb[Rb]=[]);if(Ka.obj.tech){if(Tb[Ka.order.id])continue;Tb[Ka.order.id]=1}Ra[ma]=void 0;
(Ka.original||Ka.required)&&Db.put(Ka);for(var $b=0;$b<hc.length;hc[$b++].free=0);Eb[Rb].put({list:hc,obj:Ka.obj,action:Ka});sb-=ib[0];lb-=ib[1];tb-=ib[2];xb-=ib[3]}}}hc=gc.sPeasant(db);ma=0;for(Qa=hc.length;ma<Qa;ma++){var Ib=Ui(bc,cc,Wb,dc,sb,lb,tb,xb,Lb,Mb,Nb,Ob);if(0>Ib)break;2===Ib&&(lb-=200);Gb[Ib][Ya%Gb[Ib].length]++;Ka=hc[ma];Ka.free=0;Ka.used||(Ka.used=!0,Db.put(Ka.action))}Ya++}Ra=Db;Sg(Ra,"priority")}for(var jb=pa=Ra,Jb={},ic=0;ic<jb.length;ic++)jb[ic]&&!jb[ic].obj.tech&&(Jb[jb[ic].obj.name]||
(Jb[jb[ic].obj.name]=0),Jb[jb[ic].obj.name]++,"Blacksmith"==jb[ic].obj.name&&C(jb[ic]));C(Jb);rb.precooked[n]=pa}this.script=pa;var Sb={},ac={added:Sb};this.reserved=ac;q=0;for(r=pa.length;q<r;q++)if((ca=pa[q])&&(Ba=ca.obj)&&Ba.build&&void 0==Sb[Ba.type]&&(p=Ke(h,l,80,y,f,b,Ba,900),-1<p)){x=p%d;w=~~(p/d);wa=Ba.type;Sb[Ba.type]=p;var Ub=Ba.space;Va=Ub[Ub.length-1];yb=(Ub.length-1)/Va;var fc=Va*yb;for(ha=0;ha<fc;ha++)ac[x+ha%Va+(~~(ha/Va)+w)*d]=wa}}};var Le=function(b){for(var c=0,k=b.length,d=0;d<
k;c+=b[d++]);return c},Ui=function(b,c,e,d,h,l,n,y,f,m,g,v){if(Infinity==h&&Infinity==l&&Infinity==n&&Infinity==y)return-1;if(6.25>e)return 200>l?1:2;h=f+v+g+m;l=b+c+e+d;b/=f/h*l;c/=m/h*l;e/=g/h*l;d/=v/h*l;return b<c&&b<e&&b<d?0:c<e&&c<d?1:e<d?2:3},Vi=function(){for(var b=0,c=rb.arr,e=c.length;b<e;c[b++].maintenance());Na({func:Vi},rb.time,1);rb.process++},Wi=function(b,c,e){for(var k=b.length,h=Infinity,l=0,n=0;n<k;n++){var y=A[b[n]],f=Math.pow(c-y.x32,2)+Math.pow(e-y.y32,2);f<h&&(h=f,l=y.id)}return l};
rb.prototype.maintenance=function(){var k=this.script;if(k){var c=I[this.kingdom];if(c.origin){t.blocked=!0;var e=c.technology.investigated,d=ta[c.k],h=H,l={};if(c.values.pop+c.unitLoading+5>c.values.popMax&&c.values.popMax<=c.values.popLimit){for(var n=ua[c.race].house.nu,y=0,f=0,m=c.building,g=m.length;f<g;f++){var v=A[m[f]];v.population&&(y+=v.population)}c.values.pop+c.unitLoading+5>c.values.popMax+y&&ib({order:n,priority:1,obj:n.obj},c,!0)}m=c.resources;n=m[0];y=m[1];var p=m[2],r=m[3],q=[];if(Infinity!=
n||Infinity!=y||Infinity!=p||Infinity!=r){v=0==c.race?b.createPeon.obj:1==c.race?b.createPeon2.obj:b.createPeon1.obj;var w=0,z=0,D=0,G=0;f=0;for(g=k.length;f<g;f++)if(k[f]){var F=k[f].obj.cost;w+=F[0];z+=F[1];D+=F[2];G+=F[3]}var J=F=0,N=0,P=0,M=d[v.type];f=0;for(g=M.length;f<g;f++)if(v=A[M[f]],40==v.func)21==A[v.funcObj.u].type?F+=10/7:P+=10/7;else if(43==v.func)N+=10/14;else if(42==v.func)J+=10/7;else{if(19==v.func&&v.stock){var O=v.stock[1];0==O?F+=10/7:1==O?J+=10/7:2==O?N+=10/14:P+=10/7}(19!=v.func||
v.action)&&v.func||q.put(v)}}f=0;for(g=k.length;f<g;f++)!(v=k[f])||!v.order||l[v.order.id]||6.25>N&&!v.obj.peon||(M=Ug(v,e,d,c).length,O=v.obj.cost,O[0]>m[0]||O[1]>m[1]||O[2]>m[2]||O[3]>m[3]||1===M&&(ib(v,c)?k[f]=0:l[v.order.id]=1));if(q.length)for(k=-Infinity,f=0,m=c.building,g=m.length;f<g;f++){v=A[m[f]];if(v.population)break;v=v.time*(1-v.health/v.maxHealth);v>k&&(k=v)}f=0;for(g=q.length;f<g;f++)if(v=q[f],m=Ui(F,J,N,P,n,y,p,r,w,z,D,G),0==m)(m=Wi(ta[0][21],v.x32,v.y32))&&Xi(m,v,this,c);else if(1==
m)Yi(v);else if(2==m){a:{v=d[20];m=v.length;for(k=0;k<m;k++)if(e=A[v[k]],!e.workers.length&&14E3<25*(t.cycle-e.lastUse)){e.lastUse=t.cycle+100;v=e;break a}v=void 0}if(v)C(999999999,44444);else{l=ta[c.k];v=H;M=cb[2];m=[];m.length=M.length;k=0;for(e=M.length;k<e;m[k]=l[M[k++]]);l=Infinity;M=B[20].space;O=-1;k=0;for(e=m.length;k<e;k++)for(var R=m[k],U=0,T=R.length;U<T;U++){var S=A[R[U]],W=S.x32-10,Y=S.y32-10,V=S.space[S.space.length-1],ca=S.x32+.5*V;S=S.y32+.5*(S.space.length-1)/V;for(V=0;400>V;V++){var X=
V%20,ba=~~(V/20);X+=W;ba+=Y;var da=(X+1-ca)*(X+1-ca)+(ba+1-S)*(ba+1-S);da<l&&Wg(X,ba,M)[1]&&(O=X+ba*v,l=da)}}-1<O&&(C(999999999,44444),y-=200)}}else 3==m&&(m=Wi(ta[0][22],v.x32,v.y32))&&Xi(m,v,this,c);d=!1;D=Infinity;J=c.diplomacy;w=c.origin[0];z=c.origin[1];c=ta[c.k];f=1;for(g=I.length;f<g;f++)J[f]&&!I[f].death&&I[f].origin&&(v=I[f],G=v.origin[0]-w,F=v.origin[1]-z,G=G*G+F*F,G<D&&(D=G,d=v));if(d){G=[];f=F=0;for(g=c.length;f<g;f++)for(J=c[f],D=0,N=J.length;D<N;D++)v=A[J[D]],void 0!=v.func||v.standardFunc!=
x||v.death||v.build||(G[F++]=v.id);if(60<G.length){c=d.origin[0];J=d.origin[1];m=[40,0,-40,0,0,40,0,-40];D=Infinity;f=0;for(g=m.length;f<g;f+=2)if(G=m[f],F=m[f+1],G+=w+10*Math.sign(G),F+=z+10*Math.sign(F),(G-c)*(G-c)+(J-F)*(J-F)<D&&fa(G,F)){D=(G-c)*(G-c)+(J-F)*(J-F);var aa=G+F*h}g=aa%h;aa=~~(aa/h);w=-1;z=Infinity;c=ta[d.k];f=0;for(length=c.length;f<length;f++)for(d=c[f],D=0,G=d.length;D<G;D++)v=A[d[D]],F=(v.x32-g)*(v.x32-g)+(v.y32-aa)*(v.y32-aa),F<z&&(z=F,w=v.x32+v.y32*h);-1<w&&C(999999999,44444)}}t.blocked=
!1}}};var Xi=function(b,c,e,d){c=ua[c.race].storage;var k=A[b];!A[e.mineGroup[b]]&&d.paypalTest(c.cost)?(-1<Ke(k.x32+2,k.y32+2,20,0,0,d,c,0)&&C(999999999,44444),e.mineGroup[b]=d.building[d.building.length-1]):C(999999999,44444)},Yi=function(b){for(var c=I[b.kingdom],k=ta[c.k],d=cb[1],h=0,l=d.length;h<l;h++)for(var n=k[d[h]],f=0,m=n.length;f<m;f++){var g=A[n[f]];if(!g.castle){if(!1===g.built){C(999999999,44444);return}if(Zi(g.x32,g.y32,.075)){C(999999999,44444);return}}}n=c.building;h=0;for(l=n.length;h<
l;h++)if(g=A[n[h]],1===g.storage){C(999999999,44444);return}k=ua[b.race].lumbermill;d=c.origin[0];n=c.origin[1];h=1;l=c.resources;f=k.cost;if(f[0]<l[0]&&f[1]<l[1]&&f[2]<l[2]&&f[3]<l[3])for(;80>h;){--d;--n;m=2*h+1;g=2*h+1;f=0;for(l=m*g;f<l;f++){var p=f%m,v=~~(f/m);if(!p||!v||p==m-1||v==g-1)if(p+=d,v+=n,-1<Zi(p,v,.15,!0)&&-1<Ke(p,v,8,0,0,c,k,0)){C(999999999,44444);return}}h++}c=ta[0][7];h=c.length;l=Infinity;for(k=f=0;k<h;k++)d=A[c[k]],n=Math.pow(b.x32-d.x32,2)+Math.pow(b.y32-d.y32,2),n<l&&(l=n,f=d.id);
f&&C(999999999,44444)},Zi=function(b,c,e,d){var k=H,l=b,n=c;b-=5;c-=5;for(var f=0,m=-1,g=Infinity,p=0;100>p;p++){var v=p%10,r=~~(p/10);v+=b;r+=c;if(fa(v,r)){var t=A[Y[v+r*k]];if(d&&1==t.storage)return-1;7===t.type&&(f++,v=Math.pow(v-l,2)+Math.pow(r-n,2),v<g&&(g=v,m=t.id))}}if(f/100>=e)return m},aj=function(b,c){var k=H,d=b[0];b=b[1];var h=b%k;k=~~(b/k);for(var l=0,n=c.length;l<n;l++){var f=A[c[l]];6400<(f.x32-h)*(f.x32-h)+(f.y32-k)*(f.y32-k)?da(-d,f,Id,f.url.move):da(-b,f,Id,f.url.move)}Xg(!1,c);
Na({func:$i,data:{list:c,xy:-b}},3E4,1)},$i=function(b){var c=b.list;b=b.xy;for(var k=0,d=c.length;k<d;k++){var h=A[c[k]];h.death||da(b,h,Id,h.url.move)}},bj=function(b){var c=b.x32+b.y32*H,k=I[b.kingdom].diplomacy;!b.invisible&&uc[c]&&(c=A[uc[c]],!c.freezed&&k[c.kingdom]&&Rb(b.id,[c.id],0,Wc))},Oc=function(b){var c=Yg(b.id);return c?(Rb(c,[b.id],0,Wc),!0):!1},Yg=function(b,c){b=A[b];return z.radar(b.x32,b.y32,b.sight,b.id)},im=function(b){b.setupINTV(cj,0,1E3)},cj=function(b){var c=b.free;c||(c=
dj);var k=H,d=b.x32,h=b.y32,l=[];l.length=I.length;for(var n=l.length,f=0;f<n;l[f++]=0);f=0;for(var m=c.length;f<m;f+=2){var g=c[f]+d,p=c[f+1]+h;fa(g,p)&&(g=A[Y[g+p*k]],g.nocapture||g.build||l[g.kingdom]++)}k=c=0;for(f=1;f<n;f++)l[f]>c&&(k=f,c=l[f]);c&&b.kingdom!=k&&b.changeKingdom(k);sb(b,1E3)},Zg,jm=[1,1],ej=function(){return Date.now()-Jd+25*z.gcycle()},$b=function(b){if(!(b&&t.online||$b.bySystem&&b))if(0===t.paused){t.paused=1;void 0!=Zg&&clearInterval(Zg);var c=t.now();t.pausedTime+=Date.now();
b||($b.bySystem=1);t.now=function(){return c}}else t.pausedTime-=Date.now(),t.paused=0,$b.bySystem=0,b&&p("alert")&&M("alert"),Zg=setInterval(zc,zc.speed),t.now=ej};$b.bySystem=0;$b.fast=!0;var Ib=function(b,c){var k=0,d=0,h=0;1>b?(b*=-1,h=~~(b/Da),d=b%Da):k=b;b=0;for(var l=c.length;b<l;b++){var n=A[c[b]];n.mimg=n.url.move;z.specialMoveAdapter(n.id,k,0,0,d,h)}};Ib.cursor=7;Ib.allowPos=1;var sb=function(b,c,e){c=~~(c/25)+t.cycle;b.c=c;b.timestamp=t.now()},$g=function(b){var c=A[b[0]];if(!c.death){var k=
b[1],d=b[2],h=b[3];c.cow&&"milk"==k&&c.workers&&c.workers.length||(c[k]+=I[c.kingdom].values[d],d=c[k+"Max"],c[k]>d&&2!==c.blocked&&(c[k]=d));"mana"==k&&(d=c.manaTask)&&d[2]<=c[k]&&(c.blockedAction(1),da(d[1],c,jb[d[0]],c.url.move),c.manaTask=void 0);W(c.id,1);Na({func:$g,data:b},h,1)}},Na=function(b,c,e){b.func.url||C(b.func);b.func=b.func.url;e&&(c=~~(c/25)+t.cycle);e=fj[c];e||(e=[],fj[c]=e);e.put(b)},fj={},gj=function(b){var c=H,k=!1;b.waiting&&(b.stock&&0!==b.stock[0]?(b.mimg=b.url[b.stock[4].url],
b.stock[3]===Jb&&(b.mimg=b.url.milk)):b.mimg=b.url.move);var d=b.y32,h=b.x32;ah(1,b,"zone");var l=z.unitAction(b.id),n=l&&jb[l]||!1;Oa(b,32*d);var f=b.rbase();l=f.write;var m=h+d*c;bj(b);if(b.id===f(m)){var g=b.size;if(2>g)l(m,b.radix);else for(var p=g*g,v=-c,r=0;r<p;r++){var t=r%g;0===t&&(v+=c);l(m+t+v,0)}}if(b.stop)return l(m,b.id),b.stay(),b.stop=void 0,0;if(b.kx||b.ky){var q=b.kx||0,x=b.ky||0;p=!1;if(0!==f(q+h+(x+d)*c))return b.aspettare()}else{n&&n.rev&&(p=n.rev(b))&&(C("break"),b.action=p[0],
n=jb[b.action],b.xf=p[1],b.yf=!0);if(0<(p=z.unitObjetive(b.id))){var w=A[p];if(!w||w.death&&(!n||!n.available))return l(m,b.id),b.stay();r=!0;v=!1;if(n&&n.available){v=n.available(b,w);if(!1===v)return b.aspettare();if("kill"===v)return l(m,b.id),b.stay();if(55===v)return l(m,b.id);r=v[2]}else w.death||(v=Sb(w,b,50,b.radix));z.unitObjetive(b.id)!==p&&(w=A[z.unitObjetive(b.id)]);if(!w||w.death||w.in)return l(m,b.id),b.stay();if(!r&&(B+D*c===m||n))return b.aspettare();var B=v[0],D=v[1];if(n&&n.distance){var F=
n.distance;F=0>F?b.attDist:I[b.kingdom].values[F];v=bh(w,h,d);Kd(h,d,v%H,~~(v/H),F)&&(k=2)}b==w&&(k=2)}else{B=z.unitXF(b.id);D=z.unitYF(b.id);p=f(B+D*c);if(2<p&&(!n||n&&n.rev)){p=A[p];v=Sb(p,b,50,b.radix);if(!1===v)return l(m,b.id),b.stay();B=v[0];D=v[1]}n&&n.distance&&(F=n.distance,F=0>F?b.attDist:I[b.kingdom].values[F],Kd(h,d,B,D,F)&&(k=2))}p=B+D*c;v=B;r=D;if(!k){x=z.inspector71017(h,d,v,r,b.radix,b.zLevel);void 0!==x?(q=-h+x%c,x=-d+~~(x/c)):x=q=1;if(1<Math.abs(q)||1<Math.abs(x))return b.aspettare();
if(f(h+q+(d+x)*c)!==b.radix||!fa(h+q,d+x)){q=[h+1,d,h-1,d,h+1,d+1,h+1,d-1,h,d-1,h-1,d+1,h,d+1,h-1,d-1];x=H;t=Infinity;for(var G,J=0;J<q.length;J+=2)0===f(q[J]+q[J+1]*x)&&fa(q[J],q[J+1])&&t>=(q[J]-v)*(q[J]-v)+(q[J+1]-r)*(q[J+1]-r)&&(t=(q[J]-v)*(q[J]-v)+(q[J+1]-r)*(q[J+1]-r),G=J);v=[q[G],q[G+1]];q=v[0]-h;x=v[1]-d;q=0<q?1:0>q?-1:0;x=0<x?1:0>x?-1:0;if(f(h+q+(d+x)*c)!==b.radix||!fa(h+q,d+x))return b.aspettare()}}}if(m==p||k)if(l(h+d*c,b.id),b.x32=h,b.y32=d,n){if(n.distance&&2!==k)return b.aspettare();
b.stay(1);w||(w=B+D*c);n(w,b,F)}else b.stay();else{if(0===q&&0===x)return b.aspettare();b.setupDir(q,x);k=b.spd;ba(b,b.mimg,-1,b.spd/b.__proto__.spd);b.dix=q*k;b.diy=x*k;d+=x;h+=q;b.x32=h;b.y32=d;sb(b,~~(32E3/k));ac(b,q*k,x*k,0);m=h+d*c;if(2>g)l(m,b.id);else for(p=g*g,v=-c,r=0;r<p;r++)t=r%g,0===t&&(v+=c),l(m+t+v,b.id)}},hj=function(b){b/=1E3;var c=~~(b/60)%60,k=~~(b/3600);b=~~(b%60);1===(b+"").length&&(b="0"+b);0!=k?(k+=":",10>c&&(c="0"+c)):k="";return k+c+":"+b},Jd=0,ij=0,zc=function(){if(!t.editor){t.cycle=
z.gcycle();t.now();Jd&&(ij+=Date.now()-Jd-zc.speed);Jd=Date.now();var b=Date.now();z.movtablexe();t.cycle=z.gcycle();0===t.cycle%40&&jj();ch+=Date.now()-b;0===t.cycle%40&&(p("topinfo").innerHTML="<span>CPU:"+(ch/10).toFixed(2)+"%</span> <span>"+~~(dh/eh+.5)+"FPS</span> <span>"+hj(t.now())+"</span>",dh=eh=ch=0);ij>=zc.speed&&zc()}};zc.speed=25;var ch=0,eh=0,dh=0,Tb=function(b,c,e,d){return[b,c,e,d,b,c,e,d,b,c,e,d,b,c,e,d]};new Float32Array(Tb(1,0,0,.75));new Float32Array(Tb(1,1,1,.5));new Float32Array(Tb(0,
1,0,.75));var km=new Float32Array(Tb(0,1,0,.9));new Float32Array(Tb(.3515625,.29296875,.21875,.9));var lm=new Float32Array(Tb(0,1,1,.9));new Float32Array(Tb(1,1,1,.5));var mm=new Float32Array(Tb(.3,.3,.3,.9)),nm=new Float32Array(Tb(.7,.2,.2,.9));lm.noAlpha=1;mm.noAlpha=1;nm.noAlpha=1;var J=function(b){b=B[b];if(1===Q.length)C(999999999,44444);else for(var c=0,k=4*Ac.shift+1;c<k;c++){var d=Q,h=Infinity;var l=-1;for(var n=0,f=d.length;n<f;n++){var m=A[d[n]];if(!m.techStart&&!1!==m.built){var g=m.icons.indexOf(b.nu);
g=(m.work&&m.work[g]||0)+(t.online&&m.usedCycle==t.cycle&&m.usedTimes||0);g<h&&(!Me||g)&&(h=g,l=m.id)}}0<l&&(l=A[l],l.usedCycle!=t.cycle&&(l.usedTimes=0,l.usedCycle=t.cycle),l.usedTimes++,C(999999999,44444))}},kj=function(b,c){var k=b[0],d=b[1],h=b[2];b=B[k];c=A[c];var l=c.icons.indexOf(b.nu);if(!(0>l||void 0!==c.techID)){performance.now();if(0==h)for(h=0;h<d;h++){var n=I[c.kingdom],f=n.mod[k].cost||b.cost;if(n.paypal(f))break;c.waitlist||(c.waitlist=[]);c.waitlist.push(k,-l-1);c.work||(c.work={});
c.work[l]||(c.work[l]=0);c.work[l]++;c.working=1;n.unitLoading++;2==c.waitlist.length&&(f=1E3*b.time,c.setupINTV(Ld,0,f))}else{if(!c.work||!c.waitlist.length)return;var m=c.waitlist;n=I[c.kingdom];for(h=0;h<d;h++){f=n.mod[k].cost||b.cost;n.setupResources(f,-1);f=m.lastIndexOf(k);if(0>f)break;m.splice(f,2);c.work[l]--;if(0==m.length){c.c=-1;c.working=0;break}n.unitLoading--;0===f&&(f=1E3*B[m[0]].time,c.setupINTV(Ld,0,f))}}W(c.id)}},lj=0,Ld=function(b){if(b.death||b.waitlist&&!b.waitlist.length)return!1;
var c=b.kingdom;c=I[c];var k=c.values.pop>=c.values.popMax?r.VIEWMSG_POPLIMIT2:r.VIEWMSG_POPLIMIT1;if(c.values.pop>=c.values.popMax||c.values.pop>=c.values.popLimit)return p("msgs1").getElementsByTagName("li"),3E4<Date.now()-lj&&c.k==w.kingdom&&Ub(k,0,5),lj=Date.now(),c.onFreePop.put(b.id),!0;c.unitLoading--;c=b.waitlist[0];k=B[c];b.work[-b.waitlist[1]-1]--;b.waitlist.splice(0,2);0<b.waitlist.length?b.setupINTV(Ld,0,1E3*k.time):b.working=0;Ne(c,b);W(b.id);return!0},Ea=function(){0==Me&&C(999999999,
44444)},Fa=function(){0==Me&&C(999999999,44444)},mj=function(b,c){var k=b[0];b=b[1];c=A[c];var d=I[c.kingdom],h=I[c.kingdom];if(h.values.pop>=h.values.popMax&&c.kingdom===w.kingdom)return Ub(r.VIEWMSG_POPLIMIT1,0,5);if(b)var l=h.values.fameTech;h=4;var n=9*b;n||(n=1);if(b)var f=c.mlist,m=c.mlistID;else f=c.hlist,m=c.hlistID;var g=m.indexOf(k);if(!(0>g)){k=f[g].unit;var p=B[k].cost,v=l,q=1.6,t=0;1===n&&(v=0,q=3.6,t=620);if(d.paypal([t+~~(q*p[0]*n+.5)+120*v,~~(q*p[1]*n+.5),~~(q*p[2]*n+.5),~~(q*p[3]*
n+.5)]))return 0;f.splice(g,1);m.splice(g,1);for(d=0;d<n;d++)m=Ne(k,c),l?m.level=h:b||(h=16,m.level=h,f=om[m.race],m.name=f[m.id%f.length],f=m,m=f.level,f.attack+=m,f.defence+=~~(.5*m))}},Ne=function(b,c,e,d){var k=H,l=c.kingdom;c.rnd||fh(c);var n=-1,f=-1;if(c.point&&!c.disallowPoint){var m=c.point[0],g=c.point[1];n=nj(c,m,g,B[b].radix,B[b].rbase())[0]}else n=nj(c,n,f,B[b].radix,B[b].rbase())[1],n=n[oj(c,n.length)];f=~~(n/k);b=new Xc(b,l,n%k,f,0,!1,d);popinfo(l);e||na("unitdone",0,0,b.kingdom);if(c.point){var p;
c=b||A[Q[0]];e=I[c.kingdom];"peon"==(b?c.clss:Md)&&(p=!0);if(t.editor)p=[pm,v];else{var v=m+g*H;m=Y[v];g=0;if(c){if(2<m||(m=Oe[v])&&2<m){var r=A[m];r.invisible||(p&&r.storage&&c.stock?g=Pe:p&&void 0!=r.res?g=Qe:p&&r.health<r.maxHealth&&!e.diplomacy[r.kingdom]&&r.build&&!r.dummy||r.dummy&&!r.built?g=Nd:e.diplomacy[r.kingdom]||r.dummy&&e.values.experience||r.confused?g=Rb:1===r.invType&&!c.build&&!c.boat&&0<r.invMax&&gh(c,r)&&(g=Od))}else m=kb[v],2<m&&!c.build&&!c.boat&&(r=A[m],r.item?g=Pd:r.field&&
p?g=Re:1===r.invType&&!c.build&&!c.boat&&0<r.invMax&&gh(c,r)&&(g=Od));0===g&&(g=db[c.kingdom],g[v]&&p?(m=g[v],g=Nd):(r||(m=-v),g=Ib,Ib.cursor=2));p=[g,m]}else p=[g,v]}v=p[1];if(p[0])p[0](v,[b.id])}return b},pj=0,qj=0,Pb,hb,ye,P=function(b){b=B[b];Pb=!1;var c=ja;ba(c,b.img);c.active=!0;hb=b;ye=!1;C(Pb);document.addEventListener("mousemove",Jg);document.addEventListener("mousedown",yd)},yd=function(b){var c=hb.validator,k=hb.space,d=lb[hb.img];0==b.button&&151<b.pageX?(b=fc(b.pageX-w.mx-.5*d[8]/S,b.pageY-
.5*d[9]/S),d=~~(.03125*b[1]),b=~~(.03125*b[0]),hb.wall?Eb(b,d):c(b,d,k,w.kingdom)[1]&&(Pb=!0,ja.active=!0,ja.x=-9999,ja.y=-9999,document.removeEventListener("mousedown",yd),C(999999999,44444),Ac.shift&&(ye?Ki(ye):P(hb.type)))):(ja.active=!0,ja.x=-9999,ja.y=-9999,Pb=!0,document.removeEventListener("mousedown",yd))},Jg=function(b){var c=hb.validator,k=hb.space,d=lb[hb.img];if(Pb)document.removeEventListener("mousemove",Jg);else{var h=b.pageX,l=b.pageY;if(h!=pj||l!=qj)ja.active=!0,pj=h,qj=l,h=fc(b.pageX-
w.mx-.5*d[8]/S,b.pageY-.5*d[9]/S),l=~~(.03125*h[1]),h=~~(.03125*h[0]),b=32*h,d=32*l,c=!c(h,l,k,rj.k)[1],c!=sj&&(sj=c),ja.x=b,ja.y=d}},hh=function(b,c){var k=b[0],d=k%Da,h=~~(k/Da),l=t.editor?w.kingdom:A[c[0]].kingdom;k=b[1];var n=B[k],f=n.cost,m=I[l];if(!n.validator(d,h,n.space,l)[1]||!t.editor&&m.paypal(f))return!1;b=new Xc(k,l,d,h,0,!t.editor,b[2]);if(!0===b.invalid||t.editor)return!1;b.waitlist=[];if(20===k)b.built=1,d=A[c[0]],da(b.id,d,Bc,d.url.move);else for(b.health=1,ba(b,b.bimg),b=b.id,k=
0,h=c.length;k<h;k++)d=A[c[k]],d.buildList?(d.buildList.put(b),d.func!==Se.url&&(l=Te(d.buildList,d.x32,d.y32))&&da(l,d,Cc,d.url.move)):(d.buildList=[b],d.func!==Se.url&&da(b,d,Cc,d.url.move))},sj=null,Eb=function(b,c){Eb.x=b;Eb.y=c;Pb=!0;ja.active=!0;ja.x=-9999;ja.y=-9999;document.removeEventListener("mousedown",yd);Eb.click=!1;Eb.painted={};jc.lastFrame=xa.frameCount-1;jc(b,c);document.addEventListener("mousemove",ih);document.addEventListener("mouseup",tj)},jc=function(b,c){if(Eb.click)document.removeEventListener("mousemove",
ih);else if(xa.frameCount>jc.lastFrame){jh=!1;jc.lastFrame=xa.frameCount;var k=Eb.x,d=Eb.y,h=0,l=Math.abs(k-b)+1,n=Math.abs(d-c)+1;k=b<k?b:k;d=c<d?c:d;var f=jc.anims;b=0;for(c=f.length;b<c;b++)Ma(f[b].bufferID);for(b=f.length=0;b<l;b++)for(c=0;c<n;c++)if(!b||!c||b===l-1||c===n-1){var g=b&&b<l-1?m.wood_horz:c&&c<n-1?m.wood_vert:hb.img;var p=b+k;var r=c+d;p={x32:p,y32:r,img:g,d:0};f[h++]=p}}};jc.anims=[];var tj=function(b){b=jc.anims;for(var c=0,k=b.length;c<k;c++){var d=b[c];C(999999999,44444);Ma(d.bufferID)}b.length=
0;Eb.click=!0;document.removeEventListener("mouseup",tj)},ih=function(b){var c=lb[hb.img];b=fc(b.pageX-w.mx-.5*c[8]/S,b.pageY-.5*c[9]/S);c=~~(.03125*b[1]);b=~~(.03125*b[0]);jc(b,c)},uj=function(b,c){b=0;for(var k=c.length;b<k;b++){var d=A[c[b]];d.xf?d.stop=1:d.stay()}},kh=function(b,c){b=A[c[0]];b.techStart=0;b.c=void 0;z.unitWorking(this.id,!1);c=b.techID;b.techID=void 0;if(c){var k=I[b.kingdom].technology.hidden;-1<c&&(k[c]=0);I[b.kingdom].setupResources(D[b.activeTech].cost,-1)}else if(b.lcost)I[b.kingdom].setupResources(b.lcost,
-1);else return;W(b.id)},G=function(b){C(999999999,44444)},vj=function(b,c){var k=D[b],d=k.nu.id,h=A[c];k.upgrade&&(d=-1);if(void 0!==h.techID||h.waitlist&&h.waitlist.length||I[h.kingdom].paypal(k.cost))return!1;h.activeTech=b;h.techID=d;h.setupINTV(k.type,b,1E3*k.time);h.techStart=h.c-t.cycle;b=I[A[c].kingdom].technology.hidden;-1<d&&(b[d]=1);W(c)},V=function(b,c){c=D[c];Vb(b,c,c.nu.id)},Ue=function(b,c){c=D[c];var k=c.nu.id,d=B[c.obj],h=I[b.kingdom].mod[d.type];lh(b);b.img=d.img;b.attack=h.attack||
d.attack;b.health=b.health/b.maxHealth*d.health;b.maxHealth=d.health;b.__proto__=d;Vb(b,c,k)},Ve=function(b,c){c=D[c];var k=c.nu.id;if(c.actvintv)for(var d=c.actvintv,h=0,l=d.length;h<l;h++){var n=d[h];I[b.kingdom].technology.disabled[n.id]=0;for(var f=n.builds,m=ta[b.kingdom],g=0,p=f.length;g<p;g++)for(var v=m[f[g]],r=0,q=v.length;r<q;r++)n(A[v[r]])}Vb(b,c,k)},Pa=function(b,c){c=D[c];var k=c.nu.id;I[b.kingdom].values[c.value]+=c.increase;"popMax"==c.value&&popinfo(b.kingdom);Vb(b,c,k)},wj=function(b,
c){c=D[c];var k=c.nu.id,d=c.group,h=I[b.kingdom],l=ta[h.k];h=h.mod;for(var n=0,f=d.length;n<f;n++)for(var m=h[d[n].type],g=l[d[n].type],p=0,v=c.values,r=v.length;p<r;p+=2){var q=v[p],t=v[p+1];m[q]||(m[q]=d[n][q]||0);for(var x=0,w=g.length;x<w;x++)A[g[x]][q]+=t;m[q]+=t}Vb(b,c,k)},Ua=function(b,c){c=D[c];var k=c.nu.id,d=c.group,h=I[b.kingdom],l=h.mod;h=ta[h.k];for(var n=0,f=d.length;n<f;n++){var m=l[d[n].type];m[c.value]||(m[c.value]=d[n][c.value]||0);m[c.value]+=c.increase;m=h[d[n].type];for(var g=
0,p=m.length;g<p;g++)A[m[g]][c.value]+=c.increase}Vb(b,c,k)},mh=function(b,c){c=D[c];for(var k=c.nu.id,d=I[b.kingdom].mod,h=c.mulp,l=0,n=c.group.length;l<n;l++){var f=c.group[l],m=d[f.type].cost||f.cost;d[f.type].cost=h?[~~(m[0]*h),~~(m[1]*h),~~(m[2]*h),~~(m[3]*h)]:[m[0]-c.decrease[0],m[1]-c.decrease[1],m[2]-c.decrease[2],m[3]-c.decrease[3]]}Vb(b,c,k)},nh=function(b,c){c=D[c];for(var k=c.nu.id,d=I[b.kingdom].mod,h=0,l=c.decrease,n=l.length;h<n;h+=2){var f=l[h],m=l[h+1],g=d[f.type].cost||f.cost;d[f.type].cost=
[g[0]-m[0],g[1]-m[1],g[2]-m[2],g[3]-m[3]]}Vb(b,c,k)},Vb=function(b,c,e){b.techStart=void 0;b.activeTech=void 0;b.techID=void 0;b.func=void 0;var k=I[b.kingdom].technology,h=k.disabled;k.investigated[e]=1;z.investigateTech(k.k,e+B.length);na("techdone",0,0,b.kingdom);if(c=c.next)for(e=0,k=c.length;e<k;e++)h[c[e].id]--;b.standardFunc&&b.standardFunc(b);W(b.id)};"use strict";var cb,qm={icon:"food",img:"item_meat",url:"meat"},rm={icon:"milk",img:"milk",url:"milk"},sm={icon:"gold",img:"item_gold",url:"gold"},
tm={icon:"stone",img:"item_stone",url:"stone"},xj={icon:"wood",img:"item_tree",url:"tree"},um={icon:"food",img:"item_food",url:"food"},Qd=function(b,c,e,d){b=ta[b];var k=cb[c];c=[];c.length=k.length;for(var l=0,n=k.length;l<n;c[l]=b[k[l++]]);b=Infinity;k=-1;for(l=0;l<c.length;l++){n=c[l];for(var f=n.length,m=0;m<f;m++){var g=A[n[m]];if(!1!==g.built){var p=g.x32,v=g.y32,r=g.space;g=r[r.length-1];r=(r.length-1)/g;g*=.5;r*=.5;p+=g;v+=r;g=.5*(g+r);p=Math.sqrt((p-e)*(p-e)+(v-d)*(v-d))-g;b>=p&&(b=p,k=n[m])}}}return k},
oj=function(b,c){b=b.rnd;var k=b[0],d=b[1],h=b[2];k+=h;d-=h;k=36969*(k&65535)+(k>>16)&4294967295;d=18E3*(d&65535)+(d>>16)&4294967295;b[0]=k;b[1]=d;b[2]++;return~~((((k<<16)+d&4294967295)/4294967295+.5)*c)},We=function(b){b!=yj&&(yj=b,document.body.style.cursor='url("'+w.cdn+"cursor"+b+'.gif"),auto')},yj=-1,Pd=function(b,c){for(var k=0,d=c.length;k<d;k++){var h=A[c[k]];da(b,h,Rd,h.url.move)}};Pd.spLevel=function(b){var c=0;2<kb[b]&&(c=kb[b]);return c};var Rd=function(b,c){c.stay55();if(c.inventory&&
c.invMax===c.inventory.length||!b.item)return 1;kb[b.x32+b.y32*H]=b.radix;Oa(b,NaN);if(c.peon&&b.contain){var k=b.contain[1],d=b.contain[0];c.stock&&zj(c);var h=Aj(c.x32,c.y32)||!1,l=b.contain[2];b.die(1);c.stock=[d,k,h,Rd.url,l];b=Qd(c.kingdom,k,c.x32,c.y32);da(b,c,mb,c.url[l.url]);W(c.id);return 1}c.addItem(b);W(c.id)},zj=function(b){var c=Bj(b.x32,b.y32),k=~~(c/H);c%=H;c=new Xc(52,b.kingdom,c,k,0);ba(c,m[b.stock[4].img]);c.contain=[b.stock[0],2,b.stock[4]]},Cj=function(b,c){b=0;for(var k=c.length;b<
k;b++){var d=A[c[b]];d.xf?d.stop=2:(d.stop=2,d.stay(),d.stop=void 0)}},Ye=function(b,c){var k=H;b=A[b];for(var d=0,h=c.length;d<h;d++){var l=A[c[d]];if(l.in){var n=l.rbase(),f=l.x32+l.y32*k;if(0!==n(f)||!b.build){f=b.build?Xe(l,l.x32,l.y32):Xe(l,b.x32,b.y32);if(!1===f)continue;l.x32=f%H;l.y32=~~(f/H)}l.item&&(b.attack-=l.attack||0,b.defence-=l.defence||0);l.url.idle&&ba(l,l.url.idle,1);n.write(f,l.id);l.in=0;b.inventory.quit(l.id);n=1;l.z32&&(n=l.z32);Oa(l,32*l.y32*n)}}W(b.id,1)},Od=function(b,c){b=
A[b];if(1===b.invType)for(var k=0,d=c.length;k<d;k++){var h=A[c[k]];h==b||h.in||da(b.id,h,oh,h.url.move)}},oh=function(b,c){var k=b.inventory;if(k.length<b.invMax){var d=c.x32,h=c.y32;c.stay55();c.rbase().write(d+h*H,c.radix);k.put(c.id);Oa(c,NaN);c.in=b.id;Sd(c.id);W(b.id)}else c.stay55()},Nd=function(b,c){for(var k=c.length,d=0;d<k;d++){var h=A[c[d]];h.buildList=!1;da(b,h,Cc,h.url.move)}},Cc=function(b,c){if(b.dummy&&b.dummy.built)return c.stay55();if(b.health<b.maxHealth)c.dix=0,c.diy=0,c.mv=!0,
c.setupDirBuild(b),ba(c,c.url.build,1),c.setupINTV(Se,b.id,Xa(c.img)),Gd(c,"hit%20",7,c.img);else{if(c.buildList&&(b=Te(c.buildList,c.x32,c.y32)))return da(b,c,Cc,c.url.move),0;c.stay55()}},Ze=function(b,c){return c[b]&&13==A[c[b]].type||13==A[Y[b]].type?!0:!1},Se=function(b,c){c=A[c];var k=b.x32,d=b.y32,h=c.x32+c.y32*H;if(c.death)return b.stay();var l=c.maxHealth,n=l/c.__proto__.time*I[b.kingdom].values.buildSpeed;c.health+=n;var f=c.health;if(0==c.built){if(1===c.health-n){for(var g=c.validator(c.x32,
c.y32,c.space,c.kingdom)[0],p=c.id,r=c.validator.dimension,v=r.write,q=0,t=g.length;q<t;q++)if(2<r(g[q])){sb(b,Xa(b.img));c.health-=n;return}n=db[c.kingdom];q=0;for(t=g.length;q<t;q++)v(g[q],p),n[g[q]]=void 0;ta[c.kingdom][c.type].put(c.id);Kb(c)}g=~~(4*f/l);g>c.d&&(c.d=g,ba(c,c.img))}if(f>=l){f=c.health=l;W(c.id);if(!1===c.built){c.d=0;g=c.url;n=db[c.kingdom];13===c.type&&(Ze(h-1,n)&&Ze(h+1,n)?(g=m.wood_horz,c.child=void 0):Ze(h+H,n)&&Ze(h-H,n)&&(g=m.wood_vert,c.child=void 0));c.built=1;c.img=g;
if(c.valid2)for(g=c.validator(c.x32,c.y32,c.space,c.kingdom)[2],v=c.validator.dimension.write,q=0,t=g.length;q<t;v(g[q++],0));h=c;g=I[h.kingdom];if(h.population)for(p=h.population,g.values.popMax+=p,popinfo(h.kingdom),v=0;v<p;v++)g.checkPopArray();if(h.onbuild)for(h=h.onbuild,p=g.technology,g=p.disabled,p=p.actived,v=0;v<h.length;v++)q=h[v].id,p[q]||(p[q]=0),p[q]++,p[q]-1||g[q]--;na("bldgdone",0,0,c.kingdom);I[c.kingdom].building.quit(c.id);W(c.id);c.standardFunc&&c.standardFunc(c)}c.action=void 0;
(h=b.buildList)&&h.quit(c.id);if(!h||b.buildList&&0===b.buildList.length)b.buildList=Dj(b),h=b.buildList;if(k=Te(h,k,d))return da(k,b,Cc,b.url.move),0;b.buildList.length=0;b.stay();b.stock&&b.stock[0]&&ba(b,b.url[b.stock[4].url])}else W(c.id),sb(b,Xa(b.img));Q[0]==c&&(tb.innerHTML=f+"/"+l,la.value=f)},Re=function(b,c){if(2<b)for(var k=0,d=c.length;k<d;k++){var h=A[c[k]];da(b,h,Bc,h.url.move)}},Qe=function(b,c){var k=b;b=A[b];if(b.field)for(d=0,b=c.length;d<b;d++)h=A[c[d]],da(k,h,Bc,h.url.move);else if(0===
b.res||3===b.res){var d=0;for(b=c.length;d<b;d++){var h=A[c[d]];da(k,h,$e,h.url.move)}}else if(1===b.res)for(d=0,b=c.length;d<b;d++)h=A[c[d]],da(k,h,Dc,h.url.move);else if(2===b.res)for(d=0,b=c.length;d<b;d++)h=A[c[d]],da(k,h,Jb,h.url.move)},Ej=function(b,c){var k=B[b],d=c.length;b=I[A[c[0]].kingdom].mod[b];for(var h=0;h<d;h++){var l=A[c[h]];l.stay();lh(l);l.img=k.img;l.attack=b.attack||k.attack;l.health=l.health/l.maxHealth*k.health;l.maxHealth=k.health;l.defence=b.defence||k.defence;l.__proto__=
k;W(l.id)}},Rb=function(b,c,e,d){e=d||Yc;if(!(3>b||(b=A[b],void 0!=b.res&&!b.cow||b.magicGateway))){d=0;for(var k=c.length;d<k;d++){var l=A[c[d]];l==b||l.attackOnly&&!l.attackOnly[b.type]||l.bat&&b.build||b.stoned||(l.build?e(b,l):da(b.id,l,e,l.url.move))}}},Dc=function(b,c){if(0<b.health){var k=c.x32,d=c.y32;c.mv=!0;c.setupDir(b.x32-k,b.y32-d);ba(c,c.url.cut,1);c.dix=0;c.diy=0;Gd(c,"chop%20",11,c.img);c.setupINTV(Fj,b.id,7E3);b.addWorker(c)}else c.stay55()},Fj=function(b,c){var k=H;c=A[c];var d=
I[b.kingdom].values.wood;c.workers.quit(b.id);var h=Qd(b.kingdom,1,b.x32,b.y32),l=A[h];c.health-=d;b.mv=!1;W(c.id);if(1>c.health){d+=c.health;Y[c.x32+c.y32*k]=0;k=ia(l.x32,l.y32);l=c.health=0;for(var n=c.workers.slice(0),f=n.length;l<f;l++){var m=A[n[l]];k?da(k,m,Dc,b.url.move):m.stay()}b.stock=[d,1,k,Dc.url,xj];b.mv=!1;da(h,b,mb,b.url.tree);W(b.id,1);c.workers.length=0;c.die()}else b.stock=[d,1,c.id,Dc.url,xj],da(h,b,mb,b.url.tree),W(b.id,1);if(0>h)return b.stay()},Bc=function(b,c){c.mv=!0;c.setupDir(b.x32-
c.x32,b.y32-c.y32);ba(c,c.url.dig,1);Gd(c,"dig%20",3,c.img);c.setupINTV(Gj,b.id,14E3);b.addWorker(c)},Gj=function(b,c){c=A[c];var k=I[b.kingdom].values.food,d=b.x32,h=b.y32;c.lastUse=t.cycle;d=Qd(b.kingdom,2,d,h);b.mv=!1;b.stock=[k,2,c.id,Bc.url,um];da(d,b,mb,b.url.food);W(b.id,1);if(0>d)return b.stay()},Jb=function(b,c){c.mv=!0;c.setupDir(b.x32-c.x32,b.y32-c.y32);ba(c,c.url.milk1,1);c.stock=[0,2,b.id,Jb.url,rm];c.setupINTV(ph,b.id,1E3);b.addWorker(c);b.d=(8-c.d)%8;b.stay()},ph=function(b,c){c=A[c];
c.milk-=3;var k=b.x32,d=b.y32;b.stock[0]+=3;W(b.id,1);if(0>=c.milk||c.death){if(50<b.stock[0]&&(b.stock[0]=50),b.mv=!1,c=Qd(b.kingdom,2,k,d),da(c,b,mb,b.url.milk),0>c)return b.stay()}else sb(b,1E3)},Id=function(b,c){c.stay55()},Wc=function(b,c){Yc(b,c)},Yc=function(b,c){if(1!==b.death&&b!=c){if(b.dummy&&!I[c.kingdom].values.experience)return c.stay55();c.invisible&&Zc(c.id);if(!0!==c.build){c.mv=1;var k=b.x32-c.x32,d=b.y32-c.y32;b.space&&(d=bh(b,c.x32,c.y32),k=d%H-c.x32,d=~~(d/H)-c.y32);c.setupDir(k,
d,c.d2attack);c.url.attack&&ba(c,c.url.attack,1)}c.setupINTV(af,b.id,c.attackTime||Xa(c.img),b);b.addWorker(c)}else c.stay55()};Yc.distance=-1;Wc.distance=-1;var qh=function(b,c){var k=I[b.kingdom];if(k.values.experience&&(!c||0!=k.diplomacy[c.kingdom]||c.dummy)){if(0==b.level||null==b.level)b.level=0,b.levelProgress=0;b.levelProgress++;b.levelProgress>=~~(b.level/k.values.experience)&&b.level<k.values.maxLevel&&(b.level++,b.health+=k.values.healthJump,b.maxHealth+=k.values.healthJump,b.levelProgress=
0,b.attack+=b.level,b.defence+=b.level%2,W(b.id,1))}},Hj=function(b,c){b=.5-Math.atan2(c,b)/(2*Math.PI);1==b&&(b=0);return b},af=function(b,c){c=A[c];var k=b.attDist,d=c.x32-b.x32,h=c.y32-b.y32,l=c.x32,n=c.y32,f=!b.build;if(b.attackSound){var m=b.attackSound;na(m[~~(m.length*Math.random())],b.x32,b.y32)}f&&!c.build&&b.setupDir(d,h,b.d2attack);ba(b,b.img,1);if(c.death||b.level&&8<=b.level&&c.dummy||c.dummy&&b.level&&b.level>=I[b.kingdom].values.maxLevel)return b.stay();if(1<k&&!b.dragon){f=!0;var g=
lb[b.attimg]}else f=!1;if(c.build||Kd(c.x32,c.y32,b.x32,b.y32,k)){c.onattack(b);k=b.attack*((Hd[b.type][c.type]||0)+1);if(f){c.space&&(d=bh(c,b.x32,b.y32),l=d%H,n=~~(d/H),d=l-b.x32,h=n-b.y32);f=0;if(b.arrow||b.ball){m=Ij;var p=Hj(-d,-h);var v=d;var r=h;var q=411/Math.sqrt(v*v+r*r);v*=q;r*=q;var x=Math.sqrt(1024*d*d+h*h*1024)/Math.sqrt(v*v+r*r);b.ball&&(g[1]=g[0]/x)}else{var w=2;m=bf;f=v=t.gravity;p=Math.PI/180*60;q=Math.cos(p);p=b.attackDeg;p*=Math.PI/180;r=Math.sin(p);x=Math.cos(p);p=32*Math.sqrt(d*
d+h*h);v=x*Math.sqrt(v*p/(r*x*2));x=p/v;r=-Math.sin(Math.atan2(-d,-h));p=Hj(-d,-h);v*=r;f=Math.abs(f*q*r);r=(32*h-f*x*x*.5)/x}x=Math.round(1E3*x);q={x32:b.x32+.5,y32:b.y32+.5,img:g.url,mv:b.ball,d:0,rotation:2*-p*Math.PI-3*Math.PI/2,xf:l,yf:n,obj:c.id,attack:k,range:w};ac(q,v,r,f);Na({func:m,data:q},x,1)}q||c.damage(k,b);if(c.dummy){if(50<=b.dummyDamage||!b.dummyDamage)b.dummyDamage=0;b.dummyDamage+=k;50<=b.dummyDamage&&qh(b,c)}c.death?(b.action=null,c.build||b.build||qh(b,c),Oc(b)||b.stay()):sb(b,
b.attackTime||Xa(b.img))}else b.build&&(Oc(b)||b.stay()),b.mv=!1,0!==b.state&&da(c.id,b,Yc,b.url.move)},$e=function(b,c){0<b.health?(c.dix=0,c.diy=0,c.mv=1,c.setupDirBuild(b),ba(c,c.url.kirka,1),Gd(c,"mine%20",3,c.img),c.setupINTV(Jj,b.id,7E3),b.addWorker(c)):c.stay()},Jj=function(b,c){c=A[c];var k=c.res,d=I[b.kingdom].values[0==k?"gold":"stone"],h=b.x32,l=b.y32;c.health-=d/I[b.kingdom].values.miningPerf;W(c.id);1>c.health&&(d=c.health+d,c.health=0,c.d=3,c.die());b.mv=!1;h=Qd(b.kingdom,k,h,l);0==
k?(b.stock=[d,k,c.id,$e.url,sm],da(h,b,mb,b.url.gold)):(b.stock=[d,k,c.id,$e.url,tm],da(h,b,mb,b.url.stone));W(b.id,1);if(0>h)return b.stay()},da=function(b,c,e,d){var k=0,l=0;0>=b&&(b*=-1,k=b%H,l=~~(b/H),b=0);z.specialMoveAdapter(c.id,b,e.url,d,k,l);c.mimg=d},df=function(b,c){if(A[c[0]].boat&&(b=-b,b=-Xe(B[76],b%H,~~(b/H)),!b))return!1;cf(c,b,Kj)};df.allowPos=1;var Kj=function(b,c){C(b);Ye(c.id,c.inventory.slice(0));c.stay55()},bh=function(b,c,e){var k=b.space||jm,h=k.length-1,l=k[h],n=b.x32;b=b.y32-
1;for(var f=Infinity,m=0,g=0;g<h;g++){var p=g%l;p||b++;var v=(n+p-c)*(n+p-c)+(b-e)*(b-e);v<f&&k[g]&&(m=n+p+b*H,f=v)}return m},Xe=function(b,c,e){var k=H,h=b.radix,l=b.rbase();for(b=2;60>=b;b+=2){c--;e--;for(var n=0;n<=b;){var f=c+n+k*e;if(l(f)===h)return f;f=c+n+k*(e+b);if(l(f)===h)return f;n++}for(n=0;n<b-1;){n++;f=c+k*(e+n);if(l(f)===h)return f;f=c+b+k*(e+n);if(l(f)===h)return f}}return!1},Bj=function(b,c){var k=H,d,h=$c;for(d=2;60>=d;d+=2){b--;c--;for(var l=0;l<=d;){var n=b+l+k*c;if(0===h(n)&&
0===Y[n])return n;n=b+l+k*(c+d);if(0===h(n)&&0===Y[n])return n;l++}for(l=0;l<d-1;){l++;n=b+k*(c+l);if(0===h(n)&&0===Y[n])return n;n=b+d+k*(c+l);if(0===h(n)&&0===Y[n])return n}}return!1},Sb=function(b,c,e,d){var k=c.x32,l=c.y32,n=H,f=k+l*n,m=b.x32,g=b.y32,p=b.space;if(p){var v=p[p.length-1];p=(p.length-1)/v;b=b.free}else p=v=1,b=dj;c=c.rbase();for(var r,q=Infinity,t=-1,x=!1,w=0;w<e&&-1==t;){if(0==w&&b){for(var z=[],B=0,A=b.length;B<A;B+=2){var D=b[B]+m;r=b[B+1]+g;if(fa(D,r)&&(c(D+r*n)===d||D+r*n==
f))a:{var C=z;D+=r*n;r=k;for(var F=l,G=H,J=Math.pow(D%G-r,2)+Math.pow(~~(D/G)-F,2),I=0,M=C.length;I<M;I++)if(Math.pow(C[I]%G-r,2)+Math.pow(~~(C[I]/G)-F,2)>J){C.splice(I,0,D);break a}C.put(D)}}z[0]&&(t=z[0]);if(-1<t){x=!0;break}if(1==e)break}w++;--m;--g;z=v+2*w;C=p+2*w;B=0;for(A=z*C;B<A;B++)r=B%z,F=~~(B/z),r&&F&&r!=z-1&&F!=C-1||(r+=m,F+=g,D=r+F*n,c(D)==d&&fa(r,F)&&(r=(r-k)*(r-k)+(F-l)*(F-l),q>r&&(q=r,t=D)))}return-1<t?[t%n,~~(t/n),x]:!1},nj=function(b,c,e,d,h){performance.now();var k=H,n=b.x32,f=b.y32,
m=b.space,g=[],p=0;if(m){var v=m[m.length-1];m=(m.length-1)/v;var r=b.free}else m=v=1;b=-1==c?-Infinity:Infinity;for(var q=-1,t=0,x=0;0==g.length;){if(r&&0==x){for(var w=0,z=r.length;w<z;w+=2){var B=r[w]+n,A=r[w+1]+f;fa(B,A)&&h(B+A*k)===d&&(g[p++]=B+A*k,t=(B-c)*(B-c)+(A-e)*(A-e),b>t&&(b=t,q=B+A*k))}if(g.length)break}x++;--n;--f;for(w=0;w<v+2*x;w++)h(n+f*k+w)==d&&fa(n+w,f)&&(g[p++]=n+w+f*k,t=(n+w-c)*(n+w-c)+(f-e)*(f-e),b>t&&(b=t,q=n+w+f*k)),h(n+(f+m+2*x-1)*k+w)==d&&fa(n+w,f+m+2*x-1)&&(g[p++]=n+(f+
m+2*x-1)*k+w,t=(n+w-c)*(n+w-c)+(f+m+2*x-1-e)*(f+m+2*x-1-e),b>t&&(b=t,q=n+(f+m+2*x-1)*k+w));for(w=1;w<m+2*x-1;w++)h(n+(f+w)*k)==d&&fa(n,f+w)&&(g[p++]=n+(f+w)*k,t=(n-c)*(n-c)+(f+w-e)*(f+w-e),b>t&&(b=t,q=n+(f+w)*k)),h(n+v+2*x-1+(f+w)*k)==d&&fa(n+v+2*x-1,f+w)&&(g[p++]=n+v+2*x-1+(f+w)*k,b>t&&(b=t,q=n+v+2*x-1+(f+w)*k))}return[q,g]},dj=[-1,0,-1,-1,0,-1,1,-1,1,0,1,1,0,1,-1,1],Te=function(b,c,e){for(var k=Infinity,h=!1,l=0,n=b.length;l<n;l++){var f=b[l],m=A[b[l]];if(0!=m.built||m.death)l--,n--,b.quit(f);else{var g=
m.x32;m=m.y32;m=(g-c)*(g-c)+(m-e)*(m-e);k>=m&&(k=m,h=f)}}return h},Lj=function(b,c){b=0;for(var k=c.length;b<k;b++){var d=A[c[b]];d.spd=d.__proto__.spd}},Xg=function(b,c){b=Infinity;for(var k=0,d=c.length;k<d;k++){var h=A[c[k]];h.spd<b&&(b=h.spd)}rh(b,c)},Aj=function(b,c){for(var k=H,d,h=Infinity,l=0,n=0;121>n;n++){var f=n%11-5,m=~~(n/11)-5,g=f*f+m*m;f+=b;m+=c;g<h&&(d=kb[f+k*m],0<d&&0==Y[f+k*m]&&(d=A[d],d.contain&&(h=g,l=d.id)))}return l},Pe=function(b,c){cf(c,b,mb)},mb=function(b,c){b=I[c.kingdom];
var k=c.stock;b.resources[k[1]]+=k[0];b.stats.resources[k[1]]+=k[0];ef(c.kingdom);c.func=1;var d=jb[k[3]],h=A[k[2]];if(d==Jb){var l=c.x32;for(var n=c.y32,f=H,m,g=Infinity,p=!1,v=0;961>v;v++){var r=v%31-15,q=~~(v/31)-15,x=r*r+q*q;r+=l;q+=n;x<g&&(m=kb[r+f*q],0<m&&0===Y[r+f*q]&&(m=A[m],m.contain&&"meat"==m.contain[2].url&&(g=x,p=m)))}if(l=p)d=Rd,h=l}else"meat"==k[4].url&&!1===k[2]&&(l=sh(c.x32,c.y32,!0))&&(d=Jb,h=l,k[2]=1);c.stock=void 0;if(!1===k[2])return c.stay();if(l=100<Math.pow(h.x32-c.x32,2)+
Math.pow(h.y32-c.y32,2))a:{l=cb[1];n=ta[c.kingdom];f=0;for(g=l.length;f<g;f++)if(p=l[f],1==B[p].storage&&n[p].length){l=!0;break a}l=!1}l&&void 0!==b.IAD&&1==k[1]?(t.blocked=!0,Yi(c),t.blocked=!1):(da(h.id,c,d,c.url.move),W(c.id,1))};Qe.cursor=6;Rb.cursor=1;Nd.cursor=9;Pd.cursor=5;Od.cursor=7;df.cursor=7;Re.cursor=6;Pe.cursor=6;var Dj=function(b){var c=H,k=b.kingdom,d=b.x32,h=b.y32;d-=16;h-=16;for(var l={},n=[],f=0,m=db[k],g=0;1024>g;g++){b=g%32+d;var p=~~(g/32)+h;fa(b,p)&&(b=m[b+p*c],void 0!==b&&
(b=A[b],b.kingdom!=k||!1!==b.built||l[b.id]||(n[f++]=b.id,l[b.id]=1)))}return n};Dc.available=function(b,c){var k=I[b.kingdom].values.wood;if(c.death||1>c.health-k&&c.workers.length){c=ia(c.x32,c.y32);if(!c)return"kill";b.xf=c;c=A[c]}return Sb(c,b,1,b.radix)};Bc.available=function(b,c){if(c.death)return"kill";b=c.x32+1;c=c.y32+1;return 0===Y[b+c*H]?[b,c,1]:!1};Cc.available=function(b,c){var k=b.x32,d=b.y32;if(!c.death&&c.health<c.maxHealth){var h=Sb(c,b,1,b.radix);if(h[2])return h}b.buildList?(h=
b.buildList,h.quit(c.id)):(b.buildList=Dj(b),h=b.buildList);c=Te(h,k,d);if(!c)return"kill";b.xf=c;c=A[c];return Sb(c,b,1,b.radix)};Id.rev=function(b){return 0===b.distance%3&&(b=Yg(b.id,1))?[Wc.url,b]:!1};Wc.available=function(b,c){if(0===b.distance%3){var k=Yg(b.id);k&&(b.xf=k,c=A[k])}return Sb(c,b,5,b.radix)};Rd.available=function(b,c){if(c.death||c.in)if(c.contain)if(c=Aj(c.x32,c.y32))b.xf=c,c=A[c];else return(c=sh(b.x32,b.y32,!0))?(b.stay(),da(c.id,b,Jb,b.url.move),55):"kill";else return"kill";
b=c.x32;c=c.y32;return 0===Y[b+c*H]?[b,c,1]:!1};Jb.available=function(b,c){if(c.workers.length||10>c.milk||c.death){c=sh(b.x32,b.y32);if(!c)return!1;b.xf=c.id}return c.xf?!1:Sb(c,b,5,b.radix)};oh.available=function(b,c){if(c.death)return"kill";var k=1;c.boat&&(k=2);return(b=Sb(c,b,k,b.radix))?(b[2]=1,b):!1};var sh=function(b,c,e){for(var d=H,k,l=Infinity,n=!1,f=0;441>f;f++){k=f%21-10;var m=~~(f/21)-10,g=k*k+m*m;k+=b;m+=c;g<l&&(k=Y[k+d*m],0<k&&(k=A[k],k.cow&&(!k.workers.length&&k.milk>=50/1.5||e)&&
(l=g,n=k)))}return n},cf=function(b,c,e){for(var d=0,k=b.length;d<k;d++){var l=A[b[d]];da(c,l,e,l.url.move)}},gf=function(b,c){Ta(c,b,ff)};gf.noObj=1;var ff=function(b,c){Td(c,-b,77,ff)},jf=function(b,c){Ta(c,b,hf)};jf.noObj=1;var hf=function(b,c){Td(c,-b,130,hf)},lf=function(b,c){Ta(c,b,kf)};lf.noObj=1;var kf=function(b,c){Td(c,-b,78,kf)},nf=function(b,c){Ta(c,b,mf)};nf.noObj=1;nf.cursor=10;var mf=function(b,c){Td(c,-b,132,mf)},pf=function(b,c){Ta(c,b,of)};pf.cursor=10;pf.noObj=1;var of=function(b,
c){Td(c,-b,131,of)},Td=function(b,c,e,d){var k=H,l=I[b.kingdom],n=B[e],f=B[e].cost,m=b.mana>b.manaMax;if(nb(b)||b.checkMana(f[4],c,d,f)){m||l.paypal(f);d=e;c*=-1;m=c%k;var g=~~(c/k),p=m,v=g,r=n.rbase(),q=~~(b.mana/f[4])+1;1<q&&(l.resources[0]-=f[0]*(q-1),b.mana-=f[4]*(q-1));for(l=0;l<q;l++)0!==r(c)&&(e=Xe(n,m,g),p=e%k,v=~~(e/k)),na("summon"+~~(10*Math.random()+1),p,v),e=new Xc(d,b.kingdom,p,v,0),e.setupChild(kc.spawn);b.setupDir(-b.x32+e.x32,-b.y32+e.y32);b.setupSpellIMG()}else l.paypal(f);W(b.id)},
Kd=function(b,c,e,d,h){return~~Math.sqrt((b-e)*(b-e)+(c-d)*(c-d))<=h},th=function(b,c){Ta(c,b,qf)};th.cursor=0;var qf=function(b,c){b.build||b.terrain||b.nofreeze||!nb(c)&&!c.checkMana(50,b.id,qf)||(b.freezed=1,b.stoned=1,Oa(b,32*b.y32),b.stay(),ba(b,b.img,0),b.setupChild(kc.turnStone),Sd(b.id),c.setupDir(-c.x32+b.x32,-c.y32+b.y32),c.setupSpellIMG(),na("turn%20to%20stone",c.x32,c.y32),Na({func:Mj,data:b.id},24E4,1))},Mj=function(b){b=A[b];b.freezed=0;Kb(b);b.stoned=0},uh=function(b,c){Ta(c,b,Ud)},
Ud=function(b,c){b.health<b.maxHealth&&!b.build?(c.setupDir(b.x32-c.x32,b.y32-c.y32),C("heal",Xa(c.img)),c.setupSpellIMG(!0),c.setupINTV(Nj,b.id,0),b.addWorker(c)):c.stay()},Pj=function(){Ta(list,obj,Oj)},Oj=function(){},Nj=function(b,c){c=A[c];var k=I[b.kingdom].values.healingRange;na("heal",b.x32,b.y32);if(!Kd(c.x32,c.y32,b.x32,b.y32,k))return da(c.id,b,Ud,b.url.move);if(nb(b)||b.checkMana(4,c.id,Ud)){b.setupDir(c.x32-b.x32,c.y32-b.y32);c.health+=6;c.setupChild(kc.heal);if(c.health>=c.maxHealth)return c.health=
c.maxHealth,W(c.id,1),W(b.id,1),b.stay();W(c.id,1);W(b.id,1);sb(b,Xa(b.url.spell))}},sf=function(b,c){Ta(c,b,rf)};sf.cursor=10;var Qj=function(k,c){k=A[k];c=A[c];if(k.inventory.quit(c.id)){c=b[c.spell];k.icons==k.__proto__.icons&&(k.icons=k.icons.slice(0));k.icons.put(c);var e=k.icons;e.olegal||(e.olegal={});e.olegal[c.id]=1;W(k.id)}},tf=function(b,c){var k=c[1];c=A[c[0]];A[b].nopotion||A[b].build||(da(b,c,Rj,c.url.move),c.actionItem=k)};tf.item=1;var Rj=function(b,c){var k=A[c.actionItem];c.actionItem=
void 0;k.attack&&(b.attack+=k.attack);k.defence&&(b.defence+=k.defence);k.mana&&(b.mana||(b.mana=0,b.manaMax=0,b.update?b.update.push("mana","manaSpeed",1E3):b.update=["mana","manaSpeed",1E3],Na({func:$g,data:[b.id,"mana","manaSpeed",1E3]},1E3,1)),b.manaMax+=k.mana,b.mana+=k.mana);k.level&&(b.level||(b.level=0),b.level+=k.level);na("bless",b.x32,b.y32);c.inventory.quit(k.id);c.stay55();W(c.id);W(b.id)};tf.cursor=10;uh.cursor=10;gf.cursor=10;jf.cursor=10;lf.cursor=10;var wh=function(b,c){Ta(c,b,vh)};
wh.cursor=1;var vh=function(b,c){if(b.isSpy&&b==c)c.stay55();else if(nb(c)||c.checkMana(90,b.id,vh))c.setupDir(-c.x32+b.x32,-c.y32+b.y32),ba(c,c.url.attack,1),Na({func:Sj,data:[b,c]},Xa(c.img)-25,1)},Sj=function(k){var c=k[1];k=k[0];k.die(1);var e=k.rbase().write;e(c.x32+c.y32*H,c.radix);c.x32=k.x32;c.y32=k.y32;c.d=k.d;c.name=c.name;c.attack=k.attack;c.defence=k.defence;c.update=c.update;c.mana=0;c.manaMax=c.manaMax;e(c.x32+c.y32*H,c.id);Oa(c,32*c.y32);c.__proto__=k.__proto__;ba(c,c.url.idle);e=k.icons.slice(0);
e.quit(b.menuBuilds);e.quit(b.menuBuilds1);e.quit(b.menuBuilds2);e.put(b.impersonate);e.put(b.revealSelf);c.icons=e;c.spy||(c.spy=c.kingdom);c.kingdom!==k.kingdom&&c.changeKingdom(k.kingdom);c.setupChild(kc.impersonate);W(c.id)},Tj=function(b){b=A[b];if(b.spy){var c=B[2];b.attack=c.attack;b.defence=c.defence;b.__proto__=c;b.icons=c.icons;b.kingdom!==b.spy?b.changeKingdom(b.spy):b.stay();ba(b,b.url.idle);W(b.id);b.spy=void 0}};sf.allowPos=1;var rf=function(b,c){if(b.id){var k=b.id,d=b.x32;b=b.y32}else k=
-b,d=b%H,b=~~(b/H);if(nb(c)||c.checkMana(60,k,rf)){c.setupDir(-c.x32+d,-c.y32+b);c.setupSpellIMG();k=8;d-=.5*k;b-=.5*k;var h=[];k+=1;var l=k*k;na("bless",c.x32,c.y32);for(c=0;c<l;c++)for(var n=1;3>n;n++){var f=A[(0,uf[n])(c%k+d+(~~(c/k)+b)*H)];f.build||f.terrain||(f.setupChild(kc.bless),f.blessed||(f.blessed=1,f.attack+=5,W(f.id,1),h.put(f)))}Na({func:Uj,data:h},3E4,1)}},Ta=function(b,c,e){if(b[1]&&A[b[1]].item){var d=b[1];b.length--;cf(b,c,e);A[b[0]].actionItem=d}else cf(b,c,e)},nb=function(b){var c=
b.actionItem;if(!c)return!1;c=A[c];c.attack&&(c.attack--,0===c.attack&&(b.inventory.quit(c.id),W(b.id)));return!0},Uj=function(b){for(var c=0,k=b.length;c<k;c++){var d=b[c];d.blessed=void 0;d.attack-=5;W(d.id,1)}},xh=function(b,c){Ta(c,b,vf)};xh.cursor=10;var vf=function(b,c){b.freezed||!nb(c)&&!c.checkMana(50,b.id,vf)?c.stay55():(c.setupDir(-c.x32+b.x32,-c.y32+b.y32),b!==c&&c.setupSpellIMG(),na("invisible",b.x32,b.y32),b.invisible||(b.invisible=1,b.stay()),W(b.id),Na({func:Zc,data:b.id},5E4,1))},
Zc=function(b){b=A[b];b.death||(b.invisible=void 0,Kb(b),bj(b))},yh=function(b,c){Ta(c,b,wf)};yh.cursor=0;var wf=function(b,c){if(nb(c)||c.checkMana(50,b.id,wf))c.setupDir(-c.x32+b.x32,-c.y32+b.y32),c.setupSpellIMG(),na("lightning",c.x32,c.y32),b.damage(50,c)},yf=function(b,c){Ta(c,b,xf)};yf.cursor=0;yf.noObj=1;var xf=function(b,c){var k=H;if(b.id){var d=b.id,h=b.x32;b=b.y32}else d=-b,h=b%k,b=~~(b/k);if(nb(c)||c.checkMana(50,d,xf)){c.setupDir(-c.x32+h,-c.y32+b);c.setupSpellIMG();na("flame%20ball",
h,b);var l=h-c.x32,f=b-c.y32,m=Math.sqrt(l*l+f*f);l/=m;f/=m;var g=c.x32+.5,p=c.y32+.5;d=[];h=[];var r=0;for(b=0;b<m;b++){var v=g+l*b;var q=p+f*b;h.put(v);h.put(q);v=~~v;q=~~q;d[r++]=v+q*k;d[r++]=~~(v+f)+~~(q+l)*k;d[r++]=~~(v-f)+~~(q-l)*k}for(b=0;b<0*d.length;b++)l=d[b]%k,f=~~(d[b]/k),m=Object.assign({},Vd.food),m.x32=l,m.y32=f,m.z32=2,Wd.new(m,5E3);Na({func:zh,data:{list:d,anim:h,i:2,a:c}},1E3,1)}},Ah=function(b,c){Ta(c,b,Xd)};Ah.cursor=10;var Xd=function(b,c){c.setupDir(-c.x32+b.x32,-c.y32+b.y32);
c.setupSpellIMG(!0);c.setupINTV(vm,b.id,0);b.addWorker(c)},vm=function(b,c){c=A[c];if(!Kd(c.x32,c.y32,b.x32,b.y32,I[b.kingdom].values.teachDistance))return da(c.id,b,Xd,b.url.move);if(c.level>=b.level)return b.stay();if(nb(b)||b.checkMana(10,c.id,Xd))na("teach",b.x32,b.y32),b.setupDir(c.x32-b.x32,c.y32-b.y32),c.setupChild(kc.curse,!1,km),qh(c,!1),W(c.id,1),W(b.id,1),sb(b,Xa(b.url.spell))},Af=function(b,c){Ta(c,b,zf)};Af.cursor=0;Af.noObj=1;var zf=function(b,c){var k=H;if(b.id){var d=b.id,h=b.x32;
b=b.y32}else d=-b,h=b%k,b=~~(b/k);if(nb(c)||c.checkMana(70,d,zf)){c.setupDir(-c.x32+h,-c.y32+b);c.setupSpellIMG();d=h;var l=b;h-=8;b-=8;for(var f=0;256>f;f++){var m=h+f%16,g=~~(f/16)+b,p=m+g*k;fa(m,g)&&64>=Math.pow(m-d,2)+Math.pow(g-l,2)&&Bh[p]&&0===Y[xy]&&(C(m,g),new Xc(60,c.kingdom,m,g,0))}}},zh=function(b){var c=b.list,k=b.anim,d=b.i,h=b.a,l={x32:k[2*d],y32:k[2*d+1],d:0,img:m.flame_trail,mv:1,z32:2,alpha:!0};Wd.new(l,Xa(l.img));for(l=0;3>l;l++){var f=A[Y[c[l+3*d]]];f.health&&f.damage(96,h)}b.i++;
b.i<.5*k.length&&Na({func:zh,data:b},50,1)},Cf=function(b,c){Ta(c,b,Bf)};Cf.cursor=0;Cf.noObj=1;var Bf=function(b,c){if(b.id){var k=b.id,d=b.x32;b=b.y32}else k=-b,d=b%H,b=~~(b/H);if(nb(c)||c.checkMana(60,k,Bf))c.setupDir(-c.x32+d,-c.y32+b),c.setupSpellIMG(),na("freeze",d,b),Na({func:Vj,data:[d,b]},1E3,1)},Ef=function(b,c){Ta(c,b,Df)};Ef.cursor=0;Ef.noObj=1;var Df=function(b,c){if(b.id){var k=b.id,d=b.x32;b=b.y32}else k=-b,d=b%H,b=~~(b/H);if(nb(c)||c.checkMana(70,k,Df)){c.setupDir(-c.x32+d,-c.y32+
b);c.setupSpellIMG();na("confusion",d,b);c=4;d-=.5*c;b-=.5*c;k=H;var h=[];c+=1;for(var l=c*c,f=0;f<l;f++)for(var m=1;3>m;m++){var g=A[(0,uf[m])(f%c+d+(~~(f/c)+b)*k)];g.build||g.terrain||g.stoned||(g.confused=1,g.invisible&&Zc(g),g.stay(),h.put(g),Sd(g.id))}l&&1===Q.length&&W(Q[0]);h.length&&Na({func:Wj,data:h},2E4,1)}},Wj=function(b){for(var c=0,k=b.length;c<k;c++){var d=b[c];d.confused=void 0;d.death||(ba(d,d.img,1),Kb(d),d.stay(),eb==d&&(eb=void 0,Q[0]=d.id,W(d.id)))}},Vj=function(b){var c=6,k=
b[0]-.5*c,d=b[1]-.5*c,h=H,l=[];c+=1;var f=c*c;b={img:m.freeze_expl,d:0,mv:1,x32:b[0],y32:b[1]};Wd.new(b,Xa(b.img));for(var g=0;g<f;g++)for(var p=1;3>p;p++)b=A[(0,uf[p])(g%c+k+(~~(g/c)+d)*h)],b.build||b.terrain||b.nofreeze||b.stoned||(b.freezed=1,Oa(b,32*b.y32),b.stay(),ba(b,b.img,0),b.invisible&&Zc(b),b.health-=40,1>b.health&&(b.health=1),l.put(b),Sd(b.id));f&&1===Q.length&&W(Q[0]);Na({func:Xj,data:l},2E4,1)},Xj=function(b){for(var c=0,k=b.length;c<k;c++){var d=b[c];d.freezed=void 0;d.death||(ba(d,
d.img,1),Kb(d),eb==d&&(eb=void 0,Q[0]=d.id,W(d.id)))}},Gf=function(b,c){Ta(c,b,Ff)};Gf.cursor=0;Gf.noObj=1;var Ff=function(b,c){if(b.id){var k=b.id,d=b.x32;b=b.y32}else k=-b,d=b%H,b=~~(b/H);if(nb(c)||c.checkMana(100,k,Ff))c.setupDir(-c.x32+d,-c.y32+b),c.setupSpellIMG(),Ch(d,b,3,20,4500,c.id)},Ch=function(b,c,e,d,h,l){for(var k=m.fire_rain,f=t.gravity,g=Date.now(),p=Ch.rnd,r=Math.PI,v=performance.now(),q=0;q<d;q++){var x=2*p()*r,w=e*p(),z=b+w*Math.cos(x);x=c+w*Math.sin(x);w=~~(q/d*h);fa(z,x)&&Na({func:Yj,
data:{x32:z,y32:x-6,dix:0,diy:140,img:k,mv:1,d:0,timestamp:g,finnish:Infinity,aceleration:f,attack:40,xf:z,yf:x,range:2,kingdom:0,obj:l,crashTime:(Math.sqrt(19600+384*f)-140)/f*1E3}},w,1)}C(performance.now()-v)},Yj=function(b){Na({func:bf,data:b},b.crashTime,1)};Ch.rnd=function(){var b=4096,c=2048;return function(){c=36969*(c&65535)+(c>>16)&4294967295;b=18E3*(b&65535)+(b>>16)&4294967295;return((c<<16)+b&4294967295)/4294967296+.5}}();var Ma=function(b){Yd(-1E4,0,0,b);wm.put(b)},lh=function(b){if(b=
b.childLoc)for(var c=0,k=b.length;c<k;c++)Ma(b[c])},Ij=function(b){A[b.obj].damage(b.attack,A[b.obj]);Ma(b.bufferID)},Zj=function(b){b=A[b];void 0!=b.bufferID&&Ma(b.bufferID);Bh[b.x32+b.y32*H]=void 0},bf=function(b){var c=H,k=b.xf,d=b.yf,h=b.attack;b.mv=1;b.func=void 0;b.x32=k;b.y32=d;ac(b,0,0,0);Oa(b,2);k=~~k;d=~~d;var l=k+d*c,f=Y[l];lc[l]?(b.img=m.expl_small_water,na("water%blop",b.x32,b.y32)):(b.img=m.expl_small_hole,na("small%20explosion",b.x32,b.y32));ba(b,b.img,1);Wd.new(b,ak(lb[b.img]));if(lc[l]){if(f=
kb[l],2<f){var g=A[f];g.damage(h,A[b.obj])}}else{2<f&&(g=A[f],g.damage(h,A[b.obj]));l=b.range;f=2*l+1;for(var p=0,r=f*f;p<r;p++){g=p%f-l;var q=~~(p/f)-l,v=~~Math.sqrt(g*g+q*q);v<l&&(g+=k,q+=d,g=Y[g+q*c],2<g&&(g=A[g],g.damage(h*(1-v/l),A[b.obj])))}}},xm=function(b){if(0<Q.length){var c=A[Q[0]],k=0,d=0,h=0,l=0;void 0!==c.dix&&(b=.001*(b-c.timestamp),l=c.dix,h=c.diy,k=l*b,d=h*b);if(c.space){var f=c.space;b=f[f.length-1];f=(f.length-1)/b}else f=b=1;k+=32*(c.x32+.5*b-Math.sign(l))+.5*-tzar.width+.5;d+=
32*(c.y32+.5*f-Math.sign(h))+.5*-tzar.height+.5;oa=~~-k;ha=~~-d;ad(-oa,-ha)}},bk=function(){};Ud.distance="healingRange";ff.distance="createGolemRange";rf.distance="blessDistance";Bf.distance="freezeDistance";Df.distance="confusionDistance";vf.distance="invisibilityDistance";wf.distance="lightningDistance";kf.distance="createBatDistance";hf.distance="createDragonDistance";of.distance="createCarpetDistance";mf.distance="createJinnDistance";qf.distance="turnToStoneDistance";xf.distance="flameBoltDistance";
Ff.distance="fireRainDistance";zf.distance="freezeDistance";Xd.distance="teachDistance";var I=[];var Ec=function(b,c,e,d,h,l,f){this.name=b;this.k=I.length;l||(l=[0,0,0,0]);this.color=c;this.status="";this.stats={dmgInflicted:0,dmgTaken:0,resources:[0,0,0,0],score:0,unitsKilled:0,unitsLosed:0,buildsLosed:0,buildsDestroyed:0,unitCount:new Uint32Array(B.length),unitCountMax:new Uint32Array(B.length),unitCountDeath:new Uint32Array(B.length),goldTraded:0,goldConverted:0,stoneTraded:0};this.team=f;this.resources=
l||[5E4,5E4,5E4,5E4];this.values={gold:10,wood:10,food:10,stone:10,buildSpeed:1,experience:0,healthJump:0,maxLevel:4,pop:0,popMax:t.freePop||1,popLimit:200,healingRange:1,blessDistance:9,createGolemRange:5,freezeDistance:13,invisibilityDistance:9,createBatDistance:16,lightningDistance:12,createDragonDistance:4,turnToStoneDistance:21,flameBoltDistance:19,fameTech:0,confusionDistance:13,manaSpeed:2,milkSpeed:2,cowSpeed:2,stealCow:0,miningPerf:1,fireRainDistance:15,createCarpetDistance:3,createJinnDistance:3,
teachDistance:2};this.race=d;this.racestr=ym[d];this.IA=h||0;this.building=[];this.diplomacy=e;this.control={};this.control[this.k]=1;this.onFreePop=[];b=[];b.length0function=zm;this.unitLoading=0;this.target=[0,0,0,0];this.crusade={number:0,list:b};this.technology={hidden:{},disabled:{},actived:{},investigated:{}};this.mod=b=[];Am[this.racestr]++;c=0;for(e=B.length;c<e;b[c++]={});I[I.length]=this;c=this.k;b=[];db[c]={};ta[c]=b;for(c=0;c<B.length;c++)b[c]=[]};Ec.prototype.setupResources=function(b,
c){var k=this.resources;c||(c=1);k[0]-=b[0]*c;k[1]-=b[1]*c;k[2]-=b[2]*c;k[3]-=b[3]*c;z.setupResources(-b[0]*c,-b[1]*c,-b[2]*c,-b[3]*c,k.k);ef(this.k)};var ta=[];var db=[];Ec.prototype.check=function(){if(this.values.pop)return!0;for(var b=Bm,c=ta[this.k],e=0,d=B.length;e<d;e++)if(!b[e]&&0<c[e].length)return!0;this.die()};Ec.prototype.checkPopArray=function(){if(this.onFreePop.length)for(;!Ld(this.onFreePop.shift())&&this.onFreePop.length;);};Ec.prototype.die=function(){this.death||(this.death=1,this.status=
"defeated",Dh(),Ub(Eh(r.VIEWMSG_PLAYER_DEFEATED,this.name),0,5))};Ec.prototype.paypal=function(b){var c=this.resources,k=!1,d=this.k;c[0]<b[0]&&(Hf(d,r.VIEWMSG_GOLD),k=!0);c[1]<b[1]&&(Hf(d,r.VIEWMSG_WOOD),k=!0);c[2]<b[2]&&(Hf(d,r.VIEWMSG_FOOD),k=!0);c[3]<b[3]&&(Hf(d,r.VIEWMSG_STONE),k=!0);if(k)return k;c[0]-=b[0];c[1]-=b[1];c[2]-=b[2];c[3]-=b[3];z.setupResources(b[0],b[1],b[2],b[3],d.k);ef(this.k)};Ec.prototype.paypalTest=function(b){var c=this.resources;return b[0]>c[0]||b[1]>c[1]||b[2]>c[2]||b[3]>
c[3]?!1:!0};var Hf=function(b,c){b==w.kingdom&&Ub(Eh(r.VIEWMSG_NOTRES,c),0,5)},ef=function(b,c,e,d){b==Math.pow(2,31)-1&&(b="***");c==Math.pow(2,31)-1&&(c="***");e==Math.pow(2,31)-1&&(e="***");d==Math.pow(2,31)-1&&(d="***");ck.innerHTML=b;dk.innerHTML=c;ek.innerHTML=e;fk.innerHTML=d},Bm={13:1,20:1,21:1,22:1,27:1,32:1,35:1,36:1,43:1,44:1,55:1,56:1,57:1},rj,mc,nc,bd,oc,Fc,la,Zd,tb,Aa,Fh,gk,hk,qa,$d,ck,dk,ek,fk,ik,pc,cd=function(){p("mgitem").style.backgroundPositionY=-48*z.mwicon()+"px";p("mgamount").innerHTML=
z.amount()},If=function(){if(!If.setup){If.setup=!0;p("content").innerHTML='\n<ul id="msgs1"></ul>\n<div id="clicks" style="display:none;margin-top:0;margin-left:151px"></div>\n\n<div id="playersinfo"></div>\n<div id="resources" style="display:block">\n<div id="gold"></div>\n<div id="wood"></div>\n<div id="food"></div>\n<div id="stone"></div>\n<div id="pop"></div>\n<div id="temperature"></div>\n</div>\n<div id="enterwindow" class="displaynone">\n<h2 id="sendMessageH2">'+r.CHAT_T_CHAT+'</h2>\n<input id="msginputGame" />\n</div>\n\n<div id="statButton"></div>\n<div id="topinfo"></div>\n<div id="bottominfo"></div>\n<div id="mapeditorinfo">\n<div id="sButtons"><button id="selectUnits">'+
r.SELVIEW_UNITS+'</button><button id="selectBuilds">'+r.builds+'</button><button id="selectItems">'+r.items+'</button><button id="selectNature">'+r.nature+'</button></div>\n<div id="mapeditorinfoUnits"></div>\n<div id="mapeditorinfoBuilds" style="display:none"></div>\n<div id="mapeditorinfoItems" style="display:none"></div>\n<div id="mapeditorinfoNature" style="display:none"></div>\n</div>\n<div id="mapeditorinfotop">\n<button id="menueditor">'+r.GAME_SCR_MENU+'</button>\n<button id="deleteUnit" style="color:#f00;font-weight:bold;font-size:19px">x</button>\n<button id="rotatebutton"></button>\n<button id="mapProps">'+
r.MENU_OPTI+'</button>\n<button id="mapRules">'+r.rules+'</button>\n<span>Brush size: </span><input type="number" min="1" max="256" value="6" id="brushSize"/>\n<span>Active kingdom</span>\n<select id="selectKingdom">\n</select>\n</div>\n<div id="minimap" style="position:absolute;top:31px;left:4px;z-index:99"></div>\n<div id="menu" style="display:block">\n<button id="gameMenu">'+r.GAME_SCR_MENU+'</button>\n<div style="width:151px;height:calc(100% - 741px);top:645px;background:url(/nehhon/menurepeat.gif) repeat" id="kingdomcolor"></div>\n<div id="daynighticon"></div>\n<div id="icons20">\n<div id="attackmenu" style="display:none"></div>\n<div id="defencemenu" style="display:none"></div>\n<div id="levelmenu" style="display:none"></div>\n<div id="manamenu" style="display:none"></div>\n<div id="manamenu1" style="display:none"></div>\n</div>\n<div id="progressvalue"></div>\n<div id="kingdom"></div>\n<div id="unitname" contenteditable="true"></div>\n<progress id="progressone" style="display:none"></progress>\n<progress id="progressmana" style="display:none" max="100"></progress>\n<input id="unitSpeed" min="1" max="100" type="range"/>\n<canvas width="48" height="48" id="selectedobject"></canvas>\n<div id="navigation">\n<button id="aleft"></button>\n<button id="stock"></button>\n<button id="aright"></button>\n</div>\n<div id="orders">\n<button id="order1"><progress class="loadingunit" style="display:none"></progress></button>\n<button id="order2"></button>\n<button id="order3"></button>\n<button id="order4"></button>\n<button id="order5"></button>\n<button id="order6"></button>\n<button id="order7"></button>\n<button id="order8"></button>\n</div>\n<div id="magicworkshopmenu" style="display:none">\n<button id="mgbook"></button>\n<button id="mgpotion"></button>\n<button id="mgsword"></button>\n<button id="mgamount"></button>\n<button id="mgitem"></button>\n<button id="mgdecline"></button>\n<button id="mgaccept"></button>\n<div id="mgbak"></div>\n</div>\n</div>\n\n\n        ';
pc=p("msgs1");qa={page:0,length:8,leftButton:p("aleft"),rightButton:p("aright"),stock:p("stock")};qa.leftButton.onclick=function(){z.changePage(-1)};mc=p("minimap");$d=p("unitSpeed");ck=p("gold");dk=p("wood");ek=p("food");fk=p("stone");ik=p("daynighticon");qa.rightButton.onclick=function(){z.changePage(1)};qa.displayed=[];nc=p("attackmenu");bd=p("defencemenu");oc=p("levelmenu");Fc=p("kingdom");la=p("progressone");Zd=p("unitname");tb=p("progressvalue");p("selectedobject");p("mgbook").onclick=function(){z.mwSelect(0);
cd()};p("mgpotion").onclick=function(){z.mwSelect(1);cd()};p("mgsword").onclick=function(){z.mwSelect(2);cd()};p("mgdecline").onclick=function(){p("magicworkshopmenu").style.display="none"};p("mgitem").onmousedown=function(c){var b=1;c.button&&(b*=-1);z.mwMore(b);cd()};p("mgaccept").onclick=function(){p("magicworkshopmenu").style.display="none";z.createItems()};p("mgamount").onmousedown=function(c){var b=1;c.button&&(b=-1);Ac.shift&&(b*=5);z.mwamount(b);cd()};Aa=[p("order1"),p("order2"),p("order3"),
p("order4"),p("order5"),p("order6"),p("order7"),p("order8")];Fh=p("bottominfo");for(var b=0,c=Aa.length;b<c;b++)Aa[b].addEventListener("mousedown",Cm),Aa[b].addEventListener("mouseup",Dm),Aa[b].ordid=b,Aa[b].addEventListener("mouseenter",Em),Aa[b].addEventListener("mouseout",Fm);p("stock").addEventListener("click",function(c){z.checkStock()});mc.addEventListener("mousedown",function(c){0==c.button?(document.addEventListener("mouseup",function l(c){document.removeEventListener("mouseup",l);document.removeEventListener("mousemove",
Jf)}),ae=!0,Jf(c),document.addEventListener("mousemove",Jf)):2==c.button&&C(999999999,44444)});gk=[manamenu,manamenu1];hk={mana:{background:"0px -120px",progress:progressmana},food:{background:"0px -240px"},milk:{background:"0px -280px"},gold:{background:"0px -260px"},stone:{background:"0px -320px"},wood:{background:"0px -340px"}};p("selectUnits").onclick=function(){p("mapeditorinfoUnits").style.display="block";p("mapeditorinfoBuilds").style.display="none";p("mapeditorinfoItems").style.display="none";
p("mapeditorinfoNature").style.display="none"};p("selectBuilds").onclick=function(){p("mapeditorinfoUnits").style.display="none";p("mapeditorinfoBuilds").style.display="block";p("mapeditorinfoItems").style.display="none";p("mapeditorinfoNature").style.display="none"};p("selectItems").onclick=function(){p("mapeditorinfoUnits").style.display="none";p("mapeditorinfoBuilds").style.display="none";p("mapeditorinfoItems").style.display="block";p("mapeditorinfoNature").style.display="none"};p("selectNature").onclick=
function(){p("mapeditorinfoUnits").style.display="none";p("mapeditorinfoBuilds").style.display="none";p("mapeditorinfoItems").style.display="none";p("mapeditorinfoNature").style.display="block"};p("selectKingdom").onchange=function(){w.kingdom=parseInt(this.value);var c=I[w.kingdom].color;this.style.background="rgba("+c[0]+","+c[1]+","+c[2]+",.8)"};p("mapProps").onclick=function(){p("mapPropsWindow").style.display="block";vc();if(""==p("mapPropsWindow").innerHTML){var c=document.createElement("div");
p("mapPropsWindow").appendChild(c);var b=document.createElement("table");c.appendChild(b);b=document.createElement("div");b.innerHTML=r.mapName;var k=document.createElement("input");k.value=t.name||r.strcusMap;k.id="mapName";k.type="text";c.appendChild(b);c.appendChild(k);b=document.createElement("div");b.innerHTML=r.description;k=document.createElement("textarea");k.type="text";k.value=t.description||"";k.id="mapDescription";c.appendChild(b);c.appendChild(k);b=document.createElement("div");b.innerHTML=
r.author;k=document.createElement("input");k.id="mapAuthor";k.value=t.author||"";k.type="text";c.appendChild(b);c.appendChild(k);c.appendChild(document.createElement("p"));b=document.createElement("button");b.onclick=jk;b.innerHTML=r.GENERAL_CLOSE;c.appendChild(b)}Gh()};p("mapRules").onclick=function(){p("mapRulesWindow").style.display="block";vc();if(""==p("mapRulesWindow").innerHTML){var c=document.createElement("div");c.innerHTML='\n<div id="mapEvent">\n<h4>'+r.events+'</h4>\n<select id="eventOptions" style="display:none">\n<option value="objAction">'+
r.objAction+'</option>\n<option value="objZone">'+r.objZone+'</option>\n</select>\n<div id="eventScreen">\n</div>\n<div id="eventLayout">\n</div>\n<button id="addEvent">+</button>\n</div>\n<div id="mapActions">\n<h4>'+r.actions+'</h4>\n<select id="actionOptions" style="display:none">\n<option value="objOrder">'+r.objOrder+'</option>\n</select>\n<div id="actionScreen">\n</div>\n<div id="actionLayout">\n</div>\n<button id="addAction">+</button>\n</div>\n<h4>'+r.rules+"</h4>\n";var b=document.createElement("div");
b.id="rulist";c.appendChild(b);b=document.createElement("button");b.onclick=Gm;b.innerHTML="+";c.appendChild(b);b.id="addRule";c.appendChild(document.createElement("p"));b=document.createElement("button");b.onclick=jk;b.innerHTML=r.GENERAL_CLOSE;c.appendChild(b);p("mapRulesWindow").appendChild(c);p("addEvent").onclick=Hm;p("addAction").onclick=Im;p("eventOptions").onchange=function(){var c=kk[this.value];ra.div=c.id;ka(ra.div);ra.active.name=this.value;c.func&&c.func();c=p("eventScreen").getElementsByTagName("button");
for(var b=!1,d=0,k=c.length;d<k;d++){var e=c[d];if(e.sdiv)if("none"==e.style.display)e.sdiv.style.display="none";else{if(!b)e.onclick();b=!0}}Kf(ub.active,"eventLayout")};p("actionOptions").onchange=function(){ob.active.name=this.value;Kf(ub.active,"actionLayout")};c=document.createElement("div");c.id="edobjAction";var k=document.createElement("select");k.innerHTML='\n<option value="attack">'+r.MISC_ATTACK3+'</option>\n<option value="destroy">'+r.destroy+'</option>\n<option value="moving">'+r.moving+
'</option>\n<option value="capture">'+r.capture+"</option>\n";k.value="attack";k.id="selectionEvents";k.onchange=Jm;var l=document.createElement("section"),f=document.createElement("section"),m=document.createElement("section"),g=document.createElement("section"),q=document.createElement("section");b=document.createElement("button");b.innerHTML=r.ADD;b.onclick=dd;var t=document.createElement("div");t.className="unitList";t.id="zoneList";m.appendChild(b);m.appendChild(t);t=document.createElement("div");
t.className="unitList";t.id="unitListDiv";t.spType=ra;b=document.createElement("button");b.innerHTML=r.ADD;b.onclick=function(){vb(this)};b.button=t;b.style.margin="10px";l.appendChild(b);b=document.createElement("button");b.innerHTML=r.defined;b.onclick=pb;b.sdiv=l;c.appendChild(b);b.onclick();b=document.createElement("button");b.innerHTML=r.undefined;b.onclick=pb;b.sdiv=f;c.appendChild(b);l.appendChild(t);c.appendChild(l);c.appendChild(f);c.appendChild(document.createElement("p"));c.appendChild(k);
c.appendChild(document.createElement("p"));t=document.createElement("div");t.className="unitList";t.id="unitListDiv2";t.spType=ra;b=document.createElement("button");b.innerHTML=r.ADD;b.onclick=function(){vb(this)};b.button=t;b.style.margin="10px";g.appendChild(b);b=document.createElement("button");b.innerHTML=r.defined;b.onclick=pb;b.sdiv=g;b.id="byButton1";c.appendChild(b);b=document.createElement("button");b.innerHTML=r.undefined;b.onclick=pb;b.id="byButton2";b.sdiv=q;c.appendChild(b);g.appendChild(t);
b=document.createElement("button");b.innerHTML=r.zone;b.onclick=pb;b.sdiv=m;b.id="eventZone";b.style.display="none";c.appendChild(b);c.appendChild(m);c.appendChild(g);c.appendChild(q);p("eventScreen").appendChild(c);M("mapEvent");M("mapActions");c=document.createElement("div");c.id="edobjOrder";k=document.createElement("select");k.innerHTML='\n<option value="move">'+r.move+'</option>\n<option value="attack">'+r.MISC_ATTACK3+"</option>\n";k.value="move";k.id="selectionActions";k.onchange=Km;l=document.createElement("section");
f=document.createElement("section");g=document.createElement("section");q=document.createElement("section");t=document.createElement("div");t.className="unitList";t.id="unitListDivAction";t.spType=ob;b=document.createElement("button");b.innerHTML=r.ADD;b.onclick=function(){vb(this)};b.button=t;b.style.margin="10px";l.appendChild(b);b=document.createElement("button");b.innerHTML=r.defined;b.onclick=pb;b.sdiv=l;c.appendChild(b);b=document.createElement("button");b.innerHTML=r.undefined;b.onclick=pb;
b.sdiv=f;c.appendChild(b);l.appendChild(t);c.appendChild(l);c.appendChild(f);b.onclick();c.appendChild(document.createElement("p"));c.appendChild(k);c.appendChild(document.createElement("p"));t=document.createElement("div");t.className="unitList";t.id="unitListDivAction2";t.spType=ob;b=document.createElement("button");b.innerHTML=r.ADD;b.onclick=function(){vb(this)};b.button=t;b.style.margin="10px";g.appendChild(b);b=document.createElement("button");b.innerHTML=r.defined;b.onclick=pb;b.sdiv=g;b.id=
"toButton1";c.appendChild(b);b=document.createElement("button");b.innerHTML=r.undefined;b.onclick=pb;b.id="toButton2";b.sdiv=q;c.appendChild(b);g.appendChild(t);c.appendChild(g);c.appendChild(q);b.onclick();p("actionScreen").appendChild(c);M("mapEvent");M("mapActions")}};$d.onchange=function(c){parseInt($d.value);C(999999999,44444)};p("deleteUnit").onclick=function(){Q.slice(0);C(999999999,44444)};p("rotatebutton").onclick=Ul;p("gameMenu").onclick=za;p("menueditor").onclick=za;p("statButton").onclick=
function(){}}};If.setup=!1;var Em=function(){z.mouseEnter(this.ordid)},Fm=function(){qa.stockActive&&be(Q[0],1,1);Fh.innerHTML=""},Dm=function(b){Me=b.button;z.executeOrder(this.ordid,b.button);this.style.transform="translate(0px,0px)"},Cm=function(){this.style.transform="translate(2px,2px)"},Hh=function(b,c){p(b).style.display="block";Hh.actived=b;c.actual="potion";c.id=0;c.amount=100;c.func()};Hh.actived="";var lk={potion:{bak:1,max:4,ord:["level","mana","attack","defence"]},sword:{bak:5,max:3,
ord:["attack","attackBow","defence"]},book:{bak:8,max:18,ord:"fireRain lightning healing createCarpet createBat bless freeze confusion invisibility createGolem magicVision raiseDead turnToStone whirlpool createDragon flameBolt teach createJinn".split(" ")}},nk=function(b,c){c=A[c];var k=b[2],d=[k,0,0,0];rj.paypal(d)||(k=~~(250*k),"book"==b[0]&&(k*=2),c.setupINTV(mk,b,k),c.lcost=d,c.techStart=c.c-t.cycle,W(c.id)&&(p("magicworkshopmenu").style.display="none"))},Lm={defence:6,mana:0,level:2,health:1,
attack:5},Mm={attack:"sword",attackBow:"bow",defence:"shield"},Nm={attack:.5,mana:1,defence:.5,level:.2},mk=function(k,c){k=A[inf[1]];var e=c[0],d=lk[e].ord[c[1]];c=c[2];k.lcost=void 0;"sword"==e&&(e=Mm[d]);"attackBow"==d&&(d="attack");e=Object.assign({},Vd[e]);if(e.potion)e.d=Lm[d],e[d]=~~(c*Nm[d]);else if(e.book){var h=b[d],l=h.obj;e.spell=d;e.attack=~~(c/l.spcost[0]);e.name=l.name;e.iconID=h.iconIDbook}else e[d]=~~(.25*c),250<e[d]&&(e[d]=250);C(e);Ne(52,k,!0,e);k.techStart=void 0;W(k.id)},Me,ae,
ok=function(){history.pushState("",document.title,window.location.pathname)},ec=function(){t.online=0;location.hash="";p("index").style.display="block";p("returnmenu").style.display="none";setTimeout(ok,200)},Fb=[.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.27,.3,1,.5,.5,.5,1,.62,.62,.62,1,.74,.74,.74,1,.88,.88,.88,1,.94,.94,.94,1,1,1,1,1,1.06,1.06,1.06,1,1.12,1.12,1.12,1,1.08,1.08,1.08,1,1.04,1.04,1.04,1,1,1,1,1,.95,.95,.95,1,.88,.8,.7,1,.84,.72,.6,1,.7,.62,.5,1,.6,.55,.45,1,.5,
.44,.42,1,.4,.37,.35,1],jj=function(){var b=(.025*t.cycle/t.daylength*24+t.initialhour)%24,c=~~b;b-=c;ik.style.backgroundPosition="0 -"+36*c+"px";var e=new Float32Array([Fb[4*c],Fb[4*c+1],Fb[4*c+2],Fb[4*c+3]]);c=(c+1)%24;e[0]+=(-e[0]+Fb[4*c])*b;e[1]+=(-e[1]+Fb[4*c+1])*b;e[2]+=(-e[2]+Fb[4*c+2])*b;e[3]+=(-e[3]+Fb[4*c+3])*b;f.useProgram(aa);f.uniform4fv(pk,e);f.useProgram(ea);f.uniform4fv(qk,e)},oa=0,ha=0,Gc=0,Hc=0,ad=function(b,c){var k=tzar.width,d=tzar.height,h=w.mx/32;b/=32;c/=32;var l=S*k*.03125,
f=S*d*.03125,m=.03125*k,g=.03125*d,p=b+.5*(m-l),r=c+.5*(g-f);0>p?b=.5*-(m-l):p+l-h*S>H&&(b=H-l-.5*(m-l)+h*S);0>r?c=.5*-(g-f):r+f>Da&&(c=Da-f-.5*(g-f));l-w.mx>H&&(S=H/(.03125*k),C(S));f>Da&&(S=Da/(.03125*d),C(S));oa=32*-b;ha=32*-c},Jf=function(b){var c=b.pageX-parseInt(mc.style.left);b=b.pageY-parseInt(mc.style.top);var k=tzar.height*Ya/(32*Da);c=~~(.5+(c-tzar.width*qc/(32*H)*.5)*H/qc);b=~~(.5+(b-.5*k)*Da/Ya);ad(32*c,32*b);0==ae&&document.removeEventListener("mousemove",Jf)},Ac={control:0,shift:0,
esc:0},ed={37:function(b){Gc=b},40:function(b){Hc=-b},39:function(b){Gc=-b},38:function(b){Hc=b},32:function(b){bk=b?xm:function(){}},16:function(b){Ac.shift=b;z.shiftONOFF(b)},17:function(b){Ac.control=b},27:function(b){Ac.esc=b},13:function(b){b&&!t.editor&&("displaynone"==p("enterwindow").className?(p("enterwindow").className="displayblock",p("msginputGame").focus(),ed.blocked=13):(Ih(),p("enterwindow").className="displaynone",ed.blocked=null))},19:function(b){b||t.online||$b(1)},48:function(b){b&&
Ac.control&&(S=1,rk({deltaY:0}))},219:function(b){b&&sk(-1)},221:function(b){b&&sk(1)},blocked:null};document.oncontextmenu=function(){return!1};var tk=function(b,c){if(c.length){b=b||t.editor?c.length:1;for(var k=0;k<b;k++)A[c[k]].die()}},Ga=function(b,c){b.sound&&!c&&(c=b.sound,na(c[~~(c.length*Math.random())]));oc.style.display="none";$d.style.display="none";Fc.style.display="block";la.style.display="block";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display=
"none";bd.style.display="none";Zd.innerHTML=b.name;ce(b);Fc.innerHTML=I[b.kingdom].name;b.attack?(nc.style.display="block",nc.innerHTML=b.attack):nc.style.display="none";c=b.health;var k=b.maxHealth;Infinity==c?(la.value=100,la.max=100,tb.innerHTML=c):la.value=c;Infinity==k&&Infinity!=c?(la.max=100,la.value=1):Infinity!==k&&(la.max=k);b.inventory&&b.inventory.length&&(manamenu1.style.display="block",manamenu1.style.backgroundPosition="0px -80px",manamenu1.innerHTML=b.inventory.length);tb.innerHTML=
~~c+"/"+k;if(gh(b,w))if(b.point&&(c=b.point,wb.x32=c[0],wb.y32=c[1],Oa(wb,96*(Da-1)),wb.show=1),!1===b.built)ce(b);else if(b.techStart)ce(b),manamenu.style.display="block",manamenu.style.backgroundPosition="0px -200px",manamenu.innerHTML=100-~~(100*(b.c-t.cycle)/b.techStart)+"%",Ga.intv&&clearInterval(Ga.intv),Ga.intv=setInterval(function(){Q[0]==b.id?manamenu.innerHTML=100-~~(100*(b.c-t.cycle)/b.techStart)+"%":clearInterval(Ga.intv)},400);else if(R(),b.working){k=b.work;var d=qa.page*qa.length;c=
0;for(var h=qa.length;c<h;c++){var l=k[c+d];Aa[c].innerHTML=l?l:""}manamenu.style.display="block";manamenu.style.backgroundPosition="0px -200px";var f=1E3*B[b.waitlist[0]].time;c=~~(100*(t.now()-b.timestamp)/f);100<c&&(c=100);manamenu.innerHTML=c+"%";Ga.intv&&clearInterval(Ga.intv);Ga.intv=setInterval(function(){if(Q[0]==b.id&&b.working){var c=~~(100*(t.now()-b.timestamp)/f);100<c&&(c=100);manamenu.innerHTML=c+"%"}else clearInterval(Ga.intv)},400)}else for(c=0,k=qa.length;c<k;Aa[c++].innerHTML="");
};Ga.intv=!1;var fd=function(){M("magicworkshopmenu");nc.style.display="none";bd.style.display="none";oc.style.display="none";la.style.display="none";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";Zd.innerHTML="";nc.innerHTML="";bd.innerHTML="";manamenu.innerHTML="";oc.innerHTML="";Fc.innerHTML="";tb.innerHTML="";la.value="";tb.maxLength="";$d.style.display="none";for(var b=0;b<Aa.length;Aa[b++].innerHTML="");Jh();uk()},eb,Md,Lf={},Q=[];Q.change=1;var Kh;
var jh=!1;var fc=function(b,c){var k=S,d=tzar.width,h=tzar.height;b=b*k-oa+.5*(d-k*d);c=c*k-ha+.5*(h-k*h);return[b,c]},rc=function(b){if(b){var c=b.pageX;b=b.pageY;rc.lastX=c;rc.lastY=b}else c=rc.lastX,b=rc.lastY;c=fc(c-w.mx,b);b=c[1];c=c[0];0==jh?(window.removeEventListener("mousemove",rc),Kh=!1):Kh=!0;Lh=c;Mh=b},vk=function(b,c){for(var k=c.length,d=0;d<k;d++){var h=A[c[d]];h.build&&(Y[b[0]+b[1]*H]==h.id?(h.point=void 0,Q[0]==h.id&&(wb.x32=2*H,Oa(wb,128*H),wb.show=0)):(h.point=b,wb.x32=b[0],wb.y32=
b[1],Q[0]==h.id&&(Oa(wb,96*(Da-1)),wb.show=1)))}};document.onkeydown=function(b){return b.ctrlKey&&b.shiftKey?!1:{116:1,115:1,123:1}[b.keyCode]?!1:!0};var Om=function(b){if(ed[b.keyCode])ed[b.keyCode](1);b.target!=p("msginputGame")&&z.runKey(b.keyCode,!0)},Pm=function(b){if(ed[b.keyCode])ed[b.keyCode](0);b.target!=p("msginputGame")&&z.runKey(b.keyCode,!1)},Mf,Nf,Of,Pf,de=!1,Qm=function(b){var c=b.changedTouches[0].screenX;b=b.changedTouches[0].screenY;Of=oa;Pf=ha;Mf=c;Nf=b},Rm=function(b){var c=b.changedTouches[0].screenY;
oa=Of-(Mf-b.changedTouches[0].screenX);ha=Pf-(Nf-c);Qf()},Sm=function(b){},Nh=function(b){return!(b.target==p("tzar")||b.target==p("resources")||b.target==p("playersinfo")||b.target==p("msgs1"))},Tm=function(b){if(!Nh(b)){var c=window.innerWidth,k=window.innerHeight,d=b.pageX,h=b.pageY;if(de)oa=Of-(Mf-d),ha=Pf-(Nf-h),Qf();else if(z.mouseMove(b.pageX,b.pageY),screen.height-10<=k){if(1.2==Math.abs(Gc)||0==Gc)Gc=1.2*((10>d)-(d>c-10));if(1.2==Math.abs(Hc)||0==Hc)Hc=1.2*((10>h)-(h>k-10))}}},Um=function(b){if(!Nh(b))if(b.altKey&&
b.pageX>w.mx){de=!0;var c=b.pageX;b=b.pageY;Of=oa;Pf=ha;Mf=c;Nf=b}else de=!1,fc(b.pageX-w.mx,b.pageY),z.mouseDown(b.pageX,b.pageY,b.button),!ee&&b.pageX>w.menumx&&0==b.button&&(window.addEventListener("mousemove",rc),c=fc(b.pageX-w.mx,b.pageY),b=c[1],wk=c=c[0],xk=b,Lh=c,Mh=b,jh=!0)},wk,xk,Lh,Mh,Vm=function(b){ee||(Nh(b)||(de?de=!1:z.mouseUp(b.pageX,b.pageY,b.button)),dd.actived&&dd(),vb.actived&&vb(),ae&&(ae=!1))},pm=function(){z.selection(wk,xk,Lh,Mh)},be=function(b,c){b={attack:z.gAttack(b),defence:z.gDefence(b),
level:z.glevel(b),health:z.ghealth(b),maxHealth:z.gmaxHealth(b),mana:z.gMana(b),item:z.gItem(b),build:z.gBuild(b),kingdom:z.gKingdom(b),c:z.gCval(b),manaMax:z.gManaMax(b),utype:z.giType(b),inventoryLength:z.gInventory(b),control:z.gControl(b),iconID:z.gIconID(b),type:z.gType(b),helper:z.gHelper(b),name:r[Cd[z.gName(b)]]};manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";b.sound&&!c&&(c=b.sound,na(c[~~(c.length*Math.random())]));b.inventoryLength&&b.control?
(p("stock").className="",manamenu1.style.display="block",manamenu1.style.backgroundPosition="0px -80px",manamenu1.innerHTML=b.inventoryLength):p("stock").className="blocked";b.build&&b.c&&(c=Math.floor(25*(b.c-t.cycle)/1E3),manamenu.style.display="block",manamenu.style.backgroundPosition="0px -200px",manamenu.innerHTML=c+"s");Fc.style.display="block";Zd.innerHTML=b.name;b.attack||0==b.utype?(nc.innerHTML=b.attack,ka("attackmenu")):M("attackmenu");0==b.utype||2==b.utype&&b.defence?(bd.innerHTML=b.defence,
ka("defencemenu")):M("defencemenu");b.manaMax&&(manamenu.style.display="block",manamenu.innerHTML=b.mana,27===b.type?(manamenu.style.backgroundPosition="0px -280px",ka("manamenu1"),manamenu1.style.backgroundPosition="0px -240px",manamenu1.innerHTML=b.helper):(progressmana.value=~~(100*b.mana/b.manaMax),ka("progressmana"),manamenu.style.backgroundPosition="0px -120px"));if(b.stock){c=b.stock;var k=gk[i/3];k.style.display="block";k.style.backgroundPosition=hk[c[4].icon].background;k.innerHTML=c[0]}oc.innerHTML=
b.level;oc.style.display="block";0===b.level&&(b.item||b.build)&&(oc.style.display="none");Fc.innerHTML=sc(xb(z.empName(b.kingdom),17));la.style.display="block";yk(b);ce(b.iconID)},sc=function(b){for(var c,k="",d=0;c=b[d++];)k+=String.fromCharCode(c);return k},yk=function(b){var c=b.health;b=b.maxHealth;-1==c?(la.value=100,la.max=100,tb.innerHTML=r.MISC_INF3):(la.value=c,-1==b?(la.max=100,la.value=1):la.max=b,tb.innerHTML=~~c+"/"+b)},zk=function(b,c){var k=A[b[0]],d=0,h=0,l=k.clss,f=b.length,m={},
g=[];g.cut={};for(var p={},q=0;q<f;q++){k=A[b[q]];d+=k.maxHealth;h+=k.health;Md=l!=k.clss?-1:!0;if(k.work)for(var v=k.work,t=Object.keys(v),x=0,w=t.length;x<w;x++){var z=t[x];p[z]||(p[z]=0);p[z]+=v[z]}t=k.icons;v=t.length;if(void 0===k.techID&&!1!==k.built)for(x=0;x<v;x++)w=t[x].id,t[x].obj.tech||(void 0===m[w]?m[w]=1:m[w]++,m[w]===f&&(t.cut&&(w=t.cut,z=t[x].objName,w[z]&&(g.cut[z]=w[z],g.cut[w[z]]=z)),g.put(t[x])))}!0===Md&&(Md=k.clss);h=Infinity==h?100:~~(h/d*100);tb.innerHTML=h+"/100(%)";Oh();
Zd.innerHTML="";nc.style.display="none";bd.style.display="none";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";oc.style.display="none";Fc.innerHTML=f+" "+r.SELVIEW_UNITS;la.style.display="block";la.value=h;la.max=100;if(!c)for(q=0,b=qa.page*qa.length,v=qa.length;q<v;q++)c=p[q+b],Aa[q].innerHTML=c?c:""},Qf=function(){};new Float32Array(8);var Ph,Qh,Rh,Sh,S=1,Wm=function(b){Ma(b.bufferID)},Wd={table:{},dates:[],new:function(b,c,e){c=Math.floor(c)+t.now();
var d=this.table;e||(e=Wm);d[c]||(d[c]=[]);b.animFunc=e;d[c].put(b);this.dates.add(c);this.needOrder=!0}},Xa=function(b){b=lb[b];return 0>b[1]?m.delay[b[0]-b[1]-1]:~~(b[0]/b[1]*1E3)};new Float32Array(12);var fh=function(b){var c=b.id+t.arje+b.x32+b.y32;b.rnd=[4294967295+c,4294967295-c,0]},Th=function(b){b.mlist&&Ak(b,!0);b.hlist&&Ak(b,!1)},Ak=function(b,c){if(c){var k=b.mlist;var d=b.mlistID;var h=gd.mercenaries}else k=b.hlist,d=b.hlistID,h=gd.heroes;k.unshift(h[oj(b,h.length)]);c?d.unshift(b.mercID++):
d.unshift(b.heroID++);8<k.length&&(k.length=8,d.length=8);sb(b,5E4)},Bk=function(k){k=A[k];if(!I[k.kingdom].paypal($l)){var c=I[k.kingdom],e=c.technology.disabled;if(!e[b.createCrusaders.id]){var d=16+4*c.crusade.number;c.crusade.number++;32<d&&(d=32);c=c.crusade.list;c.length=d;for(var h=0;h<d;h++)(c[h]=Ne(8,k,1)).deleteFromList=c;na("crusade",k.x32,k.y32);e[b.createCrusaders.id]=1;W(k.id)}}},zm=function(k){I[k.kingdom].technology.disabled[b.createCrusaders.id]=0},f,hd,uc={},kb,Y,Oe,id=function(b,
c){return new Float32Array(g.buffer,b,c)},xb=function(b,c){return new Uint16Array(g.buffer,b,c)},De=function(b,c){return new Uint8Array(g.buffer,b,c)},$c=function(b){return kb[b]},Ic=function(b){return Y[b]},Uh=function(b){return Oe[b]};$c.write=function(b,c){kb[b]=c};Ic.write=function(b,c){Y[b]=c};Uh.write=function(b,c){Oe[b]=c};var uf=[$c,Ic,Uh],Jh=function(){for(var b=qa.displayed.length=0,c=qa.length;b<c;b++){var e=Aa[b];e.className="blocked";e.style.backgroundPosition="48px 96px";e.innerHTML=
""}qa.rightButton.className="blocked";qa.leftButton.className="blocked";qa.stock.className="blocked";qa.rightBlocked=1},Ck=function(b,c,e){};Ck.actv={};var qk,ea,aa,Dk,pk,Ek,Rf,Vh,Wh,Sf,fe,ge,he,jd,Xh,Yh,Jc,Fk,ie=function(b,c){var k=4*Gk,d=f.createBuffer();d.size=c;d.len=k;f.bindBuffer(f.ARRAY_BUFFER,d);f.enableVertexAttribArray(b);f.vertexAttribPointer(b,c,f.FLOAT,!1,0,0);f.bufferData(f.ARRAY_BUFFER,k*c,f.STATIC_DRAW);Ba?Tf.vertexAttribDivisorANGLE(b,1):f.vertexAttribDivisor(b,1);return d};ie.jump=
4E3;var Uf=function(b,c){var k=f.createBuffer(),d=c+1E4;c*=4;d*=4;f.bindBuffer(f.COPY_READ_BUFFER,b);f.bindBuffer(f.ARRAY_BUFFER,k);f.bufferData(f.ARRAY_BUFFER,c*b.size,f.STATIC_DRAW);f.copyBufferSubData(f.COPY_READ_BUFFER,f.ARRAY_BUFFER,0,0,c*b.size);f.bindBuffer(f.COPY_READ_BUFFER,k);f.bindBuffer(f.ARRAY_BUFFER,b);f.bufferData(f.ARRAY_BUFFER,d*b.size,f.STATIC_DRAW);f.copyBufferSubData(f.COPY_READ_BUFFER,f.ARRAY_BUFFER,0,0,c*b.size);f.bindBuffer(f.COPY_READ_BUFFER,null);f.deleteBuffer(k)},Ba,xa=
function(){if(!t.canceled){performance.now();requestAnimationFrame(xa);var b=xa.fp1000,c=xa.delta,e=xa.now,d=xa.realnow,h=xa.delta,l=e;xa.frameCount++;e=Date.now()-Jd+25*t.cycle;xa.now=e;c=(c+(e-l))/1E3;xa.delta=c;l=d;d=Date.now();xa.realnow=d;h=(h+(d-l))/1E3;xa.realdelta=h;eh+=c;dh++;xa.fp1000=b+c;if(0!=Gc||0!=Hc)b=parseInt(localStorage.scrollSpeed)/100,oa+=Gc*h*1280*S*b,ha+=Hc*h*1280*S*b,oa=Math.floor(oa),ha=Math.floor(ha),ad(-oa,-ha),rc();f.useProgram(ea);bk(e);Qf();f.uniform1f(Ek,e);f.clear(f.COLOR_BUFFER_BIT|
f.DEPTH_BUFFER_BIT);h=window.innerWidth;b=window.innerHeight;f.useProgram(aa);kd(Xh);f.uniform1f(Vh,e);f.drawArrays(f.TRIANGLES,0,6);f.viewport(w.marx,b-Ya-w.mary,qc,Ya);f.uniform1i(Sf,1);f.uniform2fv(he,[0,0]);f.uniform1f(jd,qc/32/H);f.drawArrays(f.TRIANGLES,0,6);f.uniform1i(Sf,0);f.uniform2f(Wh,h,b);f.uniform2fv(he,[oa,ha]);f.uniform1f(jd,1/S);f.viewport(w.mx,0,h,b);f.useProgram(ea);kd(Yh);Zh(z.getBufferID());e=tzar.width;h=tzar.height;f.viewport(w.marx,h-Ya-w.mary,qc,Ya);f.uniform2f(Rf,32*H,32*
Da);f.uniform2fv(ge,[0,0]);f.uniform1i(fe,1);f.uniform1f(hd,1);Zh(z.getBufferID());f.uniform1i(fe,2);Zh(1);f.uniform1i(fe,0);f.uniform2f(Rf,e,h);f.uniform2fv(ge,[oa,ha]);f.uniform1f(hd,1/S);f.viewport(w.mx,0,e,h);ja.active&&(Yd(ja.x,ja.y,96*H,ja.bufferID),ja.active=!1);Kc.update&&Kc(1)}},Zh=function(b){b&&(f.enable(f.BLEND),f.blendEquation(f.FUNC_ADD),f.blendFunc(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA),Ba?Tf.drawArraysInstancedANGLE(f.TRIANGLES,0,6,b):f.drawArraysInstanced(f.TRIANGLES,0,6,b),f.disable(f.BLEND))},
je=!1,rk=function(b){if(!ee&&(b.clientX>w.menumx||ae||!b.clientX)){var c=tzar.width,k=tzar.height;b=Math.sign(b.deltaY)*parseFloat(localStorage.zoomMult)/1E3*S;k=(S+b)*k*.03125;(S+b)*c*.03125-(S+b)*w.mx/32>H||k>Da||(S+=b,.08>S&&(S=.08),Kh&&rc(),ad(-oa,-ha),f.useProgram(aa),f.uniform1f(jd,1/S),f.useProgram(ea),f.uniform1f(hd,1/S),z.setupZoom(S),Hk())}},Hk=function(){var b=tzar.width,c=tzar.height,e=-ha+.5*(c-S*c),d=S*(b-w.mx);c*=S;qb[0]=-oa+.5*(b-S*b);qb[1]=e;qb[2]=-999999999;qb[3]=0;qb[4]=0;Yd();
qb[0]=d;qb[1]=c;qb[2]=0;qb[3]=0;qb[4]=0;Ik()},Jk,Kk;Qf=function(){var b=[oa,ha];if(oa!=Jk||ha!=Kk)Jk=oa,Kk=ha,z.setupTranslation(-oa,-ha),f.useProgram(aa),f.uniform2fv(he,b),f.useProgram(ea),f.uniform2fv(ge,b),Hk()};var Lk,ld,Vf=function(){var b=window.innerWidth,c=window.innerHeight;f.canvas.width=b;f.canvas.height=c;z.canvasSize(b,c);f.useProgram(aa);f.uniform2f(Wh,b,c);f.useProgram(ea);Jc.width=b;Jc.height=c;f.activeTexture(f.TEXTURE2);ld||(ld=f.createTexture());f.bindTexture(f.TEXTURE_2D,ld);
f.texImage2D(f.TEXTURE_2D,0,f.RGBA,b,c,0,f.RGBA,f.UNSIGNED_BYTE,null);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.bindFramebuffer(f.FRAMEBUFFER,Jc);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,ld,0);f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT);f.bindFramebuffer(f.FRAMEBUFFER,
null);f.uniform1f(hd,1);f.uniform1i(f.getUniformLocation(ea,"lightmap"),2);f.useProgram(aa);f.uniform1i(f.getUniformLocation(aa,"lightmap"),2);f.uniform1f(jd,1);f.useProgram(ea);f.uniform2f(Rf,b,c);f.viewport(w.mx,0,b,c);Vf.changed=1;ad(-oa,-ha)},kd=function(b){if(Ba)return Wf.bindVertexArrayOES(b);f.bindVertexArray(b)},Wf,Tf,Mk=function(){return Ba?(Wf||(Wf=f.getExtension("OES_vertex_array_object")),Wf.createVertexArrayOES()):f.createVertexArray()};"use strict";var fa=function(b,c){return b<H&&0<=
b&&0<=c&&c<Da?!0:!1};Array.prototype.put=function(b){this[this.length]=b};var kc,ke,Vd,md=function(b,c,e,d){d&&0==md.cols[d]&&(md.list.push(d,b),md.cols[d]=1)};md.cols={};md.list=[];var F=function(b){for(var c=Object.keys(b),k=0;k<0*c.length;k++)b[b[c[k]]]=c[k];return b};window.onerror=md;var t={},lb=[],O=function(b,c,e,d){var k=0,l=e.length-1,f=e[l];d=db[d];var m=[],g=0,p=!0;fa(b,c)&&fa(b+f-1,c+l/f-1)||(p=!1);for(var r=H,v=0;v<l;v++){k==f&&(k=0,c++);if(e[v]){var q=b+k+r*c;d[q]&&(p=!1);if(0<Y[q]||
lc[q])p=!1;m[g++]=q}k++}return[m,p]};O.check=function(b,c,e,d,h,l,f,m){var k=e.length-1;e=e[k];var n=k/e;k=H;f=db[f];e+=2;--b;--c;n=e*(n+2);for(var g=0;g<n;g++){var p=b+g%e,y=c+~~(g/e),r=p+y*k;if(0<Y[r]||lc[r]||l&&(p>=h&&p<=h+2||y>=d&&y<=d+2)||!fa(p,y)||f[r]||A[kb[r]].field||m[r])return!1}return!0};var Nk=function(b,c,e){var d=0,k=e.length-1,l=e[k],f=[],m=[],g=0,p=!0;fa(b,c)&&fa(b+l-1,c+k/l-1)||(p=!1);for(var r=0,q=0;q<k;q++){d==l&&(d=0,c++);var t=b+d+H*c;e[q]?(2<Y[t]&&(p=!1),f[g++]=t):(m[r++]=t,
2<Y[t]&&(p=!1));d++}return[f,p,m]},Wg=function(b,c,e){var d=0,k=e.length-1,l=e[k],f=[],m=0,g=!0;fa(b,c)&&fa(b+l-1,c+k/l-1)||(g=!1);for(var p=0;p<k;p++){d==l&&(d=0,c++);var r=b+d+c*H;if(e[p]&&2<Y[r]&&1==A[Y[r]].build||0<kb[r])g=!1;f[m++]=r;d++}return[f,g]},Xf=function(b,c,e){var d=!1,k=0,l=[],f=0,m=e.length-1,g=e[m],p=0,r=!0;fa(b,c)&&fa(b+g-1,c+m/g-1)||(r=!1);for(var q=0;q<m;q++){p==g&&(p=0,c++);if(e[q]){var t=b+p+H*c,x=Y[t];2<x&&(r=!1);0<x?k++:d=!0;l[f++]=t}p++}k>.5*(m-1)&&d||(r=!1);return[l,r]},
le=function(b,c,e){e=!0;fa(b,c)||(e=!1);1!==kb[b+c*H]&&(e=!1);return[[b+c*H],e]},U=function(b,c,e){e=!0;fa(b,c)||(e=!1);0<Y[b+c*H]&&(e=!1);return[[b+c*H],e]},Yf=function(b,c,e){e=!0;fa(b,c)||(e=!1);0<Oe[b+c*H]&&(e=!1);return[[b+c*H],e]},Gb=function(b,c,e){e=!0;fa(b,c)||(e=!1);if(0<kb[b+c*H]||2==Y[b+c*H]||1==Y[b+c*H])e=!1;return[[b+c*H],e]};O.dimension=Ic;le.dimension=$c;Nk.dimension=Ic;Wg.dimension=$c;U.dimension=Ic;Yf.dimension=Uh;Gb.dimension=$c;Xf.dimension=Ic;var ja,D,pa,ua,bm=function(){ja={img:0,
x32:-1E3,y32:-1E3,rgb:[0,0,0,.5],d:0,active:!1};var k=8,c=9;if(!je){Xm();var e=[b.move,b.attack,b.guard,b.patrol,b.pickUp,b.explore,b.stop,b.stand,b.sameSpeed,b.restoreSpeed];ke={magic_creatures:[58,40,59,5,78,77,60,130,131,132,89,129]};var d=Object.keys(ke),h=0;for(k=d.length;h<k;h++){var l=ke[d[h]],f={};l.obj=f;for(var g=0,q=l.length;g<q;f[l[g++]]=1);}gd.mercenaries=[b.mercArcher,b.mercFootman,b.mercMaceman,b.mercLongbowman,b.mercPikeman,b.mercKnight,b.mercArcherAsian,b.mercSamurai,b.mercHourseSamurai,
b.mercRonin,b.mercHorseArcher,b.mercChariot,b.mercFootmanArab,b.mercArcherArab,b.mercMacemanArab,b.mercPikemanArab,b.mercCavalry,b.mercEnichar,b.mercJihad];gd.heroes=[b.mercArcher6,b.mercFootman6,b.mercMaceman6,b.mercLongbowman6,b.mercPikeman6,b.mercKnight6,b.mercArcherAsian6,b.mercSamurai6,b.mercHourseSamurai6,b.mercRonin6,b.mercHorseArcher6,b.mercChariot6,b.mercFootmanArab6,b.mercArcherArab6,b.mercMacemanArab6,b.mercPikemanArab6,b.mercCavalry6,b.mercEnichar6,b.mercJihad6];d=gd.mercenaries;h=0;for(k=
d.length;h<k;d[h++].merc=9);d=gd.heroes;h=0;for(k=d.length;h<k;d[h++].hero=1);Date.now();h=[b.createKnight,b.createHorseArcher1,b.createHorseArcher2,b.createHorseSamurai,b.createChariot,b.createEnichar,b.createCavalry];d=id(z.atlasLoc(),1048576);d.splen=0;ca.info=d;ca.originalLength=lb.length;Vd={sword:{name:"Sword",iconID:16,img:m.items1,d:0,dMax:7,attack:1,type:52,sword:1},bow:{name:"Bow",iconID:4,img:m.items1,d:15,dMax:4,attack:1,type:52,sword:1},shield:{name:"Shield",iconID:1,img:m.items1,d:8,
dMax:6,defence:1,type:52,shield:1},potion:{name:"Potion",iconID:11,img:m.potions,d:0,dMax:7,type:52,potion:1},book:{name:"Book",iconID:9,img:m.books,d:0,dMax:4,type:52,book:1},gold:{name:"Gold",iconID:20,img:m.item_gold,d:0,dMax:0,type:52},stone:{name:"Stone",iconID:22,img:m.item_stone,d:0,dMax:0,type:52},food:{name:"Food",iconID:14,img:m.item_food,d:0,dMax:0,type:52},wood:{name:"Wood",iconID:15,img:m.item_tree,d:0,dMax:0,type:52},iron:{name:"Iron",iconID:21,img:m.item_iron,d:0,dMax:0,type:52}};d=
[b.move,b.attack,b.stop,b.stand,b.pickUp,b.explore,b.healing,b.bless];k=[b.attack,b.guard,b.patrol,b.explore,b.stop,b.stand,b.attackGround,b.steady,b.move];g=[b.buildAcademy,b.buildWorkshop,b.buildWorkshop1,b.buildAcademy1,b.buildWorkshop2,b.buildAcademy2];f=[b.buildMerchands1,b.buildMerchands2,b.buildMerchands];ua={euro:{},asia:{},arab:{},common:{}};B=[{name:"Footman",attack:6,defence:3,health:65,maxHealth:65,img:m.euro_footman,attackSound:Yb,invType:0,invMax:8,validator:U,human:12,iconID:36,time:12,
sight:5,url:m.euro_footman,icons:e,cost:[0,0,50,0],attDist:1,spd:50,dieSound:bb,clss:"footman",size:1,standardFunc:x,radix:0,zLevel:1,strID:"e_footman",race:"euro"},{name:"Pikeman",radix:0,attackSound:Yb,attack:8,defence:4,health:75,maxHealth:75,img:m.euro_pikeman,invType:0,dieSound:bb,invMax:8,validator:U,human:1,iconID:39,time:18,sight:5,url:m.euro_pikeman,icons:e,cost:[40,0,60,0],attDist:1,spd:50,standardFunc:x,clss:"e_pikeman",zLevel:1,size:1,strID:"e_pikeman",nu:b.createPikeman,race:"euro"},
{name:"Spy",radix:0,attack:20,defence:0,mana:100,manaMax:100,health:50,maxHealth:50,img:m.euro_spy,attackSound:["spy%20kill%201","spy%20kill%202","spy%20kill%203"],invType:0,invMax:8,validator:U,human:1,dieSound:bb,iconID:41,time:30,sight:12,url:m.euro_spy,icons:[b.move,b.attack,b.guard,b.patrol,b.pickUp,b.explore,b.stop,b.stand,b.impersonate,b.revealSelf],zLevel:1,cost:[120,0,0,0],attDist:1,spd:50,clss:"spy",standardFunc:x,size:1,update:["mana","manaSpeed",1E3],isSpy:1,strID:"spy",nu:b.createSpy,
race:"common"},{name:"Maceman",radix:0,attack:8,defence:0,health:120,maxHealth:120,img:m.euro_maceman,attackSound:Yb,invType:0,invMax:8,validator:U,human:1,iconID:37,time:14,dieSound:bb,sight:5,zLevel:1,url:m.euro_maceman,icons:e,cost:[0,0,120,0],attDist:1,spd:50,clss:"maceman",standardFunc:x,size:1,strID:"e_maceman",nu:b.createMaceman,race:"euro"},{radix:0,name:"Archer",attack:5,defence:0,health:50,maxHealth:50,img:m.euro_archer1,invType:0,invMax:8,validator:U,human:1,sight:10,dieSound:bb,arrow:!0,
iconID:38,zLevel:1,time:12,url:m.euro_archer1,icons:e,cost:[0,20,40,0],attDist:7,spd:50,clss:"archer",standardFunc:x,attimg:m.arrow1,attackSound:Vc,size:1,strID:"e_archer",nu:b.createArcher,race:"euro"},{radix:0,name:"Wizard",attackSound:Si,dieSound:["mage"],attack:5,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:m.euro_mage,zLevel:1,invType:0,invMax:8,validator:U,human:1,iconID:42,time:30,sight:15,url:m.euro_mage,icons:[b.stop,b.pickUp,b.explore,b.lightning,b.createBat,b.freeze,b.createGolem,
b.invisibility,b.stand,b.attack,b.move],cost:[150,0,0,0],attDist:10,attimg:m.flame_bolt,ball:1,spd:50,clss:"mage",standardFunc:x,size:1,update:["mana","manaSpeed",1E3],strID:"e_mage",nu:b.createMage,race:"euro"},{radix:0,name:"Longbowman",attack:6,defence:2,health:50,maxHealth:50,img:m.euro_longbowman,zLevel:1,invType:0,invMax:8,dieSound:bb,attackSound:Vc,arrow:!0,validator:U,race:"euro",human:1,iconID:35,time:18,sight:18,url:m.euro_longbowman,icons:e,cost:[50,0,90,0],attDist:12,spd:50,standardFunc:x,
clss:"longbowman",size:1,d2attack:2,strID:"e_longbowman",attimg:m.arrow1,nu:b.createLongbowman},{radix:0,clss:"tree",name:"Tree",health:100,maxHealth:100,img:m.terrain_tree,invType:0,invMax:8,zLevel:1,mMapcolor:[11,131,11],validator:U,child:[{img:m.terrain_tree_s,rgb:[0,0,0,.5],alpha:1,x:0,y:0}],iconID:23,url:m.terrain_tree,dimgInfinity:m.terrain_tree,dimgRND:3,icons:[],res:1,race:"common",build:!0,size:1,zolotoy:1,strID:"tree"},{radix:0,name:"Crusader",zLevel:1,dieSound:Fd,attackSound:Dd,attack:14,
defence:8,health:180,maxHealth:180,img:m.crus,invType:0,invMax:8,validator:U,human:1,race:"euro",iconID:100,time:19,sight:5,url:m.crus,icons:e,cost:[0,0,0,0],attDist:1,spd:85,standardFunc:x,clss:"crusader",size:1,strID:"crusader"},{radix:0,name:"Priest",attack:20,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:m.euro_priest,invType:0,zLevel:1,invMax:8,validator:U,human:1,iconID:40,time:30,ball:1,sight:21,dieSound:bb,url:m.euro_priest,icons:d,attackOnly:ke.magic_creatures.obj,cost:[150,0,
0,0],attDist:18,race:"euro",spd:50,standardFunc:x,clss:"priest",size:1,update:["mana","manaSpeed",1E3],strID:"e_priest",nu:b.createPriest,attimg:m.flame_bolt},{radix:0,name:"Peasant",attackSound:Pg,attack:5,defence:0,health:50,maxHealth:50,img:m.euro_peasant,invType:0,invMax:8,dieSound:bb,zLevel:1,validator:U,human:1,race:"euro",iconID:33,time:8,sight:5,url:m.euro_peasant,icons:[b.move,b.menuBuilds,b.repair,b.conquest,b.dcm,b.pickUp,b.explore,b.stop,b.stand,b.attack,b.bribe,b.sameSpeed,b.restoreSpeed],
cost:[0,0,50,0],attDist:1,spd:50,clss:"peon",size:1,peon:1,strID:"e_peon",nu:b.createPeon,nocapture:1},{radix:0,clss:"cathedral",name:"Cathedral",dieSound:N,sound:["e_cathedral1","e_cathedral2"],resistance:700,health:5E3,maxHealth:5E3,img:m.euro_cathedral,invType:0,invMax:8,race:"euro",zLevel:1,validator:O,bimg:m.build5x5,dimg:m.des_5x5,iconID:60,icons:[b.createCrusaders,b.techFanaticism,b.techEspionage,b.techInquisition,b.techHealing,b.techBless,b.techCrusade,b.techMedicine],time:90,sight:8,child:[{img:m.euro_cathedral_c,
x:0,y:0},{img:m.euro_cathedral_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,5]),url:m.euro_cathedral,build:!0,cost:[2E3,0,0,2E3],onbuild:[b.buildChurch],size:1,strID:"cathedral"},{radix:0,name:"Castle",clss:"castle",dieSound:N,sound:["e_castle1"],resistance:700,health:8E3,maxHealth:8E3,img:m.euro_castle,invType:1,invMax:50,race:"euro",zLevel:1,validator:O,bimg:m.build6x6,dimg:m.des_6x6,iconID:59,time:120,sight:12,child:[{img:m.euro_castle_c,
x:0,y:0,mv:!0},{alpha:!0,img:m.euro_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[b.createPeon,b.createSpy,b.emergeAllUnits,b.techFeudalism,b.techArchitecture,b.techLearning],space:new Uint8Array([0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,0,1,1,7]),menu:Ga,url:m.euro_castle,build:!0,cost:[0,1500,0,1500],storage:4,castle:!0,population:20,size:1,strID:"e_castle"},{radix:0,name:"Wooden Wall",clss:"wall_wood",resistance:700,health:2E3,maxHealth:2E3,img:m.wood_tower,
time:6,sight:1,zLevel:1,dieSound:N,validator:O,bimg:m.wood_build,dimgInfinity:m.wood_debris,iconID:49,icons:[],mx:0,race:"common",my:0,hframe:71,menu:Ga,url:m.wood_tower,space:new Uint8Array([1,1]),wall:1,build:!0,cost:[0,20,0,0],size:1,strID:"woodwall",child:[{img:m.wood_tower_c,x:0,y:0}]},{radix:0,name:"Barracks",clss:"barracks",strID:"e_barrack",sound:Qg,generator:1,resistance:500,health:1400,maxHealth:1400,img:m.euro_barrack,invType:1,invMax:0,dieSound:N,time:60,sight:6,zLevel:1,race:"euro",validator:O,
bimg:m.build5x5,dimg:m.des_5x5,child:[{img:m.euro_barracks_c,mv:!0},{img:m.euro_barrack_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:57,icons:[b.createFootman,b.createArcher,b.createMaceman,b.createPikeman,b.createLongbowman,b.createKnight],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:m.euro_barrack,build:!0,cost:[0,0,200,200],size:1},{radix:0,strID:"e_lumber",name:"Lumber Mill",sound:["e_lumber1"],clss:"lumber_mill",resistance:500,health:800,maxHealth:800,img:m.euro_lumbermill,
invType:1,invMax:0,time:30,race:"euro",sight:4,dieSound:N,zLevel:1,validator:O,bimg:m.build2x2,dimg:m.des_2x2,iconID:64,child:[{img:m.euro_lumbermill_c,x:0,y:0},{alpha:!0,img:m.euro_lumbermill_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[b.techLongbow,b.techWoodCutting,b.techCrossbow],space:new Uint8Array([1,1,1,1,2]),hframe:98,url:m.euro_lumbermill,build:!0,cost:[0,100,0,0],storage:1,size:1},{radix:0,name:"Mage Tower",strID:"e_magetower",sound:["e_magetower1","e_magetower2","e_magetower3"],clss:"magictower",
resistance:700,health:5E3,maxHealth:5E3,img:m.euro_magetower,invType:1,invMax:0,time:90,race:"euro",dieSound:N,sight:8,validator:O,bimg:m.build5x5,dimg:m.des_5x5,zLevel:1,child:[{img:m.euro_magetower_c,x:0,y:0},{img:m.euro_magetower_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:71,icons:[b.createMage,b.techBat,b.techInvisibility,b.techLightning,b.techFreeze,b.techGolem],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:m.euro_magetower,build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,strID:"e_waracademy",
name:"Warriors Guild",sound:["e_waracademy1"],clss:"academy",resistance:700,health:5E3,maxHealth:5E3,img:m.euro_waracademy,invType:1,invMax:0,race:"euro",time:90,sight:8,dieSound:N,zLevel:1,validator:O,bimg:m.build6x6,dimg:m.des_6x6,iconID:56,child:[{img:m.euro_waracademy_c,x:0,y:0,mv:!0},{img:m.euro_waracademy_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],icons:[b.techHeroism,b.techWarfare,b.techMercenaries,b.techSiegeTactics,b.techBodyBuilding,b.techLeadership,b.techTactics,b.techHeroes,b.techHonor,b.techFame],
space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,0,5]),url:m.euro_waracademy,build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,name:"Storage",strID:"e_storage",sound:["e_storage1","e_storage2"],clss:"storage",resistance:80,health:800,maxHealth:800,img:m.euro_storage,invType:1,invMax:0,time:30,dieSound:N,zLevel:1,sight:5,validator:O,bimg:m.build4x4,dimg:m.des_4x4,iconID:69,race:"euro",icons:[b.techGoldMining,b.techStoneMining],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,4]),
url:m.euro_storage,storage:0,build:!0,cost:[0,200,0,0],size:1,child:[{img:m.euro_storage_c,x:0,y:0},{img:m.euro_storage_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Knight",strID:"e_knight",dieSound:Fd,clss:"knight",attackSound:Dd,attack:12,defence:6,health:120,maxHealth:120,img:m.euro_knight,invType:0,zLevel:1,race:"euro",invMax:8,validator:U,human:1,iconID:43,d2attack:2,time:22,sight:5,url:m.euro_knight,icons:e,cost:[120,0,70,0],attDist:1,spd:85,nu:b.createKnight,standardFunc:x,size:1},{radix:0,
name:"Field",clss:"field",strID:"field",instantBuild:1,resistance:80,health:100,maxHealth:100,img:m.fields,invMax:0,validator:Wg,zLevel:0,iconID:104,race:"common",icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:m.fields,build:!0,field:1,res:2,cost:[0,200,0,0],rndDirection:9,time:0,sight:1,z32:.5,size:1},{radix:0,name:"Golden rocks",mMapcolor:[148,148,0],strID:"gold",sound:["mine1"],clss:"golden_rocks",resistance:0,health:8E3,maxHealth:8E3,img:m.res_gold,invMax:0,validator:O,iconID:20,icons:[],
space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:m.res_gold,build:!0,zLevel:1,race:"common",res:0,cost:[0,0,0,0],time:0,sight:2,dieSound:["destroy%20mine"],size:1,zolotoy:1,child:[{img:m.res_gold_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:m.res_gold},{radix:0,name:"Rocks",strID:"stone",mMapcolor:[132,132,132],sound:["mine1"],clss:"rocks",dieSound:["destroy%20mine"],resistance:0,health:8E3,maxHealth:8E3,img:m.res_stone,invMax:0,validator:O,zLevel:1,iconID:22,icons:[],space:new Uint8Array([1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:m.res_stone,build:!0,res:3,cost:[0,0,0,0],race:"common",time:0,sight:2,size:1,zolotoy:1,child:[{img:m.res_stone_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:m.res_stone},{radix:0,name:"Farm",strID:"e_farm",sound:["e_farm1","e_farm2"],clss:"farm",resistance:0,health:800,maxHealth:800,img:m.euro_farm,invType:1,invMax:0,zLevel:1,validator:O,bimg:m.build4x4,dimg:m.des_4x4,iconID:61,dieSound:N,race:"euro",icons:[b.createCow,b.techCropRotation,b.techDomestication],
space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),menu:Ga,url:m.euro_farm,build:!0,cost:[0,200,0,0],time:30,sight:5,storage:2,size:1,child:[{img:m.euro_farm_c,x:0,y:0}]},{radix:0,name:"Merchants Guild",strID:"e_merchant",sound:["merchant"],clss:"merchants_guild",resistance:0,health:5E3,maxHealth:5E3,img:m.euro_tcguild,invType:1,invMax:0,validator:O,bimg:m.build6x6,zLevel:1,dimg:m.des_6x6,race:"euro",iconID:62,dieSound:N,icons:[b.techMapMaking,b.techTradeRoutes,b.techUsury,b.techSupplyStorage,
b.techBribery,b.techTradeTaxes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),menu:Ga,url:m.euro_tcguild,build:!0,time:90,sight:8,cost:[2E3,0,0,2E3],onbuild:[b.buildMarket],size:1,child:[{img:m.euro_tcguild_c,x:0,y:0},{img:m.euro_tcguild_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Church",clss:"church",strID:"e_church",sound:["e_church1"],resistance:0,health:800,maxHealth:800,img:m.euro_church,invType:1,invMax:0,dieSound:N,validator:O,bimg:m.build3x3,race:"euro",
zLevel:1,dimg:m.des_3x3,iconID:139,icons:[b.createPriest],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),menu:Ga,url:m.euro_church,build:!0,cost:[0,0,200,200],time:40,sight:6,size:1,child:[{img:m.euro_church_c,x:0,y:0},{img:m.euro_church_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Blacksmith",clss:"blacksmith",strID:"e_blacksmith",resistance:0,health:800,maxHealth:800,img:m.euro_blacksmith,invType:1,invMax:0,time:40,zLevel:1,sight:5,dieSound:N,validator:O,bimg:m.build4x4,race:"euro",dimg:m.des_4x4,
child:[{img:m.euro_blacksmith_c,x:0,y:0}],iconID:58,icons:[b.techPlateArmor,b.techTemperIron,b.techScaleArmor,b.techHalberd,b.techChainMail],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),menu:Ga,url:m.euro_blacksmith,build:!0,cost:[0,0,200,200],onbuild:g,size:1},{radix:0,name:"Cow",clss:"cow",nu:b.createCow,race:"common",strID:"cow",attack:0,defence:3,health:50,maxHealth:50,img:m.cow,invType:0,invMax:8,zLevel:1,validator:U,iconID:99,time:20,dieSound:["cowdie1","cowdie2","cowdie3","cowdie4"],
url:m.cow,icons:[b.move,b.stop],sight:3,cost:[0,0,300,0],attDist:0,spd:32,res:2,food:300,milk:50,milkMax:50,foodMax:600,size:1,cow:1,update:["milk","milkSpeed",1E3,"food","cowSpeed",1E3]},{radix:0,name:"Stable",sound:["e_stables1"],clss:"stable",strID:"e_stable",onlyRequired:1,resistance:0,health:800,maxHealth:800,invType:1,invMax:0,race:"euro",zLevel:1,validator:O,bimg:m.build4x4,dimg:m.des_4x4,iconID:68,dieSound:N,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,4]),url:m.euro_stables,build:!0,
cost:[0,200,0,0],onbuild:h,size:1,time:40,sight:5,img:m.euro_stables,nu:b.createCow,child:[{img:m.euro_stable_c,x:0,y:0}]},{radix:0,name:"Workshop",sound:["e_workshop1"],clss:"workshop",strID:"e_workshop",zLevel:1,resistance:0,health:800,maxHealth:800,img:m.euro_workshop,invType:1,invMax:0,dieSound:N,validator:O,bimg:m.build4x4,race:"euro",dimg:m.des_4x4,iconID:75,icons:[b.createCatapult,b.createHeavyCatapult,b.createBallist,b.techEngineering,b.techCannonTower],space:new Uint8Array([1,1,1,1,1,1,1,
1,1,1,1,1,1,1,0,1,4]),url:m.euro_workshop,build:!0,cost:[0,200,200,0],size:1,time:40,sight:5,child:[{img:m.euro_workshop_c,x:0,y:0}]},{radix:0,name:"Tavern",sound:["e_tavern1"],clss:"tavern",strID:"e_tavern",dieSound:N,resistance:0,health:1E3,maxHealth:1E3,img:m.euro_tavern,invType:1,invMax:0,validator:O,race:"euro",bimg:m.build4x4,dimg:m.des_4x4,zLevel:1,iconID:70,icons:[b.createMercenaries,b.createHeroes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,4]),url:m.euro_tavern,build:1,cost:[0,
200,200,0],onbuild:f,actvintv:[b.iniMercenaries,b.iniHeroes],size:1,time:40,sight:5,child:[{img:m.euro_tavern_c,x:0,y:0}]},{name:"House",sound:["house1","house2","house3","house4","house5"],clss:"house",strID:"e_house",resistance:0,health:500,maxHealth:500,img:m.euro_houses,invType:1,invMax:0,validator:O,bimg:m.build3x3,dimg:m.des_3x3,race:"euro",iconID:73,zLevel:1,dieSound:N,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:m.euro_houses,build:!0,cost:[0,75,0,0],population:10,size:1,time:20,
sight:4,child:[{img:m.euro_houses_c,x:0,y:0}]},{name:"Watch Tower",attackSound:Fe,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),clss:"watch_tower",strID:"watch_tower",attack:7,health:400,maxHealth:400,img:m.euro_tower_wood_2,state:0,invType:1,race:"common",invMax:0,zLevel:1,dieSound:N,level:0,validator:O,child:[{img:m.euro_tower_wood_2_c,x:0,y:0},{alpha:!0,img:m.euro_tower_wood_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attimg:m.arrow1,attDist:8,bimg:m.build2x2,dimg:m.des_2x2,iconID:53,icons:[b.attack,
b.stop,b.upgradeGuildTower],space:new Uint8Array([1,1,1,1,2]),url:m.euro_tower_wood_2,build:!0,cost:[0,300,0,0],size:1,arrow:!0,time:10,sight:15,standardFunc:x},{name:"Market",sound:["e_market1"],clss:"market",strID:"e_market",resistance:0,health:1400,maxHealth:1400,img:m.euro_market,invType:1,invMax:0,dieSound:N,zLevel:1,validator:O,bimg:m.build4x4,dimg:m.des_4x4,iconID:65,race:"euro",icons:[b.createCaravan],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,4]),url:m.euro_market,build:!0,cost:[0,
200,200,0],size:1,time:60,sight:8,child:[{img:m.euro_market_c,x:0,y:0}]},{name:"Outpost",sound:["e_outpost1"],clss:"outpost",strID:"e_outpost",zLevel:1,resistance:0,health:2E3,maxHealth:2E3,img:m.euro_outpost,invType:1,dieSound:N,invMax:50,validator:O,race:"euro",bimg:m.build4x4,dimg:m.des_4x4,iconID:66,icons:[b.emergeAllUnits],space:new Uint8Array([0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,4]),url:m.euro_outpost,build:!0,cost:[0,200,0,400],size:1,child:[{img:m.euro_outpost_c,x:0,y:0},{img:m.euro_outpost_s,
x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:60,sight:8},{name:"Bridge",clss:"bridge",strID:"bridge",resistance:0,health:1E4,maxHealth:1E4,img:m.bridge_horz,invMax:0,valid2:!0,validator:Nk,bimg:m.bridge_horz_build,race:"common",zLevel:1,dieSound:N,child:[{alpha:!0,img:m.bridge_horz_s,x:0,y:0,rgb:[0,0,0,.5]},{img:m.bridge_horz1,x:0,y:0,z:6}],time:22,sight:1,dimg:m.bridge_horz_demol,iconID:44,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,11]),url:m.bridge_horz,build:!0,cost:[0,200,0,400],size:1},{name:"Dummy",clss:"dummy",strID:"dummy",resistance:0,health:5E3,maxHealth:5E3,img:m.dummy1,invMax:0,validator:U,bimg:m.dummy1_b,iconID:165,icons:[],mx:0,zLevel:1,my:16,hframe:65,race:"common",url:m.dummy1,dimg:m.dummy1_d,build:!0,cost:[0,300,0,0],dummy:!0,child:[{img:m.dummy1_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:10,sight:1},{name:"Catapult",strID:"catapult",dieSound:He,
clss:"catapult",attackSound:Ge,defence:0,attack:10,health:110,maxHealth:110,img:m.catapult,invMax:0,radix:0,validator:U,iconID:30,time:30,sight:20,race:"common",url:m.catapult,level:0,zLevel:1,icons:k,cost:[0,600,0,0],nofreeze:1,arrow:!1,attDist:17,spd:40,standardFunc:x,size:1,attimg:m.cat_stone,space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:b.createCatapult},{name:"Ballista",radix:0,strID:"ballista",attackSound:Ge,dieSound:He,clss:"ballista",defence:0,attack:60,health:75,maxHealth:75,img:m.ballista,
invMax:0,validator:U,iconID:31,time:30,sight:16,nofreeze:1,race:"common",zLevel:1,url:m.ballista,icons:k,cost:[0,800,0,0],attDist:13,spd:40,standardFunc:x,size:1,attimg:m.arrow_ballista1,space:new Uint8Array([1,1,1,1,2]),attackDeg:30,nu:b.createBallist},{name:"Heavy Catapult",strID:"heavy_catapult",attackSound:Ge,defence:0,attack:25,health:250,maxHealth:250,img:m.h_catapult,invMax:0,radix:0,validator:U,iconID:45,time:60,dieSound:He,sight:26,race:"common",url:m.h_catapult,zLevel:1,icons:k,standardFunc:x,
cost:[0,1200,0,0],attDist:22,spd:40,nofreeze:1,clss:"heavy_catapult",size:1,attimg:m.cb_metal,space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:b.createHeavyCatapult},{radix:0,name:"Ghost",strID:"ghost",defence:0,attack:8,health:60,maxHealth:60,img:m.euro_ghost,invType:0,invMax:8,dieSound:["ghost1","ghost2"],validator:U,iconID:178,zLevel:1,race:"common",time:15,attackSound:Ri,sight:5,standardFunc:x,url:m.euro_ghost,icons:e,w:1,cost:[40,0,0,0],attDist:1,spd:80,clss:"ghost",size:1,nu:b.createGhost},
{name:"Harbor",strID:"e_harbor",resistance:80,health:800,maxHealth:800,img:m.euro_harbor,invType:1,invMax:0,validator:Xf,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:m.build_harbor,dimg:m.des_harbor,zLevel:1,race:"euro",dieSound:N,iconID:63,icons:[b.createFishingBoat,b.createXebec,b.createHulk,b.createGalleon,b.techLandingTactics],clss:"harbor",url:m.euro_harbor,storage:4,build:!0,cost:[0,200,200,0],child:[{img:m.euro_harbor_c,x:0,y:0},{img:m.euro_harbor_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],
time:60,sight:8},{radix:0,name:"Messiah",strID:"messiah",attack:50,defence:10,mana:1E3,manaMax:1E3,health:1E3,maxHealth:1E3,img:m.messiah,invType:0,invMax:0,race:"common",validator:U,human:1,iconID:169,zLevel:1,attackSound:["messiah_attack"],dieSound:["messiah"],time:300,sight:26,url:m.messiah,standardFunc:x,icons:e,cost:[2E3,0,0,0],attDist:10,spd:50,clss:"messiah",size:1,update:["mana","manaSpeed",1E3]},{name:"Magic Gateway",sound:["gateway"],strID:"gateway",magicGateway:1,resistance:0,health:Infinity,
maxHealth:Infinity,img:m.teleport,invMax:0,validator:O,bimg:m.build4x4,zLevel:1,dieSound:N,race:"common",iconID:180,clss:"magic_gateway",icons:[b.createOrk,b.createDwarf,b.createGhost,b.createSkeleton],space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,5]),url:m.teleport,build:!0,cost:[0,0,0,0],size:1,time:10,sight:10,zolotoy:1,child:[{img:m.teleport_c,x:0,y:0},{alpha:!0,img:m.teleport_s,x:0,y:0,rgb:[0,0,0,.5]}],standardFunc:im},{name:"Guard Tower",strID:"guard_tower",race:"common",
clss:"guard_tower",attackSound:Fe,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:12,health:1E3,maxHealth:1E3,img:m.euro_tower_wood,state:0,invType:1,invMax:0,dieSound:N,zLevel:1,validator:O,child:[{img:m.euro_tower_wood_c,x:0,y:0},{alpha:!0,img:m.euro_tower_wood_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:12,bimg:m.build2x2,dimg:m.des_2x2,iconID:52,icons:[b.attack,b.stop,b.upgradeStoneTower,b.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:m.euro_tower_wood,build:!0,cost:[0,600,0,
0],size:1,arrow:!0,attimg:m.arrow1,time:35,sight:16,standardFunc:x},{name:"Sword",attack:0,defence:0,health:25,maxHealth:25,img:m.items1,state:0,invMax:0,validator:Gb,iconID:16,url:m.items1,icons:[],cost:[0,0,0,0],size:1,zLevel:0,z32:.5,radix:0,race:"common",item:1},{name:"Bow",attack:0,defence:0,health:25,maxHealth:25,img:m.items1,state:0,invMax:0,validator:Gb,iconID:4,url:m.items1,icons:[],cost:[0,0,0,0],size:1,z32:.5,zLevel:0,radix:0,race:"common",item:1},{name:"Shield",attack:0,defence:0,health:25,
maxHealth:25,img:m.items1,state:0,invMax:0,validator:Gb,iconID:1,url:m.items1,icons:[],cost:[0,0,0,0],zLevel:0,race:"common",radix:0,size:1,z32:.5,item:1},{name:"Potion",attack:0,defence:0,health:25,maxHealth:25,img:m.potions,state:0,invMax:0,validator:Gb,iconID:11,url:m.potions,icons:[],radix:0,race:"common",zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Book",attack:0,defence:0,health:25,maxHealth:25,img:m.book1,state:0,invMax:0,validator:Gb,iconID:9,zLevel:0,race:"common",radix:0,url:m.books,
icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Gold",health:1,maxHealth:1,img:m.item_gold,invMax:0,validator:Gb,iconID:20,radix:0,race:"common",zLevel:0,url:m.item_gold,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Stone",health:1,maxHealth:1,img:m.item_stone,invMax:0,validator:Gb,iconID:22,race:"common",radix:0,url:m.item_stone,zLevel:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Food",health:15,maxHealth:15,img:m.item_food,invMax:0,mMapcolor:[0,255,255],validator:Gb,iconID:14,
url:m.item_food,radix:0,race:"common",icons:[],zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{ignore:1,name:"Wood",health:1,maxHealth:1,img:m.item_wood,invMax:0,validator:Gb,iconID:15,url:m.item_wood,icons:[],race:"common",radix:0,zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Iron",health:1,maxHealth:1,img:m.item_iron,invMax:0,validator:Gb,iconID:21,zLevel:0,race:"common",url:m.item_iron,radix:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Keep Tower",strID:"keep_tower",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),
attack:16,health:2E3,maxHealth:2E3,img:m.euro_tower_stone,state:0,invType:1,zLevel:1,attackSound:Fe,invMax:0,dieSound:N,validator:O,clss:"keep_tower",race:"common",child:[{alpha:!0,img:m.euro_tower_stone_s,x:0,y:0,rgb:[0,0,0,.5]},{img:m.euro_tower_stone_c,x:0,y:0}],attDist:14,bimg:m.build2x2,dimg:m.des_2x2,standardFunc:x,iconID:54,icons:[b.attack,b.stop,b.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:m.euro_tower_stone,build:!0,cost:[0,600,0,0],size:1,arrow:!0,attimg:m.arrow_big1,time:40,
sight:18},{name:"Cannon Tower",clss:"tower_stone2",strID:"tower_stone2",attackSound:Ed,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:40,health:2500,maxHealth:2500,img:m.euro_tower_stone_2,state:0,invType:1,invMax:0,dieSound:N,race:"common",validator:O,zLevel:1,child:[{img:m.euro_tower_stone_2_c,x:0,y:0},{alpha:!0,img:m.euro_tower_stone_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:10,bimg:m.build2x2,dimg:m.des_2x2,iconID:54,icons:[b.attack,b.stop],space:new Uint8Array([1,1,1,1,2]),url:m.euro_tower_stone_2,
build:!0,cost:[0,600,0,0],standardFunc:x,size:1,arrow:!1,attimg:m.hot_cannon,time:45,sight:18,attackDeg:30},{name:"Rocket Tower",strID:"tower_rocket",race:"asia",clss:"tower_rocket",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),zLevel:1,attack:30,health:1400,maxHealth:1400,img:m.rocket_tower,state:0,invType:1,invMax:0,dieSound:N,validator:O,child:[{img:m.rocket_tower_c},{alpha:!0,img:m.rocket_tower_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:20,bimg:m.build2x2,dimg:m.des_2x2,iconID:186,icons:[],space:new Uint8Array([1,
1,1,1,2]),url:m.rocket_tower,build:!0,cost:[0,600,0,0],standardFunc:x,size:1,arrow:!0,attimg:m.arrow_big1,time:60,sight:26},{radix:0,name:"Ork",race:"common",strID:"ork",dieSound:["orc%20die%201","orc%20die%202"],attackSound:Qi,attack:18,defence:2,health:75,maxHealth:75,img:m.ork,invType:0,invMax:8,validator:U,zLevel:1,iconID:143,time:12,sight:5,url:m.ork,standardFunc:x,icons:e,cost:[60,0,0,0],attDist:1,spd:50,clss:"ork",size:1,nu:b.createOrk},{radix:0,name:"Dwarf",race:"common",attack:7,defence:7,
health:120,maxHealth:120,img:m.dwarf,invType:0,strID:"dwarf",invMax:8,zLevel:1,dieSound:bb,validator:U,iconID:185,time:12,sight:3,url:m.dwarf,standardFunc:x,icons:e,cost:[80,0,0,0],attDist:1,spd:50,clss:"dwarf",size:1,nu:b.createDwarf},{radix:0,name:"Skeleton",strID:"skeleton",race:"common",dieSound:["skeleton%20die%201","skeleton%20die%202","skeleton%20die%203","skeleton%20die%204"],attack:4,defence:0,health:40,maxHealth:40,img:m.skeleton,invType:0,zLevel:1,attackSound:Yb,invMax:8,nofreeze:1,validator:U,
iconID:167,time:12,sight:3,url:m.skeleton,standardFunc:x,icons:e,cost:[0,0,30,0],attDist:1,spd:50,clss:"skeleton",size:1,nu:b.createSkeleton},{radix:0,name:"Caravan",race:"euro",strID:"e_caravan",attack:0,defence:0,health:350,maxHealth:350,img:m.caravan,invType:1,invMax:8,validator:U,iconID:34,zLevel:1,time:50,sight:7,url:m.caravan,icons:[b.move,b.trade,b.explore,b.stop,b.stand,b.unload],cost:[0,200,400,0],attDist:1,spd:75,clss:"caravan",size:1,nu:b.createCaravan},{name:"Castle",health:8E3,maxHealth:8E3,
img:m.asia_castle,invType:1,strID:"a_castle",zLevel:1,race:"asia",invMax:50,validator:O,bimg:m.build6x6,dimg:m.des_6x6,iconID:164,time:120,sight:12,dieSound:N,clss:"castle",child:[{img:m.asia_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:m.asia_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[b.createPeon1,b.createNinja,b.emergeAllUnits,b.techFeudalism,b.techArchitecture,b.techLearning,b.techBuddhism,b.techGreatWall],space:new Uint8Array([0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,0,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,0,0,8]),menu:Ga,url:m.asia_castle,build:!0,cost:[0,1500,0,1500],storage:4,castle:!0,population:20,size:1},{name:"Castle",dieSound:N,clss:"castle",strID:"r_castle",race:"arab",health:8E3,maxHealth:8E3,img:m.arab_castle,invType:1,invMax:50,validator:O,bimg:m.build6x6,dimg:m.des_6x6,zLevel:1,iconID:97,time:120,sight:12,child:[{img:m.arab_castle_c}],icons:[b.createPeon2,b.createSpy,b.emergeAllUnits,b.techFeudalism,b.techArchitecture,b.techLearning,b.techSlavery],
space:new Uint8Array([0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,0,0,0,1,0,0,0,,8]),menu:Ga,url:m.arab_castle,build:!0,cost:[0,1500,0,1500],storage:4,castle:!0,population:20,size:1},{radix:0,name:"Peasant",attack:5,defence:0,health:50,maxHealth:50,img:m.asian_peasant,invType:0,invMax:8,attackSound:Pg,race:"asia",validator:U,human:1,strID:"a_peon",iconID:132,dieSound:bb,zLevel:1,time:8,peon:1,sight:5,url:m.asian_peasant,icons:[b.move,
b.menuBuilds1,b.repair,b.conquest,b.dcm,b.pickUp,b.explore,b.stop,b.stand,b.attack,b.sameSpeed,b.restoreSpeed],cost:[0,0,40,0],attDist:1,spd:50,clss:"peon",nocapture:1,size:1},{radix:0,name:"Ninja",race:"asia",attack:12,defence:5,mana:100,manaMax:100,health:90,maxHealth:90,img:m.asian_ninja,invType:0,invMax:8,attackSound:Yb,validator:U,human:1,iconID:133,strID:"ninja",dieSound:bb,zLevel:1,time:20,standardFunc:x,sight:10,url:m.asian_ninja,icons:[b.guard,b.patrol,b.pickUp,b.explore,b.stop,b.stand,b.invisibility,
b.murder,b.move,b.attack,b.sameSpeed,b.restoreSpeed],cost:[120,0,0,0],attDist:1,spd:85,clss:"ninja",size:1,update:["mana","manaSpeed",1E3]},{radix:0,name:"Ronin",attack:7,defence:0,health:45,maxHealth:45,img:m.asian_ronin,invType:0,invMax:8,race:"asia",validator:U,human:1,standardFunc:x,iconID:141,strID:"ronin",dieSound:bb,zLevel:1,time:8,sight:5,url:m.asian_ronin,icons:e,cost:[0,0,40,0],attDist:1,spd:50,attackSound:Yb,clss:"a_footman",size:1},{radix:0,name:"Archer",attack:5,defence:0,health:50,maxHealth:50,
img:m.asian_archer,invType:0,invMax:8,race:"asia",validator:U,human:1,strID:"a_archer",dieSound:bb,zLevel:1,attimg:m.arrow1,iconID:136,arrow:1,attackSound:Vc,time:12,sight:10,url:m.asian_archer,icons:e,cost:[0,20,40,0],standardFunc:x,spd:50,clss:"archer",size:1,attDist:6},{radix:0,name:"Samurai",attack:10,defence:4,health:90,maxHealth:90,img:m.asian_samurai,invType:0,race:"asia",strID:"samurai",invMax:8,attackSound:Yb,validator:U,human:1,iconID:142,time:20,standardFunc:x,zLevel:1,dieSound:bb,sight:6,
url:m.asian_samurai,icons:e,cost:[50,0,150,0],attDist:1,spd:50,clss:"a_maceman",size:1},{radix:0,name:"Horse Archer",attack:7,defence:0,health:75,maxHealth:75,img:m.asian_horsarcher,invType:0,race:"asia",invMax:8,validator:U,human:1,attackSound:Vc,iconID:183,strID:"a_horse_archer",dieSound:Fd,time:20,standardFunc:x,sight:12,url:m.asian_horsarcher,zLevel:1,icons:e,arrow:1,attimg:m.arrow1,cost:[40,0,120,0],spd:85,clss:"horse_archer",size:1,attDist:7},{radix:0,name:"Horse Samurai",attack:14,defence:4,
health:160,maxHealth:160,img:m.asian_horsamurai,invType:0,invMax:8,validator:U,human:1,iconID:135,race:"asia",standardFunc:x,attackSound:Dd,time:22,zLevel:1,strID:"horse_samurai",dieSound:Fd,sight:5,url:m.asian_horsamurai,icons:e,cost:[75,0,120,0],attDist:1,spd:85,clss:"horse_samurai",size:1},{name:"Barracks",resistance:500,health:1400,maxHealth:1400,img:m.asia_barracks,invType:1,sound:Qg,invMax:0,time:60,dieSound:N,radix:0,sight:6,race:"asia",strID:"a_barrack",validator:O,zLevel:1,bimg:m.build5x5,
dimg:m.des_5x5,child:[{img:m.asia_barracks_c,x:0,y:0,mv:!0},{img:m.asia_barracks_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:146,icons:[b.createRonin,b.createArcher1,b.createSamurai,b.createHorseArcher1,b.createHorseSamurai,b.createChariot],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:m.asia_barracks,build:!0,cost:[0,200,0,200],size:1,clss:"barracks"},{name:"Chariot",attack:4,defence:3,health:180,maxHealth:180,img:m.asian_charriot,invType:0,radix:0,race:"asia",invMax:8,
strID:"chariot",dieSound:["c%20die%201","c%20die%202","c%20die%203","c%20die%204","c%20die%205"],attackSound:Dd,validator:U,human:1,zLevel:1,iconID:175,standardFunc:x,time:8,sight:5,url:m.asian_charriot,icons:e,cost:[0,200,150,0],attDist:1,spd:85,clss:"chariot",size:1},{radix:1,name:"Galleon",attackSound:Ed,attack:35,attDist:12,race:"common",defence:0,health:1200,attackTime:2E3,maxHealth:1200,strID:"galleon",nu:b.createGalleon,img:m.galleon,invType:1,invMax:24,dieSound:["ship%20sink"],zLevel:0,validator:le,
iconID:32,time:50,boat:!0,attimg:m.cb_metal,attackDeg:20,sight:16,url:m.galleon,icons:[b.move,b.explore,b.unload,b.attack,b.attackGround,b.stop,b.stand,b.stop,b.stand,b.attack,b.steady,b.upgradeShip],cost:[0,1200,800,0],spd:50,nofreeze:1,clss:"galleon",standardFunc:x,size:1,peon:1},{radix:1,name:"Fishing Boat",attackSound:Ed,attack:0,attDist:8,race:"common",defence:0,health:50,boat:!0,nu:b.createFishingBoat,maxHealth:50,img:m.boat,invType:1,invMax:0,strID:"fishing_boat",dieSound:["ship%20sink"],zLevel:0,
validator:le,iconID:184,nofreeze:1,time:50,sight:16,url:m.boat,icons:[b.move,b.explore,b.stop,b.stand,b.fishing],cost:[0,200,100,0],spd:65,clss:"fishing_boat",size:1},{radix:1,name:"Hulk",attackSound:Ed,attack:18,attDist:10,race:"common",defence:0,health:700,maxHealth:700,strID:"hulk",img:m.hulk,invType:1,attackTime:2E3,boat:!0,nu:b.createHulk,attackDeg:20,invMax:16,dieSound:["ship%20sink"],zLevel:0,validator:le,iconID:128,time:30,sight:14,attimg:m.cb_metal,url:m.hulk,icons:[b.move,b.explore,b.unload,
b.attack,b.attackGround,b.stop,b.stand,b.stop,b.stand,b.attack,b.steady,b.upgradeShip],cost:[0,500,300,0],spd:65,nofreeze:1,clss:"hulk",standardFunc:x,size:1},{radix:1,name:"Pinque",attackSound:Vc,attack:10,race:"common",attDist:8,defence:0,health:300,boat:!0,maxHealth:300,img:m.xebec,attimg:m.arrow1,arrow:!0,strID:"pinque",invType:1,invMax:8,dieSound:["ship%20sink"],zLevel:0,validator:le,iconID:129,time:20,nofreeze:1,sight:12,url:m.xebec,icons:[b.move,b.explore,b.unload,b.attack,b.attackGround,b.stop,
b.stand,b.stop,b.stand,b.attack,b.steady,b.upgradeShip],cost:[0,300,200,0],spd:80,clss:"xebec",size:1,standardFunc:x,nu:b.createXebec},{radix:0,name:"Stone Golem",strID:"troll",defence:3,attack:25,health:400,maxHealth:400,img:m.troll,invType:0,invMax:0,dieSound:["golem"],validator:U,iconID:144,race:"common",zLevel:1,nofreeze:1,attackSound:["golem1","golem2"],sight:10,standardFunc:x,url:m.troll,icons:e,w:1,cost:[120,0,0,0,600],attDist:1,spd:56,clss:"troll",size:1},{radix:0,name:"Bat",strID:"bat",defence:0,
attack:3,health:20,maxHealth:20,img:m.bat,invType:0,invMax:0,race:"common",bat:1,dieSound:["bat%20die"],validator:Yf,iconID:105,zLevel:2,attackSound:["bat%20attack"],sight:10,standardFunc:x,url:m.bat,icons:e,w:1,cost:[0,0,0,0,25],attDist:1,spd:128,clss:"bat",size:1,z32:1.5},{race:"arab",invType:0,invMax:8,iconID:138,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_peasant,img:m.arab_peasant,spd:50,validator:U,human:1,icons:[b.move,b.menuBuilds2,b.repair,b.conquest,b.dcm,b.pickUp,b.explore,
b.stop,b.stand,b.attack,b.convertJihad,b.bribe,b.sameSpeed,b.restoreSpeed],name:"Peasant",clss:"peon",cost:[0,0,50,0],attDist:1,time:8,nocapture:1,peon:1,sight:5,health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:172,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_footman,img:m.arab_footman,standardFunc:x,spd:50,validator:U,human:1,attDist:1,icons:e,name:"Footman",clss:"footman",cost:[0,0,50,0],time:12,sight:5,health:50,attack:6,defence:1},{race:"arab",invType:0,invMax:8,
iconID:170,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_archer,img:m.arab_archer,spd:50,validator:U,standardFunc:x,human:1,attimg:m.arrow1,arrow:1,icons:e,name:"Archer",clss:"archer",cost:[0,20,40,0],time:12,sight:10,attDist:6,health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:173,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_spearman,img:m.arab_spearman,spd:50,validator:U,standardFunc:x,human:1,icons:e,name:"Spearman",clss:"pikeman",attDist:1,cost:[40,
0,60,0],time:14,sight:5,health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:174,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,standardFunc:x,url:m.arab_satrap,img:m.arab_satrap,spd:50,validator:U,human:1,icons:e,name:"Satrap",attDist:1,clss:"maceman",cost:[0,0,120,0],time:14,sight:5,health:120,attack:8,defence:0},{race:"arab",invType:0,invMax:8,iconID:171,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_cavalry,standardFunc:x,img:m.arab_cavalry,spd:85,validator:U,
human:1,attDist:1,icons:e,name:"Cavalry",clss:"heavy_cavalry",cost:[60,0,100,0],time:14,sight:5,health:90,attack:10,defence:4},{race:"arab",invType:0,invMax:8,iconID:168,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_horse_archer,img:m.arab_horse_archer,spd:85,validator:U,human:1,standardFunc:x,icons:e,name:"Horse Archer",clss:"horse_archer",cost:[50,0,100,0],time:14,attimg:m.arrow1,arrow:1,sight:12,attDist:7,health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:179,
zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_jwarrior,img:m.arab_jwarrior,spd:50,validator:U,human:1,standardFunc:x,icons:e,name:"Jihad warrior",attDist:1,clss:"jihad_warrior",cost:[0,0,100,0],time:8,sight:5,health:75,attack:10,defence:2},{race:"arab",invType:0,invMax:8,iconID:176,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_priest,img:m.arab_priest,standardFunc:x,spd:50,mana:100,validator:U,human:1,icons:d,name:"Priest",clss:"priest",cost:[150,0,0,0],time:30,sight:21,
attDist:18,health:60,attack:20,update:["mana","manaSpeed",1E3],manaMax:100,defence:0,attimg:m.flame_bolt,ball:1,attackOnly:ke.magic_creatures.obj},{race:"arab",invType:0,invMax:0,iconID:105,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:0,img:0,testing:1,illegal:1,spd:50,validator:U,human:1,icons:[],name:"Spy",clss:"spy",cost:150,time:30,sight:12,health:50,attack:20,defence:0},{race:"arab",invType:0,invMax:8,iconID:188,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,attimg:m.flame_bolt,
url:m.arab_mage,img:m.arab_mage,spd:50,validator:U,human:1,icons:[b.stop,b.pickUp,b.explore,b.createCarpet,b.createJinn,b.fireRain,b.magicVision,b.raiseDead,b.attack,b.stand,b.move],standardFunc:x,name:"Mage",clss:"mage",ball:1,mana:100,manaMax:100,update:["mana","manaSpeed",1E3],cost:[150,0,0,0],time:30,sight:15,attDist:10,health:60,attack:8,defence:0},{race:"arab",invType:1,invMax:8,iconID:126,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_caravan,img:m.arab_caravan,spd:75,validator:U,
human:1,icons:[],name:"Caravan",clss:"trader",cost:[0,0,500,0],time:30,sight:5,health:150},{race:"arab",invType:0,invMax:8,iconID:177,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.arab_enichar,img:m.arab_enichar,spd:85,validator:U,human:1,standardFunc:x,icons:e,name:"Enichar",attDist:1,clss:"enichar",cost:[80,0,120,0],time:25,sight:5,health:130,attack:18,defence:4},{race:"arab",invType:1,invMax:0,iconID:82,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,
dimg:m.des_3x3,radix:0,population:10,url:m.arab_houses,validator:O,build:1,icons:[],child:[{img:m.arab_houses_c}],name:"House",clss:"house",cost:[0,75,0,0],time:20,sight:4,resistance:50,health:500},{race:"arab",invType:1,invMax:0,iconID:85,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:m.arab_lumbermill,validator:O,build:1,icons:[b.techWoodCutting,b.techCrossbow],child:[{img:m.arab_lumbermill_c}],name:"Lumber Mill",clss:"lumber",cost:[0,
100,0,0],storage:1,time:30,sight:4,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:96,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_storage,validator:O,build:1,storage:0,icons:[b.techGoldMining,b.techStoneMining],child:[{img:m.arab_storage_c},{alpha:!0,img:m.arab_storage_s,rgb:[0,0,0,.5]}],name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,
invMax:0,iconID:80,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_farm,validator:O,build:1,icons:[b.createCow,b.techCropRotation,b.techDomestication,b.techCowPoaching,b.ridingHorses,b.techHorseManShip],child:[{img:m.arab_farm_c}],name:"Farm",storage:2,clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:81,zLevel:1,dieSound:N,validator:Xf,space:new Uint8Array([1,
1,0,0,1,1,1,1,1,1,1,1,4]),bimg:m.build_harbor,dimg:m.des_harbor,radix:0,url:m.arab_harbour,build:1,icons:[b.createFishingBoat,b.createXebec,b.createHulk,b.techLandingTactics],child:[{img:m.arab_harbour_c},{alpha:!0,img:m.arab_harbour_s,rgb:[0,0,0,.5]}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,iconID:79,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:m.arab_blacksmith,
validator:O,build:1,icons:[b.techTemperIron,b.techScaleArmor,b.techScimitar,b.techChainMail,b.techHalberd],child:[{img:m.arab_blacksmith_c},{alpha:!0,img:m.arab_blacksmith_s,rgb:[0,0,0,.5]}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,150,0],onbuild:g,time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:95,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_workshop,validator:O,build:1,icons:[b.createCatapult,
b.createBallist,b.techEngineering,b.techCannonTower],child:[{img:m.arab_workshop_c},{alpha:!0,img:m.arab_workshop_s,rgb:[0,0,0,.5]}],name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:140,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:m.arab_church,validator:O,build:1,icons:[b.createPriest2],child:[{img:m.arab_church_c},{alpha:!0,img:m.arab_church_s,rgb:[0,0,
0,.5]}],name:"Church",clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"arab",invType:1,invMax:0,iconID:92,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_tavern,validator:O,build:1,icons:[b.createMercenaries,b.createHeroes],child:[{img:m.arab_tavern_c}],name:"Tavern",clss:"tavern",cost:[0,200,200,0],onbuild:f,actvintv:[b.iniMercenaries,b.iniHeroes],time:40,sight:5,resistance:150,health:1E3},
{race:"arab",invType:1,invMax:0,iconID:87,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_market,validator:O,build:1,icons:[b.createCaravan2],child:[{img:m.arab_market_c}],name:"Market",clss:"market",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,iconID:98,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:m.build5x5,dimg:m.des_5x5,
radix:0,url:m.arab_barracks,validator:O,build:1,icons:[b.createFootman2,b.createArcher2,b.createSatrap,b.createPikeman2,b.createHorseArcher2,b.createCavalry,b.createEnichar,b.createJihad],child:[{img:m.arab_barracks_c},{alpha:!0,img:m.arab_barracks_s,rgb:[0,0,0,.5]}],name:"Barracks",clss:"barrack",cost:[0,0,200,200],time:60,sight:6,resistance:500,health:1400},{race:"arab",invType:1,invMax:0,iconID:91,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,
radix:0,url:m.arab_stables,validator:O,build:1,icons:[],child:[{img:m.arab_stables_c}],name:"Stable",clss:"stable",cost:[0,200,200,0],time:40,onbuild:h,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:50,iconID:89,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.arab_outpost,validator:O,build:1,icons:[b.emergeAllUnits],child:[{img:m.arab_outpost_c,mv:1},{alpha:!0,img:m.arab_outpost_s,rgb:[0,0,0,.5]}],name:"Outpost",
clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},{race:"arab",invType:1,invMax:0,iconID:105,zLevel:1,dieSound:N,bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:0,img:0,validator:O,build:1,icons:[],child:[{img:3213123}],name:"NULL",testing:1,clss:"castle",cost:[0,1500,0,1500],time:120,sight:12,resistance:1E3,health:8E3},{race:"arab",invType:1,invMax:0,iconID:88,zLevel:1,dieSound:N,space:new Uint8Array([0,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,0,6]),
bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.arab_mosque,validator:O,build:1,icons:[b.techFanaticism,b.techEspionage,b.techHealing,b.techBless,b.techJihad],child:[{img:m.arab_mosque_c},{alpha:!0,img:m.arab_mosque_s,rgb:[0,0,0,.5]}],name:"Mosque",onbuild:[b.buildChurch2],clss:"mosque",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:86,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,
url:m.arab_magetower,validator:O,build:1,icons:[b.createMage2,b.techCarpet,b.techMagicWorkshop,b.techFireRain,b.techMagicVision,b.techNecromancy,b.techJinn],child:[{img:m.arab_magetower_c},{alpha:!0,img:m.arab_magetower_s,rgb:[0,0,0,.5]}],name:"Mage Guild",clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:93,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,5]),bimg:m.build5x5,dimg:m.des_5x5,
radix:0,url:m.arab_tc_guild,validator:O,build:1,icons:[b.techUsury,b.techTradeRoutes,b.techSupplyStorage,b.techBribery,b.techOreFloatation],child:[{img:m.arab_tcguild_c},{alpha:!0,img:m.arab_tc_guild_s,rgb:[0,0,0,.5]}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,0,2E3],time:90,onbuild:[b.buildMarket2],sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:94,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:m.build5x5,dimg:m.des_5x5,
radix:0,url:m.arab_waracademy,validator:O,build:1,icons:[b.techHeroism,b.techWarfare,b.techMercenaries,b.techRiddingHorses,b.techBodyBuilding,b.techLeadership,b.techHeroes,b.techJanissary,b.techHonor,b.techFame],child:[{img:m.arab_waracademy_c},{alpha:!0,img:m.arab_waracademy_s,rgb:[0,0,0,.5]}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:158,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),
bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:m.arab_magicworkshop,validator:O,build:1,icons:[b.createObjects],child:[{img:m.arab_magicworkshop_c},{alpha:!0,img:m.arab_magicworkshop_s,rgb:[0,0,0,.5]}],name:"Magic Workshop",disallowPoint:!0,clss:"magicworkshop",cost:[0,0,0,300],time:20,sight:5,resistance:200,health:1200},{race:"asia",invType:1,invMax:0,iconID:161,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,0,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:m.asia_houses,validator:O,build:1,
icons:[],child:[{img:m.asia_houses_c}],name:"House",clss:"house",cost:[0,75,0,0],population:10,time:20,sight:4,resistance:50,health:500},{race:"asia",invType:1,invMax:0,iconID:149,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,storage:1,url:m.asia_lumbermill,validator:O,build:1,icons:[b.techWoodCutting,b.techCrossbow],child:[{img:m.asia_lumbermill_c},{img:m.asia_lumbermill_s,rgb:[0,0,0,.5],alpha:!0}],name:"Lumber Mill",clss:"lumber",cost:[0,
100,0,0],time:30,sight:4,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:154,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.asia_storage,storage:0,validator:O,build:1,icons:[b.techGoldMining,b.techStoneMining],child:[{img:m.asia_storage_s,rgb:[0,0,0,.5],alpha:!0},{img:m.asia_storage_c}],name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,
iconID:147,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,storage:2,url:m.asia_farm,validator:O,build:1,icons:[b.techCropRotation,b.ridingHorses,b.irrigation],child:[{img:m.asia_farm_c}],name:"Farm",clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:148,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,1,1,1,1,1,3]),validator:Xf,bimg:m.build_harbor,dimg:m.des_harbor,radix:0,
url:m.asia_harbor,build:1,icons:[b.createFishingBoat,b.createXebec,b.createHulk,b.techLandingTactics],child:[{img:m.asia_harbor_c},{img:m.asia_harbor_s,rgb:[0,0,0,.5],alpha:!0}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:145,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.asia_blacksmith,validator:O,build:1,icons:[b.techTemperIron,
b.techScaleArmor,b.techArmoredChariot,b.techChainMail],child:[{img:m.asia_blacksmith_c},{img:m.asia_blacksmith_s,rgb:[0,0,0,.5],alpha:!0}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,150,0],time:40,sight:5,onbuild:g,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:157,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.asia_workshop,validator:O,build:1,icons:[b.createCatapult,b.createBallist,b.techEngineering,
b.techCannonTower],child:[{img:m.asia_workshop_c,x:0,y:0},{img:m.asia_workshop_s,rgb:[0,0,0,.5],alpha:!0}],name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:162,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,0,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,1,0,0,1,1,0,5]),bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.asian_monastery,validator:O,build:1,icons:[b.createMonk,b.createPriest1],child:[{img:m.asian_monastery_c},{img:m.asian_monastery_s,
rgb:[0,0,0,.5],alpha:!0}],name:"Monastery",clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"asia",invType:1,invMax:0,iconID:155,zLevel:1,dieSound:N,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.asia_tavern,validator:O,build:1,icons:[b.createMercenaries,b.createHeroes],child:[{img:m.asia_tavern_c},{img:m.asia_tavern_s,rgb:[0,0,0,.5],alpha:!0}],onbuild:f,name:"Tavern",clss:"tavern",actvintv:[b.iniMercenaries,
b.iniHeroes],cost:[0,200,200,0],time:40,sight:5,resistance:150,health:1E3},{race:"asia",invType:1,invMax:0,iconID:150,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.asia_market,validator:O,build:1,icons:[],child:[{img:m.asia_market_c}],name:"Market",clss:"market",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:153,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,0,1,1,1,
1,1,1,1,1,1,1,1,1,4]),bimg:m.build4x4,dimg:m.des_4x4,radix:0,url:m.asia_stables,validator:O,build:1,icons:[],child:[{img:m.asia_stables_c,mv:!0},{img:m.asia_stables_s,rgb:[0,0,0,.5],alpha:!0}],name:"Stable",clss:"stable",onbuild:h,cost:[0,200,200,0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:151,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:m.build3x3,dimg:m.des_3x3,radix:0,url:m.asia_outpost,validator:O,build:1,icons:[b.emergeAllUnits],
child:[{img:m.asia_outpost_c,mv:1},{img:m.asia_outpost_s,rgb:[0,0,0,.5],alpha:!0}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},{race:"asia",invType:1,invMax:0,iconID:163,zLevel:1,dieSound:N,space:new Uint8Array([0,0,1,1,0,0,0,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,0,6]),bimg:m.build6x6,dimg:m.des_6x6,radix:0,url:m.asia_shao_lin,validator:O,build:1,icons:[b.techMeditation,b.techKungFu,b.techHealing,b.techPhilosophy,b.techNinjas,b.techMastery,
b.techTournaments,b.techMedicine],child:[{img:m.asia_shao_lin_c},{img:m.asia_shao_lin_s,rgb:[0,0,0,.5],alpha:!0}],name:"Shao Linn",onbuild:[b.buildChurch1],clss:"shaolinn",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:152,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.asia_wizardguild,validator:O,build:1,icons:[b.createMage1,b.techConcentration,b.techWhirlpool,
b.techFlameBolt,b.techTurnToStone,b.techConfusion,b.techDragon],child:[{img:m.asia_wizardguild_c},{img:m.asia_wizardguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Mage Guild",clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:159,zLevel:1,dieSound:N,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.asia_tcguild,validator:O,build:1,icons:[b.techTradeRoutes,b.techUsury,
b.techJewelry,b.techSupplyStorage,b.techBanking,b.techChemistry,b.techSeaFood,b.techGunPowder,b.techRocketArrow],child:[{img:m.asia_tcguild_c,mv:!0},{img:m.asia_tcguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,0,2E3],time:90,onbuild:[b.buildMarket1],sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:156,zLevel:1,dieSound:N,space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:m.build5x5,dimg:m.des_5x5,radix:0,url:m.asia_warguild,
validator:O,build:1,icons:[b.techBushido,b.techHeroism,b.techWarfare,b.techMercenaries,b.techLeadership,b.techTactics,b.techHeroes,b.techHonor,b.techSunTzu],child:[{img:m.asia_warguild_c,mv:!0},{img:m.asia_warguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:0,invMax:0,iconID:166,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.asian_priest,img:m.asian_priest,spd:50,validator:U,human:1,
icons:[b.attack,b.stop,b.stand,b.pickUp,b.explore,b.healing,b.teach,b.move],name:"Priest",clss:"priest",cost:[170,0,0,0],time:30,sight:21,health:120,standardFunc:x,attDist:1,attack:10,defence:10,mana:100,update:["mana","manaSpeed",1E3],manaMax:100},{race:"asia",invType:0,invMax:0,iconID:187,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.asian_monk,img:m.asian_monk,spd:50,validator:U,human:1,icons:e,name:"Monk",standardFunc:x,clss:"monk",cost:[0,0,200,0],time:20,sight:5,health:90,attack:6,
defence:6,attDist:1},{race:"asia",invType:0,invMax:0,iconID:134,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:m.asian_mage,img:m.asian_mage,spd:50,attimg:m.flame_bolt,validator:U,standardFunc:x,human:1,icons:[b.stop,b.pickUp,b.explore,b.confusion,b.turnToStone,b.whirlpool,b.flameBolt,b.createDragon,b.attack,b.stand,b.move],name:"Mage",clss:"mage",cost:[150,0,0,0],ball:1,time:30,sight:15,mana:100,attDist:10,health:60,attack:8,defence:0,update:["mana","manaSpeed",1E3],manaMax:100},{radix:0,
name:"Dragon",strID:"dragon",defence:0,attack:25,health:300,maxHealth:300,img:m.dragon,invType:0,invMax:0,dieSound:[],sSizex:2,sSizey:2,dragon:1,iconID:160,race:"common",zLevel:2,nofreeze:1,attackSound:[],sight:12,standardFunc:x,url:m.dragon,icons:e,cost:[80,0,0,0,800],attDist:2,spd:128,clss:"drg",size:1,z32:1.5,validator:Yf},{radix:0,name:"Carpet",strID:"carpet",defence:0,attack:0,health:90,maxHealth:90,img:m.carpet,invType:1,invMax:8,dieSound:[],iconID:131,race:"common",zLevel:2,nofreeze:1,attackSound:[],
sight:8,url:m.carpet,icons:[b.move,b.unload,b.explore,b.stop,b.stand],cost:[80,0,0,0,500],attDist:2,spd:120,clss:"carpet",size:1,z32:1.5,validator:Yf},{radix:0,name:"Jinn",strID:"jinn",defence:5,attack:20,health:300,maxHealth:300,img:m.arab_jinn,invType:0,invMax:0,dieSound:[],validator:U,iconID:182,race:"common",zLevel:1,nofreeze:1,attackSound:[],sight:8,standardFunc:x,url:m.arab_jinn,icons:e,w:1,cost:[80,0,0,0,300],attDist:1,spd:85,clss:"jinn",size:1}];Hd={};$h={arr:[]};pa={euro:[],asia:[],arab:[],
common:[]};Ok=[];cb=[[],[],[],[],[],[]];q=0;for(f=B.length;q<f;q++){l=B[q];B[q].type=q;var w=l.space;l.name.split(" ").join("");l.population&&Ok.put(l);Hd[q]={};void 0!==l.storage&&(-1<l.storage?(0===l.storage&&cb[3].put(q),cb[l.storage].put(q)):(cb[0].put(q),cb[1].put(q),cb[2].put(q),cb[3].put(q)));ua[l.race][l.name.toLowerCase().split(" ").join("")]=l;l.icons.menuName=l.strID;$h[l.name]=q;$h.arr.put(q);l.img||(l.img=l.url);l.maxHealth=l.health;l.race&&pa[l.race].put(l);h=0;d=l.icons;for(k=d.length;h<
k;h++)(g=d[h])&&g.obj&&(g.orderOrigin=l);if(w){h=[];l.free=h;k=w[w.length-1];c=(w.length-1)/k;l=k+2;var A=c+2;d=new Uint8Array(l*A);for(g=0;g<c;g++)for(var v=0;v<k;v++)d[(g+1)*l+v+1]=w[v+g*k];g=0;for(k=l*A;g<k;g++)!d[g]&&(d[g+1]||d[g-1]||d[g+1+l]||d[g+1-l]||d[g-1+l]||d[g-1-l]||d[g+l]||d[g-l])&&(h.put(g%l-1),h.put(~~(g/l)-1))}}pa.euro=pa.euro.concat(pa.common);pa.asia=pa.asia.concat(pa.common);pa.arab=pa.arab.concat(pa.common);pa[0]=pa.euro;pa[1]=pa.arab;pa[2]=pa.asian;d=ua.euro;k=ua.asia;g=ua.arab;
f=ua.common;ua[0]=ua.euro;ua[1]=ua.arab;ua[2]=ua.asia;je||(e.cut=F({a:"attack",g:"guard",r:"patrol",p:"pickUp",e:"explore",s:"stop",n:"stand"}),d.tavern.icons.cut=F({t:"trade1",g:"gamble",m:"createMercenaries",h:"createHeroes",l:"loan"}),d.castle.icons.cut=F({p:"createPeon",s:"createSpy",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning"}),k.castle.icons.cut=F({p:"createPeon1",n:"createNina",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning",b:"techBudhism",
w:"techGreatwall"}),g.castle.icons.cut=F({p:"createPeon2",s:"createSpy",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning",y:"techSlavery"}),d.barracks.icons.cut=F({f:"createFootman",a:"createArcher",m:"createMaceman",p:"createPikeman",l:"createLongbowman",k:"createKnight"}),k.barracks.icons.cut=F({r:"createRonin",a:"createArcher1",s:"createSamurai",h:"createHorseArcher1",o:"createHorseSamurai",c:"createChariot"}),g.barracks.icons.cut=F({f:"createFootman2",a:"createArcher2",
s:"createSatrap",p:"createPikeman2",h:"createHorseArcher2",c:"createCavalry",j:"createEnichar",d:"createJihad"}),d.magetower.icons.cut=F({m:"createMage"}),k.mageguild.icons.cut=F({m:"createMage1"}),g.mageguild.icons.cut=F({m:"createMage2"}),d.peasant.icons.cut=F({b:"menuBuilds",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",i:"bribe"}),g.peasant.icons.cut=F({b:"menuBuilds2",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",j:"become_jihadw",
i:"bribe"}),k.peasant.icons.cut=F({b:"menuBuilds1",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",t:"trade"}),d.priest.icons.cut=F({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",b:"bless"}),g.priest.icons.cut=F({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",b:"bless"}),k.priest.icons.cut=F({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",r:"raiseexp"}),d.wizard.icons.cut=F({m:"move",a:"attack",s:"stop",n:"stand",
l:"lightning",b:"createBat",f:"freeze",t:"createGolem",i:"invisibility"}),g.mage.icons.cut=F({m:"move",a:"attack",s:"stop",n:"stand",c:"spell_spawncarpet",j:"spell_spawnjin",r:"spell_firerain",v:"spell_magicvision",d:"raisedead"}),k.mage.icons.cut=F({m:"move",a:"attack",s:"stop",n:"stand",h:"spell_hypnotize",t:"spell_turntostone",w:"spell_whirlpool",f:"spell_flamebolt",d:"spell_spawndragon"}),f.spy.icons.cut=F({a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",n:"stand",s:"stop"}),k.monk.icons.cut=
F({a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",s:"stop",n:"stand"}),k.ninja.icons.cut=F({a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",s:"stop",n:"stand",c:"cloak",u:"murder"}),f.catapult.icons.cut=F({a:"attack",g:"guard",p:"patrol",e:"explore",s:"stop",n:"stand",r:"attack_ground",h:"hold_steady"}),d.market.icons.cut=F({c:"createCaravan"}),g.market.icons.cut=F({c:"createCaravan2"}),k.market.icons.cut=F({b:"market_items",s:"market_sell"}),d.workshop.icons.cut=F({c:"createCatapult",
h:"createHeavyCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),g.workshop.icons.cut=F({c:"createCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),k.workshop.icons.cut=F({c:"createCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),d.church.icons.cut=F({p:"createPriest"}),g.church.icons.cut=F({p:"createPriest2"}),k.monastery.icons.cut=F({m:"createMonk",p:"createPriest1"}),g.magicworkshop.icons.cut=F({i:"build_item"}),h=F({c:"buildCastle",
s:"buildStorage",b:"buildBarrack",k:"buildBlacksmith",f:"buildFarm",l:"buildLumbermill",p:"buildWorkshop",e:"buildCathedral",u:"buildChurch",n:"buildTavern",m:"buildMageTower",a:"buildStable",r:"buildHarbor",o:"buildOutpost",i:"buildFields",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse",g:"buildGateWood",y:"buildDummy"}),q=F({c:"buildCastle2",k:"buildBlacksmith2",f:"buildFarm2",n:"buildTavern2",b:"buildBarrack2",p:"buildWorkshop2",s:"buildStorage2",a:"buildStable2",l:"buildLumbermill2",
r:"buildHarbor2",o:"buildOutpost2",u:"buildChurch2",e:"buildMosque",i:"buildFields",m:"buildMageTower2",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse2",g:"buildGateWood"}),l=F({c:"buildCastle1",f:"buildFarm1",e:"buildShaolinn",n:"buildTavern1",b:"buildBarrack1",p:"buildWorkshop1",s:"buildStorage1",k:"buildBlacksmith1",a:"buildStable1",l:"buildLumbermill1",r:"buildHarbor1",o:"buildOutpost1",u:"buildChurch1",i:"buildFields",m:"buildMageTower1",w:"buildWoodWall",d:"buildBridge",t:"buildTower",
h:"buildHouse1",g:"buildGateWood"}),Zf.cut=l,$f.cut=l,ag.cut=h,bg.cut=h,cg.cut=h,dg.cut=l,eg.cut=h,fg.cut=l,gg.cut=q,hg.cut=q,ig.cut=q,jg.cut=q,d.lumbermill.icons.cut=F({b:"techLongbow",w:"techWoodCutting",c:"techCrossbow"}),g.lumbermill.icons.cut=F({w:"techWoodCutting",c:"techCrossbow"}),k.lumbermill.icons.cut=F({w:"techWoodCutting",c:"techCrossbow"}),d.blacksmith.icons.cut=F({p:"techPlateArmor",t:"techTemperIron",s:"techScaleArmor",h:"techHalberd",c:"techChainMail"}),g.blacksmith.icons.cut=F({t:"techTemperIron",
a:"techScaleArmor",s:"techScimitar",c:"techChainMail",h:"techHalberd"}),k.blacksmith.icons.cut=F({t:"techTemperIron",a:"techScaleArmor",r:"techArmoredChariot",c:"techChainMail"}),d.outpost.icons.cut=F({e:"emergeAllUnits"}),g.outpost.icons.cut=F({e:"emergeAllUnits"}),k.outpost.icons.cut=F({e:"emergeAllUnits"}),f.watchtower.icons.cut=F({a:"attack",s:"stop",g:"upgradeGuildTower"}),f.guardtower.icons.cut=F({a:"attack",s:"stop",g:"upgradeStoneTower",c:"upgradeCannonTower"}),f.keeptower.icons.cut=F({a:"attack",
s:"stop",c:"upgradeCannonTower"}),f.cannontower.icons.cut=F({a:"attack",r:"attack_ground",s:"stop",h:"holdfire"}),k.rockettower.icons.cut=F({a:"attack",r:"attack_ground",s:"stop",f:"fireatwill"}),d.harbor.icons.cut=F({f:"createFishingBoat",x:"createXebec",h:"createHulk",g:"createGalleon",t:"te_landingtactics"}),g.harbor.icons.cut=F({f:"createFishingBoat",h:"createHulk",x:"createXebec",t:"te_landingtactics"}),k.harbor.icons.cut=F({f:"createFishingBoat",h:"createHulk",x:"createXebec"}),d.farm.icons.cut=
F({c:"createCow",f:"techCropRotation",d:"techDomestication"}),g.farm.icons.cut=F({c:"createCow",f:"techDomestication",d:"techDomestication",p:"techCowPoaching",r:"ridingHorses",h:"techHorseManShip"}),k.farm.icons.cut=F({f:"techDomestication",a:"ridingHorses",i:"irrigation"}),d.storage.icons.cut=F({g:"techGoldMining",s:"techStoneMining"}),g.storage.icons.cut=F({g:"techGoldMining",s:"techStoneMining"}),k.storage.icons.cut=F({g:"techGoldMining",s:"techStoneMining"}),d.cathedral.icons.cut=F({c:"createCrusaders"}),
f.magicgateway.icons.cut=F({o:"createOrk",d:"createDwarf",g:"createGhost",s:"createSkeleton"}));h=[d.knight,k.horsesamurai,g.cavalry,g.enichar,d.crusader,k.chariot,k.horsearcher,g.horsearcher];q=[k.horsesamurai,d.crusader,g.enichar];l=[d.knight,g.cavalry,k.chariot,k.horsearcher,g.horsearcher];e=[d.longbowman,g.archer,k.archer,d.archer];c=[f.catapult,f.ballista,f.heavycatapult];w=[f.galleon,f.hulk,f.pinque,f.fishingboat];A=[f.galleon,f.hulk,f.pinque];v=[g.satrap,d.maceman];var C=[d.longbowman,g.archer,
k.archer,d.archer,k.horsearcher,g.horsearcher,f.pinque,f.watchtower,f.keeptower,f.guardtower],G=[f.stonegolem,f.ork,f.dwarf,f.skeleton,f.ghost,f.dragon,f.jinn,f.bat,d.wizard,g.mage,k.mage],H=[d.peasant,k.peasant,g.peasant,d.footman,g.footman,k.ronin,d.pikeman,g.spearman,g.satrap,d.maceman,g.cavalry,g.jihadwarrior,f.spy,g.enichar,k.horsesamurai,k.monk,k.chariot,k.ninja,f.stonegolem,f.ork,f.dwarf,f.jinn,f.skeleton,f.ghost,d.knight,d.crusader],I=[f.watchtower,f.keeptower,f.guardtower,f.cannontower],
J=[f.cannontower,k.rockettower],R=[d.cathedral,d.castle,f.woodenwall,d.barracks,d.lumbermill,d.magetower,d.warriorsguild,d.storage,d.farm,d.merchantsguild,d.church,d.blacksmith,d.stable,d.workshop,d.tavern,d.house,f.watchtower,d.market,d.outpost,f.bridge,d.harbor,f.guardtower,f.keeptower,f.cannontower,k.rockettower,k.castle,g.castle,k.barracks,g.house,g.lumbermill,g.storage,g.farm,g.harbor,g.blacksmith,g.workshop,g.church,g.tavern,g.market,g.barracks,g.stable,g.outpost,g.mosque,g.mageguild,g.merchantsguild,
g.warriorsguild,g.magicworkshop,k.house,k.lumbermill,k.storage,k.farm,k.harbor,k.blacksmith,k.workshop,k.monastery,k.tavern,k.market,k.stable,k.outpost,k.shaolinn,k.mageguild,k.merchantsguild,k.warriorsguild],S=[d.cathedral,d.castle,f.woodenwall,d.barracks,d.lumbermill,d.magetower,d.warriorsguild,d.storage,d.farm,d.merchantsguild,d.church,d.blacksmith,d.stable,d.workshop,d.tavern,d.house,f.watchtower,d.market,d.outpost,f.bridge,d.harbor,k.castle,g.castle,k.barracks,g.house,g.lumbermill,g.storage,
g.farm,g.harbor,g.blacksmith,g.workshop,g.church,g.tavern,g.market,g.barracks,g.stable,g.outpost,g.mosque,g.mageguild,g.merchantsguild,g.warriorsguild,g.magicworkshop,k.house,k.lumbermill,k.storage,k.farm,k.harbor,k.blacksmith,k.workshop,k.monastery,k.tavern,k.market,k.stable,k.outpost,k.shaolinn,k.mageguild,k.merchantsguild,k.warriorsguild],T=[f.catapult,f.heavycatapult],W=[d.pikeman,g.spearman],X=[k.monk,k.priest],Y=[f.woodenwall],aa=[d.peasant,k.peasant,g.peasant],da=[d.wizard,g.mage,k.mage],fa=
[d.footman,g.footman,k.ronin],ha=[d.priest,g.priest,k.priest];kc={bless:{img:m.bless,d:0,mv:1},star:{img:m.star,d:0,mv:1},heal:{img:m.healing,d:0,mv:1},impersonate:{img:m.impersonate,d:0,mv:1},select:{img:m.select,d:0,mv:0,select:1,z32:.8},spawn:{img:m.spawn,d:0,mv:1},curse:{img:m.curse,d:0,mv:1},turnStone:{img:m.turn_to_stone,d:0,mv:1}};var Q=function(b,c,d){for(var k=b.length,e=0,h=c.length;e<h;e++)for(var f=0;f<k;f++)Hd[b[f].type][c[e].type]=d};Q(J,A,4);Q(A,A,3);Q(A,S,3);Q(A,I,3);Q(A,Y,5);Q(A,
c,2);Q(T,S,4);Q(T,w,4);Q(T,I,6);Q(T,c,4);Q(T,Y,9);Q([k.samurai],q,.5);Q([k.samurai],l,.3);Q([k.ronin],aa,1);Q(W,h,6);Q(fa,W,1.5);Q(fa,e,1.5);Q(fa,[g.jihadwarrior],1);Q([g.satrap],aa,2);Q(v,c,1.5);Q(C,[f.dragon],.75);Q(C,[f.bat],1);Q(C,[d.pikeman],-.75);Q(C,v,1);Q(C,[k.chariot],-.3);Q(C,X,.5);Q(da,ha,4);Q(ha,da,3);Q(ha,G,3);Q(H,[f.bat],-.2);Q(H,[f.dragon],-.5);Q([f.stonegolem],R,1);Q([f.dwarf],R,4);Q(G,[k.priest],-.5);l=va;e=Object.keys(l);for(h=0;h<B.length;h++)for(c=B[h],q=0;q<e.length;q++)c[e[q]]=
l[e[q]];window.Utype={archer:[d.archer,d.longbowman,k.archer,k.horsearcher,g.archer,g.horsearcher],sword:[d.footman,d.maceman,d.knight,d.crusader,d.pikeman,g.jihadwarrior,g.cavalry,g.footman,g.enichar,d.peasant,g.peasant,g.satrap,g.spearman,f.spy,k.chariot,k.monk,k.samurai,k.ronin,k.horsesamurai,k.ninja,k.peasant,f.skeleton,f.ghost,f.ork,f.dwarf],allunits:[d.footman,d.maceman,d.knight,d.crusader,d.pikeman,g.jihadwarrior,g.cavalry,g.footman,g.enichar,d.peasant,g.peasant,g.satrap,g.spearman,f.spy,k.chariot,
k.monk,k.samurai,k.ronin,k.horsesamurai,k.ninja,k.peasant,d.archer,d.longbowman,k.archer,k.horsearcher,g.archer,g.horsearcher,d.wizard,g.mage,k.mage,d.priest,g.priest,k.priest,f.skeleton,f.ghost,f.ork,f.dwarf],allbuildings:[],priest:[d.priest,g.priest,k.priest],catapults:[f.ballista,f.catapult,f.heavycatapult],kungfu:[k.peasant,k.ninja,k.monk,k.priest],peasants:[d.peasant,g.peasant,k.peasant]};D=[{name:["Longbow","Allows the production of longbowmen"],next:[b.createLongbowman],cost:[400,0,0,0],time:45,
type:V},{name:["Gold Mining","Increases gold production"],increase:2,value:"gold",cost:[400,0,0,0],time:20,type:Pa},{name:["Stone Mining","Increases stone production"],increase:2,value:"stone",cost:[400,0,0,0],time:20,type:Pa},{name:["Wood Cutting","Increases wood production"],increase:2,value:"wood",cost:[400,0,0,0],time:20,type:Pa},{name:["Temper Iron","Increases hand-to-hand units' attack power"],increase:2,value:"attack",cost:[400,0,0,0],time:30,group:Utype.sword,next:[b.techHalberd],type:Ua},
{name:["Scale Armor","Increases unit's defense"],increase:1,value:"defence",cost:[400,0,0,0],time:30,group:Utype.allunits,next:[b.techChainMail],type:Ua},{name:["Halberd","Allows the production of spear units"],next:[b.createPikeman,b.createPikeman2],cost:[400,0,0,0],time:30,type:V},{name:["Domestication","Allows the production of cows"],next:[b.createCow],cost:[300,0,0,0],time:20,type:V},{name:["Crop Rotation","Increases the production of fields"],increase:2,value:"food",cost:[400,0,0,0],time:20,
type:Pa,next:[b.irrigation]},{name:["Chain Mail","Increases unit's defense"],increase:2,value:"defence",cost:[400,0,0,0],time:30,group:Utype.allunits,type:Ua},{name:["Plate Armor","Allows the production of knights"],next:[b.createKnight],cost:[400,0,0,0],time:60,type:V},{name:["Crossbow","Increases arrow units' attack power"],increase:2,value:"attack",cost:[400,0,0,0],time:30,group:Utype.archer,type:Ua},{name:["Feudalism","Makes peasants cheaper"],cost:[300,0,0,0],time:30,decrease:[k.peasant,[0,0,
8,0],d.peasant,[0,0,10,0],g.peasant,[0,0,10,0]],type:nh,next:[b.techSlavery]},{name:["Architecture","Peasants build faster, and allows stone wall, gate and towers"],increase:.5,value:"buildSpeed",cost:[300,0,0,0],time:30,type:Pa,next:[b.upgradeStoneTower,b.techGreatWall,b.buildBridge]},{name:["Learning","Allows units to gather experience"],increase:1,value:"experience",cost:[400,0,0,0],time:30,type:Pa,next:[b.buildAcademy,b.buildAcademy1,b.buildAcademy2]},{name:["Convert Resources",""],cost:[400,
0,0,0],time:30},{name:["Map Making","Allows the production of galleons"],cost:[800,0,0,0],time:30,type:V,next:[b.createGalleon]},{name:["Trade Routes","Allows trading"],cost:[400,0,0,0],time:30,type:V,next:[b.techTradeTaxes]},{name:["Trade Taxes","Increases trade profit"],cost:[400,0,0,0],time:30},{name:["Usury","Allows the obtaining of loans in taverns"],cost:[300,0,0,0],time:30,type:Ve,next:[b.techBanking]},{name:["Supply Storage","Increases the population limit"],cost:[500,0,0,0],time:30,increase:50,
type:Pa,value:"popLimit",next:[b.techSeaFood]},{name:["Bribery","Allows the bribing of enemy units"],cost:[600,0,0,0],time:60,type:V,next:[b.bribe]},{name:["Heroism","Allows unlimited experience"],cost:[500,0,0,0],time:30,increase:Infinity,value:"maxLevel",type:Pa,next:[b.techLeadership]},{name:["Warfare","Gain experience faster"],cost:[400,0,0,0],time:30,type:Pa,increase:1,value:"experience",next:[b.techTactics]},{name:["Tactics","Gain experience faster"],cost:[800,0,0,0],time:30,type:V,next:[b.buildDummy,
b.techSunTzu]},{name:["Mercenaries","Allows the recruitment of units in taverns"],cost:[600,0,0,0],time:30,type:Ve,next:[b.techHeroes,b.createMercenaries],actvintv:[b.iniMercenaries]},{name:["Heroes' Quest","Allows the recruitment of heroes in taverns"],cost:[800,0,0,0],time:30,type:Ve,next:[b.techFame,b.createHeroes],actvintv:[b.iniHeroes]},{name:["Fame","Recruit better units from taverns"],cost:[500,0,0,0],time:30,value:"fameTech",increase:1,type:Pa},{name:["Siege Tactics","Allows the production of heavy catapults"],
cost:[1200,0,0,0],time:60,type:V,next:[b.createHeavyCatapult]},{name:["Body Building","Increases unit's hit points at every new level"],cost:[800,0,0,0],time:60,value:"healthJump",increase:5,type:Pa},{name:["Espionage","Allows the production of a spy"],cost:[400,0,0,0],time:30,type:V,next:[b.createSpy]},{name:["Fanaticism","Increases the building's resistance"],cost:[400,0,0,0],time:30,type:Ua,group:Utype.allbuildings,increase:5,value:"resistance",next:[b.techCrusade,b.techJihad]},{name:["Crusade",
"Allows the preaching of a crusade"],cost:[1200,0,0,0],time:180,type:V,next:[b.createCrusaders]},{name:["Inquisition","Increases priest attack"],cost:[400,0,0,0],time:30,type:Ua,group:Utype.priest,increase:5,value:"attack"},{name:["Healing","Allows healing of units"],cost:[400,0,0,0],time:30,next:[b.techMedicine,b.healing],type:V},{name:["Medicine","Allows remote healing of units"],cost:[500,0,0,0],time:30,value:"healingRange",increase:5,type:Pa},{name:["Bless","Temporarily increases unit attack skill"],
cost:[400,0,0,0],time:30,type:V,next:[b.bless]},{name:["Invisibility","Invisibility spell"],cost:[500,0,0,0],time:30,type:V,next:[b.invisibility]},{name:["Bat","Researches bat summoning"],cost:[400,0,0,0],time:240,type:V,next:[b.createBat]},{name:["Freeze","Freeze spell"],cost:[800,0,0,0],time:30,type:V,next:[b.freeze]},{name:["Lightning","Lightning spell"],cost:[400,0,0,0],time:30,type:V,next:[b.lightning]},{name:["Stone Golem","Researches stone golem summoning"],cost:[800,0,0,0],time:120,type:V,
next:[b.createGolem]},{name:"Upgrade to Guard Tower",cost:[0,600,0,0],time:20,type:Ue,obj:44,upgrade:1},{name:"Upgrade to Stone Tower",cost:[0,0,0,500],time:30,type:Ue,obj:55,upgrade:1},{name:"Upgrade to Cannon Tower",cost:[0,0,0,500],time:30,type:Ue,obj:56,upgrade:1},{name:["Buddhism"],cost:[400,0,0,0],time:30,type:V,next:[b.buildCathedral1]},{name:["Cannon Tower","Allows the building of cannon towers"],next:[b.upgradeCannonTower],cost:[400,0,0,0],time:30,type:V},{name:["Engineering","Increases siege weapon's attack"],
increase:5,value:"attack",cost:[400,0,0,0],time:30,group:Utype.catapults,type:Ua},{name:["Great Wall","Makes stone walls, towers and gates stronger"],cost:[600,0,0,0],time:30,type:V},{name:["Art of Riding","Allows the production of horse archers"],cost:[500,0,0,0],time:30,type:V,next:[b.createHorseArcher1,b.createHorseArcher2,b.techHorseManShip]},{name:["Irrigation","Increases field production"],increase:4,value:"food",cost:[400,0,0,0],time:30,type:Pa},{name:["Armored Chariot","Allows the production of armored chariots"],
cost:[500,0,0,0],time:60,type:V,next:[b.createChariot]},{name:["Meditation","Makes monks cheaper"],cost:[300,0,0,0],time:30,decrease:[0,0,50,0],type:mh,next:[b.techPhilosophy],group:[k.monk]},{name:["Kung-Fu","Increases the attack of all kung-fu units"],cost:[400,0,0,0],time:30,type:Ua,increase:1,value:"attack",group:Utype.kungfu,next:[b.techMastery,b.techNinjas,b.techTournaments]},{name:["Tournaments","Allows sharing of experience between kung-fu units"],cost:[800,0,0,0],time:30,type:V,next:[]},
{name:["Philosophy","Allows the production of more experienced monks"],cost:[400,0,0,0],time:30,type:Ua,increase:2,value:"level",group:[k.monk,k.priest],next:[b.createPriest1]},{name:["Ninjas","Allows the production of ninjas"],cost:[500,0,0,0],time:30,type:V,next:[b.createNinja]},{name:["Mastery","Allows priests to teach kung-fu units"],cost:[500,0,0,0],time:30,type:V,next:[b.teach]},{name:["Concentration","Allows faster manna restoration"],cost:[600,0,0,0],time:80,type:V,next:[b.techConfusion]},
{name:["Confusion","Researches the Confusion spell"],cost:[400,0,0,0],time:30,type:V,next:[b.confusion]},{name:["Whirlpool","Researches the Whirlpool spell"],cost:[300,0,0,0],time:30,type:V,next:[b.whirlpool]},{name:["Dragon","Researches Dragon summoning"],cost:[800,0,0,0],time:300,type:V,next:[b.createDragon]},{name:["Turn to Stone","Researches the Turn to Stone spell"],cost:[300,0,0,0],time:30,type:V,next:[b.turnToStone]},{name:["Flame Bolt","Researches the Flame Bolt spell"],cost:[400,0,0,0],time:30,
type:V,next:[b.techDragon,b.flameBolt]},{name:["Jewelry","Allows trading of items"],cost:[400,0,0,0],time:30,type:V,next:[b.sellItems,b.buyItems]},{name:["Banking","Increases trade profit"],cost:[600,0,0,0],time:30,type:V},{name:["Chemistry","Increases arrow units' attack power"],cost:[500,0,0,0],time:30,type:Ua,group:Utype.archer,increase:1,value:"attack",next:[b.techGunPowder]},{name:["Sea Food","Increases the population limit"],cost:[500,0,0,0],time:30,increase:50,type:Pa,value:"popLimit"},{name:["Gun Powder",
"Increases cannon tower's attack power"],cost:[500,0,0,0],time:30,type:Ua,increase:10,value:"attack",group:[f.cannontower],next:[b.techRocketArrow]},{name:["Rocket Arrow","Allows the building of rocket tower"],cost:[800,0,0,0],time:30,type:V,next:[b.buildRocketTower]},{name:["Bushido","Allows the production of horse samurai"],cost:[800,0,0,0],time:120,type:V,next:[b.createHorseSamurai]},{name:["Leadership","Units around a hero gain experience"],cost:[600,0,0,0],time:30,type:V,next:[b.techHonor]},
{name:["Honor","Hero vs. hero attack bonus"],cost:[500,0,0,0],time:30,type:V},{name:["Sun Tzu's Book","Increases the speed of learning"],cost:[800,0,0,0],time:30,type:Pa,increase:1,value:"experience"},{name:["Cow Poaching","Allows peasants to steal cows"],cost:[200,0,0,0],time:30,type:Pa,increase:1,value:"stealCows"},{name:["Horsemanship","Makes mounted units cheaper"],cost:[500,0,0,0],time:30,type:mh,mulp:.75,group:[k.horsearcher,g.cavalry,g.horsearcher]},{name:["Scimitar","Increases sword attack power and allows the production of satraps"],
cost:[400,0,0,0],time:30,type:Ua,increase:1,value:"attack",group:Utype.sword,next:[b.createSatrap]},{name:["Jihad","Allows the production of Jihad Warriors"],cost:[1200,0,0,0],time:30,type:V,next:[b.createJihad,b.convertJihad]},{name:["Magic Carpet","Researches Magic Carpet summoning"],cost:[300,0,0,0],time:30,type:V,next:[b.createCarpet,b.techJinn]},{name:["Magic Workshop","Allows the building of a magic workshop"],cost:[1200,0,0,0],time:180,type:V,next:[b.buildMagicWorkshop]},{name:["Rain of Fire",
""],cost:[800,0,0,0],time:60,type:V,next:[b.fireRain]},{name:["Magic Vision","Researches the Magic Vision spell"],cost:[400,0,0,0],time:30,type:V,next:[b.magicVision]},{name:["Necromancy","Researches the Raise the Dead spell"],cost:[400,0,0,0],time:30,type:V,next:[b.raiseDead]},{name:["Jinn","Researches Jinn summoning"],cost:[600,0,0,0],time:300,type:V,next:[b.createJinn]},{name:["Ore Enrichment","Increases mine production"],cost:[800,0,0,0],time:30,type:Pa,increase:1,value:"miningPerf"},{name:["Riding Horses",
"Increases the mounted units' attack and defense power"],cost:[500,0,0,0],time:30,type:wj,values:["attack",2,"defence",1],group:[k.horsearcher,g.cavalry,g.horsearcher],next:[b.techJanissary]},{name:["Janissary","Allows the production of Janissaries"],cost:[1200,0,0,0],time:120,type:V,next:[b.createEnichar]},{name:["Slavery","Makes peasants cheaper"],cost:[200,0,0,0],time:30,decrease:[k.peasant,[0,0,7,0],d.peasant,[0,0,8,0],g.peasant,[0,0,8,0]],type:nh}];b.buildMarket.disabled=1;e="";Pk();h=0;for(k=
D.length;h<k;h++)f=D[h],f.tech=!0,f.id=h;q=0;for(f=0*B.length;q<f;q++){l=B[q];k=0;c=[];if(l.onbuild){d=l.onbuild;h=0;for(k=d.length;h<k;h++)w=d[h],c.push(w.id),w.obj.race==l.race&&(w.disabled=1,w.requireObj||(w.requireObj=[]),w.requireObj.put(l)),g=0,g=w.obj.tech?w.obj.id+B.length:w.obj.type,Lc[h]=g;z.Uint16Array(k)}l.space?(d=l.space.slice(0,l.space.length-1).join(","),Ym(l.space),w=z.boolArray(l.space.length-1)):(w=0,d="1");A=0;g=[];if(l.icons){h=0;for(k=l.icons.length;h<k;h++)w=l.icons[h],Lc[A++]=
w.id,g.push(w.id);A&&z.Uint16Array(A)}w=0;k=[];if(l.child){for(h=0;h<l.child.length;h++)k.push(l.child[h].img.urlID),Lc[w++]=l.child[h].img.urlID;z.Uint32Array(w)}h=l.res;w=l.storage;void 0==h&&(h=55);void 0==w&&(w=55);c.length&&(e+="uint NEXTZQ"+q+"[]={"+c.join(",")+"};\n");l.icons&&l.icons.cut&&(h=Zm(l.icons.cut),e+="uint SCUT"+q+"[]={"+h.join(",")+"};\n");g.length&&(e+="uint ORDERZQ"+q+"[]={"+g.join(",")+"};\n");k.length&&(e+="uint CHILDSZQ"+q+"[]={"+k.join(",")+"};\n");e+="bool SPACEZQ"+q+"[]={"+
d+"};\n"}e="";h=0;for(k=0*D.length;h<k;h++){f=D[h];q=0;c=[];if(f.next)for(d=f.next,g=0,q=d.length;g<q;g++)l=d[g],l.disabled?(l.disabled++,l.requireObj.put(f)):(l.requireObj=[f],l.disabled=1),c.push(l.id);d=h+B.length;c.length&&(e+="u16 NEXTZQ"+d+"[]={"+c.join(",")+"};\n")}h=0;d=B;for(k=d.length;h<k;gm(d[h++]));}if(t.editor){if(M("statButton"),M("menu"),M("resources"),ka("mapeditorinfotop"),ka("mapeditorinfo"),q=p("mapeditorinfoUnits"),q.style.display="block",kg(),!ai.preload){ai.preload=!0;f={};e=
{};d=B;g={euro:La[0],arab:La[1],asia:La[2],common:r.common};f[La[0]]=[];f[La[1]]=[];f[La[2]]=[];f[r.common]=[];e[La[0]]=[];e[La[1]]=[];e[La[2]]=[];e[r.common]=[];h=0;for(k=d.length;h<k;h++)l=d[h],!l.race||l.illegal||7==l.type||l.item||(l.build?e[g[l.race]].put(h):f[g[l.race]].put(h));for(g=0;2>g;g++){d=Object.keys(f);c={};h=0;for(k=d.length;h<k;c={ul$18:c.ul$18},h++){w=document.createElement("h1");w.innerHTML=d[h];c.ul$18=document.createElement("ul");w.onclick=function(b){return function(){zg(b.ul$18)}}(c);
c.ul$18.style.display="none";A=f[d[h]];v=Object.keys(A);C={};G=0;for(H=v.length;G<H;C={tcreate:C.tcreate},G++)l=document.createElement("li"),l.innerHTML=B[A[v[G]]].name,C.tcreate=A[v[G]],l.onclick=function(b){return function(){var c=b.tcreate;if(B[c].wall){c=B[c];Pb=!1;var d=ja;hb=c;ba(d,c.img);document.addEventListener("mousemove",ih);document.addEventListener("mousedown",pushbuildWall)}else P(c)}}(C),c.ul$18.appendChild(l);q.appendChild(w);q.appendChild(c.ul$18)}f=e;q=p("mapeditorinfoBuilds")}d=
Object.keys(Vd);q=p("mapeditorinfoItems");var ea=document.createElement("ul");g={};h=0;for(k=d.length;h<k;g={u$19:g.u$19},h++)l=document.createElement("li"),g.u$19=Vd[d[h]],l.onclick=function(b){return function(){Ki(b.u$19)}}(g),l.innerHTML=g.u$19.name,ea.appendChild(l);q.appendChild(ea);q=p("mapeditorinfoNature");w=document.createElement("h1");w.innerHTML=r.trees;ea=document.createElement("ul");w.onclick=function(){zg(ea)};ea.style.display="none";l=document.createElement("li");ea.appendChild(l);
q.appendChild(w);q.appendChild(ea);l.onclick=function(){bi($m)};l.innerHTML=r.LOAD_DEL;l=document.createElement("li");ea.appendChild(l);l.onclick=function(){bi(an)};l.innerHTML=r.create;w=document.createElement("h1");w.innerHTML=r.terrain;var ia=document.createElement("ul");w.onclick=function(){zg(ia)};ia.style.display="none";q.appendChild(w);q.appendChild(ia);k=Qk.texturesRandomMap;d={};h=0;for(k=k.length;h<k;d={l:d.l},h++)l=document.createElement("li"),ia.appendChild(l),l.innerHTML=h,d.l=h,l.onclick=
function(b){return function(){bi(ci);ci.active=b.l}}(d)}}else ka("menu"),ka("statButton"),ka("resources"),M("mapeditorinfo"),M("mapeditorinfotop");Rk()},B,Hd,$h,wb,Ok,Gk,Xc=function(b,c,e,d,h,f,g){z.newUnit(b,c,e,d,h,f)},wm=[];new Float32Array(4);new Float32Array(3);var Yd=function(){f.bindBuffer(f.ARRAY_BUFFER,Qh);f.bufferSubData(f.ARRAY_BUFFER,12*qb[4],lg)},Tk=function(){f.bindBuffer(f.ARRAY_BUFFER,Rh);f.bufferSubData(f.ARRAY_BUFFER,16*qb[4],Sk)},Uk=function(){f.bindBuffer(f.ARRAY_BUFFER,Ph);f.bufferSubData(f.ARRAY_BUFFER,
12*qb[4],lg)},Ik=function(){f.bindBuffer(f.ARRAY_BUFFER,Sh);f.bufferSubData(f.ARRAY_BUFFER,12*qb[4],lg)},Kb=function(b){if(b.child&&(!1!==b.built||!b.build)){var c=0;for(b=b.child.length;c<b;c++);}},ac=function(b,c,e,d){Tk(c,e,d,t.now(),b.bufferID);if(b.tempChild){var k=0;b=b.tempChild;for(var f=b.length;k<f;ac(b[k++],c,e,d));}},Oa=function(b,c,e){void 0==e&&(e=32);b.z32&&(c*=b.z32);Yd(b.x32*e,b.y32*e,c,b.bufferID);if(b.tempChild){c=b.tempChild;e=0;for(var d=c.length;e<d;e++){var k=c[e];k.x32=b.x32;
k.y32=b.y32;Oa(k,32*b.y32)}}},va={checkMana:function(b,c,e,d){if(!this.mana)return!1;if(0>this.mana-b)return this.manaTask=[e.url,c,b],this.stay55(),b>this.manaMax&&d&&(this.blockedCost=d,c=this.setupChild(kc.curse,1),this.blocked=2,this.blockedimg=c,this.manaTarget=b),!1;this.mana-=b;return!0}},gh=function(b,c){return t.editor?!0:b.freezed||b.confused?!1:I[b.spy||b.kingdom].control[c.spy||c.kingdom]};va.changeKingdom=function(b){ta[this.kingdom][this.type].quit(this.id);if(Lf[this.id]){Lf[this.id]=
0;Q.quit(this.id);0==Q.length&&(fd(),Md=-1);var c=this.id;c=A[c];c.tempChild.quit(c.selectAnim);Ma(c.selectAnim.bufferID);c.selectAnim=void 0}this.kingdom=b;Kb(this);this.childBuild&&(this.childBuild=0);if(!this.build||this.arrow)t.editor||this.stay();ta[b][this.type].put(this.id)};va.aspettare=function(){this.rbase().write(this.x32+this.y32*H,this.id);this.waiting=!0;ba(this,this.url.idle);ac(this,0,0,0);sb(this,~~(32E3/this.spd))};va.addItem=function(b){var c=this.inventory;c&&(c[c.length]=b.id,
b.in=this.id,b.sword||b.shield)&&(b.attack&&(this.attack+=b.attack),b.defence&&(this.defence+=b.defence))};va.showInventory=function(){Jh();for(var b=this.inventory,c=0;8>c;c++){var e=b[c];if(!e)break;var d=Aa[c];d.style.backgroundPosition="0px "+48*e.iconID+"px";d.className=""}};va.deleteItem=function(b){this.inventory.quit(b.id);this.attack-=b.attack;this.defence-=b.defence};va.useItem=function(b){48==b.type&&(this.health+=b.lives,this.health>this.maxHealth&&(this.maxHealth=this.health),this.inventory.quit(b.id))};
va.onattack=function(b){!this.attack||this.freezed||this.death||this.item||this.func!=Oc.url&&this.func||Rb(b.id,[this.id],1)};va.setupINTV=function(b,c,e,d){z.setupINTVadapter(this.id,b.url,c,e)};va.damage=function(b,c){if(!(this.zolotoy||this.death||this.stoned)){this.defence&&(b-=this.defence);1>b&&(b=1);this.health-=b;c=I[c.kingdom].stats;c.dmgInflicted+=b;var e=I[this.kingdom].stats;e.dmgTaken+=b;1>this.health?(this.build?(e.buildsLosed++,c.buildsKilled++):(e.unitsLosed++,c.unitsKilled++),this.die()):
W(this.id,1)}};var W=function(b,c){if(Lf[b]||!1===b){b=Q.length;if(1===b)if(b=A[Q[0]],qa.stockActive==b&&b.inventory.length){if(be(b.id,1,1),b=b.inventory,b.length)for(c=0,b=b.length;c<b;c++);}else b.build?Ga(b,1):be(b.id,c);else 1<b?zk(Q,c):yk(eb);return!0}};va.setupSpellIMG=function(b){this.invisible&&Zc(this.id);this.url.spell?(ba(this,this.url.spell,1),b||Na({func:Vk,data:this.id},Xa(this.img),1)):this.stay()};var Vk=function(b){b=A[b];b.death||b.stay()};va.setupChild=function(b,c,e){e={x32:this.x32,
y32:this.y32,d:b.d,img:b.img,mv:b.mv,parent:this.id,z32:b.z32};if((this.dix||this.diy)&&!this.waiting){var d=.001*(t.now()-this.timestamp);e.x32+=this.dix*d/32-Math.sign(this.dix);e.y32+=this.diy*d/32-Math.sign(this.diy)}if(b.select){if(this.space)b=this.space[this.space.length-1],k=(this.space.length-1)/b;else{b=this.sSizex||1;var k=this.sSizey||1}this.z32&&(e.z32=this.z32);e.wh=[32*b-3,32*k-3];this.selectAnim=e}d&&ac(e,this.dix,this.diy,0);this.tempChild||(this.tempChild=[]);this.tempChild.put(e);
c||Wd.new(e,Xa(e.img),Wk);return e};var Wk=function(b){A[b.parent].tempChild.quit(b);Ma(b.bufferID)};va.distance=0;var ba=function(b,c,e,d){b.img=c;lb[c]||C(c);(c=lb[c])||C(b);var k=c[0],f=c[1];0<=f&&(f*=.001);d&&(f*=d);c=c.id+4*b.d*c[2];d=-1;1===e?d=t.now():0>e&&(d=1);Uk(c,d,k,f,b.bufferID)};va.setupDir=function(b,c,e){b=Math.sign(b);c=Math.sign(c);b=3*(c-1)+(b+1);2==b?this.d=1:-6==b?this.d=5:0==b?this.d=7:-4==b?this.d=3:-1==b?this.d=2:1==b?this.d=0:-5==b?this.d=4:-3==b&&(this.d=6);e&&(this.d=(this.d+
e)%8)};va.setupDirBuild=function(b){var c=H,e=this.x32+this.y32*c;if(1==b.health&&0==b.built)d=db[b.kingdom],b=b.id,d[e+c]==b?this.d=0:d[e-c]==b?this.d=4:d[e+1]==b?this.d=2:d[e-1]==b?this.d=6:d[e+c+1]==b?this.d=1:d[e-c+1]==b?this.d=3:d[e+c-1]==b?this.d=7:d[e-c-1]==b&&(this.d=5);else{b=b.id;var d=Ic;d(e+c)==b?this.d=0:d(e-c)==b?this.d=4:d(e+1)==b?this.d=2:d(e-1)==b?this.d=6:d(e+c+1)==b?this.d=1:d(e-c+1)==b?this.d=3:d(e+c-1)==b?this.d=7:d(e-c-1)==b&&(this.d=5)}};va.spdMod=0;var rh=function(b,c){for(var e=
c.length,d=0;d<e;d++){var k=A[c[d]];k.build||(k.spd=b)}};va.changeFunc=function(b,c){var e=this.func;this.func=b;if(di){if(void 0!==this.workingOn)var d=A[this.workingOn];(e=jb[e])&&e.rule&&ah(-1,this,e.rule,d);(b=jb[b])&&b.rule&&ah(1,this,b.rule,c)}};var Zm=function(k){for(var c=[],e=Object.keys(k),d=0;d<e.length;d++){var h=b[k[e[d]]];h&&c.push(e[d].charCodeAt(0),h.id)}return c};va.stay=function(b){this.mv=1;this.time=void 0;this.diy=this.dix=0;this.c=void 0;z.unitWorking(this.id,!1);this.xf=null;
ac(this,0,0,0);z.unitMovement(this.id,!1);if(!b){b=this.action==Yc.url||this.func==af.url;this.changeFunc(void 0);this.stock&&0!==this.stock[0]?ba(this,this.img,NaN):ba(this,this.__proto__.img,1);this.buildList&&(this.buildList=void 0);this.deleteWorker();if(this.standardFunc&&2!==this.stop&&void 0==this.spy)return this.standardFunc(this);b&&Oc(this)}};va.stay55=function(){this.changeFunc(void 0);this.stock&&0!==this.stock[0]?ba(this,this.img,NaN):ba(this,this.__proto__.img,1);this.deleteWorker();
this.standardFunc&&2!==this.stop&&void 0==this.spy&&this.standardFunc(this)};va.addWorker=function(b){this.workers.put(b.id);b.workingOn=this.id};va.deleteWorker=function(){this.workingOn&&(A[this.workingOn].workers.quit(this.id),this.workingOn=0);this.actionItem&&(this.actionItem=void 0);this.blockedAction()};va.blockedAction=function(b){var c=this.blocked;if(Xk[c])Xk[c](this,b)};var Xk={2:function(b,c){b.blocked=void 0;Kb(b);Wk(b.blockedimg);b.blockedimg=void 0;b.manaTarget=void 0;c||(I[b.kingdom].setupResources(b.blockedCost,
-1),b.blockedCost=void 0)}},ak=function(b){return m.delay[-b[1]+b[0]-1]},Sd=function(b){var c=Q.length;Q.quit(b);if(c!=Q.length){var e=A[b];e.selectAnim=void 0;c=0;for(e=e.tempChild;c<e.length;c++){var d=e[c];Ma(d.bufferID);var k=e.length;e.quit(d);k!=e.length&&c--}Lf[b]=void 0;0==Q.length?fd():1==Q.length?A[b].build?Ga(A[b],1):be(b):zk(Q)}eb&&eb.id===b&&(fd(),eb.selectAnim&&(Ma(eb.selectAnim.bufferID),eb.selectAnim=void 0),eb=void 0)};va.rbase=function(){return uf[this.zLevel]};var Bh;va.die=function(b){if(!this.death&&
!this.magicGateway){var c=H,e=this.id,d=this.kingdom,k=I[d];this.waitlist&&(k.unitLoading-=.5*this.waitlist.length);if(this.dieSound&&!t.editor){var f=this.dieSound;na(f[~~(f.length*Math.random())],this.x32,this.y32)}Sd(this.id);(this.freezed||this.invisible)&&Kb(this);var g=this.x32,p=this.y32;this.death=1;1==this.zLevel&&(Bh[g+p*c]=1);z.unitWorking(this.id,!1);this.c=void 0;var q=this.url.die||this.dimg;!1===this.built&&k.building.quit(this.id);void 0!=k.IAD&&k.k&&!this.item&&rb.arr[k.IAD].valorateLost(this);
if(this.food&&!t.editor){var r=100,w=this.food/r,v=~~w,B=~~((w-v)*r);for(f=0;f<w;f++){f==v&&B&&(r=B);var C=Bj(g,p),D=~~(C/c);C%=c;C=new Xc(52,d,C,D,0);ba(C,m.item_meat);C.contain=[r,2,qm]}}k.stats.unitCountDeath[this.type]++;f=this.x32;c=this.y32;b||t.editor?Ma(this.bufferID):q?(this.mv=!0,ba(this,q,1),b=lb[this.img],q=b[1],q=0>q?ak(b):1E3*b[0]/q,Na({func:Zj,data:this.id},q-25,1),ac(this,0,0,0),void 0!==this.dix&&(b=.001*(t.now()-this.timestamp),this.x32+=this.dix*b/32-Math.sign(this.dix),this.y32+=
this.diy*b/32-Math.sign(this.diy))):this.dimgInfinity?(this.dimgRND&&(this.d=this.id%this.dimgRND),ba(this,this.dimgInfinity)):Ma(this.bufferID);lh(this);this.techStart&&kh(0,[this.id]);Oa(this,32*this.y32-36);this.x32=f;this.y32=c;this.build||this.item||this.cow||k.values.pop--;this.population&&this.built&&(k.values.popMax-=this.population);p=this.validator(g,p,this.space,this.kingdom);b=p[0];if(this.onbuild&&!t.editor)for(g=this.onbuild,q=k.technology,f=q.disabled,q=q.actived,c=0;c<g.length;c++)d=
g[c].id,q[d]--,0===q[d]&&f[d]++;g=this.validator.dimension;c=g.write;f=0;for(q=b.length;f<q;f++)d=b[f],lc[d]?c(d,lc[d]):c(d,0);if(1==this.health&&!this.built)for(d=db[this.kingdom],f=0,q=b.length;f<q;d[b[f++]]=void 0);if(p[2])for(b=p[2],f=0,q=b.length;f<q;f++)d=b[f],lc[d]?(2<g(d)&&A[g(d)].die(1),c(d,lc[d])):(2<g(d)&&A[g(d)].die(),c(d,0));ta[this.kingdom][this.type].quit(this.id);if(this.callList){b=this.x32;q=this.y32;c=this.sight;f=H;d=2*c+1;g=d*d;r=this.id;for(p=0;p<g;p++)w=p%d-c,v=~~(p/d)-c,Math.sqrt(Math.pow(w,
2)+Math.pow(v,2))<=c&&(w+=b,v+=q,w+=v*f,uc[w]==r&&(uc[w]=void 0));b=this.callList;this.callList=void 0;p=0;for(g=b.length;p<g;p+=2)q=A[b[p]],q.x32+q.y32*f==b[p+1]&&q.callList&&x(q,!0);b.length=0}if(this.workers){f=0;g=this.workers.slice(0);for(q=g.length;f<q;f++)p=A[g[f]],p.workingOn===e&&(p.workingOn=0,p.func!==ph.url&&p.stay());this.workers.length=0}this.deleteFromList&&(g=this.deleteFromList,g.quit(this),g.length||g.length0function(this));this.time=void 0;this.changeFunc(void 0);this.diy=this.dix=
0;this.inventory&&0<this.inventory.length&&Ye(this.id,this.inventory.slice(0));this.stock&&zj(this);t.editor||(k.check(),popinfo(this.kingdom),k.checkPopArray());this.deleteWorker()}};Array.prototype.quit=function(b){b=this.indexOf(b);return-1<b?(this.splice(b,1),!0):!1};Array.prototype.add=function(b){0>this.indexOf(b)&&(this[this.length]=b)};var La=["European","Arab","Asian"],om={euro:"Lancelot Arthur Guivain Merlin Blackthorn Morin Golstuck Karambol Kelerick Rockmore Bridport Casevil Stirm Tonis Pelegrim Peresohn Pirk Pharn Gork".split(" "),
arab:"Ibn Fadlan;Mohammad;Al Ferissa;Harun Al Rashid;Sindbad;Mellemad;Moarrac;Sakhavan;Bellefars;Mokhac;Norahz;Kerhetin;Maham;Dushesh;Direkh".split(";"),asia:"Ishida Toranaga Ichinzen Haiako Mozuki Hitachi Tosheba Harachiko Marasuma Korodzum Ishinghen Genghis Musa Echibo Ichikahr Yotokan Maraga".split(" "),common:"Fistantilus Skenderbeg Raislin Tenis Morok Sokob Baras Haram Billihz Ynte Orgh Savael Birgos Savator Gandeh Gordor Fessh Gilmi Phergas".split(" ")},Eh=function(b,c,e){e&&(b=b.replace("%d",
e));return b.replace("%s",c)},gd={},mg,ng,Qc=function(b){t.infinity=void 0;if(p("mapconfiguration")&&""!=p("mapconfiguration").innerHTML){b="mapx mapwidth goldRes goldValue woodRes woodValue foodRes foodValue stoneRes stoneValue infinity infiniteValue water waterValue terrainType terrainSelect peons peonValue freePop freePopValue".split(" ");for(var c=0,e=b.length;c<e;c+=2){var d=p(b[c+1]).value;"infinity"==b[c]?(d=p(b[c+1]).checked,t[b[c]]=d):parseInt(d)?t[b[c]]=parseInt(d):t[b[c]]=d;localStorage[b[c]]=
d}}else"true"==localStorage.infinity&&(t.infinity=!0),t.goldRes=parseInt(localStorage.goldRes),t.foodRes=parseInt(localStorage.foodRes),t.woodRes=parseInt(localStorage.woodRes),t.stoneRes=parseInt(localStorage.stoneRes),t.mapx=parseInt(localStorage.mapx),t.water=parseInt(localStorage.water),t.terrainType=localStorage.terrainType,t.items=parseInt(localStorage.items),t.peons=parseInt(localStorage.peons),t.gateways=parseInt(localStorage.gateways),t.freePop=parseInt(localStorage.freePop);t.daylength=
2880;t.initialhour=12;t.infinity&&(t.goldRes=Math.pow(2,31)-1,t.foodRes=Math.pow(2,31)-1,t.woodRes=Math.pow(2,31)-1,t.stoneRes=Math.pow(2,31)-1);t.mapy=t.mapx;t.gravity=580.9/9.8*9.8;t.name="";t.arje=~~(555555*Math.random()+1);b=t;b.goldRes=parseInt(b.goldRes);b.foodRes=parseInt(b.foodRes);b.woodRes=parseInt(b.woodRes);b.stoneRes=parseInt(b.stoneRes);b.goldRes||(b.goldRes=Infinity);b.foodRes||(b.foodRes=Infinity);b.woodRes||(b.woodRes=Infinity);b.stoneRes||(b.stoneRes=Infinity);b.mapx=parseInt(b.mapx);
(!b.mapx||32>b.mapx)&&(b.mapx=32);1024<b.mapx&&(b.mapx=1024);b.items=parseInt(b.items)||0;0>b.items&&(b.items=0);b.peons=parseInt(b.peons)||0;0>b.peons&&(b.peons=0);b.gateways=parseInt(b.gateways)||0;0>b.gateways&&(b.gateways=0);b.water=parseInt(b.water)||0;0>b.water&&(b.water=0);b.freePop=parseInt(b.freePop)||0;b.terrainType=Va(b.terrainType);b.description=Va(b.description);b.author=Va(b.author);b.name=Va(b.name);z.setupGame(t.peons,t.freePop,t.goldRes,t.woodRes,t.foodRes,t.stoneRes,t.water,Bd[t.terrainType].id,
t.items,t.gateways,t.mapx,t.arje);return t},Rk=function(){pc.innerHTML="";p("notifybottom").style.display="none";p("loadingtext").innerHTML=r.MSG_GAME_LOAD;w.kingdom||(w.kingdom=1);t.online&&(bn(r.initializing),t.editor=0);C(z.mapWidth(),"asd");z.mapWidth()?(t.mapx=z.mapWidth(),t.mapy=t.mapx):Qc();t.pausedTime=0;t.canceled=0;ng=performance.now();bc=p("msgs1");t.online||(location.hash="");M("playermenu");M("index");t.cycle?t.deltaTime=25*t.cycle:(t.players=I.length-1,t.date=Date.now(),t.cycle=0,t.kingdoms=
I,t.deltaTime=0);t.loadDate=Date.now();t.online||ok();t.now=ej;t.paused=0;t.pausedTime=0;t.zMax=96*t.mapy;$b();performance.now();t.allow14=!0;H=t.mapx;Da=t.mapy;t.temperature=25;var b=t.temperature;0==w.temperature&&(b+="&deg;C");p("temperature").innerHTML=b;S=1;p("loadingtext").innerHTML="Loading terrain";C("arje",t.arje);z.preldd()?(b=z.trradd(),mg=new Int8Array(g.buffer,b,void 0),C(mg)):(z.configRandomMap(),b=z.randomTerrain(H),mg=new Int8Array(g.buffer,b,H*Da));ka("content");p("loadingtext").innerHTML=
"Loading textures";f.getError()==f.CONTEXT_LOST_WEBGL&&(f=p("tzar").getContext("webgl2",{antialias:!1,alpha:!1}),C("restored"));if(!je){var c=Ba?"precision highp float;\nattribute vec3 a_position;\nattribute vec3 a_texCoord;\nattribute vec4 a_physic;\nattribute vec3 a_margins;\nattribute float a_step;\n\nuniform float kingdoms;\nuniform float zoom;\nuniform mediump int miniMap;\nuniform float now;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform sampler2D u_image1;\nuniform sampler2D delay;\nuniform sampler2D colorArray;\n\nuniform float zMax;\nvarying highp vec2 vTextureCoord;\nvarying vec4 v_kcolor;\nvarying float height;\nvarying float rColor;\n\nvec4 superArray(highp float position) {\nhighp vec2 xy = vec2(mod(position,512.0) ,   floor(position/512.0) )/512.0;\nreturn (texture2D(u_image1, xy));\n}\n\nfloat delayr(float pos){\nhighp vec2 xy = vec2(mod(pos,128.0) ,   floor(pos/128.0) )/128.0;\nreturn (texture2D(delay, xy).r);\n}\n\n\nvoid main() {\n\n\n\n    highp float  x;\n    float t;\n\thighp float pos;\n    highp float jump=0.0;\n    pos=a_texCoord.x;\n\n   // pos=260840u/4u;\n\n\n\nvec4 imgInfo=superArray(pos);\n\nfloat frames=imgInfo[0];\nfloat fps=imgInfo[1];\nfloat dirs=imgInfo[2];\nfloat recolor=imgInfo[3];\n\nrColor=recolor;\n\n\nif(fps!=0.0&&miniMap==0){\nif(a_texCoord.y>=0.0){\nt=(now-a_texCoord.y);\nif(fps>0.0){\njump=floor(t * fps*0.001);         \n}else{\n\n//fps=12.0;\n//jump=floor(t * fps*0.001);  \n\n\n\nfloat index=-fps;\n\nfloat spt= mod(t,delayr(frames-1.0+index));\nbool stop=false;\nfor(int i=0;i<55;i++){\nif(!stop){\njump=float(i);\nif(jump<frames) \nif(delayr(jump+index)>spt)\nstop=true;\n}\n\n}\n\n\n\n\n\n}\n\njump=mod(jump,frames)*2.0;\npos=(pos+jump);\n}\n}\n\npos+=1.0;\n   \n    vec4 coord = superArray(pos);\n    vec2 mxy=coord.xy;\n    highp vec2 txtcord = coord.zw;\n   // txtcord=vec2(0.0,0.0);\n    \n    vec2 sizes = superArray(pos+1.0).xy;\n    //sizes=vec2(50.0);\n    if(a_step==1.0||a_step==3.0){\n    mxy.x+=sizes.x;\n    txtcord.x+=sizes.x;\n    }\n\n    if(a_step==2.0||a_step==3.0){\n    mxy.y+=sizes.y;\n    txtcord.y+=sizes.y;\n    }\n\n\theight = sizes.y;\n\n\tfloat z=a_position.z;\n\n\n    \nif(a_margins.x!=0.0&&(a_step==1.0||a_step==3.0)){\nmxy.x+=a_margins.x-sizes.x;\n}\n\n\nif(a_margins.y!=0.0&&(a_step==2.0||a_step==3.0)){\nmxy.y+=a_margins.y-sizes.y;\n}\n\n\n\tif(z<0.0){\n\tz*=-1.0;\nif(miniMap<2) mxy*=0.0;\n\t}\n\n\n\n\n\n\nif(a_margins.z!=0.0){\n\tfloat s = sin(a_margins.z);\n\tfloat c = cos(a_margins.z);\n\tmat2 m = mat2(c, -s, s, c);\n\tmxy.xy*=m;\n}\n\n\n\n    t = (now - a_physic.w) * 0.001;\n    mxy.x+=a_physic.x * t;\n\n\tfloat physicY=a_physic.y * t + a_physic.z * .5 * t * t;\n\n    mxy.y+=physicY;\n\n\nif(miniMap!=0){\n\tz=0.0;\n}else{\n\tz=(1.0 - (physicY+z)/ zMax)*.9;\n}\n\n\n   gl_Position = vec4((((a_position.xy+mxy) + u_translation) / u_resolution * 2.0 - 1.0) * vec2(zoom, -zoom), (z), 1.0);\n   vTextureCoord=txtcord;\n\n\nvec4 outColor=texture2D(colorArray,vec2(a_texCoord.z/64.0,0));\n//outColor=vec4(1.0);\n\nif(a_texCoord.z>=kingdoms) outColor.a+=1.0;\n\n\n   v_kcolor=outColor;\n}\n":
"#version 300 es\nprecision highp float;\n\nin vec3 a_position;\nin vec3 a_texCoord;\nin vec4 a_physic;\nin vec3 a_margins;\nin uint a_step;\n\nuniform float kingdoms;\nuniform float zoom;\nuniform mediump int miniMap;\nuniform float now;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform sampler2D u_image1;\nuniform sampler2D delay;\nuniform sampler2D colorArray;\n\nuniform float zMax;\nout highp vec2 vTextureCoord;\nout vec4 v_kcolor;\nout float height;\nflat out int rColor;\n\nvec4 superArray(in highp int position) {\n     return(texelFetch(u_image1, ivec2(\t\t(position%512)\t\t,\tposition/512\t), 0));\n}\n\nvoid main() {\n\n\n\n    highp float  x;\n    float t;\n\thighp int pos;\n    int jump=0;\n    pos=int(a_texCoord.x);\n   // pos=260840u/4u;\n\n\n\nvec4 imgInfo=superArray(pos);\n\nint frames=int(imgInfo[0]);\nfloat fps=imgInfo[1];\nfloat dirs=imgInfo[2];\nfloat recolor=imgInfo[3];\n\nrColor=int(recolor);\n\n\nif(fps!=0.0&&miniMap==0){\nif(a_texCoord.y>=0.0){\nt=(now-a_texCoord.y);\nif(fps>0.0){\njump=int(floor(t * fps*0.001));         \n}else{\n\n\nint index=int(-fps);\n\nfloat spt= mod(t,texelFetch(delay, ivec2(frames-1+index, 0), 0).r);\n\nfor(jump=0;jump<frames;jump++)\nif(texelFetch(delay, ivec2(jump+index, 0), 0).r>spt){ \nbreak;\n}\n\n\n\n\n}\n\njump=(jump%frames)*2;\npos=(pos+jump);\n}\n}\n\npos+=1;\n   \n    vec4 coord = superArray(pos);\n    vec2 mxy=coord.xy;\n    vec2 txtcord = coord.zw/512.0;\n\n    \n    vec2 sizes = superArray(pos+1).xy;\n\n    if(a_step==1u||a_step==3u){\n    mxy.x+=sizes.x;\n    txtcord.x+=sizes.x/512.0;\n    }\n\n    if(a_step==2u||a_step==3u){\n    mxy.y+=sizes.y;\n    txtcord.y+=sizes.y/512.0;\n    }\n\n\n\n\theight = sizes.y/512.0;\n\n\tfloat z=a_position.z;\n\n\n    \nif(a_margins.x!=0.0&&(a_step==1u||a_step==3u)){\nmxy.x+=a_margins.x-sizes.x;\n}\n\n\nif(a_margins.y!=0.0&&(a_step==2u||a_step==3u)){\nmxy.y+=a_margins.y-sizes.y;\n}\n\n\n\tif(z<0.0){\n\tz*=-1.0;\nif(miniMap<2) mxy*=0.0;\n\t}\n\n\n\n\n\n\nif(a_margins.z!=0.0){\n\tfloat s = sin(a_margins.z);\n\tfloat c = cos(a_margins.z);\n\tmat2 m = mat2(c, -s, s, c);\n\tmxy.xy*=m;\n}\n\n\n\n    t = (now - a_physic.w) * 0.001;\n    mxy.x+=a_physic.x * t;\n\n\tfloat physicY=a_physic.y * t + a_physic.z * .5 * t * t;\n\n    mxy.y+=physicY;\n\n\nif(miniMap!=0){\n\tz=0.0;\n}else{\n\tz=(1.0 - (physicY+z)/ zMax)*.9;\n}\n\n\n   gl_Position = vec4((((a_position.xy+mxy) + u_translation) / u_resolution * 2.0 - 1.0) * vec2(zoom, -zoom), (z), 1.0);\n   vTextureCoord=txtcord;\n\nvec4 outColor=texelFetch(colorArray, ivec2(a_texCoord.z, 0), 0);\n\nif(a_texCoord.z>=kingdoms) outColor.a+=1.0;\n\n\n   v_kcolor=outColor;\n}\n";
b=f.createShader(f.VERTEX_SHADER);f.shaderSource(b,c);f.compileShader(b);var e=Ba?"precision highp float;\n\nuniform sampler2D lightmap;\nuniform vec2 u_resolution;\nuniform sampler2D img_common[7];\nuniform vec4 u_ambient;\nuniform mediump int miniMap;\nvarying vec4 v_kcolor;\nvarying highp vec2 vTextureCoord;\nvarying float height;\nvarying float rColor;\n\nvec4 getPixel(){\nhighp vec2 txtFinal=vTextureCoord;\nif(txtFinal.x>=512.0){\ntxtFinal.y+=height*floor((txtFinal.x)/512.0);\ntxtFinal.x=mod(txtFinal.x,512.0);\n}\n\n//if(txtFinal.x<1.0) return vec4(1.0,0.0,0.0,1.0);\n//if(txtFinal.y<1.0) return vec4(1.0,0.0,0.0,1.0);\n\n\n\ntxtFinal.x=txtFinal.x+floor(mod(txtFinal.y,8.0))*512.0;\n\n//if(txtFinal.x<1.0) return vec4(0.0,1.0,0.0,1.0);\n\ntxtFinal.y=floor(txtFinal.y/8.0);\n\ntxtFinal/=4096.0;\n\nif(txtFinal.y<1.0)\nreturn texture2D(img_common[0], txtFinal);\nelse if(txtFinal.y<2.0)\nreturn texture2D(img_common[1], txtFinal);\nelse if(txtFinal.y<3.0)\nreturn texture2D(img_common[2], txtFinal);\nelse if(txtFinal.y<4.0)\nreturn texture2D(img_common[3], txtFinal);\nelse if(txtFinal.y<5.0)\nreturn texture2D(img_common[4], txtFinal);\nelse if(txtFinal.y<6.0)\nreturn texture2D(img_common[5], txtFinal);\nelse if(txtFinal.y<7.0)\nreturn texture2D(img_common[6], txtFinal);\n}\n\n\nvoid main() {\n\n\nif(miniMap==0){\n\n\n\n\nvec4 color=getPixel();\n\n\n\n//vec4 color=vec4(1.0);\n \n\nif(color.a<0.5) discard;\n\n\nif(rColor==1.0 &&color.r==color.g&&color.r==color.b){\ncolor.rgb*=v_kcolor.rgb;\n}\n\nif(v_kcolor.a>1.0)\n{\ncolor*=v_kcolor-vec4(0.0,0.0,0.0,1.0);\n}\n\n\n\n\nvec4 light=vec4(1.0);\n\ngl_FragColor=color*light;\n}else{\n\nif(v_kcolor.a>1.0)\ngl_FragColor=v_kcolor-vec4(0.0,0.0,0.0,1.0);\nelse\ngl_FragColor=v_kcolor;\n}\n\n}":
"#version 300 es\nprecision highp float;\n\n\n\nuniform sampler2D lightmap;\nuniform vec2 u_resolution;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\nuniform mediump int miniMap;\nin vec4 v_kcolor;\nin highp vec2 vTextureCoord;\nin float height;\nflat in int rColor;\nout vec4 COLOR;\n\nvoid main() {\n\n\nif(miniMap==0){\n\n\n\n\nvec2 txtFinal=vTextureCoord;\n\nif(txtFinal.x>=1.0){\ntxtFinal.y+=height*floor(txtFinal.x);\n}\n\n\nvec4 color=texture(img_common, vec3(txtFinal, int(txtFinal.y)));\n \n\nif(color.a<0.5) discard;\n\n\nif(rColor==1 &&color.r==color.g&&color.r==color.b){\ncolor.rgb*=v_kcolor.rgb;\n}\n\nif(v_kcolor.a>1.0)\n{\ncolor*=v_kcolor-vec4(0.0,0.0,0.0,1.0);\n}\n\n\n\n\nvec4 light=vec4(1.0);\nlight = texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+vec4(1.0,1.0,1.0,0.0)*u_ambient;\n\nCOLOR=color*light;\n}else{\n\nif(v_kcolor.a>1.0)\nCOLOR=v_kcolor-vec4(0.0,0.0,0.0,1.0);\nelse\nCOLOR=v_kcolor;\n}\n\n}";
c=f.createShader(f.FRAGMENT_SHADER);f.shaderSource(c,e);f.compileShader(c);ea=f.createProgram();f.attachShader(ea,b);f.attachShader(ea,c);f.linkProgram(ea);f.useProgram(ea);(b=f.getShaderInfoLog(b))&&console.log("Shader compiler log1: "+b);(b=f.getShaderInfoLog(c))&&console.log("Shader compiler log1: "+b);c=Ba?"precision highp float;\nattribute vec3 a_position;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform mediump int miniMap;\nuniform float zoom;\n\nvoid main() {\nfloat depth;\nif(miniMap==1){\ndepth=.03;\n}else{\ndepth=1.0;\n}\ngl_Position = vec4(a_position.x, a_position.y, depth, 1.0);\n\n}":
"#version 300 es\nprecision highp float;\nin vec3 a_position;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform mediump int miniMap;\nuniform float zoom;\n\nvoid main() {\nfloat depth;\nif(miniMap==1){\ndepth=.03;\n}else{\ndepth=1.0;\n}\ngl_Position = vec4(a_position.x, a_position.y, depth, 1.0);\n\n}";b=f.createShader(f.VERTEX_SHADER);f.shaderSource(b,c);f.compileShader(b);e=Ba?"precision highp float;\n\nuniform float u_fps;\nuniform mediump int miniMap;\nuniform sampler2D img_common[7];\nuniform vec4 u_ambient;\n\nuniform vec2 u_translation;\nuniform vec2 u_light;\nuniform vec2 u_resolution;\nuniform vec2 minimapMargin;\nuniform sampler2D img_data;\nuniform sampler2D lightmap;\nuniform float zoom;\nuniform float mx;\nuniform float mapSize;\n\nuniform sampler2D u_image1;\n\nvec4 superArray(highp float position) {\nhighp vec2 xy = vec2(mod(position,512.0) ,   floor(position/512.0) )/512.0;\nreturn (texture2D(u_image1, xy));\n}\n\nvec4 sptexture3D(vec2 txtFinal,float height) {\n\nif(txtFinal.x>=512.0){\ntxtFinal.y+=height*floor((txtFinal.x)/512.0);\ntxtFinal.x=mod(txtFinal.x,512.0);\n}\n\n//if(txtFinal.x<1.0) return vec4(1.0,0.0,0.0,1.0);\n//if(txtFinal.y<1.0) return vec4(1.0,0.0,0.0,1.0);\n\n\n\ntxtFinal.x=txtFinal.x+floor(mod(txtFinal.y,8.0))*512.0;\n\n//if(txtFinal.x<1.0) return vec4(0.0,1.0,0.0,1.0);\n\ntxtFinal.y=floor(txtFinal.y/8.0);\n\ntxtFinal/=4096.0;\n\nif(txtFinal.y<1.0)\nreturn texture2D(img_common[0], txtFinal);\nelse if(txtFinal.y<2.0)\nreturn texture2D(img_common[1], txtFinal);\nelse if(txtFinal.y<3.0)\nreturn texture2D(img_common[2], txtFinal);\nelse if(txtFinal.y<4.0)\nreturn texture2D(img_common[3], txtFinal);\nelse if(txtFinal.y<5.0)\nreturn texture2D(img_common[4], txtFinal);\nelse if(txtFinal.y<6.0)\nreturn texture2D(img_common[5], txtFinal);\nelse if(txtFinal.y<7.0)\nreturn texture2D(img_common[6], txtFinal);\n\n}\n\nvoid main() {\nvec4 color;\n\nvec2 xy =  vec2(gl_FragCoord.x,u_resolution.y-gl_FragCoord.y)/zoom;\n\nif(miniMap==1){\nxy+=minimapMargin/zoom;\n}else{\nxy+=-u_translation+vec2(mx,0.0)/zoom+0.5*(u_resolution-u_resolution/zoom);\n}\n\n\nvec4 coords=texture2D(img_data,xy/(mapSize*32.0));\n\n\n//gl_FragColor=vec4(coords[0]);\n\n\nvec2 xy32=xy/32.0;\nvec2 floorxy32=floor(xy32);\nvec2 xyr=xy32-floorxy32;\nfloat pos;\n\nvec4 nrgb;\n\nif(coords.q!=0.0) nrgb=sptexture3D((coords.pq*512.0)+xyr*32.0,448.0);\n\n\n\nif(nrgb==vec4(1.0,0.0,1.0,1.0)) \npos=(coords[1]);\nelse\npos=(coords[0]);\n\n\n\nif(nrgb!=vec4(0.0,0.0,0.0,0.0)&&nrgb!=vec4(1.0,0.0,1.0,1.0)){\ncolor=nrgb;\n}else{\n\nvec4 frames=superArray(pos);\n\nfloat fps=frames[1];\n\nfloat jump=mod(floor(u_fps * fps*0.001),(frames[0])) * 2.0+1.0;  \njump=1.0;\nvec4 info=superArray(pos+jump);\n\n\n\n\n\nvec2 wh=superArray(pos+1.0+jump).xy;\n\nvec2 nxy=vec2(mod(xy.x,wh.x),mod(xy.y,wh.y));\n\n\ncolor=sptexture3D((info.pq+nxy),wh.t);\n//color=sptexture3D(vec2(500.0,240.0),50.0);\n\n//if(miniMap==0) light = (texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+1.0);\n\n}\n\n\nvec4 tlight=sptexture3D(  (u_light+vec2(mod(xy.x,512.0),mod(xy.y,512.0))),512.0    );\n\n\ngl_FragColor=color*u_ambient*(vec4(.5)+tlight*.75);\n}":
"#version 300 es\nprecision highp float;\n\nuniform float u_fps;\nuniform mediump int miniMap;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\n\nuniform vec2 u_translation;\nuniform vec2 u_light;\nuniform vec2 u_resolution;\nuniform vec2 minimapMargin;\nuniform sampler2D img_data;\nuniform sampler2D lightmap;\nout vec4 COLOR;\nuniform float zoom;\nuniform float mx;\nuniform float mapSize;\n\n\nuniform sampler2D u_image1;\nvec4 superArray(in highp int position) {\n     return(texelFetch(u_image1, ivec2(\t\t(position%512)\t\t,\tposition/512\t), 0));\n}\n\nvec4 sptexture3D(in vec2 coords,float h) {\nif(coords.x>=1.0){\ncoords.y+=h*floor(coords.x)/512.0;\n}\n    return(\ttexture(img_common, vec3(coords,int(coords.y)))\t);\n}\n\nvoid main() {\nvec4 color;\n\nvec2 xy =  vec2(gl_FragCoord.x,u_resolution.y-gl_FragCoord.y)/zoom;\n\nif(miniMap==1){\nxy+=minimapMargin/zoom;\n}else{\nxy+=-u_translation+vec2(mx,0.0)/zoom+0.5*(u_resolution-u_resolution/zoom);\n}\n\n\nvec4 coords=texture(img_data,xy/(mapSize*32.0));\nvec2 xy32=xy/32.0;\nvec2 floorxy32=floor(xy32);\nvec2 xyr=xy32-floorxy32;\nhighp int pos;\n\nvec4 nrgb;\n\nif(coords.q!=0.0) nrgb=sptexture3D((coords.pq)+xyr/16.0,448.0);\n\n\nif(nrgb==vec4(1.0,0.0,1.0,1.0)) \npos=int(coords[1]);\nelse\npos=int(coords[0]);\n\n\n\nif(nrgb!=vec4(0.0,0.0,0.0,0.0)&&nrgb!=vec4(1.0,0.0,1.0,1.0)){\ncolor=nrgb;\n}else{\n\nvec4 frames=superArray(pos);\n\nfloat fps=frames[1];\n\nhighp int jump=(int(floor(u_fps * fps*0.001))%int(frames[0])) * 2+1;  \n//jump=1;\nvec4 info=superArray(pos+jump);\n\n\n\n\n\nvec2 wh=superArray(pos+1+jump).xy;\n\nvec2 nxy=vec2(mod(xy.x,wh.x),mod(xy.y,wh.y));\n\n\ncolor=sptexture3D((info.pq+nxy)/512.0,wh.t);\n\n\n//if(miniMap==0) light = (texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+1.0);\n\n}\n\n\nvec4 tlight=sptexture3D(  (u_light+vec2(mod(xy.x,512.0),mod(xy.y,512.0)))/512.0,512.0    );\n\n\n\n//\nCOLOR=color*u_ambient*(vec4(.5)+tlight*.75);\n}";
c=f.createShader(f.FRAGMENT_SHADER);f.shaderSource(c,e);f.compileShader(c);aa=f.createProgram();f.attachShader(aa,b);f.attachShader(aa,c);f.linkProgram(aa);(b=f.getShaderInfoLog(b))&&console.log("Shader1 compiler log T: "+b);(b=f.getShaderInfoLog(c))&&console.log("Shader compiler log T: "+b)}b=f.getAttribLocation(ea,"a_position");c=f.getAttribLocation(ea,"a_texCoord");e=f.getAttribLocation(ea,"a_step");var d=f.getAttribLocation(ea,"a_physic"),h=f.getAttribLocation(ea,"a_margins");f.useProgram(aa);
var l=f.getUniformLocation(aa,"minimapMargin");he=f.getUniformLocation(aa,"u_translation");Wh=f.getUniformLocation(aa,"u_resolution");Vh=f.getUniformLocation(aa,"u_fps");pk=f.getUniformLocation(aa,"u_ambient");jd=f.getUniformLocation(aa,"zoom");var m=f.getUniformLocation(aa,"mx"),q=f.getUniformLocation(aa,"mapSize");f.getUniformLocation(aa,"borderCoords");f.getUniformLocation(aa,"waterBorder");Sf=f.getUniformLocation(aa,"miniMap");f.uniform1i(Sf,0);f.uniform2fv(he,[0,0]);f.uniform1f(Vh,-1);f.uniform1f(jd,
1);f.uniform1f(m,-w.mx);f.uniform1f(q,H);f.uniform2fv(f.getUniformLocation(aa,"u_light"),Lk);t.editor?f.uniform2fv(l,[0,-60]):f.uniform2fv(l,[-4,-31]);l=f.getAttribLocation(aa,"a_position");Xh=Mk();kd(Xh);m=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,m);f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,-1,1,1,-1,1]),f.STATIC_DRAW);f.enableVertexAttribArray(l);f.vertexAttribPointer(l,2,f.FLOAT,!1,0,0);kd(null);f.useProgram(ea);f.bindBuffer(f.ARRAY_BUFFER,null);Yh=Mk();kd(Yh);Fk=f.createBuffer();
f.bindBuffer(f.ARRAY_BUFFER,Fk);f.enableVertexAttribArray(e);Ba?(Tf=f.getExtension("ANGLE_instanced_arrays"),f.vertexAttribPointer(e,1,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,1,2,1,2,3]),f.STATIC_DRAW),Tf.vertexAttribDivisorANGLE(e,0)):(f.vertexAttribIPointer(e,1,f.UNSIGNED_BYTE,0,0),f.bufferData(f.ARRAY_BUFFER,new Uint8Array([0,1,2,1,2,3]),f.STATIC_DRAW),f.vertexAttribDivisor(e,0));Gk=Math.floor(H*Da/2);Ph=ie(c,3);Qh=ie(b,3);Rh=ie(d,4);Sh=ie(h,3);kd(null);Rf=f.getUniformLocation(ea,
"u_resolution");qk=f.getUniformLocation(ea,"u_ambient");ge=f.getUniformLocation(ea,"u_translation");hd=f.getUniformLocation(ea,"zoom");Ek=f.getUniformLocation(ea,"now");fe=f.getUniformLocation(ea,"miniMap");b=f.getUniformLocation(ea,"zMax");f.uniform1f(b,t.zMax);f.uniform1i(fe,0);f.useProgram(ea);c=id(z.sharedDelayID(),1323);t.daylength||(t.daylength=2880);t.initialhour||(t.initialhour=12);b=0;for(e=Fb.length;b<e;b++).55>Fb[b]&&(Fb[b]=.55);jj();f.uniform1f(hd,1);f.uniform2fv(ge,[0,0]);Jc=f.createFramebuffer();
Vf.changed=0;window.addEventListener("resize",Vf,!1);Vf();f.blendEquation(f.FUNC_ADD);f.blendFunc(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA);f.disable(f.DITHER);f.disable(f.BLEND);performance.now();Kc(1);if(!je){f.uniform1f(f.getUniformLocation(ea,"kingdoms"),z.nkingdom());d=De(z.getColorTexture(),4*(z.nkingdom()+7));f.activeTexture(f.TEXTURE4);e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);if(Ba){h=new Uint8Array(4*Math.pow(64,2));for(b=0;b<h.length;b++)h[b]=d[b];f.texImage2D(f.TEXTURE_2D,0,f.RGBA,64,
64,0,f.RGBA,f.UNSIGNED_BYTE,h);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);C(d,h)}else f.texImage2D(f.TEXTURE_2D,0,f.RGBA,d.length/4,1,0,f.RGBA,f.UNSIGNED_BYTE,d),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,
f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT);f.bindTexture(f.TEXTURE_2D,null);f.bindTexture(f.TEXTURE_2D,e);f.uniform1i(f.getUniformLocation(ea,"colorArray"),4);f.activeTexture(f.TEXTURE3);e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);if(Ba){f.getExtension("OES_texture_float");d=new Float32Array(65536);for(b=0;b<d.length;b++)d[4*b]=c[b];f.texImage2D(f.TEXTURE_2D,0,f.RGBA,128,128,0,f.RGBA,f.FLOAT,d);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);
f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST)}else f.texImage2D(f.TEXTURE_2D,0,f.R16F,c.length,1,0,f.RED,f.FLOAT,c),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT);f.bindTexture(f.TEXTURE_2D,
null);f.bindTexture(f.TEXTURE_2D,e);f.uniform1i(f.getUniformLocation(ea,"delay"),3);f.activeTexture(f.TEXTURE2);Dk=f.createTexture();f.bindTexture(f.TEXTURE_2D,Dk);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,1,1,0,f.RGBA,f.UNSIGNED_BYTE,new Uint8Array([255,255,255,255]));f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT);f.clearColor(0,
0,0,1)}f.bindFramebuffer(f.FRAMEBUFFER,Jc);Jc.width=1;Jc.height=1;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,ld,0);f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT);f.bindFramebuffer(f.FRAMEBUFFER,null);new Float32Array(8);z.setupGL();f.enable(f.DEPTH_TEST);f.depthFunc(f.LEQUAL);xa.fp1000=1E3;xa.delta=0;xa.now=0;xa.frameCount=0;f.bindTexture(f.TEXTURE_2D,ld);je=ca.setup=!0;z.preldd()||z.randomMap();C(oa,ha);Db.check()},Db=function(){for(var b=["loading","playermenu","index"],
c=b.length,e=0;e<c;p(b[e++]).style.display="none");Dh();fd();Yk();window.addEventListener("keydown",Om);window.addEventListener("keyup",Pm);window.addEventListener("mousemove",Tm);window.addEventListener("touchstart",Qm);window.addEventListener("touchmove",Rm);window.addEventListener("touchend",Sm);window.addEventListener("wheel",rk,!1);window.addEventListener("mousedown",Um);window.addEventListener("mouseup",Vm);ng=performance.now()-ng;C("FULL: ",ng);t.online?(C("readyyyy"),z.plready()):me();t.allow14=
!1};Db.check=function(){Db.load++;Db.load===Db.target&&Db()};Db.target=2;var ne=function(){for(var b=Za.length,c=Za,e="",d=0;d<b;d++){var h=c[d];ne.obj[h.id]||h.id==w.onlineID||(e+="<br>"+h.nhinfo.name)}return e};ne.obj={};var Zk=function(){return w.gl?!1:(Cb("You can't run WEBGL 2<br>More info <a href='http://webglreport.com/?v=2'>here</a>","Error"),ec(),!0)},si=function(){var b=document.documentElement;b.requestFullscreen?b.requestFullscreen():b.msRequestFullscreen?b.msRequestFullscreen():b.mozRequestFullScreen?
b.mozRequestFullScreen():b.webkitRequestFullscreen&&b.webkitRequestFullscreen()},ue=function(b){var c=document.createElement("div");c.id=b;document.body.appendChild(c)},nd=function(b){Zk()||(If(),Ie(),window.onbeforeunload=function(){return"Are you sure you want to quit?"},Db.load=0,b&&"true"==localStorage.fullscreen&&si(),t.editor?(w.marx=0,w.mary=60,w.menumy=60,Ya=qc=171,w.mx=171,w.menumx=171):(w.mx=151,Ya=qc=128,w.menumx=151,w.menumy=0,w.marx=4,w.mary=31),mc.style.width=qc+"px",mc.style.height=
Ya+"px",mc.style.left=w.marx+"px",mc.style.top=w.mary+"px",ue("loading"),""==p("loading").innerHTML&&(p("loading").innerHTML='<p id="loadingtext"></p>\n<div>\n<div id=\'logo\' class="svgnehhon"></div>\n<span id="netral">NEHHON NETRAL-H ENGINE</span>\n</div>'),origin=!1,z.mapWidth()||Qc(),Ad())},di,Dh=function(){var b=p("playersinfo");b.innerHTML="";if(!t.editor)for(var c=1,e=I.length;c<e;c++){var d=I[c],h=d.death?d.name.strike():d.name;b.innerHTML+=h+"<span id='score"+c+"'></span><div class='playercolor' style='background:rgb("+
d.color[0]+","+d.color[1]+","+d.color[2]+")'></div><span class='ping'>"+(void 0!=I[c].ping&&" "+I[c].ping+"ms"||"")+"</span><br>"}},Yk=function(){var b=window.innerWidth-w.mx,c=window.innerHeight,e=z.empXY(),d=e%H,h=~~(e/H);e?(b=32*d-.5*b,c=32*h-.5*c):c=b=0;ad(~~b,~~c)},ce,Oh,uk,cm=function(){var b=p("selectedobject").getContext("webgl",{antialias:!1,depth:!1}),c=b.createShader(b.VERTEX_SHADER);b.shaderSource(c,"void main() {\ngl_Position = vec4(0 ,0, 0, 1);\ngl_PointSize=48.0;\n}");b.compileShader(c);
var e=b.createShader(b.FRAGMENT_SHADER);b.shaderSource(e,"precision mediump float;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nuniform float txtCoord;\nvoid main() {\ngl_FragColor = texture2D(u_image, (vec2(\tmod(txtCoord,21.0) ,floor(txtCoord/21.0) ) + gl_PointCoord)*(0.046875));\nif(gl_FragColor.r==gl_FragColor.g&&gl_FragColor.r==gl_FragColor.b) gl_FragColor*=u_color;\n}");b.compileShader(e);var d=b.createProgram();b.attachShader(d,c);b.attachShader(d,e);b.linkProgram(d);b.useProgram(d);
c=b.createTexture();b.bindTexture(b.TEXTURE_2D,c);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texImage2D(b.TEXTURE_2D,0,b.RGB,b.RGB,b.UNSIGNED_BYTE,qa.icons);var h=b.getUniformLocation(d,"u_color"),f=b.getUniformLocation(d,"txtCoord");ce=function(c){b.uniform4f(h,1,1,1,1);b.uniform1f(f,c);b.drawArrays(b.POINTS,
0,1)};Oh=function(){b.uniform4f(h,1,1,1,1);b.uniform1f(f,189);b.drawArrays(b.POINTS,0,1)};uk=function(){b.uniform1f(f,0);b.uniform4f(h,0,0,0,0);b.drawArrays(b.POINTS,0,1)}},qc=128,Ya=128,A=[{terrain:1},{terrain:1},{terrain:1}],lc={};window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(b){window.setTimeout(b,1E3/60)}}();var Za=[];window.addEventListener("offline",function(b){zd("Offline","#ff0000")});
window.addEventListener("online",function(b){zd("Online","#00ff00")});var od={};(function(){for(var b=["returnmenu","index","Account","accountIframe"],c=0,e=b.length;c<e;od[b[c]]=p(b[c++]));})();var ei=!1,cn=function(){ei=!0;location.replace("#"+this.gameID+"Room");fi(this.gameID)},fi=function(b){Za=[];$k();C("connecting to",b,r.MSG_GAME_LOAD);p("game").style.display="block";p("gameName").innerHTML=r.MSG_GAME_LOAD;p("returnmenu").style.display="none";p("index").style.display="none";bc.innerHTML="";
cc=[];w.p2p?(Ia.joinRoom(b,Ag),Ie()):(Ia||Bb(),Bb.func=function(){fi(b)})},dn={6400900:".",28462225:"a",29052100:"b",29648025:"c",3025E4:"d",30858025:"e",31472100:"f",32092225:"g",32718400:"h",33350625:"i",33988900:"j",34633225:"k",35283600:"l",35940025:"m",36602500:"n",37271025:"o",37945600:"p",38626225:"q",39312900:"r",40005625:"s",40704400:"t",41409225:"u",42120100:"v",42837025:"w",4356E4:"x",44289025:"y",45024100:"z"},al=function(b){M("game");pd.length=0;t.online=0;Wb=t.id=void 0;Ia.leaveRoom();
Za.length=0;ec();z.closeRoom();b.constructor==String&&Cb(b)},Am={euro:0,arab:0,asia:0},cc,bl=function(b,c,e){cc=b;qd()},cl=function(b){for(var c=0,e=Za.length;c<e;c++){var d=Za[c];if(d.id==b)return d}},Ia,el=function(b){if(!p("usernameForm")){vc();var c=localStorage.name||"Guest",e=localStorage.color||"#"+Math.floor(16777215*Math.random()).toString(16),d=document.createElement("div");d.id="usernameForm";d.innerHTML="\n            <div>\n            <h2>"+r.MP_SEARCH_T_PL_NAME+'</h2>\n            <div>\n<input type="color" id=\'usernameColor\' value="'+
e+'" /><input id=\'usernameVal\' type="text" value="'+dl(c)+'" />\n</div>\n<br />\n</div>';c=document.createElement("button");c.innerHTML=r.MSG_SYS_CONT;c.onclick=function(){w.name=Va(p("usernameVal").value);w.color=p("usernameColor").value;localStorage.color=w.color;localStorage.name=w.name;document.body.removeChild(p("usernameForm"));b();Ab()};d.children[0].appendChild(c);document.body.appendChild(d)}},ti=function(b){for(var c=0,e=0;e<b.length;e++)c+=b.charCodeAt(e)*e+(c&e);C(c,"id");return c%4294967295},
Bb=function(){Zk()||(w.name?(Xl(),Ia=new SimpleWebRTC({localVideoEl:"",remoteVideosEl:"",autoRequestMedia:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},url:"https://gthsolar0.herokuapp.com"}),Ia.on("channelMessage",function(b,c,e){c=z.tempointeradd(e.length);c=new Uint32Array(g.buffer,c,e.length);for(var d=0;d<e.length;d++)c[d]=e[d];z.onldata(b.superID)}),Ia.on("error",function(b){"full"==b&&(ec(),zd(r.ERR_GAMEFULL,"#ff0000"))}),Ia.on("connectionReady",function(b){var c=Ia.connection.connection;
w.p2p=c;w.superID=ti(c.id);z.setupOnlID(w.superID);c.username=w.name;c.color=w.color;c.on("getRooms",function(b){var c=b.date,e=Object.keys(b),k=p("gameList");if(1<e.length){k.innerHTML="";for(var f=0,g=e.length;f<g;f++){var m=e[f],q=b[m];if("date"!=m){var t=q.len;if(t){var v=document.createElement("tr"),w="";w=q.playing?w+("<td><div class='redCircle'></div>"+r.PLAYING+"</td>"):w+("<td><div class='redCircle' style=\"background:rgba(0,255,0,.8); box-shadow:0px 0px 20px rgba(0,255,0,.8)\"></div>"+r.WAITING+
"</td></td>");w+="<td>"+Va(q.description)+"</td><td>"+~~((c-q.date)/6E4)+" min ago</td><td>"+Va(t)+"/"+Va(q.max)+"</td>";v.innerHTML=w;v.gameID=m;q.playing||(v.onclick=cn);k.appendChild(v)}}}}else k.innerHTML="<tr><td>"+r.NO_GAMES_FOUND+"</td></tr>"});w.onlineID=b;Bb.func&&Bb.func()}),Ia.on("createdPeer",function(b){t.started||Ll(b)})):el(Bb))},en=function(){Ie();Ab();$k();ka("game");M("returnmenu");M("index");p("gameName").innerHTML=r.MSG_GAME_LOAD;bc.innerHTML="";Za=[];Nc();w.admin=1;w.room={description:p("gameFormName").value,
max:parseInt(p("gameMax").value),public:!0};2>w.room.max&&(w.room.max=2);14<w.room.max&&(w.room.max=14);localStorage.gameDescription=w.room.description;Ia.createRoom(w.onlineID+"b",Ag);t.online=1;document.body.removeChild(p("gameForm"));cc=[w.onlineID];Qc();z.setupOnlTable(w.room.max+1);Pc(z.onlADD(0,0,parseInt(w.color.substr(1),16),w.superID,0),17,w.name);qd()},ui=function(){Ia||Bb();if(w.onlineID){vc();var b=localStorage.gameDescription||w.name+"'s room",c=document.createElement("div");c.id="gameForm";
c.innerHTML="\n<div>\n            <h2>"+r.OPTIONS_T_GOPT+"</h2>\n            "+r.EDIT_T_GAMENAME+': <input id=\'gameFormName\' type="text" value="'+b+'" maxlength="29" /><br />\n'+r.SP_SETUPMAP_T_NUM_PLAYERS+': <input id="gameMax" type="number" value="6" max="14" min="2"/><br />\n            </div>';b=document.createElement("button");b.innerHTML=r.MSG_SYS_CONT;b.onclick=en;c.children[0].appendChild(b);document.body.appendChild(c)}else setTimeout(function(){location.hash=""},200),Bb.func=ui},fl=function(b){for(var c=
"kingdom d type img x32 y32 name iconID attack defence level health maxHealth func funcObj workers workingOn inventory dix diy timestamp working rnd techID techStart activeTech levelProgress c mimg built xf yf action point waitlist mv work death freezed confused sword shield book spy stock".split(" "),e=[],d=b.length,k=0;k<d;k++){var f=b[k],g=Object.keys(f),m={};e.put(m);for(var p=0,q=g.length;p<q;p++)m[c[g[p]]]=f[g[p]]}return e},Nl=function(){var b=z.savegame(),c=De(b,Lc[0]),e=Lc[1];C(c,b);b=new Blob([new Uint32Array([e]),
c],{type:"application/octet-binary"});fn({name:"Savegame",played:25*z.gcycle(),date:Date.now()},b);p("saveGame").innerHTML="Done";setTimeout(function(){p("saveGame").innerHTML=r.ENDGAMEDLG_SAVE},800)},gn=function(){Za.length&&(Qc(),z.strOnl(),w.p2p.emit("gameStarted"))},oe=function(b,c,e){if(e){if(ne.obj[e.id])return;ne.obj[e.id]=1;b=ne();""==b?Cb(b,r.MSG_GAME_LOAD,1):Cb(b,r.VIEWMSG_WAIT_PLAYERS,1)}w.admin&&(oe.i++,C(oe.i,pd.length,e),oe.i==pd.length-t.bots&&setTimeout(function(){C(999999999,44444)},
100))};oe.i=0;var me=function(){Ab();p("alert")&&hdid("alert");t.started=1;t.date=Date.now();$b();Ha();z.startMovement();xa()};me.fast=!0;var gl=function(b,c,e){t.started=1;nd()},ee=!1,Ab=function(){ee=!1;p("basic").style.filter=""},vc=function(){ee=!0;p("basic").style.filter="blur(94px)"};var hl=function(){M("game");pd.length=0;t.id=void 0;t.online=0;Wb=void 0;t.compressed=void 0;t.arje=void 0;Ia.leaveRoom();Za.length=0;ec();w.admin=0;z.closeRoom()};var il=function(b,c,e){e&&(fb.arr=new Uint8Array(parseInt(b)),
fb.i=0,p("showGameInfo").innerHTML="<table><tr><td>Downloading custom map</td><td id='cmappr'></td></tr></table>")},fb=function(b,c,e){e&&(fb.arr.set(b,fb.i),fb.i+=b.length,p("cmappr").innerHTML=~~(100*fb.i/fb.arr.length+.5)+"%",fb.i==fb.arr.length&&jl(fb.arr))};fb.step=1E4;var jl=function(b){C(b[0]);var c=b[1]+(b[2]<<8)+(b[3]<<16)+(b[4]<<24),e=new TextDecoder("utf-8");e=JSON.parse(e.decode(b.slice(5,c+5)));if(!1===e.arje){c=b.slice(c+5,c+5+Math.pow(e.mapx,2));var d=Math.pow(e.mapx,2),k=c.length;
d=d?new Uint8Array(d):[];for(var f=0,g=0;g<k;g++){var m=c[g];if(255!==m)d[f++]=m;else{m=c[g-1];for(var p=(c[g+1]<<8)+c[g+2],q=0;q<p;q++)d[f++]=m;g+=2}}e.terrain=d}e.allunits&&(e.allunits=fl(e.allunits));e.ini&&(e.ini=fl(e.ini));e.custom=!0;Wb=e;Wb.online=!0;Wb.started=!1;Wb.editor=!1;w.admin&&(Wb.compressed=b);C("newmap",e);og(e);qd()},kl=function(b){b=parseInt(b);if(2>b||!b)b=2;14<b&&(b=14);b!==w.room.max&&(w.p2p.emit("maxPlayers",b-(cc.length-Za.length-1)),C(999999999,44444))},ll=function(b){w.room.max=
b;qd()},hn=function(){C(999999999,44444);p("optionbutton").style.display="inline-table";M("deleteCusMap")},jn=function(b,c){if(null==p(b)){var e=document.createElement("div");e.innerHTML=c;e.id=b;p("playermenu").appendChild(e);return!0}return!1},$k=function(){jn("game",'<h2 id="gameName"></h2>\n<p id="onlineTopInfo"></p>\n<div id="multi21">\n<table class="players" >\n<tbody id="multiplayertable">\n</tbody>\n</table>\n<div id="chat">\n<ul id="msgs">\n</ul>\n<input id="msginput" type="text" autocomplete="off" />\n<input id="sendmsg" type="submit" value="" />\n</div>\n</div>\n<div id="showGameInfo"></div>\n<div id="buttons"></div>')&&
(bc=p("msgs"),pg=p("msginput"),pg.addEventListener("keyup",function(b){13==b.keyCode&&Ih()}),p("sendmsg").onclick=Ih)},Ag=function(b){if((w.admin||b)&&!t.id)if(ka("game"),b=Ia.roomName,b+="Room",C("login"),Ab(),0!==Ia.getPeers().length||w.admin){var c=w.room||NaN;C(c);t.id=b;t.online=1;Nc();w.admin&&(p("onlineTopInfo").innerHTML=' <button id="addAI" style="padding: 6px;">'+r.ADD_AI+'</button><span style="float:right">'+r.SP_SETUPMAP_T_NUM_PLAYERS+'<input id="nplayersO" min="2" type="number" max="14" value="'+
w.room.max+'" /></span>',p("nplayersO").onchange=function(){var b=this.value;b<cc.length&&(b=cc.length);C(cc.length,b);cc.length!=b||Za.length||b++;kl(b);this.value=w.room.max},p("addAI").onclick=function(){z.onlCount()<w.room.max&&(Pc(z.onlADD(0,0,16777216*Math.random(),0,1),17,"AI"),w.p2p.emit("maxPlayers",w.room.max-z.nAIs()),z.sndNfo())});p("copyButton")&&(p("copyButton").onclick=function(){p("onlineID").select();document.execCommand("Copy")},p("onlineID").value=location.origin+"/#"+t.id);p("gameName").innerHTML=
Va(c.description)||"Online Game";M("returnmenu");w.admin?(location.replace("#"+t.id),p("buttons").innerHTML='<button id="startbutton">'+r.MP_MPLAYER_PLAY+'</button><button id="optionbutton">'+r.MENU_OPTI+'</button><button id="closebutton">'+r.GENERAL_CLOSE+'</button><br><input id="maploadOnline" type="file" /> <label style="display:none" for= "maploadOnline">'+r.strcusMap+'</label> <button id="deleteCusMap">'+r.randomMap+"</button>",p("startbutton").onclick=gn,p("optionbutton").onclick=ml,p("closebutton").onclick=
hl,p("maploadOnline").accept=".tzared",p("maploadOnline").onchange=kn,M("deleteCusMap"),p("deleteCusMap").onclick=hn):(p("buttons").innerHTML='<button id="quitbutton">'+r.MSG_DISCONNECT+"</button>",p("quitbutton").onclick=al);Ia.connection.on("remove",ln)}else location.hash="",ec()},ln=function(b){if(b=cl(b.id)){var c=sc(xb(z.empName(z.pidkingdom(b.superID)),17));Ub(Eh(r.VIEWMSG_PLAYER_DISCONECTED,c),0,5);Za.quit(b);z.deletePlayer(b.superID);b.admin&&!t.started&&al(r.ERR_SERVERCANCEL)}},yb=function(){0===
yb.active&&(C(999999999,44444),yb.date=Date.now(),yb.received=0,yb.max=-Infinity,yb.active=1)};yb.active=0;var nl=function(b,c,e){e&&C(999999999,44444)};nl.fast=!0;var gi={},hi=function(b){C(b);if(w.superID==b)return Cb(r.ERR_SERVERKICK),hl();(b=cl(b))&&b.end()},ol=document.getElementsByClassName("ucolor"),pl=document.getElementsByClassName("username"),ql=document.getElementsByClassName("race"),ii=document.getElementsByClassName("team"),Lb=function(b){if(w.admin){Lb.div&&(document.body.removeChild(Lb.div),
Lb.div=void 0);var c=b.pageX;b=b.pageY;var e=this.i2,d=document.createElement("div");d.style.top=b+"px";d.style.left=c+"px";d.className="onlPlayer";Lb.div=d;C(this.peer,this.i2);if(this.peer.name)c=document.createElement("button"),c.onclick=function(){z.userKick(e);w.p2p.emit("maxPlayers",z.onlCount());document.body.removeChild(d);Lb.div=void 0},c.innerHTML=r.GENERAL_KICK,d.appendChild(c);else{var k=this.peer;c=document.createElement("button");c.onclick=function(){z.updown(e,-1);document.body.removeChild(d);
Lb.div=void 0};c.innerHTML=r.UP;d.appendChild(c);c=document.createElement("button");c.onclick=function(){z.updown(e,1);document.body.removeChild(d);Lb.div=void 0};c.innerHTML=r.DOWN;d.appendChild(c);w.onlineID!=k&&(c=document.createElement("button"),c.onclick=function(){C(22222,k);z.userKick(e);w.p2p.emit("maxPlayers",z.onlCount());document.body.removeChild(d);Lb.div=void 0},c.innerHTML=r.GENERAL_KICK,d.appendChild(c))}c=document.createElement("button");c.onclick=function(){document.body.removeChild(d);
Lb.div=void 0};c.innerHTML=r.GENERAL_CLOSE;d.appendChild(c);document.body.appendChild(d)}},qd=function(){var b=p("multiplayertable"),c='<tr style="text-transform:uppercase"><td></td><td>'+r.MP_SEARCH_T_PL_NAME+"</td><td>"+r.RACE+"</td><td>"+r.TEAM+"</td></tr>",e=cc,d=z.nkingdom()-1||14;C("LENGTH",d);e&&d<e.length&&(d=e.length);for(e=0;e<d;e++)c+='<tr><td class="ucolor"></td><td class="username">'+r.MP_MPLAYER_NAME_2+'</td><td class="race"></td><td class="team"></td></tr>';6>d&&(c+='<tr style="height: '+
(260-46*d)+'px"></tr>');b.innerHTML=c;p("multiplayertable").getElementsByTagName("tr");z.onlineKingdoms();p("msgs").style.height=b.clientHeight-87+"px"},og=function(b,c,e,d,h,f,g,m,q,t,w){if(p("showGameInfo")){g="<table><tbody>";b==Math.pow(2,31)-1&&(b="***");e==Math.pow(2,31)-1&&(e="***");c==Math.pow(2,31)-1&&(c="***");d==Math.pow(2,31)-1&&(d="***");b=[r.VIEWMSG_GOLD,b,r.MP_SETUPMAP_T_MAP_SIZE,q,r.VIEWMSG_WOOD,e,r.MP_SETUPMAP_T_TERRAIN,f,r.VIEWMSG_FOOD,c,r.INITIAL_PEASANTS,t,r.VIEWMSG_STONE,d,r.WATER,
h,r.FREE_POP,w];c=b.length;for(e=0;e<c;e+=2)e%4||(e&&(g+="</tr>"),g+="<tr>"),g+="<td>"+b[e]+":</td><td>"+b[e+1]+"</td>";g+="</tbody></table>";C(g);return p("showGameInfo").innerHTML=g}},pd=[],ve=Xb,mn=function(){Ie();document.body.removeChild(p("connectConfirm"));var b=location.hash.substr(1);fi(b.substr(0,b.length-4))},vi=function(){if(ei)ei=!1;else if(!w.admin){var b=document.createElement("div");document.body.appendChild(b);b.id="connectConfirm";b.innerHTML="<button>"+r.CLICKJOIN+"</button>";b.onclick=
mn;Bb()}};window.onhashchange=qi;var bc,pg,Ub=function(b,c,e,d){na("chat");e&&(c=z.gstarted()?pc:bc,c.innerHTML=5!==e?c.innerHTML+("<li><span>"+sc(xb(e,17))+" \u2014</span> "+sc(xb(b,d))+"</li>"):c.innerHTML+("<li>"+b+"</li>"),c.scrollTop=c.scrollHeight,z.gstarted()&&qg())};Ub.fast=!0;var qg=function(){11==bc.children.length&&pc.removeChild(pc.children[0]);1==bc.children.length&&(qg.intv=setInterval(nn,16E3))},nn=function(){pc.removeChild(pc.children[0]);0==bc.children.length&&clearInterval(qg.intv)},
Va=function(b){return String(b).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},dl=function(b){return String(b).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},Ih=function(){if(t.started){var b=pc,c=p("msginputGame").value;p("msginputGame").value=""}else b=bc,c=pg.value,pg.value="";""!=c&&(c=Va(c),b.innerHTML+="<li><span>"+w.name+" \u2014</span> "+c+"</li>",Pc(z.tempstradd(),1024,c),z.liveChat(c.length),b.scrollTop=b.scrollHeight,t.started&&qg())},rl=[gl,Ib,Qe,
Rb,Re,Nd,hh,Ub,kj,Od,Pd,Bk,Ye,tk,uj,kh,mj,oe,nl,function(b,c,e){e&&(e.ping=~~(.5*(Date.now()-yb.date)+.5),gi[e.id]?gi[e.id].put(e.ping):gi[e.id]=[e.ping],e.ping>yb.max&&(yb.max=e.ping),yb.received++,yb.received==Za.length&&(yb.active=0,t.started&&(I[e.kingdom].ping=e.ping,Dh())))},vk,me,vj,uh,sf,wh,Tj,Pe,df,gf,Cf,xh,yh,lf,Cj,tf,rh,Lj,Xg,jf,th,Ef,yf,Pj,Gf,pf,nf,Af,Ah,nk,Qj,Ej,og,function(b,c,e){if(!t.started&&e){C("peerInfo",b);b.name=Va(b.name);b.team=parseInt(b.team);0>b.team&&(b.team=0);b.team%=
6;b.race=parseInt(b.race);if(0>b.race||2<b.race)b.race=0;c=b.version;e&&e.admin&&c!=w.version&&(ec(),Ia.leaveRoom(),Cb(r.ERR_INCORRECTVER+"<p> Admin version: "+parseFloat(c.substr(1))+"<br> Your version: "+parseFloat(w.version.substr(1))));e.nhinfo=b;e.username=b.name;qd()}},bl,fb,hi,ll,aj,il],sl=function(b,c,e){return e&&e.admin},pe=function(b,c,e){return(e&&e.admin||!e)&&!t.started},X=function(b,c,e){b=c.length;e=I[e.kingdom].control;for(var d=0;d<b;d++)if(!e[A[c[d]].kingdom])return!1;return!0},
rg=function(b,c,e){b=I[e.kingdom].control;c=A[c];return b[c.kingdom]?!0:!1},ji=function(b,c,e){c=I[e.kingdom].control;b=A[b];return c[b.kingdom]?!0:!1};gl.secureNH=pe;Ib.secureNH=X;Qe.secureNH=X;Rb.secureNH=X;Re.secureNH=X;Nd.secureNH=X;hh.secureNH=X;kj.secureNH=X;Od.secureNH=X;Pd.secureNH=X;Bk.secureNH=ji;Ye.secureNH=X;tk.secureNH=X;uj.secureNH=X;kh.secureNH=X;mj.secureNH=rg;vk.secureNH=X;me.secureNH=function(b,c,e){return e&&e.admin||!e};vj.secureNH=rg;uh.secureNH=X;sf.secureNH=X;wh.secureNH=X;
Tj.secureNH=ji;Pe.secureNH=X;df.secureNH=X;gf.secureNH=X;Cf.secureNH=X;xh.secureNH=X;yh.secureNH=X;lf.secureNH=X;Cj.secureNH=X;tf.secureNH=ji;rh.secureNH=X;Lj.secureNH=X;Xg.secureNH=X;jf.secureNH=X;th.secureNH=X;Ef.secureNH=X;yf.secureNH=X;Pj.secureNH=X;Gf.secureNH=X;pf.secureNH=X;nf.secureNH=X;Af.secureNH=X;Ah.secureNH=X;nk.secureNH=rg;Qj.secureNH=rg;Ej.secureNH=X;og.secureNH=pe;bl.secureNH=pe;hi.secureNH=pe;ll.secureNH=pe;il.secureNH=sl;fb.secureNH=sl;aj.secureNH=function(b,c,e){return!e};(function(){for(var b=
0,c=rl.length;b<c;b++)rl[b].location=b})();var tl=document.getElementsByClassName("ucolor1"),on=document.getElementsByClassName("username1"),pn=document.getElementsByClassName("race1"),qn=document.getElementsByClassName("team1"),ul=function(b){var c=1;2==b.button&&(c=-1);this.innerHTML=z.changeTeam(this.iteam,c)},vl=function(b){var c=1;2==b.button&&(c=-1);this.innerHTML=La[z.changeRace(this.iteam,c)]},wl=function(){C(this.value);this.parentElement.style.background=this.value;z.changeColor(this.iteam,
parseInt(this.value.substr(1),16))},rn=function(){z.randomKingdoms(1)},sn=function(){z.randomKingdoms(-1)},ym={0:"euro",1:"arab",2:"asia"},xl=function(b,c,e,d,f,l,g){var k="#"+d.toString(16);b=sc(xb(b,17));var h=p("multiplayertable").getElementsByTagName("tr"),m=l==w.superID,n=f+1;d=parseInt(k.substr(1),16);d=[d>>16&255,d>>8&255,d&255];ol[f].style.background="rgb("+d[0]+","+d[1]+","+d[2]+")";pl[f].innerHTML=b;g&&(pl[f].style.color="#fff900");m||g&&w.admin?(ii[f].innerHTML="",b=document.createElement("button"),
b.onmousedown=ul,b.iteam=n,b.innerHTML=c,ii[f].appendChild(b),g&&(b.style.color="#fff900"),b=document.createElement("button"),b.onmousedown=vl,b.iteam=n,b.innerHTML=La[e],ql[f].appendChild(b),g&&(b.style.color="#fff900"),c=document.createElement("input"),c.type="color",c.iteam=n,c.value=k,ol[f].appendChild(c),c.onchange=wl):(ii[f].innerHTML=c,ql[f].innerHTML=La[e]);w.admin&&!m&&(h[f+1].onclick=Lb,h[f+1].peer=l,h[f+1].i2=f+1)},yl=function(){w.name?(""==p("RandomMap").innerHTML&&(p("RandomMap").innerHTML=
"<h2>"+r.MP_SETUPMAP_T_RANDOM+'</h2><div>\n            <table class="players" id="oneplayertable">\n                <tbody id="oneplayertbody">\n                </tbody>\n            </table>\n            <button style="margin-left:40px" id="start2" class="start startButton">'+r.MP_MPLAYER_PLAY+'</button>\n            <button class="start optionsButton" id="start1">'+r.MENU_OPTI+"</button>\n        </div>",p("start1").onclick=ml,p("start2").onclick=nd),ka("returnmenu"),z.randomKingdoms()):el(yl)},
zl=function(b){b=b.target.result;var c=new Uint8Array(b,4);b=(new Uint32Array(b,0,1))[0];C(b,c);for(var e=c.length,d=z.readSavegame0(e),k=0;k<e;k++)Rc[d+k]=c[k];z.readSVG(4*b,e,!0);ka("customMapcont");p("closeCustom").style.display="inline-table";p("custombody").innerHTML="";z.customMapTable()},em=function(b){ca.terrain=Al(b,323,253036);ca.check()},dm=function(b){Al(b,0,0);m={};ca.check()},Al=function(b,c,e){var d=new Uint8Array(b,24),f=z.nh19add(d.length);f=De(f,d.length);for(var k=0;k<d.length;k++)f[k]=
d[k];b=new Uint32Array(b,0,6);d=performance.now();z.rdnh19(b[0],b[1],b[2],b[3],b[4],b[5],c,e);C(performance.now()-d)},Ee=function(b,c,e){if(ya&&Ce&&-1<Ce.indexOf(b))return Ce.push(b),C("cache:",b),tn("basic",c,b);var d=new XMLHttpRequest;d.open("GET",b,!0);d.responseType="arraybuffer";d.onload=function(d){d=d.target.response;Oi({url:b,buffer:d});c(d)};e&&(d.onprogress=e);d.send()},bn=function(b,c,e){"granted"!=Notification.permission&&Notification.requestPermission(function(b){});var d=new Notification(b,
{icon:"/nehhon/807.png",body:c,requireInteraction:!1});e||(e=5550);setTimeout(function(){d.close()},e)},Qk,Bl=function(b){for(var c="",e=0,d=b.length;e<d;e++)c+=dn[b[e]];return c};Zl[Bl([32718400,37271025,40005625,40704400,36602500,28462225,35940025,30858025])]!==Bl([40704400,45024100,28462225,6400900,39312900,30858025,3025E4])&&(C("edge chrome firefox - compt"),Rk=Xb);var Kc=function(b){if(b){Kc.update=!1;var c=performance.now();b=id(z.configTerrain(),H*H*4);C(performance.now()-c);f.useProgram(aa);
f.activeTexture(f.TEXTURE1);c=f.createTexture();f.bindTexture(f.TEXTURE_2D,c);f.pixelStorei(f.UNPACK_ALIGNMENT,1);Ba?(f.getExtension("OES_texture_float"),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,H,Da,0,f.RGBA,f.FLOAT,b)):f.texImage2D(f.TEXTURE_2D,0,f.RGBA32F,H,Da,0,f.RGBA,f.FLOAT,b);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,
f.REPEAT);f.bindTexture(f.TEXTURE_2D,null);f.bindTexture(f.TEXTURE_2D,c);f.uniform1i(f.getUniformLocation(aa,"img_data"),1);f.useProgram(ea);f.activeTexture(f.TEXTURE2)}else Kc.update=!0};Kc.update=!1;var b,Pk,Zf,$f,ag,bg,cg,dg,eg,fg,gg,hg,ig,jg,Xm=function(){var f={};b={move:function(){Ib.cursor=7}};b.move.iconID=262;b.move.obj={name:r.move};b.attack=function(){};b.attack.iconID=250;b.attack.obj={name:r.MISC_ATTACK3};b.guard=function(){We(4)};b.guard.iconID=237;b.guard.obj={name:r.guard};b.patrol=
function(){We(8)};b.patrol.iconID=238;b.patrol.obj={name:r.patrol};b.pickUp=function(){};b.pickUp.iconID=240;b.pickUp.obj={name:r.pickItems};b.explore=function(){We(7)};b.explore.iconID=40;b.explore.obj={name:r.explore};b.stop=function(){C(999999999,44444)};b.stop.iconID=160;b.stop.obj={name:r.ORDERS_NAMES_STOP};b.stand=function(){C(999999999,44444)};b.stand.iconID=27;b.stand.obj={name:r.stand};b.attackGround=function(){};b.attackGround.iconID=100;b.steady=function(){};b.steady.iconID=21;b.createOrk=
function(){J(58)};b.createOrk.iconID=120;b.createDwarf=function(){J(59)};b.createDwarf.iconID=117;b.createSkeleton=function(){J(60)};b.createSkeleton.iconID=87;b.createGhost=function(){J(40)};b.createGhost.iconID=222;b.createFootman=function(){J(0)};b.createFootman.iconID=182;b.createArcher=function(){J(4)};b.createArcher.iconID=185;b.createMaceman=function(){J(3)};b.createMaceman.iconID=186;b.createPikeman=function(){J(1)};b.createPikeman.iconID=183;b.createLongbowman=function(){J(6)};b.createLongbowman.iconID=
184;b.createKnight=function(){J(19)};b.createKnight.iconID=180;b.iniMercenaries=function(b){b.mlist=[];b.mlistID=[];b.mercID=0;fh(b);b.setupINTV(Th,0,2E3)};b.iniMercenaries.builds=[30];b.iniHeroes=function(b){b.hlist=[];b.hlistID=[];b.heroID=0;fh(b);b.setupINTV(Th,0,2E3)};b.iniHeroes.builds=[30];b.mercFootmanArab=function(){Ea()};b.mercFootmanArab.iconID=49;b.mercFootmanArab.unit=80;b.mercFootmanArab.obj={};b.mercArcherArab=function(){Ea()};b.mercArcherArab.iconID=52;b.mercArcherArab.unit=85;b.mercArcherArab.obj=
{};b.mercMacemanArab=function(){Ea()};b.mercMacemanArab.iconID=116;b.mercMacemanArab.obj={};b.mercMacemanArab.unit=83;b.mercPikemanArab=function(){Ea()};b.mercPikemanArab.iconID=52;b.mercPikemanArab.unit=82;b.mercPikemanArab.obj={};b.mercCavalry=function(){Ea()};b.mercCavalry.iconID=133;b.mercCavalry.unit=84;b.mercCavalry.obj={};b.mercEnichar=function(){Ea()};b.mercEnichar.iconID=123;b.mercEnichar.unit=91;b.mercEnichar.obj={};b.mercJihad=function(){Ea()};b.mercJihad.iconID=236;b.mercJihad.unit=86;
b.mercJihad.obj={};b.mercFootmanArab6=function(){Fa()};b.mercFootmanArab6.iconID=49;b.mercFootmanArab6.unit=80;b.mercFootmanArab6.obj={};b.mercArcherArab6=function(){Fa()};b.mercArcherArab6.iconID=52;b.mercArcherArab6.unit=85;b.mercArcherArab6.obj={};b.mercMacemanArab6=function(){Fa()};b.mercMacemanArab6.iconID=116;b.mercMacemanArab6.unit=83;b.mercMacemanArab6.obj={};b.mercPikemanArab6=function(){Fa()};b.mercPikemanArab6.iconID=52;b.mercPikemanArab6.unit=82;b.mercPikemanArab6.obj={};b.mercCavalry6=
function(){Fa()};b.mercCavalry6.iconID=133;b.mercCavalry6.unit=84;b.mercCavalry6.obj={};b.mercEnichar6=function(){Fa()};b.mercEnichar6.iconID=123;b.mercEnichar6.unit=91;b.mercEnichar6.obj={};b.mercJihad6=function(){Fa()};b.mercJihad6.iconID=236;b.mercJihad6.unit=86;b.mercJihad6.obj={};b.mercFootman=function(){Ea()};b.mercFootman.iconID=182;b.mercFootman.unit=0;b.mercArcher=function(){Ea()};b.mercArcher.iconID=185;b.mercArcher.unit=4;b.mercMaceman=function(){Ea()};b.mercMaceman.iconID=186;b.mercMaceman.unit=
3;b.mercPikeman=function(){Ea()};b.mercPikeman.iconID=183;b.mercPikeman.unit=1;b.mercLongbowman=function(){Ea()};b.mercLongbowman.iconID=184;b.mercLongbowman.unit=6;b.mercKnight=function(){Ea()};b.mercKnight.iconID=180;b.mercKnight.unit=19;b.mercFootman6=function(){Fa()};b.mercFootman6.iconID=182;b.mercFootman6.unit=0;b.mercFootman6.obj={};b.mercArcher6=function(){Fa()};b.mercArcher6.iconID=185;b.mercArcher6.unit=4;b.mercArcher6.obj={};b.mercMaceman6=function(){Fa()};b.mercMaceman6.iconID=186;b.mercMaceman6.unit=
3;b.mercMaceman6.obj={};b.mercPikeman6=function(){Fa()};b.mercPikeman6.iconID=183;b.mercPikeman6.unit=1;b.mercPikeman6.obj={};b.mercLongbowman6=function(){Fa()};b.mercLongbowman6.iconID=184;b.mercLongbowman6.unit=6;b.mercLongbowman6.obj={};b.mercKnight6=function(){Fa()};b.mercKnight6.iconID=180;b.mercKnight6.unit=19;b.mercKnight6.obj={};b.mercArcherAsian6=function(){Fa()};b.mercArcherAsian6.iconID=53;b.mercArcherAsian6.unit=67;b.mercArcherAsian6.obj={};b.mercSamurai6=function(){Fa()};b.mercSamurai6.iconID=
122;b.mercSamurai6.unit=68;b.mercSamurai6.obj={};b.mercHourseSamurai6=function(){Fa()};b.mercHourseSamurai6.iconID=121;b.mercHourseSamurai6.unit=70;b.mercHourseSamurai6.obj={};b.mercRonin6=function(){Fa()};b.mercRonin6.iconID=54;b.mercRonin6.unit=66;b.mercRonin6.obj={};b.mercHorseArcher6=function(){Fa()};b.mercHorseArcher6.iconID=52;b.mercHorseArcher6.unit=69;b.mercHorseArcher6.obj={};b.mercChariot6=function(){Fa()};b.mercChariot6.iconID=79;b.mercChariot6.unit=72;b.mercChariot6.obj={};b.mercArcherAsian=
function(){Ea()};b.mercArcherAsian.iconID=53;b.mercArcherAsian.unit=67;b.mercArcherAsian.obj={};b.mercSamurai=function(){Ea()};b.mercSamurai.iconID=122;b.mercSamurai.unit=68;b.mercSamurai.obj={};b.mercHourseSamurai=function(){Ea()};b.mercHourseSamurai.iconID=121;b.mercHourseSamurai.unit=70;b.mercHourseSamurai.obj={};b.mercRonin=function(){Ea()};b.mercRonin.iconID=54;b.mercRonin.unit=66;b.mercRonin.obj={};b.mercHorseArcher=function(){Ea()};b.mercHorseArcher.iconID=52;b.mercHorseArcher.unit=69;b.mercHorseArcher.obj=
{};b.mercChariot=function(){Ea()};b.mercChariot.iconID=79;b.mercChariot.unit=72;b.mercChariot.obj={};b.createPeon=function(){J(10)};b.createPeon.iconID=187;b.sameSpeed=function(){C(999999999,44444)};b.sameSpeed.iconID=82;b.restoreSpeed=function(){C(999999999,44444)};b.restoreSpeed.iconID=88;b.createSpy=function(){J(2)};b.createSpy.iconID=162;b.emergeAllUnits=function(){A[Q[0]].inventory.slice(0);C(999999999,44444)};b.emergeAllUnits.iconID=261;b.techFeudalism=function(){G(12)};b.techFeudalism.iconID=
233;b.techArchitecture=function(){G(13)};b.techArchitecture.iconID=226;b.techLearning=function(){G(14)};b.techLearning.iconID=129;b.createPeon1=function(){J(64)};b.createPeon1.iconID=55;b.createPeon2=function(){J(79)};b.createPeon2.iconID=132;b.createNinja=function(){J(65)};b.createNinja.iconID=51;b.techArmoredChariot=function(){G(51)};b.techArmoredChariot.iconID=79;b.techBuddhism=function(){G(45)};b.techBuddhism.iconID=127;b.techGreatWall=function(){G(48)};b.techGreatWall.iconID=80;b.ridingHorses=
function(){G(49)};b.ridingHorses.iconID=64;b.irrigation=function(){G(50)};b.irrigation.iconID=72;b.createHorseArcher2=function(){J(85)};b.createHorseArcher2.iconID=52;b.techMeditation=function(){G(52)};b.techMeditation.iconID=71;b.techKungFu=function(){G(53)};b.techKungFu.iconID=228;b.techTournaments=function(){G(54)};b.techTournaments.iconID=73;b.techPhilosophy=function(){G(55)};b.techPhilosophy.iconID=68;b.techNinjas=function(){G(56)};b.techNinjas.iconID=56;b.techMastery=function(){G(57)};b.techMastery.iconID=
69;b.techGoldMining=function(){G(1)};b.techGoldMining.iconID=58;b.techStoneMining=function(){G(2)};b.techStoneMining.iconID=57;b.createCrusaders=function(){C(999999999,44444)};b.createCrusaders.iconID=221;b.techFanaticism=function(){G(31)};b.techFanaticism.iconID=235;b.techCrusade=function(){G(32)};b.techCrusade.iconID=93;b.techEspionage=function(){G(30)};b.techEspionage.iconID=215;b.techInquisition=function(){G(33)};b.techInquisition.iconID=97;b.techHealing=function(){G(34)};b.techHealing.iconID=
219;b.healing=function(){};b.healing.iconID=219;b.healing.iconIDbook=201;b.teach=function(){};b.teach.iconID=23;b.teach.iconIDbook=217;b.techBless=function(){G(36)};b.techBless.iconID=159;b.bless=function(){};b.bless.iconID=159;b.bless.iconIDbook=204;b.techMedicine=function(){G(35)};b.techMedicine.iconID=220;b.createMage=function(){J(5)};b.createMage.iconID=156;b.techBat=function(){G(38)};b.techBat.iconID=168;b.techGolem=function(){G(41)};b.techGolem.iconID=119;b.techInvisibility=function(){G(37)};
b.techInvisibility.iconID=217;b.techLightning=function(){G(40)};b.techLightning.iconID=143;b.techFreeze=function(){G(39)};b.techFreeze.iconID=130;b.techHeroism=function(){G(22)};b.techHeroism.iconID=136;b.techWarfare=function(){G(23)};b.techWarfare.iconID=108;b.techTactics=function(){G(24)};b.techTactics.iconID=257;b.techMercenaries=function(){G(25)};b.techMercenaries.iconID=95;b.techHeroes=function(){G(26)};b.techHeroes.iconID=96;b.techFame=function(){G(27)};b.techFame.iconID=111;b.techSiegeTactics=
function(){G(28)};b.techSiegeTactics.iconID=258;b.techBodyBuilding=function(){G(29)};b.techBodyBuilding.iconID=101;b.createPriest=function(){J(9)};b.createPriest.iconID=155;b.createCow=function(){J(27)};b.createCow.iconID=163;b.techCropRotation=function(){G(8)};b.techCropRotation.iconID=227;b.techDomestication=function(){G(7)};b.techDomestication.iconID=157;b.techMapMaking=function(){G(16)};b.techMapMaking.iconID=89;b.techTradeRoutes=function(){G(17)};b.techTradeRoutes.iconID=102;b.techTradeTaxes=
function(){G(18)};b.techTradeTaxes.iconID=110;b.techUsury=function(){G(19)};b.techUsury.iconID=105;b.techSupplyStorage=function(){G(20)};b.techSupplyStorage.iconID=62;b.techBribery=function(){G(21)};b.techBribery.iconID=109;b.bribe=function(){};b.bribe.iconID=128;b.createCaravan=function(){J(61)};b.createCaravan.iconID=169;b.createCaravan2=function(){J(90)};b.createCaravan2.iconID=134;b.createFootman2=function(){J(80)};b.createFootman2.iconID=49;b.createArcher2=function(){J(81)};b.createArcher2.iconID=
43;b.createSatrap=function(){J(83)};b.createSatrap.iconID=116;b.createPikeman2=function(){J(82)};b.createPikeman2.iconID=42;b.createHorseArcher2=function(){J(85)};b.createHorseArcher2.iconID=124;b.createCavalry=function(){J(84)};b.createCavalry.iconID=133;b.createEnichar=function(){J(91)};b.createEnichar.iconID=123;b.createJihad=function(){J(86)};b.createJihad.iconID=236;b.trade=function(){};b.trade.iconID=161;b.unload=function(){};b.unload.iconID=148;b.createMercenaries=function(){};b.createMercenaries.iconID=
95;b.createHeroes=function(){};b.createHeroes.iconID=96;b.upgradeGuildTower=function(){G(42)};b.upgradeGuildTower.iconID=171;b.upgradeStoneTower=function(){G(43)};b.upgradeStoneTower.iconID=178;b.upgradeCannonTower=function(){G(44)};b.upgradeCannonTower.iconID=178;b.createCatapult=function(){J(37)};b.createCatapult.iconID=152;b.createHeavyCatapult=function(){J(39)};b.createHeavyCatapult.iconID=153;b.createBallist=function(){J(38)};b.createBallist.iconID=154;b.techEngineering=function(){G(47)};b.techEngineering.iconID=
92;b.techCannonTower=function(){G(46)};b.techCannonTower.iconID=178;b.techPlateArmor=function(){G(10)};b.techPlateArmor.iconID=131;b.techTemperIron=function(){G(4)};b.techTemperIron.iconID=266;b.techHalberd=function(){G(6)};b.techHalberd.iconID=113;b.techScaleArmor=function(){G(5)};b.techScaleArmor.iconID=251;b.techChainMail=function(){G(9)};b.techChainMail.iconID=252;b.techLongbow=function(){G(0)};b.techLongbow.iconID=259;b.techWoodCutting=function(){G(3)};b.techWoodCutting.iconID=107;b.techCrossbow=
function(){G(11)};b.techCrossbow.iconID=112;b.createFishingBoat=function(){J(74)};b.createFishingBoat.iconID=48;b.createXebec=function(){J(76)};b.createXebec.iconID=166;b.upgradeShip=function(){};b.upgradeShip.iconID=268;b.fishing=function(){};b.fishing.iconID=41;b.createHulk=function(){J(75)};b.createHulk.iconID=165;b.createGalleon=function(){J(73)};b.createGalleon.iconID=164;b.techLandingTactics=function(){};b.techLandingTactics.iconID=98;b.techConcentration=function(){G(58)};b.techConcentration.iconID=
75;b.techConfusion=function(){G(59)};b.techConfusion.iconID=76;b.techWhirlpool=function(){G(60)};b.techWhirlpool.iconID=78;b.techDragon=function(){G(61)};b.techDragon.iconID=115;b.techTurnToStone=function(){G(62)};b.techTurnToStone.iconID=77;b.techFlameBolt=function(){G(63)};b.techFlameBolt.iconID=25;b.techJewelry=function(){G(64)};b.techJewelry.iconID=230;b.techBanking=function(){G(65)};b.techBanking.iconID=74;b.techChemistry=function(){G(66)};b.techChemistry.iconID=225;b.techSeaFood=function(){G(67)};
b.techSeaFood.iconID=67;b.techGunPowder=function(){G(68)};b.techGunPowder.iconID=212;b.techRocketArrow=function(){G(69)};b.techRocketArrow.iconID=47;b.techBushido=function(){G(70)};b.techBushido.iconID=60;b.techLeadership=function(){G(71)};b.techLeadership.iconID=114;b.techHonor=function(){G(72)};b.techHonor.iconID=94;b.techSunTzu=function(){G(73)};b.techSunTzu.iconID=66;b.createRonin=function(){J(66)};b.createRonin.iconID=54;b.createArcher1=function(){J(67)};b.createArcher1.iconID=53;b.createSamurai=
function(){J(68)};b.createSamurai.iconID=122;b.createHorseArcher1=function(){J(69)};b.createHorseArcher1.iconID=52;b.createMonk=function(){J(128)};b.createMonk.iconID=45;b.createMage1=function(){J(129)};b.createMage1.iconID=50;b.createPriest1=function(){J(127)};b.createPriest1.iconID=44;b.createPriest2=function(){J(87)};b.createPriest2.iconID=125;b.buyItems=function(){};b.buyItems.iconID=31;b.sellItems=function(){};b.sellItems.iconID=30;b.createHorseSamurai=function(){J(70)};b.createHorseSamurai.iconID=
121;b.createChariot=function(){J(72)};b.createChariot.iconID=79;b.stopTech=function(){C(999999999,44444)};b.stopTech.iconID=160;b.repair=function(){};b.repair.iconID=145;b.conquest=function(){};b.conquest.iconID=249;b.dcm=function(){};b.dcm.iconID=260;b.buildBarrack=function(){P(14)};b.buildBarrack.iconID=205;b.buildBarrack1=function(){P(71)};b.buildBarrack1.iconID=205;b.buildBarrack2=function(){P(102)};b.buildBarrack2.iconID=205;b.buildTower=function(){P(32)};b.buildTower.iconID=170;b.buildStorage=
function(){P(18)};b.buildStorage.iconID=200;b.buildLumbermill=function(){P(15)};b.buildLumbermill.iconID=199;b.buildLumbermill2=function(){P(93)};b.buildLumbermill2.iconID=199;b.buildFields=function(){P(20)};b.buildFields.iconID=265;b.buildCastle=function(){P(12)};b.buildCastle.iconID=206;b.buildCastle1=function(){P(62)};b.buildCastle1.iconID=206;b.buildCastle2=function(){P(63)};b.buildCastle2.iconID=206;b.buildAcademy=function(){P(17)};b.buildAcademy.iconID=204;b.buildCathedral=function(){P(11)};
b.buildCathedral.iconID=191;b.buildCathedral2=function(){P(106)};b.buildCathedral2.iconID=189;b.buildMerchands=function(){P(24)};b.buildMerchands.iconID=198;b.buildMerchands2=function(){P(108)};b.buildMerchands2.iconID=198;b.buildChurch=function(){P(25)};b.buildChurch.iconID=197;b.buildMarket=function(){P(33)};b.buildMarket.iconID=194;b.buildMageTower=function(){P(16)};b.buildMageTower.iconID=192;b.buildMageTower2=function(){P(107)};b.buildMageTower2.iconID=192;b.buildDummy=function(){P(36)};b.buildDummy.iconID=
65;b.buildFarm=function(){P(23)};b.buildFarm.iconID=193;b.buildBlacksmith=function(){P(26)};b.buildBlacksmith.iconID=202;b.buildWorkshop=function(){P(29)};b.buildWorkshop.iconID=201;b.buildWorkshop2=function(){P(98)};b.buildWorkshop2.iconID=201;b.buildStable=function(){P(28)};b.buildStable.iconID=196;b.buildStable2=function(){P(103)};b.buildStable2.iconID=196;b.buildTavern=function(){P(30)};b.buildTavern.iconID=208;b.buildHouse=function(){P(31)};b.buildHouse.iconID=195;b.buildHarbor=function(){P(41)};
b.buildHarbor.iconID=188;b.buildOutpost=function(){P(34)};b.buildOutpost.iconID=158;b.buildWoodWall=function(){P(13)};b.buildWoodWall.iconID=210;b.buildWoodGate=function(){};b.buildWoodGate.iconID=209;b.buildWoodGate.disabled=2;b.buildBridge=function(){P(35)};b.buildBridge.iconID=176;b.freeze=function(){};b.freeze.iconID=99;b.freeze.obj={name:r.freeze};b.freeze.iconIDbook=205;b.confusion=function(){};b.confusion.iconID=76;b.confusion.obj={name:"Confusion",spcost:[120,0,0,0]};b.confusion.iconIDbook=
206;b.turnToStone=function(){};b.turnToStone.iconID=77;b.turnToStone.iconIDbook=213;b.turnToStone.obj={name:"Turn to Stone",spcost:[40,0,0,0]};b.whirlpool=function(){};b.whirlpool.iconID=78;b.whirlpool.iconIDbook=214;b.whirlpool.obj={name:"Whirlpool",spcost:[80,0,0,0]};b.flameBolt=function(){};b.flameBolt.iconID=25;b.flameBolt.obj={name:"Flame Bolt",spcost:[120,0,0,0]};b.flameBolt.iconIDbook=216;b.createDragon=function(){};b.createDragon.iconID=115;b.createDragon.obj={name:"Spawn Dragon",spcost:[320,
0,0,0]};b.createDragon.iconIDbook=215;b.lightning=function(){};b.lightning.iconID=263;b.lightning.obj={name:r.lightning,spcost:[80,0,0,0]};b.lightning.iconIDbook=200;b.createBat=function(){};b.createBat.iconID=168;b.createBat.iconIDbook=203;b.createGolem=function(){};b.createGolem.iconID=119;b.createGolem.iconIDbook=209;b.autoInvisibility=function(){};b.autoInvisibility.iconID=217;b.autoInvisibility.obj={name:r.invisibility};b.invisibility=function(){};b.invisibility.iconID=217;b.invisibility.iconIDbook=
208;b.impersonate=function(){};b.impersonate.iconID=32;b.impersonate.obj={name:"Impersonate"};b.revealSelf=function(){C(999999999,44444)};b.revealSelf.iconID=33;b.revealSelf.obj={name:"Reveal your true self"};b.buildHouse1=function(){P(111)};b.buildHouse1.iconID=195;b.buildHouse2=function(){P(92)};b.buildHouse2.iconID=195;b.buildLumbermill1=function(){P(112)};b.buildLumbermill1.iconID=199;b.buildStorage1=function(){P(113)};b.buildStorage1.iconID=200;b.buildStorage2=function(){P(94)};b.buildStorage2.iconID=
200;b.buildFarm1=function(){P(114)};b.buildFarm1.iconID=193;b.buildFarm2=function(){P(95)};b.buildFarm2.iconID=193;b.buildHarbor1=function(){P(115)};b.buildHarbor1.iconID=188;b.buildHarbor2=function(){P(96)};b.buildHarbor2.iconID=188;b.buildBlacksmith1=function(){P(116)};b.buildBlacksmith1.iconID=202;b.buildBlacksmith2=function(){P(97)};b.buildBlacksmith2.iconID=202;b.buildWorkshop1=function(){P(117)};b.buildWorkshop1.iconID=201;b.buildChurch1=function(){P(118)};b.buildChurch1.iconID=197;b.buildChurch2=
function(){P(99)};b.buildChurch2.iconID=197;b.buildTavern1=function(){P(119)};b.buildTavern1.iconID=208;b.buildTavern2=function(){P(100)};b.buildTavern2.iconID=208;b.buildMarket1=function(){P(120)};b.buildMarket1.iconID=194;b.buildMarket2=function(){P(101)};b.buildMarket2.iconID=194;b.buildStable1=function(){P(121)};b.buildStable1.iconID=196;b.buildOutpost1=function(){P(122)};b.buildOutpost1.iconID=158;b.buildOutpost2=function(){P(104)};b.buildOutpost2.iconID=158;b.buildCathedral1=function(){P(123)};
b.buildCathedral1.iconID=190;b.buildMageTower1=function(){P(124)};b.buildMageTower1.iconID=192;b.createObjects=function(){Hh("magicworkshopmenu",lk)};b.createObjects.iconID=20;b.createObjects.obj={};b.buildMagicWorkshop=function(){P(110)};b.buildMagicWorkshop.iconID=46;b.buildMerchands1=function(){P(125)};b.buildMerchands1.iconID=198;b.buildAcademy1=function(){P(126)};b.buildAcademy1.iconID=204;b.buildAcademy2=function(){P(109)};b.buildAcademy2.iconID=204;b.buildRocketTower=function(){P(57)};b.buildRocketTower.iconID=
47;b.murder=function(){};b.murder.iconID=28;b.convertJihad=function(){C(999999999,44444)};b.convertJihad.iconID=236;b.convertJihad.obj={};b.menuCommonBuild2=function(){};b.menuCommonBuild2.iconID=17;gg=[b.buildFarm2,b.buildBlacksmith2,b.buildWorkshop2,b.buildStable2,b.buildTavern2,b.buildHouse2];gg.menuName="a_build";b.menuCommonBuild2.xtra=gg;b.menuSpecialBuild2=function(){};b.menuSpecialBuild2.iconID=15;hg=[b.buildCastle2,b.buildAcademy2,b.buildCathedral2,b.buildMerchands2,b.buildChurch2,b.buildMarket2,
b.buildMageTower2,b.buildMagicWorkshop];hg.menuName="a_build";b.menuSpecialBuild2.xtra=hg;b.menuOtherBuild2=function(){};b.menuOtherBuild2.iconID=16;ig=[b.buildHarbor2,b.buildOutpost2,b.buildWoodWall,b.buildWoodGate,b.buildBridge];ig.menuName="e_build";b.menuOtherBuild2.xtra=ig;b.menuBuilds2=function(){};b.menuBuilds2.iconID=245;jg=[b.menuSpecialBuild2,b.menuCommonBuild2,b.menuOtherBuild2,b.buildBarrack2,b.buildTower,b.buildStorage2,b.buildLumbermill2,b.buildFields];jg.menuName="a_build";b.menuBuilds2.xtra=
jg;b.origin=Yk;b.origin.iconID=255;b.createCarpet=function(){};b.createCarpet.iconID=146;b.createCarpet.iconIDbook=202;b.createJinn=function(){};b.createJinn.iconID=118;b.createJinn.iconIDbook=218;b.magicVision=function(){};b.magicVision.iconID=223;b.magicVision.iconIDbook=210;b.fireRain=function(){};b.fireRain.iconID=264;b.fireRain.iconIDbook=199;b.raiseDead=function(){};b.raiseDead.iconID=87;b.raiseDead.iconIDbook=211;b.createMage2=function(){J(89)};b.createMage2.iconID=126;b.techCowPoaching=function(){G(74)};
b.techCowPoaching.iconID=85;b.techHorseManShip=function(){G(75)};b.techHorseManShip.iconID=231;b.techScimitar=function(){G(76)};b.techScimitar.iconID=84;b.techJihad=function(){G(77)};b.techJihad.iconID=236;b.techCarpet=function(){G(78)};b.techCarpet.iconID=146;b.techMagicWorkshop=function(){G(79)};b.techMagicWorkshop.iconID=86;b.techFireRain=function(){G(80)};b.techFireRain.iconID=264;b.techMagicVision=function(){G(81)};b.techMagicVision.iconID=224;b.techNecromancy=function(){G(82)};b.techNecromancy.iconID=
87;b.techJinn=function(){G(83)};b.techJinn.iconID=118;b.techOreFloatation=function(){G(84)};b.techOreFloatation.iconID=106;b.techRiddingHorses=function(){G(85)};b.techRiddingHorses.iconID=232;b.techJanissary=function(){G(86)};b.techJanissary.iconID=81;b.buildMagicItems=function(){};b.buildMagicItems.iconID=20;b.techSlavery=function(){G(87)};b.techSlavery.iconID=135;b.stopBuilding=function(){C(999999999,44444)};b.stopBuilding.iconID=160;b.menuSpecialBuild1=function(){};b.menuSpecialBuild1.iconID=15;
Zf=[b.buildCastle1,b.buildAcademy1,b.buildCathedral1,b.buildMerchands1,b.buildChurch1,b.buildMarket1,b.buildMageTower1,b.buildRocketTower,b.buildDummy];Zf.menuName="a_build";b.menuSpecialBuild1.xtra=Zf;b.menuCommonBuild1=function(){};b.menuCommonBuild1.iconID=17;$f=[b.buildFarm1,b.buildBlacksmith1,b.buildWorkshop1,b.buildStable1,b.buildTavern1,b.buildHouse1];$f.menuName="a_build";b.menuCommonBuild1.xtra=$f;b.menuSpecialBuild=function(){};b.menuSpecialBuild.iconID=15;ag=[b.buildCastle,b.buildAcademy,
b.buildCathedral,b.buildMerchands,b.buildChurch,b.buildMarket,b.buildMageTower,b.buildDummy];ag.menuName="e_build";b.menuSpecialBuild.xtra=ag;b.menuCommonBuild=function(){};b.menuCommonBuild.iconID=17;bg=[b.buildFarm,b.buildBlacksmith,b.buildWorkshop,b.buildStable,b.buildTavern,b.buildHouse];bg.menuName="e_build";b.menuCommonBuild.xtra=bg;b.menuOtherBuild=function(){};b.menuOtherBuild.iconID=16;cg=[b.buildHarbor,b.buildOutpost,b.buildWoodWall,b.buildWoodGate,b.buildBridge];cg.menuName="e_build";b.menuOtherBuild.xtra=
cg;b.menuOtherBuild1=function(){};b.menuOtherBuild1.iconID=16;dg=[b.buildHarbor1,b.buildOutpost1,b.buildWoodWall,b.buildWoodGate,b.buildBridge];dg.menuName="e_build";b.menuOtherBuild1.xtra=dg;b.menuBuilds=function(){};eg=[b.menuSpecialBuild,b.menuCommonBuild,b.menuOtherBuild,b.buildBarrack,b.buildTower,b.buildStorage,b.buildLumbermill,b.buildFields];eg.menuName="e_build";b.menuBuilds.iconID=245;b.menuBuilds.xtra=eg;b.menuBuilds1=function(){};b.menuBuilds1.iconID=245;fg=[b.menuSpecialBuild1,b.menuCommonBuild1,
b.menuOtherBuild1,b.buildBarrack1,b.buildTower,b.buildStorage1,b.buildLumbermill1,b.buildFields];fg.menuName="a_build";b.menuBuilds1.xtra=fg;Pk=function(){b.fishing.obj={};b.impersonate.obj={};b.techGreatWall.obj=D[48];b.revealSelf.obj={};b.trade.obj={};b.unload.obj={};b.mercFootman6.obj={};b.murder.obj={};b.mercArcher6.obj={};b.mercMaceman6.obj={};b.mercPikeman6.obj={};b.mercLongbowman6.obj={};b.sameSpeed.obj={name:"Same speed"};b.restoreSpeed.obj={name:"Restore speed"};b.mercKnight6.obj={};b.attackGround.obj=
{};b.steady.obj={};b.bribe.obj={};b.createPriest1.obj=B[127];b.createPriest2.obj=B[87];b.createFootman2.obj=B[80];b.createArcher2.obj=B[81];b.createSatrap.obj=B[83];b.createPikeman2.obj=B[82];b.createHorseArcher2.obj=B[85];b.createCavalry.obj=B[84];b.createEnichar.obj=B[91];b.createJihad.obj=B[86];b.createMonk.obj=B[128];b.healing.obj={name:r.heal,spcost:[20,0,0,0]};b.bless.obj={name:r.bless,spcost:[20,0,0,0]};b.stopTech.obj={};b.conquest.obj={};b.dcm.obj={name:r.dcm};b.repair.obj={name:r.repair};
b.menuOtherBuild.obj={};b.menuOtherBuild1.obj={};b.menuOtherBuild2.obj={};b.sellItems.obj={};b.buyItems.obj={};b.menuBuilds.obj={name:r.menuBuild};b.menuCommonBuild.obj={};b.menuSpecialBuild.obj={};b.techMastery.obj=D[57];b.techNinjas.obj=D[56];b.teach.obj={name:"Teach",spcost:[20,0,0,0]};b.techPhilosophy.obj=D[55];b.techKungFu.obj=D[53];b.techTournaments.obj=D[54];b.techMeditation.obj=D[52];b.menuCommonBuild1.obj={};b.menuCommonBuild2.obj={};b.createMage1.obj=B[129];b.menuSpecialBuild1.obj={};b.menuSpecialBuild2.obj=
{};b.menuBuilds1.obj={name:r.menuBuild};b.menuBuilds2.obj={name:r.menuBuild};b.stopBuilding.obj={};b.freeze.obj={name:r.freeze,spcost:[200,0,0,0]};b.invisibility.obj={name:r.invisibility,spcost:[40,0,0,0]};b.autoInvisibility.obj={name:r.invisibility};b.createHeroes.obj={};b.createMercenaries.obj={};b.upgradeShip.obj={};b.techMedicine.obj=D[35];b.techBless.obj=D[36];b.buildHouse1.obj=B[111];b.techHealing.obj=D[34];b.techInquisition.obj=D[33];b.techArmoredChariot.obj=D[51];b.techRocketArrow.obj=D[69];
b.techJewelry.obj=D[64];b.techGunPowder.obj=D[68];b.techSeaFood.obj=D[67];b.techChemistry.obj=D[66];b.techBanking.obj=D[65];b.createMage.obj=B[5];b.techBat.obj=D[38];b.techGolem.obj=D[41];b.techInvisibility.obj=D[37];b.techLightning.obj=D[40];b.techFreeze.obj=D[39];b.techHeroism.obj=D[22];b.createHorseSamurai.obj=B[70];b.createChariot.obj=B[72];b.createHorseArcher1.obj=B[69];b.createHorseArcher2.obj=B[85];b.createSamurai.obj=B[68];b.createArcher1.obj=B[67];b.techConfusion.obj=D[59];b.techConcentration.obj=
D[58];b.techWhirlpool.obj=D[60];b.techDragon.obj=D[61];b.techTurnToStone.obj=D[62];b.techFlameBolt.obj=D[63];b.createRonin.obj=B[66];b.buildStorage.obj=B[18];b.buildStorage1.obj=B[113];b.buildStorage2.obj=B[94];b.buildFields.obj=B[20];b.buildLumbermill.obj=B[15];b.buildLumbermill1.obj=B[112];b.buildLumbermill2.obj=B[93];b.buildTower.obj=B[32];b.buildBarrack1.obj=B[71];b.buildBarrack.obj=B[14];b.buildBarrack2.obj=B[102];b.buildDummy.obj=B[36];b.buildRocketTower.obj=B[57];b.buildMageTower.obj=B[16];
b.buildMageTower1.obj=B[124];b.buildMageTower2.obj=B[107];b.buildMarket.obj=B[33];b.buildMarket1.obj=B[120];b.buildMarket2.obj=B[101];b.buildChurch.obj=B[25];b.buildChurch1.obj=B[118];b.buildChurch2.obj=B[99];b.buildMerchands.obj=B[24];b.irrigation.obj=D[50];b.ridingHorses.obj=D[49];b.buildMerchands1.obj=B[125];b.buildMerchands2.obj=B[108];b.buildCathedral.obj=B[11];b.buildCathedral1.obj=B[123];b.buildCathedral2.obj=B[106];b.buildAcademy.obj=B[17];b.buildAcademy1.obj=B[126];b.buildAcademy2.obj=B[109];
b.buildCastle.obj=B[12];b.magicVision.obj={name:"Magic Vision",spcost:[20,0,0,0]};b.fireRain.obj={name:"Fire Rain",spcost:[200,0,0,0]};b.raiseDead.obj={name:"Raise the Dead",spcost:[40,0,0,0]};b.createJinn.obj={name:"Spawn Jinn",spcost:[320,0,0,0]};b.createCarpet.obj={name:"Spawn Magic Carpet",spcost:[320,0,0,0]};b.buildCastle1.obj=B[62];b.buildCastle2.obj=B[63];b.buildHouse.obj=B[31];b.buildHouse2.obj=B[92];b.buildTavern.obj=B[30];b.buildTavern1.obj=B[119];b.buildTavern2.obj=B[100];b.buildStable.obj=
B[28];b.buildStable1.obj=B[121];b.buildStable2.obj=B[103];b.buildFarm.obj=B[23];b.buildFarm1.obj=B[114];b.buildFarm2.obj=B[95];b.buildWorkshop.obj=B[29];b.buildWorkshop1.obj=B[117];b.buildWorkshop2.obj=B[98];b.buildBlacksmith.obj=B[26];b.buildBlacksmith1.obj=B[116];b.buildBlacksmith2.obj=B[97];b.buildBridge.obj=B[35];b.buildHarbor.obj=B[41];b.buildHarbor1.obj=B[115];b.buildHarbor2.obj=B[96];b.createMage2.obj=B[89];b.buildMagicItems.obj={};b.techJanissary.obj=D[86];b.techRiddingHorses.obj=D[85];b.techOreFloatation.obj=
D[84];b.techJinn.obj=D[83];b.techNecromancy.obj=D[82];b.techMagicVision.obj=D[81];b.techFireRain.obj=D[80];b.techMagicWorkshop.obj=D[79];b.techCarpet.obj=D[78];b.techJihad.obj=D[77];b.techScimitar.obj=D[76];b.techHorseManShip.obj=D[75];b.techCowPoaching.obj=D[74];b.buildWoodGate.obj={};b.buildWoodWall.obj=B[13];b.buildOutpost.obj=B[34];b.buildOutpost1.obj=B[122];b.buildOutpost2.obj=B[104];b.createGolem.obj={name:"Spawn Stone Golem",spcost:[480,0,0,0]};b.techSunTzu.obj=D[73];b.techBushido.obj=D[70];
b.techLeadership.obj=D[71];b.techHonor.obj=D[72];b.createBat.obj={name:"Spawn Bat",spcost:[40,0,0,0]};b.techGoldMining.obj=D[1];b.techStoneMining.obj=D[2];b.emergeAllUnits.obj={};b.origin.obj={name:"Origin"};b.createOrk.obj=B[58];b.createDwarf.obj=B[59];b.createSkeleton.obj=B[60];b.createGhost.obj=B[40];b.createFootman.obj=B[0];b.createArcher.obj=B[4];b.techSlavery.obj=D[87];b.createMaceman.obj=B[3];b.createPikeman.obj=B[1];b.createLongbowman.obj=B[6];b.createKnight.obj=B[19];b.mercFootman.obj=f;
b.mercArcher.obj=f;b.mercMaceman.obj=f;b.mercPikeman.obj=f;b.mercLongbowman.obj=f;b.mercKnight.obj=f;b.createPeon.obj=B[10];b.createSpy.obj=B[2];b.techFeudalism.obj=D[12];b.techArchitecture.obj=D[13];b.techLearning.obj=D[14];b.createPeon1.obj=B[64];b.createPeon2.obj=B[79];b.createNinja.obj=B[65];b.techBuddhism.obj=D[45];b.createCrusaders.obj={name:"Preach a crusade",cost:[1E3,0,2E3,0]};b.buildMagicWorkshop.obj=B[110];b.techFanaticism.obj=D[31];b.techCrusade.obj=D[32];b.techEspionage.obj=D[30];b.techChainMail.obj=
D[9];b.techHalberd.obj=D[6];b.techLongbow.obj=D[0];b.techScaleArmor.obj=D[5];b.techTemperIron.obj=D[4];b.techPlateArmor.obj=D[10];b.techLandingTactics.obj={};b.createGalleon.obj=B[73];b.createHulk.obj=B[75];b.createXebec.obj=B[76];b.createFishingBoat.obj=B[74];b.techCrossbow.obj=D[11];b.techWoodCutting.obj=D[3];b.techCannonTower.obj=D[46];b.techEngineering.obj=D[47];b.createBallist.obj=B[38];b.createHeavyCatapult.obj=B[39];b.createCatapult.obj=B[37];b.upgradeCannonTower.obj=D[44];b.upgradeStoneTower.obj=
D[43];b.upgradeGuildTower.obj=D[42];b.createCaravan.obj=B[61];b.createCaravan2.obj=B[90];b.techBribery.obj=D[21];b.techSupplyStorage.obj=D[20];b.techUsury.obj=D[19];b.techCropRotation.obj=D[8];b.createCow.obj=B[27];b.techDomestication.obj=D[7];b.techTradeTaxes.obj=D[18];b.techTradeRoutes.obj=D[17];b.techMapMaking.obj=D[16];b.createPriest.obj=B[9];b.techBodyBuilding.obj=D[29];b.techSiegeTactics.obj=D[28];b.techFame.obj=D[27];b.techHeroes.obj=D[26];b.techMercenaries.obj=D[25];b.techTactics.obj=D[24];
b.techWarfare.obj=D[23];for(var c=Object.keys(b),e=0,d=c.length;e<d;e++){var k=b[c[e]];k.id=e;k.objName=c[e];k.obj&&(k.obj.nu=k)}}},g="undefined"!==typeof g?g:{},qe={},tc;for(tc in g)g.hasOwnProperty(tc)&&(qe[tc]=g[tc]);g.arguments=[];g.thisProgram="./this.program";g.quit=function(b,c){throw c;};g.preRun=[];g.postRun=[];var vd=!1,wc=!1,sg=!1,Cl=!1;vd="object"===typeof window;wc="function"===typeof importScripts;sg="object"===typeof process&&"function"===typeof require&&!vd&&!wc;Cl=!vd&&!sg&&!wc;var Nb=
"";if(sg){Nb=__dirname+"/";var ki,li;g.read=function(b,c){ki||(ki=require("fs"));li||(li=require("path"));b=li.normalize(b);b=ki.readFileSync(b);return c?b:b.toString()};g.readBinary=function(b){b=g.read(b,!0);b.buffer||(b=new Uint8Array(b));yg(b.buffer);return b};1<process.argv.length&&(g.thisProgram=process.argv[1].replace(/\\/g,"/"));g.arguments=process.argv.slice(2);"undefined"!==typeof module&&(module.exports=g);process.on("uncaughtException",function(b){if(!(b instanceof Tc))throw b;});process.on("unhandledRejection",
Ra);g.quit=function(b){process.exit(b)};g.inspect=function(){return"[Emscripten Module object]"}}else if(Cl)"undefined"!=typeof read&&(g.read=function(b){return read(b)}),g.readBinary=function(b){if("function"===typeof readbuffer)return new Uint8Array(readbuffer(b));b=read(b,"binary");yg("object"===typeof b);return b},"undefined"!=typeof scriptArgs?g.arguments=scriptArgs:"undefined"!=typeof arguments&&(g.arguments=arguments),"function"===typeof quit&&(g.quit=function(b){quit(b)});else if(vd||wc)wc?
Nb=self.location.href:document.currentScript&&(Nb=document.currentScript.src),Nb=0!==Nb.indexOf("blob:")?Nb.substr(0,Nb.lastIndexOf("/")+1):"",g.read=function(b){var c=new XMLHttpRequest;c.open("GET",b,!1);c.send(null);return c.responseText},wc&&(g.readBinary=function(b){var c=new XMLHttpRequest;c.open("GET",b,!1);c.responseType="arraybuffer";c.send(null);return new Uint8Array(c.response)}),g.readAsync=function(b,c,e){var d=new XMLHttpRequest;d.open("GET",b,!0);d.responseType="arraybuffer";d.onload=
function(){200==d.status||0==d.status&&d.response?c(d.response):e()};d.onerror=e;d.send(null)},g.setWindowTitle=function(b){document.title=b};var Ig=g.print||("undefined"!==typeof console?console.log.bind(console):"undefined"!==typeof print?print:null),Ob=g.printErr||("undefined"!==typeof printErr?printErr:"undefined"!==typeof console&&console.warn.bind(console)||Ig);for(tc in qe)qe.hasOwnProperty(tc)&&(g[tc]=qe[tc]);qe=void 0;var Ql={"f64-rem":function(b,c){return b%c},"debugger":function(){debugger}},
Sc=0;"object"!==typeof WebAssembly&&Ob("no native wasm support detected");var Gg=!1,wi="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");var yi,Rc,gb,Ai,Mc=g.TOTAL_MEMORY||471859200;5242880>Mc&&Ob("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+Mc+"! (TOTAL_STACK=5242880)");if(g.buffer)var Wa=g.buffer;else{if("object"===typeof WebAssembly&&"function"===typeof WebAssembly.Memory){var we=new WebAssembly.Memory({initial:Mc/
65536});Wa=we.buffer}else Wa=new ArrayBuffer(Mc);g.buffer=Wa}zi();gb[1364208]=10699968;var Ji=[],Hg=[],Tl=[],Ii=[],xe=!1,xc=0,Eg=null,wd=null;g.preloadedImages={};g.preloadedAudios={};var dc="a.out.wasm";Bi(dc)||(dc=Ml(dc));g.asm=function(b,c,e){c.memory=we;c.table=new WebAssembly.Table({initial:157,maximum:157,element:"anyfunc"});c.__memory_base=1024;c.__table_base=0;return Pl(c)};var Qa=[function(b){We(b)},function(){p("magicworkshopmenu").style.display="block";cd()},function(b){C(b);Uf(Ph,b);Uf(Qh,
b);Uf(Rh,b);Uf(Sh,b)},function(){Ik()},function(){Yd()},function(){Tk()},function(){Uk()},function(b,c,e){a:{for(var d=0,f=Za.length;d<f;d++){var k=Za[d];if(k.superID==e){e=k;break a}}e=void 0}b=new Uint32Array(g.buffer,b,c);e&&e.sendDirectly("channelMessage","nehhof",b)},function(b,c,e,d,f,l,g){xl(b,c,e,d,f,l,g)},function(b,c,e,d,f,l){xl(b,c,e,d,f,l)},function(){qd()},function(b,c,e){Ub(b,0,c,e)},function(b){hi(b)},function(){ka("returnmenu");p("oneplayertbody").innerHTML='<tr><td></td><td id="addremove"><button id="addPlayer">+</button><button id="removePlayer">-</button></td><td></td><td></td></tr>';
for(var b=0,c=z.nkingdom()-1;b<c;b++)p("oneplayertbody").innerHTML+='<tr><td class="ucolor1"></td><td class="username1"></td><td class="race1"><button></button></td><td class="team1"><button></button></td></tr>';p("addPlayer").onclick=rn;p("removePlayer").onclick=sn},function(b,c,e,d,f){for(d="#"+d.toString(16);7>d.length;)d+="0";tl[f].style.background=d;on[f].innerHTML=sc(xb(b,20));b=qn[f].getElementsByTagName("button")[0];b.iteam=f+1;b.onmousedown=ul;b.innerHTML=c;c=pn[f].getElementsByTagName("button")[0];
c.iteam=f+1;c.onmousedown=vl;c.innerHTML=La[e];e=document.createElement("input");e.type="color";e.iteam=f+1;e.value=d;tl[f].appendChild(e);e.onchange=wl},function(){Jh()},function(b,c,e,d,f){b=Aa[b];b.style.backgroundPosition=48*f+"px "+48*c+"px";e&&(b.className="");0<d&&(b.innerHTML=d)},function(b,c){b&&(qa.leftButton.className="");8*(b+1)<c&&(qa.rightButton.className="")},function(b,c){be(b,c)},function(b,c,e){la.value=c;la.max=e;tb.innerHTML=c+"/"+e;la.style.display="block";p("kingdom").innerHTML=
b+" "+r.SELVIEW_UNITS;Oh()},function(){fd()},function(b,c,e,d){ef(b,c,e,d)},function(b,c){p("pop").innerHTML=b+"/"+c},function(b,c,e,d,f,l){var h=p("rndtable"),k=document.createElement("tr");h.appendChild(k);h=document.createElement("td");var g=document.createElement("select"),m=g;g.innerHTML='<option value="0">'+La[0]+'</option><option value="1">'+La[1]+'</option><option value="2">'+La[2]+'</option><option value="3">'+La[3]+"</option>";g.value=b;h.appendChild(g);k.appendChild(h);h=document.createElement("td");
g=document.createElement("select");g.innerHTML=tg[b];g.value=c;g.rndid=l;g.onchange=un;m.types=g;m.onchange=vn;h.appendChild(g);k.appendChild(h);h=document.createElement("td");g=document.createElement("input");g.value=e;g.onchange=wn;g.type="number";g.rndid=l;h.appendChild(g);k.appendChild(h);h=document.createElement("td");b=document.createElement("label");b.className="container";c=document.createElement("input");c.type="checkbox";c.rndid=l;c.checked=d;c.onchange=xn;d=document.createElement("span");
d.className="checkmark";b.appendChild(c);b.appendChild(d);h.appendChild(b);k.appendChild(h);opttxt="<option value='"+(Math.pow(2,31)-1)+"'>Capturable</option>";i=0;for(len=z.nkingdom();i<len;i++)h=i?sc(xb(z.empName(i),17)):r.MISC_NATURE3,opttxt+='<option value="'+i+'">'+h+"</option>";h=document.createElement("td");g=document.createElement("select");g.innerHTML=opttxt;g.rndid=l;g.value=f;g.onchange=yn;h.appendChild(g);k.appendChild(h);h=document.createElement("td");f=document.createElement("button");
f.className="closeIcon";f.onclick=zn;f.rndid=l;h.appendChild(f);k.appendChild(h)},function(b,c,e,d,f,l,g,m,p,q,r){og(b,c,e,d,f,l,g,m,p,q,r)},function(){me()},function(){nd()},function(b,c,e){B[b]&&(b=B[b].attackSound)&&b.length&&na(b[~~(b.length*Math.random())],c,e)},function(b,c,e){na(b,c,e)},function(){Cb(55)},function(b,c,e,d,f,l){C(xb(b,20));p("custombody").innerHTML+="<tr>\n<td style='background:rgb("+d+","+f+","+l+')\' class="ucolor1"></td>\n<td class="username1">'+sc(xb(b,20))+'</td>\n<td style="display:none" class="race1">'+
e+'</td>\n<td class="team1">'+c+"</td></tr>"},function(){fd()},function(b,c,e,d,f,l,m,p){str="";l&&(str+="<span>"+r[Cd[l]]+"</span>");m&&(str+="<span>"+r[Cd[m]]+"</span>");C(p);if(p){str+='<span class="red">'+r.MISC_REQ3+": ";l=z.shapoint();l=new Int32Array(g.buffer,l,p);for(m=0;m<p;m++)str+=r[Cd[l[m]]],m+1<p&&(str+=", ");str+="</span>"}str+="<span>";b&&(str+=b+"<img class='resource' src='/nehhon/gold.gif' /> ");c&&(str+=c+"<img class='resource' src='/nehhon/wood.gif' /> ");e&&(str+=e+"<img class='resource' src='/nehhon/food.gif' /> ");
d&&(str+=d+"<img class='resource' src='/nehhon/stone.gif' /> ");str+="</span>";f&&(str+="<span class='shotcut'>"+String.fromCharCode(f).toUpperCase()+"</span>");Fh.innerHTML=str},function(b,c){Lk=[b,c]}];Hg.push({func:function(){An()}});var $a={last:0,caught:[],infos:{},deAdjust:function(b){if(!b||$a.infos[b])return b;for(var c in $a.infos)for(var e=+c,d=$a.infos[e].adjusted,f=d.length,k=0;k<f;k++)if(d[k]===b)return e;return b},addRef:function(b){b&&$a.infos[b].refcount++},decRef:function(b){if(b){var c=
$a.infos[b];yg(0<c.refcount);c.refcount--;0!==c.refcount||c.rethrown||(c.destructor&&g.dynCall_vi(c.destructor,b),delete $a.infos[b],Ei(b))}},clearRef:function(b){b&&($a.infos[b].refcount=0)}},wa={buffers:[null,[],[]],printChar:function(b,c){var e=wa.buffers[b];0===c||10===c?((1===b?Ig:Ob)(ri(e,0)),e.length=0):e.push(c)},varargs:0,get:function(b){wa.varargs+=4;return gb[wa.varargs-4>>2]},getStr:function(){var b=wa.get();return b?ri(Rc,b,void 0):""},get64:function(){var b=wa.get();wa.get();return b},
getZero:function(){wa.get()}};Fi=sg?function(){var b=process.hrtime();return 1E3*b[0]+b[1]/1E6}:"undefined"!==typeof dateNow?dateNow:"object"===typeof self&&self.performance&&"function"===typeof self.performance.now?function(){return self.performance.now()}:"object"===typeof performance&&"function"===typeof performance.now?function(){return performance.now()}:Date.now;var Dl=g.asm({},{abort:Ra,setTempRet0:function(b){Sc=b},getTempRet0:function(){return Sc},__ZSt18uncaught_exceptionv:Di,___cxa_find_matching_catch:xd,
___cxa_free_exception:Ei,___gxx_personality_v0:function(){},___resumeException:function(b){$a.last||($a.last=b);throw b;},___setErrNo:function(b){g.___errno_location&&(gb[g.___errno_location()>>2]=b);return b},___syscall140:function(b,c){wa.varargs=c;try{var e=wa.getStreamFromFD();wa.get();var d=wa.get(),f=wa.get(),k=wa.get();FS.llseek(e,d,k);gb[f>>2]=e.position;e.getdents&&0===d&&0===k&&(e.getdents=null);return 0}catch(n){return"undefined"!==typeof FS&&n instanceof FS.ErrnoError||Ra(n),-n.errno}},
___syscall146:function(b,c){wa.varargs=c;try{var e=wa.get(),d=wa.get(),f=wa.get();for(c=b=0;c<f;c++){for(var k=gb[d+8*c>>2],g=gb[d+(8*c+4)>>2],m=0;m<g;m++)wa.printChar(e,Rc[k+m]);b+=g}return b}catch(E){return"undefined"!==typeof FS&&E instanceof FS.ErrnoError||Ra(E),-E.errno}},___syscall54:function(b,c){wa.varargs=c;return 0},___syscall6:function(b,c){wa.varargs=c;try{var e=wa.getStreamFromFD();FS.close(e);return 0}catch(d){return"undefined"!==typeof FS&&d instanceof FS.ErrnoError||Ra(d),-d.errno}},
_emscripten_asm_const_i:function(b){return Qa[b]()},_emscripten_asm_const_idd:function(b,c,e){return Qa[b](c,e)},_emscripten_asm_const_ii:function(b,c){return Qa[b](c)},_emscripten_asm_const_iii:function(b,c,e){return Qa[b](c,e)},_emscripten_asm_const_iiii:function(b,c,e,d){return Qa[b](c,e,d)},_emscripten_asm_const_iiiii:function(b,c,e,d,f){return Qa[b](c,e,d,f)},_emscripten_asm_const_iiiiii:function(b,c,e,d,f,l){return Qa[b](c,e,d,f,l)},_emscripten_asm_const_iiiiiii:function(b,c,e,d,f,l,g){return Qa[b](c,
e,d,f,l,g)},_emscripten_asm_const_iiiiiiii:function(b,c,e,d,f,l,g,m){return Qa[b](c,e,d,f,l,g,m)},_emscripten_asm_const_iiiiiiiii:function(b,c,e,d,f,l,g,m,p){return Qa[b](c,e,d,f,l,g,m,p)},_emscripten_asm_const_iiiiiiiiiiii:function(b,c,e,d,f,l,g,m,p,q,r,v){return Qa[b](c,e,d,f,l,g,m,p,q,r,v)},_emscripten_get_heap_size:function(){return Mc},_emscripten_get_now:Fi,_emscripten_memcpy_big:function(b,c,e){Rc.set(Rc.subarray(c,c+e),b)},_emscripten_resize_heap:function(b){if(2147418112<b)return!1;for(var c=
Math.max(Mc,16777216);c<b;)c=536870912>=c?Dg(2*c,65536):Math.min(Dg((3*c+2147483648)/4,65536),2147418112);var e=Gi(c);if(!e||e.byteLength!=c)return!1;g.buffer=Wa=e;zi();Mc=c;Ai[1364208]=b;return!0},abortOnCannotGrowMemory:function(b){Ra("OOM")},emscripten_realloc_buffer:Gi,flush_NO_FILESYSTEM:function(){var b=g._fflush;b&&b(0);b=wa.buffers;b[1].length&&wa.printChar(1,10);b[2].length&&wa.printChar(2,10)},tempDoublePtr:5457072,DYNAMICTOP_PTR:5456832},Wa);g.asm=Dl;var An=g.__GLOBAL__sub_I_nh_cpp=function(){return g.asm.__GLOBAL__sub_I_nh_cpp.apply(null,
arguments)};g.__Z10Uint8Arrayj=function(){return g.asm.__Z10Uint8Arrayj.apply(null,arguments)};g.__Z10canvasSizejj=function(){return g.asm.__Z10canvasSizejj.apply(null,arguments)};g.__Z10changePagei=function(){return g.asm.__Z10changePagei.apply(null,arguments)};g.__Z10changeRaceji=function(){return g.asm.__Z10changeRaceji.apply(null,arguments)};g.__Z10changeTeamji=function(){return g.asm.__Z10changeTeamji.apply(null,arguments)};g.__Z10checkStockv=function(){return g.asm.__Z10checkStockv.apply(null,
arguments)};g.__Z10gInventoryj=function(){return g.asm.__Z10gInventoryj.apply(null,arguments)};g.__Z10gmaxHealthj=function(){return g.asm.__Z10gmaxHealthj.apply(null,arguments)};g.__Z10mouseEnterj=function(){return g.asm.__Z10mouseEnterj.apply(null,arguments)};g.__Z10movtablexev=function(){return g.asm.__Z10movtablexev.apply(null,arguments)};g.__Z10nameSharedPjS_j=function(){return g.asm.__Z10nameSharedPjS_j.apply(null,arguments)};g.__Z10pidkingdomj=function(){return g.asm.__Z10pidkingdomj.apply(null,
arguments)};g.__Z10searchUnitth=function(){return g.asm.__Z10searchUnitth.apply(null,arguments)};g.__Z10setupOnlIDj=function(){return g.asm.__Z10setupOnlIDj.apply(null,arguments)};g.__Z10shiftONOFFb=function(){return g.asm.__Z10shiftONOFFb.apply(null,arguments)};g.__Z10tempstraddv=function(){return g.asm.__Z10tempstraddv.apply(null,arguments)};g.__Z10touchStartjj=function(){return g.asm.__Z10touchStartjj.apply(null,arguments)};g.__Z10unitActionj=function(){return g.asm.__Z10unitActionj.apply(null,
arguments)};g.__Z10userConfigj=function(){return g.asm.__Z10userConfigj.apply(null,arguments)};g.__Z11Uint16Arrayj=function(){return g.asm.__Z11Uint16Arrayj.apply(null,arguments)};g.__Z11Uint32Arrayt=function(){return g.asm.__Z11Uint32Arrayt.apply(null,arguments)};g.__Z11changeColorjj=function(){return g.asm.__Z11changeColorjj.apply(null,arguments)};g.__Z11createItemsv=function(){return g.asm.__Z11createItemsv.apply(null,arguments)};g.__Z11getBufferIDv=function(){return g.asm.__Z11getBufferIDv.apply(null,
arguments)};g.__Z11movtableADDjjjj=function(){return g.asm.__Z11movtableADDjjjj.apply(null,arguments)};g.__Z11setupRandomi=function(){return g.asm.__Z11setupRandomi.apply(null,arguments)};g.__Z11showrndobjsv=function(){return g.asm.__Z11showrndobjsv.apply(null,arguments)};g.__Z11synchroHashv=function(){return g.asm.__Z11synchroHashv.apply(null,arguments)};g.__Z12bufferMarginfffj=function(){return g.asm.__Z12bufferMarginfffj.apply(null,arguments)};g.__Z12deletePlayerj=function(){return g.asm.__Z12deletePlayerj.apply(null,
arguments)};g.__Z12executeOrderjj=function(){return g.asm.__Z12executeOrderjj.apply(null,arguments)};g.__Z12setupIMGinfojjjjjjjjjjjjjjjjjjj=function(){return g.asm.__Z12setupIMGinfojjjjjjjjjjjjjjjjjjj.apply(null,arguments)};g.__Z12setupKingdomjjjjhbjjj=function(){return g.asm.__Z12setupKingdomjjjjhbjjj.apply(null,arguments)};g.__Z12unitObjetivej=function(){return g.asm.__Z12unitObjetivej.apply(null,arguments)};g.__Z13configTerrainv=function(){return g.asm.__Z13configTerrainv.apply(null,arguments)};
g.__Z13randomTerraini=function(){return g.asm.__Z13randomTerraini.apply(null,arguments)};g.__Z13readSavegame0j=function(){return g.asm.__Z13readSavegame0j.apply(null,arguments)};g.__Z13setupOnlTablej=function(){return g.asm.__Z13setupOnlTablej.apply(null,arguments)};g.__Z13sharedDelayIDv=function(){return g.asm.__Z13sharedDelayIDv.apply(null,arguments)};g.__Z13sharedFloatIDv=function(){return g.asm.__Z13sharedFloatIDv.apply(null,arguments)};g.__Z13startMovementv=function(){return g.asm.__Z13startMovementv.apply(null,
arguments)};g.__Z13tempointeraddj=function(){return g.asm.__Z13tempointeraddj.apply(null,arguments)};g.__Z13updateRNDtypejj=function(){return g.asm.__Z13updateRNDtypejj.apply(null,arguments)};g.__Z14customMapTablev=function(){return g.asm.__Z14customMapTablev.apply(null,arguments)};g.__Z14finishSavegamev=function(){return g.asm.__Z14finishSavegamev.apply(null,arguments)};g.__Z14onlineKingdomsv=function(){return g.asm.__Z14onlineKingdomsv.apply(null,arguments)};g.__Z14randomKingdomsi=function(){return g.asm.__Z14randomKingdomsi.apply(null,
arguments)};g.__Z14setupResourcesjjjjt=function(){return g.asm.__Z14setupResourcesjjjjt.apply(null,arguments)};g.__Z15configRandomMapv=function(){return g.asm.__Z15configRandomMapv.apply(null,arguments)};g.__Z15getColorTexturev=function(){return g.asm.__Z15getColorTexturev.apply(null,arguments)};g.__Z15setupOnlineGamePjS_j=function(){return g.asm.__Z15setupOnlineGamePjS_j.apply(null,arguments)};g.__Z15updateRNDnumberjj=function(){return g.asm.__Z15updateRNDnumberjj.apply(null,arguments)};g.__Z16setupTranslationjj=
function(){return g.asm.__Z16setupTranslationjj.apply(null,arguments)};g.__Z16updateRNDeach256jj=function(){return g.asm.__Z16updateRNDeach256jj.apply(null,arguments)};g.__Z16updateRNDkingdomjj=function(){return g.asm.__Z16updateRNDkingdomjj.apply(null,arguments)};g.__Z3rndi=function(){return g.asm.__Z3rndi.apply(null,arguments)};g.__Z4nAIsv=function(){return g.asm.__Z4nAIsv.apply(null,arguments)};g.__Z4testjj=function(){return g.asm.__Z4testjj.apply(null,arguments)};g.__Z5empXYv=function(){return g.asm.__Z5empXYv.apply(null,
arguments)};g.__Z5gCvalj=function(){return g.asm.__Z5gCvalj.apply(null,arguments)};g.__Z5gItemj=function(){return g.asm.__Z5gItemj.apply(null,arguments)};g.__Z5gManaj=function(){return g.asm.__Z5gManaj.apply(null,arguments)};g.__Z5gNamej=function(){return g.asm.__Z5gNamej.apply(null,arguments)};g.__Z5gTypej=function(){return g.asm.__Z5gTypej.apply(null,arguments)};g.__Z5nhlenv=function(){return g.asm.__Z5nhlenv.apply(null,arguments)};g.__Z5test2jj=function(){return g.asm.__Z5test2jj.apply(null,arguments)};
g.__Z5test3jj=function(){return g.asm.__Z5test3jj.apply(null,arguments)};g.__Z6amountv=function(){return g.asm.__Z6amountv.apply(null,arguments)};g.__Z6dbgspdj=function(){return g.asm.__Z6dbgspdj.apply(null,arguments)};g.__Z6gBuildj=function(){return g.asm.__Z6gBuildj.apply(null,arguments)};g.__Z6gcyclev=function(){return g.asm.__Z6gcyclev.apply(null,arguments)};g.__Z6giTypej=function(){return g.asm.__Z6giTypej.apply(null,arguments)};g.__Z6glevelj=function(){return g.asm.__Z6glevelj.apply(null,arguments)};
g.__Z6mapLocv=function(){return g.asm.__Z6mapLocv.apply(null,arguments)};g.__Z6mwMorei=function(){return g.asm.__Z6mwMorei.apply(null,arguments)};g.__Z6mwiconv=function(){return g.asm.__Z6mwiconv.apply(null,arguments)};g.__Z6nfolenv=function(){return g.asm.__Z6nfolenv.apply(null,arguments)};g.__Z6nhcompv=function(){return g.asm.__Z6nhcompv.apply(null,arguments)};g.__Z6onlADDjjjjb=function(){return g.asm.__Z6onlADDjjjjb.apply(null,arguments)};g.__Z6prelddv=function(){return g.asm.__Z6prelddv.apply(null,
arguments)};g.__Z6rdnh19mmmmmmjj=function(){return g.asm.__Z6rdnh19mmmmmmjj.apply(null,arguments)};g.__Z6runKeyjb=function(){return g.asm.__Z6runKeyjb.apply(null,arguments)};g.__Z6sndNfov=function(){return g.asm.__Z6sndNfov.apply(null,arguments)};g.__Z6strOnlv=function(){return g.asm.__Z6strOnlv.apply(null,arguments)};g.__Z6trraddv=function(){return g.asm.__Z6trraddv.apply(null,arguments)};g.__Z6unitXFj=function(){return g.asm.__Z6unitXFj.apply(null,arguments)};g.__Z6unitYFj=function(){return g.asm.__Z6unitYFj.apply(null,
arguments)};g.__Z6updownji=function(){return g.asm.__Z6updownji.apply(null,arguments)};g.__Z7crtStxtm=function(){return g.asm.__Z7crtStxtm.apply(null,arguments)};g.__Z7delTexsv=function(){return g.asm.__Z7delTexsv.apply(null,arguments)};g.__Z7empNamej=function(){return g.asm.__Z7empNamej.apply(null,arguments)};g.__Z7gAttackj=function(){return g.asm.__Z7gAttackj.apply(null,arguments)};g.__Z7gHelperj=function(){return g.asm.__Z7gHelperj.apply(null,arguments)};g.__Z7gIconIDj=function(){return g.asm.__Z7gIconIDj.apply(null,
arguments)};g.__Z7getPagev=function(){return g.asm.__Z7getPagev.apply(null,arguments)};g.__Z7ghealthj=function(){return g.asm.__Z7ghealthj.apply(null,arguments)};g.__Z7mouseUpiij=function(){return g.asm.__Z7mouseUpiij.apply(null,arguments)};g.__Z7nh19addj=function(){return g.asm.__Z7nh19addj.apply(null,arguments)};g.__Z7onldataj=function(){return g.asm.__Z7onldataj.apply(null,arguments)};g.__Z7plreadyv=function(){return g.asm.__Z7plreadyv.apply(null,arguments)};g.__Z7readSVGmmb=function(){return g.asm.__Z7readSVGmmb.apply(null,
arguments)};g.__Z7setupGLv=function(){return g.asm.__Z7setupGLv.apply(null,arguments)};g.__Z8atlasLocv=function(){return g.asm.__Z8atlasLocv.apply(null,arguments)};g.__Z8gControlj=function(){return g.asm.__Z8gControlj.apply(null,arguments)};g.__Z8gDefencej=function(){return g.asm.__Z8gDefencej.apply(null,arguments)};g.__Z8gKingdomj=function(){return g.asm.__Z8gKingdomj.apply(null,arguments)};g.__Z8gManaMaxj=function(){return g.asm.__Z8gManaMaxj.apply(null,arguments)};g.__Z8gstartedv=function(){return g.asm.__Z8gstartedv.apply(null,
arguments)};g.__Z8liveChatj=function(){return g.asm.__Z8liveChatj.apply(null,arguments)};g.__Z8mapWidthv=function(){return g.asm.__Z8mapWidthv.apply(null,arguments)};g.__Z8mnameaddv=function(){return g.asm.__Z8mnameaddv.apply(null,arguments)};g.__Z8mwSelectj=function(){return g.asm.__Z8mwSelectj.apply(null,arguments)};g.__Z8mwamounti=function(){return g.asm.__Z8mwamounti.apply(null,arguments)};g.__Z8nkingdomv=function(){return g.asm.__Z8nkingdomv.apply(null,arguments)};g.__Z8onlCountv=function(){return g.asm.__Z8onlCountv.apply(null,
arguments)};g.__Z8savegamev=function(){return g.asm.__Z8savegamev.apply(null,arguments)};g.__Z8shapointv=function(){return g.asm.__Z8shapointv.apply(null,arguments)};g.__Z8touchEndjj=function(){return g.asm.__Z8touchEndjj.apply(null,arguments)};g.__Z8userKickj=function(){return g.asm.__Z8userKickj.apply(null,arguments)};g.__Z9RNDdeletej=function(){return g.asm.__Z9RNDdeletej.apply(null,arguments)};g.__Z9addRNDobjv=function(){return g.asm.__Z9addRNDobjv.apply(null,arguments)};g.__Z9boolArrayt=function(){return g.asm.__Z9boolArrayt.apply(null,
arguments)};g.__Z9closeRoomv=function(){return g.asm.__Z9closeRoomv.apply(null,arguments)};g.__Z9createMapi=function(){return g.asm.__Z9createMapi.apply(null,arguments)};g.__Z9ginfonamejj=function(){return g.asm.__Z9ginfonamejj.apply(null,arguments)};g.__Z9mouseDowniij=function(){return g.asm.__Z9mouseDowniij.apply(null,arguments)};g.__Z9mouseMoveii=function(){return g.asm.__Z9mouseMoveii.apply(null,arguments)};g.__Z9onLimits2ii=function(){return g.asm.__Z9onLimits2ii.apply(null,arguments)};g.__Z9randomMapv=
function(){return g.asm.__Z9randomMapv.apply(null,arguments)};g.__Z9selectionv=function(){return g.asm.__Z9selectionv.apply(null,arguments)};g.__Z9setupGamejjjjjjjjjjjj=function(){return g.asm.__Z9setupGamejjjjjjjjjjjj.apply(null,arguments)};g.__Z9setupInfojjjjjjjjjjcchhhhhhbbPjhbPbS_hthS_hth=function(){return g.asm.__Z9setupInfojjjjjjjjjjcchhhhhhbbPjhbPbS_hthS_hth.apply(null,arguments)};g.__Z9setupOdinj=function(){return g.asm.__Z9setupOdinj.apply(null,arguments)};g.__Z9setupZoomf=function(){return g.asm.__Z9setupZoomf.apply(null,
arguments)};g.__Z9shareNamej=function(){return g.asm.__Z9shareNamej.apply(null,arguments)};g.__Z9touchMovejj=function(){return g.asm.__Z9touchMovejj.apply(null,arguments)};g.___errno_location=function(){return g.asm.___errno_location.apply(null,arguments)};g._emscripten_replace_memory=function(){return g.asm._emscripten_replace_memory.apply(null,arguments)};var Rl=g._free=function(){return g.asm._free.apply(null,arguments)};g._llvm_bswap_i32=function(){return g.asm._llvm_bswap_i32.apply(null,arguments)};
g._main=function(){return g.asm._main.apply(null,arguments)};var Sl=g._malloc=function(){return g.asm._malloc.apply(null,arguments)};g._memcpy=function(){return g.asm._memcpy.apply(null,arguments)};g._memset=function(){return g.asm._memset.apply(null,arguments)};g._sbrk=function(){return g.asm._sbrk.apply(null,arguments)};g.establishStackSpace=function(){return g.asm.establishStackSpace.apply(null,arguments)};var xi=g.stackAlloc=function(){return g.asm.stackAlloc.apply(null,arguments)};g.stackRestore=
function(){return g.asm.stackRestore.apply(null,arguments)};g.stackSave=function(){return g.asm.stackSave.apply(null,arguments)};g.dynCall_ii=function(){return g.asm.dynCall_ii.apply(null,arguments)};g.dynCall_iii=function(){return g.asm.dynCall_iii.apply(null,arguments)};g.dynCall_iiii=function(){return g.asm.dynCall_iiii.apply(null,arguments)};g.dynCall_iiiii=function(){return g.asm.dynCall_iiiii.apply(null,arguments)};g.dynCall_v=function(){return g.asm.dynCall_v.apply(null,arguments)};g.dynCall_vi=
function(){return g.asm.dynCall_vi.apply(null,arguments)};g.dynCall_vii=function(){return g.asm.dynCall_vii.apply(null,arguments)};g.dynCall_viii=function(){return g.asm.dynCall_viii.apply(null,arguments)};g.asm=Dl;Tc.prototype=Error();Tc.prototype.constructor=Tc;wd=function c(){g.calledRun||Fg();g.calledRun||(wd=c)};g.callMain=function(b){b=b||[];xe||(xe=!0,ud(Hg));var c=b.length+1,d=xi(4*(c+1));gb[d>>2]=se(g.thisProgram);for(var f=1;f<c;f++)gb[(d>>2)+f]=se(b[f-1]);gb[(d>>2)+c]=0;try{var l=g._main(c,
d,0);if(!g.noExitRuntime||0!==l){if(!g.noExitRuntime&&(Gg=!0,g.onExit))g.onExit(l);g.quit(l,new Tc(l))}}catch(n){n instanceof Tc||("SimulateInfiniteLoop"==n?g.noExitRuntime=!0:((b=n)&&"object"===typeof n&&n.stack&&(b=[n,n.stack]),Ob("exception thrown: "+b),g.quit(1,n)))}finally{}};g.run=Fg;g.abort=Ra;if(g.preInit)for("function"==typeof g.preInit&&(g.preInit=[g.preInit]);0<g.preInit.length;)g.preInit.pop()();var Hi=!0;g.noInitialRun&&(Hi=!1);g.noExitRuntime=!0;Fg();var Bg=!1,z={};ve=Xb;var Lc,lg,Sk,
qb,mi=function(){Bg=!0;for(var b=g.asm,e=Object.keys(b),d=e.length,h="inspector71017 newUnit radar createMap falseunit synchroHash rnd setupRandom randomTerrain unitMovement test setupInfo setupKingdom shapoint Uint16Array setupTech setupRequirements boolArray AIobjetive test2 searchUnit killUnit investigateTech AIprocess setupResources unitWorking movtablexe test3 unitParameter setupGL bufferColor getBufferID setupIMGinfo atlasLoc randomMap selection gAttack gDefence glevel ghealth gmaxHealth gMana gItem gBuild gKingdom executeOrder shiftONOFF gType IMGdata Uint32Array getColorTexture canvasSize setupZoom setupTranslation mouseDown mouseUp sharedFloatID setupGame mouseMove gCval gManaMax giType setupOdin empXY nkingdom empName changePage gInventory gControl checkStock runKey sharedDelayID amount mwicon mwSelect mwMore mwamount createItems gIconID mouseEnter gHelper startMovement savegame finishSavegame readSavegame0 readSVG customMapTable mapWidth gcycle dbgspd randomKingdoms changeTeam changeRace userConfig onlineKingdoms setupOnlTable onlADD changeColor sndNfo tempointeradd onldata shareName mnameadd configRandomMap strOnl plready setupOnlID preldd nAIs closeRoom onlCount userKick pidkingdom deletePlayer updown tempstradd liveChat gstarted trradd nh19add nhcomp nhlen rdnh19 crtStxt configTerrain delTexs gName touchStart touchMove touchEnd showrndobjs ginfoname nfolen updateRNDtype updateRNDkingdom updateRNDnumber updateRNDeach256 addRNDobj RNDdelete".split(" "),
l=0,m=h.length;l<m;l++)for(var q=h[l],r=0;r<d;r++){var t=e[r];if(-1<t.indexOf(q)){z[h[l]]=b[t];break}}b=z.shapoint();Lc=new Int32Array(g.buffer,b,1024);qb=id(z.sharedFloatID(),5);lg=id(z.sharedFloatID(),3);Sk=id(z.sharedFloatID(),4);Pc(z.userConfig(parseInt(w.color.substr(1),16)),17,w.name||"Guest");localStorage.webgl&&"2"!=localStorage.webgl||(f=document.getElementById("tzar").getContext("webgl2",{antialias:!1}));f||(f=p("tzar").getContext("webgl",{antialias:!1}),Ba=!0);w.gl=f;mi.waiting&&nd();ve()},
Pc=function(b,e,d){b=xb(b,e);for(var c=0;c<e;c++)b[c]=d.charCodeAt(c)},Ym=function(b){for(var c=0,d=b.length;c<d;Lc[c]=b[c++]);};mi.waiting=!1;g.postRun[0]=mi;var ug=window.indexedDB.open("nh2019",w.versionInt),ya,Bn=[];ug.onsuccess=function(b){ya=ug.result;p("savelocal").onclick=Og;Ng("basic",function(b){b=b.target.result;for(var c=Pi(),e=0;e<c.length;e++)if(-1==b.indexOf(w.cdn+c[e]))return;p("topLinks").removeChild(p("savelocal"))});for(b=0;b<Bn.length;b++)xtradbfunc[b]()};ug.onupgradeneeded=function(b){ya=
ug.result;C(ya);ya.objectStoreNames.contains("basic")&&ya.deleteObjectStore("basic");ya.objectStoreNames.contains("maps")||ya.createObjectStore("maps",{keyPath:"id",autoIncrement:!0});ya.objectStoreNames.contains("mapsBlobs")||ya.createObjectStore("mapsBlobs",{keyPath:"id2",autoIncrement:!0});ya.objectStoreNames.contains("basic")||ya.createObjectStore("basic",{keyPath:"url"})};var Oi=function(b){ya&&(ya.transaction(["basic"],"readwrite").objectStore("basic").add(b).onsuccess=function(){})},fn=function(b,
e){var c=ya.transaction(["maps"],"readwrite");c.objectStore("maps").add(b).onsuccess=function(){C("done")};c=ya.transaction(["mapsBlobs"],"readwrite");c.objectStore("mapsBlobs").add(e).onsuccess=function(){C("done")}},Ng=function(b,e){if(ya){var c=ya.transaction([b],"readonly");if(c.objectStore(b).getAllKeys)b=c.objectStore(b).getAllKeys();else return e({target:{result:[]}});b.onsuccess=e}else e({target:{result:[]}})},tn=function(b,e,d){ya.transaction([b],"readonly").objectStore(b).get(d).onsuccess=
function(b){e(b.target.result.buffer)}},El=function(){ya?ya.transaction(["maps"],"readwrite").objectStore("maps").getAll().onsuccess=Cn:xtradbfunc=El},Cn=function(b){b=b.target.result;var c=b.length;if(c){var d=p("mapcache");d.innerHTML='<tr style="font-size:23px"><td>Name</td><td>Date</td><td>'+r.PLAYED_TIME+"</td></tr>";for(--c;-1<c;c--){var f=b[c],l=document.createElement("tr");l.cid=f.id;var g=new Date(f.date),m=g.getHours(),q="0"+g.getMinutes();g.getSeconds();var t=g.getDate(),w=g.getMonth()+
1;g=g.getFullYear();m=m+":"+q.substr(-2)+" &nbsp; &nbsp;"+t+"/"+w+"/"+g;l.onclick=ni;l.innerHTML="<td>"+(f.name||"savegame")+"</td><td>"+m+"</td><td>"+hj(f.played)+"</td>";d.appendChild(l)}C(b)}},ni=function(){var b=this.cid;ya.transaction(["mapsBlobs"],"readwrite").objectStore("mapsBlobs").get(b).onsuccess=ni.step2};ni.step2=function(b){b=b.target.result;var c=new FileReader;c.onload=zl;c.readAsArrayBuffer(b)};var ah=function(b,e,d,f){if(di&&!t.editor){var c=di.events.defined[e.id];if(c&&c[d])if(c=
c[d],"zone"==d)for(b=0,f=c.length;b<f;b+=5){d=c[b];var h=c[b+2],g=c[b+3],m=c[b+4];e.x32>=c[b+1]&&e.x32<=g&&e.y32>=h&&e.y32<=m?(e.inZone||(e.inZone={}),e.inZone[d.id]||vg([c[b]],1),e.inZone[d.id]=1):e.inZone&&e.inZone[d.id]&&(e.inZone[d.id]=0,vg([c[b]],-1))}else{if(!f)return vg(c,b);C(f.name);e=c.defined;e[f.id]&&vg(e[f.id],b)}}},vg=function(b,e){for(var c=b.length,f=0;f<c;f++){var l=b[f],g=l.rule,m=l.activeEvents;l.activeEvents+=e;0===m?g.activeEvents++:0===l.activeEvents&&g.activeEvents--;if(1==
e&&g.activeEvents==g.events.length)for(l=0,g=g.actions,m=g.length;l<m;l++){var p=g[l];C("action:",p.type);if(Fl[p.type])Fl[p.type](p.to[0],p.list)}}},Fl={attack:Rb,move:Ib},ai={start:function(){},func:function(){C(t.arje);if(void 0==t.arje){Ab();p("editorRandom").checked?t.arje=555555*Math.random()+1:t.arje=!1;t.mapx=parseInt(p("editorSize").value);t.mapy=t.mapx;t.goldRes=Infinity;t.foodRes=Infinity;t.woodRes=Infinity;t.stoneRes=Infinity;t.gravity=580.9/9.8*9.8;t.terrainType="grass";pd=[];for(var b=
0,e=parseInt(p("editorPlayers").value);b<e;b++){for(var d="#"+(~~(16777216*Math.random())).toString(16);7>d.length;)d+="0";pd[b]={color:d,IA:!1,name:"Tzar "+(b+1),race:0,team:0}}document.body.removeChild(p("mapForm"))}t.editor=1;nd()}},kg=function(){var b=p("selectKingdom");b.innerHTML="";for(var e=1,d=I.length;e<d;e++){var f=I[e];1===e&&(b.style.background="rgba("+f.color[0]+","+f.color[1]+","+f.color[2]+",1)");b.innerHTML+='<option value="'+e+'" style="background:rgba('+f.color[0]+","+f.color[1]+
","+f.color[2]+',1)">'+f.name+"</option>"}},M=function(b){p(b).style.display="none"},ka=function(b){p(b).style.display="block"},bi=function(b){var c=ja;c.img=m.blank;var d=32*rd();c.wh=[d,d];c.active=!0;document.addEventListener("mousemove",Mb);document.addEventListener("mousedown",Gl);Mb.active=b},Gl=function(b){if(2==b.buttons||b.pageX<w.menumx||b.pageY<w.menumy)return Hl();Mb(b)},sk=function(b){if(t.editor){var c=parseInt(p("brushSize").value)+b;c>p("brushSize").max?p("brushSize").value=p("brushSize").max:
1>c?p("brushSize").value=1:(p("brushSize").value=c,ja.wh&&(ja.wh[0]+=32*b,ja.wh[1]+=32*b,ja.active=!0))}},rd=function(){return parseInt(p("brushSize").value)},ci=function(b,e,d){b=rd();for(var c=b*b,f=H,g=mg,m=ci.active,p=Qk.type,q=0;q<c;q++){var r=e+q%b,t=d+~~(q/b);fa(r,t)&&(r+=t*f,g[r]=m,p[m]&&(2<Y[r]&&A[Y[r]].die(),2<kb[r]&&A[kb[r]].die()))}Kc()},an=function(b,e,d){b=rd();for(var c=b*b,f=H,g=0;g<c;g++){var m=e+g%b,p=d+~~(g/b);fa(m,p)&&(0===Y[m+p*f]?.2>Math.random()&&hh([m+p*f,7,{d:3+~~(28*Math.random())}]):
(m=A[Y[m+p*f]],7==m.type&&m.die()))}},$m=function(b,e,d){b=rd();for(var c=b*b,f=H,g=0;g<c;g++){var m=e+g%b,p=d+~~(g/b);fa(m,p)&&(m=A[Y[m+p*f]],7==m.type&&m.die())}},Mb=function(b){var c=32*rd();c=fc(b.pageX-w.mx-.5*c/S,b.pageY-.5*c/S);var d=~~(.03125*c[1]);c=~~(.03125*c[0]);ja.x=32*c;ja.y=32*d;ja.active=!0;if(0!==b.buttons){if(2==b.buttons)return Hl();Mb.last!==c+d*H&&Mb.active&&Mb.active(b,c,d);Mb.last=c+d*H}},Hl=function(){ja.active=!0;ja.x=-9999;ja.y=-9999;if(Mb.active){var b=32*rd();fc(event.pageX-
w.mx-.5*b/S,event.pageY-.5*b/S);Mb.active=!1}ja.wh=void 0;document.removeEventListener("mousedown",Gl);document.removeEventListener("mousemove",Mb)},jk=function(){C(this);this.parentElement.parentElement.style.display="none";Ab()},kk={objAction:{id:"edobjAction",msg:"",func:function(){ra.active.type="attack";ka("selectionEvents");M("eventZone");ka("unitListDiv2");p("byButton2").style.display="inline-block";p("byButton1").style.display="inline-block";ra.active.zone=void 0}},objZone:{id:"edobjAction",
msg:0,func:function(){ra.active.type="zone";ra.active.to.length=0;M("selectionEvents");p("eventZone").style.display="inline-block";M("byButton2");M("byButton1");M("unitListDiv2");Il()}}},dd=function(b){if(b)M("mapRulesWindow"),Ab(),dd.actived=!0;else if(dd.actived){ka("mapRulesWindow");vc();b=~~((void 0)[0]/32);var c=~~((void 0)[1]/32),d=~~((void 0)[9]/32),f=~~((void 0)[10]/32);if(b<d)var g=b,m=d;else g=d,m=b;if(c<f)var p=c,q=f;else p=f,q=c;ra.active.zone||(ra.active.zone=[]);ra.active.zone.put([g,
p,m,q]);C(b,c,d,f);Il();dd.actived=!1}},Il=function(){var b=p("zoneList");b.innerHTML="";var e=ra.active.zone;if(e)for(var d=e.length,f=0;f<d;f++){var g=e[f],m=document.createElement("div"),q=document.createElement("button");q.innerHTML="x";q.obj=g;q.pObj=e;q.spObj=!0;q.onclick=oi;m.innerHTML=g[0]+"x "+g[1]+"y -> "+g[2]+"x "+g[3]+"y";m.appendChild(q);b.appendChild(m)}},Jl={moving:1},Jm=function(){Jl[this.value]?(M("byButton2"),M("byButton1"),M("unitListDiv2")):(ka("unitListDiv2"),p("byButton2").style.display=
"inline-block",p("byButton1").style.display="inline-block");ra.active.type=this.value},Km=function(){Jl[this.value]?(M("toButton2"),M("toButton1"),M("unitListDivAction2")):(ka("unitListDivAction2"),p("toButton2").style.display="inline-block",p("toButton1").style.display="inline-block");ob.active.type=this.value},vb=function(b){if(b)M("mapRulesWindow"),Ab(),vb.actived=b.button;else if(vb.actived){ka("mapRulesWindow");vc();b=vb.actived.spType.active;b="unitListDiv2"==vb.actived.id||"unitListDivAction2"==
vb.actived.id?b.to:b.list;for(var c={},d=0,f=b.length;d<f;d++)c[b[d]]=1;d=0;for(f=Q.length;d<f;d++)c[Q[d]]||b.put(Q[d]);re(vb.actived,b);vb.actived=!1}},re=function(b,e){b.innerHTML="";for(var c=0,f=e.length;c<f;c++){var g=document.createElement("div");g.innerHTML=A[e[c]].name;var m=document.createElement("button");m.onclick=oi;m.innerHTML="x";m.pObj=e;m.spObj=!0;m.obj=e[c];g.appendChild(m);b.appendChild(g)}},pb=function(){pb.active&&(pb.active.className="");pb.active=this;this.className="spSelect";
for(var b=this.parentElement.getElementsByTagName("section"),e=0,d=b.length;e<d;e++)b[e].style.display="none";this.sdiv.style.display="block"},ub=function(){var b=this.editorRule;b.deleted||(ka("mapEvent"),ka("mapActions"),M("eventOptions"),ub.active&&(ub.div.className=""),this.className="spSelect",ub.active=b,ub.div=this,Kf(b,"eventLayout"),Kf(b,"actionLayout"),ra.div&&M(ra.div),ra.div1=void 0)},ra=function(){var b=this.editorRule;b.deleted||(ka("eventOptions"),ra.div1&&(ra.div1.className=""),this.className=
"spSelect",ra.active=b,p("selectionEvents").value=b.type,ra.div1=this,p("eventOptions").value=b.name,ra.div=kk[b.name].id,ka(ra.div),re(p("unitListDiv"),b.list),re(p("unitListDiv2"),b.to))},ob=function(){var b=this.editorRule;b.deleted||(ka("actionOptions"),ob.div1&&(ob.div1.className=""),this.className="spSelect",ob.active=b,p("selectionActions").value=b.type,ob.div1=this,p("actionOptions").value=b.name,ob.div="ed"+b.name,ka(ob.div),re(p("unitListDivAction"),b.list),re(p("unitListDivAction2"),b.to))},
Kf=function(b,e){p(e).innerHTML="";if("eventLayout"==e){b=b.events;var c=ra,f=ub.active.events}else b=b.actions,c=ob,f=ub.active.actions;for(var g=0,m=b.length;g<m;g++){var q=document.createElement("div");wg(q,b[g],c,f);p(e).appendChild(q)}},Hm=function(){var b=ub.active,e={name:"objAction",list:[],to:[],type:"attack"};b.events.put(e);var d=document.createElement("div");wg(d,e,ra,b.events);p("eventLayout").appendChild(d);if(ra.div1)ra.div1.onclick()},Im=function(){var b=ub.active,e={name:"objOrder",
list:[],to:[],type:"move"};b.actions.put(e);var d=document.createElement("div");wg(d,e,ob,b.actions);p("actionLayout").appendChild(d);if(ob.div1)ob.div1.onclick()},wg=function(b,e,d,f){b.innerHTML=e.events?e.name:r[e.name];b.onclick=d;b.editorRule=e;d=document.createElement("button");d.innerHTML="x";d.obj=e;d.pObj=f;d.onclick=oi;b.appendChild(d)},Gm=function(){t.rules||(t.rules=[]);var b={name:"Rule"+t.rules.length,events:[],actions:[]};t.rules.put(b);var e=document.createElement("div");wg(e,b,ub,
t.rules);p("rulist").appendChild(e)},oi=function(){this.pObj.quit(this.obj);this.obj.deleted=!0;this.parentElement.parentElement.removeChild(this.parentElement);if(!this.spObj)if(this.pObj!==t.rules)ub.div.onclick();else M("mapEvent"),M("mapActions")},Gh=function(){var b=p("mapPropsWindow").getElementsByTagName("table")[0];b.innerHTML="";b.innerHTML+="<tr><td>"+r.color+"</td><td>"+r.MP_SEARCH_T_PL_NAME+"</td><td>"+r.VIEWMSG_GOLD+"</td><td>"+r.VIEWMSG_WOOD+"</td><td>"+r.VIEWMSG_FOOD+"</td><td>"+r.VIEWMSG_STONE+
"</td><td>"+r.AI+"</td><td>"+r.TEAM+"</td></tr>";for(var e=1,d=I.length;e<d;e++){var f=I[e],g=f.color,m=f.resources;g="#"+(16777216+(g[0]<<16)+(g[1]<<8)+g[2]).toString(16).slice(1);b.innerHTML+='<tr><td><input style="background:'+g+'" type="color" value="'+g+'" /></td><td><input type="text" value="'+f.name+'"></td>\n\n<td><input type="text" class="res" value="'+(parseInt(m[0])||"\u221e")+'"></td>\n<td><input type="text" class="res" value="'+(parseInt(m[1])||"\u221e")+'"></td>\n<td><input type="text" class="res" value="'+
(parseInt(m[2])||"\u221e")+'"></td>\n<td><input type="text" class="res" value="'+(parseInt(m[3])||"\u221e")+'"></td>\n<td><label class="container">\n  <input type="checkbox">\n  <span class="checkmark"></span>\n</label></td><td><input type="number" min="0" value="'+f.team+'"></td></tr>'}b.innerHTML+="<tr><td><button id='editorAdd'>+</button><button id='editorDelete'>-</button></td></tr>";p("editorAdd").onclick=Dn;p("editorDelete").onclick=En;b=b.getElementsByTagName("input");e=0;for(d=I.length-1;e<
d;e++)m=8*e,f=I[e+1],b[m].onchange=Fn,b[m+1].onchange=Gn,b[m+2].onchange=xg,b[m+3].onchange=xg,b[m+4].onchange=xg,b[m+5].onchange=xg,b[m+2].res=0,b[m+3].res=1,b[m+4].res=2,b[m+5].res=3,b[m+6].onchange=Hn,b[m+6].checked=f.IA,b[m+7].onchange=In,b[m].team=e+1,b[m+1].team=e+1,b[m+2].team=e+1,b[m+3].team=e+1,b[m+4].team=e+1,b[m+5].team=e+1,b[m+6].team=e+1,b[m+7].team=e+1},xg=function(){var b=parseInt(this.value);b||(b=Infinity,this.value="\u221e");I[this.team].resources[this.res]=b},Dn=function(){new Ec("Tzar "+
I.length,[~~(256*Math.random()),~~(256*Math.random()),~~(256*Math.random())],[0],0,!0,[t.goldRes,t.woodRes,t.foodRes,t.stoneRes],2);kg();Gh()},En=function(){if(2<I.length){for(var b=I.length-1,e=3,d=A.length;e<d;e++){var f=A[e];f.kingdom==b&&f.die()}I.length--;kg();Gh()}},Fn=function(){var b=I[this.team],e=parseInt(this.value.substr(1),16),d=e>>16&255,f=e>>8&255;e&=255;b.color=[d,f,e];var g=this.team;b=ta[g];I[g].color=[d,f,e];d=0;for(f=b.length;d<f;d++){e=b[d];g=0;for(var m=e.length;g<m;g++)Kb(A[e[g]])}kg()},
Gn=function(){I[this.team].name=this.value},Hn=function(){I[this.team].IA=this.checked?!0:!1},In=function(){var b=I[this.team];b.team=parseInt(this.value);for(var e=I.length,d=1;d<e;d++){var f=I[d];f.team!==b.team&&(f.diplomacy[b.k]=1,b.diplomacy[f.k]=1)}},kn=function(b){if(b=p("maploadOnline").files[0]){b.name.split(".");var c=new FileReader;c.onload=function(){var b=new Uint8Array(this.result);if(w.admin){M("optionbutton");var c=b.length;C(999999999,44444);for(var e=fb.step,f=0;f<c;f+=e)b.slice(f,
f+e),C(999999999,44444);jl(b);C(Wb);kl(Wb.kingdoms.length);p("nplayersO").value=w.room.max;p("deleteCusMap").style.display="inline-table"}};c.readAsArrayBuffer(b)}},Wb,vn=function(){this.types.innerHTML=tg[this.value];this.types.value=""},un=function(){z.updateRNDtype(this.rndid,this.value)},yn=function(){z.updateRNDkingdom(this.rndid,this.value)},wn=function(){z.updateRNDnumber(this.rndid,this.value)},xn=function(){z.updateRNDeach256(this.rndid,this.checked)},zn=function(){z.RNDdelete(this.rndid);
pi()},Jn=function(){z.addRNDobj();pi()},pi=function(){p("rndtable").innerHTML='<tr style="height: 57px"><td>Type</td><td>Object</td><td>Amount</td><td>Each 256\u00b2</td><td>'+r.MISC_KINGDOM3+"</td><td></td></tr>";z.showrndobjs();var b=document.createElement("tr"),e=document.createElement("td"),d=document.createElement("button");d.innerHTML=r.ADD;d.onclick=Jn;e.appendChild(d);b.appendChild(e);p("rndtable").appendChild(b)},tg,ml=function(){p("mapconfiguration")||ue("mapconfiguration");p("mapconfiguration").style.display=
"block";p("basic").style.filter="blur(94px)";if(""==p("mapconfiguration").innerHTML){tg=["","","",""];for(var b=0;4>b;b++){for(var e="",d=0,f=z.nfolen();d<f;d++){var g=z.ginfoname(d,b);g&&(e+='<option value="'+d+'">'+r[Cd[g]].toUpperCase()+"</option>")}tg[b]=e}b="";e=["grass","trenkorian"];d=0;for(f=e.length;d<f;d++)b+='<option value="'+e[d]+'" '+(e[d]==localStorage.terrain?"selected":"")+">"+(r[e[d]]||e[d])+"</option>";d="";"true"==localStorage.infinity&&(d="checked");p("mapconfiguration").innerHTML=
'<div><button id="closeButton1" class="closeIcon"></button><table>\n<tbody>\n<tr><td>'+r.MP_SETUPMAP_T_MAP_SIZE+'</td><td><input id="mapwidth" type="number" value="'+localStorage.mapx+'" step="32" min="32" max="1024" /></td></tr>\n<tr><td><hr></td></tr>\n<tr><td>'+r.MP_SETUPMAP_T_ST_RES+"</td></tr>\n<tr><td><hr></td></tr>\n<tr><td>"+r.MISC_INF3+'</td><td><label class="container">\n  <input id="infiniteValue" type="checkbox" '+d+'>\n  <span class="checkmark"></span>\n</label></td></tr>\n<tr><td>'+
r.VIEWMSG_GOLD+'</td><td><input id="goldValue" type="number" value="'+localStorage.goldRes+'" step="250" /></td></tr>\n<tr><td>'+r.VIEWMSG_WOOD+'</td><td><input id="woodValue" type="number" value="'+localStorage.woodRes+'" step="250" /></td></tr>\n<tr><td>'+r.VIEWMSG_FOOD+'</td><td><input id="foodValue" type="number" value="'+localStorage.foodRes+'" step="250" /></td></tr>\n<tr><td>'+r.VIEWMSG_STONE+'</td><td><input id="stoneValue" type="number" value="'+localStorage.stoneRes+'" step="250" /></td></tr>\n<tr><td><hr></td></tr>\n<tr><td>'+
r.MP_SETUPMAP_T_TERRAIN+'</td></tr>\n<tr><td><select name="terrain" id="terrainSelect">\n'+b+"\n<tr><td>"+r.WATER+'</td><td><input type="number" value="'+localStorage.water+'" id="waterValue" min="0"/></td></tr>\n<tr><td>'+r.INITIAL_PEASANTS+'</td><td><input type="number" value="'+localStorage.peons+'" id="peonValue" min="0"/></td></tr>\n<tr><td>'+r.FREE_POP+'</td><td><input type="number" value="'+localStorage.freePop+'" id="freePopValue" /></td></tr>\n</select>\n</td>\n</tr>\n</tbody>\n</table>\n<hr style="margin: 25px">\n<table>\n<tbody id="rndtable">\n</tbody>\n</div>';
pi();p("infiniteValue").onchange=function(){var b=this.checked;p("goldValue").disabled=b;p("stoneValue").disabled=b;p("woodValue").disabled=b;p("foodValue").disabled=b};p("infiniteValue").onchange();p("closeButton1").onclick=function(){t.online&&Qc();p("mapconfiguration").style.display="none";Ab()}}};p("returnmenu").onclick=ec;var Kn=function(){C(this,this.checked);localStorage[this.localProp]=this.checked},Kl=function(){var b=this.value;"color"==this.type?this.style.backgroundColor=b:"name"==this.localProp&&
(b=Va(b));w[this.localProp]=b;localStorage[this.localProp]=b},Cg={Multiplayer:Hb,RandomMap:yl,Twitter:function(){p("returnmenu").style.display="block"},Account:function(){od.returnmenu.style.display="block";""==od.Account.innerHTML&&(od.Account.innerHTML='<iframe id="accountIframe"></iframe>',od.accountIframe=p("accountIframe"));od.accountIframe.src=baseUrl+w.langCodeUrl+"account/?iframe=1"},MapEditor:ai.start,CustomMap:function(){""==p("CustomMap").innerHTML&&(p("CustomMap").innerHTML="<h2>"+r.SINGLESCR_LOAD.split("| ")[0]+
'</h2>\n<input id="mapload" type="file" />\n<label for="mapload" id="maploadlabel">Choose a file</label>\n<table id="mapcache"></table>\n<div id="customMapcont" style="display:none">\n<table class="players" id="customaptable">\n<tbody id="custombody">\n</tbody>\n</table>\n<button style="margin-left:40px" id="startCustom" class="start startButton">'+r.MP_MPLAYER_PLAY+'</button>\n\n<button style="margin-left:40px" id="closeCustom" class="start">'+r.GENERAL_CLOSE+"</button>\n</div>",p("closeCustom").onclick=
function(){M("customMapcont");p("maploadlabel").style.display="inline-block";p("mapcache").style.display="table"},p("startCustom").onclick=function(){M("customMapcont");p("closeCustom").onclick();nd()},p("mapload").accept=".tzared",p("mapload").onchange=function(b){b=p("mapload").files[0];C(b);b.name.split(".");var c=new FileReader;c.onload=zl;c.readAsArrayBuffer(b)});ka("returnmenu");El()},Settings:function(){var b=p("Settings");if(""==b.innerHTML){var e=document.createElement("h2");e.innerHTML=
r.MP_MPLAYER_SETTINGS;b.appendChild(e);e=document.createElement("div");var d=document.createElement("span");d.innerHTML=r.COLOUR;e.appendChild(d);var f=document.createElement("input");f.type="color";f.value=localStorage.color;f.onchange=Kl;f.localProp="color";f.style.backgroundColor=localStorage.color;e.appendChild(f);d=document.createElement("span");d.innerHTML=r.MP_SEARCH_T_PL_NAME;e.appendChild(d);f=document.createElement("input");f.type="text";f.value=dl(localStorage.name);f.onchange=Kl;f.localProp=
"name";e.appendChild(f);d=document.createElement("span");d.innerHTML=r.LANGUAGE;e.appendChild(d);d=document.createElement("select");d.innerHTML='<option value="en">English</option>\n<option value="es">Espa\u00f1ol</option>\n<option value="it">Italiano</option>\n<option value="pt">Portugu\u00eas</option>\n<option value="pl">Polski</option>\n<option value="de">Deutsch</option>\n<option value="ru">\u0420\u0443\u0441\u0441\u043a\u0438\u0439</option>\n<option value="bg">\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438</option>\n';
d.value=w.langstr;d.onchange=function(){localStorage.language=this.value;location.href=""};e.appendChild(d);d=document.createElement("span");d.innerHTML=r.AUTOFULLSCREEN;e.appendChild(d);var g=document.createElement("label");g.className="container";d=document.createElement("span");d.className="checkmark";f=document.createElement("input");f.type="checkbox";f.checked="true"==localStorage.fullscreen?!0:!1;f.onchange=Kn;f.localProp="fullscreen";g.appendChild(f);g.appendChild(d);e.appendChild(g);d=document.createElement("span");
d.innerHTML="GPU";e.appendChild(d);d.style.marginTop="65px";d=document.createElement("select");d.innerHTML='<option value="1">WebGL 1</option>\n<option value="2">WebGL 2 (recommended)</option>\n';d.value=Ba?1:2;d.onchange=function(){localStorage.webgl=this.value;location.href=""};e.appendChild(d);b.appendChild(e)}ka("returnmenu")},About:function(){var b=p("About");""==b.innerHTML&&(b.innerHTML='<div style="text-align:center;    user-select: text;"><div class="svgnehhon" style="background-repeat: no-repeat;height:342px;background-position: center;"></div>\nFully programmed by Donov from <a href="https://nehhon.com" target="_blank">nehhon</a><p>\n<a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=ABHGGGQ4TZFA2&source=url" target="_blank"><img src="/nehhon/donate.gif" /></a><p>\nContact:</p>\n<a href=\'mailto:webmaster@nehhon.com\' target="_blank">webmaster@nehhon.com</a> <br> <a href="https://twitter.com/TzaredGame" target="_blank">@TzaredGame</a>\n<p>Graphics, sound and game concept (Tzar) by Haemimont</p>\n<hr>\n<p>Special thanks to:</p>\n<img style="max-width:422px" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgODc0LjMgMzkzLjciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDg3NC4zIDM5My43OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHN0eWxlIHR5cGU9InRleHQvY3NzIj4uc3Qwe2ZpbGw6I0ZGRkZGRjt9LnN0MXtmaWxsOiNGMzgwMjA7fS5zdDJ7ZmlsbDojRkFBRTQwO308L3N0eWxlPjxnPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik03OTAuNiwyNzEuOWMtMy40LDAtNi4xLTIuNy02LjEtNi4xYzAtMy4zLDIuNy02LjEsNi4xLTYuMWMzLjMsMCw2LjEsMi43LDYuMSw2LjFDNzk2LjcsMjY5LjEsNzkzLjksMjcxLjksNzkwLjYsMjcxLjkgTTc5MC42LDI2MC45Yy0yLjcsMC00LjksMi4yLTQuOSw0LjljMCwyLjcsMi4yLDQuOSw0LjksNC45YzIuNywwLDQuOS0yLjIsNC45LTQuOUM3OTUuNSwyNjMuMSw3OTMuMywyNjAuOSw3OTAuNiwyNjAuOSBNNzkzLjcsMjY5aC0xLjRsLTEuMi0yLjNoLTEuNnYyLjNoLTEuM3YtNi43aDMuMmMxLjQsMCwyLjMsMC45LDIuMywyLjJjMCwxLTAuNiwxLjctMS40LDJMNzkzLjcsMjY5eiBNNzkxLjMsMjY1LjVjMC41LDAsMS0wLjMsMS0xYzAtMC44LTAuNC0xLTEtMWgtMnYyTDc5MS4zLDI2NS41TDc5MS4zLDI2NS41eiIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iMTU1LjEsMjU5LjEgMTcwLjcsMjU5LjEgMTcwLjcsMzAxLjYgMTk3LjgsMzAxLjYgMTk3LjgsMzE1LjIgMTU1LjEsMzE1LjIgIi8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTIxMy45LDI4Ny4zdi0wLjJjMC0xNi4xLDEzLTI5LjIsMzAuMy0yOS4yczMwLjEsMTIuOSwzMC4xLDI5djAuMmMwLDE2LjEtMTMsMjkuMi0zMC4zLDI5LjJDMjI2LjcsMzE2LjMsMjEzLjksMzAzLjQsMjEzLjksMjg3LjMgTTI1OC41LDI4Ny4zdi0wLjJjMC04LjEtNS44LTE1LjEtMTQuNC0xNS4xYy04LjUsMC0xNC4yLDYuOS0xNC4yLDE1djAuMmMwLDguMSw1LjgsMTUuMSwxNC4zLDE1LjFDMjUyLjgsMzAyLjMsMjU4LjUsMjk1LjQsMjU4LjUsMjg3LjMiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjkzLjQsMjkwLjZ2LTMxLjVoMTUuOHYzMS4yYzAsOC4xLDQuMSwxMS45LDEwLjMsMTEuOXMxMC4zLTMuNywxMC4zLTExLjV2LTMxLjZoMTUuOHYzMS4xYzAsMTguMS0xMC4zLDI2LTI2LjMsMjZDMzAzLjQsMzE2LjIsMjkzLjQsMzA4LjIsMjkzLjQsMjkwLjYiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzY5LjQsMjU5LjFIMzkxYzIwLDAsMzEuNywxMS41LDMxLjcsMjcuN3YwLjJjMCwxNi4yLTExLjgsMjguMi0zMiwyOC4yaC0yMS4zTDM2OS40LDI1OS4xTDM2OS40LDI1OS4xeiBNMzkxLjMsMzAxLjRjOS4zLDAsMTUuNS01LjEsMTUuNS0xNC4ydi0wLjJjMC05LTYuMi0xNC4yLTE1LjUtMTQuMkgzODV2MjguNUgzOTEuM3oiLz48cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjQ0NS4zLDI1OS4xIDQ5MC4yLDI1OS4xIDQ5MC4yLDI3Mi43IDQ2MC44LDI3Mi43IDQ2MC44LDI4Mi4zIDQ4Ny40LDI4Mi4zIDQ4Ny40LDI5NS4yIDQ2MC44LDI5NS4yIDQ2MC44LDMxNS4yIDQ0NS4zLDMxNS4yICIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNTExLjgsMjU5LjEgNTI3LjMsMjU5LjEgNTI3LjMsMzAxLjYgNTU0LjUsMzAxLjYgNTU0LjUsMzE1LjIgNTExLjgsMzE1LjIgIi8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTU5NS4xLDI1OC43aDE1bDIzLjksNTYuNWgtMTYuN2wtNC4xLTEwaC0yMS42bC00LDEwaC0xNi4zTDU5NS4xLDI1OC43eiBNNjA4LjgsMjkzLjFsLTYuMi0xNS45bC02LjMsMTUuOUg2MDguOHoiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNNjU0LDI1OS4xaDI2LjVjOC42LDAsMTQuNSwyLjIsMTguMyw2LjFjMy4zLDMuMiw1LDcuNSw1LDEzLjF2MC4yYzAsOC42LTQuNiwxNC4zLTExLjUsMTcuMmwxMy40LDE5LjZoLTE4bC0xMS4zLTE3aC02Ljh2MTdINjU0TDY1NCwyNTkuMUw2NTQsMjU5LjF6IE02NzkuOCwyODZjNS4zLDAsOC4zLTIuNiw4LjMtNi42di0wLjJjMC00LjQtMy4yLTYuNi04LjQtNi42aC0xMC4yVjI4Nkw2NzkuOCwyODZMNjc5LjgsMjg2eiIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNzI2LjIsMjU5LjEgNzcxLjMsMjU5LjEgNzcxLjMsMjcyLjMgNzQxLjYsMjcyLjMgNzQxLjYsMjgwLjggNzY4LjUsMjgwLjggNzY4LjUsMjkzLjEgNzQxLjYsMjkzLjEgNzQxLjYsMzAyIDc3MS43LDMwMiA3NzEuNywzMTUuMiA3MjYuMiwzMTUuMiAiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTIxLjEsMjkzLjljLTIuMiw0LjktNi44LDguNC0xMi44LDguNGMtOC41LDAtMTQuMy03LjEtMTQuMy0xNS4xVjI4N2MwLTguMSw1LjctMTUsMTQuMi0xNWM2LjQsMCwxMS4zLDMuOSwxMy4zLDkuM2gxNi40Yy0yLjYtMTMuNC0xNC40LTIzLjMtMjkuNi0yMy4zYy0xNy4zLDAtMzAuMywxMy4xLTMwLjMsMjkuMnYwLjJjMCwxNi4xLDEyLjgsMjksMzAuMSwyOWMxNC44LDAsMjYuNC05LjYsMjkuNC0yMi40TDEyMS4xLDI5My45TDEyMS4xLDI5My45eiIvPjxnPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNzUyLjksMTY5LjYgNzEwLDE0NSA3MDIuNiwxNDEuOCA1MjcuMSwxNDMgNTI3LjEsMjMyLjEgNzUyLjksMjMyLjEgIi8+PHBhdGggY2xhc3M9InN0MSIgZD0iTTY3NC44LDIyMy45YzIuMS03LjIsMS4zLTEzLjgtMi4yLTE4LjdjLTMuMi00LjUtOC42LTcuMS0xNS4xLTcuNGwtMTIzLjEtMS42Yy0wLjgsMC0xLjUtMC40LTEuOS0xYy0wLjQtMC42LTAuNS0xLjQtMC4zLTIuMmMwLjQtMS4yLDEuNi0yLjEsMi45LTIuMmwxMjQuMi0xLjZjMTQuNy0wLjcsMzAuNy0xMi42LDM2LjMtMjcuMmw3LjEtMTguNWMwLjMtMC44LDAuNC0xLjYsMC4yLTIuNGMtOC0zNi4yLTQwLjMtNjMuMi03OC45LTYzLjJjLTM1LjYsMC02NS44LDIzLTc2LjYsNTQuOWMtNy01LjItMTUuOS04LTI1LjUtNy4xYy0xNy4xLDEuNy0zMC44LDE1LjQtMzIuNSwzMi41Yy0wLjQsNC40LTAuMSw4LjcsMC45LDEyLjdjLTI3LjksMC44LTUwLjIsMjMuNi01MC4yLDUxLjdjMCwyLjUsMC4yLDUsMC41LDcuNWMwLjIsMS4yLDEuMiwyLjEsMi40LDIuMWwyMjcuMiwwYzEuMywwLDIuNS0wLjksMi45LTIuMkw2NzQuOCwyMjMuOXoiLz48cGF0aCBjbGFzcz0ic3QyIiBkPSJNNzE0LDE0NC44Yy0xLjEsMC0yLjMsMC0zLjQsMC4xYy0wLjgsMC0xLjUsMC42LTEuOCwxLjRsLTQuOCwxNi43Yy0yLjEsNy4yLTEuMywxMy44LDIuMiwxOC43YzMuMiw0LjUsOC42LDcuMSwxNS4xLDcuNGwyNi4yLDEuNmMwLjgsMCwxLjUsMC40LDEuOSwxYzAuNCwwLjYsMC41LDEuNSwwLjMsMi4yYy0wLjQsMS4yLTEuNiwyLjEtMi45LDIuMmwtMjcuMywxLjZjLTE0LjgsMC43LTMwLjcsMTIuNi0zNi4zLDI3LjJsLTIsNS4xYy0wLjQsMSwwLjMsMiwxLjQsMmg5My44YzEuMSwwLDIuMS0wLjcsMi40LTEuOGMxLjYtNS44LDIuNS0xMS45LDIuNS0xOC4yQzc4MS4zLDE3NSw3NTEuMSwxNDQuOCw3MTQsMTQ0LjgiLz48L2c+PC9nPjwvc3ZnPg==" alt="cloudflare">\n</div>');
ka("returnmenu")}};p("about").onclick=function(){location.hash="About"};p("discord").onclick=function(){window.open("https://discord.gg/ndxJHxT","_blank")};p("mult0").onclick=function(){location.hash="Multiplayer"};p("rnd0").onclick=function(){location.hash="RandomMap"};p("load0").onclick=function(){location.hash="CustomMap"};p("editor0").onclick=function(){location.hash="MapEditor"};p("settings0").onclick=function(){location.hash="Settings"};qi();var jb=[Xb,rf,Dc,Bc,Ud,ff,Bf,vf,kf,hf,qf,Df,xf,Oj,
Ff,mf,of,zf,Xd,gj,Oc,cj,$g,Vi,$i,Mj,bf,Sj,Uj,Zc,zh,Vj,Wj,Xj,Yj,bf,Vk,Ij,Zj,Ld,Jj,Se,Fj,Gj,ph,af,Rd,mb,oh,Cc,Bc,$e,Dc,Jb,Wc,Yc,V,function(b,e){e=D[e];var c=e.nu.id;I[b.kingdom].technology.hidden[e.id.id]=0;Vb(b,e,c);Ck.actv[e.id.id]&&W(!1)},Ue,Ve,Pa,wj,Ua,mh,nh,Id,Th,mk,Rj,vh,wf,Nj,Kj,function(b,e){}];(function(){for(var b=0,e=jb.length;b<e;b++)jb[b].url=b})();gj.rule="moving";af.rule="attack"})();
