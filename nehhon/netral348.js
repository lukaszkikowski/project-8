var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(m){var z=0;return function(){return z<m.length?{done:!1,value:m[z++]}:{done:!0}}};$jscomp.arrayIterator=function(m){return{next:$jscomp.arrayIteratorImpl(m)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(m,z,y){m!=Array.prototype&&m!=Object.prototype&&(m[z]=y.value)};$jscomp.getGlobal=function(m){return"undefined"!=typeof window&&window===m?m:"undefined"!=typeof global&&null!=global?global:m};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(m,z){this.$jscomp$symbol$id_=m;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:z})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function m(y){if(this instanceof m)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(y||"")+"_"+z++,y)}var z=0;return m}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var m=$jscomp.global.Symbol.iterator;m||(m=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[m]&&$jscomp.defineProperty(Array.prototype,m,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var m=$jscomp.global.Symbol.asyncIterator;m||(m=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(m){$jscomp.initSymbolIterator();m={next:m};m[$jscomp.global.Symbol.iterator]=function(){return this};return m};
$jscomp.iteratorFromArray=function(m,z){$jscomp.initSymbolIterator();m instanceof String&&(m+="");var y=0,E={next:function(){if(y<m.length){var v=y++;return{value:z(v,m[v]),done:!1}}E.next=function(){return{done:!0,value:void 0}};return E.next()}};E[Symbol.iterator]=function(){return E};return E};
$jscomp.polyfill=function(m,z,y,E){if(z){y=$jscomp.global;m=m.split(".");for(E=0;E<m.length-1;E++){var v=m[E];v in y||(y[v]={});y=y[v]}m=m[m.length-1];E=y[m];z=z(E);z!=E&&null!=z&&$jscomp.defineProperty(y,m,{configurable:!0,writable:!0,value:z})}};$jscomp.polyfill("Array.prototype.keys",function(m){return m?m:function(){return $jscomp.iteratorFromArray(this,function(m){return m})}},"es6","es3");$jscomp.polyfill("Object.getOwnPropertySymbols",function(m){return m?m:function(){return[]}},"es6","es5");
$jscomp.findInternal=function(m,z,y){m instanceof String&&(m=String(m));for(var E=m.length,v=0;v<E;v++){var ka=m[v];if(z.call(y,ka,v,m))return{i:v,v:ka}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(m){return m?m:function(m,y){return $jscomp.findInternal(this,m,y).v}},"es6","es3");$jscomp.polyfill("Math.sign",function(m){return m?m:function(m){m=Number(m);return 0===m||isNaN(m)?m:0<m?1:-1}},"es6","es3");
$jscomp.owns=function(m,z){return Object.prototype.hasOwnProperty.call(m,z)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(m,z){for(var y=1;y<arguments.length;y++){var E=arguments[y];if(E)for(var v in E)$jscomp.owns(E,v)&&(m[v]=E[v])}return m};$jscomp.polyfill("Object.assign",function(m){return m||$jscomp.assign},"es6","es3");$jscomp.makeIterator=function(m){var z="undefined"!=typeof Symbol&&Symbol.iterator&&m[Symbol.iterator];return z?z.call(m):$jscomp.arrayIterator(m)};
$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(m){function z(){this.batch_=null}function y(m){return m instanceof v?m:new v(function(R,v){R(m)})}if(m&&!$jscomp.FORCE_POLYFILL_PROMISE)return m;z.prototype.asyncExecute=function(m){if(null==this.batch_){this.batch_=[];var R=this;this.asyncExecuteFunction(function(){R.executeBatch_()})}this.batch_.push(m)};var E=$jscomp.global.setTimeout;z.prototype.asyncExecuteFunction=function(m){E(m,0)};z.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var m=
this.batch_;this.batch_=[];for(var v=0;v<m.length;++v){var z=m[v];m[v]=null;try{z()}catch(sa){this.asyncThrow_(sa)}}}this.batch_=null};z.prototype.asyncThrow_=function(m){this.asyncExecuteFunction(function(){throw m;})};var v=function(m){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var v=this.createResolveAndReject_();try{m(v.resolve,v.reject)}catch(sb){v.reject(sb)}};v.prototype.createResolveAndReject_=function(){function m(m){return function(R){z||(z=!0,m.call(v,R))}}var v=this,
z=!1;return{resolve:m(this.resolveTo_),reject:m(this.reject_)}};v.prototype.resolveTo_=function(m){if(m===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(m instanceof v)this.settleSameAsPromise_(m);else{a:switch(typeof m){case "object":var R=null!=m;break a;case "function":R=!0;break a;default:R=!1}R?this.resolveToNonPromiseObj_(m):this.fulfill_(m)}};v.prototype.resolveToNonPromiseObj_=function(m){var v=void 0;try{v=m.then}catch(sb){this.reject_(sb);return}"function"==
typeof v?this.settleSameAsThenable_(v,m):this.fulfill_(m)};v.prototype.reject_=function(m){this.settle_(2,m)};v.prototype.fulfill_=function(m){this.settle_(1,m)};v.prototype.settle_=function(m,v){if(0!=this.state_)throw Error("Cannot settle("+m+", "+v+"): Promise already settled in state"+this.state_);this.state_=m;this.result_=v;this.executeOnSettledCallbacks_()};v.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var m=0;m<this.onSettledCallbacks_.length;++m)ka.asyncExecute(this.onSettledCallbacks_[m]);
this.onSettledCallbacks_=null}};var ka=new z;v.prototype.settleSameAsPromise_=function(m){var v=this.createResolveAndReject_();m.callWhenSettled_(v.resolve,v.reject)};v.prototype.settleSameAsThenable_=function(m,v){var z=this.createResolveAndReject_();try{m.call(v,z.resolve,z.reject)}catch(sa){z.reject(sa)}};v.prototype.then=function(m,z){function y(m,v){return"function"==typeof m?function(v){try{E(m(v))}catch(Qb){R(Qb)}}:v}var E,R,Pb=new v(function(m,v){E=m;R=v});this.callWhenSettled_(y(m,E),y(z,
R));return Pb};v.prototype.catch=function(m){return this.then(void 0,m)};v.prototype.callWhenSettled_=function(m,v){function z(){switch(y.state_){case 1:m(y.result_);break;case 2:v(y.result_);break;default:throw Error("Unexpected state: "+y.state_);}}var y=this;null==this.onSettledCallbacks_?ka.asyncExecute(z):this.onSettledCallbacks_.push(z)};v.resolve=y;v.reject=function(m){return new v(function(v,z){z(m)})};v.race=function(m){return new v(function(v,z){for(var E=$jscomp.makeIterator(m),R=E.next();!R.done;R=
E.next())y(R.value).callWhenSettled_(v,z)})};v.all=function(m){var z=$jscomp.makeIterator(m),E=z.next();return E.done?y([]):new v(function(m,v){function R(v){return function(z){ka[v]=z;sa--;0==sa&&m(ka)}}var ka=[],sa=0;do ka.push(void 0),sa++,y(E.value).callWhenSettled_(R(ka.length-1),v),E=z.next();while(!E.done)})};return v},"es6","es3");
(function(){function m(r,a,e){this.context=r;this.urlList=a;this.onload=e;this.loadCount=0}function z(r,a,e){a=a.split(".")[0].toLowerCase();Rb[a]=r;!e||e.music&&e.mid!==W.id||(Ma(a,e.x,e.y,e.k,e.music,e.date),e.date=0)}function y(){g("playingMenu")||Sb("playingMenu");if(""==g("playingMenu").innerHTML){var r="";"true"===localStorage.nightcycle&&(r="checked");g("playingMenu").innerHTML='<div>\n<ul>\n<li id="backToGame">'+l.MENU_BACK+'</li>\n<li id="saveGame">'+l.ENDGAMEDLG_SAVE+'</li>\n<li id="fullscreenmenu">'+
l.FULLSCREEN+'</li>\n<li id="quitButton1">'+l.MENU_QUIT+"</li>\n</ul>\n<table>\n<tr><td>"+l.ZOOMSPEED+' </td><td><input type="range" id="zoomRange" value="'+localStorage.zoomMult+'"/></td></tr>\n<tr><td>'+l.OPTIONS_T_SS+' </td><td><input type="range" id="scrollRange" value="'+localStorage.scrollSpeed+'"/></td></tr>\n<tr><td>'+l.MP_SETUPMAP_T_DAY+' </td><td><label class="container"><input id="daynightvalue" type="checkbox" '+r+'><span class="checkmark"></span></label></td>\n</table>\n<div>\n<span>'+
l.OPTIONS_T_MV+'</span><br/><input type="range" id="musicRange" value="'+localStorage.musicRange+'"/><br/><br/>\n<form id="musicSelect">\n<input type="radio" name="mversion" value="originalMusic" checked /> Original<br/>\n<input type="radio" name="mversion" value="sharpRain" /> Original - <a href="https://www.youtube.com/user/rainheart666787/featured" target="_blank" rel="noopener noreferrer">Sharp Rain</a> Version<br/>\n<input type="radio" name="mversion" value="originalMusic1" /> Original - Alternative One<br/>\n<input type="radio" name="mversion" value="mute" /> Mute\n</form>\n<br />\n<span>'+
l.OPTIONS_T_SVOL+'</span><br/><input type="range" id="soundRange" value="'+localStorage.soundRange+'"/><br/>\n</div>\n</div>\n';g("quitButton1").onclick=E;g("saveGame").onclick=lf;g("backToGame").onclick=function(){A("playingMenu");ha()};g("daynightvalue").onchange=function(){localStorage.nightcycle=this.checked};g("fullscreenmenu").onclick=Dd;g("musicRange").oninput=function(){ub.gain.value=parseInt(g("musicRange").value)/100;localStorage.musicRange=g("musicRange").value};g("zoomRange").oninput=
function(){localStorage.zoomMult=g("zoomRange").value};g("scrollRange").oninput=function(){localStorage.scrollSpeed=g("scrollRange").value};g("soundRange").oninput=function(){vb.gain.value=parseInt(g("soundRange").value)/100;localStorage.soundRange=g("soundRange").value};localStorage.favMusic&&(g("musicSelect").mversion.value=localStorage.favMusic);r=g("musicSelect").getElementsByTagName("input");for(var a=0,e=r.length;a<e;a++)r[a].onchange=W.reset}p.demo&&A("saveGame")||H("saveGame");g("playingMenu").style.display=
"block";Qa()}function E(){location.href=""}function v(r){B("setup:",r);r.toSend=[];r.orderList=[];var a=Z.roomName;a=a.substr(0,a.length-1);r.id==a&&(r.admin=!0);r.superID=Ed(r.id);r.sendDirectly("channelMessage","nehhof",{});B(r.channels.channelMessage);r.channels.channelMessage.onopen=function(){la.put(r);Ma("attack");Fc(1);B("DATACHANNEL OPEN");setTimeout(function(){B(r);t.admin?(Ra(q.onlADD(0,0,Tb(),r.superID,0),17,"connecting..."),q.onlineKingdoms(),bb()):r.admin&&(Ra(q.mnameadd(),17,t.name),
q.shareName(r.superID))},500)};r.channels.channelMessage.onerror=function(a){B(a)}}function ka(){g("buttons").innerHTML="";g("gameName").innerHTML=""}function R(){""==g("Multiplayer").innerHTML&&(g("Multiplayer").innerHTML="<h2>"+l.MAINSCR_MULTI.split("|")[0]+'</h2>\n<button id="createbutton">'+l.MP_SEARCH_CREATE.split("| ")[1]+'</button>\n<button id="refreshButton1" class="refreshButton">'+l.GENERAL_REFRESH+'</button>\n<table id="gameList">\n<tbody>\n<tr><td></td></tr>\n</tbody>\n</table>',g("refreshButton1").onclick=
R,g("createbutton").onclick=Fd);t.p2p?(ha(),t.p2p.emit("getRooms"),g("returnmenu").style.display="block"):(Z||pa(),pa.func=R)}function Pb(){var r=location,a=r.hash.substr(1);""===a&&(g("returnmenu").style.display="none");if("Room"===r.hash.substr(-4))Gc?Gd():Ub=Gd;else if(Hc[a])if(Gc)Hc[a]();else Ub=Hc[a];else r.hash=""}function sb(r){return f.locateFile?f.locateFile(r,Da):Da+r}function sa(r,a){r||ta("Assertion failed: "+a)}function Ad(r,a,e){var b=a+e;for(e=a;r[e]&&!(e>=b);)++e;if(16<e-a&&r.subarray&&
Hd)return Hd.decode(r.subarray(a,e));for(b="";a<e;){var d=r[a++];if(d&128){var h=r[a++]&63;if(192==(d&224))b+=String.fromCharCode((d&31)<<6|h);else{var k=r[a++]&63;d=224==(d&240)?(d&15)<<12|h<<6|k:(d&7)<<18|h<<12|k<<6|r[a++]&63;65536>d?b+=String.fromCharCode(d):(d-=65536,b+=String.fromCharCode(55296|d>>10,56320|d&1023))}}else b+=String.fromCharCode(d)}return b}function Cd(r){for(var a=0,e=0;e<r.length;++e){var b=r.charCodeAt(e);55296<=b&&57343>=b&&(b=65536+((b&1023)<<10)|r.charCodeAt(++e)&1023);127>=
b?++a:a=2047>=b?a+2:65535>=b?a+3:a+4}var d=a+1;a=Id(d);e=Ic;b=a;if(0<d){d=b+d-1;for(var h=0;h<r.length;++h){var k=r.charCodeAt(h);if(55296<=k&&57343>=k){var c=r.charCodeAt(++h);k=65536+((k&1023)<<10)|c&1023}if(127>=k){if(b>=d)break;e[b++]=k}else{if(2047>=k){if(b+1>=d)break;e[b++]=192|k>>6}else{if(65535>=k){if(b+2>=d)break;e[b++]=224|k>>12}else{if(b+3>=d)break;e[b++]=240|k>>18;e[b++]=128|k>>12&63}e[b++]=128|k>>6&63}e[b++]=128|k&63}}e[b]=0}return a}function Ec(r,a){0<r%a&&(r+=a-r%a);return r}function Bd(){f.HEAP8=
Ic=new Int8Array(ma);f.HEAP16=new Int16Array(ma);f.HEAP32=ca=new Int32Array(ma);f.HEAPU8=cb=new Uint8Array(ma);f.HEAPU16=new Uint16Array(ma);f.HEAPU32=new Uint32Array(ma);f.HEAPF32=new Float32Array(ma);f.HEAPF64=new Float64Array(ma)}function tb(r){for(;0<r.length;){var a=r.shift();if("function"==typeof a)a();else{var e=a.func;"number"===typeof e?void 0===a.arg?f.dynCall_v(e):f.dynCall_vi(e,a.arg):e(void 0===a.arg?null:a.arg)}}}function Qb(r){return String.prototype.startsWith?r.startsWith("data:application/octet-stream;base64,"):
0===r.indexOf("data:application/octet-stream;base64,")}function Jd(){try{if(f.wasmBinary)return new Uint8Array(f.wasmBinary);if(f.readBinary)return f.readBinary(Na);throw"both async and sync fetching of the wasm failed";}catch(r){ta(r)}}function mf(){return f.wasmBinary||!wb&&!Sa||"function"!==typeof fetch?new Promise(function(r,a){r(Jd())}):fetch(Na,{credentials:"same-origin"}).then(function(r){if(!r.ok)throw"failed to load wasm binary file at '"+Na+"'";return r.arrayBuffer()}).catch(function(){return Jd()})}
function nf(r){function a(a,r){f.asm=a.exports;Ta--;f.monitorRunDependencies&&f.monitorRunDependencies(Ta);0==Ta&&(null!==Jc&&(clearInterval(Jc),Jc=null),xb&&(a=xb,xb=null,a()))}function e(r){a(r.instance)}function b(a){mf().then(function(a){return WebAssembly.instantiate(a,d)}).then(a,function(a){Ea("failed to asynchronously prepare wasm: "+a);ta(a)})}var d={env:r,global:{NaN:NaN,Infinity:Infinity},"global.Math":Math,asm2wasm:of};Ta++;f.monitorRunDependencies&&f.monitorRunDependencies(Ta);if(f.instantiateWasm)try{return f.instantiateWasm(d,
a)}catch(h){return Ea("Module.instantiateWasm callback failed with error: "+h),!1}f.wasmBinary||"function"!==typeof WebAssembly.instantiateStreaming||Qb(Na)||"function"!==typeof fetch?b(e):WebAssembly.instantiateStreaming(fetch(Na,{credentials:"same-origin"}),d).then(e,function(a){Ea("wasm streaming compile failed: "+a);Ea("falling back to ArrayBuffer instantiation");b(e)});return{}}function Kd(){return!!Kd.uncaught_exception}function Ld(r){try{return pf(r)}catch(a){}}function yb(){var r=ua.last;
if(!r)return db=0;var a=ua.infos[r],e=a.type;if(!e)return db=0,r|0;var b=Array.prototype.slice.call(arguments);f.___cxa_is_pointer_type(e);yb.buffer||(yb.buffer=qf(4));ca[yb.buffer>>2]=r;r=yb.buffer;for(var d=0;d<b.length;d++)if(b[d]&&f.___cxa_can_catch(b[d],e,r))return r=ca[r>>2],a.adjusted.push(r),db=b[d],r|0;r=ca[r>>2];db=e;return r|0}function Md(){return Ic.length}function Nd(){ta()}function Od(r){r=Ec(r,65536);var a=ma.byteLength;try{return-1!==Vb.grow((r-a)/65536)?(ma=Vb.buffer,!0):!1}catch(e){return!1}}
function eb(r){this.name="ExitStatus";this.message="Program terminated with exit("+r+")";this.status=r}function Kc(r){function a(){if(!f.calledRun&&(f.calledRun=!0,!Lc)){Wb||(Wb=!0,tb(Mc));tb(rf);if(f.onRuntimeInitialized)f.onRuntimeInitialized();f._main&&Pd&&f.callMain(r);if(f.postRun)for("function"==typeof f.postRun&&(f.postRun=[f.postRun]);f.postRun.length;)Qd.unshift(f.postRun.shift());tb(Qd)}}r=r||f.arguments;if(!(0<Ta)){if(f.preRun)for("function"==typeof f.preRun&&(f.preRun=[f.preRun]);f.preRun.length;)Rd.unshift(f.preRun.shift());
tb(Rd);0<Ta||f.calledRun||(f.setStatus?(f.setStatus("Running..."),setTimeout(function(){setTimeout(function(){f.setStatus("")},1);a()},1)):a())}}function ta(r){if(f.onAbort)f.onAbort(r);void 0!==r?(Nc(r),Ea(r),r=JSON.stringify(r)):r="";Lc=!0;throw"abort("+r+"). Build with -s ASSERTIONS=1 for more info.";}var vf=function(){(function(r){"object"===typeof exports&&"undefined"!==typeof module?module.exports=r():"function"===typeof define&&define.amd?define([],r):("undefined"!==typeof window?window:"undefined"!==
typeof global?global:"undefined"!==typeof self?self:this).SimpleWebRTC=r()})(function(){return function d(a,e,b){function h(n,c){if(!e[n]){if(!a[n]){var u="function"==typeof require&&require;if(!c&&u)return u(n,!0);if(k)return k(n,!0);c=Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c;}c=e[n]={exports:{}};a[n][0].call(c.exports,function(b){var d=a[n][1][b];return h(d?d:b)},c,c.exports,d,a,e,b)}return e[n].exports}for(var k="function"==typeof require&&require,c=0;c<b.length;c++)h(b[c]);
return h}({1:[function(a,e,b){function d(){}e.exports=function(a,b,e){function h(a,d){if(0>=h.count)throw Error("after called too many times");--h.count;a?(k=!0,b(a),b=e):0!==h.count||k||b(null,d)}var k=!1;e=e||d;h.count=a;return 0===a?b():h}},{}],2:[function(a,e,b){e.exports=function(a,b,e){var d=a.byteLength;b=b||0;e=e||d;if(a.slice)return a.slice(b,e);0>b&&(b+=d);0>e&&(e+=d);e>d&&(e=d);if(b>=d||b>=e||0===d)return new ArrayBuffer(0);a=new Uint8Array(a);d=new Uint8Array(e-b);for(var h=0;b<e;b++,
h++)d[h]=a[b];return d.buffer}},{}],3:[function(a,e,b){e.exports=function(a,b,e){var d,h=b;b={autoplay:!0,mirror:!1,muted:!1,audio:!1,disableContextMenu:!1};if(e)for(d in e)b[d]=e[d];h?"audio"===h.tagName.toLowerCase()&&(b.audio=!0):h=document.createElement(b.audio?"audio":"video");b.disableContextMenu&&(h.oncontextmenu=function(a){a.preventDefault()});b.autoplay&&(h.autoplay="autoplay");b.muted&&(h.muted=!0);!b.audio&&b.mirror&&["","moz","webkit","o","ms"].forEach(function(a){h.style[a?a+"Transform":
"transform"]="scaleX(-1)"});h.srcObject=a;return h}},{}],4:[function(a,e,b){function d(a){a=a||{};this.ms=a.min||100;this.max=a.max||1E4;this.factor=a.factor||2;this.jitter=0<a.jitter&&1>=a.jitter?a.jitter:0;this.attempts=0}e.exports=d;d.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),d=Math.floor(b*this.jitter*a);a=0==(Math.floor(10*b)&1)?a-d:a+d}return Math.min(a,this.max)|0};d.prototype.reset=function(){this.attempts=0};d.prototype.setMin=
function(a){this.ms=a};d.prototype.setMax=function(a){this.max=a};d.prototype.setJitter=function(a){this.jitter=a}},{}],5:[function(a,e,b){(function(a){b.encode=function(b){b=new Uint8Array(b);var d,e=b.length,h="";for(d=0;d<e;d+=3)h+=a[b[d]>>2],h+=a[(b[d]&3)<<4|b[d+1]>>4],h+=a[(b[d+1]&15)<<2|b[d+2]>>6],h+=a[b[d+2]&63];2===e%3?h=h.substring(0,h.length-1)+"=":1===e%3&&(h=h.substring(0,h.length-2)+"==");return h};b.decode=function(b){var d=.75*b.length,e=b.length,h=0;"="===b[b.length-1]&&(d--,"="===
b[b.length-2]&&d--);var c=new ArrayBuffer(d),u=new Uint8Array(c);for(d=0;d<e;d+=4){var x=a.indexOf(b[d]);var f=a.indexOf(b[d+1]);var w=a.indexOf(b[d+2]);var P=a.indexOf(b[d+3]);u[h++]=x<<2|f>>4;u[h++]=(f&15)<<4|w>>2;u[h++]=(w&3)<<6|P&63}return c}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],6:[function(a,e,b){(function(a){function b(a){for(var b=0;b<a.length;b++){var d=a[b];if(d.buffer instanceof ArrayBuffer){var e=d.buffer;if(d.byteLength!==e.byteLength){var h=new Uint8Array(d.byteLength);
h.set(new Uint8Array(e,d.byteOffset,d.byteLength));e=h.buffer}a[b]=e}}}function d(a,d){d=d||{};var e=new n;b(a);for(var h=0;h<a.length;h++)e.append(a[h]);return d.type?e.getBlob(d.type):e.getBlob()}function c(a,d){b(a);return new Blob(a,d||{})}var n=a.BlobBuilder||a.WebKitBlobBuilder||a.MSBlobBuilder||a.MozBlobBuilder;try{var f=2===(new Blob(["hi"])).size}catch(G){f=!1}var u;if(u=f)try{u=2===(new Blob([new Uint8Array([1,2])])).size}catch(G){u=!1}var x=n&&n.prototype.append&&n.prototype.getBlob;a=
f?u?a.Blob:c:x?d:void 0;e.exports=a}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],7:[function(a,e,b){var d=[].slice;e.exports=function(a,b){"string"==typeof b&&(b=a[b]);if("function"!=typeof b)throw Error("bind() requires a function");var e=d.call(arguments,2);return function(){return b.apply(a,e.concat(d.call(arguments)))}}},{}],8:[function(a,e,b){function d(a){if(a){for(var b in d.prototype)a[b]=d.prototype[b];return a}}
e.exports=d;d.prototype.on=d.prototype.addEventListener=function(a,b){this._callbacks=this._callbacks||{};(this._callbacks[a]=this._callbacks[a]||[]).push(b);return this};d.prototype.once=function(a,b){function d(){e.off(a,d);b.apply(this,arguments)}var e=this;this._callbacks=this._callbacks||{};d.fn=b;this.on(a,d);return this};d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(a,b){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks=
{},this;var d=this._callbacks[a];if(!d)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var e,h=0;h<d.length;h++)if(e=d[h],e===b||e.fn===b){d.splice(h,1);break}return this};d.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),d=this._callbacks[a];if(d){d=d.slice(0);for(var e=0,h=d.length;e<h;++e)d[e].apply(this,b)}return this};d.prototype.listeners=function(a){this._callbacks=this._callbacks||{};return this._callbacks[a]||[]};
d.prototype.hasListeners=function(a){return!!this.listeners(a).length}},{}],9:[function(a,e,b){e.exports=function(a,b){var d=function(){};d.prototype=b.prototype;a.prototype=new d;a.prototype.constructor=a}},{}],10:[function(a,e,b){function d(a){return d.enabled(a)?function(b){b instanceof Error&&(b=b.stack||b.message);var e=new Date,h=e-(d[a]||e);d[a]=e;b=a+" "+b+" +"+d.humanize(h);window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}e.exports=d;
d.names=[];d.skips=[];d.enable=function(a){try{localStorage.debug=a}catch(X){}for(var b=(a||"").split(/[\s,]+/),e=b.length,h=0;h<e;h++)a=b[h].replace("*",".*?"),"-"===a[0]?d.skips.push(new RegExp("^"+a.substr(1)+"$")):d.names.push(new RegExp("^"+a+"$"))};d.disable=function(){d.enable("")};d.humanize=function(a){return 36E5<=a?(a/36E5).toFixed(1)+"h":6E4<=a?(a/6E4).toFixed(1)+"m":1E3<=a?(a/1E3|0)+"s":a+"ms"};d.enabled=function(a){for(var b=0,e=d.skips.length;b<e;b++)if(d.skips[b].test(a))return!1;
b=0;for(e=d.names.length;b<e;b++)if(d.names[b].test(a))return!0;return!1};try{window.localStorage&&d.enable(localStorage.debug)}catch(h){}},{}],11:[function(a,e,b){e.exports=a("./lib/")},{"./lib/":12}],12:[function(a,e,b){e.exports=a("./socket");e.exports.parser=a("engine.io-parser")},{"./socket":13,"engine.io-parser":24}],13:[function(a,e,b){(function(b){function d(a,e){if(!(this instanceof d))return new d(a,e);e=e||{};a&&"object"==typeof a&&(e=a,a=null);a&&(a=x(a),e.host=a.host,e.secure="https"==
a.protocol||"wss"==a.protocol,e.port=a.port,a.query&&(e.query=a.query));this.secure=null!=e.secure?e.secure:b.location&&"https:"==location.protocol;e.host&&(a=e.host.split(":"),e.hostname=a.shift(),a.length?e.port=a.pop():e.port||(e.port=this.secure?"443":"80"));this.agent=e.agent||!1;this.hostname=e.hostname||(b.location?location.hostname:"localhost");this.port=e.port||(b.location&&location.port?location.port:this.secure?443:80);this.query=e.query||{};"string"==typeof this.query&&(this.query=w.decode(this.query));
this.upgrade=!1!==e.upgrade;this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!e.forceJSONP;this.jsonp=!1!==e.jsonp;this.forceBase64=!!e.forceBase64;this.enablesXDR=!!e.enablesXDR;this.timestampParam=e.timestampParam||"t";this.timestampRequests=e.timestampRequests;this.transports=e.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.callbackBuffer=[];this.policyPort=e.policyPort||843;this.rememberUpgrade=e.rememberUpgrade||!1;this.binaryType=null;
this.onlyBinaryUpgrades=e.onlyBinaryUpgrades;this.pfx=e.pfx||null;this.key=e.key||null;this.passphrase=e.passphrase||null;this.cert=e.cert||null;this.ca=e.ca||null;this.ciphers=e.ciphers||null;this.rejectUnauthorized=e.rejectUnauthorized||null;this.open()}var k=a("./transports"),c=a("component-emitter"),n=a("debug")("engine.io-client:socket"),f=a("indexof"),u=a("engine.io-parser"),x=a("parseuri"),G=a("parsejson"),w=a("parseqs");e.exports=d;d.priorWebsocketSuccess=!1;c(d.prototype);d.protocol=u.protocol;
d.Socket=d;d.Transport=a("./transport");d.transports=a("./transports");d.parser=a("engine.io-parser");d.prototype.createTransport=function(a){n('creating transport "%s"',a);var b=this.query,d={},e;for(e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);d.EIO=u.protocol;d.transport=a;this.id&&(d.sid=this.id);return new k[a]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:d,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,
timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})};d.prototype.open=function(){if(this.rememberUpgrade&&d.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))var a="websocket";else{if(0==this.transports.length){var b=this;setTimeout(function(){b.emit("error","No transports available")},
0);return}a=this.transports[0]}this.readyState="opening";try{a=this.createTransport(a)}catch(Oc){this.transports.shift();this.open();return}a.open();this.setTransport(a)};d.prototype.setTransport=function(a){n("setting transport %s",a.name);var b=this;this.transport&&(n("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=a;a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",
function(){b.onClose("transport close")})};d.prototype.probe=function(a){function b(){if(C.onlyBinaryUpgrades){var b=!this.supportsBinary&&C.transport.supportsBinary;x=x||b}x||(n('probe transport "%s" opened',a),f.send([{type:"ping",data:"probe"}]),f.once("packet",function(b){x||("pong"==b.type&&"probe"==b.data?(n('probe transport "%s" pong',a),C.upgrading=!0,C.emit("upgrading",f),f&&(d.priorWebsocketSuccess="websocket"==f.name,n('pausing current transport "%s"',C.transport.name),C.transport.pause(function(){x||
"closed"==C.readyState||(n("changing transport and sending upgrade packet"),w(),C.setTransport(f),f.send([{type:"upgrade"}]),C.emit("upgrade",f),f=null,C.upgrading=!1,C.flush())}))):(n('probe transport "%s" failed',a),b=Error("probe error"),b.transport=f.name,C.emit("upgradeError",b)))}))}function e(){x||(x=!0,w(),f.close(),f=null)}function h(b){var d=Error("probe error: "+b);d.transport=f.name;e();n('probe transport "%s" failed because of error: %s',a,b);C.emit("upgradeError",d)}function k(){h("transport closed")}
function c(){h("socket closed")}function u(a){f&&a.name!=f.name&&(n('"%s" works - aborting "%s"',a.name,f.name),e())}function w(){f.removeListener("open",b);f.removeListener("error",h);f.removeListener("close",k);C.removeListener("close",c);C.removeListener("upgrading",u)}n('probing transport "%s"',a);var f=this.createTransport(a,{probe:1}),x=!1,C=this;d.priorWebsocketSuccess=!1;f.once("open",b);f.once("error",h);f.once("close",k);this.once("close",c);this.once("upgrading",u);f.open()};d.prototype.onOpen=
function(){n("socket open");this.readyState="open";d.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){n("starting upgrade probes");for(var a=0,b=this.upgrades.length;a<b;a++)this.probe(this.upgrades[a])}};d.prototype.onPacket=function(a){if("opening"==this.readyState||"open"==this.readyState)switch(n('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),
a.type){case "open":this.onHandshake(G(a.data));break;case "pong":this.setPing();break;case "error":var b=Error("server error");b.code=a.data;this.emit("error",b);break;case "message":this.emit("data",a.data),this.emit("message",a.data)}else n('packet received with socket readyState "%s"',this.readyState)};d.prototype.onHandshake=function(a){this.emit("handshake",a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=this.filterUpgrades(a.upgrades);this.pingInterval=a.pingInterval;this.pingTimeout=
a.pingTimeout;this.onOpen();"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};d.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);var b=this;b.pingTimeoutTimer=setTimeout(function(){if("closed"!=b.readyState)b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)};d.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer);a.pingIntervalTimer=setTimeout(function(){n("writing ping packet - expecting pong within %sms",
a.pingTimeout);a.ping();a.onHeartbeat(a.pingTimeout)},a.pingInterval)};d.prototype.ping=function(){this.sendPacket("ping")};d.prototype.onDrain=function(){for(var a=0;a<this.prevBufferLen;a++)if(this.callbackBuffer[a])this.callbackBuffer[a]();this.writeBuffer.splice(0,this.prevBufferLen);this.callbackBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0==this.writeBuffer.length?this.emit("drain"):this.flush()};d.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&
this.writeBuffer.length&&(n("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};d.prototype.write=d.prototype.send=function(a,b){this.sendPacket("message",a,b);return this};d.prototype.sendPacket=function(a,b,d){"closing"!=this.readyState&&"closed"!=this.readyState&&(a={type:a,data:b},this.emit("packetCreate",a),this.writeBuffer.push(a),this.callbackBuffer.push(d),this.flush())};d.prototype.close=
function(){if("opening"==this.readyState||"open"==this.readyState){var a=function(){e.once("upgrade",b);e.once("upgradeError",b)},b=function(){e.removeListener("upgrade",b);e.removeListener("upgradeError",b);d()},d=function(){e.onClose("forced close");n("socket closing - telling transport to close");e.transport.close()};this.readyState="closing";var e=this;if(this.writeBuffer.length)this.once("drain",function(){this.upgrading?a():d()});else this.upgrading?a():d()}return this};d.prototype.onError=
function(a){n("socket error %j",a);d.priorWebsocketSuccess=!1;this.emit("error",a);this.onClose("transport error",a)};d.prototype.onClose=function(a,b){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){n('socket close with reason: "%s"',a);var d=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);setTimeout(function(){d.writeBuffer=[];d.callbackBuffer=[];d.prevBufferLen=0},0);this.transport.removeAllListeners("close");this.transport.close();
this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",a,b)}};d.prototype.filterUpgrades=function(a){for(var b=[],d=0,e=a.length;d<e;d++)~f(this.transports,a[d])&&b.push(a[d]);return b}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":8,debug:21,"engine.io-parser":24,indexof:32,parsejson:40,parseqs:41,parseuri:23}],14:[function(a,e,b){function d(a){this.path=
a.path;this.hostname=a.hostname;this.port=a.port;this.secure=a.secure;this.query=a.query;this.timestampParam=a.timestampParam;this.timestampRequests=a.timestampRequests;this.readyState="";this.agent=a.agent||!1;this.socket=a.socket;this.enablesXDR=a.enablesXDR;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized}var h=a("engine.io-parser");a=a("component-emitter");e.exports=d;a(d.prototype);d.timestamps=
0;d.prototype.onError=function(a,b){a=Error(a);a.type="TransportError";a.description=b;this.emit("error",a);return this};d.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this};d.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this};d.prototype.send=function(a){if("open"==this.readyState)this.write(a);else throw Error("Transport not open");};d.prototype.onOpen=
function(){this.readyState="open";this.writable=!0;this.emit("open")};d.prototype.onData=function(a){a=h.decodePacket(a,this.socket.binaryType);this.onPacket(a)};d.prototype.onPacket=function(a){this.emit("packet",a)};d.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":8,"engine.io-parser":24}],15:[function(a,e,b){(function(d){var e=a("xmlhttprequest"),c=a("./polling-xhr"),f=a("./polling-jsonp"),n=a("./websocket");b.polling=function(a){var b=!1,h=!1,k=
!1!==a.jsonp;d.location&&(h="https:"==location.protocol,(b=location.port)||(b=h?443:80),b=a.hostname!=location.hostname||b!=a.port,h=a.secure!=h);a.xdomain=b;a.xscheme=h;if("open"in new e(a)&&!a.forceJSONP)return new c(a);if(!k)throw Error("JSONP disabled");return new f(a)};b.websocket=n}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(a,e,
b){(function(b){function d(){}function c(a){f.call(this,a);this.query=this.query||{};x||(b.___eio||(b.___eio=[]),x=b.___eio);this.index=x.length;var e=this;x.push(function(a){e.onData(a)});this.query.j=this.index;b.document&&b.addEventListener&&b.addEventListener("beforeunload",function(){e.script&&(e.script.onerror=d)},!1)}var f=a("./polling"),n=a("component-inherit");e.exports=c;var X=/\n/g,u=/\\n/g,x;n(c,f);c.prototype.supportsBinary=!1;c.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),
this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.iframe=this.form=null);f.prototype.doClose.call(this)};c.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);b.async=!0;b.src=this.uri();b.onerror=function(b){a.onError("jsonp poll error",b)};var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(b,d);this.script=b;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&
setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a);document.body.removeChild(a)},100)};c.prototype.doWrite=function(a,b){function d(){e();b()}function e(){if(h.iframe)try{h.form.removeChild(h.iframe)}catch(zb){h.onError("jsonp polling iframe removal error",zb)}try{f=document.createElement('<iframe src="javascript:0" name="'+h.iframeId+'">')}catch(zb){f=document.createElement("iframe"),f.name=h.iframeId,f.src="javascript:0"}f.id=h.iframeId;h.form.appendChild(f);
h.iframe=f}var h=this;if(!this.form){var c=document.createElement("form"),k=document.createElement("textarea"),n=this.iframeId="eio_iframe_"+this.index,f;c.className="socketio";c.style.position="absolute";c.style.top="-1000px";c.style.left="-1000px";c.target=n;c.method="POST";c.setAttribute("accept-charset","utf-8");k.name="d";c.appendChild(k);document.body.appendChild(c);this.form=c;this.area=k}this.form.action=this.uri();e();a=a.replace(u,"\\\n");this.area.value=a.replace(X,"\\n");try{this.form.submit()}catch(zb){}this.iframe.attachEvent?
this.iframe.onreadystatechange=function(){"complete"==h.iframe.readyState&&d()}:this.iframe.onload=d}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-inherit":9}],17:[function(a,e,b){(function(b){function d(){}function c(a){u.call(this,a);if(b.location){var d="https:"==location.protocol,e=location.port;e||(e=d?443:80);this.xd=a.hostname!=b.location.hostname||e!=a.port;this.xs=a.secure!=d}}function f(a){this.method=
a.method||"GET";this.uri=a.uri;this.xd=!!a.xd;this.xs=!!a.xs;this.async=!1!==a.async;this.data=void 0!=a.data?a.data:null;this.agent=a.agent;this.isBinary=a.isBinary;this.supportsBinary=a.supportsBinary;this.enablesXDR=a.enablesXDR;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.create()}function n(){for(var a in f.requests)f.requests.hasOwnProperty(a)&&f.requests[a].abort()}var X=a("xmlhttprequest"),
u=a("./polling"),x=a("component-emitter"),G=a("component-inherit"),w=a("debug")("engine.io-client:polling-xhr");e.exports=c;e.exports.Request=f;G(c,u);c.prototype.supportsBinary=!0;c.prototype.request=function(a){a=a||{};a.uri=this.uri();a.xd=this.xd;a.xs=this.xs;a.agent=this.agent||!1;a.supportsBinary=this.supportsBinary;a.enablesXDR=this.enablesXDR;a.pfx=this.pfx;a.key=this.key;a.passphrase=this.passphrase;a.cert=this.cert;a.ca=this.ca;a.ciphers=this.ciphers;a.rejectUnauthorized=this.rejectUnauthorized;
return new f(a)};c.prototype.doWrite=function(a,b){a=this.request({method:"POST",data:a,isBinary:"string"!==typeof a&&void 0!==a});var d=this;a.on("success",b);a.on("error",function(a){d.onError("xhr post error",a)});this.sendXhr=a};c.prototype.doPoll=function(){w("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)});a.on("error",function(a){b.onError("xhr poll error",a)});this.pollXhr=a};x(f.prototype);f.prototype.create=function(){var a={agent:this.agent,xdomain:this.xd,
xscheme:this.xs,enablesXDR:this.enablesXDR};a.pfx=this.pfx;a.key=this.key;a.passphrase=this.passphrase;a.cert=this.cert;a.ca=this.ca;a.ciphers=this.ciphers;a.rejectUnauthorized=this.rejectUnauthorized;var d=this.xhr=new X(a),e=this;try{w("xhr open %s: %s",this.method,this.uri);d.open(this.method,this.uri,this.async);this.supportsBinary&&(d.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?d.setRequestHeader("Content-type","application/octet-stream"):d.setRequestHeader("Content-type",
"text/plain;charset=UTF-8")}catch(Pc){}"withCredentials"in d&&(d.withCredentials=!0);this.hasXDR()?(d.onload=function(){e.onLoad()},d.onerror=function(){e.onError(d.responseText)}):d.onreadystatechange=function(){if(4==d.readyState)if(200==d.status||1223==d.status)e.onLoad();else setTimeout(function(){e.onError(d.status)},0)};w("xhr data %s",this.data);d.send(this.data)}catch(Pc){setTimeout(function(){e.onError(Pc)},0);return}b.document&&(this.index=f.requestsCount++,f.requests[this.index]=this)};
f.prototype.onSuccess=function(){this.emit("success");this.cleanup()};f.prototype.onData=function(a){this.emit("data",a);this.onSuccess()};f.prototype.onError=function(a){this.emit("error",a);this.cleanup(!0)};f.prototype.cleanup=function(a){if("undefined"!=typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=this.xhr.onerror=d:this.xhr.onreadystatechange=d;if(a)try{this.xhr.abort()}catch(Aa){}b.document&&delete f.requests[this.index];this.xhr=null}};f.prototype.onLoad=function(){try{try{var a=
this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(Oc){}var b="application/octet-stream"===a?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(Oc){this.onError(Oc)}if(null!=b)this.onData(b)};f.prototype.hasXDR=function(){return"undefined"!==typeof b.XDomainRequest&&!this.xs&&this.enablesXDR};f.prototype.abort=function(){this.cleanup()};b.document&&(f.requestsCount=0,f.requests={},b.attachEvent?b.attachEvent("onunload",n):b.addEventListener&&b.addEventListener("beforeunload",
n,!1))}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-emitter":8,"component-inherit":9,debug:21,xmlhttprequest:20}],18:[function(a,e,b){function d(a){var b=a&&a.forceBase64;if(!X||b)this.supportsBinary=!1;h.call(this,a)}var h=a("../transport"),c=a("parseqs"),f=a("engine.io-parser");b=a("component-inherit");var n=a("debug")("engine.io-client:polling");e.exports=d;var X=null!=(new (a("xmlhttprequest"))({xdomain:!1})).responseType;
b(d,h);d.prototype.name="polling";d.prototype.doOpen=function(){this.poll()};d.prototype.pause=function(a){function b(){n("paused");d.readyState="paused";a()}var d=this;this.readyState="pausing";if(this.polling||!this.writable){var e=0;this.polling&&(n("we are currently polling - waiting to pause"),e++,this.once("pollComplete",function(){n("pre-pause polling complete");--e||b()}));this.writable||(n("we are currently writing - waiting to pause"),e++,this.once("drain",function(){n("pre-pause writing complete");
--e||b()}))}else b()};d.prototype.poll=function(){n("polling");this.polling=!0;this.doPoll();this.emit("poll")};d.prototype.onData=function(a){var b=this;n("polling got data %s",a);f.decodePayload(a,this.socket.binaryType,function(a,d,e){if("opening"==b.readyState)b.onOpen();if("close"==a.type)return b.onClose(),!1;b.onPacket(a)});"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():n('ignoring poll - transport state "%s"',this.readyState))};d.prototype.doClose=
function(){function a(){n("writing close packet");b.write([{type:"close"}])}var b=this;"open"==this.readyState?(n("transport open - closing"),a()):(n("transport not open - deferring close"),this.once("open",a))};d.prototype.write=function(a){var b=this;this.writable=!1;var d=function(){b.writable=!0;b.emit("drain")};b=this;f.encodePayload(a,this.supportsBinary,function(a){b.doWrite(a,d)})};d.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",d="";!1!==this.timestampRequests&&
(a[this.timestampParam]=+new Date+"-"+h.timestamps++);this.supportsBinary||a.sid||(a.b64=1);a=c.encode(a);this.port&&("https"==b&&443!=this.port||"http"==b&&80!=this.port)&&(d=":"+this.port);a.length&&(a="?"+a);return b+"://"+this.hostname+d+this.path+a}},{"../transport":14,"component-inherit":9,debug:21,"engine.io-parser":24,parseqs:41,xmlhttprequest:20}],19:[function(a,e,b){function d(a){a&&a.forceBase64&&(this.supportsBinary=!1);h.call(this,a)}var h=a("../transport"),c=a("engine.io-parser"),f=
a("parseqs");b=a("component-inherit");var n=a("debug")("engine.io-client:websocket"),X=a("ws");e.exports=d;b(d,h);d.prototype.name="websocket";d.prototype.supportsBinary=!0;d.prototype.doOpen=function(){if(this.check()){var a=this.uri(),b={agent:this.agent};b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;this.ws=new X(a,void 0,b);void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.binaryType=
"arraybuffer";this.addEventListeners()}};d.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()};this.ws.onclose=function(){a.onClose()};this.ws.onmessage=function(b){a.onData(b.data)};this.ws.onerror=function(b){a.onError("websocket error",b)}};"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(d.prototype.onData=function(a){var b=this;setTimeout(function(){h.prototype.onData.call(b,a)},0)});d.prototype.write=function(a){var b=this;this.writable=
!1;for(var d=0,e=a.length;d<e;d++)c.encodePacket(a[d],this.supportsBinary,function(a){try{b.ws.send(a)}catch(Aa){n("websocket closed before onclose event")}});setTimeout(function(){b.writable=!0;b.emit("drain")},0)};d.prototype.onClose=function(){h.prototype.onClose.call(this)};d.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()};d.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",d="";this.port&&("wss"==b&&443!=this.port||"ws"==b&&80!=this.port)&&(d=
":"+this.port);this.timestampRequests&&(a[this.timestampParam]=+new Date);this.supportsBinary||(a.b64=1);a=f.encode(a);a.length&&(a="?"+a);return b+"://"+this.hostname+d+this.path+a};d.prototype.check=function(){return!!X&&!("__initialize"in X&&this.name===d.prototype.name)}},{"../transport":14,"component-inherit":9,debug:21,"engine.io-parser":24,parseqs:41,ws:66}],20:[function(a,e,b){var d=a("has-cors");e.exports=function(a){var b=a.xdomain,e=a.xscheme;a=a.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&
(!b||d))return new XMLHttpRequest}catch(n){}try{if("undefined"!=typeof XDomainRequest&&!e&&a)return new XDomainRequest}catch(n){}if(!b)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(n){}}},{"has-cors":31}],21:[function(a,e,b){function d(){try{var a=localStorage.debug}catch(k){}return a}b=e.exports=a("./debug");b.log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)};b.formatArgs=function(){var a=arguments,
d=this.useColors;a[0]=(d?"%c":"")+this.namespace+(d?" %c":" ")+a[0]+(d?"%c ":" ")+"+"+b.humanize(this.diff);if(!d)return a;d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,c=0;a[0].replace(/%[a-z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(c=e))});a.splice(c,0,d);return a};b.save=function(a){try{null==a?localStorage.removeItem("debug"):localStorage.debug=a}catch(k){}};b.load=d;b.useColors=function(){return"WebkitAppearance"in document.documentElement.style||
window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)};b.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");b.formatters.j=function(a){return JSON.stringify(a)};b.enable(d())},{"./debug":22}],22:[function(a,e,b){b=e.exports=function(a){function e(){}function h(){var a=+new Date;h.diff=a-(c||a);h.prev=c;c=h.curr=a;null==h.useColors&&(h.useColors=b.useColors());null==
h.color&&h.useColors&&(h.color=b.colors[d++%b.colors.length]);var e=Array.prototype.slice.call(arguments);e[0]=b.coerce(e[0]);"string"!==typeof e[0]&&(e=["%o"].concat(e));var k=0;e[0]=e[0].replace(/%([a-z%])/g,function(a,d){if("%%"===a)return a;k++;d=b.formatters[d];"function"===typeof d&&(a=d.call(h,e[k]),e.splice(k,1),k--);return a});"function"===typeof b.formatArgs&&(e=b.formatArgs.apply(h,e));(h.log||b.log||console.log.bind(console)).apply(h,e)}e.enabled=!1;h.enabled=!0;var k=b.enabled(a)?h:e;
k.namespace=a;return k};b.coerce=function(a){return a instanceof Error?a.stack||a.message:a};b.disable=function(){b.enable("")};b.enable=function(a){b.save(a);for(var d=(a||"").split(/[\s,]+/),e=d.length,h=0;h<e;h++)d[h]&&(a=d[h].replace(/\*/g,".*?"),"-"===a[0]?b.skips.push(new RegExp("^"+a.substr(1)+"$")):b.names.push(new RegExp("^"+a+"$")))};b.enabled=function(a){var d;var e=0;for(d=b.skips.length;e<d;e++)if(b.skips[e].test(a))return!1;e=0;for(d=b.names.length;e<d;e++)if(b.names[e].test(a))return!0;
return!1};b.humanize=a("ms");b.names=[];b.skips=[];b.formatters={};var d=0,c},{ms:38}],23:[function(a,e,b){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,h="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");e.exports=function(a){var b=a,e=a.indexOf("["),
c=a.indexOf("]");-1!=e&&-1!=c&&(a=a.substring(0,e)+a.substring(e,c).replace(/:/g,";")+a.substring(c,a.length));a=d.exec(a||"");for(var k={},f=14;f--;)k[h[f]]=a[f]||"";-1!=e&&-1!=c&&(k.source=b,k.host=k.host.substring(1,k.host.length-1).replace(/;/g,":"),k.authority=k.authority.replace("[","").replace("]","").replace(/;/g,":"),k.ipv6uri=!0);return k}},{}],24:[function(a,e,b){(function(d){function e(a,d,e){if(!d)return b.encodeBase64Packet(a,e);var c=new FileReader;c.onload=function(){a.data=c.result;
b.encodePacket(a,d,!0,e)};return c.readAsArrayBuffer(a.data)}function c(a,b,d){var e=Array(a.length);d=x(a.length,d);for(var c=function(a,d,c){b(d,function(b,d){e[a]=d;c(b,e)})},h=0;h<a.length;h++)c(h,a[h],d)}var f=a("./keys"),n=a("has-binary"),X=a("arraybuffer.slice"),u=a("base64-arraybuffer"),x=a("after"),G=a("utf8"),w=navigator.userAgent.match(/Android/i),g=/PhantomJS/i.test(navigator.userAgent),Aa=w||g;b.protocol=3;var l=b.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},m=f(l),
xa={type:"error",data:"parser error"},p=a("blob");b.encodePacket=function(a,c,h,k){"function"==typeof c&&(k=c,c=!1);"function"==typeof h&&(k=h,h=null);var f=void 0===a.data?void 0:a.data.buffer||a.data;if(d.ArrayBuffer&&f instanceof ArrayBuffer){if(c){h=a.data;c=new Uint8Array(h);h=new Uint8Array(1+h.byteLength);h[0]=l[a.type];for(a=0;a<c.length;a++)h[a+1]=c[a];a=k(h.buffer)}else a=b.encodeBase64Packet(a,k);return a}if(p&&f instanceof d.Blob)return c?Aa?a=e(a,c,k):(c=new Uint8Array(1),c[0]=l[a.type],
a=new p([c.buffer,a.data]),a=k(a)):a=b.encodeBase64Packet(a,k),a;if(f&&f.base64)return k("b"+b.packets[a.type]+a.data.data);c=l[a.type];void 0!==a.data&&(c+=h?G.encode(String(a.data)):String(a.data));return k(""+c)};b.encodeBase64Packet=function(a,e){var c="b"+b.packets[a.type];if(p&&a.data instanceof p){var h=new FileReader;h.onload=function(){var a=h.result.split(",")[1];e(c+a)};return h.readAsDataURL(a.data)}try{var k=String.fromCharCode.apply(null,new Uint8Array(a.data))}catch(Ag){a=new Uint8Array(a.data);
k=Array(a.length);for(var f=0;f<a.length;f++)k[f]=a[f];k=String.fromCharCode.apply(null,k)}c+=d.btoa(k);return e(c)};b.decodePacket=function(a,d,e){if("string"==typeof a||void 0===a){if("b"==a.charAt(0))return b.decodeBase64Packet(a.substr(1),d);if(e)try{a=G.decode(a)}catch(zg){return xa}e=a.charAt(0);return Number(e)==e&&m[e]?1<a.length?{type:m[e],data:a.substring(1)}:{type:m[e]}:xa}e=(new Uint8Array(a))[0];a=X(a,1);p&&"blob"===d&&(a=new p([a]));return{type:m[e],data:a}};b.decodeBase64Packet=function(a,
b){var e=m[a.charAt(0)];if(!d.ArrayBuffer)return{type:e,data:{base64:!0,data:a.substr(1)}};a=u.decode(a.substr(1));"blob"===b&&p&&(a=new p([a]));return{type:e,data:a}};b.encodePayload=function(a,d,e){"function"==typeof d&&(e=d,d=null);var h=n(a);if(d&&h)return p&&!Aa?b.encodePayloadAsBlob(a,e):b.encodePayloadAsArrayBuffer(a,e);if(!a.length)return e("0:");c(a,function(a,e){b.encodePacket(a,h?d:!1,!0,function(a){e(null,a.length+":"+a)})},function(a,b){return e(b.join(""))})};b.decodePayload=function(a,
d,e){if("string"!=typeof a)return b.decodePayloadAsBinary(a,d,e);"function"===typeof d&&(e=d,d=null);if(""==a)return e(xa,0,1);var c="";for(var h,k,f=0,n=a.length;f<n;f++)if(k=a.charAt(f),":"!=k)c+=k;else{if(""==c||c!=(h=Number(c)))return e(xa,0,1);k=a.substr(f+1,h);if(c!=k.length)return e(xa,0,1);if(k.length){c=b.decodePacket(k,d,!0);if(xa.type==c.type&&xa.data==c.data)return e(xa,0,1);if(!1===e(c,f+h,n))return}f+=h;c=""}if(""!=c)return e(xa,0,1)};b.encodePayloadAsArrayBuffer=function(a,d){if(!a.length)return d(new ArrayBuffer(0));
c(a,function(a,d){b.encodePacket(a,!0,!0,function(a){return d(null,a)})},function(a,b){a=b.reduce(function(a,b){b="string"===typeof b?b.length:b.byteLength;return a+b.toString().length+b+2},0);var e=new Uint8Array(a),c=0;b.forEach(function(a){var b="string"===typeof a,d=a;if(b){d=new Uint8Array(a.length);for(var h=0;h<a.length;h++)d[h]=a.charCodeAt(h);d=d.buffer}b?e[c++]=0:e[c++]=1;a=d.byteLength.toString();for(h=0;h<a.length;h++)e[c++]=parseInt(a[h]);e[c++]=255;d=new Uint8Array(d);for(h=0;h<d.length;h++)e[c++]=
d[h]});return d(e.buffer)})};b.encodePayloadAsBlob=function(a,d){c(a,function(a,d){b.encodePacket(a,!0,!0,function(a){var b=new Uint8Array(1);b[0]=1;if("string"===typeof a){for(var e=new Uint8Array(a.length),c=0;c<a.length;c++)e[c]=a.charCodeAt(c);a=e.buffer;b[0]=0}e=(a instanceof ArrayBuffer?a.byteLength:a.size).toString();var h=new Uint8Array(e.length+1);for(c=0;c<e.length;c++)h[c]=parseInt(e[c]);h[e.length]=255;p&&(a=new p([b.buffer,h.buffer,a]),d(null,a))})},function(a,b){return d(new p(b))})};
b.decodePayloadAsBinary=function(a,d,e){"function"===typeof d&&(e=d,d=null);for(var c=[],h=!1;0<a.byteLength;){for(var k=new Uint8Array(a),f=0===k[0],n="",w=1;255!=k[w];w++){if(310<n.length){h=!0;break}n+=k[w]}if(h)return e(xa,0,1);a=X(a,2+n.length);n=parseInt(n);k=X(a,0,n);if(f)try{k=String.fromCharCode.apply(null,new Uint8Array(k))}catch(Bg){for(f=new Uint8Array(k),k="",w=0;w<f.length;w++)k+=String.fromCharCode(f[w])}c.push(k);a=X(a,n)}var u=c.length;c.forEach(function(a,c){e(b.decodePacket(a,d,
!0),c,u)})}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./keys":25,after:1,"arraybuffer.slice":2,"base64-arraybuffer":5,blob:6,"has-binary":30,utf8:60}],25:[function(a,e,b){e.exports=Object.keys||function(a){var b=[],d=Object.prototype.hasOwnProperty,e;for(e in a)d.call(a,e)&&b.push(e);return b}},{}],26:[function(a,e,b){function d(a){k.call(this);a=a||{};this.config={chunksize:16384,pacing:0};for(var b in a)this.config[b]=
a[b];this.channel=this.file=null}function c(){k.call(this);this.receiveBuffer=[];this.received=0;this.metadata={};this.channel=null}var k=a("wildemitter");a=a("util");a.inherits(d,k);d.prototype.send=function(a,b){var d=this;this.file=a;this.channel=b;var e="number"!==typeof b.bufferedAmountLowThreshold,c=0,h=function(){var k=new window.FileReader;k.onload=function(){return function(k){d.channel.send(k.target.result);d.emit("progress",c,a.size,k.target.result);a.size>c+k.target.result.byteLength?
e?window.setTimeout(h,d.config.pacing):b.bufferedAmount<=b.bufferedAmountLowThreshold&&window.setTimeout(h,0):(d.emit("progress",a.size,a.size,null),d.emit("sentFile"));c+=d.config.chunksize}}(a);var f=a.slice(c,c+d.config.chunksize);k.readAsArrayBuffer(f)};e||(b.bufferedAmountLowThreshold=8*this.config.chunksize,b.addEventListener("bufferedamountlow",h));window.setTimeout(h,0)};a.inherits(c,k);c.prototype.receive=function(a,b){var d=this;a&&(this.metadata=a);this.channel=b;b.binaryType="arraybuffer";
this.channel.onmessage=function(a){d.received+=a.data.byteLength;d.receiveBuffer.push(a.data);d.emit("progress",d.received,d.metadata.size,a.data);d.received===d.metadata.size?(d.emit("receivedFile",new window.Blob(d.receiveBuffer),d.metadata),d.receiveBuffer=[]):d.received>d.metadata.size&&(console.error("received more than expected, discarding..."),d.receiveBuffer=[])}};e.exports={};e.exports.support="undefined"!==typeof window&&window&&window.File&&window.FileReader&&window.Blob;e.exports.Sender=
d;e.exports.Receiver=c},{util:63,wildemitter:65}],27:[function(a,e,b){var d={};e.exports=function(a,b){var e=2===arguments.length,c=e?b:a;if("undefined"===typeof window||"http:"===window.location.protocol){var h=Error("NavigatorUserMediaError");h.name="HTTPS_REQUIRED";return c(h)}if(window.navigator.userAgent.match("Chrome")){var k=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),f=33,G=!window.chrome.webstore;window.navigator.userAgent.match("Linux")&&(f=35);sessionStorage.getScreenMediaJSExtensionId?
chrome.runtime.sendMessage(sessionStorage.getScreenMediaJSExtensionId,{type:"getScreen",id:1},null,function(b){b&&""!==b.sourceId?(a=e&&a||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3}}},a.video.mandatory.chromeMediaSourceId=b.sourceId,window.navigator.mediaDevices.getUserMedia(a).then(function(a){c(null,a)}).catch(function(a){c(a)})):(b=Error("NavigatorUserMediaError"),b.name="NotAllowedError",c(b))}):window.cefGetScreenMedia?
window.cefGetScreenMedia(function(b){b?(a=e&&a||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},a.video.mandatory.chromeMediaSourceId=b,window.navigator.mediaDevices.getUserMedia(a).then(function(a){c(null,a)}).catch(function(a){c(a)})):(b=Error("cefGetScreenMediaError"),b.name="CEF_GETSCREENMEDIA_CANCELED",c(b))}):G||26<=k&&k<=f?(a=e&&a||{video:{mandatory:{googLeakyBucket:!0,
maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3,chromeMediaSource:"screen"}}},window.navigator.mediaDevices.getUserMedia(a).then(function(a){c(null,a)}).catch(function(a){c(a)})):(k=window.setTimeout(function(){h=Error("NavigatorUserMediaError");h.name="EXTENSION_UNAVAILABLE";return c(h)},1E3),d[k]=[c,e?a:null],window.postMessage({type:"getScreen",id:k},"*"))}else window.navigator.userAgent.match("Firefox")&&(33<=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],
10)?(a=e&&a||{video:{mozMediaSource:"window",mediaSource:"window"}},window.navigator.mediaDevices.getUserMedia(a).then(function(a){c(null,a);var b=a.currentTime,d=window.setInterval(function(){a||window.clearInterval(d);if(a.currentTime==b&&(window.clearInterval(d),a.onended))a.onended();b=a.currentTime},500)}).catch(function(a){c(a)})):(h=Error("NavigatorUserMediaError"),h.name="EXTENSION_UNAVAILABLE"))};"undefined"!==typeof window&&window.addEventListener("message",function(a){if(a.origin==window.location.origin)if("gotScreen"==
a.data.type&&d[a.data.id]){var b=d[a.data.id],e=b[1],c=b[0];delete d[a.data.id];""===a.data.sourceId?(a=Error("NavigatorUserMediaError"),a.name="NotAllowedError",c(a)):(e=e||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},e.video.mandatory.chromeMediaSourceId=a.data.sourceId,window.navigator.mediaDevices.getUserMedia(e).then(function(a){c(null,a)}).catch(function(a){c(a)}))}else"getScreenPending"==
a.data.type&&window.clearTimeout(a.data.id)})},{}],28:[function(a,e,b){e.exports=function(){return this}()},{}],29:[function(a,e,b){var d=a("wildemitter"),c;"undefined"!==typeof window&&(c=window.AudioContext||window.webkitAudioContext);var k=null;e.exports=function(a,b){var e=new d;if(!c)return e;b=b||{};var h=b.smoothing||.1,f=b.interval||50,n=b.threshold,w=b.play;b=b.history||10;var C=!0;k||(k=new c);var g=k.createAnalyser();g.fftSize=512;g.smoothingTimeConstant=h;var l=new Float32Array(g.frequencyBinCount);
a.jquery&&(a=a[0]);if(a instanceof HTMLAudioElement||a instanceof HTMLVideoElement){var m=k.createMediaElementSource(a);"undefined"===typeof w&&(w=!0)}else m=k.createMediaStreamSource(a);n=n||-50;m.connect(g);w&&g.connect(k.destination);e.speaking=!1;e.setThreshold=function(a){n=a};e.setInterval=function(a){f=a};e.stop=function(){C=!1;e.emit("volume_change",-100,n);e.speaking&&(e.speaking=!1,e.emit("stopped_speaking"));g.disconnect();m.disconnect()};e.speakingHistory=[];for(a=0;a<b;a++)e.speakingHistory.push(0);
var p=function(){setTimeout(function(){if(C){var a=-Infinity;g.getFloatFrequencyData(l);for(var b=4,d=l.length;b<d;b++)l[b]>a&&0>l[b]&&(a=l[b]);e.emit("volume_change",a,n);b=0;if(a>n&&!e.speaking){for(d=e.speakingHistory.length-3;d<e.speakingHistory.length;d++)b+=e.speakingHistory[d];2<=b&&(e.speaking=!0,e.emit("speaking"))}else if(a<n&&e.speaking){for(d=0;d<e.speakingHistory.length;d++)b+=e.speakingHistory[d];0==b&&(e.speaking=!1,e.emit("stopped_speaking"))}e.speakingHistory.shift();e.speakingHistory.push(0+
(a>n));p()}},f)};p();return e}},{wildemitter:65}],30:[function(a,e,b){(function(b){var d=a("isarray");e.exports=function(a){function e(a){if(!a)return!1;if(b.Buffer&&b.Buffer.isBuffer(a)||b.ArrayBuffer&&a instanceof ArrayBuffer||b.Blob&&a instanceof Blob||b.File&&a instanceof File)return!0;if(d(a))for(var c=0;c<a.length;c++){if(e(a[c]))return!0}else if(a&&"object"==typeof a)for(c in a.toJSON&&(a=a.toJSON()),a)if(Object.prototype.hasOwnProperty.call(a,c)&&e(a[c]))return!0;return!1}return e(a)}}).call(this,
"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{isarray:33}],31:[function(a,e,b){a=a("global");try{e.exports="XMLHttpRequest"in a&&"withCredentials"in new a.XMLHttpRequest}catch(d){e.exports=!1}},{global:28}],32:[function(a,e,b){var d=[].indexOf;e.exports=function(a,b){if(d)return a.indexOf(b);for(var e=0;e<a.length;++e)if(a[e]===b)return e;return-1}},{}],33:[function(a,e,b){e.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},
{}],34:[function(a,e,b){(function(a){function d(a){if(d[a]!==f)return d[a];if("bug-string-char-index"==a)var b=!1;else if("json"==a)b=d("json-stringify")&&d("json-parse");else{var c;if("json-stringify"==a){b=u.stringify;var h="function"==typeof b&&x;if(h){(c=function(){return 1}).toJSON=c;try{h="0"===b(0)&&"0"===b(new Number)&&'""'==b(new String)&&b(e)===f&&b(f)===f&&b()===f&&"1"===b(c)&&"[1]"==b([c])&&"[null]"==b([f])&&"null"==b(null)&&"[null,null,null]"==b([f,e,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==
b({a:[c,!0,!1,null,"\x00\b\n\f\r\t"]})&&"1"===b(null,c)&&"[\n 1,\n 2\n]"==b([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==b(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==b(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==b(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==b(new Date(-1))}catch(Fa){h=!1}}b=h}if("json-parse"==a){b=u.parse;if("function"==typeof b)try{if(0===b("0")&&!b(!1)){c=b('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var k=5==c.a.length&&1===c.a[0];if(k){try{k=
!b('"\t"')}catch(Fa){}if(k)try{k=1!==b("01")}catch(Fa){}if(k)try{k=1!==b("1.")}catch(Fa){}}}}catch(Fa){k=!1}b=k}}return d[a]=!!b}var e={}.toString,c,f,g="object"==typeof JSON&&JSON,u="object"==typeof b&&b&&!b.nodeType&&b;u&&g?(u.stringify=g.stringify,u.parse=g.parse):u=a.JSON=g||{};var x=new Date(-0xc782b5b800cec);try{x=-109252==x.getUTCFullYear()&&0===x.getUTCMonth()&&1===x.getUTCDate()&&10==x.getUTCHours()&&37==x.getUTCMinutes()&&6==x.getUTCSeconds()&&708==x.getUTCMilliseconds()}catch(Cg){}if(!d("json")){var G=
d("bug-string-char-index");if(!x)var w=Math.floor,P=[0,31,59,90,120,151,181,212,243,273,304,334],Aa=function(a,b){return P[b]+365*(a-1970)+w((a-1969+(b=+(1<b)))/4)-w((a-1901+b)/100)+w((a-1601+b)/400)};(c={}.hasOwnProperty)||(c=function(a){var b={};if((b.__proto__=null,b.__proto__={toString:1},b).toString!=e)c=function(a){var b=this.__proto__;a=a in(this.__proto__=null,this);this.__proto__=b;return a};else{var d=b.constructor;c=function(a){var b=(this.constructor||d).prototype;return a in this&&!(a in
b&&this[a]===b[a])}}b=null;return c.call(this,a)});var l={"boolean":1,number:1,string:1,undefined:1};var m=function(a,b){var d=0,h,k;(h=function(){this.valueOf=0}).prototype.valueOf=0;var f=new h;for(k in f)c.call(f,k)&&d++;h=f=null;d?m=2==d?function(a,b){var d={},h="[object Function]"==e.call(a),f;for(f in a)h&&"prototype"==f||c.call(d,f)||!(d[f]=1)||!c.call(a,f)||b(f)}:function(a,b){var d="[object Function]"==e.call(a),h,f;for(h in a)d&&"prototype"==h||!c.call(a,h)||(f="constructor"===h)||b(h);
(f||c.call(a,h="constructor"))&&b(h)}:(f="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),m=function(a,b){var d="[object Function]"==e.call(a),h,k;if(k=!d&&"function"!=typeof a.constructor)k=typeof a.hasOwnProperty,k="object"==k?!!a.hasOwnProperty:!l[k];k=k?a.hasOwnProperty:c;for(h in a)d&&"prototype"==h||!k.call(a,h)||b(h);for(d=f.length;h=f[--d];k.call(a,h)&&b(h));});return m(a,b)};if(!d("json-stringify")){var p={92:"\\\\",34:'\\"',8:"\\b",
12:"\\f",10:"\\n",13:"\\r",9:"\\t"},q=function(a,b){return("000000"+(b||0)).slice(-a)},t=function(a){var b='"',d=0,e=a.length,c=10<e&&G,h;for(c&&(h=a.split(""));d<e;d++){var f=a.charCodeAt(d);switch(f){case 8:case 9:case 10:case 12:case 13:case 34:case 92:b+=p[f];break;default:b=32>f?b+("\\u00"+q(2,f.toString(16))):b+(c?h[d]:G?a.charAt(d):a[d])}}return b+'"'},v=function(a,b,d,h,k,n,u){var x;try{var g=b[a]}catch(Eg){}if("object"==typeof g&&g){var C=e.call(g);if("[object Date]"!=C||c.call(g,"toJSON"))"function"==
typeof g.toJSON&&("[object Number]"!=C&&"[object String]"!=C&&"[object Array]"!=C||c.call(g,"toJSON"))&&(g=g.toJSON(a));else if(g>-1/0&&g<1/0){if(Aa){var G=w(g/864E5);for(C=w(G/365.2425)+1970-1;Aa(C+1,0)<=G;C++);for(x=w((G-Aa(C,0))/30.42);Aa(C,x+1)<=G;x++);G=1+G-Aa(C,x);var X=(g%864E5+864E5)%864E5;var P=w(X/36E5)%24;var l=w(X/6E4)%60;var p=w(X/1E3)%60;X%=1E3}else C=g.getUTCFullYear(),x=g.getUTCMonth(),G=g.getUTCDate(),P=g.getUTCHours(),l=g.getUTCMinutes(),p=g.getUTCSeconds(),X=g.getUTCMilliseconds();
g=(0>=C||1E4<=C?(0>C?"-":"+")+q(6,0>C?-C:C):q(4,C))+"-"+q(2,x+1)+"-"+q(2,G)+"T"+q(2,P)+":"+q(2,l)+":"+q(2,p)+"."+q(3,X)+"Z"}else g=null}d&&(g=d.call(b,a,g));if(null===g)return"null";C=e.call(g);if("[object Boolean]"==C)return""+g;if("[object Number]"==C)return g>-1/0&&g<1/0?""+g:"null";if("[object String]"==C)return t(""+g);if("object"==typeof g){for(a=u.length;a--;)if(u[a]===g)throw TypeError();u.push(g);var za=[];b=n;n+=k;if("[object Array]"==C){x=0;for(a=g.length;x<a;x++)C=v(x,g,d,h,k,n,u),za.push(C===
f?"null":C);a=za.length?k?"[\n"+n+za.join(",\n"+n)+"\n"+b+"]":"["+za.join(",")+"]":"[]"}else m(h||g,function(a){var b=v(a,g,d,h,k,n,u);b!==f&&za.push(t(a)+":"+(k?" ":"")+b)}),a=za.length?k?"{\n"+n+za.join(",\n"+n)+"\n"+b+"}":"{"+za.join(",")+"}":"{}";u.pop();return a}};u.stringify=function(a,b,d){var c;if("function"==typeof b||"object"==typeof b&&b)if("[object Function]"==(c=e.call(b)))var h=b;else if("[object Array]"==c){var k={};for(var f=0,n=b.length,u;f<n;u=b[f++],(c=e.call(u),"[object String]"==
c||"[object Number]"==c)&&(k[u]=1));}if(d)if("[object Number]"==(c=e.call(d))){if(0<(d-=d%1)){var w="";for(10<d&&(d=10);w.length<d;w+=" ");}}else"[object String]"==c&&(w=10>=d.length?d:d.slice(0,10));return v("",(u={},u[""]=a,u),h,k,w,"",[])}}if(!d("json-parse")){var z=String.fromCharCode,B={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},D,A,y=function(){D=A=null;throw SyntaxError();},E=function(){for(var a=A,b=a.length,d,e,c,h,k;D<b;)switch(k=a.charCodeAt(D),k){case 9:case 10:case 13:case 32:D++;
break;case 123:case 125:case 91:case 93:case 58:case 44:return d=G?a.charAt(D):a[D],D++,d;case 34:d="@";for(D++;D<b;)if(k=a.charCodeAt(D),32>k)y();else if(92==k)switch(k=a.charCodeAt(++D),k){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:d+=B[k];D++;break;case 117:e=++D;for(c=D+4;D<c;D++)k=a.charCodeAt(D),48<=k&&57>=k||97<=k&&102>=k||65<=k&&70>=k||y();d+=z("0x"+a.slice(e,D));break;default:y()}else{if(34==k)break;k=a.charCodeAt(D);for(e=D;32<=k&&92!=k&&34!=k;)k=a.charCodeAt(++D);
d+=a.slice(e,D)}if(34==a.charCodeAt(D))return D++,d;y();default:e=D;45==k&&(h=!0,k=a.charCodeAt(++D));if(48<=k&&57>=k){for(48==k&&(k=a.charCodeAt(D+1),48<=k&&57>=k)&&y();D<b&&(k=a.charCodeAt(D),48<=k&&57>=k);D++);if(46==a.charCodeAt(D)){for(c=++D;c<b&&(k=a.charCodeAt(c),48<=k&&57>=k);c++);c==D&&y();D=c}k=a.charCodeAt(D);if(101==k||69==k){k=a.charCodeAt(++D);43!=k&&45!=k||D++;for(c=D;c<b&&(k=a.charCodeAt(c),48<=k&&57>=k);c++);c==D&&y();D=c}return+a.slice(e,D)}h&&y();if("true"==a.slice(D,D+4))return D+=
4,!0;if("false"==a.slice(D,D+5))return D+=5,!1;if("null"==a.slice(D,D+4))return D+=4,null;y()}return"$"},F=function(a){var b,d;"$"==a&&y();if("string"==typeof a){if("@"==(G?a.charAt(0):a[0]))return a.slice(1);if("["==a){for(b=[];;d||(d=!0)){a=E();if("]"==a)break;d&&(","==a?(a=E(),"]"==a&&y()):y());","==a&&y();b.push(F(a))}return b}if("{"==a){for(b={};;d||(d=!0)){a=E();if("}"==a)break;d&&(","==a?(a=E(),"}"==a&&y()):y());","!=a&&"string"==typeof a&&"@"==(G?a.charAt(0):a[0])&&":"==E()||y();b[a.slice(1)]=
F(E())}return b}y()}return a},I=function(a,b,d){d=H(a,b,d);d===f?delete a[b]:a[b]=d},H=function(a,b,d){var c=a[b],h;if("object"==typeof c&&c)if("[object Array]"==e.call(c))for(h=c.length;h--;)I(c,h,d);else m(c,function(a){I(c,a,d)});return d.call(a,b,c)};u.parse=function(a,b){var d;D=0;A=""+a;a=F(E());"$"!=E()&&y();D=A=null;return b&&"[object Function]"==e.call(b)?H((d={},d[""]=a,d),"",b):a}}}})(this)},{}],35:[function(a,e,b){function d(a){var b=!0;a.getTracks().forEach(function(a){b="ended"===a.readyState&&
b});return b}function c(){if("undefined"===typeof window||!window.navigator.mozGetUserMedia)return!1;var a=window.navigator.userAgent.match(/Firefox\/(\d+)\./);return 50>(a&&1<=a.length&&parseInt(a[1],10))}function k(a){g.call(this);var b=this.config={detectSpeakingEvents:!1,audioFallback:!1,media:{audio:!0,video:!0},harkOptions:null,logger:u},d;for(d in a)a.hasOwnProperty(d)&&(this.config[d]=a[d]);this.logger=b.logger;this._log=this.logger.log.bind(this.logger,"LocalMedia:");this._logerror=this.logger.error.bind(this.logger,
"LocalMedia:");this.localStreams=[];this.localScreens=[];navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||this._logerror("Your browser does not support local media capture.");this._audioMonitors=[];this.on("localStreamStopped",this._stopAudioMonitor.bind(this));this.on("localScreenStopped",this._stopAudioMonitor.bind(this))}b=a("util");var f=a("hark"),n=a("getscreenmedia"),g=a("wildemitter"),u=a("mockconsole");b.inherits(k,g);k.prototype.start=function(a,b){var e=this,c=a||this.config.media;
this.emit("localStreamRequested",c);navigator.mediaDevices.getUserMedia(c).then(function(a){c.audio&&e.config.detectSpeakingEvents&&e._setupAudioMonitor(a,e.config.harkOptions);e.localStreams.push(a);a.getTracks().forEach(function(b){b.addEventListener("ended",function(){d(a)&&e._removeStream(a)})});e.emit("localStream",a);if(b)return b(null,a)}).catch(function(a){if(e.config.audioFallback&&"NotFoundError"===a.name&&!1!==c.video)c.video=!1,e.start(c,b);else if(e.emit("localStreamRequestFailed",c),
b)return b(a,null)})};k.prototype.stop=function(a){this.stopStream(a);this.stopScreenShare(a)};k.prototype.stopStream=function(a){var b=this;a?-1<this.localStreams.indexOf(a)&&(a.getTracks().forEach(function(a){a.stop()}),c()&&this._removeStream(a)):this.localStreams.forEach(function(a){a.getTracks().forEach(function(a){a.stop()});c()&&b._removeStream(a)})};k.prototype.startScreenShare=function(a,b){var d=this;this.emit("localScreenRequested");"function"!==typeof a||b||(b=a,a=null);n(a,function(a,
e){a?d.emit("localScreenRequestFailed"):(d.localScreens.push(e),e.getTracks().forEach(function(a){a.addEventListener("ended",function(){var a=!0;e.getTracks().forEach(function(b){a="ended"===b.readyState&&a});a&&d._removeStream(e)})}),d.emit("localScreen",e));if(b)return b(a,e)})};k.prototype.stopScreenShare=function(a){var b=this;a?-1<this.localScreens.indexOf(a)&&(a.getTracks().forEach(function(a){a.stop()}),c()&&this._removeStream(a)):this.localScreens.forEach(function(a){a.getTracks().forEach(function(a){a.stop()});
c()&&b._removeStream(a)})};k.prototype.mute=function(){this._audioEnabled(!1);this.emit("audioOff")};k.prototype.unmute=function(){this._audioEnabled(!0);this.emit("audioOn")};k.prototype.pauseVideo=function(){this._videoEnabled(!1);this.emit("videoOff")};k.prototype.resumeVideo=function(){this._videoEnabled(!0);this.emit("videoOn")};k.prototype.pause=function(){this.mute();this.pauseVideo()};k.prototype.resume=function(){this.unmute();this.resumeVideo()};k.prototype._audioEnabled=function(a){this.localStreams.forEach(function(b){b.getAudioTracks().forEach(function(b){b.enabled=
!!a})})};k.prototype._videoEnabled=function(a){this.localStreams.forEach(function(b){b.getVideoTracks().forEach(function(b){b.enabled=!!a})})};k.prototype.isAudioEnabled=function(){var a=!0;this.localStreams.forEach(function(b){b.getAudioTracks().forEach(function(b){a=a&&b.enabled})});return a};k.prototype.isVideoEnabled=function(){var a=!0;this.localStreams.forEach(function(b){b.getVideoTracks().forEach(function(b){a=a&&b.enabled})});return a};k.prototype._removeStream=function(a){var b=this.localStreams.indexOf(a);
-1<b?(this.localStreams.splice(b,1),this.emit("localStreamStopped",a)):(b=this.localScreens.indexOf(a),-1<b&&(this.localScreens.splice(b,1),this.emit("localScreenStopped",a)))};k.prototype._setupAudioMonitor=function(a,b){this._log("Setup audio");b=f(a,b);var d=this,e;b.on("speaking",function(){d.emit("speaking")});b.on("stopped_speaking",function(){e&&clearTimeout(e);e=setTimeout(function(){d.emit("stoppedSpeaking")},1E3)});b.on("volume_change",function(a,b){d.emit("volumeChange",a,b)});this._audioMonitors.push({audio:b,
stream:a})};k.prototype._stopAudioMonitor=function(a){var b=-1;this._audioMonitors.forEach(function(d,e){d.stream===a&&(b=e)});-1<b&&(this._audioMonitors[b].audio.stop(),this._audioMonitors.splice(b,1))};e.exports=k},{getscreenmedia:27,hark:29,mockconsole:37,util:63,wildemitter:65}],36:[function(a,e,b){(function(a){function d(a,b){a.set(b[0],b[1]);return a}function c(a,b){a.add(b);return a}function f(a,b){for(var d=-1,e=a?a.length:0;++d<e&&!1!==b(a[d],d,a););return a}function n(a,b,d,e){var c=-1,
h=a?a.length:0;for(e&&h&&(d=a[++c]);++c<h;)d=b(d,a[c],c,a);return d}function g(a){var b=!1;if(null!=a&&"function"!=typeof a.toString)try{b=!!(a+"")}catch(Gg){}return b}function u(a){var b=-1,d=Array(a.size);a.forEach(function(a,e){d[++b]=[e,a]});return d}function x(a,b){return function(d){return a(b(d))}}function G(a){var b=-1,d=Array(a.size);a.forEach(function(a){d[++b]=a});return d}function w(a){var b=-1,d=a?a.length:0;for(this.clear();++b<d;){var e=a[b];this.set(e[0],e[1])}}function P(a){var b=
-1,d=a?a.length:0;for(this.clear();++b<d;){var e=a[b];this.set(e[0],e[1])}}function l(a){var b=-1,d=a?a.length:0;for(this.clear();++b<d;){var e=a[b];this.set(e[0],e[1])}}function m(a){this.__data__=new P(a)}function p(a,b,d){var e=a[b];S.call(a,b)&&(e===d||e!==e&&d!==d)&&(void 0!==d||b in a)||(a[b]=d)}function q(a,b){for(var d=a.length;d--;){var e=a[d][0];if(e===b||e!==e&&b!==b)return d}return-1}function t(a,b){return a&&B(b,M(b),a)}function v(a,b,d,e,c,h,k){var n;e&&(n=h?e(a,c,h,k):e(a));if(void 0!==
n)return n;if(!Fa(a))return a;if(c=pa(a)){if(n=I(a),!b)return D(a,n)}else{var u=ba(a),w="[object Function]"==u||"[object GeneratorFunction]"==u;if(ya(a))return z(a,b);if("[object Object]"==u||"[object Arguments]"==u||w&&!h){if(g(a))return h?a:{};n=H(w?{}:a);if(!b)return A(a,t(n,a))}else{if(!Q[u])return h?a:{};n=L(a,u,v,b)}}k||(k=new m);if(h=k.get(a))return h;k.set(a,n);if(!c)var C=d?zb(a,M,ra):M(a);f(C||a,function(c,h){C&&(h=c,c=a[h]);p(n,h,v(c,b,d,e,h,a,k))});return n}function zb(a,b,d){b=b(a);if(!pa(a)){a=
d(a);d=-1;for(var e=a.length,c=b.length;++d<e;)b[c+d]=a[d]}return b}function z(a,b){if(b)return a.slice();b=new a.constructor(a.length);a.copy(b);return b}function y(a){var b=new a.constructor(a.byteLength);(new ea(b)).set(new ea(a));return b}function D(a,b){var d=-1,e=a.length;for(b||(b=Array(e));++d<e;)b[d]=a[d];return b}function B(a,b,d,e){d||(d={});for(var c=-1,h=b.length;++c<h;){var k=b[c],f=e?e(d[k],a[k],k,d,a):void 0;p(d,k,void 0===f?a[k]:f)}return d}function A(a,b){return B(a,ra(a),b)}function E(a,
b){a=a.__data__;var d=typeof b;return("string"==d||"number"==d||"symbol"==d||"boolean"==d?"__proto__"!==b:null===b)?a["string"==typeof b?"string":"hash"]:a.map}function F(a,b){a=null==a?void 0:a[b];b=!Fa(a)||Z&&Z in a?!1:(Td(a)||g(a)?fa:U).test(Ua(a));return b?a:void 0}function I(a){var b=a.length,d=a.constructor(b);b&&"string"==typeof a[0]&&S.call(a,"index")&&(d.index=a.index,d.input=a.input);return d}function H(a){"function"!=typeof a.constructor||za(a)?a={}:(a=ka(a),a=Fa(a)?la(a):{});return a}
function L(a,b,e,h){var k=a.constructor;switch(b){case "[object ArrayBuffer]":return y(a);case "[object Boolean]":case "[object Date]":return new k(+a);case "[object DataView]":return b=h?y(a.buffer):a.buffer,new a.constructor(b,a.byteOffset,a.byteLength);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return b=
h?y(a.buffer):a.buffer,new a.constructor(b,a.byteOffset,a.length);case "[object Map]":return b=h?e(u(a),!0):u(a),n(b,d,new a.constructor);case "[object Number]":case "[object String]":return new k(a);case "[object RegExp]":return b=new a.constructor(a.source,R.exec(a)),b.lastIndex=a.lastIndex,b;case "[object Set]":return b=h?e(G(a),!0):G(a),n(b,c,new a.constructor);case "[object Symbol]":return qa?Object(qa.call(a)):{}}}function za(a){var b=a&&a.constructor;return a===("function"==typeof b&&b.prototype||
T)}function Ua(a){if(null!=a){try{return aa.call(a)}catch(Fg){}return a+""}return""}function Sd(a){var b;if(b=null!=a)b=a.length,b="number"==typeof b&&-1<b&&0==b%1&&9007199254740991>=b;return b&&!Td(a)}function Td(a){a=Fa(a)?Y.call(a):"";return"[object Function]"==a||"[object GeneratorFunction]"==a}function Fa(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function M(a){if(Sd(a)){var b;(b=pa(a))||(b=!!a&&"object"==typeof a&&Sd(a)&&S.call(a,"callee")&&(!ma.call(a,"callee")||"[object Arguments]"==
Y.call(a)));if(b){b=a.length;for(var d=String,e=-1,c=Array(b);++e<b;)c[e]=d(e);b=c}else b=[];d=b.length;e=!!d;for(var h in a){if(!(c=!S.call(a,h))&&(c=e)&&!(c="length"==h)){c=h;var k=d;k=null==k?9007199254740991:k;c=!!k&&("number"==typeof c||V.test(c))&&-1<c&&0==c%1&&c<k}c||b.push(h)}a=b}else if(za(a)){h=[];for(b in Object(a))S.call(a,b)&&"constructor"!=b&&h.push(b);a=h}else a=oa(a);return a}function uf(){return[]}function O(){return!1}var R=/\w*$/,U=/^\[object .+?Constructor\]$/,V=/^(?:0|[1-9]\d*)$/,
Q={};Q["[object Arguments]"]=Q["[object Array]"]=Q["[object ArrayBuffer]"]=Q["[object DataView]"]=Q["[object Boolean]"]=Q["[object Date]"]=Q["[object Float32Array]"]=Q["[object Float64Array]"]=Q["[object Int8Array]"]=Q["[object Int16Array]"]=Q["[object Int32Array]"]=Q["[object Map]"]=Q["[object Number]"]=Q["[object Object]"]=Q["[object RegExp]"]=Q["[object Set]"]=Q["[object String]"]=Q["[object Symbol]"]=Q["[object Uint8Array]"]=Q["[object Uint8ClampedArray]"]=Q["[object Uint16Array]"]=Q["[object Uint32Array]"]=
!0;Q["[object Error]"]=Q["[object Function]"]=Q["[object WeakMap]"]=!1;var J="object"==typeof self&&self&&self.Object===Object&&self;a="object"==typeof a&&a&&a.Object===Object&&a||J||Function("return this")();var K=(J="object"==typeof b&&b&&!b.nodeType&&b)&&"object"==typeof e&&e&&!e.nodeType&&e;J=K&&K.exports===J;K=Array.prototype;var N=Function.prototype,T=Object.prototype,W=a["__core-js_shared__"],Z=function(){var a=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),
aa=N.toString,S=T.hasOwnProperty,Y=T.toString,fa=RegExp("^"+aa.call(S).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");N=J?a.Buffer:void 0;J=a.Symbol;var ea=a.Uint8Array,ka=x(Object.getPrototypeOf,Object),la=Object.create,ma=T.propertyIsEnumerable,na=K.splice;K=Object.getOwnPropertySymbols;N=N?N.isBuffer:void 0;var oa=x(Object.keys,Object),ha=F(a,"DataView"),ca=F(a,"Map"),ia=F(a,"Promise"),ja=F(a,"Set");a=F(a,"WeakMap");var da=F(Object,
"create"),sa=Ua(ha),ta=Ua(ca),ua=Ua(ia),va=Ua(ja),wa=Ua(a),qa=(J=J?J.prototype:void 0)?J.valueOf:void 0;w.prototype.clear=function(){this.__data__=da?da(null):{}};w.prototype["delete"]=function(a){return this.has(a)&&delete this.__data__[a]};w.prototype.get=function(a){var b=this.__data__;return da?(a=b[a],"__lodash_hash_undefined__"===a?void 0:a):S.call(b,a)?b[a]:void 0};w.prototype.has=function(a){var b=this.__data__;return da?void 0!==b[a]:S.call(b,a)};w.prototype.set=function(a,b){this.__data__[a]=
da&&void 0===b?"__lodash_hash_undefined__":b;return this};P.prototype.clear=function(){this.__data__=[]};P.prototype["delete"]=function(a){var b=this.__data__;a=q(b,a);if(0>a)return!1;a==b.length-1?b.pop():na.call(b,a,1);return!0};P.prototype.get=function(a){var b=this.__data__;a=q(b,a);return 0>a?void 0:b[a][1]};P.prototype.has=function(a){return-1<q(this.__data__,a)};P.prototype.set=function(a,b){var d=this.__data__,e=q(d,a);0>e?d.push([a,b]):d[e][1]=b;return this};l.prototype.clear=function(){this.__data__=
{hash:new w,map:new (ca||P),string:new w}};l.prototype["delete"]=function(a){return E(this,a)["delete"](a)};l.prototype.get=function(a){return E(this,a).get(a)};l.prototype.has=function(a){return E(this,a).has(a)};l.prototype.set=function(a,b){E(this,a).set(a,b);return this};m.prototype.clear=function(){this.__data__=new P};m.prototype["delete"]=function(a){return this.__data__["delete"](a)};m.prototype.get=function(a){return this.__data__.get(a)};m.prototype.has=function(a){return this.__data__.has(a)};
m.prototype.set=function(a,b){var d=this.__data__;if(d instanceof P){d=d.__data__;if(!ca||199>d.length)return d.push([a,b]),this;d=this.__data__=new l(d)}d.set(a,b);return this};var ra=K?x(K,Object):uf,ba=function(a){return Y.call(a)};if(ha&&"[object DataView]"!=ba(new ha(new ArrayBuffer(1)))||ca&&"[object Map]"!=ba(new ca)||ia&&"[object Promise]"!=ba(ia.resolve())||ja&&"[object Set]"!=ba(new ja)||a&&"[object WeakMap]"!=ba(new a))ba=function(a){var b=Y.call(a);if(a=(a="[object Object]"==b?a.constructor:
void 0)?Ua(a):void 0)switch(a){case sa:return"[object DataView]";case ta:return"[object Map]";case ua:return"[object Promise]";case va:return"[object Set]";case wa:return"[object WeakMap]"}return b};var pa=Array.isArray,ya=N||O;e.exports=function(a){return v(a,!0,!0)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],37:[function(a,e,b){a="assert count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd time timeEnd trace warn".split(" ");
b=a.length;for(var d=function(){},c={};b--;)c[a[b]]=d;e.exports=c},{}],38:[function(a,e,b){function d(a){if(a=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(a)){var b=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case "years":case "year":case "y":return b*k;case "days":case "day":case "d":return 864E5*b;case "hours":case "hour":case "h":return 36E5*b;case "minutes":case "minute":case "m":return 6E4*b;case "seconds":case "second":case "s":return 1E3*b;case "ms":return b}}}
function c(a,b,d){if(!(a<b))return a<1.5*b?Math.floor(a/b)+" "+d:Math.ceil(a/b)+" "+d+"s"}var k=315576E5;e.exports=function(a,b){b=b||{};return"string"==typeof a?d(a):b.long?c(a,864E5,"day")||c(a,36E5,"hour")||c(a,6E4,"minute")||c(a,1E3,"second")||a+" ms":864E5<=a?Math.round(a/864E5)+"d":36E5<=a?Math.round(a/36E5)+"h":6E4<=a?Math.round(a/6E4)+"m":1E3<=a?Math.round(a/1E3)+"s":a+"ms"}},{}],39:[function(a,e,b){var d=Object.prototype.hasOwnProperty;b.keys=Object.keys||function(a){var b=[],e;for(e in a)d.call(a,
e)&&b.push(e);return b};b.values=function(a){var b=[],e;for(e in a)d.call(a,e)&&b.push(a[e]);return b};b.merge=function(a,b){for(var e in b)d.call(b,e)&&(a[e]=b[e]);return a};b.length=function(a){return b.keys(a).length};b.isEmpty=function(a){return 0==b.length(a)}},{}],40:[function(a,e,b){(function(a){var b=/^[\],:{}\s]*$/,d=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,c=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,f=/(?:^|:|,)(?:\s*\[)+/g,g=/^\s+/,u=/\s+$/;e.exports=function(e){if("string"!=
typeof e||!e)return null;e=e.replace(g,"").replace(u,"");if(a.JSON&&JSON.parse)return JSON.parse(e);if(b.test(e.replace(d,"@").replace(c,"]").replace(f,"")))return(new Function("return "+e))()}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],41:[function(a,e,b){b.encode=function(a){var b="",d;for(d in a)a.hasOwnProperty(d)&&(b.length&&(b+="&"),b+=encodeURIComponent(d)+"="+encodeURIComponent(a[d]));return b};b.decode=function(a){var b=
{};a=a.split("&");for(var d=0,e=a.length;d<e;d++){var c=a[d].split("=");b[decodeURIComponent(c[0])]=decodeURIComponent(c[1])}return b}},{}],42:[function(a,e,b){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,c="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");
e.exports=function(a){a=d.exec(a||"");for(var b={},e=14;e--;)b[c[e]]=a[e]||"";return b}},{}],43:[function(a,e,b){function d(){throw Error("setTimeout has not been defined");}function c(){throw Error("clearTimeout has not been defined");}function k(a){if(G===setTimeout)return setTimeout(a,0);if((G===d||!G)&&setTimeout)return G=setTimeout,setTimeout(a,0);try{return G(a,0)}catch(sf){try{return G.call(null,a,0)}catch(tf){return G.call(this,a,0)}}}function f(a){if(w===clearTimeout)return clearTimeout(a);
if((w===c||!w)&&clearTimeout)return w=clearTimeout,clearTimeout(a);try{return w(a)}catch(sf){try{return w.call(null,a)}catch(tf){return w.call(this,a)}}}function n(){l&&m&&(l=!1,m.length?P=m.concat(P):p=-1,P.length&&g())}function g(){if(!l){var a=k(n);l=!0;for(var b=P.length;b;){m=P;for(P=[];++p<b;)m&&m[p].run();p=-1;b=P.length}m=null;l=!1;f(a)}}function u(a,b){this.fun=a;this.array=b}function x(){}a=e.exports={};try{var G="function"===typeof setTimeout?setTimeout:d}catch(xa){G=d}try{var w="function"===
typeof clearTimeout?clearTimeout:c}catch(xa){w=c}var P=[],l=!1,m,p=-1;a.nextTick=function(a){var b=Array(arguments.length-1);if(1<arguments.length)for(var d=1;d<arguments.length;d++)b[d-1]=arguments[d];P.push(new u(a,b));1!==P.length||l||k(g)};u.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=x;a.addListener=x;a.once=x;a.off=x;a.removeListener=x;a.removeAllListeners=x;a.emit=x;a.prependListener=x;a.prependOnceListener=
x;a.listeners=function(a){return[]};a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},{}],44:[function(a,e,b){function d(a,b){var d=this,e;k.call(this);a=a||{};a.iceServers=a.iceServers||[];this.enableChromeNativeSimulcast=!1;b&&b.optional&&window.chrome&&null===navigator.appVersion.match(/Chromium\//)&&b.optional.forEach(function(a){a.enableChromeNativeSimulcast&&
(d.enableChromeNativeSimulcast=!0)});this.enableMultiStreamHacks=!1;b&&b.optional&&window.chrome&&b.optional.forEach(function(a){a.enableMultiStreamHacks&&(d.enableMultiStreamHacks=!0)});this.restrictBandwidth=0;b&&b.optional&&b.optional.forEach(function(a){a.andyetRestrictBandwidth&&(d.restrictBandwidth=a.andyetRestrictBandwidth)});this.batchIceCandidates=0;b&&b.optional&&b.optional.forEach(function(a){a.andyetBatchIce&&(d.batchIceCandidates=a.andyetBatchIce)});this.batchedIceCandidates=[];b&&b.optional&&
window.chrome&&b.optional.forEach(function(a){a.andyetFasterICE&&(d.eliminateDuplicateCandidates=a.andyetFasterICE)});b&&b.optional&&b.optional.forEach(function(a){a.andyetDontSignalCandidates&&(d.dontSignalCandidates=a.andyetDontSignalCandidates)});this.assumeSetLocalSuccess=!1;b&&b.optional&&b.optional.forEach(function(a){a.andyetAssumeSetLocalSuccess&&(d.assumeSetLocalSuccess=a.andyetAssumeSetLocalSuccess)});window.navigator.mozGetUserMedia&&b&&b.optional&&(this.wtFirefox=0,b.optional.forEach(function(a){a.andyetFirefoxMakesMeSad&&
(d.wtFirefox=a.andyetFirefoxMakesMeSad,0<d.wtFirefox&&(d.firefoxcandidatebuffer=[]))}));this.pc=new RTCPeerConnection(a,b);this.getLocalStreams="function"===typeof this.pc.getLocalStreams?this.pc.getLocalStreams.bind(this.pc):function(){return[]};this.getSenders="function"===typeof this.pc.getSenders?this.pc.getSenders.bind(this.pc):function(){return[]};this.getRemoteStreams="function"===typeof this.pc.getRemoteStreams?this.pc.getRemoteStreams.bind(this.pc):function(){return[]};this.getReceivers=
"function"===typeof this.pc.getReceivers?this.pc.getReceivers.bind(this.pc):function(){return[]};this.addStream=this.pc.addStream.bind(this.pc);this.removeStream=function(a){"function"===typeof d.pc.removeStream?d.pc.removeStream.apply(d.pc,arguments):"function"===typeof d.pc.removeTrack&&a.getTracks().forEach(function(a){d.pc.removeTrack(a)})};"function"===typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc));this.pc.onremovestream=this.emit.bind(this,"removeStream");this.pc.onremovetrack=
this.emit.bind(this,"removeTrack");this.pc.onaddstream=this.emit.bind(this,"addStream");this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded");this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange");this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange");this.pc.onicecandidate=this._onIce.bind(this);this.pc.ondatachannel=this._onDataChannel.bind(this);this.localDescription={contents:[]};this.remoteDescription={contents:[]};this.config={debug:!1,
sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1};this.iceCredentials={local:{},remote:{}};for(e in a)this.config[e]=a[e];if(this.config.debug)this.on("*",function(){(a.logger||console).log("PeerConnection event:",arguments)});this.hadRemoteIPv6Candidate=this.hadLocalIPv6Candidate=this.hadRemoteRelayCandidate=this.hadLocalRelayCandidate=this.hadRemoteStunCandidate=this.hadLocalStunCandidate=!1;this._remoteDataChannels=[];this._localDataChannels=[];this._candidateBuffer=[]}b=a("util");var c=
a("sdp-jingle-json"),k=a("wildemitter"),f=a("lodash.clonedeep");b.inherits(d,k);Object.defineProperty(d.prototype,"signalingState",{get:function(){return this.pc.signalingState}});Object.defineProperty(d.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}});d.prototype._role=function(){return this.isInitiator?"initiator":"responder"};d.prototype.addStream=function(a){this.localStream=a;this.pc.addStream(a)};d.prototype._checkLocalCandidate=function(a){a=c.toCandidateJSON(a);
"srflx"==a.type?this.hadLocalStunCandidate=!0:"relay"==a.type&&(this.hadLocalRelayCandidate=!0);-1!=a.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)};d.prototype._checkRemoteCandidate=function(a){a=c.toCandidateJSON(a);"srflx"==a.type?this.hadRemoteStunCandidate=!0:"relay"==a.type&&(this.hadRemoteRelayCandidate=!0);-1!=a.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)};d.prototype.processIce=function(a,b){b=b||function(){};var d=this;if("closed"===this.pc.signalingState)return b();if(a.contents||
a.jingle&&a.jingle.contents){var e=this.remoteDescription.contents.map(function(a){return a.name});(a.contents||a.jingle.contents).forEach(function(a){var h=a.transport||{},k=h.candidates||[],f=e.indexOf(a.name),u=a.name,n=d.remoteDescription.contents.find(function(b){return b.name===a.name}),g=function(){k.forEach(function(a){a=c.toCandidateSDP(a);d.pc.addIceCandidate(new RTCIceCandidate({candidate:a,sdpMLineIndex:f,sdpMid:u}),function(){},function(a){d.emit("error",a)});d._checkRemoteCandidate(a)});
b()};d.iceCredentials.remote[a.name]&&h.ufrag&&d.iceCredentials.remote[a.name].ufrag!==h.ufrag?n?(n.transport.ufrag=h.ufrag,n.transport.pwd=h.pwd,h={type:"offer",jingle:d.remoteDescription},h.sdp=c.toSessionSDP(h.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"incoming"}),d.pc.setRemoteDescription(new RTCSessionDescription(h),function(){g()},function(a){d.emit("error",a)})):d.emit("error","ice restart failed to find matching content"):g()})}else{a.candidate&&0!==a.candidate.candidate.indexOf("a=")&&
(a.candidate.candidate="a="+a.candidate.candidate);if(this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(a.candidate),b();d.pc.addIceCandidate(new RTCIceCandidate(a.candidate),function(){},function(a){d.emit("error",a)});d._checkRemoteCandidate(a.candidate.candidate);b()}};d.prototype.offer=function(a,b){var d=this,e=2===arguments.length,h=e&&a?a:{offerToReceiveAudio:1,offerToReceiveVideo:1};
b=(b=e?b:a)||function(){};if("closed"===this.pc.signalingState)return b("Already closed");this.pc.createOffer(function(a){var e={type:"offer",sdp:a.sdp};d.assumeSetLocalSuccess&&(d.emit("offer",e),b(null,e));d._candidateBuffer=[];d.pc.setLocalDescription(a,function(){if(d.config.useJingle){var h=c.toSessionJSON(a.sdp,{role:d._role(),direction:"outgoing"});h.sid=d.config.sid;d.localDescription=h;h.contents.forEach(function(a){var b=a.transport||{};b.ufrag&&(d.iceCredentials.local[a.name]={ufrag:b.ufrag,
pwd:b.pwd})});e.jingle=h}e.sdp.split("\r\n").forEach(function(a){0===a.indexOf("a=candidate:")&&d._checkLocalCandidate(a)});d.assumeSetLocalSuccess||(d.emit("offer",e),b(null,e))},function(a){d.emit("error",a);b(a)})},function(a){d.emit("error",a);b(a)},h)};d.prototype.handleOffer=function(a,b){b=b||function(){};var d=this;a.type="offer";if(a.jingle){this.enableChromeNativeSimulcast&&a.jingle.contents.forEach(function(a){"video"===a.name&&(a.application.googConferenceFlag=!0)});this.enableMultiStreamHacks&&
a.jingle.contents.forEach(function(a){if("video"===a.name){var b=a.application.sources||[];if(0===b.length||"3735928559"!==b[0].ssrc)b.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),a.application.sources=b}});if(0<d.restrictBandwidth&&2<=a.jingle.contents.length&&"video"===a.jingle.contents[1].name){var e=a.jingle.contents[1];e.application&&e.application.bandwidth&&e.application.bandwidth.bandwidth||(a.jingle.contents[1].application.bandwidth=
{type:"AS",bandwidth:d.restrictBandwidth.toString()},a.sdp=c.toSessionSDP(a.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"outgoing"}))}a.jingle.contents.forEach(function(a){var b=a.transport||{};b.ufrag&&(d.iceCredentials.remote[a.name]={ufrag:b.ufrag,pwd:b.pwd})});a.sdp=c.toSessionSDP(a.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"incoming"});d.remoteDescription=a.jingle}a.sdp.split("\r\n").forEach(function(a){0===a.indexOf("a=candidate:")&&d._checkRemoteCandidate(a)});
d.pc.setRemoteDescription(new RTCSessionDescription(a),function(){b()},b)};d.prototype.answerAudioOnly=function(a){this._answer({mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},a)};d.prototype.answerBroadcastOnly=function(a){this._answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},a)};d.prototype.answer=function(a,b){var d=2===arguments.length;this._answer(d&&a?a:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},d?b:a)};d.prototype.handleAnswer=function(a,b){b=
b||function(){};var d=this;a.jingle&&(a.sdp=c.toSessionSDP(a.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"incoming"}),d.remoteDescription=a.jingle,a.jingle.contents.forEach(function(a){var b=a.transport||{};b.ufrag&&(d.iceCredentials.remote[a.name]={ufrag:b.ufrag,pwd:b.pwd})}));a.sdp.split("\r\n").forEach(function(a){0===a.indexOf("a=candidate:")&&d._checkRemoteCandidate(a)});d.pc.setRemoteDescription(new RTCSessionDescription(a),function(){d.wtFirefox&&window.setTimeout(function(){d.firefoxcandidatebuffer.forEach(function(a){d.pc.addIceCandidate(new RTCIceCandidate(a),
function(){},function(a){d.emit("error",a)});d._checkRemoteCandidate(a.candidate)});d.firefoxcandidatebuffer=null},d.wtFirefox);b(null)},b)};d.prototype.close=function(){this.pc.close();this._localDataChannels=[];this._remoteDataChannels=[];this.emit("close")};d.prototype._answer=function(a,b){b=b||function(){};var d=this;if(!this.pc.remoteDescription)throw Error("remoteDescription not set");if("closed"===this.pc.signalingState)return b("Already closed");d.pc.createAnswer(function(a){var e=[];if(d.enableChromeNativeSimulcast&&
(a.jingle=c.toSessionJSON(a.sdp,{role:d._role(),direction:"outgoing"}),2<=a.jingle.contents.length&&"video"===a.jingle.contents[1].name)){var h=a.jingle.contents[1].application.sourceGroups||[],k=!1;h.forEach(function(a){"SIM"==a.semantics&&(k=!0)});if(!k&&a.jingle.contents[1].application.sources.length){var g=JSON.parse(JSON.stringify(a.jingle.contents[1].application.sources[0]));g.ssrc=""+Math.floor(4294967295*Math.random());a.jingle.contents[1].application.sources.push(g);e.push(a.jingle.contents[1].application.sources[0].ssrc);
e.push(g.ssrc);h.push({semantics:"SIM",sources:e});e=JSON.parse(JSON.stringify(g));e.ssrc=""+Math.floor(4294967295*Math.random());a.jingle.contents[1].application.sources.push(e);h.push({semantics:"FID",sources:[g.ssrc,e.ssrc]});a.jingle.contents[1].application.sourceGroups=h;a.sdp=c.toSessionSDP(a.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"outgoing"})}}var n={type:"answer",sdp:a.sdp};d.assumeSetLocalSuccess&&(h=f(n),d.emit("answer",h),b(null,h));d._candidateBuffer=[];d.pc.setLocalDescription(a,
function(){if(d.config.useJingle){var e=c.toSessionJSON(a.sdp,{role:d._role(),direction:"outgoing"});e.sid=d.config.sid;d.localDescription=e;n.jingle=e}d.enableChromeNativeSimulcast&&(n.jingle||(n.jingle=c.toSessionJSON(a.sdp,{role:d._role(),direction:"outgoing"})),n.jingle.contents[1].application.sources.forEach(function(a,b){a.parameters=a.parameters.map(function(a){"msid"===a.key&&(a.value+="-"+Math.floor(b/2));return a})}),n.sdp=c.toSessionSDP(n.jingle,{sid:d.sdpSessionID,role:d._role(),direction:"outgoing"}));
n.sdp.split("\r\n").forEach(function(a){0===a.indexOf("a=candidate:")&&d._checkLocalCandidate(a)});d.assumeSetLocalSuccess||(e=f(n),d.emit("answer",e),b(null,e))},function(a){d.emit("error",a);b(a)})},function(a){d.emit("error",a);b(a)},a)};d.prototype._onIce=function(a){var b=this;if(a.candidate){if(!this.dontSignalCandidates){a=a.candidate;var d={candidate:{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex}};this._checkLocalCandidate(a.candidate);var e=c.toCandidateJSON(a.candidate);
if(this.eliminateDuplicateCandidates&&"relay"===e.type){var h=this._candidateBuffer.filter(function(a){return"relay"===a.type}).map(function(a){return a.foundation+":"+a.component});var k=h.indexOf(e.foundation+":"+e.component);if(-1<k&&e.priority>>24>=h[k].priority>>24)return}if("max-bundle"===this.config.bundlePolicy&&(h=this._candidateBuffer.filter(function(a){return e.type===a.type}).map(function(a){return a.address+":"+a.port}),k=h.indexOf(e.address+":"+e.port),-1<k))return;if("require"!==this.config.rtcpMuxPolicy||
"2"!==e.component){this._candidateBuffer.push(e);if(b.config.useJingle&&(a.sdpMid||(a.sdpMid=b.pc.remoteDescription&&"offer"===b.pc.remoteDescription.type?b.remoteDescription.contents[a.sdpMLineIndex].name:b.localDescription.contents[a.sdpMLineIndex].name),b.iceCredentials.local[a.sdpMid]||c.toSessionJSON(b.pc.localDescription.sdp,{role:b._role(),direction:"outgoing"}).contents.forEach(function(a){var d=a.transport||{};d.ufrag&&(b.iceCredentials.local[a.name]={ufrag:d.ufrag,pwd:d.pwd})}),d.jingle=
{contents:[{name:a.sdpMid,creator:b._role(),transport:{transportType:"iceUdp",ufrag:b.iceCredentials.local[a.sdpMid].ufrag,pwd:b.iceCredentials.local[a.sdpMid].pwd,candidates:[e]}}]},0<b.batchIceCandidates)){0===b.batchedIceCandidates.length&&window.setTimeout(function(){var a={};b.batchedIceCandidates.forEach(function(b){b=b.contents[0];a[b.name]||(a[b.name]=b);a[b.name].transport.candidates.push(b.transport.candidates[0])});var d={jingle:{contents:[]}};Object.keys(a).forEach(function(b){d.jingle.contents.push(a[b])});
b.batchedIceCandidates=[];b.emit("ice",d)},b.batchIceCandidates);b.batchedIceCandidates.push(d.jingle);return}this.emit("ice",d)}}}else this.emit("endOfCandidates")};d.prototype._onDataChannel=function(a){a=a.channel;this._remoteDataChannels.push(a);this.emit("addChannel",a)};d.prototype.createDataChannel=function(a,b){a=this.pc.createDataChannel(a,b);this._localDataChannels.push(a);return a};d.prototype.getStats=function(){if("function"===typeof arguments[0]){var a=arguments[0];this.pc.getStats().then(function(b){a(null,
b)},function(b){a(b)})}else return this.pc.getStats.apply(this.pc,arguments)};e.exports=d},{"lodash.clonedeep":36,"sdp-jingle-json":45,util:63,wildemitter:65}],45:[function(a,e,b){var d=a("./lib/tosdp"),c=a("./lib/tojson");b.toIncomingSDPOffer=function(a){return d.toSessionSDP(a,{role:"responder",direction:"incoming"})};b.toOutgoingSDPOffer=function(a){return d.toSessionSDP(a,{role:"initiator",direction:"outgoing"})};b.toIncomingSDPAnswer=function(a){return d.toSessionSDP(a,{role:"initiator",direction:"incoming"})};
b.toOutgoingSDPAnswer=function(a){return d.toSessionSDP(a,{role:"responder",direction:"outgoing"})};b.toIncomingMediaSDPOffer=function(a){return d.toMediaSDP(a,{role:"responder",direction:"incoming"})};b.toOutgoingMediaSDPOffer=function(a){return d.toMediaSDP(a,{role:"initiator",direction:"outgoing"})};b.toIncomingMediaSDPAnswer=function(a){return d.toMediaSDP(a,{role:"initiator",direction:"incoming"})};b.toOutgoingMediaSDPAnswer=function(a){return d.toMediaSDP(a,{role:"responder",direction:"outgoing"})};
b.toCandidateSDP=d.toCandidateSDP;b.toMediaSDP=d.toMediaSDP;b.toSessionSDP=d.toSessionSDP;b.toIncomingJSONOffer=function(a,b){return c.toSessionJSON(a,{role:"responder",direction:"incoming",creators:b})};b.toOutgoingJSONOffer=function(a,b){return c.toSessionJSON(a,{role:"initiator",direction:"outgoing",creators:b})};b.toIncomingJSONAnswer=function(a,b){return c.toSessionJSON(a,{role:"initiator",direction:"incoming",creators:b})};b.toOutgoingJSONAnswer=function(a,b){return c.toSessionJSON(a,{role:"responder",
direction:"outgoing",creators:b})};b.toIncomingMediaJSONOffer=function(a,b){return c.toMediaJSON(a,{role:"responder",direction:"incoming",creator:b})};b.toOutgoingMediaJSONOffer=function(a,b){return c.toMediaJSON(a,{role:"initiator",direction:"outgoing",creator:b})};b.toIncomingMediaJSONAnswer=function(a,b){return c.toMediaJSON(a,{role:"initiator",direction:"incoming",creator:b})};b.toOutgoingMediaJSONAnswer=function(a,b){return c.toMediaJSON(a,{role:"responder",direction:"outgoing",creator:b})};
b.toCandidateJSON=c.toCandidateJSON;b.toMediaJSON=c.toMediaJSON;b.toSessionJSON=c.toSessionJSON},{"./lib/tojson":48,"./lib/tosdp":49}],46:[function(a,e,b){b.lines=function(a){return a.split("\r\n").filter(function(a){return 0<a.length})};b.findLine=function(a,b,e){for(var d=a.length,c=0;c<b.length;c++)if(b[c].substr(0,d)===a)return b[c];if(!e)return!1;for(b=0;b<e.length;b++)if(e[b].substr(0,d)===a)return e[b];return!1};b.findLines=function(a,b,e){for(var d=[],c=a.length,h=0;h<b.length;h++)b[h].substr(0,
c)===a&&d.push(b[h]);if(d.length||!e)return d;for(b=0;b<e.length;b++)e[b].substr(0,c)===a&&d.push(e[b]);return d};b.mline=function(a){a=a.substr(2).split(" ");for(var b={media:a[0],port:a[1],proto:a[2],formats:[]},d=3;d<a.length;d++)a[d]&&b.formats.push(a[d]);return b};b.rtpmap=function(a){a=a.substr(9).split(" ");var b={id:a.shift()};a=a[0].split("/");b.name=a[0];b.clockrate=a[1];b.channels=3==a.length?a[2]:"1";return b};b.sctpmap=function(a){a=a.substr(10).split(" ");return{number:a.shift(),protocol:a.shift(),
streams:a.shift()}};b.fmtp=function(a){for(var b,d=a.substr(a.indexOf(" ")+1).split(";"),e=[],c=0;c<d.length;c++)b=d[c].split("="),a=b[0].trim(),b=b[1],a&&b?e.push({key:a,value:b}):a&&e.push({key:"",value:a});return e};b.crypto=function(a){a=a.substr(9).split(" ");return{tag:a[0],cipherSuite:a[1],keyParams:a[2],sessionParams:a.slice(3).join(" ")}};b.fingerprint=function(a){a=a.substr(14).split(" ");return{hash:a[0],value:a[1]}};b.extmap=function(a){a=a.substr(9).split(" ");var b={},d=a.shift(),e=
d.indexOf("/");0<=e?(b.id=d.substr(0,e),b.senders=d.substr(e+1)):(b.id=d,b.senders="sendrecv");b.uri=a.shift()||"";return b};b.rtcpfb=function(a){a=a.substr(10).split(" ");var b={};b.id=a.shift();b.type=a.shift();"trr-int"===b.type?b.value=a.shift():b.subtype=a.shift()||"";b.parameters=a;return b};b.candidate=function(a){a=0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var b={foundation:a[0],component:a[1],protocol:a[2].toLowerCase(),priority:a[3],ip:a[4],
port:a[5],type:a[7],generation:"0"},d=8;d<a.length;d+=2)"raddr"===a[d]?b.relAddr=a[d+1]:"rport"===a[d]?b.relPort=a[d+1]:"generation"===a[d]?b.generation=a[d+1]:"tcptype"===a[d]&&(b.tcpType=a[d+1]);b.network="1";return b};b.sourceGroups=function(a){for(var b=[],d=0;d<a.length;d++){var e=a[d].substr(13).split(" ");b.push({semantics:e.shift(),sources:e})}return b};b.sources=function(a){for(var b=[],d={},e=0;e<a.length;e++){var c=a[e].substr(7).split(" "),f=c.shift();if(!d[f]){var g={ssrc:f,parameters:[]};
b.push(g);d[f]=g}c=c.join(" ").split(":");g=c.shift();c=c.join(":")||null;d[f].parameters.push({key:g,value:c})}return b};b.groups=function(a){for(var b=[],d,e=0;e<a.length;e++)d=a[e].substr(8).split(" "),b.push({semantics:d.shift(),contents:d});return b};b.bandwidth=function(a){a=a.substr(2).split(":");var b={};b.type=a.shift();b.bandwidth=a.shift();return b};b.msid=function(a){a=a.substr(7);var b=a.split(" ");return{msid:a,mslabel:b[0],label:b[1]}}},{}],47:[function(a,e,b){e.exports={initiator:{incoming:{initiator:"recvonly",
responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",
both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],48:[function(a,e,b){var d=a("./senders"),c=a("./parsers"),f=Math.random();b._setIdCounter=function(a){f=a};b.toSessionJSON=function(a,d){var e,f=d.creators||[],h=d.role||"initiator";d=d.direction||"outgoing";var k=a.split("\r\nm=");for(e=1;e<k.length;e++)k[e]="m="+k[e],e!==k.length-1&&(k[e]+="\r\n");var g=k.shift()+"\r\n",n=c.lines(g);a={};var C=[];for(e=0;e<k.length;e++)C.push(b.toMediaJSON(k[e],
g,{role:h,direction:d,creator:f[e]||"initiator"}));a.contents=C;f=c.findLines("a=group:",n);f.length&&(a.groups=c.groups(f));return a};b.toMediaJSON=function(a,e,f){var k=f.creator||"initiator",h=f.role||"initiator",g=f.direction||"outgoing",w=c.lines(a);a=c.lines(e);e=c.mline(w[0]);k={creator:k,name:e.media,application:{applicationType:"rtp",media:e.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==e.media&&
(k.application={applicationType:"datachannel"},k.transport.sctp=[]);var n=k.application,C=k.transport;if(e=c.findLine("a=mid:",w))k.name=e.substr(6);c.findLine("a=sendrecv",w,a)?k.senders="both":c.findLine("a=sendonly",w,a)?k.senders=d[h][g].sendonly:c.findLine("a=recvonly",w,a)?k.senders=d[h][g].recvonly:c.findLine("a=inactive",w,a)&&(k.senders="none");if("rtp"==n.applicationType){if(e=c.findLine("b=",w))n.bandwidth=c.bandwidth(e);if(e=c.findLine("a=ssrc:",w))n.ssrc=e.substr(7).split(" ")[0];c.findLines("a=rtpmap:",
w).forEach(function(a){var b=c.rtpmap(a);b.parameters=[];b.feedback=[];c.findLines("a=fmtp:"+b.id,w).forEach(function(a){b.parameters=c.fmtp(a)});c.findLines("a=rtcp-fb:"+b.id,w).forEach(function(a){b.feedback.push(c.rtcpfb(a))});n.payloads.push(b)});c.findLines("a=crypto:",w,a).forEach(function(a){n.encryption.push(c.crypto(a))});c.findLine("a=rtcp-mux",w)&&(n.mux=!0);c.findLines("a=rtcp-fb:*",w).forEach(function(a){n.feedback.push(c.rtcpfb(a))});c.findLines("a=extmap:",w).forEach(function(a){a=
c.extmap(a);a.senders=d[h][g][a.senders];n.headerExtensions.push(a)});e=c.findLines("a=ssrc-group:",w);n.sourceGroups=c.sourceGroups(e||[]);e=c.findLines("a=ssrc:",w);var l=n.sources=c.sources(e||[]);if(e=c.findLine("a=msid:",w)){var m=c.msid(e);["msid","mslabel","label"].forEach(function(a){for(var b=0;b<l.length;b++){for(var d=!1,e=0;e<l[b].parameters.length;e++)l[b].parameters[e].key===a&&(d=!0);d||l[b].parameters.push({key:a,value:m[a]})}})}c.findLine("a=x-google-flag:conference",w,a)&&(n.googConferenceFlag=
!0)}e=c.findLines("a=fingerprint:",w,a);var p=c.findLine("a=setup:",w,a);e.forEach(function(a){a=c.fingerprint(a);p&&(a.setup=p.substr(8));C.fingerprints.push(a)});e=c.findLine("a=ice-ufrag:",w,a);f=c.findLine("a=ice-pwd:",w,a);e&&f&&(C.ufrag=e.substr(12),C.pwd=f.substr(10),C.candidates=[],c.findLines("a=candidate:",w,a).forEach(function(a){C.candidates.push(b.toCandidateJSON(a))}));"datachannel"==n.applicationType&&c.findLines("a=sctpmap:",w).forEach(function(a){a=c.sctpmap(a);C.sctp.push(a)});return k};
b.toCandidateJSON=function(a){a=c.candidate(a.split("\r\n")[0]);a.id=(f++).toString(36).substr(0,12);return a}},{"./parsers":46,"./senders":47}],49:[function(a,e,b){var d=a("./senders");b.toSessionSDP=function(a,d){var e=d.sid||a.sid||Date.now(),c=d.time||Date.now(),f=["v=0","o=- "+e+" "+c+" IN IP4 0.0.0.0","s=-","t=0 0"];e=a.contents||[];var k=!1;e.forEach(function(a){a.application.sources&&a.application.sources.length&&(k=!0)});k&&f.push("a=msid-semantic: WMS *");(a.groups||[]).forEach(function(a){f.push("a=group:"+
a.semantics+" "+a.contents.join(" "))});e.forEach(function(a){f.push(b.toMediaSDP(a,d))});return f.join("\r\n")+"\r\n"};b.toMediaSDP=function(a,e){var c=[],f=e.role||"initiator",k=e.direction||"outgoing",h=a.application;e=a.transport;var g=h.payloads||[],G=e&&e.fingerprints||[],w=[];"datachannel"==h.applicationType?(w.push("application"),w.push("1"),w.push("DTLS/SCTP"),e.sctp&&e.sctp.forEach(function(a){w.push(a.number)})):(w.push(h.media),w.push("1"),0<G.length?w.push("UDP/TLS/RTP/SAVPF"):h.encryption&&
0<h.encryption.length?w.push("RTP/SAVPF"):w.push("RTP/AVPF"),g.forEach(function(a){w.push(a.id)}));c.push("m="+w.join(" "));c.push("c=IN IP4 0.0.0.0");h.bandwidth&&h.bandwidth.type&&h.bandwidth.bandwidth&&c.push("b="+h.bandwidth.type+":"+h.bandwidth.bandwidth);"rtp"==h.applicationType&&c.push("a=rtcp:1 IN IP4 0.0.0.0");e&&(e.ufrag&&c.push("a=ice-ufrag:"+e.ufrag),e.pwd&&c.push("a=ice-pwd:"+e.pwd),G.forEach(function(a){c.push("a=fingerprint:"+a.hash+" "+a.value);a.setup&&c.push("a=setup:"+a.setup)}),
e.sctp&&e.sctp.forEach(function(a){c.push("a=sctpmap:"+a.number+" "+a.protocol+" "+a.streams)}));"rtp"==h.applicationType&&c.push("a="+(d[f][k][a.senders]||"sendrecv"));c.push("a=mid:"+a.name);h.sources&&h.sources.length&&(h.sources[0].parameters||[]).forEach(function(a){"msid"===a.key&&c.push("a=msid:"+a.value)});h.mux&&c.push("a=rtcp-mux");(h.encryption||[]).forEach(function(a){c.push("a=crypto:"+a.tag+" "+a.cipherSuite+" "+a.keyParams+(a.sessionParams?" "+a.sessionParams:""))});h.googConferenceFlag&&
c.push("a=x-google-flag:conference");g.forEach(function(a){var b="a=rtpmap:"+a.id+" "+a.name+"/"+a.clockrate;a.channels&&"1"!=a.channels&&(b+="/"+a.channels);c.push(b);if(a.parameters&&a.parameters.length){b=["a=fmtp:"+a.id];var d=[];a.parameters.forEach(function(a){d.push((a.key?a.key+"=":"")+a.value)});b.push(d.join(";"));c.push(b.join(" "))}a.feedback&&a.feedback.forEach(function(b){"trr-int"===b.type?c.push("a=rtcp-fb:"+a.id+" trr-int "+(b.value?b.value:"0")):c.push("a=rtcp-fb:"+a.id+" "+b.type+
(b.subtype?" "+b.subtype:""))})});h.feedback&&h.feedback.forEach(function(a){"trr-int"===a.type?c.push("a=rtcp-fb:* trr-int "+(a.value?a.value:"0")):c.push("a=rtcp-fb:* "+a.type+(a.subtype?" "+a.subtype:""))});(h.headerExtensions||[]).forEach(function(a){c.push("a=extmap:"+a.id+(a.senders?"/"+d[f][k][a.senders]:"")+" "+a.uri)});(h.sourceGroups||[]).forEach(function(a){c.push("a=ssrc-group:"+a.semantics+" "+a.sources.join(" "))});(h.sources||[]).forEach(function(a){for(var b=0;b<a.parameters.length;b++){var d=
a.parameters[b];c.push("a=ssrc:"+(a.ssrc||h.ssrc)+" "+d.key+(d.value?":"+d.value:""))}});(e.candidates||[]).forEach(function(a){c.push(b.toCandidateSDP(a))});return c.join("\r\n")};b.toCandidateSDP=function(a){var b=[];b.push(a.foundation);b.push(a.component);b.push(a.protocol.toUpperCase());b.push(a.priority);b.push(a.ip);b.push(a.port);var d=a.type;b.push("typ");b.push(d);("srflx"===d||"prflx"===d||"relay"===d)&&a.relAddr&&a.relPort&&(b.push("raddr"),b.push(a.relAddr),b.push("rport"),b.push(a.relPort));
a.tcpType&&"TCP"==a.protocol.toUpperCase()&&(b.push("tcptype"),b.push(a.tcpType));b.push("generation");b.push(a.generation||"0");return"a=candidate:"+b.join(" ")}},{"./senders":47}],50:[function(a,e,b){e.exports=a("./lib/")},{"./lib/":51}],51:[function(a,e,b){function d(a,b){"object"==typeof a&&(b=a,a=void 0);b=b||{};a=c(a);var d=a.source,e=a.id;b.forceNew||b["force new connection"]||!1===b.multiplex?(n("ignoring socket cache for %s",d),b=g(d,b)):(l[e]||(n("new io instance for %s",d),l[e]=g(d,b)),
b=l[e]);return b.socket(a.path)}var c=a("./url"),f=a("socket.io-parser"),g=a("./manager"),n=a("debug")("socket.io-client");e.exports=b=d;var l=b.managers={};b.protocol=f.protocol;b.connect=d;b.Manager=a("./manager");b.Socket=a("./socket")},{"./manager":52,"./socket":54,"./url":55,debug:10,"socket.io-parser":57}],52:[function(a,e,b){function d(a,b){if(!(this instanceof d))return new d(a,b);a&&"object"==typeof a&&(b=a,a=void 0);b=b||{};b.path=b.path||"/socket.io";this.nsps={};this.subs=[];this.opts=
b;this.reconnection(!1!==b.reconnection);this.reconnectionAttempts(b.reconnectionAttempts||Infinity);this.reconnectionDelay(b.reconnectionDelay||1E3);this.reconnectionDelayMax(b.reconnectionDelayMax||5E3);this.randomizationFactor(b.randomizationFactor||.5);this.backoff=new G({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==b.timeout?2E4:b.timeout);this.readyState="closed";this.uri=a;this.connected=[];this.encoding=!1;this.packetBuffer=
[];this.encoder=new g.Encoder;this.decoder=new g.Decoder;(this.autoConnect=!1!==b.autoConnect)&&this.open()}a("./url");var c=a("engine.io-client"),f=a("./socket");b=a("component-emitter");var g=a("socket.io-parser"),n=a("./on"),l=a("component-bind");a("object-component");var u=a("debug")("socket.io-client:manager"),x=a("indexof"),G=a("backo2");e.exports=d;d.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var a in this.nsps)this.nsps[a].emit.apply(this.nsps[a],arguments)};d.prototype.updateSocketIds=
function(){for(var a in this.nsps)this.nsps[a].id=this.engine.id};b(d.prototype);d.prototype.reconnection=function(a){if(!arguments.length)return this._reconnection;this._reconnection=!!a;return this};d.prototype.reconnectionAttempts=function(a){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=a;return this};d.prototype.reconnectionDelay=function(a){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=a;this.backoff&&this.backoff.setMin(a);return this};
d.prototype.randomizationFactor=function(a){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=a;this.backoff&&this.backoff.setJitter(a);return this};d.prototype.reconnectionDelayMax=function(a){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=a;this.backoff&&this.backoff.setMax(a);return this};d.prototype.timeout=function(a){if(!arguments.length)return this._timeout;this._timeout=a;return this};d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&
this._reconnection&&0===this.backoff.attempts&&this.reconnect()};d.prototype.open=d.prototype.connect=function(a){u("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;u("opening %s",this.uri);var b=this.engine=c(this.uri,this.opts),d=this;this.readyState="opening";this.skipReconnect=!1;var e=n(b,"open",function(){d.onopen();a&&a()}),f=n(b,"error",function(b){u("connect_error");d.cleanup();d.readyState="closed";d.emitAll("connect_error",b);if(a){var e=Error("Connection error");
e.data=b;a(e)}else d.maybeReconnectOnOpen()});if(!1!==this._timeout){var h=this._timeout;u("connect attempt will timeout after %d",h);var k=setTimeout(function(){u("connect attempt timed out after %d",h);e.destroy();b.close();b.emit("error","timeout");d.emitAll("connect_timeout",h)},h);this.subs.push({destroy:function(){clearTimeout(k)}})}this.subs.push(e);this.subs.push(f);return this};d.prototype.onopen=function(){u("open");this.cleanup();this.readyState="open";this.emit("open");var a=this.engine;
this.subs.push(n(a,"data",l(this,"ondata")));this.subs.push(n(this.decoder,"decoded",l(this,"ondecoded")));this.subs.push(n(a,"error",l(this,"onerror")));this.subs.push(n(a,"close",l(this,"onclose")))};d.prototype.ondata=function(a){this.decoder.add(a)};d.prototype.ondecoded=function(a){this.emit("packet",a)};d.prototype.onerror=function(a){u("error",a);this.emitAll("error",a)};d.prototype.socket=function(a){var b=this.nsps[a];if(!b){b=new f(this,a);this.nsps[a]=b;var d=this;b.on("connect",function(){b.id=
d.engine.id;~x(d.connected,b)||d.connected.push(b)})}return b};d.prototype.destroy=function(a){a=x(this.connected,a);~a&&this.connected.splice(a,1);this.connected.length||this.close()};d.prototype.packet=function(a){u("writing packet %j",a);var b=this;b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(a){for(var d=0;d<a.length;d++)b.engine.write(a[d]);b.encoding=!1;b.processPacketQueue()}))};d.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var a=
this.packetBuffer.shift();this.packet(a)}};d.prototype.cleanup=function(){for(var a;a=this.subs.shift();)a.destroy();this.packetBuffer=[];this.encoding=!1;this.decoder.destroy()};d.prototype.close=d.prototype.disconnect=function(){this.skipReconnect=!0;this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};d.prototype.onclose=function(a){u("close");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",a);this._reconnection&&!this.skipReconnect&&this.reconnect()};
d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();u("will wait %dms before reconnect attempt",b);this.reconnecting=!0;var d=setTimeout(function(){a.skipReconnect||(u("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),
a.skipReconnect||a.open(function(b){b?(u("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(u("reconnect success"),a.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(d)}})}};d.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",a)}},{"./on":53,"./socket":54,"./url":55,backo2:4,"component-bind":7,"component-emitter":8,debug:10,"engine.io-client":11,
indexof:32,"object-component":39,"socket.io-parser":57}],53:[function(a,e,b){e.exports=function(a,b,e){a.on(b,e);return{destroy:function(){a.removeListener(b,e)}}}},{}],54:[function(a,e,b){function d(a,b){this.io=a;this.nsp=b;this.json=this;this.ids=0;this.acks={};this.io.autoConnect&&this.open();this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0}var c=a("socket.io-parser");b=a("component-emitter");var f=a("to-array"),g=a("./on"),n=a("component-bind"),l=a("debug")("socket.io-client:socket"),
u=a("has-binary");e.exports=d;var x={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},G=b.prototype.emit;b(d.prototype);d.prototype.subEvents=function(){if(!this.subs){var a=this.io;this.subs=[g(a,"open",n(this,"onopen")),g(a,"packet",n(this,"onpacket")),g(a,"close",n(this,"onclose"))]}};d.prototype.open=d.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==
this.io.readyState)this.onopen();return this};d.prototype.send=function(){var a=f(arguments);a.unshift("message");this.emit.apply(this,a);return this};d.prototype.emit=function(a){if(x.hasOwnProperty(a))return G.apply(this,arguments),this;var b=f(arguments),d=c.EVENT;u(b)&&(d=c.BINARY_EVENT);d={type:d,data:b};"function"==typeof b[b.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),d.id=this.ids++);this.connected?this.packet(d):this.sendBuffer.push(d);return this};
d.prototype.packet=function(a){a.nsp=this.nsp;this.io.packet(a)};d.prototype.onopen=function(){l("transport is open - connecting");"/"!=this.nsp&&this.packet({type:c.CONNECT})};d.prototype.onclose=function(a){l("close (%s)",a);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",a)};d.prototype.onpacket=function(a){if(a.nsp==this.nsp)switch(a.type){case c.CONNECT:this.onconnect();break;case c.EVENT:this.onevent(a);break;case c.BINARY_EVENT:this.onevent(a);break;case c.ACK:this.onack(a);
break;case c.BINARY_ACK:this.onack(a);break;case c.DISCONNECT:this.ondisconnect();break;case c.ERROR:this.emit("error",a.data)}};d.prototype.onevent=function(a){var b=a.data||[];l("emitting event %j",b);null!=a.id&&(l("attaching ack callback to event"),b.push(this.ack(a.id)));this.connected?G.apply(this,b):this.receiveBuffer.push(b)};d.prototype.ack=function(a){var b=this,d=!1;return function(){if(!d){d=!0;var e=f(arguments);l("sending ack %j",e);var h=u(e)?c.BINARY_ACK:c.ACK;b.packet({type:h,id:a,
data:e})}}};d.prototype.onack=function(a){l("calling ack %s with %j",a.id,a.data);this.acks[a.id].apply(this,a.data);delete this.acks[a.id]};d.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};d.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)G.apply(this,this.receiveBuffer[a]);this.receiveBuffer=[];for(a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);this.sendBuffer=[]};d.prototype.ondisconnect=
function(){l("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};d.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)};d.prototype.close=d.prototype.disconnect=function(){this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:c.DISCONNECT}));this.destroy();if(this.connected)this.onclose("io client disconnect");return this}},{"./on":53,"component-bind":7,"component-emitter":8,
debug:10,"has-binary":30,"socket.io-parser":57,"to-array":59}],55:[function(a,e,b){(function(b){var d=a("parseuri"),c=a("debug")("socket.io-client:url");e.exports=function(a,e){var f=a;e=e||b.location;null==a&&(a=e.protocol+"//"+e.host);"string"==typeof a&&("/"==a.charAt(0)&&(a="/"==a.charAt(1)?e.protocol+a:e.hostname+a),/^(https?|wss?):\/\//.test(a)||(c("protocol-less url %s",a),a="undefined"!=typeof e?e.protocol+"//"+a:"https://"+a),c("parse %s",a),f=d(a));f.port||(/^(http|ws)$/.test(f.protocol)?
f.port="80":/^(http|ws)s$/.test(f.protocol)&&(f.port="443"));f.path=f.path||"/";f.id=f.protocol+"://"+f.host+":"+f.port;f.href=f.protocol+"://"+f.host+(e&&e.port==f.port?"":":"+f.port);return f}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{debug:10,parseuri:42}],56:[function(a,e,b){(function(d){var e=a("isarray"),c=a("./is-buffer");b.deconstructPacket=function(a){function b(a){if(!a)return a;if(c(a)){var f={_placeholder:!0,
num:d.length};d.push(a);return f}if(e(a)){f=Array(a.length);for(var h=0;h<a.length;h++)f[h]=b(a[h]);return f}if("object"==typeof a&&!(a instanceof Date)){f={};for(h in a)f[h]=b(a[h]);return f}return a}var d=[];a.data=b(a.data);a.attachments=d.length;return{packet:a,buffers:d}};b.reconstructPacket=function(a,b){function d(a){if(a&&a._placeholder)return b[a.num];if(e(a))for(var c=0;c<a.length;c++)a[c]=d(a[c]);else if(a&&"object"==typeof a)for(c in a)a[c]=d(a[c]);return a}a.data=d(a.data);a.attachments=
void 0;return a};b.removeBlobs=function(a,b){function f(a,g,n){if(!a)return a;if(d.Blob&&a instanceof Blob||d.File&&a instanceof File){h++;var u=new FileReader;u.onload=function(){n?n[g]=this.result:k=this.result;--h||b(k)};u.readAsArrayBuffer(a)}else if(e(a))for(u=0;u<a.length;u++)f(a[u],u,a);else if(a&&"object"==typeof a&&!c(a))for(u in a)f(a[u],u,a)}var h=0,k=a;f(k);h||b(k)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./is-buffer":58,
isarray:33}],57:[function(a,e,b){function d(){}function c(a){var d=!1;var e=""+a.type;if(b.BINARY_EVENT==a.type||b.BINARY_ACK==a.type)e+=a.attachments,e+="-";a.nsp&&"/"!=a.nsp&&(d=!0,e+=a.nsp);null!=a.id&&(d&&(e+=",",d=!1),e+=a.id);null!=a.data&&(d&&(e+=","),e+=u.stringify(a.data));l("encoded %j as %s",a,e);return e}function f(a,b){x.removeBlobs(a,function(a){var d=x.deconstructPacket(a);a=c(d.packet);d=d.buffers;d.unshift(a);b(d)})}function g(){this.reconstructor=null}function n(a){this.reconPack=
a;this.buffers=[]}var l=a("debug")("socket.io-parser"),u=a("json3");a("isarray");e=a("component-emitter");var x=a("./binary"),m=a("./is-buffer");b.protocol=4;b.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" ");b.CONNECT=0;b.DISCONNECT=1;b.EVENT=2;b.ACK=3;b.ERROR=4;b.BINARY_EVENT=5;b.BINARY_ACK=6;b.Encoder=d;b.Decoder=g;d.prototype.encode=function(a,d){l("encoding packet %j",a);b.BINARY_EVENT==a.type||b.BINARY_ACK==a.type?f(a,d):(a=c(a),d([a]))};e(g.prototype);g.prototype.add=
function(a){if("string"==typeof a){a:{var d={},e=0;d.type=Number(a.charAt(0));if(null==b.types[d.type])a={type:b.ERROR,data:"parser error"};else{if(b.BINARY_EVENT==d.type||b.BINARY_ACK==d.type){for(var c="";"-"!=a.charAt(++e)&&(c+=a.charAt(e),e!=a.length););if(c!=Number(c)||"-"!=a.charAt(e))throw Error("Illegal attachments");d.attachments=Number(c)}if("/"==a.charAt(e+1))for(d.nsp="";++e;){c=a.charAt(e);if(","==c)break;d.nsp+=c;if(e==a.length)break}else d.nsp="/";c=a.charAt(e+1);if(""!==c&&Number(c)==
c){for(d.id="";++e;){c=a.charAt(e);if(null==c||Number(c)!=c){--e;break}d.id+=a.charAt(e);if(e==a.length)break}d.id=Number(d.id)}if(a.charAt(++e))try{d.data=u.parse(a.substr(e))}catch(Pc){a={type:b.ERROR,data:"parser error"};break a}l("decoded %s as %j",a,d);a=d}}b.BINARY_EVENT==a.type||b.BINARY_ACK==a.type?(this.reconstructor=new n(a),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",a)):this.emit("decoded",a)}else if(m(a)||a.base64)if(this.reconstructor){if(a=this.reconstructor.takeBinaryData(a))this.reconstructor=
null,this.emit("decoded",a)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+a);};g.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};n.prototype.takeBinaryData=function(a){this.buffers.push(a);return this.buffers.length==this.reconPack.attachments?(a=x.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),a):null};n.prototype.finishedReconstruction=function(){this.reconPack=null;
this.buffers=[]}},{"./binary":56,"./is-buffer":58,"component-emitter":8,debug:10,isarray:33,json3:34}],58:[function(a,e,b){(function(a){e.exports=function(b){return a.Buffer&&a.Buffer.isBuffer(b)||a.ArrayBuffer&&b instanceof ArrayBuffer}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],59:[function(a,e,b){e.exports=function(a,b){for(var d=[],e=(b=b||0)||0;e<a.length;e++)d[e-b]=a[e];return d}},{}],60:[function(a,e,b){(function(a){(function(d){function c(a){for(var b=
[],d=0,e=a.length,c,f;d<e;)c=a.charCodeAt(d++),55296<=c&&56319>=c&&d<e?(f=a.charCodeAt(d++),56320==(f&64512)?b.push(((c&1023)<<10)+(f&1023)+65536):(b.push(c),d--)):b.push(c);return b}function f(a){if(55296<=a&&57343>=a)throw Error("Lone surrogate U+"+a.toString(16).toUpperCase()+" is not a scalar value");}function h(){if(v>=t)throw Error("Invalid byte index");var a=q[v]&255;v++;if(128==(a&192))return a&63;throw Error("Invalid continuation byte");}function g(){if(v>t)throw Error("Invalid byte index");
if(v==t)return!1;var a=q[v]&255;v++;if(0==(a&128))return a;if(192==(a&224)){var b=h();a=(a&31)<<6|b;if(128<=a)return a;throw Error("Invalid continuation byte");}if(224==(a&240)){b=h();var d=h();a=(a&15)<<12|b<<6|d;if(2048<=a)return f(a),a;throw Error("Invalid continuation byte");}if(240==(a&248)){b=h();d=h();var e=h();a=(a&15)<<18|b<<12|d<<6|e;if(65536<=a&&1114111>=a)return a}throw Error("Invalid UTF-8 detected");}var u="object"==typeof b&&b,l="object"==typeof e&&e&&e.exports==u&&e,m="object"==typeof a&&
a;if(m.global===m||m.window===m)d=m;var p=String.fromCharCode,q,t,v;m={version:"2.0.0",encode:function(a){a=c(a);for(var b=a.length,d=-1,e,h="";++d<b;){e=a[d];if(0==(e&4294967168))e=p(e);else{var k="";0==(e&4294965248)?k=p(e>>6&31|192):0==(e&4294901760)?(f(e),k=p(e>>12&15|224),k+=p(e>>6&63|128)):0==(e&4292870144)&&(k=p(e>>18&7|240),k+=p(e>>12&63|128),k+=p(e>>6&63|128));e=k+=p(e&63|128)}h+=e}return h},decode:function(a){q=c(a);t=q.length;v=0;a=[];for(var b;!1!==(b=g());)a.push(b);b=a.length;for(var d=
-1,e,f="";++d<b;)e=a[d],65535<e&&(e-=65536,f+=p(e>>>10&1023|55296),e=56320|e&1023),f+=p(e);return f}};if(u&&!u.nodeType)if(l)l.exports=m;else{d={}.hasOwnProperty;for(var y in m)d.call(m,y)&&(u[y]=m[y])}else d.utf8=m})(this)}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],61:[function(a,e,b){e.exports="function"===typeof Object.create?function(a,b){a.super_=b;a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,
writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var d=function(){};d.prototype=b.prototype;a.prototype=new d;a.prototype.constructor=a}},{}],62:[function(a,e,b){e.exports=function(a){return a&&"object"===typeof a&&"function"===typeof a.copy&&"function"===typeof a.fill&&"function"===typeof a.readUInt8}},{}],63:[function(a,e,b){(function(d,e){function c(a,d){var e={seen:[],stylize:h};3<=arguments.length&&(e.depth=arguments[2]);4<=arguments.length&&(e.colors=arguments[3]);y(d)?e.showHidden=
d:d&&b._extend(e,d);A(e.showHidden)&&(e.showHidden=!1);A(e.depth)&&(e.depth=2);A(e.colors)&&(e.colors=!1);A(e.customInspect)&&(e.customInspect=!0);e.colors&&(e.stylize=f);return u(e,a,e.depth)}function f(a,b){return(b=c.styles[b])?"\u001b["+c.colors[b][0]+"m"+a+"\u001b["+c.colors[b][1]+"m":a}function h(a,b){return a}function g(a){var b={};a.forEach(function(a,d){b[a]=!0});return b}function u(a,d,e){if(a.customInspect&&d&&H(d.inspect)&&d.inspect!==b.inspect&&(!d.constructor||d.constructor.prototype!==
d)){var c=d.inspect(e,a);B(c)||(c=u(a,c,e));return c}if(c=l(a,d))return c;var f=Object.keys(d),h=g(f);a.showHidden&&(f=Object.getOwnPropertyNames(d));if(D(d)&&(0<=f.indexOf("message")||0<=f.indexOf("description")))return m(d);if(0===f.length){if(H(d))return a.stylize("[Function"+(d.name?": "+d.name:"")+"]","special");if(E(d))return a.stylize(RegExp.prototype.toString.call(d),"regexp");if(I(d))return a.stylize(Date.prototype.toString.call(d),"date");if(D(d))return m(d)}c="";var k=!1,n=["{","}"];v(d)&&
(k=!0,n=["[","]"]);H(d)&&(c=" [Function"+(d.name?": "+d.name:"")+"]");E(d)&&(c=" "+RegExp.prototype.toString.call(d));I(d)&&(c=" "+Date.prototype.toUTCString.call(d));D(d)&&(c=" "+m(d));if(0===f.length&&(!k||0==d.length))return n[0]+c+n[1];if(0>e)return E(d)?a.stylize(RegExp.prototype.toString.call(d),"regexp"):a.stylize("[Object]","special");a.seen.push(d);f=k?p(a,d,e,h,f):f.map(function(b){return q(a,d,e,h,b,k)});a.seen.pop();return t(f,c,n)}function l(a,b){if(A(b))return a.stylize("undefined",
"undefined");if(B(b))return b="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",a.stylize(b,"string");if(z(b))return a.stylize(""+b,"number");if(y(b))return a.stylize(""+b,"boolean");if(null===b)return a.stylize("null","null")}function m(a){return"["+Error.prototype.toString.call(a)+"]"}function p(a,b,d,e,c){for(var f=[],h=0,k=b.length;h<k;++h)Object.prototype.hasOwnProperty.call(b,String(h))?f.push(q(a,b,d,e,String(h),!0)):f.push("");c.forEach(function(c){c.match(/^\d+$/)||
f.push(q(a,b,d,e,c,!0))});return f}function q(a,b,d,e,c,f){var h,k;b=Object.getOwnPropertyDescriptor(b,c)||{value:b[c]};b.get?k=b.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):b.set&&(k=a.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(e,c)||(h="["+c+"]");k||(0>a.seen.indexOf(b.value)?(k=null===d?u(a,b.value,null):u(a,b.value,d-1),-1<k.indexOf("\n")&&(k=f?k.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+k.split("\n").map(function(a){return"   "+
a}).join("\n"))):k=a.stylize("[Circular]","special"));if(A(h)){if(f&&c.match(/^\d+$/))return k;h=JSON.stringify(""+c);h.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(h=h.substr(1,h.length-2),h=a.stylize(h,"name")):(h=h.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),h=a.stylize(h,"string"))}return h+": "+k}function t(a,b,d){var e=0;return 60<a.reduce(function(a,b){e++;0<=b.indexOf("\n")&&e++;return a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)?d[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+
" "+d[1]:d[0]+b+" "+a.join(", ")+" "+d[1]}function v(a){return Array.isArray(a)}function y(a){return"boolean"===typeof a}function z(a){return"number"===typeof a}function B(a){return"string"===typeof a}function A(a){return void 0===a}function E(a){return F(a)&&"[object RegExp]"===Object.prototype.toString.call(a)}function F(a){return"object"===typeof a&&null!==a}function I(a){return F(a)&&"[object Date]"===Object.prototype.toString.call(a)}function D(a){return F(a)&&("[object Error]"===Object.prototype.toString.call(a)||
a instanceof Error)}function H(a){return"function"===typeof a}function J(a){return 10>a?"0"+a.toString(10):a.toString(10)}function L(){var a=new Date,b=[J(a.getHours()),J(a.getMinutes()),J(a.getSeconds())].join(":");return[a.getDate(),O[a.getMonth()],b].join(" ")}var M=/%[sdj%]/g;b.format=function(a){if(!B(a)){for(var b=[],d=0;d<arguments.length;d++)b.push(c(arguments[d]));return b.join(" ")}d=1;var e=arguments,f=e.length;b=String(a).replace(M,function(a){if("%%"===a)return"%";if(d>=f)return a;switch(a){case "%s":return String(e[d++]);
case "%d":return Number(e[d++]);case "%j":try{return JSON.stringify(e[d++])}catch(Dg){return"[Circular]"}default:return a}});for(var h=e[d];d<f;h=e[++d])b=null!==h&&F(h)?b+(" "+c(h)):b+(" "+h);return b};b.deprecate=function(a,c){if(A(e.process))return function(){return b.deprecate(a,c).apply(this,arguments)};if(!0===d.noDeprecation)return a;var f=!1;return function(){if(!f){if(d.throwDeprecation)throw Error(c);d.traceDeprecation?console.trace(c):console.error(c);f=!0}return a.apply(this,arguments)}};
var K={},N;b.debuglog=function(a){A(N)&&(N=d.env.NODE_DEBUG||"");a=a.toUpperCase();if(!K[a])if((new RegExp("\\b"+a+"\\b","i")).test(N)){var e=d.pid;K[a]=function(){var d=b.format.apply(b,arguments);console.error("%s %d: %s",a,e,d)}}else K[a]=function(){};return K[a]};b.inspect=c;c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};c.styles={special:"cyan",number:"yellow",
"boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};b.isArray=v;b.isBoolean=y;b.isNull=function(a){return null===a};b.isNullOrUndefined=function(a){return null==a};b.isNumber=z;b.isString=B;b.isSymbol=function(a){return"symbol"===typeof a};b.isUndefined=A;b.isRegExp=E;b.isObject=F;b.isDate=I;b.isError=D;b.isFunction=H;b.isPrimitive=function(a){return null===a||"boolean"===typeof a||"number"===typeof a||"string"===typeof a||"symbol"===typeof a||"undefined"===
typeof a};b.isBuffer=a("./support/isBuffer");var O="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");b.log=function(){console.log("%s - %s",L(),b.format.apply(b,arguments))};b.inherits=a("inherits");b._extend=function(a,b){if(!b||!F(b))return a;for(var d=Object.keys(b),e=d.length;e--;)a[d[e]]=b[d[e]];return a}}).call(this,a("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":62,_process:43,inherits:61}],
64:[function(a,e,b){if(window.mozRTCPeerConnection||navigator.mozGetUserMedia){var d="moz";var c=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)}else if(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)d="webkit",c=navigator.userAgent.match(/Chrom(e|ium)/)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10);a=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;b=window.mozRTCIceCandidate||window.RTCIceCandidate;var f=
window.mozRTCSessionDescription||window.RTCSessionDescription,g=window.webkitMediaStream||window.MediaStream,n="https:"===window.location.protocol&&("webkit"===d&&26<=c||"moz"===d&&33<=c),l=window.AudioContext||window.webkitAudioContext,u=document.createElement("video");u=u&&u.canPlayType&&"probably"===u.canPlayType('video/webm; codecs="vp8", vorbis');var x=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;e.exports={prefix:d,browserVersion:c,
support:!!a&&!!x,supportRTCPeerConnection:!!a,supportVp8:u,supportGetUserMedia:!!x,supportDataChannel:!!(a&&a.prototype&&a.prototype.createDataChannel),supportWebAudio:!(!l||!l.prototype.createMediaStreamSource),supportMediaStream:!(!g||!g.prototype.removeTrack),supportScreenSharing:!!n,AudioContext:l,PeerConnection:a,SessionDescription:f,IceCandidate:b,MediaStream:g,getUserMedia:x}},{}],65:[function(a,e,b){function d(){}e.exports=d;d.mixin=function(a){a=a.prototype||a;a.isWildEmitter=!0;a.on=function(a,
b,d){this.callbacks=this.callbacks||{};var e=3===arguments.length,c=e?arguments[2]:arguments[1];c._groupName=e?arguments[1]:void 0;(this.callbacks[a]=this.callbacks[a]||[]).push(c);return this};a.once=function(a,b,d){function e(){c.off(a,e);h.apply(this,arguments)}var c=this,f=3===arguments.length,h=f?arguments[2]:arguments[1];this.on(a,f?arguments[1]:void 0,e);return this};a.releaseGroup=function(a){this.callbacks=this.callbacks||{};var b,d;for(b in this.callbacks){var e=this.callbacks[b];var c=
0;for(d=e.length;c<d;c++)e[c]._groupName===a&&(e.splice(c,1),c--,d--)}return this};a.off=function(a,b){this.callbacks=this.callbacks||{};var d=this.callbacks[a];if(!d)return this;if(1===arguments.length)return delete this.callbacks[a],this;var e=d.indexOf(b);d.splice(e,1);0===d.length&&delete this.callbacks[a];return this};a.emit=function(a){this.callbacks=this.callbacks||{};var b=[].slice.call(arguments,1),d=this.callbacks[a],e=this.getWildcardCallbacks(a),c;if(d){var f=d.slice();d=0;for(c=f.length;d<
c&&f[d];++d)f[d].apply(this,b)}if(e)for(f=e.slice(),d=0,c=f.length;d<c&&f[d];++d)f[d].apply(this,[a].concat(b));return this};a.getWildcardCallbacks=function(a){this.callbacks=this.callbacks||{};var b,d=[];for(b in this.callbacks){var e=b.split("*");if("*"===b||2===e.length&&a.slice(0,e[0].length)===e[0])d=d.concat(this.callbacks[b])}return d}};d.mixin(d)},{}],66:[function(a,e,b){function d(a,b,d){return b?new c(a,b):new c(a)}a=window;var c=a.WebSocket||a.MozWebSocket;e.exports=c?d:null;c&&(d.prototype=
c.prototype)},{}],67:[function(a,e,b){function d(a){var b=!0;a.getTracks().forEach(function(a){b="ended"===a.readyState&&b});return b}function c(a){var b=this;n.call(this);this.id=a.id;this.parent=a.parent;this.type=a.type||"video";this.oneway=a.oneway||!1;this.sharemyscreen=a.sharemyscreen||!1;this.browserPrefix=a.prefix;this.stream=a.stream;this.enableDataChannels=void 0===a.enableDataChannels?this.parent.config.enableDataChannels:a.enableDataChannels;this.receiveMedia=a.receiveMedia||this.parent.config.receiveMedia;
this.channels={};this.sid=a.sid||Date.now().toString();this.pc=new g(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints);this.pc.on("ice",this.onIceCandidate.bind(this));this.pc.on("endOfCandidates",function(a){b.send("endOfCandidates",a)});this.pc.on("offer",function(a){b.parent.config.nick&&(a.nick=b.parent.config.nick);b.send("offer",a)});this.pc.on("answer",function(a){b.parent.config.nick&&(a.nick=b.parent.config.nick);b.send("answer",a)});this.pc.on("addStream",
this.handleRemoteStreamAdded.bind(this));this.pc.on("addChannel",this.handleDataChannelAdded.bind(this));this.pc.on("removeStream",this.handleStreamRemoved.bind(this));this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded"));this.pc.on("iceConnectionStateChange",this.emit.bind(this,"iceConnectionStateChange"));this.pc.on("iceConnectionStateChange",function(){switch(b.pc.iceConnectionState){case "failed":"offer"===b.pc.pc.localDescription.type&&(b.parent.emit("iceFailed",b),b.send("connectivityError"))}});
this.pc.on("signalingStateChange",this.emit.bind(this,"signalingStateChange"));this.logger=this.parent.logger;"screen"===a.type?this.parent.localScreens&&this.parent.localScreens[0]&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),this.pc.addStream(this.parent.localScreens[0]),this.broadcaster=a.broadcaster):this.parent.localStreams.forEach(function(a){b.pc.addStream(a)});this.on("channelOpen",function(a){"https://simplewebrtc.com/protocol/filetransfer#inband-v1"===
a.protocol&&(a.onmessage=function(d){d=JSON.parse(d.data);var e=new l.Receiver;e.receive(d,a);b.emit("fileTransfer",d,e);e.on("receivedFile",function(a,b){e.channel.close()})})});this.on("*",function(){b.parent.emit.apply(b.parent,arguments)})}b=a("util");var f=a("webrtcsupport"),g=a("rtcpeerconnection"),n=a("wildemitter"),l=a("filetransfer");b.inherits(c,n);c.prototype.handleMessage=function(a){var b=this;this.logger.log("getting",a.type,a);a.prefix&&(this.browserPrefix=a.prefix);"offer"===a.type?
(this.nick||(this.nick=a.payload.nick),delete a.payload.nick,this.pc.handleOffer(a.payload,function(a){a||b.pc.answer(function(a,b){})})):"answer"===a.type?(this.nick||(this.nick=a.payload.nick),delete a.payload.nick,this.pc.handleAnswer(a.payload)):"candidate"===a.type?this.pc.processIce(a.payload):"connectivityError"===a.type?this.parent.emit("connectivityError",b):"mute"===a.type?this.parent.emit("mute",{id:a.from,name:a.payload.name}):"unmute"===a.type&&this.parent.emit("unmute",{id:a.from,name:a.payload.name})};
c.prototype.send=function(a,b){b={to:this.id,sid:this.sid,broadcaster:this.broadcaster,roomType:this.type,type:a,payload:b,prefix:f.prefix};this.logger.log("sending",a,b);this.parent.emit("message",b)};c.prototype.sendDirectly=function(a,b,d){this.logger.log("sending via datachannel",a,b,{type:b,payload:d});a=this.getDataChannel(a);if("open"!=a.readyState)return!1;a.send(d);return!0};c.prototype._observeDataChannel=function(a){var b=this;a.binaryType="arraybuffer";a.onclose=this.emit.bind(this,"channelClose",
a);a.onerror=this.emit.bind(this,"channelError",a);a.onmessage=function(d){var e=new Uint32Array(d.data);b.emit("channelMessage",b,a.label,e,a,d)};a.onopen=this.emit.bind(this,"channelOpen",a)};c.prototype.getDataChannel=function(a,b){if(!f.supportDataChannel)return this.emit("error",Error("createDataChannel not supported"));var d=this.channels[a];b||(b={});if(d)return d;d=this.channels[a]=this.pc.createDataChannel(a,b);d.binaryType="arraybuffer";this._observeDataChannel(d);return d};c.prototype.onIceCandidate=
function(a){if(!this.closed)if(a){var b=this.parent.config.peerConnectionConfig;"moz"===f.prefix&&b&&b.iceTransports&&a.candidate&&a.candidate.candidate&&0>a.candidate.candidate.indexOf(b.iceTransports)?this.logger.log("Ignoring ice candidate not matching pcConfig iceTransports type: ",b.iceTransports):this.send("candidate",a)}else this.logger.log("End of candidates.")};c.prototype.start=function(){this.enableDataChannels&&this.getDataChannel("simplewebrtc");this.pc.offer(this.receiveMedia,function(a,
b){})};c.prototype.icerestart=function(){var a=this.receiveMedia;a.mandatory.IceRestart=!0;this.pc.offer(a,function(a,b){})};c.prototype.end=function(){this.closed||(this.pc.close(),this.handleStreamRemoved())};c.prototype.handleRemoteStreamAdded=function(a){var b=this;this.stream?this.logger.warn("Already have a remote stream"):(this.stream=a.stream,this.stream.getTracks().forEach(function(a){a.addEventListener("ended",function(){d(b.stream)&&b.end()})}),this.parent.emit("peerStreamAdded",this))};
c.prototype.handleStreamRemoved=function(){var a=this.parent.peers.indexOf(this);-1<a&&(this.parent.peers.splice(a,1),this.closed=!0,this.parent.emit("peerStreamRemoved",this))};c.prototype.handleDataChannelAdded=function(a){this.channels[a.label]=a;this._observeDataChannel(a)};c.prototype.sendFile=function(a){var b=new l.Sender,d=this.getDataChannel("filetransfer"+(new Date).getTime(),{protocol:"https://simplewebrtc.com/protocol/filetransfer#inband-v1"});d.onopen=function(){d.send(JSON.stringify({size:a.size,
name:a.name}));b.send(a,d)};d.onclose=function(){console.log("sender received transfer");b.emit("complete")};return b};e.exports=c},{filetransfer:26,rtcpeerconnection:44,util:63,webrtcsupport:64,wildemitter:65}],68:[function(a,e,b){function d(a){var b=this,d=a||{},e=this.config={url:"https://sandbox.simplewebrtc.com:443/",socketio:{},connection:null,debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!1,peerVolumeWhenSpeaking:.25,
media:{video:!0,audio:!0},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},localVideo:{autoplay:!0,mirror:!0,muted:!0}},h;var k=a.debug?a.logger||console:a.logger||m;this.logger=k;for(h in d)d.hasOwnProperty(h)&&(this.config[h]=d[h]);this.capabilities=g;f.call(this);var l=null===this.config.connection?this.connection=new p(this.config):this.connection=this.config.connection;l.on("connect",function(){b.emit("connectionReady",l.getSessionid());b.sessionReady=!0;b.testReadiness()});l.on("message",
function(a){var d=b.webrtc.getPeers(a.from,a.roomType);if("offer"===a.type){d.length&&d.forEach(function(b){b.sid==a.sid&&(e=b)});if(!e){var e=b.webrtc.createPeer({id:a.from,sid:a.sid,type:a.roomType,enableDataChannels:b.config.enableDataChannels&&"screen"!==a.roomType,sharemyscreen:"screen"===a.roomType&&!a.broadcaster,broadcaster:"screen"!==a.roomType||a.broadcaster?null:b.connection.getSessionid()});b.emit("createdPeer",e)}e.handleMessage(a)}else d.length&&d.forEach(function(b){a.sid?b.sid===a.sid&&
b.handleMessage(a):b.handleMessage(a)})});l.on("remove",function(a){a.id!==b.connection.getSessionid()&&b.webrtc.removePeers(a.id,a.type)});a.logger=this.logger;a.debug=!1;this.webrtc=new c(a);"mute unmute pauseVideo resumeVideo pause resume sendToAll sendDirectlyToAll getPeers".split(" ").forEach(function(a){b[a]=b.webrtc[a].bind(b.webrtc)});this.webrtc.on("*",function(){b.emit.apply(b,arguments)});if(e.debug)this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:"));this.webrtc.on("localStream",
function(){b.testReadiness()});this.webrtc.on("message",function(a){b.connection.emit("message",a)});this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this));this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this));this.config.adjustPeerVolume&&(this.webrtc.on("speaking",this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1)));l.on("stunservers",function(a){b.webrtc.config.peerConnectionConfig.iceServers=
a;b.emit("stunservers",a)});l.on("turnservers",function(a){b.webrtc.config.peerConnectionConfig.iceServers=b.webrtc.config.peerConnectionConfig.iceServers.concat(a);b.emit("turnservers",a)});this.webrtc.on("iceFailed",function(a){});this.webrtc.on("connectivityError",function(a){});this.webrtc.on("audioOn",function(){b.webrtc.sendToAll("unmute",{name:"audio"})});this.webrtc.on("audioOff",function(){b.webrtc.sendToAll("mute",{name:"audio"})});this.webrtc.on("videoOn",function(){b.webrtc.sendToAll("unmute",
{name:"video"})});this.webrtc.on("videoOff",function(){b.webrtc.sendToAll("mute",{name:"video"})});this.webrtc.on("localScreen",function(a){var d=document.createElement("video"),e=b.getRemoteVideoContainer();d.oncontextmenu=function(){return!1};d.id="localScreen";n(a,d);e&&e.appendChild(d);b.emit("localScreenAdded",d);b.connection.emit("shareScreen");b.webrtc.peers.forEach(function(a){"video"===a.type&&(a=b.webrtc.createPeer({id:a.id,type:"screen",sharemyscreen:!0,enableDataChannels:!1,receiveMedia:{offerToReceiveAudio:0,
offerToReceiveVideo:0},broadcaster:b.connection.getSessionid()}),b.emit("createdPeer",a),a.start())})});this.webrtc.on("localScreenStopped",function(a){b.getLocalScreen()&&b.stopScreenShare()});this.webrtc.on("channelMessage",function(a,d,e){"volume"==e.type&&b.emit("remoteVolumeChange",a,e.volume)});this.config.autoRequestMedia&&this.startLocalVideo()}var c=a("./webrtc"),f=a("wildemitter"),g=a("webrtcsupport"),n=a("attachmediastream"),m=a("mockconsole"),p=a("./socketioconnection");d.prototype=Object.create(f.prototype,
{constructor:{value:d}});d.prototype.leaveRoom=function(){if(this.roomName){for(this.connection.emit("leave");this.webrtc.peers.length;)this.webrtc.peers[0].end();this.getLocalScreen()&&this.stopScreenShare();this.emit("leftRoom",this.roomName);this.roomName=void 0}};d.prototype.disconnect=function(){this.connection.disconnect();delete this.connection};d.prototype.handlePeerStreamAdded=function(a){var b=this,d=this.getRemoteVideoContainer(),e=n(a.stream);a.videoEl=e;e.id=this.getDomId(a);d&&d.appendChild(e);
this.emit("videoAdded",e,a);window.setTimeout(function(){b.webrtc.isAudioEnabled()||a.send("mute",{name:"audio"});b.webrtc.isVideoEnabled()||a.send("mute",{name:"video"})},250)};d.prototype.handlePeerStreamRemoved=function(a){var b=this.getRemoteVideoContainer(),d=a.videoEl;this.config.autoRemoveVideos&&b&&d&&b.removeChild(d);d&&this.emit("videoRemoved",d,a)};d.prototype.getDomId=function(a){return[a.id,a.type,a.broadcaster?"broadcasting":"incoming"].join("_")};d.prototype.setVolumeForAll=function(a){this.webrtc.peers.forEach(function(b){b.videoEl&&
(b.videoEl.volume=a)})};d.prototype.joinRoom=function(a,b){var d=this;this.roomName=a;this.connection.emit("join",a,function(e,c){console.log("join CB",e);if(e)d.emit("error",e);else{if(!c.xtra){ha();A("game");Va();Ab(l.ERR_GAMELOAD,"#ff0000");return}t.room=c.xtra;var f,h;for(f in c.clients){var k=c.clients[f];for(h in k)if(k[h]){var g=d.webrtc.createPeer({id:f,type:h,enableDataChannels:d.config.enableDataChannels&&"screen"!==h,receiveMedia:{offerToReceiveAudio:"screen"!==h&&d.config.receiveMedia.offerToReceiveAudio?
1:0,offerToReceiveVideo:d.config.receiveMedia.offerToReceiveVideo}});d.emit("createdPeer",g);g.start()}}}b&&b(e,c);d.emit("joinedRoom",a)})};d.prototype.getEl=function(a){return"string"===typeof a?document.getElementById(a):a};d.prototype.startLocalVideo=function(){var a=this;this.webrtc.start(this.config.media,function(b,d){b?a.emit("localMediaError",b):n(d,a.getLocalVideoContainer(),a.config.localVideo)})};d.prototype.stopLocalVideo=function(){this.webrtc.stop()};d.prototype.getLocalVideoContainer=
function(){var a=this.getEl(this.config.localVideoEl);if(a&&"VIDEO"===a.tagName)return a.oncontextmenu=function(){return!1},a;if(a){var b=document.createElement("video");b.oncontextmenu=function(){return!1};a.appendChild(b);return b}};d.prototype.getRemoteVideoContainer=function(){return this.getEl(this.config.remoteVideosEl)};d.prototype.shareScreen=function(a){this.webrtc.startScreenShare(a)};d.prototype.getLocalScreen=function(){return this.webrtc.localScreens&&this.webrtc.localScreens[0]};d.prototype.stopScreenShare=
function(){this.connection.emit("unshareScreen");var a=document.getElementById("localScreen"),b=this.getRemoteVideoContainer();this.config.autoRemoveVideos&&b&&a&&b.removeChild(a);a&&this.emit("videoRemoved",a);this.getLocalScreen()&&this.webrtc.stopScreenShare();this.webrtc.peers.forEach(function(a){a.broadcaster&&a.end()})};d.prototype.testReadiness=function(){this.sessionReady&&(this.config.media.video||this.config.media.audio?0<this.webrtc.localStreams.length&&this.emit("readyToCall",this.connection.getSessionid()):
this.emit("readyToCall",this.connection.getSessionid()))};d.prototype.createRoom=function(a,b){this.roomName=a;this.connection.emit("create",t.room,b)};d.prototype.sendFile=function(){if(!g.dataChannel)return this.emit("error",Error("DataChannelNotSupported"))};e.exports=d},{"./socketioconnection":69,"./webrtc":70,attachmediastream:3,mockconsole:37,webrtcsupport:64,wildemitter:65}],69:[function(a,e,b){function d(a){this.connection=c.connect(a.url,a.socketio)}var c=a("socket.io-client");d.prototype.on=
function(a,b){this.connection.on(a,b)};d.prototype.emit=function(){this.connection.emit.apply(this.connection,arguments)};d.prototype.getSessionid=function(){return this.connection.id};d.prototype.disconnect=function(){return this.connection.disconnect()};e.exports=d},{"socket.io-client":50}],70:[function(a,e,b){function d(a){var b=this,d=a||{};this.config={debug:!1,peerConnectionConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[]},receiveMedia:{offerToReceiveAudio:1,
offerToReceiveVideo:1},enableDataChannels:!0};var e;a=a.debug?a.logger||console:a.logger||f;this.logger=a;for(e in d)d.hasOwnProperty(e)&&(this.config[e]=d[e]);c.support||this.logger.error("Your browser doesn't seem to support WebRTC");this.peers=[];g.call(this,this.config);this.on("speaking",function(){b.hardMuted||b.peers.forEach(function(a){a.enableDataChannels&&(a=a.getDataChannel("hark"),"open"==a.readyState&&a.send(JSON.stringify({type:"speaking"})))})});this.on("stoppedSpeaking",function(){b.hardMuted||
b.peers.forEach(function(a){a.enableDataChannels&&(a=a.getDataChannel("hark"),"open"==a.readyState&&a.send(JSON.stringify({type:"stoppedSpeaking"})))})});this.on("volumeChange",function(a,d){b.hardMuted||b.peers.forEach(function(b){b.enableDataChannels&&(b=b.getDataChannel("hark"),"open"==b.readyState&&b.send(JSON.stringify({type:"volume",volume:a})))})});if(this.config.debug)this.on("*",function(a,d,e){(b.config.logger===f?console:b.logger).log("event:",a,d,e)})}b=a("util");var c=a("webrtcsupport"),
f=a("mockconsole"),g=a("localmedia"),n=a("./peer");b.inherits(d,g);d.prototype.createPeer=function(a){a.parent=this;a=new n(a);this.peers.push(a);return a};d.prototype.removePeers=function(a,b){this.getPeers(a,b).forEach(function(a){a.end()})};d.prototype.getPeers=function(a,b){return this.peers.filter(function(d){return(!a||d.id===a)&&(!b||d.type===b)})};d.prototype.sendToAll=function(a,b){this.peers.forEach(function(d){d.send(a,b)})};d.prototype.sendDirectlyToAll=function(a,b,d){this.peers.forEach(function(e){e.enableDataChannels&&
e.sendDirectly(a,b,d)})};e.exports=d},{"./peer":67,localmedia:35,mockconsole:37,util:63,webrtcsupport:64}]},{},[68])(68)})},U,na,t={name:localStorage.name,color:localStorage.color||"#ff0000"},Wa=function(){};console.log("%c nehhon %c POWER ","background: #00ffd4; color: #000; font-size:20px","background: #000; color: #00ffd4; font-size:20px");console.log("%c webmaster@nehhon.com ","background: #00ffd4; color: #000; font-size:20px");console.log("%c @nehhon ","background: #000; color: #00ffd4; font-size:20px");
var g=function(c){return document.getElementById(c)},J=function(c,a,e){void 0===localStorage[c]&&(localStorage[c]=a);e&&(g(e).value=localStorage[c])};void 0===localStorage.fullscreen&&(localStorage.fullscreen=!0);J("favMusic","originalMusic");J("musicRange",36);J("soundRange",100);J("goldRes",400);J("foodRes",400);J("stoneRes",400);J("woodRes",400);J("nplayed",0);J("infinity","true");J("mapx",256);J("terrainType","grass");J("terrain","grass");J("water","0");J("items","10");J("peons","3");J("gateways",
"1");J("freePop","1");J("maxPop",200);J("zoomMult",70);J("scrollSpeed",50);J("nightcycle",!0);console.log=Wa;console.error=Wa;console.warn=Wa;console.info=Wa;"tza.red"!==location.hostname&&(location.href="https://tza.red");window.addEventListener("error",function(c){fb(c.lineno+":"+c.colno+" "+c.message,"error")});var wf=function(c){c.parentNode.removeChild(c)},Ab=function(c,a){var e=g("notifybar"),b=document.createElement("div");b.innerHTML=c;a&&(b.style.background=a);e.appendChild(b);setTimeout(wf,
11E3,b)},xf=location;(function(){var c=!!window.opr||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),a="undefined"!==typeof InstallTrigger,e=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),b=!!document.documentMode,d=!b&&!!window.StyleMedia,f=!!window.chrome&&!!window.chrome.webstore,k;c?k="Opera":a?k="Firefox":e?k="Safari":b?k="IE":d?k="Edge":f&&(k="Chrome");t.navLang=localStorage.language||navigator.language||navigator.userLanguage;a=t.navLang.substr(0,2);"es"==
a?c=["Tzared","Juego de estrategia en tiempo real para navegadores web, juega solo o con amigos","tzared,jugar,multijugador,juego,online,navegador web,tzar"]:"it"==a?c=["Tzared","Gioco di strategia in tempo reale per browser web, giocare da soli o con gli amici","tzared,giocare,multigiocatore,gioco,online,navigatore,tzar,web"]:"it"==a?c=["Tzared","Gra strategiczna w czasie rzeczywistym dla przegl\u0105darek internetowych, bawi\u0107 si\u0119 samotnie lub z przyjaci\u00f3\u0142mi","tzared,gra,multiplayer,online,tzar,przegl\u0105darka internetowa"]:
"ru"==a?c=["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u043b\u044f \u0432\u0435\u0431-\u0431\u0440\u0430\u0443\u0437\u0435\u0440\u043e\u0432, \u0438\u0433\u0440\u0430\u0442\u044c \u0432 \u043e\u0434\u0438\u043d\u043e\u0447\u043a\u0443 \u0438\u043b\u0438 \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438","\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u044c\u0442\u0438\u043f\u043b\u0435\u0435\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u0435\u0440,\u043e\u0433\u043d\u0451\u043c \u0438 \u043c\u0435\u0447\u043e\u043c"]:
"pt"==a?c=["Tzared","Jogo de estrat\u00e9gia em tempo real para navegadores da web, jogar sozinho ou com amigos","tzared,jogar,multiplayer,jogo,online,navegador web,tzar"]:"bg"==a?c=["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0447\u0435\u0441\u043a\u0430 \u0438\u0433\u0440\u0430 \u0432 \u0440\u0435\u0430\u043b\u043d\u043e \u0432\u0440\u0435\u043c\u0435 \u0437\u0430 \u0443\u0435\u0431 \u0431\u0440\u0430\u0443\u0437\u044a\u0440\u0438, \u0438\u0433\u0440\u0430\u0439\u0442\u0435 \u0441\u0430\u043c\u0438 \u0438\u043b\u0438 \u0441 \u043f\u0440\u0438\u044f\u0442\u0435\u043b\u0438",
"\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u0442\u0438\u043f\u043b\u0435\u0439\u044a\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u044a\u0440"]:"de"==a?c=["Tzared","Echtzeit-Strategiespiel f\u00fcr Webbrowser, alleine oder mit Freunden spielen","tzared,multiplayer,spiel,online,Webbrowser,tzar"]:(c=["Tzared","Real-time strategy game for web browsers, play alone or with friends","tzared,play,multiplayer,game,online,browser,tzar,web"],a="en");
document.getElementsByTagName("html")[0].lang=a;document.title=c[0];t.title=c[0];document.getElementsByTagName("meta").description=c[1];document.getElementsByTagName("meta").keywords=c[2];t.versionInt=348;t.version="v"+t.versionInt/10;t.versionDate=Date.now()-1557937313828;localStorage.version!==t.version&&(localStorage.version=t.version,Ab("Updated to "+t.version));g("info").innerHTML="Work in progress - Beta "+t.version+" - Updated "+~~(t.versionDate/864E5)+" days ago";t.lang="en es it pt ru pl bg de".split(" ").indexOf(a);
0>t.lang&&(t.lang=0);t.langstr=a;t.team=0;t.race=0;t.navigator=k;t.mx=151;t.onlineID=null;t.temperature=0;t.cdn="nehhon/"})();var Qc=function(c){c--;var a=new XMLHttpRequest;a.open("GET",t.cdn+t.langstr+".json",!0);a.onload=function(){l=JSON.parse(a.response);Ga=[l.SP_SETUPMAP_RACE_1.split("|")[0],l.SP_SETUPMAP_RACE_2.split("|")[0],l.SP_SETUPMAP_RACE_3.split("|")[0],l.ORDERS_NAMES_E_COMMON.toLocaleUpperCase()];for(var e=["mult0",l.MAINSCR_MULTI.split("|")[0],"rnd0",l.MAINSCR_SINGLE.split("| ")[0],
"load0",l.SINGLESCR_LOAD.split("| ")[1],"editor0",l.MAPEDITOR,"settings0",l.MP_MPLAYER_SETTINGS,"about",l.ABOUT,"multSection",l.MAINSCR_MULTI.split("|")[0],"offlineSection",l.MAINSCR_SINGLE.split("|")[0],"returnmenu",l.CAMPAIGN_BACK,"savelocal",l.SAVE_GAME_CONTENT],b=0,d=e.length;b<d;b+=2)g(e[b])&&(g(e[b]).innerHTML=e[b+1])};a.send()};Qc(t.lang);Qc.translated=!0;var B=console.log,fb=function(c,a,e){var b=g("alert");b||(Sb("alert"),b=g("alert"),b.innerHTML='\n<div id="playingMenu" style=""></div>\n            <div id="alert" style="">\n                <div>\n                    <h3 id="alerttitle"></h3>\n                    <div id="alerttext"></div>\n                    <button id="alertok">'+
l.DLG_BTNS_OK+"</button>\n                </div>\n            </div>");var d=g("alerttitle"),r=g("alerttext");g("alertok").onclick=function(){A("alert");ha()};b.style.display="block";d.innerHTML=a||l.TZAREDIT_S2;r.innerHTML=c;e?g("alertok").style.display="none":g("alertok").style.display="block";g("basic").style.filter="blur(94px)"},yf=function(c,a,e){for(var b=0,d={},r=0;r<c.length;d={$jscomp$loop$prop$url$20:d.$jscomp$loop$prop$url$20},r++)d.$jscomp$loop$prop$url$20=t.cdn+c[r],-1===a.indexOf(d.$jscomp$loop$prop$url$20)?
fetch(d.$jscomp$loop$prop$url$20).then(function(a){return a.arrayBuffer()}).then(function(a){return function(d){b++;e.innerHTML=100*b/c.length+"%";b==c.length&&(e.style.display="none");Ud({url:a.$jscomp$loop$prop$url$20,buffer:d})}}(d)):b++},Vd=function(){for(var c=[Bb.content.common,Bb.content.icons],a=Object.keys(Cb),e=0;e<a.length;e++)c.put(Cb[a[e]].url);return c},Wd=function(){var c=this;navigator.storage&&navigator.storage.persist&&navigator.storage.persist().then(function(a){a?Rc("basic",function(a){a=
a.target.result;B(this);yf(Vd(),a,c);c.innerHTML="0%";c.onclick=null;Wd.button=this}):fb("Storage may be cleared by the UA under storage pressure.")})},K={size:512,load:0,xtra:[],common:1,xtraRes:[]},va=function(c){c.target.loadedSize||(va.total+=c.total,c.target.lastLoaded=0,c.target.loadedSize=!0);va.progress+=c.loaded-c.target.lastLoaded;c.target.lastLoaded=c.loaded;g("loadingtext").innerHTML=l.DOWNLOADING_GRAPHICS+~~(100*va.progress/va.total)+"%"};K.check=function(){B("txt",K.load,K.images);K.load++;
if(K.load===K.images){p.editor?(A("statButton"),A("menu"),A("resources"),H("mapeditorinfotop"),H("mapeditorinfo"),g("mapeditorinfoUnits").style.display="block"):(H("menu"),H("statButton"),H("resources"),A("mapeditorinfo"),A("mapeditorinfotop"));Xd();var r=gb(q.atlasLoc(),1048576);c.activeTexture(c.TEXTURE0);var a=c.createTexture();c.bindTexture(c.TEXTURE_2D,a);S?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,512,512,0,c.RGBA,c.FLOAT,r):c.texImage2D(c.TEXTURE_2D,0,c.RGBA32F,512,512,0,c.RGBA,c.FLOAT,r);c.texParameteri(c.TEXTURE_2D,
c.TEXTURE_MAG_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT);c.uniform1i(c.getUniformLocation(F,"u_image1"),0);var e=performance.now();r=K.common;if(S){e=4*Math.pow(4096,2);for(var b=Math.ceil(r.length/e),d=0;d<b;d++){c.activeTexture(c.TEXTURE6+d);var f=c.createTexture();c.bindTexture(c.TEXTURE_2D,f);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);
c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT);f=new Uint8Array(r.buffer,r.byteOffset+e*d,e);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,4096,4096,0,c.RGBA,c.UNSIGNED_BYTE,f);c.uniform1i(c.getUniformLocation(F,"img_common["+d+"]"),6+d);c.useProgram(I);c.uniform1i(c.getUniformLocation(I,"img_common["+d+"]"),6+d);c.useProgram(F)}c.useProgram(I)}else c.activeTexture(c.TEXTURE1),f=c.createTexture(),
c.bindTexture(c.TEXTURE_2D_ARRAY,f),c.texParameteri(c.TEXTURE_2D_ARRAY,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D_ARRAY,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texImage3D(c.TEXTURE_2D_ARRAY,0,c.RGBA,K.size,K.size,r.length/(K.size*K.size*4),0,c.RGBA,c.UNSIGNED_BYTE,r),c.uniform1i(c.getUniformLocation(F,"img_common"),1),B("3dtex",performance.now()-e),c.useProgram(I),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D_ARRAY,f),c.uniform1i(c.getUniformLocation(I,"img_common"),0);c.activeTexture(c.TEXTURE5);
c.bindTexture(c.TEXTURE_2D,a);c.uniform1i(c.getUniformLocation(I,"u_image1"),5);q.delTexs();c.activeTexture(c.TEXTURE2);zf();Ha.check()}};var Xb,Cf=function(c){g("loadingtext").innerHTML=l.DOWNLOADING_GRAPHICS;Rc("basic",function(a){Xb=a.target.result;a=1048576*(323+Cb[p.terrainType||"grass"].size);K.common=Yb(q.crtStxt(a),a);K.images=Object.keys(c).length+1;K.load=0;va.progress=0;va.total=0;Date.now();Y.icons?K.check():Zb(t.cdn+c.icons,function(a){B(a);a=new Uint8Array(a);a=new Blob([a],{type:"image/png"});
var b=new Image;b.src=URL.createObjectURL(a);Y.icons=b;b.onload=K.check},va);Zb(t.cdn+c.common,Af,va);g("terrainSelect")&&(localStorage.terrain=g("terrainSelect").value);p.terrainType=localStorage.terrain;a=Cb[p.terrainType||"grass"];B(a);Zb(t.cdn+a.url,Bf,va)})},Bb=function(){K.started=!0;Cf(Bb.content)};Bb.content={icons:"icons.png",common:"common.neh2"};var Cb={grass:{url:"grass.neh2",size:30,id:0},trenkorian:{url:"trenkorian.neh2",size:36,id:1}};(function(){"serviceWorker"in navigator?(console.log("CLIENT: service worker registration in progress."),
navigator.serviceWorker.register("sworker.js").then(function(c){console.log("CLIENT: service worker registration complete.")},function(c){B(c);console.log("CLIENT: service worker registration failure.")}),navigator.serviceWorker.oncontrollerchange=function(){console.log("page controlled by:",navigator.serviceWorker.controller);location.reload(!0)}):console.log("CLIENT: service worker is not supported.")})();var hb="GENERAL_DEFGAMENAME;GENERAL_GAMENAME;GENERAL_VERSION;GENERAL_NET_TITLE;GENERAL_CANCEL;GENERAL_OK;GENERAL_YES;GENERAL_NO;GENERAL_CLOSE;GENERAL_IGNORE;GENERAL_ABORT;GENERAL_YOUSURE;GENERAL_REFRESH;GENERAL_KICK;GENERAL_QLOAD;GENERAL_QSAVE;ADDS_MOREHOUSES;ADDS_AISEND;CHECK_INSERTCD;CHECK_INSERTCD2;CHECK_INSERTCD3;CHECK_NOCD;CHECK_BADEXE;ERR_CTFCANTSPAWN;ERR_DXFAILED;ERR_VMODE;ERR_OFFSCREEN;ERR_GPF;ERR_INCORRECTVER;ERR_GAMEFULL;ERR_BROWSEFAIL;ERR_NONET;ERR_SNDINIT;ERR_GAMECREATE;ERR_GAMELOAD;ERR_GAMELOAD2;ERR_DEMOVER;ERR_DEMORNDMAP;ERR_INVALIDCFG;ERR_INITMIDI;ERR_DSINIT;ERR_MCIINIT;ERR_BETACONNECT;ERR_SERVERCANCEL;ERR_SERVERKICK;ERR_ORDERROOM;ERR_MENUROOM;ERR_NETASYNC;ERR_NETASYNC2;ERR_NETASYNCBAD;ERR_NOTERRAIN;ERR_NOMAP;ERR_CLIENTSYNC;ERR_RULESLOAD;ERR_MAPWRONGVER;ERR_WRONGAI;ERR_WRONGOBJS;ERR_UNKNOWN;ERR_FATAL;ERR_NONFATAL;ERR_ERRORCODE;DEFMSG_MOVEDAVANCE;DEFMSG_MOVESNEAK;DEFMSG_ATTACK;DEFMSG_ATTACKTYPE;DEFMSG_ENTERHOLDER;DEFMSG_MINE;DEFMSG_BUILD;DEFMSG_REPAIR;DEFMSG_DIG;DEFMSG_CAPTURE;DEFMSG_CHOP;DEFMSG_ENTERSHIP;DEFMSG_FISHING;DEFMSG_PICKITEM;DEFMSG_PICKITEMINST;DEFMSG_GATHERRESITEMS;DEFMSG_TENDCOWS;DEFMSG_LEAVETRADE;DEFMSG_RETURNGOODS;DEFMSG_DUMMYTRAIN;DEFMSG_REMOVERALLYPOINT;DEFMSG_SETRALLYPOINT;DEFMSG_SETRALLYPOINTDA;DEFMSG_SETRALLYPOINTADV;DEFMSG_NOMAPTITLE;DEFMSG_NODECR;Q_QUIT_TITLE;Q_QUIT;Q_RESIGN;Q_DISCONNECT;MSG_CLIENT_QUIT;MSG_LOAD_OBJDEFS;MSG_LOAD_TERRAIN;MSG_LOAD_OBJECTS;MSG_LOAD_FINAL;MSG_LOAD_AI;MSG_LOAD_DONE;MSG_GAME_DESTROY;MSG_GAME_CREATE;MSG_GAME_RANDOM;MSG_GAME_RESTART;MSG_GAME_LOAD;MSG_GAME_LOAD_OBJ;MSG_GAME_INIT;MSG_RESADDED;MSG_NET_JOIN;MSG_NET_BROWSE;MSG_TREE;MSG_GAME_SPEED;MSG_GAME_SPEED_SLOWEST;MSG_GAME_SPEED_SLOW;MSG_GAME_SPEED_NORMAL;MSG_GAME_SPEED_FAST;MSG_GAME_SPEED_FASTEST;MSG_SYS_ERROR;MSG_SYS_TITLE;MSG_SYS_CONT;MSG_SYS_ABORT;MSG_SYS_YES;MSG_SYS_NO;MSG_SYS_IGNORE;MSG_DISCONNECT;VIEWMSG_POPLIMIT1;VIEWMSG_POPLIMIT2;VIEWMSG_NOTGOLD;VIEWMSG_NOTMANNA;VIEWMSG_NOTPOWER;VIEWMSG_MAGICGATEWAYCAP;VIEWMSG_QUICKSAVED;VIEWMSG_NOMPCHEAT;VIEWMSG_CHEATSENABLED;VIEWMSG_PLAYER_RESIGNED;VIEWMSG_PLAYER_DISCONECTED;VIEWMSG_PLAYER_DEFEATED;VIEWMSG_NEWQUEST;VIEWMSG_DEMO_END;VIEWMSG_NOTRES;VIEWMSG_GOLD;VIEWMSG_STONE;VIEWMSG_FOOD;VIEWMSG_WOOD;VIEWMSG_MANNA;VIEWMSG_SELL_ITEM;VIEWMSG_WAIT_PLAYERS;VIEWMSG_WAIT_RESPONSE;VIEWMSG_PLAYER_ENEMY;VIEWMSG_PLAYER_NEUTRAL;VIEWMSG_PLAYER_ALLY;VIEWMSG_PLAYER_WANT_ENEMY;VIEWMSG_PLAYER_WANT_NEUTRAL;VIEWMSG_PLAYER_WANT_ALLY;VIEWMSG_SPELL_LEARNED;VIEWMSG_PAUSE;NOTIFY_UNDER_ATTACK;NOTIFY_CAPTURED;NOTIFY_KILLED;NOTIFY_DESTROYED;NOTIFY_BUILT;NOTIFY_PRODUCED;NOTIFY_DISCOVERED;NOTIFY_UPGRADED;SELVIEW_UNITS;SELVIEW_BERSERKKINGDOM;MAINSCR_SINGLE;MAINSCR_MULTI;MAINSCR_PREF;MAINSCR_CREDITS;MAINSCR_QUIT;SINGLESCR_CAMPAIGN;SINGLESCR_CUSTOM;SINGLESCR_RANDOM;SINGLESCR_LOAD;SINGLESCR_BACK;SP_CHOOSEMAP_T_CUSTOMMAP;SP_CHOOSEMAP_T_MAP;SP_CHOOSEMAP_T_DESCRIPTION;SP_CHOOSEMAP_PLAY;SP_CHOOSEMAP_BACK;SP_SETUPMAP_T_NUM_PLAYERS;SP_SETUPMAP_T_GAME_TYPE;SP_SETUPMAP_T_VICT_COND;SP_SETUPMAP_T_SCORE_LIM;SP_SETUPMAP_T_TIME_LIM;SP_SETUPMAP_T_DIFF_LVL;SP_SETUPMAP_T_ST_RES;SP_SETUPMAP_T_MAP_DECR;SP_SETUPMAP_T_FOG;SP_SETUPMAP_T_EXPOLRE;SP_SETUPMAP_T_MAPDEF;SP_SETUPMAP_T_POPLIMIT;SP_SETUPMAP_BACK;SP_SETUPMAP_PLAY;SP_SETUPMAP_RACE_0;SP_SETUPMAP_RACE_1;SP_SETUPMAP_RACE_2;SP_SETUPMAP_RACE_3;SP_SETUPMAP_G_TYPE_0;SP_SETUPMAP_G_TYPE_1;SP_SETUPMAP_G_TYPE_2;SP_SETUPMAP_VCOND_0;SP_SETUPMAP_VCOND_1;SP_SETUPMAP_VCOND_2;SP_SETUPMAP_VCOND_3;SP_SETUPMAP_DIFFLVL_0;SP_SETUPMAP_DIFFLVL_1;SP_SETUPMAP_DIFFLVL_2;SP_SETUPMAP_RESURCS_0;SP_SETUPMAP_RESURCS_1;SP_SETUPMAP_RESURCS_2;SP_SETUPMAP_RESURCS_3;MP_SEARCH_T_PL_NAME;MP_SEARCH_T_IPX;MP_SEARCH_T_TCP;MP_SEARCH_T_IP;MP_SEARCH_T_LOBBY;MP_SEARCH_T_GAMES;MP_SEARCH_T_INFORM;MP_SEARCH_T_GAMENAME;MP_SEARCH_CREATE;MP_SEARCH_SEARCH;MP_SEARCH_JOIN;MP_SEARCH_BACK;MP_MPLAYER_PLAY;MP_MPLAYER_SETTINGS;MP_MPLAYER_DISCONNECT;MP_MPLAYER_RACE_0;MP_MPLAYER_RACE_1;MP_MPLAYER_RACE_2;MP_MPLAYER_RACE_3;MP_MPLAYER_NAME_0;MP_MPLAYER_NAME_1;MP_MPLAYER_NAME_2;MP_SETUPMAP_T_RANDOM;MP_SETUPMAP_T_CUSTOM;MP_SETUPMAP_T_CUSTOM_LIST;MP_SETUPMAP_T_MAP_DECR;MP_SETUPMAP_T_GAME_TYPE;MP_SETUPMAP_T_VICT_COND;MP_SETUPMAP_T_SCORE_LIM;MP_SETUPMAP_T_TIME_LIM;MP_SETUPMAP_T_DIFF_LVL;MP_SETUPMAP_T_ST_RES;MP_SETUPMAP_T_MAP_SIZE;MP_SETUPMAP_T_MAP_RES;MP_SETUPMAP_T_MAP_TYPE;MP_SETUPMAP_T_TERRAIN;MP_SETUPMAP_T_GSLOCATIONS;MP_SETUPMAP_T_ANIMALS;MP_SETUPMAP_T_RIVERS;MP_SETUPMAP_T_MITEMS;MP_SETUPMAP_T_CLIFFS;MP_SETUPMAP_T_FOG;MP_SETUPMAP_T_EXPOLRE;MP_SETUPMAP_T_WEATHER;MP_SETUPMAP_T_DAY;MP_SETUPMAP_T_POPLIMIT;MP_SETUPMAP_T_USEMAPSET;MP_SETUPMAP_T_GATEWAYS;MP_SETUPMAP_T_COMP;MP_SETUPMAP_T_OPEN;MP_SETUPMAP_T_DISABLE;MP_SETUPMAP_G_TYPE_0;MP_SETUPMAP_G_TYPE_1;MP_SETUPMAP_G_TYPE_2;MP_SETUPMAP_VCOND_0;MP_SETUPMAP_VCOND_1;MP_SETUPMAP_VCOND_2;MP_SETUPMAP_VCOND_3;MP_SETUPMAP_DIFFLVL_0;MP_SETUPMAP_DIFFLVL_1;MP_SETUPMAP_DIFFLVL_2;MP_SETUPMAP_RESURCS_0;MP_SETUPMAP_RESURCS_1;MP_SETUPMAP_RESURCS_2;MP_SETUPMAP_RESURCS_3;MP_SETUPMAP_CANCEL;MP_SETUPMAP_ACCEPT;MP_SETUPMAP_M_SIZE_0;MP_SETUPMAP_M_SIZE_1;MP_SETUPMAP_M_SIZE_2;MP_SETUPMAP_M_SIZE_3;MP_SETUPMAP_M_SIZE_4;MP_SETUPMAP_M_SIZE_5;MP_SETUPMAP_M_SIZE_6;MP_SETUPMAP_M_RES_0;MP_SETUPMAP_M_RES_1;MP_SETUPMAP_M_RES_2;MP_SETUPMAP_M_TYPE_0;MP_SETUPMAP_M_TYPE_1;MP_SETUPMAP_M_TYPE_2;MP_SETUPMAP_M_TYPE_3;MP_SETUPMAP_M_TYPE_4;MP_SETUPMAP_M_TYPE_5;MP_SETUPMAP_AI_ASSIST;GAME_SCR_MENU;GAME_SCR_DIPLOMACY;GAME_SCR_CHAT;DLG_BTNS_OK;DLG_BTNS_CANCEL;WND_QUESTS_CURQUEST;WND_QUESTS_CLOSE;WND_QUESTS_PAGE;WND_QUESTS_NONE;WND_MESSAGE_CLOSE;SP_SETUPRND_T_NUM_PLAYERS;SP_SETUPRND_T_GAME_TYPE;SP_SETUPRND_T_VICT_COND;SP_SETUPRND_T_SCORE_LIM;SP_SETUPRND_T_TIME_LIM;SP_SETUPRND_T_DIFF_LVL;SP_SETUPRND_T_ST_RES;SP_SETUPRND_T_FOG;SP_SETUPRND_T_EXPOLRE;SP_SETUPRND_T_MAP_SIZE;SP_SETUPRND_T_MAP_RES;SP_SETUPRND_T_MAP_TYPE;SP_SETUPRND_T_TERRAIN;SP_SETUPRND_T_GSLOCATIONS;SP_SETUPRND_T_ANIMALS;SP_SETUPRND_T_RIVERS;SP_SETUPRND_T_MITEMS;SP_SETUPRND_T_CLIFFS;SP_SETUPRND_T_POPLIMIT;SP_SETUPRND_T_GATEWAYS;SP_SETUPRND_BACK;SP_SETUPRND_PLAY;SP_SETUPRND_RACE_0;SP_SETUPRND_RACE_1;SP_SETUPRND_RACE_2;SP_SETUPRND_RACE_3;SP_SETUPRND_G_TYPE_0;SP_SETUPRND_G_TYPE_1;SP_SETUPRND_G_TYPE_2;SP_SETUPRND_VCOND_0;SP_SETUPRND_VCOND_1;SP_SETUPRND_VCOND_2;SP_SETUPRND_VCOND_3;SP_SETUPRND_DIFFLVL_0;SP_SETUPRND_DIFFLVL_1;SP_SETUPRND_DIFFLVL_2;SP_SETUPRND_RESURCS_0;SP_SETUPRND_RESURCS_1;SP_SETUPRND_RESURCS_2;SP_SETUPRND_RESURCS_3;SP_SETUPRND_M_SIZE_0;SP_SETUPRND_M_SIZE_1;SP_SETUPRND_M_SIZE_2;SP_SETUPRND_M_SIZE_3;SP_SETUPRND_M_SIZE_4;SP_SETUPRND_M_SIZE_5;SP_SETUPRND_M_SIZE_6;SP_SETUPRND_M_RES_0;SP_SETUPRND_M_RES_1;SP_SETUPRND_M_RES_2;SP_SETUPRND_M_TYPE_0;SP_SETUPRND_M_TYPE_1;SP_SETUPRND_M_TYPE_2;SP_SETUPRND_M_TYPE_3;SP_SETUPRND_M_TYPE_4;SP_SETUPRND_M_TYPE_5;OPTIONS_T_SOPT;OPTIONS_T_SVOL;OPTIONS_T_USP;OPTIONS_T_BS;OPTIONS_T_NS;OPTIONS_T_MOPT;OPTIONS_T_MV;OPTIONS_T_CD;OPTIONS_T_GOPT;OPTIONS_T_GS;OPTIONS_T_SS;OPTIONS_T_PD;OPTIONS_T_UINT;OPTIONS_T_HC;OPTIONS_T_ML;OPTIONS_T_WE;OPTIONS_T_DN;OPTIONS_OK;ENDGAMEDLG_QUIT;ENDGAMEDLG_LOAD;ENDGAMEDLG_SAVE;ENDGAMEDLG_NEXT;ENDGAMEDLG_STAT;ENDGAMEDLG_RESTART;ENDGAMEDLG_WIN1;ENDGAMEDLG_WIN2;ENDGAMEDLG_LOSE1;ENDGAMEDLG_LOSE2;PEONS_CHOP;PEONS_DIG;PEONS_MINE;PEONS_BUILD;PEONS_REPAIR;PEONS_TEND COWS;PEONS_EXPLORE;PEONS_CAPTURE;PEONS_ATTACK;PEONS_AI FAR BUILD;PEONS_GATHER RESOURCE ITEMS;PEONS_USE TRANSPORT;CHAT_T_CHAT;LOAD_T_LOAD;LOAD_TYPE_0;LOAD_TYPE_1;LOAD_TYPE_2;LOAD_LOAD;LOAD_DEL;LOAD_CANCEL;SAVE_T_SAVE;SAVE_NEW;SAVE_SAVE;SAVE_DEL;SAVE_CANCEL;CAMPAIGN_T_CAM;CAMPAIGN_T_DESCR;CAMPAIGN_T_EMISS;CAMPAIGN_T_EMISDES;CAMPAIGN_BACK;CAMPAIGN_PLAY;EDIT_T_GAMENAME;DIPLOMACY_T_TITLE;DIPLOMACY_TRIBUTE;DIPLOMACY_SHVICTORY;DIPLOMACY_ACCEPT;DIPLOMACY_CANCEL;TRIBUTE_T_TITLE;TRIBUTE_CANCEL;TRIBUTE_SEND;MENU_INST;MENU_LOAD;MENU_SAVE;MENU_OPTI;MENU_REST;MENU_QUIT;MENU_BACK;MENU_SURR;MENU_DISCONNECT;OBJECTS_ACADEMY;OBJECTS_ARCHER;OBJECTS_BALLISTA;OBJECTS_BARRACK;OBJECTS_BAT;OBJECTS_BEAR;OBJECTS_BIRD;OBJECTS_BLACKSMITH;OBJECTS_BRIDGE;OBJECTS_CARPET;OBJECTS_CASTLE;OBJECTS_CATAPULT;OBJECTS_CATHEDRAL;OBJECTS_CHARIOT;OBJECTS_CHURCH E;OBJECTS_CHURCH R;OBJECTS_CHURCH A;OBJECTS_COW;OBJECTS_CRUSADEANCHOR;OBJECTS_CRUSADER;OBJECTS_DRAGON;OBJECTS_DUMMY;OBJECTS_DWARF;OBJECTS_EAGLE;OBJECTS_ENICHAR;OBJECTS_FARM;OBJECTS_FIELD;OBJECTS_FISH;OBJECTS_FISHING_BOAT;OBJECTS_FISHPATCH;OBJECTS_FOOTMAN E;OBJECTS_FOOTMAN A;OBJECTS_FOOTMAN R;OBJECTS_GALLEON;OBJECTS_GATE_STONE;OBJECTS_GATE_WOOD;OBJECTS_GHOST;OBJECTS_GROUND_OBJECT;OBJECTS_GROUND_PATCH;OBJECTS_HARBOR;OBJECTS_HCATAPULT;OBJECTS_HEAVY_CAVALRY;OBJECTS_HORSE_ARCHER;OBJECTS_HORSE_SAMURAI;OBJECTS_HOUSE;OBJECTS_HULK;OBJECTS_ITEM;OBJECTS_ITEM_FLAG;OBJECTS_ITEM_HEALTH;OBJECTS_ITEM_MAGIC;OBJECTS_ITEM_PLUSPLUS;OBJECTS_ITEM_SCROLL;OBJECTS_ITEM_SOUL;OBJECTS_JIHAD_WARRIOR;OBJECTS_JINN;OBJECTS_KNIGHT;OBJECTS_LONGBOWMAN;OBJECTS_LUMBER;OBJECTS_MACEMAN E;OBJECTS_MACEMAN R;OBJECTS_MACEMAN A;OBJECTS_MAGE;OBJECTS_MAGETOWER;OBJECTS_MAGICWORKSHOP;OBJECTS_MARKET;OBJECTS_MONK;OBJECTS_MOSQUE;OBJECTS_NINJA;OBJECTS_ORK;OBJECTS_OUTPOST;OBJECTS_PEON;OBJECTS_PIKEMAN;OBJECTS_PRIEST;OBJECTS_RES_GOLD;OBJECTS_RES_STONE;OBJECTS_RESITEM;OBJECTS_RUIN;OBJECTS_SHAOLINN;OBJECTS_SKELETON;OBJECTS_SPY;OBJECTS_STABLE;OBJECTS_STORAGE;OBJECTS_TAVERN;OBJECTS_TCGUILD;OBJECTS_TOWER_STONE;OBJECTS_TOWER_STONE2;OBJECTS_TOWER_WOOD;OBJECTS_TOWER_WOOD2;OBJECTS_TOWER_ROCKET;OBJECTS_TRADER E;OBJECTS_TRADER R;OBJECTS_TROLL;OBJECTS_WALL_STONE;OBJECTS_WALL_WOOD;OBJECTS_WHIRLPOOL;OBJECTS_WORKSHOP;OBJECTS_XEBEC;OBJECTS_MAGICGATEWAY;OBJECTS_EVILCASTLE;ORDERS_NAMES_???;ORDERS_NAMES_FISHING_BOAT;ORDERS_NAMES_FISHING;ORDERS_NAMES_LOAN_RETURN;ORDERS_NAMES_LOAN;ORDERS_NAMES_LOAN_GOLD;ORDERS_NAMES_LOAN_STONE;ORDERS_NAMES_LOAN_IRON;ORDERS_NAMES_LOAN_FOOD;ORDERS_NAMES_LOAN_WOOD;ORDERS_NAMES_BRIBE;ORDERS_NAMES_REVEAL_SELF;ORDERS_NAMES_IMPERSONATE;ORDERS_NAMES_BECOME_JIHADW;ORDERS_NAMES_BECOME_PRIEST;ORDERS_NAMES_CLOAK;ORDERS_NAMES_UNCLOAK;ORDERS_NAMES_MURDER;ORDERS_NAMES_ITEM_USE;ORDERS_NAMES_ITEM_DROP;ORDERS_NAMES_ITEM_KILL;ORDERS_NAMES_ITEM_BERSERK;ORDERS_NAMES_MOVE;ORDERS_NAMES_REPAIR;ORDERS_NAMES_CAPTURE;ORDERS_NAMES_HARVEST;ORDERS_NAMES_ATTACK;ORDERS_NAMES_ATTACK_GROUND;ORDERS_NAMES_HOLD_STEADY;ORDERS_NAMES_SELECT_CRUSADERS;ORDERS_NAMES_STAND_GROUND;ORDERS_NAMES_ATTACK_TYPE;ORDERS_NAMES_EXORCISM;ORDERS_NAMES_PICK_ITEM;ORDERS_NAMES_GUARD;ORDERS_NAMES_PATROL;ORDERS_NAMES_GATEOPEN;ORDERS_NAMES_GATECLOSE;ORDERS_NAMES_GATE_SUBAI_ON;ORDERS_NAMES_GATE_SUBAI_OFF;ORDERS_NAMES_E_BARRACK;ORDERS_NAMES_DUMMY;ORDERS_NAMES_TCGUILD;ORDERS_NAMES_E_BLACKSMITH;ORDERS_NAMES_MAGETOWER;ORDERS_NAMES_WALL_STONE;ORDERS_NAMES_WALL_WOOD;ORDERS_NAMES_E_BUILD;ORDERS_NAMES_R_BUILD;ORDERS_NAMES_A_BUILD;ORDERS_NAMES_E_CASTLE;ORDERS_NAMES_MAGICWORKSHOP;ORDERS_NAMES_CATHEDRAL;ORDERS_NAMES_SHAOLINN;ORDERS_NAMES_MOSQUE;ORDERS_NAMES_E_CHURCH;ORDERS_NAMES_E_FARM;ORDERS_NAMES_E_FOOTMAN;ORDERS_NAMES_A_RHONIN;ORDERS_NAMES_R_JANISSARY;ORDERS_NAMES_ORK;ORDERS_NAMES_R_SATRAP;ORDERS_NAMES_R_FOOTMAN;ORDERS_NAMES_R_SPEARMAN;ORDERS_NAMES_JINN;ORDERS_NAMES_DWARF;ORDERS_NAMES_TROLL;ORDERS_NAMES_A_HORSEARCHER;ORDERS_NAMES_R_HORSEARCHER;ORDERS_NAMES_R_CAVALRY;ORDERS_NAMES_A_HORSESAMURAI;ORDERS_NAMES_E_ARCHER;ORDERS_NAMES_R_ARCHER;ORDERS_NAMES_A_ARCHER;ORDERS_NAMES_A_SAMURAI;ORDERS_NAMES_E_MAGE;ORDERS_NAMES_R_MAGE;ORDERS_NAMES_A_MAGE;ORDERS_NAMES_E_OUTPOST;ORDERS_NAMES_E_HARBOR;ORDERS_NAMES_E_LUMBER;ORDERS_NAMES_E_MARKET;ORDERS_NAMES_E_CARAVAN;ORDERS_NAMES_R_CARAVAN;ORDERS_NAMES_GATE_WOOD;ORDERS_NAMES_GATE_STONE;ORDERS_NAMES_FIELD;ORDERS_NAMES_E_PEON;ORDERS_NAMES_R_PEON;ORDERS_NAMES_A_PEON;ORDERS_NAMES_NINJA;ORDERS_NAMES_MONK;ORDERS_NAMES_E_MACEMAN;ORDERS_NAMES_E_PRIEST;ORDERS_NAMES_A_PRIEST;ORDERS_NAMES_R_PRIEST;ORDERS_NAMES_CHARIOT;ORDERS_NAMES_E_LONGBOWMAN;ORDERS_NAMES_E_KNIGHT;ORDERS_NAMES_E_STABLE;ORDERS_NAMES_STOP;ORDERS_NAMES_E_STORAGE;ORDERS_NAMES_E_TAVERN;ORDERS_NAMES_E_WORKSHOP;ORDERS_NAMES_EMERGE;ORDERS_NAMES_E_GALLEON;ORDERS_NAMES_E_HULK;ORDERS_NAMES_E_XEBEC;ORDERS_NAMES_BRIDGE;ORDERS_NAMES_E_ACADEMY;ORDERS_NAMES_E_TOWER_STONE;ORDERS_NAMES_E_TOWER_STONE2;ORDERS_NAMES_TOWER_ROCKET;ORDERS_NAMES_E_TOWER_WOOD;ORDERS_NAMES_E_TOWER_WOOD2;ORDERS_NAMES_VIEW_HEROES;ORDERS_NAMES_VIEW_SPYS;ORDERS_NAMES_VIEW_ITEMS;ORDERS_NAMES_E_HOUSE;ORDERS_NAMES_E_PIKEMAN;ORDERS_NAMES_E_SPY;ORDERS_NAMES_CATAPULT;ORDERS_NAMES_H_CATAPULT;ORDERS_NAMES_TO_WTOWER2;ORDERS_NAMES_TO_STOWER;ORDERS_NAMES_TO_STOWER2_1;ORDERS_NAMES_TO_STOWER2_2;ORDERS_NAMES_TO_SWALL;ORDERS_NAMES_TO_SGATE;ORDERS_NAMES_TE_ARROW_1;ORDERS_NAMES_TE_PLATEARMOR;ORDERS_NAMES_TE_FIELDS;ORDERS_NAMES_TE_LIVESTOCK;ORDERS_NAMES_TE_FEUDALISM;ORDERS_NAMES_TE_ARCHITECTURE;ORDERS_NAMES_TE_LONGBOW;ORDERS_NAMES_RAISEDEAD;ORDERS_NAMES_SPELL_HEAL;ORDERS_NAMES_SPELL_SPAWNDRAGON;ORDERS_NAMES_SPELL_RAISEEXP;ORDERS_NAMES_SPELL_FLAMEBOLT;ORDERS_NAMES_SPELL_BLESS;ORDERS_NAMES_SPELL_FREEZE;ORDERS_NAMES_SPELL_WHIRLPOOL;ORDERS_NAMES_SPELL_TURNTOSTONE;ORDERS_NAMES_SPELL_LIGHTNING;ORDERS_NAMES_SPELL_FIRERAIN;ORDERS_NAMES_SPELL_SPAWNBAT;ORDERS_NAMES_SPELL_SPAWNSTONEGOLEM;ORDERS_NAMES_SPELL_SPAWNCARPET;ORDERS_NAMES_SPELL_SPAWNJIN;ORDERS_NAMES_SPELL_MAGICVISION;ORDERS_NAMES_SPELL_RAISEDEAD;ORDERS_NAMES_SPELL_BERSERK;ORDERS_NAMES_SPELL_HYPNOTIZE;ORDERS_NAMES_SPELL_CLOAK;ORDERS_NAMES_UNLOAD;ORDERS_NAMES_TRADE;ORDERS_NAMES_BUILD_ITEM;ORDERS_NAMES_TRADE1;ORDERS_NAMES_TRADE_SHIP;ORDERS_NAMES_DIE;ORDERS_NAMES_DEFAULT;ORDERS_NAMES_MINE;ORDERS_NAMES_DIG;ORDERS_NAMES_CHOP;ORDERS_NAMES_SPELL;ORDERS_NAMES_PREACH_CRUSADE;ORDERS_NAMES_COW;ORDERS_NAMES_TO_SHIP_LEVEL2;ORDERS_NAMES_TO_SHIP_LEVEL3;ORDERS_NAMES_TO_SHIP_LEVEL4;ORDERS_NAMES_TO_SHIP_LEVEL5;ORDERS_NAMES_TO_SHIP_LEVEL6;ORDERS_NAMES_TO_CONVERTRES;ORDERS_NAMES_HOLDFIRE;ORDERS_NAMES_FIREATWILL;ORDERS_NAMES_EXPLORE;ORDERS_NAMES_BALLISTA;ORDERS_NAMES_TE_HALBERD;ORDERS_NAMES_TE_GOLDPLUS;ORDERS_NAMES_TE_STONEPLUS;ORDERS_NAMES_TE_WOODPLUS;ORDERS_NAMES_TE_LEARNING;ORDERS_NAMES_TE_TEMPERIRON;ORDERS_NAMES_TE_CROSSBOW;ORDERS_NAMES_TE_SCALEARMOR;ORDERS_NAMES_TE_CHAINMAIL;ORDERS_NAMES_TE_ENGINEERING;ORDERS_NAMES_TE_CANNONTOWER;ORDERS_NAMES_TE_HEROISM;ORDERS_NAMES_TE_NOBILITY;ORDERS_NAMES_TE_HONOR;ORDERS_NAMES_TE_WARFARE;ORDERS_NAMES_TE_TACTICS;ORDERS_NAMES_TE_MERCENARIES;ORDERS_NAMES_TE_HEROESQUEST;ORDERS_NAMES_TE_FAME;ORDERS_NAMES_TE_SIEGETACTICS;ORDERS_NAMES_TE_BODYBUILDING;ORDERS_NAMES_TE_FANATICISM;ORDERS_NAMES_TE_CRUSADE;ORDERS_NAMES_TE_ESPIONAGE;ORDERS_NAMES_TE_INQUISITION;ORDERS_NAMES_TE_HEALING;ORDERS_NAMES_TE_MEDICINE;ORDERS_NAMES_TE_TRADEROUTES;ORDERS_NAMES_TE_MAPMAKING;ORDERS_NAMES_TE_USURY;ORDERS_NAMES_TE_GAMBLING;ORDERS_NAMES_TE_SUPPLYSTORAGE;ORDERS_NAMES_TE_BRIBERY;ORDERS_NAMES_TE_BUDDHISM;ORDERS_NAMES_TE_TRADETAXES;ORDERS_NAMES_TE_BAT;ORDERS_NAMES_TE_STONEGOLEM;ORDERS_NAMES_TE_INVISIBILITY;ORDERS_NAMES_TE_LIGHTNING;ORDERS_NAMES_TE_FREEZE;ORDERS_NAMES_TE_BLESS;ORDERS_NAMES_TAVERN_MERC;ORDERS_NAMES_TAVERN_HERO;ORDERS_NAMES_MARKET_ITEMS;ORDERS_NAMES_MARKET_SELL;ORDERS_NAMES_TE_LANDINGTACTICS;ORDERS_NAMES_TE_COWPOACHING;ORDERS_NAMES_TE_SLAVERY;ORDERS_NAMES_TE_RIDINGHORSES;ORDERS_NAMES_TE_JANISSARY;ORDERS_NAMES_TE_JIHAD;ORDERS_NAMES_TE_MAGICCARPET;ORDERS_NAMES_TE_JIN;ORDERS_NAMES_TE_WITCHCRAFTS;ORDERS_NAMES_TE_RAINOFFIRE;ORDERS_NAMES_TE_MAGICVISION;ORDERS_NAMES_TE_NECROMANCY;ORDERS_NAMES_GAMBLE;ORDERS_NAMES_TE_HORSEMANSHIP;ORDERS_NAMES_TE_SCIMITAR;ORDERS_NAMES_TE_OREFLOATATION;ORDERS_NAMES_TE_JEWELRY;ORDERS_NAMES_TE_GREATWALL;ORDERS_NAMES_TE_BUDHISM;ORDERS_NAMES_TE_IRRIGATION;ORDERS_NAMES_TE_ARMOREDCHARIOT;ORDERS_NAMES_TE_BUSHIDO;ORDERS_NAMES_TE_SUNTZUBOOK;ORDERS_NAMES_TE_MEDITATION;ORDERS_NAMES_TE_PHILOSOPHY;ORDERS_NAMES_TE_KUNGFU;ORDERS_NAMES_TE_NINJAS;ORDERS_NAMES_TE_MASTERY;ORDERS_NAMES_TE_TOURNAMENTS;ORDERS_NAMES_TE_BANKING;ORDERS_NAMES_TE_CHEMISTRY;ORDERS_NAMES_TE_GUNPOWDER;ORDERS_NAMES_TE_ROCKETARROW;ORDERS_NAMES_TE_SEAFOOD;ORDERS_NAMES_TE_CONCENTRATION;ORDERS_NAMES_TE_BERSERK;ORDERS_NAMES_TE_WHIRLPOOL;ORDERS_NAMES_TE_DRAGON;ORDERS_NAMES_TE_TURNTOSTONE;ORDERS_NAMES_TE_FLAMEBOLT;ORDERS_NAMES_TE_ARTOFRIDING;ORDERS_NAMES_BUILD_ORC;ORDERS_NAMES_BUILD_DWARF;ORDERS_NAMES_BUILD_SKELETON;ORDERS_NAMES_BUILD_GHOST;ORDERS_NAMES_VIEW_QUESTS;ORDERS_NAMES_R_JIHAD_WARRIOR;ORDERS_NAMES_E_COMMON;ORDERS_NAMES_E_RARE;ORDERS_NAMES_E_GUILDS;ORDERS_NAMES_R_COMMON;ORDERS_NAMES_R_RARE;ORDERS_NAMES_R_GUILDS;ORDERS_NAMES_A_COMMON;ORDERS_NAMES_A_RARE;ORDERS_NAMES_A_GUILDS;ORDERS_NAMES_TR_TRADE;ORDERS_NAMES_TR_CANCEL;ORDERS_NAMES_TR_AMOUNT;ORDERS_NAMES_TR_SRCOBJ;ORDERS_NAMES_TR_SRCRES;ORDERS_NAMES_TR_DSTOBJ;ORDERS_NAMES_TR_DSTRES;ORDERS_NAMES_GM_RES;ORDERS_NAMES_GM_AMOUNT;ORDERS_NAMES_GM_PROP;ORDERS_NAMES_GM_GAMBLE;ORDERS_NAMES_GM_CANCEL;ORDERS_NAMES_BU_ITEM;ORDERS_NAMES_BU_AMOUNT;ORDERS_NAMES_BU_CANCEL;ORDERS_NAMES_BU_BUILD;ORDERS_NAMES_TR1_TRADE;ORDERS_NAMES_TR1_CANCEL;ORDERS_NAMES_TR1_AMOUNT1;ORDERS_NAMES_TR1_AMOUNT2;ORDERS_NAMES_TR1_SRCRES;ORDERS_NAMES_TR1_DSTRES;ORDERS_ADD_TE_SLAVERY;ORDERS_ADD_TE_STONEGOLEM;ORDERS_ADD_TE_FREEZE;ORDERS_ADD_TE_LIGHTNING;ORDERS_ADD_TE_INVISIBILITY;ORDERS_ADD_TE_BAT;ORDERS_ADD_TE_CRUSADE;ORDERS_ADD_TE_BLESS;ORDERS_ADD_TE_LONGBOW;ORDERS_ADD_TE_PLATEARMOR;ORDERS_ADD_TE_FIELDS;ORDERS_ADD_TE_LIVESTOCK;ORDERS_ADD_TE_FEUDALISM;ORDERS_ADD_TE_ARCHITECTURE;ORDERS_ADD_TE_LONGBOWMAN;ORDERS_ADD_TE_HALBERD;ORDERS_ADD_TE_GOLDPLUS;ORDERS_ADD_TE_STONEPLUS;ORDERS_ADD_TE_WOODPLUS;ORDERS_ADD_TE_LEARNING;ORDERS_ADD_TE_TEMPERIRON;ORDERS_ADD_TE_CROSSBOW;ORDERS_ADD_TE_SCALEARMOR;ORDERS_ADD_TE_CHAINMAIL;ORDERS_ADD_TE_ENGINEERING;ORDERS_ADD_TE_CANNONTOWER;ORDERS_ADD_TE_HEROISM;ORDERS_ADD_TE_NOBILITY;ORDERS_ADD_TE_HONOR;ORDERS_ADD_TE_WARFARE;ORDERS_ADD_TE_TACTICS;ORDERS_ADD_TE_MERCENARIES;ORDERS_ADD_TE_HEROESQUEST;ORDERS_ADD_TE_FAME;ORDERS_ADD_TE_SIEGETACTICS;ORDERS_ADD_TE_BODYBUILDING;ORDERS_ADD_TE_FANATICISM;ORDERS_ADD_TE_ESPIONAGE;ORDERS_ADD_TE_INQUISITION;ORDERS_ADD_TE_HEALING;ORDERS_ADD_TE_MEDICINE;ORDERS_ADD_TE_TRADETOUTES;ORDERS_ADD_TE_MAPMAKING;ORDERS_ADD_TE_PIRACY;ORDERS_ADD_TE_USURY;ORDERS_ADD_TE_SUPPLYSTORAGE;ORDERS_ADD_TE_BRIBERY;ORDERS_ADD_TE_BUDDHISM;ORDERS_ADD_TE_TRADETAXES;ORDERS_ADD_TE_LANDINGTACTICS;ORDERS_ADD_TE_BOARDINGRAM;ORDERS_ADD_TE_COWPOACHING;ORDERS_ADD_TE_RIDINGHORSES;ORDERS_ADD_TE_JANISSARY;ORDERS_ADD_TE_JIHAD;ORDERS_ADD_TE_MAGICCARPET;ORDERS_ADD_TE_JIN;ORDERS_ADD_TE_WITCHCRAFTS;ORDERS_ADD_TE_MAGICVISION;ORDERS_ADD_TE_NECROMANCY;ORDERS_ADD_TE_HORSEMANSHIP;ORDERS_ADD_TE_SCIMITAR;ORDERS_ADD_TE_OREFLOATATION;ORDERS_ADD_TE_JEWELRY;ORDERS_ADD_TE_GREATWALL;ORDERS_ADD_TE_BUDHISM;ORDERS_ADD_TE_IRRIGATION;ORDERS_ADD_TE_ARMOREDCHARIOT;ORDERS_ADD_TE_BUSHIDO;ORDERS_ADD_TE_SUNTZUBOOK;ORDERS_ADD_TE_MEDITATION;ORDERS_ADD_TE_PHILOSOPHY;ORDERS_ADD_TE_KUNGFU;ORDERS_ADD_TE_NINJAS;ORDERS_ADD_TE_MASTERY;ORDERS_ADD_TE_TOURNAMENTS;ORDERS_ADD_TE_BANKING;ORDERS_ADD_TE_CHEMISTRY;ORDERS_ADD_TE_GUNPOWDER;ORDERS_ADD_TE_ROCKETARROW;ORDERS_ADD_TE_SEAFOOD;ORDERS_ADD_TE_CONCENTRATION;ORDERS_ADD_TE_BERSERK;ORDERS_ADD_TE_WHIRLPOOL;ORDERS_ADD_TE_DRAGON;ORDERS_ADD_TE_TURNTOSTONE;ORDERS_ADD_TE_FLAMEBOLT;ORDERS_ADD_TE_ARTOFRIDING;ORDERS_ADD_TE_TRADEROUTES;ORDERS_ADD_TE_GAMBLE;SPELL_NAMES_SPELL_FIRERAIN;SPELL_NAMES_SPELL_LIGHTNING;SPELL_NAMES_SPELL_HEAL;SPELL_NAMES_SPELL_SPAWNCARPET;SPELL_NAMES_SPELL_SPAWNBAT;SPELL_NAMES_SPELL_BLESS;SPELL_NAMES_SPELL_FREEZE;SPELL_NAMES_SPELL_BERSERK;SPELL_NAMES_SPELL_SOULBIND;SPELL_NAMES_SPELL_CLOAK;SPELL_NAMES_SPELL_SPAWNSTONEGOLEM;SPELL_NAMES_SPELL_MAGICVISION;SPELL_NAMES_SPELL_RAISEDEAD;SPELL_NAMES_SPELL_TURNTOSTONE;SPELL_NAMES_SPELL_WHIRLPOOL;SPELL_NAMES_SPELL_SPAWNDRAGON;SPELL_NAMES_SPELL_FLAMEBOLT;SPELL_NAMES_SPELL_RAISEEXP;SPELL_NAMES_SPELL_SPAWNJIN;SPELL_NAMES_SPELL_CURSE;SPELL_NAMES_SPELL_HYPNOTIZE;IMAGES_FLAG_CAPTURE;IMAGES_ITEM_BOOK1;IMAGES_ITEM_BOOK2;IMAGES_ITEM_BOOK3;IMAGES_ITEM_BOW1;IMAGES_ITEM_BOW2;IMAGES_ITEM_BOW3;IMAGES_ITEM_FLAG;IMAGES_ITEM_FOOD;IMAGES_ITEM_GOLD;IMAGES_ITEM_IRON;IMAGES_ITEM_POTION1;IMAGES_ITEM_POTION2;IMAGES_ITEM_POTION3;IMAGES_ITEM_POTION4;IMAGES_ITEM_POTION5;IMAGES_ITEM_POTION6;IMAGES_ITEM_POTION7;IMAGES_ITEM_POTION8;IMAGES_ITEM_SCROLL1;IMAGES_ITEM_SHIELD1;IMAGES_ITEM_SHIELD2;IMAGES_ITEM_SHIELD3;IMAGES_ITEM_STONE;IMAGES_ITEM_SWORD;IMAGES_ITEM_SWORD1;IMAGES_ITEM_SWORD2;IMAGES_ITEM_SWORD3;IMAGES_ITEM_WOOD;TZAREDIT_S1;TZAREDIT_S2;HELP_???;HELP_SP_CAMPAIGN;HELP_SP_CUSTOM_MAP;HELP_SP_RANDOM_MAP;HELP_SP_LOAD_GAME;HELP_SP_BACK;HELP_CN_CAMPAIGNS;HELP_CN_CAMPAIGN_DESCRIPTION;HELP_CN_ENTRY_MISSONS;HELP_CN_ENTRY_MISSONS_DESCRIPTION;HELP_CN_BACK;HELP_CN_PLAY;HELP_CM_MAPS;HELP_CM_MAP_DECRIPTION;HELP_CM_PLAY;HELP_CM_BACK;HELP_RM_PLAYER_COLOR;HELP_RM_PLAYER_NAME;HELP_RM_PLAYER_CIVILIVIZATION;HELP_RM_PLAYER_TEAM;HELP_RM_NUMBER_OF_PLAYERS;HELP_RM_POP_LIMIT;HELP_RM_GAME_TYPE;HELP_RM_DIFFICULTY_LEVEL;HELP_RM_VICTORY_CONDITION;HELP_RM_STARTING_RESOURCES;HELP_RM_NO_FOG;HELP_RM_EXPLORE;HELP_RM_MAP_SIZE;HELP_RM_MAP_TYPE;HELP_RM_TERRAIN;HELP_RM_MAP_RESOURCES;HELP_RM_GUARDED_TOWN;HELP_RM_AMNIMALS;HELP_RM_MAGIC_ITEMS;HELP_RM_CLIFFS;HELP_RM_GATEWAYS;HELP_RM_PLAY;HELP_RM_BACK;HELP_RM_VALUE;HELP_LG_SELECT_GAME;HELP_LG_CHOOSE;HELP_LG_LOAD;HELP_LG_CANCEL;HELP_LG_DELETE;HELP_MP_PLAYER_NAME;HELP_MP_GAME_NAME;HELP_MP_IPX;HELP_MP_TCP/IP;HELP_MP_IP_ADDRESS;HELP_MP_CREATE;HELP_MP_SEARCH;HELP_MP_JOIN;HELP_MP_BACK;HELP_MP_GAMES_FOUND;HELP_MP_GAME_INFORMATION;HELP_MP_BETA;HELP_MPC_CHECK_BUTTON;HELP_MPC_PLAYER_COLOR;HELP_MPC_PLAYER_NAME;HELP_MPC_PLAYER_CIVILIVIZATION;HELP_MPC_PLAYER_TEAM;HELP_MPC_CHAT_BOX;HELP_MPC_CHAT_BOX_WRITE;HELP_MPC_SETTINGS;HELP_MPC_MAP;HELP_MPC_DISCONNECT;HELP_MPC_PLAY;HELP_MPS_RANDOM_MAP;HELP_MPS_CUSTOM_MAP;HELP_MPS_POP_LIMIT;HELP_MPS_GAME_TYPE;HELP_MPS_DIFFICULTY_LEVEL;HELP_MPS_VICTORY_CONDITION;HELP_MPS_STARTING_RESOURCES;HELP_MPS_MAP_SIZE;HELP_MPS_MAP_TYPE;HELP_MPS_TERRAIN;HELP_MPS_MAP_RESOURCES;HELP_MPS_TOWERS;HELP_MPS_AMNIMALS;HELP_MPS_MAGIC_ITEMS;HELP_MPS_CLIFFS;HELP_MPS_GATEWAYS;HELP_MPS_DAY_NIGTH;HELP_MPS_WEATHER;HELP_MPS_NO_FOG;HELP_MPS_EXPLORE;HELP_MPS_ACCEPT;HELP_MPS_CANCEL;HELP_MPS_MAPS_LIST;HELP_MPS_MAP_DECRIPTION;HELP_MPS_USE_MAP_SETTINGS;HELP_MPS_VALUE;HELP_SG_SAVE_GAME;HELP_SG_NEW;HELP_SG_SAVE;HELP_SG_DELETE;HELP_SG_CANCEL;HELP_SG_RESTART;HELP_SG_QUIT;HELP_SG_LIST;HELP_CH_BOX;HELP_CH_ALLIES;HELP_CH_ENEMIES;HELP_CH_ALL;HELP_CH_CUSTOM;HELP_CH_SELECT_PLAYER;HELP_CH_NAMES;HELP_CH_COLORS;HELP_D_ALLIES;HELP_D_ENEMIES;HELP_D_NEUTRAL;HELP_D_SHARED VISION;HELP_D_SHARED RESOURCES;HELP_D_SHARED UNIT CONTROL;HELP_D_SHARED_VICTORY;HELP_D_ACCEPT;HELP_D_CANCEL;HELP_D_TRIBUTE;HELP_T_AMOUNT;HELP_T_SEND;HELP_T_CANCEL;HELP_CM1_PLAYER_COLOR;HELP_CM1_PLAYER_NAME;HELP_CM1_PLAYER_CIVILIVIZATION;HELP_CM1_PLAYER_TEAM;HELP_CM1_NUMBER_OF_PLAYERS;HELP_CM1_POP_LIMIT;HELP_CM1_GAME_TYPE;HELP_CM1_DIFFICULTY_LEVEL;HELP_CM1_VICTORY_CONDITION;HELP_CM1_STARTING_RESOURCES;HELP_CM1_NO_FOG;HELP_CM1_EXPLORE;HELP_CM1_USE_MAP_SETTINGS;HELP_CM1_MAP_DECRIPTION;HELP_CM1_VALUE;HELP_CM1_BACK;HELP_CM1_PLAY;HELP_O_SOUND_VOLUME;HELP_O_CHK_VOLUME;HELP_O_UNIT_SPEECH;HELP_O_BUILDING_SOUND;HELP_O_NATURE_SOUND;HELP_O_GAME_SPEED;HELP_O_SCROLL_SPEED;HELP_O_PATH_DEPTH;HELP_O_DAY_NIGTH;HELP_O_WEATHER;HELP_O_MUSIC_VOLUME;HELP_O_CHK_MVOLUME;HELP_O_CD;HELP_O_H_CURS;HELP_O_MENU;HELP_O_OK;HELP_MPS_AI_ASSIST;HELP_MPS_SH_RES;HELP_MPS_TOWERS_POP;VM_LOC_SENT;VM_BOOKMARK_SET;VM_TIME_LIMIT_HIT;VM_TIME_LIMIT_REACHED;VM_SCORE_LIMIT_HIT;VM_SCORE_LIMIT_REACHED;VM_SAVING;VM_DISCON1;VM_DISCON2;TZAREDIT_DELETE;TZAREDIT_ANY;TZAREDIT_MILITARY_UNITS;TZAREDIT_DELAY;TZAREDIT_REMOVE;OBJECTS_MESSIAH;ERR_NOMAPS;ERR_FIRST;ERR_EXPLASYNC;ERR_OBJASYNC;ERR_BADKINGDOMSCRIPT;ORDERS_NAMES_TE_INVINSIBILITY;ORDERS_NAMES_TE_IRONPLUS;ORDERS_NAMES_TO_WALL_STONE;ORDERS_NAMES_TO_GATE_STONE;ORDERS_NAMES_VIEW_AI;ORDERS_NAMES_SET_AI_NONE;ORDERS_NAMES_SET_AI_FULL;ORDERS_NAMES_SET_AI_WAR;ORDERS_NAMES_SET_AI_ECO;CHOOSEAI_TITLE;CHOOSEAI_OK;CHOOSEAI_CANCEL;CHOOSEAI_DEFAULT;ENDGAMEDLG_HIDE;MISC_SELLITEM3;MISC_HERO3;MISC_KINGDOM3;MISC_QUICKSAVE3;MISC_AUTOSAVE3;MISC_NATURE3;MISC_RESCUE3;MISC_BUY3;MISC_PREVPAGE3;MISC_NEXTPAGE3;MISC_VIEW3;MISC_REQ3;MISC_INF3;MISC_HIRE3;MISC_RETLOAN3;MISC_GETLOAN3;MISC_WATOBJ3;MISC_RES3;MISC_TREES3;MISC_UNK3;MISC_RND3;MISC_UNKAUTHOR3;MISC_HEALTH3;MISC_EXP3;MISC_MANNA3;MISC_DEFENCE3;MISC_ATTACK3;MISC_SWORD3;MISC_SHIELD3;MISC_BOW3;MSG_GAME_CONNECT;MSG_GAME_SPEED_TURBO;MSG_AIFULL3;MSG_AIECO3;MSG_AIWAR3;MSG_AIOFF3;MSG_NET_JOIN_HEADOFF;MSG_GOLDREQ;MSG_GAME_SPEED2;ERR3_ERR_CONNECT;ERR3_RANKSLOST;ORDERS_NAMES_DESTROY;ORDERS_NAMES_ONLINEHELP;ORDERS_NAMES_NEXTIDLE;ORDERS_NAMES_BOOK_ITM;ORDERS_NAMES_POTION_ITM;ORDERS_NAMES_POWER_ITM;TZAREDIT_ANY_MAJOR_OBJECTS;DEFMSG_CAPTUREOWN;MP_SETUPMAP_SH_RES;MP_SETUPMAP_TOWERS_POP;VM_SENDRESULTS;VM_SENDRESULTS2;SYSTEM_LANGUAGE;DOWNLOADING_GRAPHICS;WEBAUDIO;CONNECTION_ERROR;DOWNLOAD_ALL;MAPEDITOR;TEAM;COLOUR;MAXHEALTH;PLAYING;WAITING;ADD;WATER;AUTOFULLSCREEN;FULLSCREEN;UP;DOWN;LANGUAGE;INITIAL_PEASANTS;ADD_AI;RACE;DATE;FREE_POP;ABOUT;PLAYED_TIME;ZOOMSPEED".split(";"),
Ia,W,Ma,Rb={},Sc="ts1.mp3 ts2.mp3 ts3.mp3 ts4.mp3 ts5.mp3 ts6.mp3 ts7.mp3 ts8.mp3 ts9.mp3 ts10.mp3 sr1.mp3 sr2.mp3 sr3.mp3 sr4.mp3 sr5.mp3 sr6.mp3 sr7.mp3 sr8.mp3 sr9.mp3 sr10.mp3 o1.mp3 o2.mp3 o3.mp3 o4.mp3 o5.mp3 o6.mp3 o7.mp3 o8.mp3 o9.mp3 o10.mp3 INTRO.mp3 OUTRO.mp3 WIN1.mp3 WIN2.mp3 ATTACK.mp3 BALLISTA.mp3 BLDGDONE.mp3 CHAT%20LOCATION.mp3 TECHDONE.mp3 UNITDONE.mp3 CHAT.mp3 E_CASTLE1.mp3 E_CATHEDRAL1.mp3 E_CATHEDRAL2.mp3 E_FARM1.mp3 E_CHURCH1.mp3 E_FARM2.mp3 E_HARBOR1.mp3 E_LUMBER1.mp3 E_MAGETOWER1.mp3 E_MAGETOWER2.mp3 E_MAGETOWER3.mp3 E_MARKET1.mp3 E_SHIPYARD1.mp3 E_STABLES1.mp3 E_STORAGE1.mp3 E_OUTPOST1.mp3 E_STORAGE2.mp3 E_TAVERN1.mp3 E_WARACADEMY1.mp3 E_WORKSHOP1.mp3 EVILCASTLE.mp3 GATE1.mp3 GATE2.mp3 GATE3.mp3 GATE4.mp3 GATE5.mp3 GATE6.mp3 GATEWAY.mp3 HOUSE1.mp3 HOUSE2.mp3 HOUSE3.mp3 HOUSE4.mp3 HOUSE5.mp3 MERCHANT.mp3 MINE1.mp3 MONASTERY1.mp3 MONASTERY2.mp3 R_CATHEDRAL1.mp3 R_CHURCH1.mp3 SHAOLIN2.mp3 SHAOLIN.mp3 CHOP%201.mp3 CHOP%202.mp3 CHOP%203.mp3 CHOP%204.mp3 CHOP%205.mp3 CHOP%206.mp3 CHOP%207.mp3 CHOP%208.mp3 CHOP%209.mp3 CHOP%2010.mp3 CHOP%2011.mp3 DIG%201.mp3 DIG%202.mp3 DIG%203.mp3 MINE%201.mp3 MINE%202.mp3 MINE%203.mp3 HIT%201.mp3 HIT%202.mp3 HIT%203.mp3 HIT%204.mp3 HIT%205.mp3 HIT%206.mp3 HIT%207.mp3 GHOST1.mp3 GHOST2.mp3 GOLEM1.mp3 GOLEM2.mp3 H%20SWORD%201.mp3 H%20SWORD%202.mp3 H%20SWORD%203.mp3 H%20SWORD%204.mp3 H%20SWORD%205.mp3 H%20SWORD%206.mp3 H%20SWORD%207.mp3 H%20SWORD%208.mp3 H%20SWORD%209.mp3 H%20SWORD%2010.mp3 H%20SWORD%2011.mp3 H%20SWORD%2012.mp3 HAND1.mp3 HAND2.mp3 HAND3.mp3 HAND4.mp3 MAGE%20ATTACK.mp3 MESSIAH.mp3 ORC%20SWORD%201.mp3 ORC%20SWORD%202.mp3 ORC%20SWORD%203.mp3 ORC%20SWORD%204.mp3 ORC%20SWORD%205.mp3 ORC%20SWORD%206.mp3 ORC%20SWORD%20V1.mp3 ORC%20SWORD%20V2.mp3 ORC%20SWORD%20V3.mp3 SHIP%20CANNON%201.mp3 SHIP%20CANNON%202.mp3 SHIP%20CANNON%203.mp3 SHIP%20CANNON%204.mp3 SHIP%20CANNON%205.mp3 SHIP%20CANNON%206.mp3 SHIP%20CANNON%207.mp3 SIEGE.mp3 SWORD%201.mp3 SWORD%202.mp3 SWORD%203.mp3 SWORD%204.mp3 SWORD%205.mp3 SWORD%206.mp3 SWORD%207.mp3 SWORD%208.mp3 SWORD%209.mp3 SWORD%2010.mp3 SWORD%2011.mp3 SWORD%2012.mp3 SWORD%2013.mp3 SWORD%2014.mp3 SWORD%2015.mp3 SWORD%2016.mp3 V%20SWORD%201.mp3 V%20SWORD%202.mp3 V%20SWORD%203.mp3 V%20SWORD%204.mp3 V%20SWORD%205.mp3 V%20SWORD%206.mp3 V%20SWORD%207.mp3 ADRAGON2.mp3 ADRAGON3.mp3 ARROW%201.mp3 ARROW%202.mp3 ARROW%203.mp3 ARROW%204.mp3 ARROW%205.mp3 ARROW%206.mp3 ARROW%20V1.mp3 ARROW%20V2.mp3 ARROW%20V3.mp3 ARROW%20V4.mp3 BEAR1.mp3 BEAR2.mp3 BEAR3.mp3 BEAR4.mp3 BEAR5.mp3 MWORKSHOP.mp3 DESTROY%20BUILDING.mp3 DESTROY%20MINE.mp3 LIGHTING2.mp3 LIGHTING.mp3 METEOR.mp3 SMALL%20EXPLOSION.mp3 WATER%20BLOP.mp3 SPY%20KILL%201.mp3 SPY%20KILL%203.mp3 SPY%20KILL%202.mp3 PRIEST%20ATTACK.mp3 LIGHTNING.mp3 INVISIBLE.mp3 HEAL.mp3 FREEZE.mp3 FLAME%20BALL.mp3 CURSE.mp3 CRUSADE.mp3 CONFUSION.mp3 BLESS.mp3 WHIRLPOOL.mp3 TURN%20TO%20STONE.mp3 TEACH.mp3 SUMMON10.mp3 SUMMON9.mp3 SUMMON8.mp3 SUMMON7.mp3 SUMMON6.mp3 SUMMON5.mp3 SUMMON4.mp3 SUMMON3.mp3 SUMMON2.mp3 SUMMON1.mp3 REVEAL.mp3 RESSURECT.mp3 COWDIE1.mp3 COWDIE2.mp3 COWDIE3.mp3 COWDIE4.mp3 DIE%201.mp3 DIE%202.mp3 DIE%203.mp3 DIE%204.mp3 DIE%205.mp3 DIE%206.mp3 DIE%207.mp3 DIE%208.mp3 DIE%209.mp3 DIE%2010.mp3 DRAGON%20DIE%201.mp3 DRAGON%20DIE%202.mp3 GOLEM.mp3 H%20DIE%201.mp3 H%20DIE%202.mp3 H%20DIE%203.mp3 H%20DIE%204.mp3 H%20DIE%205.mp3 H%20DIE%206.mp3 H%20DIE%207.mp3 H%20DIE%208.mp3 H%20DIE%209.mp3 H%20DIE%2010.mp3 MAGE.mp3 ORC%20DIE%201.mp3 ORC%20DIE%202.mp3 SHIP%20SINK.mp3 SIEGE%20DIE%201.mp3 SIEGE%20DIE%202.mp3 SIEGE%20DIE%203.mp3 SIEGE%20DIE%204.mp3 SKELETON%20DIE%201.mp3 SKELETON%20DIE%202.mp3 SKELETON%20DIE%203.mp3 SKELETON%20DIE%204.mp3 MESSIAH_ATTACK.mp3 C%20DIE%201.mp3 C%20DIE%202.mp3 C%20DIE%203.mp3 C%20DIE%204.mp3 C%20DIE%205.mp3 CAMELDIE1.mp3 CAMELDIE2.mp3 CAMELDIE3.mp3 BAT%20ATTACK.mp3 BAT%20CMD.mp3 BAT%20DIE.mp3 CAMEL1.WAV CAMEL2.WAV CARPETCMD.WAV CATAPULT.WAV CBEAR1.WAV CBEAR2.WAV CBEAR3.WAV CBEAR4.WAV COW1.WAV COW2.WAV COW3.WAV COW4.WAV DRAGON1.WAV DRAGON2.WAV FLY1.WAV FLY2.WAV FOOT1.WAV FOOT2.WAV FOOT3.WAV FOOT4.WAV FOOT5.WAV FOOT6.WAV FOOT7.WAV FOOT8.WAV GHOST1CMD.WAV GHOST2CMD.WAV GHOST3CMD.WAV GOLEMCMD.WAV H%20CMD%201.WAV H%20CMD%202.WAV H%20CMD%203.WAV H%20CMD%204.WAV HEAVY%20CATAPULT.WAV INF%20CMD%201.WAV INF%20CMD%202.WAV INF%20CMD%203.WAV INF%20CMD%204.WAV INF%20CMD%205.WAV MESSIAHCMD.WAV ORC%20CMD%201.WAV ORC%20CMD%202.WAV ORC%20CMD%203.WAV ORC%20CMD%204.WAV ORC%20CMD%205.WAV ORC%20CMD%206.WAV SHIP%20CMD%201.WAV SHIP%20CMD%202.WAV SKELETON1.WAV SKELETON2.WAV SHIP%20SELECT.WAV E_BARRACK1.WAV E_BLACKSMITH1.WAV FIRE1.WAV FIRE2.WAV FIRE3.WAV FIRE4.WAV FIRE5.WAV ROCKET.WAV".split(" "),
Yd,ub,vb,$b=function(){if(!Ia){m.prototype.loadBuffer=function(a,d){var b=this;Zb(t.cdn+a,function(e){b.context.decodeAudioData(e).then(function(b){b&&z(b,a,d)})})};for(var c=0,a=Sc.length;c<a;c++){var e=Sc[c];Rb[e.split(".")[0].toLowerCase()]=e}B("");"undefined"!==typeof AudioContext&&(window.AudioContext=window.AudioContext||window.webkitAudioContext,Ia=new AudioContext,ub=Ia.createGain(),vb=Ia.createGain(),Yd=new m(Ia,void 0,z),B("Sound: OK"),ub.gain.value=parseInt(localStorage.musicRange)/100,
vb.gain.value=parseInt(localStorage.soundRange)/100,ub.connect(Ia.destination),vb.connect(Ia.destination));W=function(){if(!p.editor){W.id++;g("musicSelect")&&(localStorage.favMusic=g("musicSelect").mversion.value);var a=W.list[localStorage.favMusic];a&&Ma(a[~~(a.length*Math.random())],0,0,void 0,1,0,W.id)}};W.reset=function(){W.stop();W()};W.stop=function(){W.active&&(W.active.stop(),clearTimeout(W.intv))};W.id=0;W.list={originalMusic1:"o1 o2 o3 o4 o5 o6 o7 o8 o9 o10 outro".split(" "),originalMusic:"ts1 ts2 ts3 ts4 ts5 ts6 ts7 ts8 ts9 ts10".split(" "),
sharpRain:"sr1 sr2 sr3 sr4 sr5 sr6 sr7 sr8 sr9 sr10".split(" ")};Ma=function(a,d,e,c,r,f,g){"string"!==typeof a&&(a=Sc[a].split(".")[0].toLowerCase());var b=a;if((a=Rb[a])&&"loading"!==a&&!p.canceled){var h=-N+(window.innerWidth-t.mx)/2,k=-T+window.innerHeight/2;if(a.duration){if(p.started)if(64<p.now()-a.lastPlayed||!a.lastPlayed)a.lastPlayed=p.now();else return;if(!(!r&&"attack"!=b&&f&&600<Date.now()-f)){if(d){d=-h+32*d;e=-k+32*e;k=L;if(d*d+e*e>Math.pow(2E3,2))return!1;d/=80;e/=80;k/=8}else k=e=
d=0;void 0!==c&&c!==t.kingdom||p.mute||(c=Ia.createBufferSource(),c.buffer=a,r?(c.connect(ub),W.active=c,W.intv=setTimeout(W,Math.floor(1E3*a.duration)+1E3)):(a=Ia.createPanner(),a.panningModel="HRTF",a.setPosition(d,e,k),c.connect(a),a.connect(vb)),c.start(0))}}else Rb[b]="loading",r={x:d,y:e,k:c,music:r,date:Date.now(),mid:g},Yd.loadBuffer(a,r)}}}},Tc,Zd=function(){return Date.now()-Db+25*q.gcycle()},Xa=function(c){if(!(c&&p.online||Xa.bySystem&&c))if(0===p.paused){p.paused=1;void 0!=Tc&&clearInterval(Tc);
var a=p.now();p.pausedTime+=Date.now();c||(Xa.bySystem=1);p.now=function(){return a}}else p.pausedTime-=Date.now(),p.paused=0,Xa.bySystem=0,c&&g("alert")&&A("alert"),Tc=setInterval(ib,ib.speed),p.now=Zd};Xa.bySystem=0;Xa.fast=!0;var $d=function(c){c/=1E3;var a=~~(c/60)%60,e=~~(c/3600);c=~~(c%60);1===(c+"").length&&(c="0"+c);0!=e?(e+=":",10>a&&(a="0"+a)):e="";return e+a+":"+c},Db=0,ae=0,ib=function(){if(!p.editor){p.cycle=q.gcycle();p.now();Db&&(ae+=Date.now()-Db-ib.speed);Db=Date.now();var c=Date.now();
q.movtablexe();p.cycle=q.gcycle();0===p.cycle%40&&be();Uc+=Date.now()-c;0===p.cycle%40&&(g("topinfo").innerHTML="<span>CPU:"+(Uc/10).toFixed(2)+"%</span> <span>"+~~(Vc/Wc+.5)+"FPS</span> <span>"+$d(p.now())+"</span>",Vc=Wc=Uc=0);ae>=ib.speed&&ib()}};ib.speed=25;var Uc=0,Wc=0,Vc=0,ce=-1,Ja,ac,bc,jb,cc,oa,Xc,kb,wa,Yc,Y,de,ee,fe,ge,he,ie,dc,lb=function(){g("mgitem").style.backgroundPositionY=-48*q.mwicon()+"px";g("mgamount").innerHTML=q.amount()},ec=function(){if(!ec.setup){ec.setup=!0;g("content").innerHTML=
'\n<ul id="msgs1"></ul>\n<div id="clicks" style="display:none;margin-top:0;margin-left:151px"></div>\n\n<div id="playersinfo"></div>\n<div id="resources" style="display:block">\n<div id="gold"></div>\n<div id="wood"></div>\n<div id="food"></div>\n<div id="stone"></div>\n<div id="pop"></div>\n<div id="temperature"></div>\n</div>\n<div id="enterwindow" class="displaynone">\n<h2 id="sendMessageH2">'+l.CHAT_T_CHAT+'</h2>\n<input id="msginputGame" />\n</div>\n\n<div id="statButton"></div>\n<div id="topinfo"></div>\n<div id="bottominfo"></div>\n<div id="mapeditorinfo">\n<div id="sButtons"><button id="selectUnits">'+
l.SELVIEW_UNITS+'</button><button id="selectBuilds">'+l.builds+'</button><button id="selectItems">'+l.items+'</button><button id="selectNature">'+l.nature+'</button></div>\n<div id="mapeditorinfoUnits"></div>\n<div id="mapeditorinfoBuilds" style="display:none"></div>\n<div id="mapeditorinfoItems" style="display:none"></div>\n<div id="mapeditorinfoNature" style="display:none"></div>\n</div>\n<div id="mapeditorinfotop">\n<button id="menueditor">'+l.GAME_SCR_MENU+'</button>\n<button id="deleteUnit" style="color:#f00;font-weight:bold;font-size:19px">x</button>\n<button id="rotatebutton"></button>\n<button id="mapProps">'+
l.MENU_OPTI+'</button>\n<button id="mapRules">'+l.rules+'</button>\n<span>Brush size: </span><input type="number" min="1" max="256" value="6" id="brushSize"/>\n<span>Active kingdom</span>\n<select id="selectKingdom">\n</select>\n</div>\n<div id="minimap" style="position:absolute;top:31px;left:4px;z-index:99"></div>\n<div id="menu" style="display:block">\n<button id="gameMenu">'+l.GAME_SCR_MENU+'</button>\n<div style="width:151px;height:calc(100% - 741px);top:645px;background:url(nehhon/menurepeat.gif) repeat" id="kingdomcolor"></div>\n<div id="daynighticon"></div>\n<div id="icons20">\n<div id="attackmenu" style="display:none"></div>\n<div id="defencemenu" style="display:none"></div>\n<div id="levelmenu" style="display:none"></div>\n<div id="manamenu" style="display:none"></div>\n<div id="manamenu1" style="display:none"></div>\n</div>\n<div id="progressvalue"></div>\n<div id="kingdom"></div>\n<div id="unitname" contenteditable="true"></div>\n<progress id="progressone" style="display:none"></progress>\n<progress id="progressmana" style="display:none" max="100"></progress>\n<input id="unitSpeed" min="1" max="100" type="range"/>\n<canvas width="48" height="48" id="selectedobject"></canvas>\n<div id="navigation">\n<button id="aleft"></button>\n<button id="stock"></button>\n<button id="aright"></button>\n</div>\n<div id="orders">\n<button id="order1"><progress class="loadingunit" style="display:none"></progress></button>\n<button id="order2"></button>\n<button id="order3"></button>\n<button id="order4"></button>\n<button id="order5"></button>\n<button id="order6"></button>\n<button id="order7"></button>\n<button id="order8"></button>\n</div>\n<div id="magicworkshopmenu" style="display:none">\n<button id="mgbook"></button>\n<button id="mgpotion"></button>\n<button id="mgsword"></button>\n<button id="mgamount"></button>\n<button id="mgitem"></button>\n<button id="mgdecline"></button>\n<button id="mgaccept"></button>\n<div id="mgbak"></div>\n</div>\n</div>\n\n\n        ';
dc=g("msgs1");Y={page:0,length:8,leftButton:g("aleft"),rightButton:g("aright"),stock:g("stock")};Y.leftButton.onclick=function(){q.changePage(-1)};Ja=g("minimap");de=g("unitSpeed");ee=g("gold");fe=g("wood");ge=g("food");he=g("stone");ie=g("daynighticon");Y.rightButton.onclick=function(){q.changePage(1)};Y.displayed=[];ac=g("attackmenu");bc=g("defencemenu");jb=g("levelmenu");cc=g("kingdom");oa=g("progressone");Xc=g("unitname");kb=g("progressvalue");g("selectedobject");g("mgbook").onclick=function(){q.mwSelect(0);
lb()};g("mgpotion").onclick=function(){q.mwSelect(1);lb()};g("mgsword").onclick=function(){q.mwSelect(2);lb()};g("mgdecline").onclick=function(){g("magicworkshopmenu").style.display="none"};g("mgitem").onmousedown=function(a){var b=1;a.button&&(b*=-1);q.mwMore(b);lb()};g("mgaccept").onclick=function(){g("magicworkshopmenu").style.display="none";q.createItems()};g("mgamount").onmousedown=function(a){var b=1;a.button&&(b=-1);Eb.shift&&(b*=5);q.mwamount(b);lb()};Ja.addEventListener("mousedown",function(a){var b=
a.pageX-4,d=a.pageY-31;0===a.button?(document.addEventListener("mouseup",function C(a){document.removeEventListener("mouseup",C);document.removeEventListener("mousemove",fc)}),Zc=!0,fc(a),document.addEventListener("mousemove",fc)):2===a.button&&(b=~~(U*(a.pageX-4)/Ka),d=~~(U*(a.pageY-31)/ya),B(b,d),q.mouseUp(b,d,2,!0))});wa=[g("order1"),g("order2"),g("order3"),g("order4"),g("order5"),g("order6"),g("order7"),g("order8")];Yc=g("bottominfo");for(var c=0,a=wa.length;c<a;c++)wa[c].addEventListener("mousedown",
Df),wa[c].addEventListener("mouseup",Ef),wa[c].ordid=c,wa[c].addEventListener("mouseenter",Ff),wa[c].addEventListener("mouseout",Gf);g("stock").addEventListener("click",function(a){q.checkStock()});Ja.addEventListener("mousedown",function(a){});g("progressmana");g("selectUnits").onclick=function(){g("mapeditorinfoUnits").style.display="block";g("mapeditorinfoBuilds").style.display="none";g("mapeditorinfoItems").style.display="none";g("mapeditorinfoNature").style.display="none"};g("selectBuilds").onclick=
function(){g("mapeditorinfoUnits").style.display="none";g("mapeditorinfoBuilds").style.display="block";g("mapeditorinfoItems").style.display="none";g("mapeditorinfoNature").style.display="none"};g("selectItems").onclick=function(){g("mapeditorinfoUnits").style.display="none";g("mapeditorinfoBuilds").style.display="none";g("mapeditorinfoItems").style.display="block";g("mapeditorinfoNature").style.display="none"};g("selectNature").onclick=function(){g("mapeditorinfoUnits").style.display="none";g("mapeditorinfoBuilds").style.display=
"none";g("mapeditorinfoItems").style.display="none";g("mapeditorinfoNature").style.display="block"};g("selectKingdom").onchange;g("mapProps").onclick=function(){g("mapPropsWindow").style.display="block";Qa();if(""==g("mapPropsWindow").innerHTML){var a=document.createElement("div");g("mapPropsWindow").appendChild(a);var b=document.createElement("table");a.appendChild(b);b=document.createElement("div");b.innerHTML=l.mapName;var d=document.createElement("input");d.value=p.name||l.strcusMap;d.id="mapName";
d.type="text";a.appendChild(b);a.appendChild(d);b=document.createElement("div");b.innerHTML=l.description;d=document.createElement("textarea");d.type="text";d.value=p.description||"";d.id="mapDescription";a.appendChild(b);a.appendChild(d);b=document.createElement("div");b.innerHTML=l.author;d=document.createElement("input");d.id="mapAuthor";d.value=p.author||"";d.type="text";a.appendChild(b);a.appendChild(d);a.appendChild(document.createElement("p"));b=document.createElement("button");b.onclick=je;
b.innerHTML=l.GENERAL_CLOSE;a.appendChild(b)}a=g("mapPropsWindow").getElementsByTagName("table")[0];a.innerHTML="";a.innerHTML+="<tr><td>"+l.color+"</td><td>"+l.MP_SEARCH_T_PL_NAME+"</td><td>"+l.VIEWMSG_GOLD+"</td><td>"+l.VIEWMSG_WOOD+"</td><td>"+l.VIEWMSG_FOOD+"</td><td>"+l.VIEWMSG_STONE+"</td><td>"+l.AI+"</td><td>"+l.TEAM+"</td></tr>";a.innerHTML+="<tr><td><button id='editorAdd'>+</button><button id='editorDelete'>-</button></td></tr>";g("editorAdd").onclick=Hf;g("editorDelete").onclick=If;a=a.getElementsByTagName("input");
for(b=0;1>b;b++)d=8*b,a[d].onchange=Jf,a[d+1].onchange=Kf,a[d+2].onchange=gc,a[d+3].onchange=gc,a[d+4].onchange=gc,a[d+5].onchange=gc,a[d+2].res=0,a[d+3].res=1,a[d+4].res=2,a[d+5].res=3,a[d+6].onchange=Lf,a[d+6].checked=NaN.IA,a[d+7].onchange=Mf,a[d].team=b+1,a[d+1].team=b+1,a[d+2].team=b+1,a[d+3].team=b+1,a[d+4].team=b+1,a[d+5].team=b+1,a[d+6].team=b+1,a[d+7].team=b+1};g("mapRules").onclick=function(){g("mapRulesWindow").style.display="block";Qa();if(""==g("mapRulesWindow").innerHTML){var a=document.createElement("div");
a.innerHTML='\n<div id="mapEvent">\n<h4>'+l.events+'</h4>\n<select id="eventOptions" style="display:none">\n<option value="objAction">'+l.objAction+'</option>\n<option value="objZone">'+l.objZone+'</option>\n</select>\n<div id="eventScreen">\n</div>\n<div id="eventLayout">\n</div>\n<button id="addEvent">+</button>\n</div>\n<div id="mapActions">\n<h4>'+l.actions+'</h4>\n<select id="actionOptions" style="display:none">\n<option value="objOrder">'+l.objOrder+'</option>\n</select>\n<div id="actionScreen">\n</div>\n<div id="actionLayout">\n</div>\n<button id="addAction">+</button>\n</div>\n<h4>'+
l.rules+"</h4>\n";var b=document.createElement("div");b.id="rulist";a.appendChild(b);b=document.createElement("button");b.onclick=Nf;b.innerHTML="+";a.appendChild(b);b.id="addRule";a.appendChild(document.createElement("p"));b=document.createElement("button");b.onclick=je;b.innerHTML=l.GENERAL_CLOSE;a.appendChild(b);g("mapRulesWindow").appendChild(a);g("addEvent").onclick=Of;g("addAction").onclick=Pf;g("eventOptions").onchange=function(){var a=ke[this.value];M.div=a.id;H(M.div);M.active.name=this.value;
a.func&&a.func();a=g("eventScreen").getElementsByTagName("button");for(var b=!1,d=0,e=a.length;d<e;d++){var c=a[d];if(c.sdiv)if("none"==c.style.display)c.sdiv.style.display="none";else{if(!b)c.onclick();b=!0}}hc(ia.active,"eventLayout")};g("actionOptions").onchange=function(){ea.active.name=this.value;hc(ia.active,"actionLayout")};a=document.createElement("div");a.id="edobjAction";var d=document.createElement("select");d.innerHTML='\n<option value="attack">'+l.MISC_ATTACK3+'</option>\n<option value="destroy">'+
l.destroy+'</option>\n<option value="moving">'+l.moving+'</option>\n<option value="capture">'+l.capture+"</option>\n";d.value="attack";d.id="selectionEvents";d.onchange=Qf;var c=document.createElement("section"),r=document.createElement("section"),f=document.createElement("section"),n=document.createElement("section"),m=document.createElement("section");b=document.createElement("button");b.innerHTML=l.ADD;b.onclick=ic;var p=document.createElement("div");p.className="unitList";p.id="zoneList";f.appendChild(b);
f.appendChild(p);p=document.createElement("div");p.className="unitList";p.id="unitListDiv";p.spType=M;b=document.createElement("button");b.innerHTML=l.ADD;b.onclick=function(){qa(this)};b.button=p;b.style.margin="10px";c.appendChild(b);b=document.createElement("button");b.innerHTML=l.defined;b.onclick=ja;b.sdiv=c;a.appendChild(b);b.onclick();b=document.createElement("button");b.innerHTML=l.undefined;b.onclick=ja;b.sdiv=r;a.appendChild(b);c.appendChild(p);a.appendChild(c);a.appendChild(r);a.appendChild(document.createElement("p"));
a.appendChild(d);a.appendChild(document.createElement("p"));p=document.createElement("div");p.className="unitList";p.id="unitListDiv2";p.spType=M;b=document.createElement("button");b.innerHTML=l.ADD;b.onclick=function(){qa(this)};b.button=p;b.style.margin="10px";n.appendChild(b);b=document.createElement("button");b.innerHTML=l.defined;b.onclick=ja;b.sdiv=n;b.id="byButton1";a.appendChild(b);b=document.createElement("button");b.innerHTML=l.undefined;b.onclick=ja;b.id="byButton2";b.sdiv=m;a.appendChild(b);
n.appendChild(p);b=document.createElement("button");b.innerHTML=l.zone;b.onclick=ja;b.sdiv=f;b.id="eventZone";b.style.display="none";a.appendChild(b);a.appendChild(f);a.appendChild(n);a.appendChild(m);g("eventScreen").appendChild(a);A("mapEvent");A("mapActions");a=document.createElement("div");a.id="edobjOrder";d=document.createElement("select");d.innerHTML='\n<option value="move">'+l.move+'</option>\n<option value="attack">'+l.MISC_ATTACK3+"</option>\n";d.value="move";d.id="selectionActions";d.onchange=
Rf;c=document.createElement("section");r=document.createElement("section");n=document.createElement("section");m=document.createElement("section");p=document.createElement("div");p.className="unitList";p.id="unitListDivAction";p.spType=ea;b=document.createElement("button");b.innerHTML=l.ADD;b.onclick=function(){qa(this)};b.button=p;b.style.margin="10px";c.appendChild(b);b=document.createElement("button");b.innerHTML=l.defined;b.onclick=ja;b.sdiv=c;a.appendChild(b);b=document.createElement("button");
b.innerHTML=l.undefined;b.onclick=ja;b.sdiv=r;a.appendChild(b);c.appendChild(p);a.appendChild(c);a.appendChild(r);b.onclick();a.appendChild(document.createElement("p"));a.appendChild(d);a.appendChild(document.createElement("p"));p=document.createElement("div");p.className="unitList";p.id="unitListDivAction2";p.spType=ea;b=document.createElement("button");b.innerHTML=l.ADD;b.onclick=function(){qa(this)};b.button=p;b.style.margin="10px";n.appendChild(b);b=document.createElement("button");b.innerHTML=
l.defined;b.onclick=ja;b.sdiv=n;b.id="toButton1";a.appendChild(b);b=document.createElement("button");b.innerHTML=l.undefined;b.onclick=ja;b.id="toButton2";b.sdiv=m;a.appendChild(b);n.appendChild(p);a.appendChild(n);a.appendChild(m);b.onclick();g("actionScreen").appendChild(a);A("mapEvent");A("mapActions")}};g("gameMenu").onclick=y;g("menueditor").onclick=y}};ec.setup=!1;var Ff=function(){q.mouseEnter(this.ordid)},Gf=function(){Y.stockActive&&le(Fb[0],1,1);Yc.innerHTML=""},Ef=function(c){q.executeOrder(this.ordid,
c.button);this.style.transform="translate(0px,0px)"},Df=function(){this.style.transform="translate(2px,2px)"},Zc,me=function(){history.pushState("",document.title,window.location.pathname)},Va=function(){p.online=0;location.hash="";g("index").style.display="block";g("returnmenu").style.display="none";setTimeout(me,200)},ra=[.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.27,.3,1,.5,.5,.5,1,.62,.62,.62,1,.74,.74,.74,1,.88,.88,.88,1,.94,.94,.94,1,1,1,1,1,1.06,1.06,1.06,1,1.12,1.12,1.12,
1,1.08,1.08,1.08,1,1.04,1.04,1.04,1,1,1,1,1,.95,.95,.95,1,.88,.8,.7,1,.84,.72,.6,1,.7,.62,.5,1,.6,.55,.45,1,.5,.44,.42,1,.4,.37,.35,1],be=function(){if("false"===localStorage.nightcycle)e=new Float32Array([1,1,1,1]);else{var r=(.025*p.cycle/p.daylength*24+p.initialhour)%24,a=~~r;r-=a;ie.style.backgroundPosition="0 -"+36*a+"px";var e=new Float32Array([ra[4*a],ra[4*a+1],ra[4*a+2],ra[4*a+3]]);a=(a+1)%24;e[0]+=(-e[0]+ra[4*a])*r;e[1]+=(-e[1]+ra[4*a+1])*r;e[2]+=(-e[2]+ra[4*a+2])*r;e[3]+=(-e[3]+ra[4*a+3])*
r}a=e;c.useProgram(I);c.uniform4fv(ne,a);c.useProgram(F);c.uniform4fv(oe,a)},N=0,T=0,Ya=0,Za=0,Gb=function(c,a){var e=g("tzar").width,b=g("tzar").height,d=t.mx/32;c/=32;a/=32;var r=L*e*.03125,f=L*b*.03125,l=.03125*e,n=.03125*b,p=c+.5*(l-r),m=a+.5*(n-f);0>p?c=.5*-(l-r):p+r-d*L>U&&(c=U-r-.5*(l-r)+d*L);0>m?a=.5*-(n-f):m+f>na&&(a=na-f-.5*(n-f));r-t.mx>U&&(L=U/(.03125*e),B(L));f>na&&(L=na/(.03125*b),B(L));N=32*-c;T=32*-a},fc=function(c){var a=c.pageX-parseInt(Ja.style.left);c=c.pageY-parseInt(Ja.style.top);
var e=g("tzar").width,b=g("tzar").height*ya/(32*na);a=~~(.5+(a-e*Ka/(32*U)*.5)*U/Ka);c=~~(.5+(c-.5*b)*na/ya);Gb(32*a,32*c);0==Zc&&document.removeEventListener("mousemove",fc)},Eb={control:0,shift:0,esc:0},mb={37:function(c){Ya=c},40:function(c){Za=-c},39:function(c){Ya=-c},38:function(c){Za=c},16:function(c){Eb.shift=c;q.shiftONOFF(c)},17:function(c){Eb.control=c},27:function(c){Eb.esc=c},13:function(c){c&&!p.editor&&("displaynone"==g("enterwindow").className?(g("enterwindow").className="displayblock",
g("msginputGame").focus(),mb.blocked=13):($c(),g("enterwindow").className="displaynone",mb.blocked=null))},19:function(c){},48:function(c){c&&Eb.control&&(L=1,pe({deltaY:0}))},219:function(c){c&&qe(-1)},221:function(c){c&&qe(1)},blocked:null};document.oncontextmenu=function(){return!1};var ad=function(){A("magicworkshopmenu");ac.style.display="none";bc.style.display="none";jb.style.display="none";oa.style.display="none";g("manamenu").style.display="none";g("manamenu1").style.display="none";g("progressmana").style.display=
"none";Xc.innerHTML="";ac.innerHTML="";bc.innerHTML="";g("manamenu").innerHTML="";jb.innerHTML="";cc.innerHTML="";kb.innerHTML="";oa.value="";kb.maxLength="";de.style.display="none";for(var c=0;c<wa.length;wa[c++].innerHTML="");re();se()},Fb=[];Fb.change=1;document.onkeydown=function(c){if(c.ctrlKey&&c.shiftKey)return!1;var a=!0;({116:1,115:1,123:1})[c.keyCode]&&(a=!1);return a};var Sf=function(c){if(mb[c.keyCode])mb[c.keyCode](1);c.target!=g("msginputGame")&&(B(c.keyCode),q.runKey(c.keyCode,!0))},
Tf=function(c){if(mb[c.keyCode])mb[c.keyCode](0);c.target!=g("msginputGame")&&q.runKey(c.keyCode,!1)},jc,kc,lc,mc,Hb=!1,Uf=function(c){var a=c.changedTouches[0].screenX;c=c.changedTouches[0].screenY;lc=N;mc=T;jc=a;kc=c},Vf=function(c){var a=c.changedTouches[0].screenY;N=lc-(jc-c.changedTouches[0].screenX);T=mc-(kc-a);nc()},Wf=function(c){},bd=function(c){return!("li"==c.target.localName||c.target==g("tzar")||c.target==g("resources")||c.target==g("playersinfo")||c.target==g("msgs1"))},Xf=function(c){var a=
window.innerWidth,e=window.innerHeight,b=c.pageX,d=c.pageY;if(!bd(c)){if(Hb){N=lc-(jc-b);T=mc-(kc-d);nc();return}q.mouseMove(c.pageX,c.pageY)}if(screen.height-10<=e){if(1.2===Math.abs(Ya)||0===Ya)Ya=1.2*((10>b)-(b>a-10));if(1.2===Math.abs(Za)||0===Za)Za=1.2*((10>d)-(d>e-10))}},Yf=function(c){if(!bd(c))if(c.altKey&&c.pageX>t.mx){Hb=!0;var a=c.pageX;c=c.pageY;lc=N;mc=T;jc=a;kc=c}else Hb=!1,q.mouseDown(c.pageX,c.pageY,c.button)},Zf=function(c){if(!bd(c))if(Hb)Hb=!1;else return q.mouseUp(c.pageX,c.pageY,
c.button)},le=function(c,a){c={attack:q.gAttack(c),defence:q.gDefence(c),level:q.glevel(c),health:q.ghealth(c),maxHealth:q.gmaxHealth(c),mana:q.gMana(c),item:q.gItem(c),build:q.gBuild(c),kingdom:q.gKingdom(c),c:q.gCval(c),manaMax:q.gManaMax(c),utype:q.giType(c),inventoryLength:q.gInventory(c),control:q.gControl(c),iconID:q.gIconID(c),type:q.gType(c),helper:q.gHelper(c),name:l[hb[q.gName(c)]]};g("manamenu").style.display="none";g("manamenu1").style.display="none";g("progressmana").style.display="none";
c.sound&&!a&&(a=c.sound,Ma(a[~~(a.length*Math.random())]));c.inventoryLength&&c.control?(g("stock").className="",g("manamenu1").style.display="block",g("manamenu1").style.backgroundPosition="0px -80px",g("manamenu1").innerHTML=c.inventoryLength):g("stock").className="blocked";c.build&&c.c&&(a=Math.floor(25*(c.c-p.cycle)/1E3),0<a&&(g("manamenu").style.display="block",g("manamenu").style.backgroundPosition="0px -200px",g("manamenu").innerHTML=a+"s"));cc.style.display="block";Xc.innerHTML=c.name;c.attack||
0==c.utype?(ac.innerHTML=c.attack,H("attackmenu")):A("attackmenu");0==c.utype||2==c.utype&&c.defence?(bc.innerHTML=c.defence,H("defencemenu")):A("defencemenu");c.manaMax&&(g("manamenu").style.display="block",g("manamenu").innerHTML=c.mana,27===c.type?(g("manamenu1").style.backgroundPosition="0px -280px",H("manamenu1"),g("manamenu1").innerHTML=c.mana,g("manamenu").style.backgroundPosition="0px -240px",g("manamenu").innerHTML=c.helper):(g("progressmana").value=~~(100*c.mana/c.manaMax),H("progressmana"),
g("manamenu").style.backgroundPosition="0px -120px"));jb.innerHTML=c.level;jb.style.display="block";0===c.level&&(c.item||c.build)&&(jb.style.display="none");cc.innerHTML=La(ba(q.empName(c.kingdom),17));oa.style.display="block";a=c.health;var e=c.maxHealth;-1===a?(oa.value=100,oa.max=100,kb.innerHTML=l.MISC_INF3):(oa.value=a,-1===e?(oa.max=100,oa.value=1):oa.max=e,kb.innerHTML=~~a+"/"+e);te(c.iconID)},ve=function(c,a,e){c=l[hb[c]];e&&(c=ue(c,La(ba(a,e))));g("msgs1").innerHTML+="<li>"+c+"<li>";Ib()},
La=function(c){for(var a,e="",b=0;a=c[b++];)e+=String.fromCharCode(a);return e},nc=function(){};new Float32Array(8);var cd,dd,ed,fd,we,L=1;new Float32Array(12);var c,nb,gb=function(c,a){return new Float32Array(f.HEAPF32.buffer,c,a)},xe=function(c,a){return new Int32Array(f.HEAPF32.buffer,c,a)},ye=function(c,a){return new Int8Array(f.HEAPF32.buffer,c,a)},ba=function(c,a){return new Uint16Array(f.HEAPF32.buffer,c,a)},Yb=function(c,a){return new Uint8Array(f.HEAPF32.buffer,c,a)},re=function(){for(var c=
Y.displayed.length=0,a=Y.length;c<a;c++){var e=wa[c];e.className="blocked";e.style.backgroundPosition="48px 96px";e.innerHTML=""}Y.rightButton.className="blocked";Y.leftButton.className="blocked";Y.stock.className="blocked";Y.rightBlocked=1},oe,F,I,ze,ne,Ae,oc,gd,hd,pc,Jb,Kb,Lb,ob,id,jd,$a,Be,Mb=function(f,a){var e=4*we,b=c.createBuffer();b.size=a;b.len=e;c.bindBuffer(c.ARRAY_BUFFER,b);c.enableVertexAttribArray(f);c.vertexAttribPointer(f,a,c.FLOAT,!1,0,0);c.bufferData(c.ARRAY_BUFFER,e*a,c.STATIC_DRAW);
S?qc.vertexAttribDivisorANGLE(f,1):c.vertexAttribDivisor(f,1);return b};Mb.jump=4E3;var rc=function(f,a){var e=c.createBuffer(),b=a+1E4;a*=4;b*=4;c.bindBuffer(c.COPY_READ_BUFFER,f);c.bindBuffer(c.ARRAY_BUFFER,e);c.bufferData(c.ARRAY_BUFFER,a*f.size,c.STATIC_DRAW);c.copyBufferSubData(c.COPY_READ_BUFFER,c.ARRAY_BUFFER,0,0,a*f.size);c.bindBuffer(c.COPY_READ_BUFFER,e);c.bindBuffer(c.ARRAY_BUFFER,f);c.bufferData(c.ARRAY_BUFFER,b*f.size,c.STATIC_DRAW);c.copyBufferSubData(c.COPY_READ_BUFFER,c.ARRAY_BUFFER,
0,0,a*f.size);c.bindBuffer(c.COPY_READ_BUFFER,null);c.deleteBuffer(e)},S,aa=function(){if(!p.canceled){performance.now();requestAnimationFrame(aa);var f=aa.fp1000,a=aa.delta,e=aa.now,b=aa.realnow,d=aa.delta,h=e;aa.frameCount++;e=Date.now()-Db+25*p.cycle;aa.now=e;a=(a+(e-h))/1E3;aa.delta=a;h=b;b=Date.now();aa.realnow=b;d=(d+(b-h))/1E3;aa.realdelta=d;Wc+=a;Vc++;aa.fp1000=f+a;if(0!=Ya||0!=Za)f=parseInt(localStorage.scrollSpeed)/100,N+=Ya*d*1280*L*f,T+=Za*d*1280*L*f,N=Math.floor(N),T=Math.floor(T),Gb(-N,
-T);c.useProgram(F);nc();c.uniform1f(Ae,e);c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT);d=window.innerWidth;f=window.innerHeight;c.useProgram(I);pb(id);c.uniform1f(gd,e);c.drawArrays(c.TRIANGLES,0,6);c.viewport(t.marx,f-ya-t.mary,Ka,ya);c.uniform1i(pc,1);c.uniform2fv(Lb,[0,0]);c.uniform1f(ob,Ka/32/U);c.drawArrays(c.TRIANGLES,0,6);c.uniform1i(pc,0);c.uniform2f(hd,d,f);c.uniform2fv(Lb,[N,T]);c.uniform1f(ob,1/L);c.viewport(t.mx,0,d,f);c.useProgram(F);pb(jd);kd(q.getBufferID());e=g("tzar").width;d=
g("tzar").height;c.viewport(t.marx,d-ya-t.mary,Ka,ya);c.uniform2f(oc,32*U,32*na);c.uniform2fv(Kb,[0,0]);c.uniform1i(Jb,1);c.uniform1f(nb,1);kd(q.getBufferID());c.uniform1i(Jb,2);kd(1);c.uniform1i(Jb,0);c.uniform2f(oc,e,d);c.uniform2fv(Kb,[N,T]);c.uniform1f(nb,1/L);c.viewport(t.mx,0,e,d);qb.update&&qb(1)}},kd=function(f){f&&(c.enable(c.BLEND),c.blendEquation(c.FUNC_ADD),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),S?qc.drawArraysInstancedANGLE(c.TRIANGLES,0,6,f):c.drawArraysInstanced(c.TRIANGLES,
0,6,f),c.disable(c.BLEND))},ld=!1,pe=function(f){if(!md&&(f.clientX>t.menumx||Zc||!f.clientX)){var a=f.deltaY;f=g("tzar").width;var e=g("tzar").height;a=Math.sign(a)*parseFloat(localStorage.zoomMult)/1E3*L;e=(L+a)*e*.03125;(L+a)*f*.03125-(L+a)*t.mx/32>U||e>na||(L+=a,.08>L&&(L=.08),Gb(-N,-T),c.useProgram(I),c.uniform1f(ob,1/L),c.useProgram(F),c.uniform1f(nb,1/L),q.setupZoom(L),Ce())}},Ce=function(){var c=g("tzar").width,a=g("tzar").height,e=-T+.5*(a-L*a),b=L*(c-t.mx);a*=L;fa[0]=-N+.5*(c-L*c);fa[1]=
e;fa[2]=-999999999;fa[3]=0;fa[4]=0;De();fa[0]=b;fa[1]=a;fa[2]=0;fa[3]=0;fa[4]=0;Ee()},Fe,Ge;nc=function(){var f=[N,T];if(N!=Fe||T!=Ge)Fe=N,Ge=T,q.setupTranslation(-N,-T),c.useProgram(I),c.uniform2fv(Lb,f),c.useProgram(F),c.uniform2fv(Kb,f),Ce()};var He,rb,sc=function(){var f=window.innerWidth,a=window.innerHeight;c.canvas.width=f;c.canvas.height=a;q.canvasSize(f,a);c.useProgram(I);c.uniform2f(hd,f,a);c.useProgram(F);$a.width=f;$a.height=a;c.activeTexture(c.TEXTURE2);rb||(rb=c.createTexture());c.bindTexture(c.TEXTURE_2D,
rb);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,f,a,0,c.RGBA,c.UNSIGNED_BYTE,null);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.bindFramebuffer(c.FRAMEBUFFER,$a);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,rb,0);c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT);c.bindFramebuffer(c.FRAMEBUFFER,
null);c.uniform1f(nb,1);c.uniform1i(c.getUniformLocation(F,"lightmap"),2);c.useProgram(I);c.uniform1i(c.getUniformLocation(I,"lightmap"),2);c.uniform1f(ob,1);c.useProgram(F);c.uniform2f(oc,f,a);c.viewport(t.mx,0,f,a);sc.changed=1;Gb(-N,-T)},pb=function(f){if(S)return tc.bindVertexArrayOES(f);c.bindVertexArray(f)},tc,qc,Ie=function(){return S?(tc||(tc=c.getExtension("OES_vertex_array_object")),tc.createVertexArrayOES()):c.createVertexArray()};Array.prototype.put=function(c){this[this.length]=c};Array.prototype.quit=
function(c){c=this.indexOf(c);return-1<c?(this.splice(c,1),!0):!1};Array.prototype.add=function(c){0>this.indexOf(c)&&(this[this.length]=c)};var p={},De=function(){c.bindBuffer(c.ARRAY_BUFFER,dd);c.bufferSubData(c.ARRAY_BUFFER,12*fa[4],uc)},Ee=function(){c.bindBuffer(c.ARRAY_BUFFER,fd);c.bufferSubData(c.ARRAY_BUFFER,12*fa[4],uc)},Ga=["European","Arab","Asian"],ue=function(c,a,e){e&&(c=c.replace("%d",e));return c.replace("%s",a)};Qc.translated=!0;var nd,vc,bb=function(c){p.infinity=void 0;if(g("mapconfiguration")&&
""!==g("mapconfiguration").innerHTML){c="mapx mapwidth goldRes goldValue woodRes woodValue foodRes foodValue stoneRes stoneValue infinity infiniteValue water waterValue terrainType terrainSelect peons peonValue freePop freePopValue maxPop maxPopValue".split(" ");for(var a=0,e=c.length;a<e;a+=2){var b=g(c[a+1]).value;"infinity"===c[a]?(b=g(c[a+1]).checked,p[c[a]]=b):parseInt(b)?p[c[a]]=parseInt(b):p[c[a]]=b;localStorage[c[a]]=b}}else"true"===localStorage.infinity&&(p.infinity=!0),p.goldRes=parseInt(localStorage.goldRes),
p.foodRes=parseInt(localStorage.foodRes),p.woodRes=parseInt(localStorage.woodRes),p.stoneRes=parseInt(localStorage.stoneRes),p.mapx=parseInt(localStorage.mapx),p.water=parseInt(localStorage.water),p.terrainType=localStorage.terrainType,p.items=parseInt(localStorage.items),p.peons=parseInt(localStorage.peons),p.gateways=parseInt(localStorage.gateways),p.freePop=parseInt(localStorage.freePop),p.maxPop=parseInt(localStorage.maxPop);p.daylength=2880;p.initialhour=12;p.infinity&&(p.goldRes=Math.pow(2,
31)-1,p.foodRes=Math.pow(2,31)-1,p.woodRes=Math.pow(2,31)-1,p.stoneRes=Math.pow(2,31)-1);p.mapy=p.mapx;p.gravity=580.9/9.8*9.8;p.name="";p.arje=~~(555555*Math.random()+1);q.setupGame(p.peons,p.freePop,p.goldRes,p.woodRes,p.foodRes,p.stoneRes,p.water,Cb[p.terrainType].id,p.items,p.gateways,p.mapx,p.arje,p.maxPop);return p},Xd=function(){dc.innerHTML="";A("notifybottom");g("loadingtext").innerHTML=l.MSG_GAME_LOAD;t.kingdom||(t.kingdom=1);p.online&&($f(l.MSG_GAME_CREATE),p.editor=0);B(q.mapWidth(),"width");
q.mapWidth()?(p.mapx=q.mapWidth(),p.mapy=p.mapx):bb();p.pausedTime=0;p.canceled=0;vc=performance.now();Ba=g("msgs1");p.online||(location.hash="");A("playermenu");A("index");p.cycle?p.deltaTime=25*p.cycle:(p.date=Date.now(),p.cycle=0,p.deltaTime=0);p.loadDate=Date.now();p.online||me();p.now=Zd;p.paused=0;p.pausedTime=0;p.zMax=96*p.mapy;Xa();performance.now();p.allow14=!0;U=p.mapx;na=p.mapy;p.temperature=25;var f=p.temperature;0===t.temperature&&(f+="&deg;C");g("temperature").innerHTML=f;L=1;g("loadingtext").innerHTML=
"Loading terrain";B("arje",p.arje);q.preldd()?(nd=ye(q.trradd()),B(nd)):(q.configRandomMap(),nd=ye(q.randomTerrain(U),U*na));H("content");g("loadingtext").innerHTML="Loading textures";c.getError()===c.CONTEXT_LOST_WEBGL&&(c=g("tzar").getContext("webgl2",{antialias:!1,alpha:!1}),B("restored"));if(!ld){var a=S?"precision highp float;\nattribute vec3 a_position;\nattribute vec3 a_texCoord;\nattribute vec4 a_physic;\nattribute vec3 a_margins;\nattribute float a_step;\n\nuniform float kingdoms;\nuniform float zoom;\nuniform mediump int miniMap;\nuniform float now;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform sampler2D u_image1;\nuniform sampler2D delay;\nuniform sampler2D colorArray;\n\nuniform float zMax;\nvarying highp vec2 vTextureCoord;\nvarying vec4 v_kcolor;\nvarying float height;\nvarying float rColor;\n\nvec4 superArray(highp float position) {\nhighp vec2 xy = vec2(mod(position,512.0) ,   floor(position/512.0) )/512.0;\nreturn (texture2D(u_image1, xy));\n}\n\nfloat delayr(float pos){\nhighp vec2 xy = vec2(mod(pos,128.0) ,   floor(pos/128.0) )/128.0;\nreturn (texture2D(delay, xy).r);\n}\n\n\nvoid main() {\n\n\n\n    highp float  x;\n    float t;\n\thighp float pos;\n    highp float jump=0.0;\n    pos=a_texCoord.x;\n\n   // pos=260840u/4u;\n\n\n\nvec4 imgInfo=superArray(pos);\n\nfloat frames=imgInfo[0];\nfloat fps=imgInfo[1];\nfloat dirs=imgInfo[2];\nfloat recolor=imgInfo[3];\n\nrColor=recolor;\n\n\nif(fps!=0.0&&miniMap==0){\nif(a_texCoord.y>=0.0){\nt=(now-a_texCoord.y);\nif(fps>0.0){\njump=floor(t * fps*0.001);         \n}else{\n\n//fps=12.0;\n//jump=floor(t * fps*0.001);  \n\n\n\nfloat index=-fps;\n\nfloat spt= mod(t,delayr(frames-1.0+index));\nbool stop=false;\nfor(int i=0;i<55;i++){\nif(!stop){\njump=float(i);\nif(jump<frames) \nif(delayr(jump+index)>spt)\nstop=true;\n}\n\n}\n\n\n\n\n\n}\n\njump=mod(jump,frames)*2.0;\npos=(pos+jump);\n}\n}\n\npos+=1.0;\n   \n    vec4 coord = superArray(pos);\n    vec2 mxy=coord.xy;\n    highp vec2 txtcord = coord.zw;\n   // txtcord=vec2(0.0,0.0);\n    \n    vec2 sizes = superArray(pos+1.0).xy;\n    //sizes=vec2(50.0);\n    if(a_step==1.0||a_step==3.0){\n    mxy.x+=sizes.x;\n    txtcord.x+=sizes.x;\n    }\n\n    if(a_step==2.0||a_step==3.0){\n    mxy.y+=sizes.y;\n    txtcord.y+=sizes.y;\n    }\n\n\theight = sizes.y;\n\n\tfloat z=a_position.z;\n\n\n    \nif(a_margins.x!=0.0&&(a_step==1.0||a_step==3.0)){\nmxy.x+=a_margins.x-sizes.x;\n}\n\n\nif(a_margins.y!=0.0&&(a_step==2.0||a_step==3.0)){\nmxy.y+=a_margins.y-sizes.y;\n}\n\n\n\tif(z<0.0){\n\tz*=-1.0;\nif(miniMap<2) mxy*=0.0;\n\t}\n\n\n\n\n\n\nif(a_margins.z!=0.0){\n\tfloat s = sin(a_margins.z);\n\tfloat c = cos(a_margins.z);\n\tmat2 m = mat2(c, -s, s, c);\n\tmxy.xy*=m;\n}\n\n\n\n    t = (now - a_physic.w) * 0.001;\n    mxy.x+=a_physic.x * t;\n\n\tfloat physicY=a_physic.y * t + a_physic.z * .5 * t * t;\n\n    mxy.y+=physicY;\n\n\nif(miniMap!=0){\n\tz=0.0;\n}else{\n\tz=(1.0 - (physicY+z)/ zMax)*.9;\n}\n\n\n   gl_Position = vec4((((a_position.xy+mxy) + u_translation) / u_resolution * 2.0 - 1.0) * vec2(zoom, -zoom), (z), 1.0);\n   vTextureCoord=txtcord;\n\n\nvec4 outColor=texture2D(colorArray,vec2(a_texCoord.z/64.0,0));\n//outColor=vec4(1.0);\n\nif(a_texCoord.z>=kingdoms) outColor.a+=1.0;\n\n\n   v_kcolor=outColor;\n}\n":
"#version 300 es\nprecision highp float;\n\nin vec3 a_position;\nin vec3 a_texCoord;\nin vec4 a_physic;\nin vec3 a_margins;\nin uint a_step;\n\nuniform float kingdoms;\nuniform float zoom;\nuniform mediump int miniMap;\nuniform float now;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform sampler2D u_image1;\nuniform sampler2D delay;\nuniform sampler2D colorArray;\n\nuniform float zMax;\nout highp vec2 vTextureCoord;\nout vec4 v_kcolor;\nout float height;\nflat out int rColor;\n\nvec4 superArray(in highp int position) {\n     return(texelFetch(u_image1, ivec2(\t\t(position%512)\t\t,\tposition/512\t), 0));\n}\n\nvoid main() {\n\n\n\n    highp float  x;\n    float t;\n\thighp int pos;\n    int jump=0;\n    pos=int(a_texCoord.x);\n   // pos=260840u/4u;\n\n\n\nvec4 imgInfo=superArray(pos);\n\nint frames=int(imgInfo[0]);\nfloat fps=imgInfo[1];\nfloat dirs=imgInfo[2];\nfloat recolor=imgInfo[3];\n\nrColor=int(recolor);\n\n\nif(fps!=0.0&&miniMap==0){\nif(a_texCoord.y>=0.0){\nt=(now-a_texCoord.y);\nif(fps>0.0){\njump=int(floor(t * fps*0.001));         \n}else{\n\n\nint index=int(-fps);\n\nfloat spt= mod(t,texelFetch(delay, ivec2(frames-1+index, 0), 0).r);\n\nfor(jump=0;jump<frames;jump++)\nif(texelFetch(delay, ivec2(jump+index, 0), 0).r>spt){ \nbreak;\n}\n\n\n\n\n}\n\njump=(jump%frames)*2;\npos=(pos+jump);\n}\n}\n\npos+=1;\n   \n    vec4 coord = superArray(pos);\n    vec2 mxy=coord.xy;\n    vec2 txtcord = coord.zw/512.0;\n\n    \n    vec2 sizes = superArray(pos+1).xy;\n\n    if(a_step==1u||a_step==3u){\n    mxy.x+=sizes.x;\n    txtcord.x+=sizes.x/512.0;\n    }\n\n    if(a_step==2u||a_step==3u){\n    mxy.y+=sizes.y;\n    txtcord.y+=sizes.y/512.0;\n    }\n\n\n\n\theight = sizes.y/512.0;\n\n\tfloat z=a_position.z;\n\n\n    \nif(a_margins.x!=0.0&&(a_step==1u||a_step==3u)){\nmxy.x+=a_margins.x-sizes.x;\n}\n\n\nif(a_margins.y!=0.0&&(a_step==2u||a_step==3u)){\nmxy.y+=a_margins.y-sizes.y;\n}\n\n\n\tif(z<0.0){\n\tz*=-1.0;\nif(miniMap<2) mxy*=0.0;\n\t}\n\n\n\n\n\n\nif(a_margins.z!=0.0){\n\tfloat s = sin(a_margins.z);\n\tfloat c = cos(a_margins.z);\n\tmat2 m = mat2(c, -s, s, c);\n\tmxy.xy*=m;\n}\n\n\n\n    t = (now - a_physic.w) * 0.001;\n    mxy.x+=a_physic.x * t;\n\n\tfloat physicY=a_physic.y * t + a_physic.z * .5 * t * t;\n\n    mxy.y+=physicY;\n\n\nif(miniMap!=0){\n\tz=0.0;\n}else{\n\tz=(1.0 - (physicY+z)/ zMax)*.9;\n}\n\n\n   gl_Position = vec4((((a_position.xy+mxy) + u_translation) / u_resolution * 2.0 - 1.0) * vec2(zoom, -zoom), (z), 1.0);\n   vTextureCoord=txtcord;\n\nvec4 outColor=texelFetch(colorArray, ivec2(a_texCoord.z, 0), 0);\n\nif(a_texCoord.z>=kingdoms) outColor.a+=1.0;\n\n\n   v_kcolor=outColor;\n}\n";
f=c.createShader(c.VERTEX_SHADER);c.shaderSource(f,a);c.compileShader(f);var e=S?"precision highp float;\n\nuniform sampler2D lightmap;\nuniform vec2 u_resolution;\nuniform sampler2D img_common[7];\nuniform vec4 u_ambient;\nuniform mediump int miniMap;\nvarying vec4 v_kcolor;\nvarying highp vec2 vTextureCoord;\nvarying float height;\nvarying float rColor;\n\nvec4 getPixel(){\nhighp vec2 txtFinal=vTextureCoord;\nif(txtFinal.x>=512.0){\ntxtFinal.y+=height*floor((txtFinal.x)/512.0);\ntxtFinal.x=mod(txtFinal.x,512.0);\n}\n\n//if(txtFinal.x<1.0) return vec4(1.0,0.0,0.0,1.0);\n//if(txtFinal.y<1.0) return vec4(1.0,0.0,0.0,1.0);\n\n\n\ntxtFinal.x=txtFinal.x+floor(mod(txtFinal.y,8.0))*512.0;\n\n//if(txtFinal.x<1.0) return vec4(0.0,1.0,0.0,1.0);\n\ntxtFinal.y=floor(txtFinal.y/8.0);\n\ntxtFinal/=4096.0;\n\nif(txtFinal.y<1.0)\nreturn texture2D(img_common[0], txtFinal);\nelse if(txtFinal.y<2.0)\nreturn texture2D(img_common[1], txtFinal);\nelse if(txtFinal.y<3.0)\nreturn texture2D(img_common[2], txtFinal);\nelse if(txtFinal.y<4.0)\nreturn texture2D(img_common[3], txtFinal);\nelse if(txtFinal.y<5.0)\nreturn texture2D(img_common[4], txtFinal);\nelse if(txtFinal.y<6.0)\nreturn texture2D(img_common[5], txtFinal);\nelse if(txtFinal.y<7.0)\nreturn texture2D(img_common[6], txtFinal);\n}\n\n\nvoid main() {\n\n\nif(miniMap==0){\n\n\n\n\nvec4 color=getPixel();\n\n\n\n//vec4 color=vec4(1.0);\n \n\nif(color.a<0.5) discard;\n\n\nif(rColor==1.0 &&color.r==color.g&&color.r==color.b){\ncolor.rgb*=v_kcolor.rgb;\n}\n\nif(v_kcolor.a>1.0)\n{\ncolor*=v_kcolor-vec4(0.0,0.0,0.0,1.0);\n}\n\n\n\n\nvec4 light=vec4(1.0);\n\ngl_FragColor=color*light;\n}else{\n\nif(v_kcolor.a>1.0)\ngl_FragColor=v_kcolor-vec4(0.0,0.0,0.0,1.0);\nelse\ngl_FragColor=v_kcolor;\n}\n\n}":
"#version 300 es\nprecision highp float;\n\n\n\nuniform sampler2D lightmap;\nuniform vec2 u_resolution;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\nuniform mediump int miniMap;\nin vec4 v_kcolor;\nin highp vec2 vTextureCoord;\nin float height;\nflat in int rColor;\nout vec4 COLOR;\n\n\nbool v4no(vec4 color,int r){\nif(color.r==float(r)/255.0) return false;\nreturn true;\n}\n\n\nvoid main() {\n\n\nif(miniMap==0){\n\n\n\n\nvec2 txtFinal=vTextureCoord;\n\nif(txtFinal.x>=1.0){\ntxtFinal.y+=height*floor(txtFinal.x);\n}\n\n\nvec4 color=texture(img_common, vec3(txtFinal, int(txtFinal.y)));\n \n\nif(color.a<0.5) discard;\n\n\nif(rColor==1 &&color.r==color.g&&color.r==color.b\n&&v4no(color,68)\n&&v4no(color,95)\n&&v4no(color,96)\n&&v4no(color,98)\n&&v4no(color,101)\n&&v4no(color,103)\n&&v4no(color,107)\n&&v4no(color,108)\n&&v4no(color,109)\n&&v4no(color,118)\n&&v4no(color,121)\n&&v4no(color,124)\n&&v4no(color,134)\n&&v4no(color,135)\n&&v4no(color,139)\n&&v4no(color,148)\n&&v4no(color,150)\n&&v4no(color,151)\n&&v4no(color,156)\n&&v4no(color,163)\n&&v4no(color,164)\n&&v4no(color,165)\n&&v4no(color,166)\n&&v4no(color,167)\n&&v4no(color,173)\n&&v4no(color,177)\n&&v4no(color,180)\n&&v4no(color,183)\n&&v4no(color,185)\n&&v4no(color,186)\n&&v4no(color,195)\n&&v4no(color,196)\n&&v4no(color,198)\n&&v4no(color,200)\n&&v4no(color,203)\n&&v4no(color,210)\n&&v4no(color,214)\n&&v4no(color,215)\n&&v4no(color,223)\n&&v4no(color,225)\n&&v4no(color,230)\n&&v4no(color,231)\n&&v4no(color,241)\n&&v4no(color,251)\n&&v4no(color,252)\n&&v4no(color,253)\n&&v4no(color,254)\n){\ncolor.rgb*=v_kcolor.rgb;\n}\n\nif(v_kcolor.a>1.0)\n{\ncolor*=v_kcolor-vec4(0.0,0.0,0.0,1.0);\n}\n\n\n\n\nvec4 light=vec4(1.0);\nlight = texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+vec4(1.0,1.0,1.0,0.0)*u_ambient;\n\nCOLOR=color*light;\n}else{\n\nif(v_kcolor.a>1.0)\nCOLOR=v_kcolor-vec4(0.0,0.0,0.0,1.0);\nelse\nCOLOR=v_kcolor;\n}\n\n}";
a=c.createShader(c.FRAGMENT_SHADER);c.shaderSource(a,e);c.compileShader(a);F=c.createProgram();c.attachShader(F,f);c.attachShader(F,a);c.linkProgram(F);c.useProgram(F);(f=c.getShaderInfoLog(f))&&console.log("Shader compiler log1: "+f);(f=c.getShaderInfoLog(a))&&console.log("Shader compiler log1: "+f);a=S?"precision highp float;\nattribute vec3 a_position;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform mediump int miniMap;\nuniform float zoom;\n\nvoid main() {\nfloat depth;\nif(miniMap==1){\ndepth=.03;\n}else{\ndepth=1.0;\n}\ngl_Position = vec4(a_position.x, a_position.y, depth, 1.0);\n\n}":
"#version 300 es\nprecision highp float;\nin vec3 a_position;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform mediump int miniMap;\nuniform float zoom;\n\nvoid main() {\nfloat depth;\nif(miniMap==1){\ndepth=.03;\n}else{\ndepth=1.0;\n}\ngl_Position = vec4(a_position.x, a_position.y, depth, 1.0);\n\n}";f=c.createShader(c.VERTEX_SHADER);c.shaderSource(f,a);c.compileShader(f);e=S?"precision highp float;\n\nuniform float u_fps;\nuniform mediump int miniMap;\nuniform sampler2D img_common[7];\nuniform vec4 u_ambient;\n\nuniform vec2 u_translation;\nuniform vec2 u_light;\nuniform vec2 u_resolution;\nuniform vec2 minimapMargin;\nuniform sampler2D img_data;\nuniform sampler2D lightmap;\nuniform float zoom;\nuniform float mx;\nuniform float mapSize;\n\nuniform sampler2D u_image1;\n\nvec4 superArray(highp float position) {\nhighp vec2 xy = vec2(mod(position,512.0) ,   floor(position/512.0) )/512.0;\nreturn (texture2D(u_image1, xy));\n}\n\nvec4 sptexture3D(vec2 txtFinal,float height) {\n\nif(txtFinal.x>=512.0){\ntxtFinal.y+=height*floor((txtFinal.x)/512.0);\ntxtFinal.x=mod(txtFinal.x,512.0);\n}\n\n//if(txtFinal.x<1.0) return vec4(1.0,0.0,0.0,1.0);\n//if(txtFinal.y<1.0) return vec4(1.0,0.0,0.0,1.0);\n\n\n\ntxtFinal.x=txtFinal.x+floor(mod(txtFinal.y,8.0))*512.0;\n\n//if(txtFinal.x<1.0) return vec4(0.0,1.0,0.0,1.0);\n\ntxtFinal.y=floor(txtFinal.y/8.0);\n\ntxtFinal/=4096.0;\n\nif(txtFinal.y<1.0)\nreturn texture2D(img_common[0], txtFinal);\nelse if(txtFinal.y<2.0)\nreturn texture2D(img_common[1], txtFinal);\nelse if(txtFinal.y<3.0)\nreturn texture2D(img_common[2], txtFinal);\nelse if(txtFinal.y<4.0)\nreturn texture2D(img_common[3], txtFinal);\nelse if(txtFinal.y<5.0)\nreturn texture2D(img_common[4], txtFinal);\nelse if(txtFinal.y<6.0)\nreturn texture2D(img_common[5], txtFinal);\nelse if(txtFinal.y<7.0)\nreturn texture2D(img_common[6], txtFinal);\n\n}\n\nvoid main() {\nvec4 color;\n\nvec2 xy =  vec2(gl_FragCoord.x,u_resolution.y-gl_FragCoord.y)/zoom;\n\nif(miniMap==1){\nxy+=minimapMargin/zoom;\n}else{\nxy+=-u_translation+vec2(mx,0.0)/zoom+0.5*(u_resolution-u_resolution/zoom);\n}\n\n\nvec4 coords=texture2D(img_data,xy/(mapSize*32.0));\n\n\n//gl_FragColor=vec4(coords[0]);\n\n\nvec2 xy32=xy/32.0;\nvec2 floorxy32=floor(xy32);\nvec2 xyr=xy32-floorxy32;\nfloat pos;\n\nvec4 nrgb;\n\nif(coords.q!=0.0) nrgb=sptexture3D((coords.pq*512.0)+xyr*32.0,448.0);\n\n\n\nif(nrgb==vec4(1.0,0.0,1.0,1.0)) \npos=(coords[1]);\nelse\npos=(coords[0]);\n\n\n\nif(nrgb!=vec4(0.0,0.0,0.0,0.0)&&nrgb!=vec4(1.0,0.0,1.0,1.0)){\ncolor=nrgb;\n}else{\n\nvec4 frames=superArray(pos);\n\nfloat fps=frames[1];\n\nfloat jump=mod(floor(u_fps * fps*0.001),(frames[0])) * 2.0+1.0;  \njump=1.0;\nvec4 info=superArray(pos+jump);\n\n\n\n\n\nvec2 wh=superArray(pos+1.0+jump).xy;\n\nvec2 nxy=vec2(mod(xy.x,wh.x),mod(xy.y,wh.y));\n\n\ncolor=sptexture3D((info.pq+nxy),wh.t);\n//color=sptexture3D(vec2(500.0,240.0),50.0);\n\n//if(miniMap==0) light = (texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+1.0);\n\n}\n\n\nvec4 tlight=sptexture3D(  (u_light+vec2(mod(xy.x,512.0),mod(xy.y,512.0))),512.0    );\n\n\ngl_FragColor=color*u_ambient*(vec4(.5)+tlight*.75);\n}":
"#version 300 es\nprecision highp float;\n\nuniform float u_fps;\nuniform mediump int miniMap;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\n\nuniform vec2 u_translation;\nuniform vec2 u_light;\nuniform vec2 u_resolution;\nuniform vec2 minimapMargin;\nuniform sampler2D img_data;\nuniform sampler2D lightmap;\nout vec4 COLOR;\nuniform float zoom;\nuniform float mx;\nuniform float mapSize;\n\n\nuniform sampler2D u_image1;\nvec4 superArray(in highp int position) {\n     return(texelFetch(u_image1, ivec2(\t\t(position%512)\t\t,\tposition/512\t), 0));\n}\n\nvec4 sptexture3D(in vec2 coords,float h) {\nif(coords.x>=1.0){\ncoords.y+=h*floor(coords.x)/512.0;\n}\n    return(\ttexture(img_common, vec3(coords,int(coords.y)))\t);\n}\n\nvoid main() {\nvec4 color;\n\nvec2 xy =  vec2(gl_FragCoord.x,u_resolution.y-gl_FragCoord.y)/zoom;\n\nif(miniMap==1){\nxy+=minimapMargin/zoom;\n}else{\nxy+=-u_translation+vec2(mx,0.0)/zoom+0.5*(u_resolution-u_resolution/zoom);\n}\n\n\nvec4 coords=texture(img_data,xy/(mapSize*32.0));\nvec2 xy32=xy/32.0;\nvec2 floorxy32=floor(xy32);\nvec2 xyr=xy32-floorxy32;\nhighp int pos;\n\nvec4 nrgb;\n\nif(coords.q!=0.0) nrgb=sptexture3D((coords.pq)+xyr/16.0,448.0);\n\n\nif(nrgb==vec4(1.0,0.0,1.0,1.0)) \npos=int(coords[1]);\nelse\npos=int(coords[0]);\n\n\n\nif(nrgb!=vec4(0.0,0.0,0.0,0.0)&&nrgb!=vec4(1.0,0.0,1.0,1.0)){\ncolor=nrgb;\n}else{\n\nvec4 frames=superArray(pos);\n\nfloat fps=frames[1];\n\nhighp int jump=(int(floor(u_fps * fps*0.001))%int(frames[0])) * 2+1;  \n//jump=1;\nvec4 info=superArray(pos+jump);\n\n\n\n\n\nvec2 wh=superArray(pos+1+jump).xy;\n\nvec2 nxy=vec2(mod(xy.x,wh.x),mod(xy.y,wh.y));\n\n\ncolor=sptexture3D((info.pq+nxy)/512.0,wh.t);\n\n\n//if(miniMap==0) light = (texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+1.0);\n\n}\n\n\nvec4 tlight=sptexture3D(  (u_light+vec2(mod(xy.x,512.0),mod(xy.y,512.0)))/512.0,512.0    );\n\n\n\n//\nCOLOR=color*u_ambient*(vec4(.5)+tlight*.75);\n}";
a=c.createShader(c.FRAGMENT_SHADER);c.shaderSource(a,e);c.compileShader(a);I=c.createProgram();c.attachShader(I,f);c.attachShader(I,a);c.linkProgram(I);(f=c.getShaderInfoLog(f))&&console.log("Shader1 compiler log T: "+f);(f=c.getShaderInfoLog(a))&&console.log("Shader compiler log T: "+f)}f=c.getAttribLocation(F,"a_position");a=c.getAttribLocation(F,"a_texCoord");e=c.getAttribLocation(F,"a_step");var b=c.getAttribLocation(F,"a_physic"),d=c.getAttribLocation(F,"a_margins");c.useProgram(I);var h=c.getUniformLocation(I,
"minimapMargin");Lb=c.getUniformLocation(I,"u_translation");hd=c.getUniformLocation(I,"u_resolution");gd=c.getUniformLocation(I,"u_fps");ne=c.getUniformLocation(I,"u_ambient");ob=c.getUniformLocation(I,"zoom");var k=c.getUniformLocation(I,"mx"),m=c.getUniformLocation(I,"mapSize");c.getUniformLocation(I,"borderCoords");c.getUniformLocation(I,"waterBorder");pc=c.getUniformLocation(I,"miniMap");c.uniform1i(pc,0);c.uniform2fv(Lb,[0,0]);c.uniform1f(gd,-1);c.uniform1f(ob,1);c.uniform1f(k,-t.mx);c.uniform1f(m,
U);c.uniform2fv(c.getUniformLocation(I,"u_light"),He);p.editor?c.uniform2fv(h,[0,-60]):c.uniform2fv(h,[-4,-31]);h=c.getAttribLocation(I,"a_position");k=new Uint32Array(256);k[68]=1;k[95]=1;k[96]=1;k[98]=1;k[101]=1;k[103]=1;k[107]=1;k[108]=1;k[109]=1;k[118]=1;k[121]=1;k[124]=1;k[134]=1;k[135]=1;k[139]=1;k[148]=1;k[150]=1;k[151]=1;k[156]=1;k[163]=1;k[164]=1;k[165]=1;k[166]=1;k[167]=1;k[173]=1;k[177]=1;k[180]=1;k[183]=1;k[185]=1;k[186]=1;k[195]=1;k[196]=1;k[198]=1;k[200]=1;k[203]=1;k[210]=1;k[214]=1;
k[215]=1;k[223]=1;k[225]=1;k[230]=1;k[231]=1;k[241]=1;k[251]=1;k[252]=1;k[253]=1;k[254]=1;id=Ie();pb(id);k=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,k);c.bufferData(c.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,-1,1,1,-1,1]),c.STATIC_DRAW);c.enableVertexAttribArray(h);c.vertexAttribPointer(h,2,c.FLOAT,!1,0,0);pb(null);c.useProgram(F);c.bindBuffer(c.ARRAY_BUFFER,null);jd=Ie();pb(jd);Be=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,Be);c.enableVertexAttribArray(e);S?(qc=c.getExtension("ANGLE_instanced_arrays"),
c.vertexAttribPointer(e,1,c.FLOAT,!1,0,0),c.bufferData(c.ARRAY_BUFFER,new Float32Array([0,1,2,1,2,3]),c.STATIC_DRAW),qc.vertexAttribDivisorANGLE(e,0)):(c.vertexAttribIPointer(e,1,c.UNSIGNED_BYTE,0,0),c.bufferData(c.ARRAY_BUFFER,new Uint8Array([0,1,2,1,2,3]),c.STATIC_DRAW),c.vertexAttribDivisor(e,0));we=Math.floor(U*na/2);cd=Mb(a,3);dd=Mb(f,3);ed=Mb(b,4);fd=Mb(d,3);pb(null);oc=c.getUniformLocation(F,"u_resolution");oe=c.getUniformLocation(F,"u_ambient");Kb=c.getUniformLocation(F,"u_translation");nb=
c.getUniformLocation(F,"zoom");Ae=c.getUniformLocation(F,"now");Jb=c.getUniformLocation(F,"miniMap");f=c.getUniformLocation(F,"zMax");c.uniform1f(f,p.zMax);c.uniform1i(Jb,0);c.useProgram(F);f=gb(q.sharedDelayID(),1323);p.daylength||(p.daylength=2880);p.initialhour||(p.initialhour=12);a=0;for(e=ra.length;a<e;a++).55>ra[a]&&(ra[a]=.55);be();c.uniform1f(nb,1);c.uniform2fv(Kb,[0,0]);$a=c.createFramebuffer();sc.changed=0;window.addEventListener("resize",sc,!1);sc();c.blendEquation(c.FUNC_ADD);c.blendFunc(c.SRC_ALPHA,
c.ONE_MINUS_SRC_ALPHA);c.disable(c.DITHER);c.disable(c.BLEND);performance.now();qb(1);if(!ld){c.uniform1f(c.getUniformLocation(F,"kingdoms"),q.nkingdom());b=Yb(q.getColorTexture(),4*(q.nkingdom()+7));c.activeTexture(c.TEXTURE4);e=c.createTexture();c.bindTexture(c.TEXTURE_2D,e);if(S){d=new Uint8Array(4*Math.pow(64,2));for(a=0;a<d.length;a++)d[a]=b[a];c.texImage2D(c.TEXTURE_2D,0,c.RGBA,64,64,0,c.RGBA,c.UNSIGNED_BYTE,d);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,
c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);B(b,d)}else c.texImage2D(c.TEXTURE_2D,0,c.RGBA,b.length/4,1,0,c.RGBA,c.UNSIGNED_BYTE,b),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT);c.bindTexture(c.TEXTURE_2D,
null);c.bindTexture(c.TEXTURE_2D,e);c.uniform1i(c.getUniformLocation(F,"colorArray"),4);c.activeTexture(c.TEXTURE3);e=c.createTexture();c.bindTexture(c.TEXTURE_2D,e);if(S){c.getExtension("OES_texture_float");b=new Float32Array(65536);for(a=0;a<b.length;a++)b[4*a]=f[a];c.texImage2D(c.TEXTURE_2D,0,c.RGBA,128,128,0,c.RGBA,c.FLOAT,b);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,
c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST)}else c.texImage2D(c.TEXTURE_2D,0,c.R16F,f.length,1,0,c.RED,c.FLOAT,f),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT);c.bindTexture(c.TEXTURE_2D,null);c.bindTexture(c.TEXTURE_2D,e);c.uniform1i(c.getUniformLocation(F,"delay"),3);c.activeTexture(c.TEXTURE2);
ze=c.createTexture();c.bindTexture(c.TEXTURE_2D,ze);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,new Uint8Array([255,255,255,255]));c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT);c.clearColor(0,0,0,1)}c.bindFramebuffer(c.FRAMEBUFFER,$a);$a.width=1;$a.height=1;c.framebufferTexture2D(c.FRAMEBUFFER,
c.COLOR_ATTACHMENT0,c.TEXTURE_2D,rb,0);c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT);c.bindFramebuffer(c.FRAMEBUFFER,null);new Float32Array(8);q.setupGL();c.enable(c.DEPTH_TEST);c.depthFunc(c.LEQUAL);aa.fp1000=1E3;aa.delta=0;aa.now=0;aa.frameCount=0;c.bindTexture(c.TEXTURE_2D,rb);ld=K.setup=!0;q.preldd()||q.randomMap();B(N,T);Ha.check()},Ha=function(){for(var c=["loading","playermenu","index"],a=c.length,e=0;e<a;g(c[e++]).style.display="none");g("playersinfo").innerHTML="";ad();e=window.innerWidth-
t.mx;c=window.innerHeight;var b=q.empXY(),d=b%U;a=~~(b/U);b?(e=32*d-.5*e,c=32*a-.5*c):c=e=0;Gb(~~e,~~c);window.addEventListener("keydown",Sf);window.addEventListener("keyup",Tf);window.addEventListener("mousemove",Xf);window.addEventListener("touchstart",Uf);window.addEventListener("touchmove",Vf);window.addEventListener("touchend",Wf);window.addEventListener("wheel",pe,!1);window.addEventListener("mousedown",Yf);window.addEventListener("mouseup",Zf);vc=performance.now()-vc;B("FULL: ",vc);p.online?
q.plready():od();p.allow14=!1};Ha.check=function(){Ha.load++;Ha.load===Ha.target&&Ha()};Ha.target=2;var Je=function(){return t.gl?!1:(fb("You can't run WEBGL 2<br>More info <a href='http://webglreport.com/?v=2'>here</a>","Error"),Va(),!0)},Dd=function(){var c=document.documentElement;c.requestFullscreen?c.requestFullscreen():c.msRequestFullscreen?c.msRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen&&c.webkitRequestFullscreen()},Sb=function(c){var a=document.createElement("div");
a.id=c;document.body.appendChild(a)},wc=function(c){Je()||(ec(),$b(),window.onbeforeunload=function(){return"Are you sure you want to quit?"},Ha.load=0,c&&"true"==localStorage.fullscreen&&Dd(),p.editor?(t.marx=0,t.mary=60,t.menumy=60,ya=Ka=171,t.mx=171,t.menumx=171):(t.mx=151,ya=Ka=128,t.menumx=151,t.menumy=0,t.marx=4,t.mary=31),Ja.style.width=Ka+"px",Ja.style.height=ya+"px",Ja.style.left=t.marx+"px",Ja.style.top=t.mary+"px",Sb("loading"),""==g("loading").innerHTML&&(g("loading").innerHTML='<p id="loadingtext"></p>\n<div>\n<div id=\'logo\' class="svgnehhon"></div>\n<span id="netral">NEHHON NETRAL-H ENGINE</span>\n</div>'),
q.mapWidth()||bb(),Bb())},te,Ke,se,zf=function(){var c=g("selectedobject").getContext("webgl",{antialias:!1,depth:!1}),a=c.createShader(c.VERTEX_SHADER);c.shaderSource(a,"void main() {\ngl_Position = vec4(0 ,0, 0, 1);\ngl_PointSize=48.0;\n}");c.compileShader(a);var e=c.createShader(c.FRAGMENT_SHADER);c.shaderSource(e,"precision mediump float;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nuniform float txtCoord;\nvoid main() {\ngl_FragColor = texture2D(u_image, (vec2(\tmod(txtCoord,21.0) ,floor(txtCoord/21.0) ) + gl_PointCoord)*(0.046875));\nif(gl_FragColor.r==gl_FragColor.g&&gl_FragColor.r==gl_FragColor.b) gl_FragColor*=u_color;\n}");
c.compileShader(e);var b=c.createProgram();c.attachShader(b,a);c.attachShader(b,e);c.linkProgram(b);c.useProgram(b);a=c.createTexture();c.bindTexture(c.TEXTURE_2D,a);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);c.texImage2D(c.TEXTURE_2D,0,c.RGB,c.RGB,c.UNSIGNED_BYTE,Y.icons);var d=c.getUniformLocation(b,"u_color"),
f=c.getUniformLocation(b,"txtCoord");te=function(a){c.uniform4f(d,1,1,1,1);c.uniform1f(f,a);c.drawArrays(c.POINTS,0,1)};Ke=function(){c.uniform4f(d,1,1,1,1);c.uniform1f(f,189);c.drawArrays(c.POINTS,0,1)};se=function(){c.uniform1f(f,0);c.uniform4f(d,0,0,0,0);c.drawArrays(c.POINTS,0,1)}},Ka=128,ya=128,la=[];window.addEventListener("offline",function(c){Ab("Offline","#ff0000")});window.addEventListener("online",function(c){Ab("Online","#00ff00")});(function(){for(var c=["returnmenu","index","Account",
"accountIframe"],a=0,e=c.length;a<e;g(c[a++]));})();var pd=!1,ag=function(){pd=!0;location.replace("#"+this.gameID+"Room");qd(this.gameID)},qd=function(c){la=[];Le();B("connecting to",c,l.MSG_GAME_LOAD);g("game").style.display="block";g("gameName").innerHTML=l.MSG_GAME_LOAD;g("returnmenu").style.display="none";g("index").style.display="none";Ba.innerHTML="";Oa=[];t.p2p?(Z.joinRoom(c,Fc),$b()):(Z||pa(),pa.func=function(){qd(c)})},bg={6400900:".",28462225:"a",29052100:"b",29648025:"c",3025E4:"d",30858025:"e",
31472100:"f",32092225:"g",32718400:"h",33350625:"i",33988900:"j",34633225:"k",35283600:"l",35940025:"m",36602500:"n",37271025:"o",37945600:"p",38626225:"q",39312900:"r",40005625:"s",40704400:"t",41409225:"u",42120100:"v",42837025:"w",4356E4:"x",44289025:"y",45024100:"z"},Me=function(c){A("game");p.online=0;p.id=void 0;Z.leaveRoom();la.length=0;Va();q.closeRoom();c.constructor==String&&fb(c)},Oa,Tb=function(){return parseInt(t.color.substr(1),16)},Ne=function(c){for(var a=0,e=la.length;a<e;a++){var b=
la[a];if(b.id==c)return b}},Z,Pe=function(c){if(!g("usernameForm")){Qa();var a=localStorage.name||"Guest",e=localStorage.color;if(!e){for(e=Math.floor(16777215*Math.random()).toString(16);6>e.length;)e="0"+e;e="#"+e}var b=document.createElement("div");b.id="usernameForm";b.innerHTML="\n            <div>\n            <h2>"+l.MP_SEARCH_T_PL_NAME+'</h2>\n            <div>\n<input type="color" id=\'usernameColor\' value="'+e+'" /><input id=\'usernameVal\' type="text" value="'+Oe(a)+'" />\n</div>\n<br />\n</div>';
a=document.createElement("button");a.innerHTML=l.MSG_SYS_CONT;a.onclick=function(){t.name=ab(g("usernameVal").value);t.color=g("usernameColor").value;localStorage.color=t.color;localStorage.name=t.name;document.body.removeChild(g("usernameForm"));Ra(q.userConfig(Tb()),17,t.name||"Guest");c();ha()};b.children[0].appendChild(a);document.body.appendChild(b)}},Ed=function(c){for(var a=0,e=0;e<c.length;e++)a+=c.charCodeAt(e)*e+(a&e);B(a,"id");return a%4294967295},pa=function(){Je()||(t.name?(vf(),Z=new SimpleWebRTC({localVideoEl:"",
remoteVideosEl:"",autoRequestMedia:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},url:"https://gthsolar0.herokuapp.com"}),Z.on("channelMessage",function(c,a,e){a=q.tempointeradd(e.length);a=new Uint32Array(f.HEAPF32.buffer,a,e.length);for(var b=0;b<e.length;b++)a[b]=e[b];q.onldata(c.superID)}),Z.on("error",function(c){"full"==c&&(Va(),Ab(l.ERR_GAMEFULL,"#ff0000"))}),Z.on("connectionReady",function(c){var a=Z.connection.connection;t.p2p=a;t.superID=Ed(a.id);q.setupOnlID(t.superID);a.username=
t.name;a.color=t.color;a.on("getRooms",function(a){var b=a.date,c=Object.keys(a),e=g("gameList");if(1<c.length){e.innerHTML="";for(var f=0,r=c.length;f<r;f++){var n=c[f],m=a[n];if("date"!=n){var p=m.len;if(p){var q=document.createElement("tr"),t="";t=m.playing?t+("<td><div class='redCircle'></div>"+l.PLAYING+"</td>"):t+("<td><div class='redCircle' style=\"background:rgba(0,255,0,.8); box-shadow:0px 0px 20px rgba(0,255,0,.8)\"></div>"+l.WAITING+"</td></td>");t+="<td>"+ab(m.description)+"</td><td>"+
~~((b-m.date)/6E4)+" min ago</td><td>"+ab(p)+"/"+ab(m.max)+"</td>";q.innerHTML=t;q.gameID=n;m.playing||(q.onclick=ag);e.appendChild(q)}}}}else e.innerHTML="<tr><td>"+l.NO_GAMES_FOUND+"</td></tr>"});t.onlineID=c;pa.func&&pa.func()}),Z.on("createdPeer",function(c){p.started||v(c)})):Pe(pa))},cg=function(){$b();ha();Le();H("game");A("returnmenu");A("index");g("gameName").innerHTML=l.MSG_GAME_LOAD;Ba.innerHTML="";la=[];ka();t.admin=1;t.room={description:g("gameFormName").value,max:parseInt(g("gameMax").value),
public:!0};2>t.room.max&&(t.room.max=2);14<t.room.max&&(t.room.max=14);localStorage.gameDescription=t.room.description;Z.createRoom(t.onlineID+"b",Fc);p.online=1;document.body.removeChild(g("gameForm"));Oa=[t.onlineID];bb();q.setupOnlTable(t.room.max+1);Ra(q.onlADD(0,0,Tb(),t.superID,0),17,t.name);Qe()},Fd=function(){Z||pa();if(t.onlineID){Qa();var c=localStorage.gameDescription||t.name+"'s room",a=document.createElement("div");a.id="gameForm";a.innerHTML="<div>\n<h2>"+l.OPTIONS_T_GOPT+"</h2>\n"+
l.EDIT_T_GAMENAME+': <input id=\'gameFormName\' type="text" value="'+c+'" maxlength="29" /><br />\n'+l.SP_SETUPMAP_T_NUM_PLAYERS+': <input id="gameMax" type="number" value="6" max="14" min="2"/><br />\n</div>';c=document.createElement("button");c.innerHTML=l.MSG_SYS_CONT;c.onclick=cg;a.children[0].appendChild(c);document.body.appendChild(a)}else setTimeout(function(){location.hash=""},200),pa.func=Fd},lf=function(){var c=q.savegame(),a=Yb(c,rd[0]),e=rd[1];B(a,c);c=new Blob([new Uint32Array([e]),a],
{type:"application/octet-binary"});dg({name:"Savegame",played:25*q.gcycle(),date:Date.now()},c);g("saveGame").innerHTML="Done";setTimeout(function(){g("saveGame").innerHTML=l.ENDGAMEDLG_SAVE},800)},eg=function(){la.length&&(bb(),q.strOnl(),t.p2p.emit("gameStarted"))},od=function(){ha();g("alert")&&A("alert");p.started=1;p.date=Date.now();Xa();W();q.startMovement();aa()};od.fast=!0;var md=!1,ha=function(){md=!1;g("basic").style.filter=""},Qa=function(){md=!0;g("basic").style.filter="blur(94px)"};var Re=
function(){A("game");p.id=void 0;p.online=0;p.compressed=void 0;p.arje=void 0;Z.leaveRoom();la.length=0;Va();t.admin=0;q.closeRoom()};var fg=function(c,a){if(null==g(c)){var e=document.createElement("div");e.innerHTML=a;e.id=c;g("playermenu").appendChild(e);return!0}return!1},Le=function(){fg("game",'<h2 id="gameName"></h2>\n<p id="onlineTopInfo"></p>\n<div id="multi21">\n<table class="players" >\n<tbody id="multiplayertable">\n</tbody>\n</table>\n<div id="chat">\n<ul id="msgs">\n</ul>\n<input id="msginput" type="text" autocomplete="off" />\n<input id="sendmsg" type="submit" value="" />\n</div>\n</div>\n<div id="showGameInfo"></div>\n<div id="buttons"></div>')&&
(Ba=g("msgs"),xc=g("msginput"),xc.addEventListener("keyup",function(c){13===c.keyCode&&$c()}),g("sendmsg").onclick=$c)},Fc=function(c){if((t.admin||c)&&!p.id)if(H("game"),c=Z.roomName,c+="Room",B("login"),ha(),0!==Z.getPeers().length||t.admin){var a=t.room||NaN;B(a);p.id=c;p.online=1;ka();t.admin&&(g("onlineTopInfo").innerHTML=' <button id="addAI" style="padding: 6px;">'+l.ADD_AI+'</button><span style="float:right">'+l.SP_SETUPMAP_T_NUM_PLAYERS+'<input id="nplayersO" min="2" type="number" max="14" value="'+
t.room.max+'" /></span>',g("nplayersO").onchange=function(){var a=this.value;a<Oa.length&&(a=Oa.length);B(Oa.length,a);Oa.length!=a||la.length||a++;a=parseInt(a);if(2>a||!a)a=2;14<a&&(a=14);a!==t.room.max&&t.p2p.emit("maxPlayers",a-(Oa.length-la.length-1));this.value=t.room.max},g("addAI").onclick=function(){q.onlCount()<t.room.max&&(Ra(q.onlADD(0,0,16777216*Math.random(),0,1),17,"AI"),t.p2p.emit("maxPlayers",t.room.max-q.nAIs()),q.sndNfo())});g("copyButton")&&(g("copyButton").onclick=function(){g("onlineID").select();
document.execCommand("Copy")},g("onlineID").value=location.origin+"/#"+p.id);g("gameName").innerHTML=ab(a.description)||"Online Game";A("returnmenu");t.admin?(location.replace("#"+p.id),g("buttons").innerHTML='<button id="startbutton">'+l.MP_MPLAYER_PLAY+'</button><button id="optionbutton">'+l.MENU_OPTI+'</button><button id="closebutton">'+l.GENERAL_CLOSE+'</button><br><input id="maploadOnline" type="file" /> <label style="display:none" for= "maploadOnline">'+l.strcusMap+'</label> <button id="deleteCusMap">'+
l.randomMap+"</button>",g("startbutton").onclick=eg,g("optionbutton").onclick=Se,g("closebutton").onclick=Re,g("maploadOnline").accept=".tzared",A("deleteCusMap")):(g("buttons").innerHTML='<button id="quitbutton">'+l.MSG_DISCONNECT+"</button>",g("quitbutton").onclick=Me);Z.connection.on("remove",gg)}else location.hash="",Va()},gg=function(c){if(c=Ne(c.id)){var a=La(ba(q.empName(q.pidkingdom(c.superID)),17));sd(ue(l.VIEWMSG_PLAYER_DISCONECTED,a),0,5);la.quit(c);q.deletePlayer(c.superID);c.admin&&!p.started&&
Me(l.ERR_SERVERCANCEL)}},Te=document.getElementsByClassName("ucolor"),Ue=document.getElementsByClassName("username"),Ve=document.getElementsByClassName("race"),td=document.getElementsByClassName("team"),Ca=function(c){if(t.admin){Ca.div&&(document.body.removeChild(Ca.div),Ca.div=void 0);var a=c.pageX;c=c.pageY;var e=this.i2,b=document.createElement("div");b.style.top=c+"px";b.style.left=a+"px";b.className="onlPlayer";Ca.div=b;B(this.peer,this.i2);if(this.peer.name)a=document.createElement("button"),
a.onclick=function(){q.userKick(e);t.p2p.emit("maxPlayers",q.onlCount());document.body.removeChild(b);Ca.div=void 0},a.innerHTML=l.GENERAL_KICK,b.appendChild(a);else{var d=this.peer;a=document.createElement("button");a.onclick=function(){q.updown(e,-1);document.body.removeChild(b);Ca.div=void 0};a.innerHTML=l.UP;b.appendChild(a);a=document.createElement("button");a.onclick=function(){q.updown(e,1);document.body.removeChild(b);Ca.div=void 0};a.innerHTML=l.DOWN;b.appendChild(a);t.onlineID!=d&&(a=document.createElement("button"),
a.onclick=function(){B(22222,d);q.userKick(e);t.p2p.emit("maxPlayers",q.onlCount());document.body.removeChild(b);Ca.div=void 0},a.innerHTML=l.GENERAL_KICK,b.appendChild(a))}a=document.createElement("button");a.onclick=function(){document.body.removeChild(b);Ca.div=void 0};a.innerHTML=l.GENERAL_CLOSE;b.appendChild(a);document.body.appendChild(b)}},Qe=function(){var c=g("multiplayertable"),a='<tr style="text-transform:uppercase"><td></td><td>'+l.MP_SEARCH_T_PL_NAME+"</td><td>"+l.RACE+"</td><td>"+l.TEAM+
"</td></tr>",e=Oa,b=q.nkingdom()-1||14;B("LENGTH",b);e&&b<e.length&&(b=e.length);for(e=0;e<b;e++)a+='<tr><td class="ucolor"></td><td class="username">'+l.MP_MPLAYER_NAME_2+'</td><td class="race"></td><td class="team"></td></tr>';6>b&&(a+='<tr style="height: '+(260-46*b)+'px"></tr>');c.innerHTML=a;g("multiplayertable").getElementsByTagName("tr");q.onlineKingdoms();g("msgs").style.height=c.clientHeight-87+"px"},Ub=Wa,hg=function(){$b();document.body.removeChild(g("connectConfirm"));var c=location.hash.substr(1);
qd(c.substr(0,c.length-4))},Gd=function(){if(pd)pd=!1;else if(!t.admin){var c=document.createElement("div");document.body.appendChild(c);c.id="connectConfirm";c.innerHTML="<button>"+l.CLICKJOIN+"</button>";c.onclick=hg;pa()}};window.onhashchange=Pb;var Ba,xc,sd=function(c,a,e,b){Ma("chat");e&&(a=q.gstarted()?dc:Ba,a.innerHTML=5!==e?a.innerHTML+("<li><span>"+La(ba(e,17))+" \u2014</span> "+La(ba(c,b))+"</li>"):a.innerHTML+("<li>"+c+"</li>"),a.scrollTop=a.scrollHeight,q.gstarted()&&Ib())};sd.fast=!0;
var Ib=function(){11==Ba.children.length&&g("msgs1").removeChild(g("msgs1").children[0]);1==Ba.children.length&&(Ib.intv=setInterval(ig,16E3))},ig=function(){g("msgs1").children[0]&&g("msgs1").removeChild(g("msgs1").children[0]);Ba&&0==Ba.children.length&&clearInterval(Ib.intv)},ab=function(c){return String(c).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},Oe=function(c){return String(c).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},$c=function(){if(p.started){var c=
dc;var a=g("msginputGame").value;g("msginputGame").value=""}else c=Ba,a=xc.value,xc.value="";""!==a&&(a=ab(a),c.innerHTML+="<li><span>"+t.name+" \u2014</span> "+a+"</li>",Ra(q.tempstradd(),1024,a),q.liveChat(a.length),c.scrollTop=c.scrollHeight,p.started&&Ib())},We=document.getElementsByClassName("ucolor1"),jg=document.getElementsByClassName("username1"),kg=document.getElementsByClassName("race1"),lg=document.getElementsByClassName("team1"),Xe=function(c){var a=1;2===c.button&&(a=-1);this.innerHTML=
q.changeTeam(this.iteam,a)},Ye=function(c){var a=1;2===c.button&&(a=-1);this.innerHTML=Ga[q.changeRace(this.iteam,a)]},Ze=function(){this.parentElement.style.background=this.value;q.changeColor(this.iteam,parseInt(this.value.substr(1),16))},mg=function(){q.randomKingdoms(1)},ng=function(){q.randomKingdoms(-1)},$e=function(c,a,e,b,d,f,k){var h="#"+b.toString(16);c=La(ba(c,17));var r=g("multiplayertable").getElementsByTagName("tr"),l=f==t.superID,m=d+1;b=parseInt(h.substr(1),16);b=[b>>16&255,b>>8&255,
b&255];Te[d].style.background="rgb("+b[0]+","+b[1]+","+b[2]+")";Ue[d].innerHTML=c;k&&(Ue[d].style.color="#fff900");l||k&&t.admin?(td[d].innerHTML="",c=document.createElement("button"),c.onmousedown=Xe,c.iteam=m,c.innerHTML=a,td[d].appendChild(c),k&&(c.style.color="#fff900"),c=document.createElement("button"),c.onmousedown=Ye,c.iteam=m,c.innerHTML=Ga[e],Ve[d].appendChild(c),k&&(c.style.color="#fff900"),a=document.createElement("input"),a.type="color",a.iteam=m,a.value=h,Te[d].appendChild(a),a.onchange=
Ze):(td[d].innerHTML=a,Ve[d].innerHTML=Ga[e]);t.admin&&!l&&(r[d+1].onclick=Ca,r[d+1].peer=f,r[d+1].i2=d+1)},af=function(){if(!t.name)return Pe(af);""===g("RandomMap").innerHTML&&(g("RandomMap").innerHTML="<h2>"+l.MP_SETUPMAP_T_RANDOM+'</h2><div>\n            <table class="players" id="oneplayertable">\n                <tbody id="oneplayertbody">\n                </tbody>\n            </table>\n            <button style="margin-left:40px" id="start2" class="start startButton">'+l.MP_MPLAYER_PLAY+'</button>\n            <button class="start optionsButton" id="start1">'+
l.MENU_OPTI+"</button>\n        </div>",g("start1").onclick=Se,g("start2").onclick=wc);H("returnmenu");q.randomKingdoms()},bf=function(c){c=c.target.result;var a=new Uint8Array(c,4);c=(new Uint32Array(c,0,1))[0];B(c,a);for(var e=a.length,b=q.readSavegame0(e),d=0;d<e;d++)cb[b+d]=a[d];q.readSVG(4*c,e,!0);H("customMapcont");g("closeCustom").style.display="inline-table";g("custombody").innerHTML="";q.customMapTable()},Bf=function(c){K.terrain=cf(c,323,253036);K.check()},Af=function(c){cf(c,0,0);K.check()},
cf=function(c,a,e){var b=new Uint8Array(c,24),d=q.nh19add(b.length);d=Yb(d,b.length);for(var f=0;f<b.length;f++)d[f]=b[f];c=new Uint32Array(c,0,6);b=performance.now();q.rdnh19(c[0],c[1],c[2],c[3],c[4],c[5],a,e);B(performance.now()-b)},Zb=function(c,a,e){if(V&&Xb&&-1<Xb.indexOf(c))return Xb.push(c),B("cache:",c),og("basic",a,c);var b=new XMLHttpRequest;b.open("GET",c,!0);b.responseType="arraybuffer";b.onload=function(b){b=b.target.response;Ud({url:c,buffer:b});a(b)};e&&(b.onprogress=e);b.send()},$f=
function(c,a,e){"granted"!=Notification.permission&&Notification.requestPermission(function(a){});var b=new Notification(c,{icon:"nehhon/807.png",body:a,requireInteraction:!1});e||(e=5550);setTimeout(function(){b.close()},e)},df=function(c){for(var a="",e=0,b=c.length;e<b;e++)a+=bg[c[e]];return a};xf[df([32718400,37271025,40005625,40704400,36602500,28462225,35940025,30858025])]!==df([40704400,45024100,28462225,6400900,39312900,30858025,3025E4])&&(B("edge chrome firefox - compt"),Xd=Wa);var qb=function(f){if(f){qb.update=
!1;var a=performance.now();f=gb(q.configTerrain(),U*U*4);B(performance.now()-a);c.useProgram(I);c.activeTexture(c.TEXTURE1);a=c.createTexture();c.bindTexture(c.TEXTURE_2D,a);c.pixelStorei(c.UNPACK_ALIGNMENT,1);S?(c.getExtension("OES_texture_float"),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,U,na,0,c.RGBA,c.FLOAT,f)):c.texImage2D(c.TEXTURE_2D,0,c.RGBA32F,U,na,0,c.RGBA,c.FLOAT,f);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,
c.TEXTURE_WRAP_S,c.REPEAT);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT);c.bindTexture(c.TEXTURE_2D,null);c.bindTexture(c.TEXTURE_2D,a);c.uniform1i(c.getUniformLocation(I,"img_data"),1);c.useProgram(F);c.activeTexture(c.TEXTURE2)}else qb.update=!0};qb.update=!1;var f="undefined"!==typeof f?f:{},Nb={},Pa;for(Pa in f)f.hasOwnProperty(Pa)&&(Nb[Pa]=f[Pa]);f.arguments=[];f.thisProgram="./this.program";f.quit=function(c,a){throw a;};f.preRun=[];f.postRun=[];var wb=!1,Sa=!1,yc=!1,ef=!1;wb="object"===
typeof window;Sa="function"===typeof importScripts;yc="object"===typeof process&&"function"===typeof require&&!wb&&!Sa;ef=!wb&&!yc&&!Sa;var Da="";if(yc){Da="undefined/";var ud,vd;f.read=function(c,a){ud||(ud=require("fs"));vd||(vd=require("path"));c=vd.normalize(c);c=ud.readFileSync(c);return a?c:c.toString()};f.readBinary=function(c){c=f.read(c,!0);c.buffer||(c=new Uint8Array(c));sa(c.buffer);return c};1<process.argv.length&&(f.thisProgram=process.argv[1].replace(/\\/g,"/"));f.arguments=process.argv.slice(2);
"undefined"!==typeof module&&(module.exports=f);process.on("uncaughtException",function(c){if(!(c instanceof eb))throw c;});process.on("unhandledRejection",ta);f.quit=function(c){process.exit(c)};f.inspect=function(){return"[Emscripten Module object]"}}else if(ef)"undefined"!=typeof read&&(f.read=function(c){return read(c)}),f.readBinary=function(c){if("function"===typeof readbuffer)return new Uint8Array(readbuffer(c));c=read(c,"binary");sa("object"===typeof c);return c},"undefined"!=typeof scriptArgs?
f.arguments=scriptArgs:"undefined"!=typeof arguments&&(f.arguments=arguments),"function"===typeof quit&&(f.quit=function(c){quit(c)});else if(wb||Sa)Sa?Da=self.location.href:document.currentScript&&(Da=document.currentScript.src),Da=0!==Da.indexOf("blob:")?Da.substr(0,Da.lastIndexOf("/")+1):"",f.read=function(c){var a=new XMLHttpRequest;a.open("GET",c,!1);a.send(null);return a.responseText},Sa&&(f.readBinary=function(c){var a=new XMLHttpRequest;a.open("GET",c,!1);a.responseType="arraybuffer";a.send(null);
return new Uint8Array(a.response)}),f.readAsync=function(c,a,e){var b=new XMLHttpRequest;b.open("GET",c,!0);b.responseType="arraybuffer";b.onload=function(){200==b.status||0==b.status&&b.response?a(b.response):e()};b.onerror=e;b.send(null)},f.setWindowTitle=function(c){document.title=c};var Nc=f.print||("undefined"!==typeof console?console.log.bind(console):"undefined"!==typeof print?print:null),Ea=f.printErr||("undefined"!==typeof printErr?printErr:"undefined"!==typeof console&&console.warn.bind(console)||
Nc);for(Pa in Nb)Nb.hasOwnProperty(Pa)&&(f[Pa]=Nb[Pa]);Nb=void 0;var of={"f64-rem":function(c,a){return c%a},"debugger":function(){debugger}},db=0;"object"!==typeof WebAssembly&&Ea("no native wasm support detected");var Lc=!1,Hd="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");var Ic,cb,ca,zc=f.TOTAL_MEMORY||471859200;5242880>zc&&Ea("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+zc+"! (TOTAL_STACK=5242880)");if(f.buffer)var ma=
f.buffer;else if("object"===typeof WebAssembly&&"function"===typeof WebAssembly.Memory){var Vb=new WebAssembly.Memory({initial:zc/65536});ma=Vb.buffer}else ma=new ArrayBuffer(zc);Bd();ca[1375280]=10744032;var Rd=[],Mc=[],rf=[],Qd=[],Wb=!1,Ta=0,Jc=null,xb=null;f.preloadedImages={};f.preloadedAudios={};var Na="a.out.wasm";Qb(Na)||(Na=sb(Na));f.asm=function(c,a,e){a.memory=Vb;a.table=new WebAssembly.Table({initial:221,maximum:221,element:"anyfunc"});a.__memory_base=1024;a.__table_base=0;return nf(a)};
var da=[function(c){c!==ce&&(ce=c,document.body.style.cursor='url("'+t.cdn+"cursor"+c+'.gif"),auto')},function(){g("magicworkshopmenu").style.display="block";lb()},function(){re()},function(c,a,e,b,d){c=wa[c];c.style.backgroundPosition=48*d+"px "+48*a+"px";e&&(c.className="");0<b&&(c.innerHTML=b)},function(c){B(c);rc(cd,c);rc(dd,c);rc(ed,c);rc(fd,c)},function(){Ee()},function(){De()},function(){c.bindBuffer(c.ARRAY_BUFFER,ed);c.bufferSubData(c.ARRAY_BUFFER,16*fa[4],ff)},function(){c.bindBuffer(c.ARRAY_BUFFER,
cd);c.bufferSubData(c.ARRAY_BUFFER,12*fa[4],uc)},function(c,a,e){a:{for(var b=0,d=la.length;b<d;b++){var h=la[b];if(h.superID===e){e=h;break a}}e=void 0}c=new Uint32Array(f.HEAPF32.buffer,c,a);e&&e.sendDirectly("channelMessage","nehhof",c)},function(c,a,e,b,d,f,k){$e(c,a,e,b,d,f,k)},function(c,a,e,b,d,f){$e(c,a,e,b,d,f)},function(){Qe()},function(c,a,e){sd(c,0,a,e)},function(c){B(c);t.superID==c?(fb(l.ERR_SERVERKICK),Re()):(c=Ne(c))&&c.end()},function(){H("returnmenu");g("oneplayertbody").innerHTML=
'<tr><td></td><td id="addremove"><button id="addPlayer">+</button><button id="removePlayer">-</button></td><td></td><td></td></tr>';for(var c=0,a=q.nkingdom()-1;c<a;c++)g("oneplayertbody").innerHTML+='<tr><td class="ucolor1"></td><td class="username1"></td><td class="race1"><button></button></td><td class="team1"><button></button></td></tr>';g("addPlayer").onclick=mg;g("removePlayer").onclick=ng},function(c,a,e,b,d){for(b=b.toString(16);6>b.length;)b="0"+b;b="#"+b;We[d].style.background=b;jg[d].innerHTML=
La(ba(c,20));c=lg[d].getElementsByTagName("button")[0];c.iteam=d+1;c.onmousedown=Xe;c.innerHTML=a;a=kg[d].getElementsByTagName("button")[0];a.iteam=d+1;a.onmousedown=Ye;a.innerHTML=Ga[e];e=document.createElement("input");e.type="color";e.iteam=d+1;e.value=b;We[d].appendChild(e);e.onchange=Ze},function(c,a){c&&(Y.leftButton.className="");8*(c+1)<a&&(Y.rightButton.className="")},function(c,a){le(c,a)},function(c,a,e){oa.value=a;oa.max=e;kb.innerHTML=a+"/"+e;oa.style.display="block";g("kingdom").innerHTML=
c+" "+l.SELVIEW_UNITS;Ke()},function(){ad()},function(c,a,e){Ma(c,a,e)},function(c,a,e){ve(c,a,e)},function(c,a,e,b){c==Math.pow(2,31)-1&&(c="***");a==Math.pow(2,31)-1&&(a="***");e==Math.pow(2,31)-1&&(e="***");b==Math.pow(2,31)-1&&(b="***");ee.innerHTML=c;fe.innerHTML=a;ge.innerHTML=e;he.innerHTML=b},function(c,a){g("pop").innerHTML=c+"/"+a},function(c,a,e,b,d,f){var h=g("rndtable"),r=document.createElement("tr");h.appendChild(r);h=document.createElement("td");var n=document.createElement("select"),
m=n;n.innerHTML='<option value="0">'+Ga[0]+'</option><option value="1">'+Ga[1]+'</option><option value="2">'+Ga[2]+'</option><option value="3">'+Ga[3]+"</option>";n.value=c;h.appendChild(n);r.appendChild(h);h=document.createElement("td");n=document.createElement("select");n.innerHTML=Ac[c];n.value=a;n.rndid=f;n.onchange=pg;m.types=n;m.onchange=qg;h.appendChild(n);r.appendChild(h);h=document.createElement("td");n=document.createElement("input");n.value=e;n.onchange=rg;n.type="number";n.rndid=f;h.appendChild(n);
r.appendChild(h);h=document.createElement("td");c=document.createElement("label");c.className="container";a=document.createElement("input");a.type="checkbox";a.rndid=f;a.checked=b;a.onchange=sg;b=document.createElement("span");b.className="checkmark";c.appendChild(a);c.appendChild(b);h.appendChild(c);r.appendChild(h);b="<option value='"+(Math.pow(2,31)-1)+"'>Capturable</option>";h=0;for(c=q.nkingdom();h<c;h++)a=h?La(ba(q.empName(h),17)):l.MISC_NATURE3,b+='<option value="'+h+'">'+a+"</option>";h=document.createElement("td");
n=document.createElement("select");n.innerHTML=b;n.rndid=f;n.value=d;n.onchange=tg;h.appendChild(n);r.appendChild(h);h=document.createElement("td");d=document.createElement("button");d.className="closeIcon";d.onclick=ug;d.rndid=f;h.appendChild(d);r.appendChild(h)},function(c){Ma(c)},function(c,a,e,b,d,f,k,m,n,p,q){k=b;if(g("showGameInfo")){b="<table><tbody>";c==Math.pow(2,31)-1&&(c="***");e==Math.pow(2,31)-1&&(e="***");a==Math.pow(2,31)-1&&(a="***");k==Math.pow(2,31)-1&&(k="***");d=[l.VIEWMSG_GOLD,
c,l.MP_SETUPMAP_T_MAP_SIZE,n,l.VIEWMSG_WOOD,e,l.MP_SETUPMAP_T_TERRAIN,f,l.VIEWMSG_FOOD,a,l.INITIAL_PEASANTS,p,l.VIEWMSG_STONE,k,l.WATER,d,l.FREE_POP,q];f=d.length;for(n=0;n<f;n+=2)n%4||(n&&(b+="</tr>"),b+="<tr>"),b+="<td>"+d[n]+":</td><td>"+d[n+1]+"</td>";b+="</tbody></table>";g("showGameInfo").innerHTML=b}},function(){od()},function(){wc()},function(c){ve(c)},function(c,a,e,b){console.log(c,a,e,b)},function(){fb(55)},function(c,a,e,b,d,f){B(ba(c,20));g("custombody").innerHTML+="<tr>\n<td style='background:rgb("+
b+","+d+","+f+')\' class="ucolor1"></td>\n<td class="username1">'+La(ba(c,20))+'</td>\n<td style="display:none" class="race1">'+e+'</td>\n<td class="team1">'+a+"</td></tr>"},function(){ad()},function(c,a,e,b,d,f,g,m){var h="";f&&(h+="<span>"+l[hb[f]]+"</span>");g&&(h+="<span>"+l[hb[g]]+"</span>");B(m);if(m){h+='<span class="red">'+l.MISC_REQ3+": ";f=xe(q.shapoint(),m);for(g=0;g<m;g++)h+=l[hb[f[g]]],g+1<m&&(h+=", ");h+="</span>"}h+="<span>";c&&(h+=c+"<img class='resource' src='nehhon/gold.gif' /> ");
a&&(h+=a+"<img class='resource' src='nehhon/wood.gif' /> ");e&&(h+=e+"<img class='resource' src='nehhon/food.gif' /> ");b&&(h+=b+"<img class='resource' src='nehhon/stone.gif' /> ");h+="</span>";d&&(h+="<span class='shotcut'>"+String.fromCharCode(d).toUpperCase()+"</span>");Yc.innerHTML=h},function(c,a){He=[c,a]}];Mc.push({func:function(){vg()}});var ua={last:0,caught:[],infos:{},deAdjust:function(c){if(!c||ua.infos[c])return c;for(var a in ua.infos)for(var e=+a,b=ua.infos[e].adjusted,d=b.length,f=
0;f<d;f++)if(b[f]===c)return e;return c},addRef:function(c){c&&ua.infos[c].refcount++},decRef:function(c){if(c){var a=ua.infos[c];sa(0<a.refcount);a.refcount--;0!==a.refcount||a.rethrown||(a.destructor&&f.dynCall_vi(a.destructor,c),delete ua.infos[c],Ld(c))}},clearRef:function(c){c&&(ua.infos[c].refcount=0)}},O={buffers:[null,[],[]],printChar:function(c,a){var e=O.buffers[c];0===a||10===a?((1===c?Nc:Ea)(Ad(e,0)),e.length=0):e.push(a)},varargs:0,get:function(c){O.varargs+=4;return ca[O.varargs-4>>
2]},getStr:function(){var c=O.get();return c?Ad(cb,c,void 0):""},get64:function(){var c=O.get();O.get();return c},getZero:function(){O.get()}};Nd=yc?function(){var c=process.hrtime();return 1E3*c[0]+c[1]/1E6}:"undefined"!==typeof dateNow?dateNow:"object"===typeof performance&&performance&&"function"===typeof performance.now?function(){return performance.now()}:Date.now;var gf=f.asm({},{abort:ta,setTempRet0:function(c){db=c},getTempRet0:function(){return db},__ZSt18uncaught_exceptionv:Kd,___cxa_find_matching_catch:yb,
___cxa_free_exception:Ld,___gxx_personality_v0:function(){},___resumeException:function(c){ua.last||(ua.last=c);throw c;},___setErrNo:function(c){f.___errno_location&&(ca[f.___errno_location()>>2]=c);return c},___syscall140:function(c,a){O.varargs=a;try{return O.getStreamFromFD(),O.get(),O.get(),O.get(),O.get(),0}catch(e){return ta(e),-e.errno}},___syscall146:function(c,a){O.varargs=a;try{var e=O.get(),b=O.get(),d=O.get();for(a=c=0;a<d;a++){for(var f=ca[b+8*a>>2],g=ca[b+(8*a+4)>>2],l=0;l<g;l++)O.printChar(e,
cb[f+l]);c+=g}return c}catch(n){return ta(n),-n.errno}},___syscall54:function(c,a){O.varargs=a;return 0},___syscall6:function(c,a){O.varargs=a;try{return O.getStreamFromFD(),0}catch(e){return ta(e),-e.errno}},_emscripten_asm_const_i:function(c){return da[c]()},_emscripten_asm_const_idd:function(c,a,e){return da[c](a,e)},_emscripten_asm_const_idddd:function(c,a,e,b,d){return da[c](a,e,b,d)},_emscripten_asm_const_ii:function(c,a){return da[c](a)},_emscripten_asm_const_iii:function(c,a,e){return da[c](a,
e)},_emscripten_asm_const_iiii:function(c,a,e,b){return da[c](a,e,b)},_emscripten_asm_const_iiiii:function(c,a,e,b,d){return da[c](a,e,b,d)},_emscripten_asm_const_iiiiii:function(c,a,e,b,d,f){return da[c](a,e,b,d,f)},_emscripten_asm_const_iiiiiii:function(c,a,e,b,d,f,g){return da[c](a,e,b,d,f,g)},_emscripten_asm_const_iiiiiiii:function(c,a,e,b,d,f,g,l){return da[c](a,e,b,d,f,g,l)},_emscripten_asm_const_iiiiiiiii:function(c,a,e,b,d,f,g,l,n){return da[c](a,e,b,d,f,g,l,n)},_emscripten_asm_const_iiiiiiiiiiii:function(c,
a,e,b,d,f,g,l,n,m,p,q){return da[c](a,e,b,d,f,g,l,n,m,p,q)},_emscripten_get_heap_size:Md,_emscripten_get_now:Nd,_emscripten_memcpy_big:function(c,a,e){cb.set(cb.subarray(a,a+e),c)},_emscripten_resize_heap:function(c){var a=Md();if(2147418112<c)return!1;for(a=Math.max(a,16777216);a<c;)a=536870912>=a?Ec(2*a,65536):Math.min(Ec((3*a+2147483648)/4,65536),2147418112);if(!Od(a))return!1;Bd();return!0},abortOnCannotGrowMemory:function(c){ta("OOM")},emscripten_realloc_buffer:Od,flush_NO_FILESYSTEM:function(){var c=
f._fflush;c&&c(0);c=O.buffers;c[1].length&&O.printChar(1,10);c[2].length&&O.printChar(2,10)},tempDoublePtr:5501136,DYNAMICTOP_PTR:5501120},ma);f.asm=gf;var vg=f.__GLOBAL__sub_I_nh_cpp=function(){return f.asm.__GLOBAL__sub_I_nh_cpp.apply(null,arguments)};f.__Z10Uint8Arrayj=function(){return f.asm.__Z10Uint8Arrayj.apply(null,arguments)};f.__Z10canvasSizejj=function(){return f.asm.__Z10canvasSizejj.apply(null,arguments)};f.__Z10changePagei=function(){return f.asm.__Z10changePagei.apply(null,arguments)};
f.__Z10changeRaceji=function(){return f.asm.__Z10changeRaceji.apply(null,arguments)};f.__Z10changeTeamji=function(){return f.asm.__Z10changeTeamji.apply(null,arguments)};f.__Z10checkStockv=function(){return f.asm.__Z10checkStockv.apply(null,arguments)};f.__Z10gInventoryj=function(){return f.asm.__Z10gInventoryj.apply(null,arguments)};f.__Z10gmaxHealthj=function(){return f.asm.__Z10gmaxHealthj.apply(null,arguments)};f.__Z10mouseEnterj=function(){return f.asm.__Z10mouseEnterj.apply(null,arguments)};
f.__Z10movtablexev=function(){return f.asm.__Z10movtablexev.apply(null,arguments)};f.__Z10nameSharedPjS_j=function(){return f.asm.__Z10nameSharedPjS_j.apply(null,arguments)};f.__Z10pidkingdomj=function(){return f.asm.__Z10pidkingdomj.apply(null,arguments)};f.__Z10searchUnitth=function(){return f.asm.__Z10searchUnitth.apply(null,arguments)};f.__Z10setupOnlIDj=function(){return f.asm.__Z10setupOnlIDj.apply(null,arguments)};f.__Z10shiftONOFFb=function(){return f.asm.__Z10shiftONOFFb.apply(null,arguments)};
f.__Z10tempstraddv=function(){return f.asm.__Z10tempstraddv.apply(null,arguments)};f.__Z10touchStartjj=function(){return f.asm.__Z10touchStartjj.apply(null,arguments)};f.__Z10unitActionj=function(){return f.asm.__Z10unitActionj.apply(null,arguments)};f.__Z10userConfigj=function(){return f.asm.__Z10userConfigj.apply(null,arguments)};f.__Z11Uint16Arrayj=function(){return f.asm.__Z11Uint16Arrayj.apply(null,arguments)};f.__Z11Uint32Arrayt=function(){return f.asm.__Z11Uint32Arrayt.apply(null,arguments)};
f.__Z11changeColorjj=function(){return f.asm.__Z11changeColorjj.apply(null,arguments)};f.__Z11createItemsv=function(){return f.asm.__Z11createItemsv.apply(null,arguments)};f.__Z11getBufferIDv=function(){return f.asm.__Z11getBufferIDv.apply(null,arguments)};f.__Z11movtableADDjjjj=function(){return f.asm.__Z11movtableADDjjjj.apply(null,arguments)};f.__Z11setupRandomi=function(){return f.asm.__Z11setupRandomi.apply(null,arguments)};f.__Z11showrndobjsv=function(){return f.asm.__Z11showrndobjsv.apply(null,
arguments)};f.__Z11synchroHashv=function(){return f.asm.__Z11synchroHashv.apply(null,arguments)};f.__Z12bufferMarginfffj=function(){return f.asm.__Z12bufferMarginfffj.apply(null,arguments)};f.__Z12deletePlayerj=function(){return f.asm.__Z12deletePlayerj.apply(null,arguments)};f.__Z12executeOrderjj=function(){return f.asm.__Z12executeOrderjj.apply(null,arguments)};f.__Z12setupIMGinfojjjjjjjjjjjjjjjjjjj=function(){return f.asm.__Z12setupIMGinfojjjjjjjjjjjjjjjjjjj.apply(null,arguments)};f.__Z12setupKingdomjjjjhbjjj=
function(){return f.asm.__Z12setupKingdomjjjjhbjjj.apply(null,arguments)};f.__Z12unitObjetivej=function(){return f.asm.__Z12unitObjetivej.apply(null,arguments)};f.__Z13configTerrainv=function(){return f.asm.__Z13configTerrainv.apply(null,arguments)};f.__Z13randomTerraini=function(){return f.asm.__Z13randomTerraini.apply(null,arguments)};f.__Z13readSavegame0j=function(){return f.asm.__Z13readSavegame0j.apply(null,arguments)};f.__Z13setupOnlTablej=function(){return f.asm.__Z13setupOnlTablej.apply(null,
arguments)};f.__Z13sharedDelayIDv=function(){return f.asm.__Z13sharedDelayIDv.apply(null,arguments)};f.__Z13sharedFloatIDv=function(){return f.asm.__Z13sharedFloatIDv.apply(null,arguments)};f.__Z13startMovementv=function(){return f.asm.__Z13startMovementv.apply(null,arguments)};f.__Z13tempointeraddj=function(){return f.asm.__Z13tempointeraddj.apply(null,arguments)};f.__Z13updateRNDtypejj=function(){return f.asm.__Z13updateRNDtypejj.apply(null,arguments)};f.__Z14customMapTablev=function(){return f.asm.__Z14customMapTablev.apply(null,
arguments)};f.__Z14finishSavegamev=function(){return f.asm.__Z14finishSavegamev.apply(null,arguments)};f.__Z14onlineKingdomsv=function(){return f.asm.__Z14onlineKingdomsv.apply(null,arguments)};f.__Z14randomKingdomsi=function(){return f.asm.__Z14randomKingdomsi.apply(null,arguments)};f.__Z14setupResourcesjjjjt=function(){return f.asm.__Z14setupResourcesjjjjt.apply(null,arguments)};f.__Z15configRandomMapv=function(){return f.asm.__Z15configRandomMapv.apply(null,arguments)};f.__Z15getColorTexturev=
function(){return f.asm.__Z15getColorTexturev.apply(null,arguments)};f.__Z15setupOnlineGamePjS_j=function(){return f.asm.__Z15setupOnlineGamePjS_j.apply(null,arguments)};f.__Z15updateRNDnumberjj=function(){return f.asm.__Z15updateRNDnumberjj.apply(null,arguments)};f.__Z16setupTranslationjj=function(){return f.asm.__Z16setupTranslationjj.apply(null,arguments)};f.__Z16updateRNDeach256jj=function(){return f.asm.__Z16updateRNDeach256jj.apply(null,arguments)};f.__Z16updateRNDkingdomjj=function(){return f.asm.__Z16updateRNDkingdomjj.apply(null,
arguments)};f.__Z3rndi=function(){return f.asm.__Z3rndi.apply(null,arguments)};f.__Z4nAIsv=function(){return f.asm.__Z4nAIsv.apply(null,arguments)};f.__Z4testjj=function(){return f.asm.__Z4testjj.apply(null,arguments)};f.__Z5empXYv=function(){return f.asm.__Z5empXYv.apply(null,arguments)};f.__Z5gCvalj=function(){return f.asm.__Z5gCvalj.apply(null,arguments)};f.__Z5gItemj=function(){return f.asm.__Z5gItemj.apply(null,arguments)};f.__Z5gManaj=function(){return f.asm.__Z5gManaj.apply(null,arguments)};
f.__Z5gNamej=function(){return f.asm.__Z5gNamej.apply(null,arguments)};f.__Z5gTypej=function(){return f.asm.__Z5gTypej.apply(null,arguments)};f.__Z5nhlenv=function(){return f.asm.__Z5nhlenv.apply(null,arguments)};f.__Z5test2jj=function(){return f.asm.__Z5test2jj.apply(null,arguments)};f.__Z5test3jj=function(){return f.asm.__Z5test3jj.apply(null,arguments)};f.__Z6amountv=function(){return f.asm.__Z6amountv.apply(null,arguments)};f.__Z6dbgspdj=function(){return f.asm.__Z6dbgspdj.apply(null,arguments)};
f.__Z6gBuildj=function(){return f.asm.__Z6gBuildj.apply(null,arguments)};f.__Z6gcyclev=function(){return f.asm.__Z6gcyclev.apply(null,arguments)};f.__Z6giTypej=function(){return f.asm.__Z6giTypej.apply(null,arguments)};f.__Z6glevelj=function(){return f.asm.__Z6glevelj.apply(null,arguments)};f.__Z6mapLocv=function(){return f.asm.__Z6mapLocv.apply(null,arguments)};f.__Z6mwMorei=function(){return f.asm.__Z6mwMorei.apply(null,arguments)};f.__Z6mwiconv=function(){return f.asm.__Z6mwiconv.apply(null,arguments)};
f.__Z6nfolenv=function(){return f.asm.__Z6nfolenv.apply(null,arguments)};f.__Z6nhcompv=function(){return f.asm.__Z6nhcompv.apply(null,arguments)};f.__Z6onlADDjjjjb=function(){return f.asm.__Z6onlADDjjjjb.apply(null,arguments)};f.__Z6prelddv=function(){return f.asm.__Z6prelddv.apply(null,arguments)};f.__Z6rdnh19mmmmmmjj=function(){return f.asm.__Z6rdnh19mmmmmmjj.apply(null,arguments)};f.__Z6runKeyjb=function(){return f.asm.__Z6runKeyjb.apply(null,arguments)};f.__Z6sndNfov=function(){return f.asm.__Z6sndNfov.apply(null,
arguments)};f.__Z6strOnlv=function(){return f.asm.__Z6strOnlv.apply(null,arguments)};f.__Z6trraddv=function(){return f.asm.__Z6trraddv.apply(null,arguments)};f.__Z6unitXFj=function(){return f.asm.__Z6unitXFj.apply(null,arguments)};f.__Z6unitYFj=function(){return f.asm.__Z6unitYFj.apply(null,arguments)};f.__Z6updownji=function(){return f.asm.__Z6updownji.apply(null,arguments)};f.__Z7crtStxtm=function(){return f.asm.__Z7crtStxtm.apply(null,arguments)};f.__Z7delTexsv=function(){return f.asm.__Z7delTexsv.apply(null,
arguments)};f.__Z7empNamej=function(){return f.asm.__Z7empNamej.apply(null,arguments)};f.__Z7gAttackj=function(){return f.asm.__Z7gAttackj.apply(null,arguments)};f.__Z7gHelperj=function(){return f.asm.__Z7gHelperj.apply(null,arguments)};f.__Z7gIconIDj=function(){return f.asm.__Z7gIconIDj.apply(null,arguments)};f.__Z7getPagev=function(){return f.asm.__Z7getPagev.apply(null,arguments)};f.__Z7ghealthj=function(){return f.asm.__Z7ghealthj.apply(null,arguments)};f.__Z7mouseUpiijb=function(){return f.asm.__Z7mouseUpiijb.apply(null,
arguments)};f.__Z7nh19addj=function(){return f.asm.__Z7nh19addj.apply(null,arguments)};f.__Z7onldataj=function(){return f.asm.__Z7onldataj.apply(null,arguments)};f.__Z7plreadyv=function(){return f.asm.__Z7plreadyv.apply(null,arguments)};f.__Z7readSVGmmb=function(){return f.asm.__Z7readSVGmmb.apply(null,arguments)};f.__Z7setupGLv=function(){return f.asm.__Z7setupGLv.apply(null,arguments)};f.__Z8atlasLocv=function(){return f.asm.__Z8atlasLocv.apply(null,arguments)};f.__Z8gControlj=function(){return f.asm.__Z8gControlj.apply(null,
arguments)};f.__Z8gDefencej=function(){return f.asm.__Z8gDefencej.apply(null,arguments)};f.__Z8gKingdomj=function(){return f.asm.__Z8gKingdomj.apply(null,arguments)};f.__Z8gManaMaxj=function(){return f.asm.__Z8gManaMaxj.apply(null,arguments)};f.__Z8gstartedv=function(){return f.asm.__Z8gstartedv.apply(null,arguments)};f.__Z8liveChatj=function(){return f.asm.__Z8liveChatj.apply(null,arguments)};f.__Z8mapWidthv=function(){return f.asm.__Z8mapWidthv.apply(null,arguments)};f.__Z8mnameaddv=function(){return f.asm.__Z8mnameaddv.apply(null,
arguments)};f.__Z8mwSelectj=function(){return f.asm.__Z8mwSelectj.apply(null,arguments)};f.__Z8mwamounti=function(){return f.asm.__Z8mwamounti.apply(null,arguments)};f.__Z8nkingdomv=function(){return f.asm.__Z8nkingdomv.apply(null,arguments)};f.__Z8onlCountv=function(){return f.asm.__Z8onlCountv.apply(null,arguments)};f.__Z8savegamev=function(){return f.asm.__Z8savegamev.apply(null,arguments)};f.__Z8shapointv=function(){return f.asm.__Z8shapointv.apply(null,arguments)};f.__Z8touchEndjj=function(){return f.asm.__Z8touchEndjj.apply(null,
arguments)};f.__Z8userKickj=function(){return f.asm.__Z8userKickj.apply(null,arguments)};f.__Z9RNDdeletej=function(){return f.asm.__Z9RNDdeletej.apply(null,arguments)};f.__Z9addRNDobjv=function(){return f.asm.__Z9addRNDobjv.apply(null,arguments)};f.__Z9boolArrayt=function(){return f.asm.__Z9boolArrayt.apply(null,arguments)};f.__Z9closeRoomv=function(){return f.asm.__Z9closeRoomv.apply(null,arguments)};f.__Z9createMapi=function(){return f.asm.__Z9createMapi.apply(null,arguments)};f.__Z9ginfonamejj=
function(){return f.asm.__Z9ginfonamejj.apply(null,arguments)};f.__Z9mouseDowniij=function(){return f.asm.__Z9mouseDowniij.apply(null,arguments)};f.__Z9mouseMoveii=function(){return f.asm.__Z9mouseMoveii.apply(null,arguments)};f.__Z9onLimits2ii=function(){return f.asm.__Z9onLimits2ii.apply(null,arguments)};f.__Z9randomMapv=function(){return f.asm.__Z9randomMapv.apply(null,arguments)};f.__Z9setupGamejjjjjjjjjjjjj=function(){return f.asm.__Z9setupGamejjjjjjjjjjjjj.apply(null,arguments)};f.__Z9setupInfojjjjjjjjjjcchhhhhhbbPjhbPbS_hthS_hth=
function(){return f.asm.__Z9setupInfojjjjjjjjjjcchhhhhhbbPjhbPbS_hthS_hth.apply(null,arguments)};f.__Z9setupOdinj=function(){return f.asm.__Z9setupOdinj.apply(null,arguments)};f.__Z9setupZoomf=function(){return f.asm.__Z9setupZoomf.apply(null,arguments)};f.__Z9shareNamej=function(){return f.asm.__Z9shareNamej.apply(null,arguments)};f.__Z9touchMovejj=function(){return f.asm.__Z9touchMovejj.apply(null,arguments)};f.___errno_location=function(){return f.asm.___errno_location.apply(null,arguments)};f._emscripten_replace_memory=
function(){return f.asm._emscripten_replace_memory.apply(null,arguments)};var pf=f._free=function(){return f.asm._free.apply(null,arguments)};f._llvm_bswap_i32=function(){return f.asm._llvm_bswap_i32.apply(null,arguments)};f._main=function(){return f.asm._main.apply(null,arguments)};var qf=f._malloc=function(){return f.asm._malloc.apply(null,arguments)};f._memcpy=function(){return f.asm._memcpy.apply(null,arguments)};f._memset=function(){return f.asm._memset.apply(null,arguments)};f._sbrk=function(){return f.asm._sbrk.apply(null,
arguments)};f.establishStackSpace=function(){return f.asm.establishStackSpace.apply(null,arguments)};var Id=f.stackAlloc=function(){return f.asm.stackAlloc.apply(null,arguments)};f.stackRestore=function(){return f.asm.stackRestore.apply(null,arguments)};f.stackSave=function(){return f.asm.stackSave.apply(null,arguments)};f.dynCall_ii=function(){return f.asm.dynCall_ii.apply(null,arguments)};f.dynCall_iidiiii=function(){return f.asm.dynCall_iidiiii.apply(null,arguments)};f.dynCall_iii=function(){return f.asm.dynCall_iii.apply(null,
arguments)};f.dynCall_iiii=function(){return f.asm.dynCall_iiii.apply(null,arguments)};f.dynCall_iiiii=function(){return f.asm.dynCall_iiiii.apply(null,arguments)};f.dynCall_jiji=function(){return f.asm.dynCall_jiji.apply(null,arguments)};f.dynCall_v=function(){return f.asm.dynCall_v.apply(null,arguments)};f.dynCall_vi=function(){return f.asm.dynCall_vi.apply(null,arguments)};f.dynCall_vii=function(){return f.asm.dynCall_vii.apply(null,arguments)};f.dynCall_viii=function(){return f.asm.dynCall_viii.apply(null,
arguments)};f.asm=gf;eb.prototype=Error();eb.prototype.constructor=eb;xb=function a(){f.calledRun||Kc();f.calledRun||(xb=a)};f.callMain=function(a){a=a||[];Wb||(Wb=!0,tb(Mc));var c=a.length+1,b=Id(4*(c+1));ca[b>>2]=Cd(f.thisProgram);for(var d=1;d<c;d++)ca[(b>>2)+d]=Cd(a[d-1]);ca[(b>>2)+c]=0;try{var h=f._main(c,b,0);if(!f.noExitRuntime||0!==h){if(!f.noExitRuntime&&(Lc=!0,f.onExit))f.onExit(h);f.quit(h,new eb(h))}}catch(k){k instanceof eb||("SimulateInfiniteLoop"==k?f.noExitRuntime=!0:((a=k)&&"object"===
typeof k&&k.stack&&(a=[k,k.stack]),Ea("exception thrown: "+a),f.quit(1,k)))}finally{}};f.run=Kc;f.abort=ta;if(f.preInit)for("function"==typeof f.preInit&&(f.preInit=[f.preInit]);0<f.preInit.length;)f.preInit.pop()();var Pd=!0;f.noInitialRun&&(Pd=!1);f.noExitRuntime=!0;Kc();var Gc=!1,q={};Ub=Wa;var l,rd,uc,ff,fa,wd=function(){Gc=!0;for(var a=f.asm,e=Object.keys(a),b=e.length,d="inspector71017 newUnit radar createMap falseunit synchroHash rnd setupRandom randomTerrain unitMovement test setupInfo setupKingdom shapoint Uint16Array setupTech setupRequirements boolArray AIobjetive test2 searchUnit killUnit investigateTech AIprocess setupResources unitWorking movtablexe test3 unitParameter setupGL bufferColor getBufferID setupIMGinfo atlasLoc randomMap gAttack gDefence glevel ghealth gmaxHealth gMana gItem gBuild gKingdom executeOrder shiftONOFF gType IMGdata Uint32Array getColorTexture canvasSize setupZoom setupTranslation mouseDown mouseUp sharedFloatID setupGame mouseMove gCval gManaMax giType setupOdin empXY nkingdom empName changePage gInventory gControl checkStock runKey sharedDelayID amount mwicon mwSelect mwMore mwamount createItems gIconID mouseEnter gHelper startMovement savegame finishSavegame readSavegame0 readSVG customMapTable mapWidth gcycle dbgspd randomKingdoms changeTeam changeRace userConfig onlineKingdoms setupOnlTable onlADD changeColor sndNfo tempointeradd onldata shareName mnameadd configRandomMap strOnl plready setupOnlID preldd nAIs closeRoom onlCount userKick pidkingdom deletePlayer updown tempstradd liveChat gstarted trradd nh19add nhcomp nhlen rdnh19 crtStxt configTerrain delTexs gName touchStart touchMove touchEnd showrndobjs ginfoname nfolen updateRNDtype updateRNDkingdom updateRNDnumber updateRNDeach256 addRNDobj RNDdelete".split(" "),
h=0,k=d.length;h<k;h++)for(var l=d[h],m=0;m<b;m++){var p=e[m];if(-1<p.indexOf(l)){q[d[h]]=a[p];break}}rd=xe(q.shapoint(),1024);fa=gb(q.sharedFloatID(),5);uc=gb(q.sharedFloatID(),3);ff=gb(q.sharedFloatID(),4);Ra(q.userConfig(Tb()),17,t.name||"Guest");a={antialias:!1,desynchronized:!0};localStorage.webgl&&"2"!=localStorage.webgl||(c=g("tzar").getContext("webgl2",a));c||(c=g("tzar").getContext("webgl",a),S=!0);t.gl=c;wd.waiting&&wc();Ub()},Ra=function(a,c,b){a=ba(a,c);for(var d=0;d<c;d++)a[d]=b.charCodeAt(d)};
wd.waiting=!1;f.postRun[0]=wd;var Bc=window.indexedDB.open("nh2019",t.versionInt),V;Bc.onsuccess=function(a){V=Bc.result;Rc("basic",function(a){a=a.target.result;for(var b=Vd(),c=0;c<b.length;c++)if(-1===a.indexOf(t.cdn+b[c])){a=document.createElement("li");g("topLinks").appendChild(a);l&&(a.innerHTML=l.SAVE_GAME_CONTENT);a.onclick=Wd;a.id="savelocal";break}})};Bc.onupgradeneeded=function(a){V=Bc.result;B(V);V.objectStoreNames.contains("basic")&&V.deleteObjectStore("basic");V.objectStoreNames.contains("maps")||
V.createObjectStore("maps",{keyPath:"id",autoIncrement:!0});V.objectStoreNames.contains("mapsBlobs")||V.createObjectStore("mapsBlobs",{keyPath:"id2",autoIncrement:!0});V.objectStoreNames.contains("basic")||V.createObjectStore("basic",{keyPath:"url"})};var Ud=function(a){V&&(V.transaction(["basic"],"readwrite").objectStore("basic").add(a).onsuccess=function(){})},dg=function(a,c){var b=V.transaction(["maps"],"readwrite");b.objectStore("maps").add(a).onsuccess=function(){B("done")};b=V.transaction(["mapsBlobs"],
"readwrite");b.objectStore("mapsBlobs").add(c).onsuccess=function(){B("done")}},Rc=function(a,c){if(V){var b=V.transaction([a],"readonly");if(b.objectStore(a).getAllKeys)a=b.objectStore(a).getAllKeys();else return c({target:{result:[]}});a.onsuccess=c}else c({target:{result:[]}})},og=function(a,c,b){V.transaction([a],"readonly").objectStore(a).get(b).onsuccess=function(a){c(a.target.result.buffer)}},wg=function(a){a=a.target.result;var c=a.length;if(c){var b=g("mapcache");b.innerHTML='<tr style="font-size:23px"><td>Name</td><td>Date</td><td>'+
l.PLAYED_TIME+"</td></tr>";for(--c;-1<c;c--){var d=a[c],f=document.createElement("tr");f.cid=d.id;var k=new Date(d.date),m=k.getHours(),n="0"+k.getMinutes();k.getSeconds();var p=k.getDate(),q=k.getMonth()+1;k=k.getFullYear();m=m+":"+n.substr(-2)+" &nbsp; &nbsp;"+p+"/"+q+"/"+k;f.onclick=xd;f.innerHTML="<td>"+(d.name||"savegame")+"</td><td>"+m+"</td><td>"+$d(d.played)+"</td>";b.appendChild(f)}B(a)}},xd=function(){var a=this.cid;V.transaction(["mapsBlobs"],"readwrite").objectStore("mapsBlobs").get(a).onsuccess=
xd.step2};xd.step2=function(a){a=a.target.result;var c=new FileReader;c.onload=bf;c.readAsArrayBuffer(a)};var A=function(a){g(a).style.display="none"},H=function(a){g(a).style.display="block"},qe=function(a){p.editor&&(a=parseInt(g("brushSize").value)+a,a>g("brushSize").max?g("brushSize").value=g("brushSize").max:1>a?g("brushSize").value=1:g("brushSize").value=a)},je=function(){B(this);this.parentElement.parentElement.style.display="none";ha()},ke={objAction:{id:"edobjAction",msg:"",func:function(){M.active.type=
"attack";H("selectionEvents");A("eventZone");H("unitListDiv2");g("byButton2").style.display="inline-block";g("byButton1").style.display="inline-block";M.active.zone=void 0}},objZone:{id:"edobjAction",msg:0,func:function(){M.active.type="zone";M.active.to.length=0;A("selectionEvents");g("eventZone").style.display="inline-block";A("byButton2");A("byButton1");A("unitListDiv2");hf()}}},ic=function(a){if(a)A("mapRulesWindow"),ha(),ic.actived=!0;else if(ic.actived){H("mapRulesWindow");Qa();a=~~((void 0)[0]/
32);var c=~~((void 0)[1]/32),b=~~((void 0)[9]/32),d=~~((void 0)[10]/32);if(a<b)var f=a,g=b;else f=b,g=a;if(c<d)var l=c,m=d;else l=d,m=c;M.active.zone||(M.active.zone=[]);M.active.zone.put([f,l,g,m]);B(a,c,b,d);hf();ic.actived=!1}},hf=function(){var a=g("zoneList");a.innerHTML="";var c=M.active.zone;if(c)for(var b=c.length,d=0;d<b;d++){var f=c[d],k=document.createElement("div"),l=document.createElement("button");l.innerHTML="x";l.obj=f;l.pObj=c;l.spObj=!0;l.onclick=yd;k.innerHTML=f[0]+"x "+f[1]+"y -> "+
f[2]+"x "+f[3]+"y";k.appendChild(l);a.appendChild(k)}},jf={moving:1},Qf=function(){jf[this.value]?(A("byButton2"),A("byButton1"),A("unitListDiv2")):(H("unitListDiv2"),g("byButton2").style.display="inline-block",g("byButton1").style.display="inline-block");M.active.type=this.value},Rf=function(){jf[this.value]?(A("toButton2"),A("toButton1"),A("unitListDivAction2")):(H("unitListDivAction2"),g("toButton2").style.display="inline-block",g("toButton1").style.display="inline-block");ea.active.type=this.value},
qa=function(a){if(a)A("mapRulesWindow"),ha(),qa.actived=a.button;else if(qa.actived){H("mapRulesWindow");Qa();a=qa.actived.spType.active;a="unitListDiv2"==qa.actived.id||"unitListDivAction2"==qa.actived.id?a.to:a.list;for(var c={},b=0,d=a.length;b<d;b++)c[a[b]]=1;b=0;for(d=Fb.length;b<d;b++)c[Fb[b]]||a.put(Fb[b]);Ob(qa.actived,a);qa.actived=!1}},Ob=function(a,c){a.innerHTML="";for(var b=0,d=c.length;b<d;b++){var e=document.createElement("div"),f=document.createElement("button");f.onclick=yd;f.innerHTML=
"x";f.pObj=c;f.spObj=!0;f.obj=c[b];e.appendChild(f);a.appendChild(e)}},ja=function(){ja.active&&(ja.active.className="");ja.active=this;this.className="spSelect";for(var a=this.parentElement.getElementsByTagName("section"),c=0,b=a.length;c<b;c++)a[c].style.display="none";this.sdiv.style.display="block"},ia=function(){var a=this.editorRule;a.deleted||(H("mapEvent"),H("mapActions"),A("eventOptions"),ia.active&&(ia.div.className=""),this.className="spSelect",ia.active=a,ia.div=this,hc(a,"eventLayout"),
hc(a,"actionLayout"),M.div&&A(M.div),M.div1=void 0)},M=function(){var a=this.editorRule;a.deleted||(H("eventOptions"),M.div1&&(M.div1.className=""),this.className="spSelect",M.active=a,g("selectionEvents").value=a.type,M.div1=this,g("eventOptions").value=a.name,M.div=ke[a.name].id,H(M.div),Ob(g("unitListDiv"),a.list),Ob(g("unitListDiv2"),a.to))},ea=function(){var a=this.editorRule;a.deleted||(H("actionOptions"),ea.div1&&(ea.div1.className=""),this.className="spSelect",ea.active=a,g("selectionActions").value=
a.type,ea.div1=this,g("actionOptions").value=a.name,ea.div="ed"+a.name,H(ea.div),Ob(g("unitListDivAction"),a.list),Ob(g("unitListDivAction2"),a.to))},hc=function(a,c){g(c).innerHTML="";if("eventLayout"==c){a=a.events;var b=M,d=ia.active.events}else a=a.actions,b=ea,d=ia.active.actions;for(var e=0,f=a.length;e<f;e++){var l=document.createElement("div");Cc(l,a[e],b,d);g(c).appendChild(l)}},Of=function(){var a=ia.active,c={name:"objAction",list:[],to:[],type:"attack"};a.events.put(c);var b=document.createElement("div");
Cc(b,c,M,a.events);g("eventLayout").appendChild(b);if(M.div1)M.div1.onclick()},Pf=function(){var a=ia.active,c={name:"objOrder",list:[],to:[],type:"move"};a.actions.put(c);var b=document.createElement("div");Cc(b,c,ea,a.actions);g("actionLayout").appendChild(b);if(ea.div1)ea.div1.onclick()},Cc=function(a,c,b,d){a.innerHTML=c.events?c.name:l[c.name];a.onclick=b;a.editorRule=c;b=document.createElement("button");b.innerHTML="x";b.obj=c;b.pObj=d;b.onclick=yd;a.appendChild(b)},Nf=function(){p.rules||(p.rules=
[]);var a={name:"Rule"+p.rules.length,events:[],actions:[]};p.rules.put(a);var c=document.createElement("div");Cc(c,a,ia,p.rules);g("rulist").appendChild(c)},yd=function(){this.pObj.quit(this.obj);this.obj.deleted=!0;this.parentElement.parentElement.removeChild(this.parentElement);if(!this.spObj)if(this.pObj!==p.rules)ia.div.onclick();else A("mapEvent"),A("mapActions")},gc=function(){},Hf=function(){},If=function(){},Jf=function(){},Kf=function(){},Lf=function(){},Mf=function(){},qg=function(){this.types.innerHTML=
Ac[this.value];this.types.value=""},pg=function(){q.updateRNDtype(this.rndid,this.value)},tg=function(){q.updateRNDkingdom(this.rndid,this.value)},rg=function(){q.updateRNDnumber(this.rndid,this.value)},sg=function(){q.updateRNDeach256(this.rndid,this.checked)},ug=function(){q.RNDdelete(this.rndid);zd()},xg=function(){q.addRNDobj();zd()},zd=function(){g("rndtable").innerHTML='<tr style="height: 57px"><td>Type</td><td>Object</td><td>Amount</td><td>Each 256\u00b2</td><td>'+l.MISC_KINGDOM3+"</td><td></td></tr>";
q.showrndobjs();var a=document.createElement("tr"),c=document.createElement("td"),b=document.createElement("button");b.innerHTML=l.ADD;b.onclick=xg;c.appendChild(b);a.appendChild(c);g("rndtable").appendChild(a)},Dc=function(){var a=parseInt(this.min),c=parseInt(this.max),b=parseInt(this.value);b>c?this.value=this.max:b<a&&(this.value=this.min)},Ac,Se=function(){g("mapconfiguration")||Sb("mapconfiguration");g("mapconfiguration").style.display="block";g("basic").style.filter="blur(94px)";if(""==g("mapconfiguration").innerHTML){Ac=
["","","",""];for(var a=0;4>a;a++){for(var c="",b=0,d=q.nfolen();b<d;b++){var f=q.ginfoname(b,a);f&&(c+='<option value="'+b+'">'+l[hb[f]].toUpperCase()+"</option>")}Ac[a]=c}a="";c=["grass","trenkorian"];b=0;for(d=c.length;b<d;b++)a+='<option value="'+c[b]+'" '+(c[b]==localStorage.terrain?"selected":"")+">"+(l[c[b]]||c[b])+"</option>";b="";"true"==localStorage.infinity&&(b="checked");g("mapconfiguration").innerHTML='<div><button id="closeButton1" class="closeIcon"></button><table>\n<tbody>\n<tr><td>'+
l.MP_SETUPMAP_T_MAP_SIZE+'</td><td><input id="mapwidth" type="number" value="'+localStorage.mapx+'" step="32" min="32" max="1024" /></td></tr>\n<tr><td><hr></td></tr>\n<tr><td>'+l.MP_SETUPMAP_T_ST_RES+"</td></tr>\n<tr><td><hr></td></tr>\n<tr><td>"+l.MISC_INF3+'</td><td><label class="container">\n  <input id="infiniteValue" type="checkbox" '+b+'>\n  <span class="checkmark"></span>\n</label></td></tr>\n<tr><td>'+l.VIEWMSG_GOLD+'</td><td><input id="goldValue" type="number" value="'+localStorage.goldRes+
'" step="250"/></td></tr>\n<tr><td>'+l.VIEWMSG_WOOD+'</td><td><input id="woodValue" type="number" value="'+localStorage.woodRes+'" step="250"/></td></tr>\n<tr><td>'+l.VIEWMSG_FOOD+'</td><td><input id="foodValue" type="number" value="'+localStorage.foodRes+'" step="250"/></td></tr>\n<tr><td>'+l.VIEWMSG_STONE+'</td><td><input id="stoneValue" type="number" value="'+localStorage.stoneRes+'" step="250"/></td></tr>\n<tr><td><hr></td></tr>\n<tr><td>'+l.MP_SETUPMAP_T_TERRAIN+'</td></tr>\n<tr><td><select name="terrain" id="terrainSelect">\n'+
a+"\n<tr><td>"+l.WATER+'</td><td><input type="number" value="'+localStorage.water+'" id="waterValue" min="0"/></td></tr>\n<tr><td>'+l.INITIAL_PEASANTS+'</td><td><input type="number" value="'+localStorage.peons+'" id="peonValue" min="0"/></td></tr>\n<tr><td>'+l.FREE_POP+'</td><td><input type="number" value="'+localStorage.freePop+'" id="freePopValue" min="0" /></td></tr>\n<tr><td>'+l.SP_SETUPMAP_T_POPLIMIT+'</td><td><input type="number" value="'+localStorage.maxPop+'" id="maxPopValue" min="100" max="500" /></td></tr>\n</select>\n</td>\n</tr>\n</tbody>\n</table>\n<hr style="margin: 25px">\n<table>\n<tbody id="rndtable">\n</tbody>\n</div>';
zd();g("maxPopValue").oninput=Dc;g("waterValue").oninput=Dc;g("peonValue").oninput=Dc;g("freePopValue").oninput=Dc;g("infiniteValue").onchange=function(){var a=this.checked;g("goldValue").disabled=a;g("stoneValue").disabled=a;g("woodValue").disabled=a;g("foodValue").disabled=a};g("infiniteValue").onchange();g("closeButton1").onclick=function(){p.online&&bb();g("mapconfiguration").style.display="none";ha()}}};g("returnmenu").onclick=Va;var yg=function(){B(this,this.checked);localStorage[this.localProp]=
this.checked},kf=function(){var a=this.value;"color"==this.type?this.style.backgroundColor=a:"name"==this.localProp&&(a=ab(a));t[this.localProp]=a;localStorage[this.localProp]=a},Hc={Multiplayer:R,RandomMap:af,MapEditor:function(){},CustomMap:function(){""==g("CustomMap").innerHTML&&(g("CustomMap").innerHTML="<h2>"+l.SINGLESCR_LOAD.split("| ")[0]+'</h2>\n<input id="mapload" type="file" />\n<label for="mapload" id="maploadlabel">Choose a file</label>\n<table id="mapcache"></table>\n<div id="customMapcont" style="display:none">\n<table class="players" id="customaptable">\n<tbody id="custombody">\n</tbody>\n</table>\n<button style="margin-left:40px" id="startCustom" class="start startButton">'+
l.MP_MPLAYER_PLAY+'</button>\n\n<button style="margin-left:40px" id="closeCustom" class="start">'+l.GENERAL_CLOSE+"</button>\n</div>",g("closeCustom").onclick=function(){A("customMapcont");g("maploadlabel").style.display="inline-block";g("mapcache").style.display="table"},g("startCustom").onclick=function(){A("customMapcont");g("closeCustom").onclick();wc()},g("mapload").accept=".tzared",g("mapload").onchange=function(a){a=g("mapload").files[0];B(a);a.name.split(".");var c=new FileReader;c.onload=
bf;c.readAsArrayBuffer(a)});H("returnmenu");V&&(V.transaction(["maps"],"readwrite").objectStore("maps").getAll().onsuccess=wg)},Settings:function(){var a=g("Settings");if(""==a.innerHTML){var c=document.createElement("h2");c.innerHTML=l.MP_MPLAYER_SETTINGS;a.appendChild(c);c=document.createElement("div");var b=document.createElement("span");b.innerHTML=l.COLOUR;c.appendChild(b);var d=document.createElement("input");d.type="color";d.value=localStorage.color;d.onchange=kf;d.localProp="color";d.style.backgroundColor=
localStorage.color;c.appendChild(d);b=document.createElement("span");b.innerHTML=l.MP_SEARCH_T_PL_NAME;c.appendChild(b);d=document.createElement("input");d.type="text";d.value=Oe(localStorage.name);d.onchange=kf;d.localProp="name";c.appendChild(d);b=document.createElement("span");b.innerHTML=l.LANGUAGE;c.appendChild(b);b=document.createElement("select");b.innerHTML='<option value="en">English</option>\n<option value="es">Espa\u00f1ol</option>\n<option value="it">Italiano</option>\n<option value="pt">Portugu\u00eas</option>\n<option value="pl">Polski</option>\n<option value="de">Deutsch</option>\n<option value="ru">\u0420\u0443\u0441\u0441\u043a\u0438\u0439</option>\n<option value="bg">\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438</option>\n';
b.value=t.langstr;b.onchange=function(){localStorage.language=this.value;location.href=""};c.appendChild(b);b=document.createElement("span");b.innerHTML=l.AUTOFULLSCREEN;c.appendChild(b);var f=document.createElement("label");f.className="container";b=document.createElement("span");b.className="checkmark";d=document.createElement("input");d.type="checkbox";d.checked="true"==localStorage.fullscreen?!0:!1;d.onchange=yg;d.localProp="fullscreen";f.appendChild(d);f.appendChild(b);c.appendChild(f);b=document.createElement("span");
b.innerHTML="GPU";c.appendChild(b);b.style.marginTop="65px";b=document.createElement("select");b.innerHTML='<option value="1">WebGL 1</option>\n<option value="2">WebGL 2 (recommended)</option>\n';b.value=S?1:2;b.onchange=function(){localStorage.webgl=this.value;location.href=""};c.appendChild(b);a.appendChild(c)}H("returnmenu")},About:function(){var a=g("About");""==a.innerHTML&&(a.innerHTML='<div style="text-align:center;    user-select: text;"><div class="svgnehhon" style="background-repeat: no-repeat;height:342px;background-position: center;"></div>\nFully programmed by Donov from <a href="https://nehhon.com" target="_blank">nehhon</a><p>\n<a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=ABHGGGQ4TZFA2&source=url" target="_blank"><img src="nehhon/donate.gif" /></a><p>\nContact:</p>\n<a href=\'mailto:webmaster@nehhon.com\' target="_blank">webmaster@nehhon.com</a> <br> <a href="https://twitter.com/TzaredGame" target="_blank">@TzaredGame</a>\n<p>Graphics, sound and game concept (Tzar) by Haemimont</p>\n<hr>\n<p>Special thanks to:</p>\n<img style="max-width:422px" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgODc0LjMgMzkzLjciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDg3NC4zIDM5My43OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHN0eWxlIHR5cGU9InRleHQvY3NzIj4uc3Qwe2ZpbGw6I0ZGRkZGRjt9LnN0MXtmaWxsOiNGMzgwMjA7fS5zdDJ7ZmlsbDojRkFBRTQwO308L3N0eWxlPjxnPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik03OTAuNiwyNzEuOWMtMy40LDAtNi4xLTIuNy02LjEtNi4xYzAtMy4zLDIuNy02LjEsNi4xLTYuMWMzLjMsMCw2LjEsMi43LDYuMSw2LjFDNzk2LjcsMjY5LjEsNzkzLjksMjcxLjksNzkwLjYsMjcxLjkgTTc5MC42LDI2MC45Yy0yLjcsMC00LjksMi4yLTQuOSw0LjljMCwyLjcsMi4yLDQuOSw0LjksNC45YzIuNywwLDQuOS0yLjIsNC45LTQuOUM3OTUuNSwyNjMuMSw3OTMuMywyNjAuOSw3OTAuNiwyNjAuOSBNNzkzLjcsMjY5aC0xLjRsLTEuMi0yLjNoLTEuNnYyLjNoLTEuM3YtNi43aDMuMmMxLjQsMCwyLjMsMC45LDIuMywyLjJjMCwxLTAuNiwxLjctMS40LDJMNzkzLjcsMjY5eiBNNzkxLjMsMjY1LjVjMC41LDAsMS0wLjMsMS0xYzAtMC44LTAuNC0xLTEtMWgtMnYyTDc5MS4zLDI2NS41TDc5MS4zLDI2NS41eiIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iMTU1LjEsMjU5LjEgMTcwLjcsMjU5LjEgMTcwLjcsMzAxLjYgMTk3LjgsMzAxLjYgMTk3LjgsMzE1LjIgMTU1LjEsMzE1LjIgIi8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTIxMy45LDI4Ny4zdi0wLjJjMC0xNi4xLDEzLTI5LjIsMzAuMy0yOS4yczMwLjEsMTIuOSwzMC4xLDI5djAuMmMwLDE2LjEtMTMsMjkuMi0zMC4zLDI5LjJDMjI2LjcsMzE2LjMsMjEzLjksMzAzLjQsMjEzLjksMjg3LjMgTTI1OC41LDI4Ny4zdi0wLjJjMC04LjEtNS44LTE1LjEtMTQuNC0xNS4xYy04LjUsMC0xNC4yLDYuOS0xNC4yLDE1djAuMmMwLDguMSw1LjgsMTUuMSwxNC4zLDE1LjFDMjUyLjgsMzAyLjMsMjU4LjUsMjk1LjQsMjU4LjUsMjg3LjMiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjkzLjQsMjkwLjZ2LTMxLjVoMTUuOHYzMS4yYzAsOC4xLDQuMSwxMS45LDEwLjMsMTEuOXMxMC4zLTMuNywxMC4zLTExLjV2LTMxLjZoMTUuOHYzMS4xYzAsMTguMS0xMC4zLDI2LTI2LjMsMjZDMzAzLjQsMzE2LjIsMjkzLjQsMzA4LjIsMjkzLjQsMjkwLjYiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzY5LjQsMjU5LjFIMzkxYzIwLDAsMzEuNywxMS41LDMxLjcsMjcuN3YwLjJjMCwxNi4yLTExLjgsMjguMi0zMiwyOC4yaC0yMS4zTDM2OS40LDI1OS4xTDM2OS40LDI1OS4xeiBNMzkxLjMsMzAxLjRjOS4zLDAsMTUuNS01LjEsMTUuNS0xNC4ydi0wLjJjMC05LTYuMi0xNC4yLTE1LjUtMTQuMkgzODV2MjguNUgzOTEuM3oiLz48cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjQ0NS4zLDI1OS4xIDQ5MC4yLDI1OS4xIDQ5MC4yLDI3Mi43IDQ2MC44LDI3Mi43IDQ2MC44LDI4Mi4zIDQ4Ny40LDI4Mi4zIDQ4Ny40LDI5NS4yIDQ2MC44LDI5NS4yIDQ2MC44LDMxNS4yIDQ0NS4zLDMxNS4yICIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNTExLjgsMjU5LjEgNTI3LjMsMjU5LjEgNTI3LjMsMzAxLjYgNTU0LjUsMzAxLjYgNTU0LjUsMzE1LjIgNTExLjgsMzE1LjIgIi8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTU5NS4xLDI1OC43aDE1bDIzLjksNTYuNWgtMTYuN2wtNC4xLTEwaC0yMS42bC00LDEwaC0xNi4zTDU5NS4xLDI1OC43eiBNNjA4LjgsMjkzLjFsLTYuMi0xNS45bC02LjMsMTUuOUg2MDguOHoiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNNjU0LDI1OS4xaDI2LjVjOC42LDAsMTQuNSwyLjIsMTguMyw2LjFjMy4zLDMuMiw1LDcuNSw1LDEzLjF2MC4yYzAsOC42LTQuNiwxNC4zLTExLjUsMTcuMmwxMy40LDE5LjZoLTE4bC0xMS4zLTE3aC02Ljh2MTdINjU0TDY1NCwyNTkuMUw2NTQsMjU5LjF6IE02NzkuOCwyODZjNS4zLDAsOC4zLTIuNiw4LjMtNi42di0wLjJjMC00LjQtMy4yLTYuNi04LjQtNi42aC0xMC4yVjI4Nkw2NzkuOCwyODZMNjc5LjgsMjg2eiIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNzI2LjIsMjU5LjEgNzcxLjMsMjU5LjEgNzcxLjMsMjcyLjMgNzQxLjYsMjcyLjMgNzQxLjYsMjgwLjggNzY4LjUsMjgwLjggNzY4LjUsMjkzLjEgNzQxLjYsMjkzLjEgNzQxLjYsMzAyIDc3MS43LDMwMiA3NzEuNywzMTUuMiA3MjYuMiwzMTUuMiAiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTIxLjEsMjkzLjljLTIuMiw0LjktNi44LDguNC0xMi44LDguNGMtOC41LDAtMTQuMy03LjEtMTQuMy0xNS4xVjI4N2MwLTguMSw1LjctMTUsMTQuMi0xNWM2LjQsMCwxMS4zLDMuOSwxMy4zLDkuM2gxNi40Yy0yLjYtMTMuNC0xNC40LTIzLjMtMjkuNi0yMy4zYy0xNy4zLDAtMzAuMywxMy4xLTMwLjMsMjkuMnYwLjJjMCwxNi4xLDEyLjgsMjksMzAuMSwyOWMxNC44LDAsMjYuNC05LjYsMjkuNC0yMi40TDEyMS4xLDI5My45TDEyMS4xLDI5My45eiIvPjxnPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNzUyLjksMTY5LjYgNzEwLDE0NSA3MDIuNiwxNDEuOCA1MjcuMSwxNDMgNTI3LjEsMjMyLjEgNzUyLjksMjMyLjEgIi8+PHBhdGggY2xhc3M9InN0MSIgZD0iTTY3NC44LDIyMy45YzIuMS03LjIsMS4zLTEzLjgtMi4yLTE4LjdjLTMuMi00LjUtOC42LTcuMS0xNS4xLTcuNGwtMTIzLjEtMS42Yy0wLjgsMC0xLjUtMC40LTEuOS0xYy0wLjQtMC42LTAuNS0xLjQtMC4zLTIuMmMwLjQtMS4yLDEuNi0yLjEsMi45LTIuMmwxMjQuMi0xLjZjMTQuNy0wLjcsMzAuNy0xMi42LDM2LjMtMjcuMmw3LjEtMTguNWMwLjMtMC44LDAuNC0xLjYsMC4yLTIuNGMtOC0zNi4yLTQwLjMtNjMuMi03OC45LTYzLjJjLTM1LjYsMC02NS44LDIzLTc2LjYsNTQuOWMtNy01LjItMTUuOS04LTI1LjUtNy4xYy0xNy4xLDEuNy0zMC44LDE1LjQtMzIuNSwzMi41Yy0wLjQsNC40LTAuMSw4LjcsMC45LDEyLjdjLTI3LjksMC44LTUwLjIsMjMuNi01MC4yLDUxLjdjMCwyLjUsMC4yLDUsMC41LDcuNWMwLjIsMS4yLDEuMiwyLjEsMi40LDIuMWwyMjcuMiwwYzEuMywwLDIuNS0wLjksMi45LTIuMkw2NzQuOCwyMjMuOXoiLz48cGF0aCBjbGFzcz0ic3QyIiBkPSJNNzE0LDE0NC44Yy0xLjEsMC0yLjMsMC0zLjQsMC4xYy0wLjgsMC0xLjUsMC42LTEuOCwxLjRsLTQuOCwxNi43Yy0yLjEsNy4yLTEuMywxMy44LDIuMiwxOC43YzMuMiw0LjUsOC42LDcuMSwxNS4xLDcuNGwyNi4yLDEuNmMwLjgsMCwxLjUsMC40LDEuOSwxYzAuNCwwLjYsMC41LDEuNSwwLjMsMi4yYy0wLjQsMS4yLTEuNiwyLjEtMi45LDIuMmwtMjcuMywxLjZjLTE0LjgsMC43LTMwLjcsMTIuNi0zNi4zLDI3LjJsLTIsNS4xYy0wLjQsMSwwLjMsMiwxLjQsMmg5My44YzEuMSwwLDIuMS0wLjcsMi40LTEuOGMxLjYtNS44LDIuNS0xMS45LDIuNS0xOC4yQzc4MS4zLDE3NSw3NTEuMSwxNDQuOCw3MTQsMTQ0LjgiLz48L2c+PC9nPjwvc3ZnPg==" alt="cloudflare">\n</div>');
H("returnmenu")}};g("about").onclick=function(){location.hash="About"};g("discord").onclick=function(){window.open("https://discord.gg/ndxJHxT","_blank")};g("mult0").onclick=function(){location.hash="Multiplayer"};g("rnd0").onclick=function(){location.hash="RandomMap"};g("load0").onclick=function(){location.hash="CustomMap"};g("editor0").onclick=function(){location.hash="MapEditor"};g("settings0").onclick=function(){location.hash="Settings"};Pb()})();
