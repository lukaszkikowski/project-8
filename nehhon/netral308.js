
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(D,ha,sa){D!=Array.prototype&&D!=Object.prototype&&(D[ha]=sa.value)};$jscomp.getGlobal=function(D){return"undefined"!=typeof window&&window===D?D:"undefined"!=typeof global&&null!=global?global:D};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var D=0;return function(ha){return $jscomp.SYMBOL_PREFIX+(ha||"")+D++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var D=$jscomp.global.Symbol.iterator;D||(D=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[D]&&$jscomp.defineProperty(Array.prototype,D,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(D){var ha=0;return $jscomp.iteratorPrototype(function(){return ha<D.length?{done:!1,value:D[ha++]}:{done:!0}})};$jscomp.iteratorPrototype=function(D){$jscomp.initSymbolIterator();D={next:D};D[$jscomp.global.Symbol.iterator]=function(){return this};return D};
$jscomp.iteratorFromArray=function(D,ha){$jscomp.initSymbolIterator();D instanceof String&&(D+="");var sa=0,na={next:function(){if(sa<D.length){var ta=sa++;return{value:ha(ta,D[ta]),done:!1}}na.next=function(){return{done:!0,value:void 0}};return na.next()}};na[Symbol.iterator]=function(){return na};return na};
$jscomp.polyfill=function(D,ha,sa,na){if(ha){sa=$jscomp.global;D=D.split(".");for(na=0;na<D.length-1;na++){var ta=D[na];ta in sa||(sa[ta]={});sa=sa[ta]}D=D[D.length-1];na=sa[D];ha=ha(na);ha!=na&&null!=ha&&$jscomp.defineProperty(sa,D,{configurable:!0,writable:!0,value:ha})}};$jscomp.polyfill("Array.prototype.keys",function(D){return D?D:function(){return $jscomp.iteratorFromArray(this,function(D){return D})}},"es6","es3");
$jscomp.polyfill("Object.getOwnPropertySymbols",function(D){return D?D:function(){return[]}},"es6","es5");$jscomp.findInternal=function(D,ha,sa){D instanceof String&&(D=String(D));for(var na=D.length,ta=0;ta<na;ta++){var R=D[ta];if(ha.call(sa,R,ta,D))return{i:ta,v:R}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(D){return D?D:function(D,sa){return $jscomp.findInternal(this,D,sa).v}},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(D){return D?D:function(){return $jscomp.iteratorFromArray(this,function(D,sa){return sa})}},"es8","es3");$jscomp.polyfill("Math.sign",function(D){return D?D:function(D){D=Number(D);return 0===D||isNaN(D)?D:0<D?1:-1}},"es6","es3");$jscomp.polyfill("Number.isFinite",function(D){return D?D:function(D){return"number"!==typeof D?!1:!isNaN(D)&&Infinity!==D&&-Infinity!==D}},"es6","es3");
$jscomp.polyfill("Number.isInteger",function(D){return D?D:function(D){return Number.isFinite(D)?D===Math.floor(D):!1}},"es6","es3");$jscomp.owns=function(D,ha){return Object.prototype.hasOwnProperty.call(D,ha)};$jscomp.polyfill("Object.assign",function(D){return D?D:function(D,sa){for(var ha=1;ha<arguments.length;ha++){var ta=arguments[ha];if(ta)for(var R in ta)$jscomp.owns(ta,R)&&(D[R]=ta[R])}return D}},"es6","es3");
(function(){var D,ha,sa,na;function ta(g,c){var d=E,b;for(b=2;60>=b;b+=2){g--;c--;for(var f=0;f<=b;){if(2<M[g+f+d*c]&&1==A[M[g+f+d*c]].res)return M[g+f+d*c];if(2<M[g+f+d*(c+b)]&&1==A[M[g+f+d*(c+b)]].res)return M[g+f+d*(c+b)];f++}for(f=0;f<b-1;){f++;if(2<M[g+d*(c+f)]&&1==A[M[g+d*(c+f)]].res)return M[g+d*(c+f)];if(2<M[g+b+d*(c+f)]&&1==A[M[g+b+d*(c+f)]].res)return M[g+b+d*(c+f)]}}return!1}function R(g,c){if(!Hd(g)){var d=g.x32,b=g.y32,f=g.sight;g.build&&(f=g.attDist);var h=E,m=2*f+1,n=m*m,v=g.id,q={};
g.callList||(g.callList=[]);for(var p=0;p<n;p++){var u=p%m-f,y=~~(p/m)-f;Math.sqrt(Math.pow(u,2)+Math.pow(y,2))<=f&&(u+=d,y+=b,u+=y*h,hc[u]?(u=A[hc[u]],q[u.id]||c||(u.callList||P(u),u.callList.put(g.id),u.callList.put(g.x32+g.y32*h),q[u.id]=1)):hc[u]=v)}}}function di(g){if(g.callList){for(var c=g.x32,d=g.y32,b=g.sight,f=E,h=2*b+1,m=h*h,n=g.id,v=0;v<m;v++){var q=v%h-b,p=~~(v/h)-b;Math.sqrt(Math.pow(q,2)+Math.pow(p,2))<=b&&(q+=c,p+=d,q+=p*f,hc[q]==n&&(hc[q]=void 0))}g.callList=void 0}}function Fk(){for(var g=
0,c=ya.length;g<c;ya[g++].className="");}function Gk(g){k.getError()==k.CONTEXT_LOST_WEBGL&&(k=document.getElementById("tzar").getContext("webgl2",{antialias:!1,alpha:!1}),P("restored"));ha=[];sa=[0,1,2,1,2,3];na=[];sa.changed=!0;if(!hd){var c=k.createShader(k.VERTEX_SHADER);k.shaderSource(c,"#version 300 es\nprecision mediump float;\n\nin vec3 a_position;\nin vec4 a_texCoord;\nin vec4 a_kingdom;\nin vec4 a_physic;\nuniform float zoom;\nuniform mediump int miniMap;\nuniform float now;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform sampler2D u_image1;\nuniform sampler2D delay;\nuniform float zMax;\nout highp vec2 vTextureCoord;\nout vec4 v_kcolor;\nout float height;\n\nvec4 superArray(in highp uint position) {\n     return(texelFetch(u_image1, ivec2(\t\t(position%uint(512))\t\t,\tposition/uint(512)\t), 0));\n}\n\n\n\nvoid main() {\n\n\n\n    highp float  x;\n    float t;\n\thighp uint pos;\n\n\nif(a_texCoord.y>-.5&&miniMap==0){\nt=(now-a_texCoord.y);\nif(a_texCoord.w>=0.0){\npos=uint(floor(t * a_texCoord.w));         \n}else{\n\n\nint index=int(-a_texCoord.w);\nint len=int(a_texCoord.z);\nint i;\n\nfloat spt= mod(t,texelFetch(delay, ivec2(len-1+index, 0), 0).r);\n\n for(i=0;i<len;i++){\n\n\nif(texelFetch(delay, ivec2(i+index, 0), 0).r>spt) {\n\nbreak;\n }\n\n\n }\n\n pos=uint(i);\n\n\t\t\t\t  \n //pos=uint(4);\n}\n\n\n\tpos=uint(a_texCoord.x)+uint(4)*(pos%uint(a_texCoord.z));\n\n\n}else{\n\npos=uint(a_texCoord.x);\n\n}\n\n\n\n    vec4 coord = superArray(pos);\n\n\tpos=pos-pos%uint(4);\n\n\theight = (superArray(pos+uint(3)).w-superArray(pos).w)/512.0;\n\n    vec2 mxy=vec2(coord.p,coord.q);\n\n\n\t\tfloat z=a_position.z;\n\n\tif(z<0.0){\n\tz*=-1.0;\n\tmxy*=0.0;\n\n\t}\n\n\n\n    t = (now - a_physic.w) * 0.001;\n    mxy.x+=a_physic.x * t;\n\n\tfloat physicY=a_physic.y * t + a_physic.z * .5 * t * t;\n\n    mxy.y+=physicY;\n\n\nif(miniMap==1){\n\tz=0.0;\n}else{\n\tz=(1.0 - (physicY+z)/ zMax)*.9;\n}\n\n   gl_Position = vec4((((a_position.xy+mxy) + u_translation) / u_resolution * 2.0 - 1.0) * vec2(zoom, -zoom), (z), 1.0);\n\n   vTextureCoord=vec2(coord.s,coord.t);\n\n\n    v_kcolor=a_kingdom;\n\n\n}\n");
k.compileShader(c);var d=k.createShader(k.FRAGMENT_SHADER);k.shaderSource(d,"#version 300 es\nprecision mediump float;\n\n\n\nuniform sampler2D lightmap;\nuniform vec2 u_resolution;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\nuniform mediump int miniMap;\nin vec4 v_kcolor;\nin highp vec2 vTextureCoord;\nin float height;\nout vec4 COLOR;\n\nvoid main() {\n\n\nif(miniMap==0){\n\n\n\n\nvec2 txtFinal=vTextureCoord;\n\nif(txtFinal.x>=1.0){\ntxtFinal.y+=height*floor(txtFinal.x);\n}\n\n\nvec4 color=texture(img_common, vec3(txtFinal, int(txtFinal.y)));\n \n\nif(color.a<0.5) discard;\n\n\n\n\nif(v_kcolor.a<1.0){\ncolor*=v_kcolor;\n}else if(v_kcolor.a!=1.0){\n\nif(color.r==color.g&&color.r==color.b){\ncolor.rgb*=v_kcolor.rgb;\n}\ncolor.a*=v_kcolor.a-1.0;\n}\nvec4 light=vec4(1.0);\n\n\nlight = texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+vec4(1.0,1.0,1.0,0.0)*u_ambient;\n\nCOLOR=color*light;\n\n}else{\nCOLOR=v_kcolor;\n}\n\n}");
k.compileShader(d);oa=k.createProgram();k.attachShader(oa,c);k.attachShader(oa,d);k.linkProgram(oa);k.useProgram(oa);c=k.getShaderInfoLog(c);console.log("Shader compiler log: "+c);c=k.getShaderInfoLog(d);console.log("Shader compiler log: "+c);c=k.createShader(k.VERTEX_SHADER);k.shaderSource(c,"#version 300 es\nprecision mediump float;\n\nin vec3 a_position;\n\n\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform mediump int miniMap;\nuniform float zoom;\n\n\nvoid main() {\n\nfloat depth;\nif(miniMap==1){\ndepth=.03;\n}else{\ndepth=1.0;\n}\n\n   gl_Position = vec4(a_position.x, a_position.y, depth, 1.0);\n   \n\n}");
k.compileShader(c);d=k.createShader(k.FRAGMENT_SHADER);k.shaderSource(d,"#version 300 es\nprecision mediump float;\n\nuniform float u_fps;\nuniform mediump int miniMap;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\nuniform vec2 borderCoords;\nuniform vec2 waterBorder;\nuniform vec2 u_translation;\nuniform vec2 u_resolution;\nuniform vec2 minimapMargin;\nuniform mediump isampler2D img_data;\nuniform sampler2D lightmap;\nout vec4 COLOR;\nuniform float zoom;\nuniform float mx;\nuniform float mapSize;\nuniform float terrainInfo[32];\nvec4 sptexture3D(in vec2 coords,in float height1) {\n \n\n \nif(coords.x>=1.0){\ncoords.y+=height1*floor(coords.x);\n}\n\n\n\n    return(\ttexture(img_common, vec3(coords,int(coords.y)))\t);\n}\n\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main() {\nvec4 color;\n\nvec2 xy =  vec2(gl_FragCoord.x,u_resolution.y-gl_FragCoord.y)/zoom;\n\nif(miniMap==1){\nxy+=minimapMargin/zoom;\n}else{\nxy+=-u_translation+vec2(mx,0.0)/zoom+0.5*(u_resolution-u_resolution/zoom);\n}\n\nvec2 xy32=xy/32.0;\n\nvec2 floorxy32=floor(xy32);\n\nvec2 xyr=xy32-floorxy32;\n\n\nvec2 xyb;\n\n\nfloat dx=0.0;\nfloat dy=0.0;\n\nif(xyr.x>0.5){dx=1.0;}\nif(xyr.y>0.5){dy=1.0;}\n\nvec2 oxy32=xy32;\n\n\nif(dx==1.0){\nxyb=vec2(borderCoords.x+floor(rand(floorxy32)*24.0)*64.0/512.0,borderCoords.y)+(xyr)*(32.0/512.0)+vec2(-16.0,8.0)/512.0;\nif(sptexture3D(xyb,64.0/512.0).r>0.5){\nxy32.x+=dx;\n}\n}\n\nif(dy==1.0){\nxyb=vec2(borderCoords.x+floor(rand(1.5*floorxy32-3.0)*24.0)*64.0/512.0,borderCoords.y)+(xyr)*(32.0/512.0)+vec2(8,-16.0)/512.0;\nif(sptexture3D(xyb,64.0/512.0).r>0.5){\nxy32.y+=dy;\n}\n}\n\n\nint type = texture(img_data,xy32/(mapSize)).r;\nint ntype = texture(img_data,oxy32/(mapSize)).r;\n\nif(type<0&&type!=ntype){\n\nif(ntype<0){\ntype=ntype;\n}else if(ntype==3){\ntype=ntype;\n}else{\ntype=1;\n}\n}\n\n\n\nfloat h;\nfloat w;\nvec2 xytxt;\nif(type<0){\n\ntype=-type-2;\nxytxt=waterBorder+vec2(float(type*8*32),0.0)/512.0;\nw=32.0;\nh=32.0;\ntype*=-1;\n}else{\nxytxt=vec2(terrainInfo[type*4],terrainInfo[type*4+1]);\nw=terrainInfo[type*4+2];\nh=terrainInfo[type*4+3];\n\nif(type==3) xytxt+=vec2(u_fps,0.0);\n}\n\n\nvec2 xyt=vec2(xytxt)+vec2(mod(xy.x,w),mod(xy.y,h))/512.0;\n\n\nif(type==3){ h=576.0; }\ncolor=sptexture3D(xyt,h/512.0);\n\nmediump vec4 light=vec4(1.0);\nif(miniMap==0) light = (texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+1.0)*u_ambient;\n\n\n\nCOLOR=color*light;\n\n\n\n}");
k.compileShader(d);ia=k.createProgram();k.attachShader(ia,c);k.attachShader(ia,d);k.linkProgram(ia);c=k.getShaderInfoLog(c);console.log("Shader1 compiler log T: "+c);c=k.getShaderInfoLog(d);console.log("Shader compiler log T: "+c)}d=k.getAttribLocation(oa,"a_position");c=k.getAttribLocation(oa,"a_texCoord");var b=k.getAttribLocation(oa,"a_kingdom"),f=k.getAttribLocation(oa,"a_physic"),h=l,m=ic.dir,n=[];n.length=4*m.length;for(var v=0,q=m.length;v<q;v++){var p=Ca[h[m[v]]],u=p[7]+p.deltaY,y=p[8],Na=
p[9];n[4*v]=p[6]/512;n[4*v+1]=u/512;n[4*v+2]=y;n[4*v+3]=Na}P(n);v=1/512;k.useProgram(ia);q=k.getUniformLocation(ia,"minimapMargin");Id=k.getUniformLocation(ia,"u_translation");jg=k.getUniformLocation(ia,"u_resolution");kg=k.getUniformLocation(ia,"u_fps");var id=k.getUniformLocation(ia,"u_ambient");jd=k.getUniformLocation(ia,"zoom");p=k.getUniformLocation(ia,"mx");m=k.getUniformLocation(ia,"mapSize");u=k.getUniformLocation(ia,"borderCoords");y=k.getUniformLocation(ia,"waterBorder");Pe=k.getUniformLocation(ia,
"miniMap");Na=k.getUniformLocation(ia,"terrainInfo");k.uniform2fv(u,[Ca[h.terrain_border][6]*v,v*(Ca[h.terrain_border].deltaY+Ca[h.terrain_border][7])]);k.uniform2fv(y,[Ca[h.waterborder][6]*v,v*(Ca[h.waterborder].deltaY+Ca[h.waterborder][7])]);k.uniform1i(Pe,0);k.uniform2fv(Id,[0,0]);k.uniform1f(kg,-1);k.uniform1f(jd,1);k.uniform1f(p,-w.mx);k.uniform1f(m,E);k.uniform1fv(Na,n);r.editor?k.uniform2fv(q,[0,-60]):k.uniform2fv(q,[-4,-31]);h=k.getAttribLocation(ia,"a_position");lg=k.createVertexArray();
k.bindVertexArray(lg);n=k.createBuffer();k.bindBuffer(k.ARRAY_BUFFER,n);k.bufferData(k.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,-1,1,1,-1,1]),k.STATIC_DRAW);k.enableVertexAttribArray(h);k.vertexAttribPointer(h,2,k.FLOAT,!1,0,0);k.bindVertexArray(null);k.useProgram(oa);k.bindBuffer(k.ARRAY_BUFFER,null);h=E*va*3;mg=k.createVertexArray();k.bindVertexArray(mg);ub=k.createBuffer();k.bindBuffer(k.ARRAY_BUFFER,ub);k.enableVertexAttribArray(b);k.vertexAttribPointer(b,4,k.FLOAT,!1,0,0);k.bufferData(k.ARRAY_BUFFER,
16*h,k.DYNAMIC_DRAW);kd=k.createBuffer();k.bindBuffer(k.ARRAY_BUFFER,kd);k.enableVertexAttribArray(c);k.vertexAttribPointer(c,4,k.FLOAT,!1,0,0);k.bufferData(k.ARRAY_BUFFER,16*h,k.DYNAMIC_DRAW);wc=k.createBuffer();k.bindBuffer(k.ARRAY_BUFFER,wc);k.enableVertexAttribArray(d);k.vertexAttribPointer(d,3,k.FLOAT,!1,0,0);k.bufferData(k.ARRAY_BUFFER,12*h,k.DYNAMIC_DRAW);Jd=k.createBuffer();k.bindBuffer(k.ARRAY_BUFFER,Jd);k.enableVertexAttribArray(f);k.vertexAttribPointer(f,4,k.FLOAT,!1,0,0);k.bufferData(k.ARRAY_BUFFER,
16*h,k.DYNAMIC_DRAW);k.bindVertexArray(null);Qe=k.getUniformLocation(oa,"u_resolution");var jc=k.getUniformLocation(oa,"u_ambient");Kd=k.getUniformLocation(oa,"u_translation");ld=k.getUniformLocation(oa,"zoom");ei=k.getUniformLocation(oa,"now");Re=k.getUniformLocation(oa,"miniMap");d=k.getUniformLocation(oa,"zMax");k.uniform1f(d,r.zMax);k.uniform1i(Re,0);k.useProgram(oa);l.delay=[100,250,400,550,650,750,850,1E3,1150,5150,7650,10150,13650,17150,21150,25150,100,200,300,400,500,600,700,800,900,1E3,1100,
1200,7200,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,6500,7700,8900,10100,13600,17100,22100,8E3,8080,8160,8240,8320,8400,8480,100,200,300,400,500,600,700,800,900,1E3,1100,2400,3600,4800,6E3,7200,8400,11900,15400,20400,8E3,8077,8154,8231,8308,8385,8462,8539,8616,8693,8770,8847,8923,5E3,5072,5143,5215,5286,5358,5429,5501,5572,5644,5715,5787,5858,5929,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,3700,4900,7100,9600,12600,17100,8E3,8083,8166,8250,8333,8416,8500,8583,8666,8750,
8833,8916,9E3,8E3,8083,8166,8250,8333,8416,8500,8583,8666,8750,8833,8916,9E3,9080,5E3,5100,5200,5300,5400,5500,5600,5700,5850,6E3,70,140,210,280,350,420,490,560,630,700,770,840,910,980,4980,8980,12980,16980,20980,26980,6E3,6100,6200,6300,6400,6500,6600,100,200,300,400,500,600,700,800,900,1E3,1100,4100,6300,8500,11E3,13500,17E3,20500,5E3,5100,5200,5300,5400,5500,5600,5700,5800,5900,6E3,125,230,335,431,546,606,666,731,857,952,1045,1139,1238,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,3300,
5800,8800,12E3,15500,5500,5600,5700,5800,5900,6E3,6100,6200,6300,6400,6500,6600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,6800,9800,12800,16300,19800,23800,28300,5E3,5100,5200,5300,5400,5500,5600,210,420,654,864,1074,1284,1494,108,244,380,516,652,788,924,1060,1196,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4100,6100,8100,11100,14100,17100,6E3,6100,6200,6300,6400,6500,6600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,5200,9E3,11E3,13800,17600,23400,7E3,7100,
7200,7300,7400,8200,8300,8400,8500,8600,9600,9700,9800,9900,1E4,80,160,210,360,610,1010,1510,100,200,300,400,500,3500,7500,13500,40,80,120,160,200,240,280,320,360,400,440,480,520,2520,3520,4520,5520,6520,8520,11520,107,214,321,428,535,642,749,856,963,1070,1177,1284,1391,1498,7323,13148,18973,24798,30623,36448,7E3,7170,7340,7510,7680,7980,8150,8320,8490,8660,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,4400,6400,8900,11400,14900,18400,7E3,7200,7400,7600,7800,8E3,8200,125,250,375,500,
2E3,2125,2250,100,200,300,400,500,4E3,10500,100,200,300,400,500,600,700,800,900,8900,15900,21400,27400,33900,38900,44900,51900,800,1E3,1200,1400,1600,1800,2E3,2200,2400,2600,NaN,80,160,240,320,400,480,560,640,720,800,880,960,1040,5040,9040,12790,16540,19290,22040,25790,7671,7771,7871,7971,8071,8171,8271,100,200,300,400,500,600,700,800,900,1E3,1100,1200,6200,9700,13200,17200,21200,25200,29200,35200,100,200,300,400,500,600,9600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,5300,11300,17300,
27300,37300,49300,64300,8E3,8228,8457,8685,8914,9142,9371,80,160,240,320,400,480,560,640,720,800,880,960,4960,8460,11460,14460,18460,22460,28460,8E3,8228,8456,8684,8912,9140,9367,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,5400,8900,12900,16900,22900,28900,5E3,5143,5286,5429,5572,5715,5857,121,232,361,508,629,758,879,1018,1165,1425,1445,1465,1536,1692,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,5300,8300,11300,14800,18800,23300,29300,6E3,6171,6343,6514,6685,6857,7028,125,
250,375,500,625,750,875,1E3,1125,1250,1375,1500,6500,10500,13500,16500,19500,23E3,27E3,31500,8E3,8185,8370,8555,8740,8925,9108,14E3,14143,14286,14429,14572,14715,14857,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4300,7800,11300,15300,19300,23800,29800,1E4,10107,10214,10321,10428,10535,10643,10750,10857,10964,11071,11178,11285,11393,190,369,547,726,904,1073,1241,1325,1398,1429,1586,1754,1922,2100,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,4900,8400,12900,17400,22400,27400,
8E3,8250,8500,8750,9E3,9250,9500,9750,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4800,7800,10800,14300,17800,21800,26300,5E3,5086,5171,5257,5342,5428,5513,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4800,8300,11800,15800,19800,24300,29300,5E3,5157,5314,5471,5628,5785,5943,125,250,375,500,625,3125,3250,3375,100,200,300,400,500,600,4600,8600,14600,15600,14E3,14143,14286,14429,14572,14715,14857,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,7400,10900,14400,18400,
22400,28400,180,360,540,720,900,1080,10080,100,200,350,500,600,700,800,950,1100,1250,1400,1550,1700,6200,8700,11700,15200,18700,22700,27700,6E3,6120,6240,6360,6480,6600,6720,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,7400,10900,14900,18900,23400,29400,8E3,8150,8300,8450,8600,8750,8900,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,4400,7400,10900,14900,19900,5E3,5100,5200,5300,5400,5500,5600,116,232,348,464,522,580,638,696,812,928,1044,1160,1276,1392,100,200,300,400,
500,600,700,800,900,1E3,1100,1200,5200,8700,11700,14700,18700,22700,28700,8E3,8228,8456,8684,8912,9140,9367,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,6900,10900,14400,18400,22400,27400,7E3,7100,7200,7300,7400,7500,7600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,5300,8600,10800,13E3,15500,19500,24E3,8E3,8100,8200,8300,8400,8500,8600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,5300,8800,12300,16300,20300,24300,29300,6E3,6100,6200,6300,6400,6500,6600,100,200,
300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,1500,1600,1630,1730,1830,1930,2030,2130,2230,2330,5330,8330,11330,7E3,7150,7300,7450,7600,7750,7900,100,200,300,400,500,600,700,800,900,1E3,1100,1200,5200,8700,12200,15700,20200,24700,29700,34700,8E3,8080,8163,8246,8330,8413,8496,8580,8663,8746,8830,8913,8996,9080,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4800,7800,10800,14300,17800,21800,26300,5E3,5086,5171,5257,5342,5428,5513,5599,5684,5770,5855,5941,6026,6112,125,250,375,500,625,
750,875,1E3,1125,1250,1375,1500,1625,5625,8625,11625,14625,18125,22125,26625,8E3,8185,8370,8555,8740,8925,9108,190,369,547,726,904,1073,1241,1325,1398,1429,1586,1754,1922,2100,100,200,300,400,500,600,700,800,900,1E3,1100,6100,10600,14600,18100,21600,26100,30600,35600,40600,8E3,8150,8300,8450,8600,8750,8900,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,1500,1600,1700,6700,10700,11300,6E3,6200,6400,6600,6800,7E3,7200,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,10400,100,
200,300,400,500,600,8600];d=l.delay;var wa=d.length;Ca[l.expl_small_hole][1]=-wa;for(c=v=0;14>v;v++)c+=66,d[v+wa]=c;d.put(c+3E4);d=new Float32Array(d);fi=function(g){k.useProgram(ia);k.uniform4fv(id,g);k.useProgram(oa);k.uniform4fv(jc,g)};ng=function(g){if(!Ld&&(g.clientX>w.menumx||md||!g.clientX)){g=.07*Math.sign(g.deltaY)*ba;var c=(ba+g)*tzar.height*.03125;(ba+g)*tzar.width*.03125-(ba+g)*w.mx/32>E||c>va||(ba+=g,.08>ba&&(ba=.08),vb(),nd(-rb,-Da),k.useProgram(ia),k.uniform1f(jd,1/ba),k.useProgram(oa),
k.uniform1f(ld,1/ba))}};window.addEventListener("wheel",ng,!1);gi=function(){wa=[rb,Da];k.useProgram(ia);k.uniform2fv(Id,wa);k.useProgram(oa);k.uniform2fv(Kd,wa)};fi(hi());P(hi());k.uniform1f(ld,1);k.uniform2fv(Kd,[0,0]);var dc=k.createFramebuffer(),ma;Md=function(){var g=window.innerWidth,c=window.innerHeight;tzar.width=g;tzar.height=c;k.useProgram(ia);k.uniform2f(jg,g,c);k.useProgram(oa);dc.width=g;dc.height=c;k.activeTexture(k.TEXTURE2);ma||(ma=k.createTexture());k.bindTexture(k.TEXTURE_2D,ma);
k.texImage2D(k.TEXTURE_2D,0,k.RGBA,g,c,0,k.RGBA,k.UNSIGNED_BYTE,null);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);k.bindFramebuffer(k.FRAMEBUFFER,dc);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,ma,0);k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT);k.bindFramebuffer(k.FRAMEBUFFER,
null);ba=1;k.uniform1f(ld,1/ba);k.uniform1i(k.getUniformLocation(oa,"lightmap"),2);k.useProgram(ia);k.uniform1i(k.getUniformLocation(ia,"lightmap"),2);k.uniform1f(jd,1/ba);k.useProgram(oa);k.uniform2f(Qe,g,c);k.viewport(w.mx,0,g,c);Md.changed=1;nd(-rb,-Da)};Md.changed=0;window.addEventListener("resize",Md,!1);Md();k.blendEquation(k.FUNC_ADD);k.blendFunc(k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA);k.disable(k.DITHER);k.disable(k.BLEND);performance.now();c=k.createTexture();b=S.info;k.bindTexture(k.TEXTURE_2D,
c);k.texImage2D(k.TEXTURE_2D,0,k.RGBA32F,512,512,0,k.RGBA,k.FLOAT,b);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.REPEAT);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.REPEAT);k.bindTexture(k.TEXTURE_2D,null);k.activeTexture(k.TEXTURE0);k.bindTexture(k.TEXTURE_2D,c);k.uniform1i(k.getUniformLocation(oa,"u_image1"),0);k.activeTexture(k.TEXTURE1);c=k.createTexture();k.bindTexture(k.TEXTURE_2D_ARRAY,
c);k.texParameteri(k.TEXTURE_2D_ARRAY,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D_ARRAY,k.TEXTURE_MIN_FILTER,k.NEAREST);b=S.common;f=b.length;p=S.xtra;v=0;for(q=p.length;v<q;f+=p[v++].length);P(S);k.texImage3D(k.TEXTURE_2D_ARRAY,0,k.RGBA,S.size,S.size,f/(4*S.size*S.size),0,k.RGBA,k.UNSIGNED_BYTE,null);f=b.length;k.texSubImage3D(k.TEXTURE_2D_ARRAY,0,0,0,0,S.size,S.size,b.length/(4*S.size*S.size),k.RGBA,k.UNSIGNED_BYTE,b);v=0;for(q=p.length;v<q;v++)b=p[v],k.texSubImage3D(k.TEXTURE_2D_ARRAY,
0,0,0,f/1048576,S.size,S.size,b.length/(4*S.size*S.size),k.RGBA,k.UNSIGNED_BYTE,b),f+=b.length;P(f);k.activeTexture(k.TEXTURE1);k.bindTexture(k.TEXTURE_2D_ARRAY,c);k.uniform1i(k.getUniformLocation(oa,"img_common"),1);k.useProgram(ia);k.activeTexture(k.TEXTURE0);k.bindTexture(k.TEXTURE_2D_ARRAY,c);k.uniform1i(k.getUniformLocation(ia,"img_common"),0);Jc(g);hd||(P(d),k.activeTexture(k.TEXTURE3),c=k.createTexture(),k.bindTexture(k.TEXTURE_2D,c),k.texImage2D(k.TEXTURE_2D,0,k.R16F,d.length,1,0,k.RED,k.FLOAT,
d),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.REPEAT),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.REPEAT),k.bindTexture(k.TEXTURE_2D,null),k.bindTexture(k.TEXTURE_2D,c),k.uniform1i(k.getUniformLocation(oa,"delay"),3),k.activeTexture(k.TEXTURE2),og=k.createTexture(),k.bindTexture(k.TEXTURE_2D,og),k.texImage2D(k.TEXTURE_2D,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,new Uint8Array([255,
255,255,255])),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.REPEAT),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.REPEAT),k.clearColor(0,0,0,1));k.bindFramebuffer(k.FRAMEBUFFER,dc);dc.width=1;dc.height=1;k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,ma,0);k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT);k.bindFramebuffer(k.FRAMEBUFFER,null);new Float32Array(8);
pg=k.createBuffer();qg=k.createBuffer();ii=k.createBuffer();v=0;for(q=rg.length;v<q;v++)Xa(rg[v]);k.enable(k.DEPTH_TEST);k.depthFunc(k.LEQUAL);Oa.fp1000=1E3;Oa.delta=0;Oa.now=0;Oa.frameCount=0;k.bindTexture(k.TEXTURE_2D,ma);hd=S.setup=!0}function od(g,c){sg();var b=c||od,e=function(){b(g,c)};if(!ji()){if("true"==localStorage.fullscreen){var f=document.documentElement;f.requestFullscreen?f.requestFullscreen():f.msRequestFullscreen?f.msRequestFullscreen():f.mozRequestFullScreen?f.mozRequestFullScreen():
f.webkitRequestFullscreen&&f.webkitRequestFullscreen()}r.editor?(w.marx=0,w.mary=60,t("saveGame").innerHTML=x.save,w.menumy=60,Ob=Tb=171,w.mx=0,w.menumx=171):(w.mx=151,Ob=Tb=128,w.menumx=151,w.menumy=0,t("saveGame").innerHTML=x.savegame,w.marx=4,w.mary=31);Kc.style.width=Tb+"px";Kc.style.height=Ob+"px";Kc.style.left=w.marx+"px";Kc.style.top=w.mary+"px";Pb();t("loading").style.display="block";origin=!1;P(S.load,S.images);if(S.load<S.images||!S.images)return S.started||(t("qdgraphics")&&(t("qdgraphics").style.display=
"none"),ki()),t("loadingtext").innerHTML=x.waitImages,Ub=e,!1;if(tg.last!==t("terrainSelect").value)return ug=!0,t("loadingtext").innerHTML="Downloading terrain",Ik(),Ub=e,!1;Jk();t("notifybottom").style.display="none";void 0===r.arje&&vg();r.demo?t("saveGame").style.display="none":t("saveGame").style.display="block";if(r.custom){var h=0==r.cycle?r.kingdomStart||r.kingdoms:r.kingdoms;e=0;for(f=h.length;e<f;e++){var m=new kc("",h[e].color,[0],!0);Object.assign(m,h[e]);m.values.pop=0;null==m.resources[0]&&
(m.resources[0]=Infinity);null==m.resources[1]&&(m.resources[1]=Infinity);null==m.resources[2]&&(m.resources[2]=Infinity);null==m.resources[3]&&(m.resources[3]=Infinity)}}else for(e=0,f=I.length;e<f;e++){h=I[e];m=[0];for(var n=0;n<f;n++)m[n+1]=I[n].team==h.team?0:1;r.online&&h.id===w.onlineID&&(w.kingdom=e+1);new kc(h.name,h.color,m,h.race,h.IA,[r.goldRes,r.woodRes,r.foodRes,r.stoneRes],h.team)}r.rules?Kk(r.rules):Nd=void 0;w.kingdom||(w.kingdom=1);Lk();return!0}}function li(){t("playingMenu").style.display=
"block";Pb()}function Mk(g){P("setup:",g);g.toSend=[];g.orderList=[];g.sendDirectly("channelMessage","nehhof",{});g.channels.channelMessage.onopen=function(){Ma.put(g);pa("attack");wg();xg(1);P("DATACHANNEL OPEN");for(var c=0,b=I.length;c<b;c++)if(I[c].id==g.id)g.username=I[c].name,lc[c]&&(lc[c].style.background="#00ff00",lc[c].style.boxShadow="0px 0px 30px 0px #00ff00");else if(I[c].id==w.onlineID){var e=I[c],f=w.color;P("sending");ea(yg,f,0,[g],2);ea(zg,e.team,0,[g],2);ea(Ag,e.race,0,[g],2);ea(mi,
w.name,0,[g],2)}};g.channels.channelMessage.onerror=function(g){P(g)}}function Nk(g){var c={};g=(g+"").split("");for(var b=g[0],e=b,f=[b],h=256,m,n=1;n<g.length;n++)m=g[n].charCodeAt(0),m=256>m?g[n]:c[m]?c[m]:e+b,f.push(m),b=m.charAt(0),c[h]=e+b,h++,e=m;return f.join("")}function ni(){document.getElementById("buttons").innerHTML="";document.getElementById("onlineID").value="";document.getElementById("gameName").innerHTML=""}function Bg(){w.p2p?(Ya(),w.p2p.emit("getRooms"),t("returnmenu").style.display=
"block"):(Ua||mc(),mc.func=Bg)}function oi(){var g=location,c=g.hash.substr(1);""==c&&(document.getElementById("returnmenu").style.display="none");if("MatchX"==c.substr(0,6))6<c.length&&Ok(c.substr(6-c.length));else if("Room"==g.hash.substr(-4))g=g.hash.substr(1),w.admin||pi(g.substr(0,g.length-4));else if(qi[c])qi[c]();else g.hash=""}function ri(g){var c=new Date;g=new Uint32Array(g);for(var b,e=E,f=0;f<M.length;f++)M[f]!=g[f]&&(b=g[f],M[f]=b,b=A[b],b.x32=f%e,b.y32=~~(f/e));console.log(new Date-
c)}function si(g){g=new Uint32Array(g);console.log(g)}function ti(g){g=document.getElementById(g);g.style.display="none"==g.style.display?"block":"none"}function Cg(g){g.style.display="none"==g.style.display?"block":"none"}function ui(g){Q=function(){};Vb=!1;var c=X;c.d=g.d;Z(c,g.img);c.active=!0;Qa=B[52];Od=g;document.addEventListener("mousemove",Dg);document.addEventListener("mousedown",Se)}function Pk(g,c){return g.innerHTML-c.innerHTML}var Qk=function(){(function(g){"object"===typeof exports&&
"undefined"!==typeof module?module.exports=g():"function"===typeof define&&define.amd?define([],g):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).SimpleWebRTC=g()})(function(){return function f(c,b,e){function d(h,n){if(!b[h]){if(!c[h]){var v="function"==typeof require&&require;if(!n&&v)return v(h,!0);if(m)return m(h,!0);n=Error("Cannot find module '"+h+"'");throw n.code="MODULE_NOT_FOUND",n;}n=b[h]={exports:{}};c[h][0].call(n.exports,function(b){var f=
c[h][1][b];return d(f?f:b)},n,n.exports,f,c,b,e)}return b[h].exports}for(var m="function"==typeof require&&require,n=0;n<e.length;n++)d(e[n]);return d}({1:[function(c,b,e){function f(){}b.exports=function(c,b,d){function e(c,f){if(0>=e.count)throw Error("after called too many times");--e.count;c?(h=!0,b(c),b=d):0!==e.count||h||b(null,f)}var h=!1;d=d||f;e.count=c;return 0===c?b():e}},{}],2:[function(c,b,e){b.exports=function(c,b,d){var f=c.byteLength;b=b||0;d=d||f;if(c.slice)return c.slice(b,d);0>
b&&(b+=f);0>d&&(d+=f);d>f&&(d=f);if(b>=f||b>=d||0===f)return new ArrayBuffer(0);c=new Uint8Array(c);f=new Uint8Array(d-b);for(var e=0;b<d;b++,e++)f[e]=c[b];return f.buffer}},{}],3:[function(c,b,e){b.exports=function(c,b,d){var f,e=b;b={autoplay:!0,mirror:!1,muted:!1,audio:!1,disableContextMenu:!1};if(d)for(f in d)b[f]=d[f];e?"audio"===e.tagName.toLowerCase()&&(b.audio=!0):e=document.createElement(b.audio?"audio":"video");b.disableContextMenu&&(e.oncontextmenu=function(c){c.preventDefault()});b.autoplay&&
(e.autoplay="autoplay");b.muted&&(e.muted=!0);!b.audio&&b.mirror&&["","moz","webkit","o","ms"].forEach(function(c){e.style[c?c+"Transform":"transform"]="scaleX(-1)"});e.srcObject=c;return e}},{}],4:[function(c,b,e){function f(c){c=c||{};this.ms=c.min||100;this.max=c.max||1E4;this.factor=c.factor||2;this.jitter=0<c.jitter&&1>=c.jitter?c.jitter:0;this.attempts=0}b.exports=f;f.prototype.duration=function(){var c=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),f=Math.floor(b*
this.jitter*c);c=0==(Math.floor(10*b)&1)?c-f:c+f}return Math.min(c,this.max)|0};f.prototype.reset=function(){this.attempts=0};f.prototype.setMin=function(c){this.ms=c};f.prototype.setMax=function(c){this.max=c};f.prototype.setJitter=function(c){this.jitter=c}},{}],5:[function(c,b,e){(function(c){e.encode=function(b){b=new Uint8Array(b);var f,d=b.length,e="";for(f=0;f<d;f+=3)e+=c[b[f]>>2],e+=c[(b[f]&3)<<4|b[f+1]>>4],e+=c[(b[f+1]&15)<<2|b[f+2]>>6],e+=c[b[f+2]&63];2===d%3?e=e.substring(0,e.length-1)+
"=":1===d%3&&(e=e.substring(0,e.length-2)+"==");return e};e.decode=function(b){var f=.75*b.length,d=b.length,e=0;"="===b[b.length-1]&&(f--,"="===b[b.length-2]&&f--);var h=new ArrayBuffer(f),p=new Uint8Array(h);for(f=0;f<d;f+=4){var u=c.indexOf(b[f]);var y=c.indexOf(b[f+1]);var Na=c.indexOf(b[f+2]);var id=c.indexOf(b[f+3]);p[e++]=u<<2|y>>4;p[e++]=(y&15)<<4|Na>>2;p[e++]=(Na&3)<<6|id&63}return h}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],6:[function(c,b,e){(function(c){function f(c){for(var b=
0;b<c.length;b++){var f=c[b];if(f.buffer instanceof ArrayBuffer){var d=f.buffer;if(f.byteLength!==d.byteLength){var e=new Uint8Array(f.byteLength);e.set(new Uint8Array(d,f.byteOffset,f.byteLength));d=e.buffer}c[b]=d}}}function d(c,b){b=b||{};var d=new v;f(c);for(var e=0;e<c.length;e++)d.append(c[e]);return b.type?d.getBlob(b.type):d.getBlob()}function e(c,b){f(c);return new Blob(c,b||{})}var v=c.BlobBuilder||c.WebKitBlobBuilder||c.MSBlobBuilder||c.MozBlobBuilder;try{var q=2===(new Blob(["hi"])).size}catch(y){q=
!1}var p;if(p=q)try{p=2===(new Blob([new Uint8Array([1,2])])).size}catch(y){p=!1}var u=v&&v.prototype.append&&v.prototype.getBlob;c=q?p?c.Blob:e:u?d:void 0;b.exports=c}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],7:[function(c,b,e){var f=[].slice;b.exports=function(c,b){"string"==typeof b&&(b=c[b]);if("function"!=typeof b)throw Error("bind() requires a function");var d=f.call(arguments,2);return function(){return b.apply(c,
d.concat(f.call(arguments)))}}},{}],8:[function(c,b,e){function f(c){if(c){for(var b in f.prototype)c[b]=f.prototype[b];return c}}b.exports=f;f.prototype.on=f.prototype.addEventListener=function(c,b){this._callbacks=this._callbacks||{};(this._callbacks[c]=this._callbacks[c]||[]).push(b);return this};f.prototype.once=function(c,b){function f(){d.off(c,f);b.apply(this,arguments)}var d=this;this._callbacks=this._callbacks||{};f.fn=b;this.on(c,f);return this};f.prototype.off=f.prototype.removeListener=
f.prototype.removeAllListeners=f.prototype.removeEventListener=function(c,b){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var f=this._callbacks[c];if(!f)return this;if(1==arguments.length)return delete this._callbacks[c],this;for(var d,e=0;e<f.length;e++)if(d=f[e],d===b||d.fn===b){f.splice(e,1);break}return this};f.prototype.emit=function(c){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),f=this._callbacks[c];if(f){f=f.slice(0);for(var d=
0,e=f.length;d<e;++d)f[d].apply(this,b)}return this};f.prototype.listeners=function(c){this._callbacks=this._callbacks||{};return this._callbacks[c]||[]};f.prototype.hasListeners=function(c){return!!this.listeners(c).length}},{}],9:[function(c,b,e){b.exports=function(c,b){var f=function(){};f.prototype=b.prototype;c.prototype=new f;c.prototype.constructor=c}},{}],10:[function(c,b,e){function f(c){return f.enabled(c)?function(b){b instanceof Error&&(b=b.stack||b.message);var d=new Date,e=d-(f[c]||
d);f[c]=d;b=c+" "+b+" +"+f.humanize(e);window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}b.exports=f;f.names=[];f.skips=[];f.enable=function(c){try{localStorage.debug=c}catch(q){}for(var b=(c||"").split(/[\s,]+/),d=b.length,e=0;e<d;e++)c=b[e].replace("*",".*?"),"-"===c[0]?f.skips.push(new RegExp("^"+c.substr(1)+"$")):f.names.push(new RegExp("^"+c+"$"))};f.disable=function(){f.enable("")};f.humanize=function(c){return 36E5<=c?(c/36E5).toFixed(1)+
"h":6E4<=c?(c/6E4).toFixed(1)+"m":1E3<=c?(c/1E3|0)+"s":c+"ms"};f.enabled=function(c){for(var b=0,d=f.skips.length;b<d;b++)if(f.skips[b].test(c))return!1;b=0;for(d=f.names.length;b<d;b++)if(f.names[b].test(c))return!0;return!1};try{window.localStorage&&f.enable(localStorage.debug)}catch(h){}},{}],11:[function(c,b,e){b.exports=c("./lib/")},{"./lib/":12}],12:[function(c,b,e){b.exports=c("./socket");b.exports.parser=c("engine.io-parser")},{"./socket":13,"engine.io-parser":24}],13:[function(c,b,e){(function(f){function d(c,
b){if(!(this instanceof d))return new d(c,b);b=b||{};c&&"object"==typeof c&&(b=c,c=null);c&&(c=u(c),b.host=c.host,b.secure="https"==c.protocol||"wss"==c.protocol,b.port=c.port,c.query&&(b.query=c.query));this.secure=null!=b.secure?b.secure:f.location&&"https:"==location.protocol;b.host&&(c=b.host.split(":"),b.hostname=c.shift(),c.length?b.port=c.pop():b.port||(b.port=this.secure?"443":"80"));this.agent=b.agent||!1;this.hostname=b.hostname||(f.location?location.hostname:"localhost");this.port=b.port||
(f.location&&location.port?location.port:this.secure?443:80);this.query=b.query||{};"string"==typeof this.query&&(this.query=Na.decode(this.query));this.upgrade=!1!==b.upgrade;this.path=(b.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!b.forceJSONP;this.jsonp=!1!==b.jsonp;this.forceBase64=!!b.forceBase64;this.enablesXDR=!!b.enablesXDR;this.timestampParam=b.timestampParam||"t";this.timestampRequests=b.timestampRequests;this.transports=b.transports||["polling","websocket"];this.readyState=
"";this.writeBuffer=[];this.callbackBuffer=[];this.policyPort=b.policyPort||843;this.rememberUpgrade=b.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=b.onlyBinaryUpgrades;this.pfx=b.pfx||null;this.key=b.key||null;this.passphrase=b.passphrase||null;this.cert=b.cert||null;this.ca=b.ca||null;this.ciphers=b.ciphers||null;this.rejectUnauthorized=b.rejectUnauthorized||null;this.open()}var e=c("./transports"),n=c("component-emitter"),v=c("debug")("engine.io-client:socket"),q=c("indexof"),
p=c("engine.io-parser"),u=c("parseuri"),y=c("parsejson"),Na=c("parseqs");b.exports=d;d.priorWebsocketSuccess=!1;n(d.prototype);d.protocol=p.protocol;d.Socket=d;d.Transport=c("./transport");d.transports=c("./transports");d.parser=c("engine.io-parser");d.prototype.createTransport=function(c){v('creating transport "%s"',c);var b=this.query,d={},f;for(f in b)b.hasOwnProperty(f)&&(d[f]=b[f]);d.EIO=p.protocol;d.transport=c;this.id&&(d.sid=this.id);return new e[c]({agent:this.agent,hostname:this.hostname,
port:this.port,secure:this.secure,path:this.path,query:d,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})};d.prototype.open=function(){if(this.rememberUpgrade&&d.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))var c=
"websocket";else{if(0==this.transports.length){var b=this;setTimeout(function(){b.emit("error","No transports available")},0);return}c=this.transports[0]}this.readyState="opening";try{c=this.createTransport(c)}catch(wa){this.transports.shift();this.open();return}c.open();this.setTransport(c)};d.prototype.setTransport=function(c){v("setting transport %s",c.name);var b=this;this.transport&&(v("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=c;
c.on("drain",function(){b.onDrain()}).on("packet",function(c){b.onPacket(c)}).on("error",function(c){b.onError(c)}).on("close",function(){b.onClose("transport close")})};d.prototype.probe=function(c){function b(){if(y.onlyBinaryUpgrades){var b=!this.supportsBinary&&y.transport.supportsBinary;u=u||b}u||(v('probe transport "%s" opened',c),p.send([{type:"ping",data:"probe"}]),p.once("packet",function(b){u||("pong"==b.type&&"probe"==b.data?(v('probe transport "%s" pong',c),y.upgrading=!0,y.emit("upgrading",
p),p&&(d.priorWebsocketSuccess="websocket"==p.name,v('pausing current transport "%s"',y.transport.name),y.transport.pause(function(){u||"closed"==y.readyState||(v("changing transport and sending upgrade packet"),q(),y.setTransport(p),p.send([{type:"upgrade"}]),y.emit("upgrade",p),p=null,y.upgrading=!1,y.flush())}))):(v('probe transport "%s" failed',c),b=Error("probe error"),b.transport=p.name,y.emit("upgradeError",b)))}))}function f(){u||(u=!0,q(),p.close(),p=null)}function e(b){var d=Error("probe error: "+
b);d.transport=p.name;f();v('probe transport "%s" failed because of error: %s',c,b);y.emit("upgradeError",d)}function h(){e("transport closed")}function m(){e("socket closed")}function n(c){p&&c.name!=p.name&&(v('"%s" works - aborting "%s"',c.name,p.name),f())}function q(){p.removeListener("open",b);p.removeListener("error",e);p.removeListener("close",h);y.removeListener("close",m);y.removeListener("upgrading",n)}v('probing transport "%s"',c);var p=this.createTransport(c,{probe:1}),u=!1,y=this;d.priorWebsocketSuccess=
!1;p.once("open",b);p.once("error",e);p.once("close",h);this.once("close",m);this.once("upgrading",n);p.open()};d.prototype.onOpen=function(){v("socket open");this.readyState="open";d.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){v("starting upgrade probes");for(var c=0,b=this.upgrades.length;c<b;c++)this.probe(this.upgrades[c])}};d.prototype.onPacket=function(c){if("opening"==this.readyState||
"open"==this.readyState)switch(v('socket receive: type "%s", data "%s"',c.type,c.data),this.emit("packet",c),this.emit("heartbeat"),c.type){case "open":this.onHandshake(y(c.data));break;case "pong":this.setPing();break;case "error":var b=Error("server error");b.code=c.data;this.emit("error",b);break;case "message":this.emit("data",c.data),this.emit("message",c.data)}else v('packet received with socket readyState "%s"',this.readyState)};d.prototype.onHandshake=function(c){this.emit("handshake",c);
this.id=c.sid;this.transport.query.sid=c.sid;this.upgrades=this.filterUpgrades(c.upgrades);this.pingInterval=c.pingInterval;this.pingTimeout=c.pingTimeout;this.onOpen();"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};d.prototype.onHeartbeat=function(c){clearTimeout(this.pingTimeoutTimer);var b=this;b.pingTimeoutTimer=setTimeout(function(){if("closed"!=b.readyState)b.onClose("ping timeout")},c||b.pingInterval+b.pingTimeout)};
d.prototype.setPing=function(){var c=this;clearTimeout(c.pingIntervalTimer);c.pingIntervalTimer=setTimeout(function(){v("writing ping packet - expecting pong within %sms",c.pingTimeout);c.ping();c.onHeartbeat(c.pingTimeout)},c.pingInterval)};d.prototype.ping=function(){this.sendPacket("ping")};d.prototype.onDrain=function(){for(var c=0;c<this.prevBufferLen;c++)if(this.callbackBuffer[c])this.callbackBuffer[c]();this.writeBuffer.splice(0,this.prevBufferLen);this.callbackBuffer.splice(0,this.prevBufferLen);
this.prevBufferLen=0;0==this.writeBuffer.length?this.emit("drain"):this.flush()};d.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(v("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};d.prototype.write=d.prototype.send=function(c,b){this.sendPacket("message",c,b);return this};d.prototype.sendPacket=function(c,b,d){"closing"!=
this.readyState&&"closed"!=this.readyState&&(c={type:c,data:b},this.emit("packetCreate",c),this.writeBuffer.push(c),this.callbackBuffer.push(d),this.flush())};d.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){var c=function(){f.once("upgrade",b);f.once("upgradeError",b)},b=function(){f.removeListener("upgrade",b);f.removeListener("upgradeError",b);d()},d=function(){f.onClose("forced close");v("socket closing - telling transport to close");f.transport.close()};this.readyState=
"closing";var f=this;if(this.writeBuffer.length)this.once("drain",function(){this.upgrading?c():d()});else this.upgrading?c():d()}return this};d.prototype.onError=function(c){v("socket error %j",c);d.priorWebsocketSuccess=!1;this.emit("error",c);this.onClose("transport error",c)};d.prototype.onClose=function(c,b){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){v('socket close with reason: "%s"',c);var d=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);
setTimeout(function(){d.writeBuffer=[];d.callbackBuffer=[];d.prevBufferLen=0},0);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",c,b)}};d.prototype.filterUpgrades=function(c){for(var b=[],d=0,f=c.length;d<f;d++)~q(this.transports,c[d])&&b.push(c[d]);return b}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./transport":14,
"./transports":15,"component-emitter":8,debug:21,"engine.io-parser":24,indexof:32,parsejson:40,parseqs:41,parseuri:23}],14:[function(c,b,e){function d(c){this.path=c.path;this.hostname=c.hostname;this.port=c.port;this.secure=c.secure;this.query=c.query;this.timestampParam=c.timestampParam;this.timestampRequests=c.timestampRequests;this.readyState="";this.agent=c.agent||!1;this.socket=c.socket;this.enablesXDR=c.enablesXDR;this.pfx=c.pfx;this.key=c.key;this.passphrase=c.passphrase;this.cert=c.cert;
this.ca=c.ca;this.ciphers=c.ciphers;this.rejectUnauthorized=c.rejectUnauthorized}var h=c("engine.io-parser");c=c("component-emitter");b.exports=d;c(d.prototype);d.timestamps=0;d.prototype.onError=function(c,b){c=Error(c);c.type="TransportError";c.description=b;this.emit("error",c);return this};d.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this};d.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),
this.onClose();return this};d.prototype.send=function(c){if("open"==this.readyState)this.write(c);else throw Error("Transport not open");};d.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};d.prototype.onData=function(c){c=h.decodePacket(c,this.socket.binaryType);this.onPacket(c)};d.prototype.onPacket=function(c){this.emit("packet",c)};d.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":8,"engine.io-parser":24}],15:[function(c,
b,e){(function(b){var d=c("xmlhttprequest"),f=c("./polling-xhr"),n=c("./polling-jsonp"),v=c("./websocket");e.polling=function(c){var e=!1,h=!1,m=!1!==c.jsonp;b.location&&(h="https:"==location.protocol,(e=location.port)||(e=h?443:80),e=c.hostname!=location.hostname||e!=c.port,h=c.secure!=h);c.xdomain=e;c.xscheme=h;if("open"in new d(c)&&!c.forceJSONP)return new f(c);if(!m)throw Error("JSONP disabled");return new n(c)};e.websocket=v}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?
self:"undefined"!==typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(c,b,e){(function(d){function f(){}function e(c){n.call(this,c);this.query=this.query||{};u||(d.___eio||(d.___eio=[]),u=d.___eio);this.index=u.length;var b=this;u.push(function(c){b.onData(c)});this.query.j=this.index;d.document&&d.addEventListener&&d.addEventListener("beforeunload",function(){b.script&&(b.script.onerror=f)},!1)}var n=c("./polling"),v=c("component-inherit");
b.exports=e;var q=/\n/g,p=/\\n/g,u;v(e,n);e.prototype.supportsBinary=!1;e.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.iframe=this.form=null);n.prototype.doClose.call(this)};e.prototype.doPoll=function(){var c=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);b.async=!0;b.src=this.uri();b.onerror=function(b){c.onError("jsonp poll error",
b)};var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(b,d);this.script=b;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var c=document.createElement("iframe");document.body.appendChild(c);document.body.removeChild(c)},100)};e.prototype.doWrite=function(c,b){function d(){f();b()}function f(){if(e.iframe)try{e.form.removeChild(e.iframe)}catch(Eg){e.onError("jsonp polling iframe removal error",Eg)}try{v=document.createElement('<iframe src="javascript:0" name="'+
e.iframeId+'">')}catch(Eg){v=document.createElement("iframe"),v.name=e.iframeId,v.src="javascript:0"}v.id=e.iframeId;e.form.appendChild(v);e.iframe=v}var e=this;if(!this.form){var h=document.createElement("form"),m=document.createElement("textarea"),n=this.iframeId="eio_iframe_"+this.index,v;h.className="socketio";h.style.position="absolute";h.style.top="-1000px";h.style.left="-1000px";h.target=n;h.method="POST";h.setAttribute("accept-charset","utf-8");m.name="d";h.appendChild(m);document.body.appendChild(h);
this.form=h;this.area=m}this.form.action=this.uri();f();c=c.replace(p,"\\\n");this.area.value=c.replace(q,"\\n");try{this.form.submit()}catch(Eg){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==e.iframe.readyState&&d()}:this.iframe.onload=d}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-inherit":9}],17:[function(c,b,e){(function(d){function f(){}function e(c){p.call(this,
c);if(d.location){var b="https:"==location.protocol,e=location.port;e||(e=b?443:80);this.xd=c.hostname!=d.location.hostname||e!=c.port;this.xs=c.secure!=b}}function n(c){this.method=c.method||"GET";this.uri=c.uri;this.xd=!!c.xd;this.xs=!!c.xs;this.async=!1!==c.async;this.data=void 0!=c.data?c.data:null;this.agent=c.agent;this.isBinary=c.isBinary;this.supportsBinary=c.supportsBinary;this.enablesXDR=c.enablesXDR;this.pfx=c.pfx;this.key=c.key;this.passphrase=c.passphrase;this.cert=c.cert;this.ca=c.ca;
this.ciphers=c.ciphers;this.rejectUnauthorized=c.rejectUnauthorized;this.create()}function v(){for(var c in n.requests)n.requests.hasOwnProperty(c)&&n.requests[c].abort()}var q=c("xmlhttprequest"),p=c("./polling"),u=c("component-emitter"),y=c("component-inherit"),Na=c("debug")("engine.io-client:polling-xhr");b.exports=e;b.exports.Request=n;y(e,p);e.prototype.supportsBinary=!0;e.prototype.request=function(c){c=c||{};c.uri=this.uri();c.xd=this.xd;c.xs=this.xs;c.agent=this.agent||!1;c.supportsBinary=
this.supportsBinary;c.enablesXDR=this.enablesXDR;c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;return new n(c)};e.prototype.doWrite=function(c,b){c=this.request({method:"POST",data:c,isBinary:"string"!==typeof c&&void 0!==c});var d=this;c.on("success",b);c.on("error",function(c){d.onError("xhr post error",c)});this.sendXhr=c};e.prototype.doPoll=function(){Na("xhr poll");var c=this.request(),
b=this;c.on("data",function(c){b.onData(c)});c.on("error",function(c){b.onError("xhr poll error",c)});this.pollXhr=c};u(n.prototype);n.prototype.create=function(){var c={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;var b=this.xhr=new q(c),e=this;try{Na("xhr open %s: %s",this.method,this.uri);b.open(this.method,
this.uri,this.async);this.supportsBinary&&(b.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?b.setRequestHeader("Content-type","application/octet-stream"):b.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(dc){}"withCredentials"in b&&(b.withCredentials=!0);this.hasXDR()?(b.onload=function(){e.onLoad()},b.onerror=function(){e.onError(b.responseText)}):b.onreadystatechange=function(){if(4==b.readyState)if(200==b.status||1223==b.status)e.onLoad();else setTimeout(function(){e.onError(b.status)},
0)};Na("xhr data %s",this.data);b.send(this.data)}catch(dc){setTimeout(function(){e.onError(dc)},0);return}d.document&&(this.index=n.requestsCount++,n.requests[this.index]=this)};n.prototype.onSuccess=function(){this.emit("success");this.cleanup()};n.prototype.onData=function(c){this.emit("data",c);this.onSuccess()};n.prototype.onError=function(c){this.emit("error",c);this.cleanup(!0)};n.prototype.cleanup=function(c){if("undefined"!=typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=
this.xhr.onerror=f:this.xhr.onreadystatechange=f;if(c)try{this.xhr.abort()}catch(jc){}d.document&&delete n.requests[this.index];this.xhr=null}};n.prototype.onLoad=function(){try{try{var c=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(wa){}var b="application/octet-stream"===c?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(wa){this.onError(wa)}if(null!=b)this.onData(b)};n.prototype.hasXDR=function(){return"undefined"!==typeof d.XDomainRequest&&!this.xs&&this.enablesXDR};
n.prototype.abort=function(){this.cleanup()};d.document&&(n.requestsCount=0,n.requests={},d.attachEvent?d.attachEvent("onunload",v):d.addEventListener&&d.addEventListener("beforeunload",v,!1))}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-emitter":8,"component-inherit":9,debug:21,xmlhttprequest:20}],18:[function(c,b,e){function d(c){var b=c&&c.forceBase64;if(!q||b)this.supportsBinary=!1;h.call(this,
c)}var h=c("../transport"),m=c("parseqs"),n=c("engine.io-parser");e=c("component-inherit");var v=c("debug")("engine.io-client:polling");b.exports=d;var q=null!=(new (c("xmlhttprequest"))({xdomain:!1})).responseType;e(d,h);d.prototype.name="polling";d.prototype.doOpen=function(){this.poll()};d.prototype.pause=function(c){function b(){v("paused");d.readyState="paused";c()}var d=this;this.readyState="pausing";if(this.polling||!this.writable){var e=0;this.polling&&(v("we are currently polling - waiting to pause"),
e++,this.once("pollComplete",function(){v("pre-pause polling complete");--e||b()}));this.writable||(v("we are currently writing - waiting to pause"),e++,this.once("drain",function(){v("pre-pause writing complete");--e||b()}))}else b()};d.prototype.poll=function(){v("polling");this.polling=!0;this.doPoll();this.emit("poll")};d.prototype.onData=function(c){var b=this;v("polling got data %s",c);n.decodePayload(c,this.socket.binaryType,function(c,d,e){if("opening"==b.readyState)b.onOpen();if("close"==
c.type)return b.onClose(),!1;b.onPacket(c)});"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():v('ignoring poll - transport state "%s"',this.readyState))};d.prototype.doClose=function(){function c(){v("writing close packet");b.write([{type:"close"}])}var b=this;"open"==this.readyState?(v("transport open - closing"),c()):(v("transport not open - deferring close"),this.once("open",c))};d.prototype.write=function(c){var b=this;this.writable=!1;
var d=function(){b.writable=!0;b.emit("drain")};b=this;n.encodePayload(c,this.supportsBinary,function(c){b.doWrite(c,d)})};d.prototype.uri=function(){var c=this.query||{},b=this.secure?"https":"http",d="";!1!==this.timestampRequests&&(c[this.timestampParam]=+new Date+"-"+h.timestamps++);this.supportsBinary||c.sid||(c.b64=1);c=m.encode(c);this.port&&("https"==b&&443!=this.port||"http"==b&&80!=this.port)&&(d=":"+this.port);c.length&&(c="?"+c);return b+"://"+this.hostname+d+this.path+c}},{"../transport":14,
"component-inherit":9,debug:21,"engine.io-parser":24,parseqs:41,xmlhttprequest:20}],19:[function(c,b,e){function d(c){c&&c.forceBase64&&(this.supportsBinary=!1);h.call(this,c)}var h=c("../transport"),m=c("engine.io-parser"),n=c("parseqs");e=c("component-inherit");var v=c("debug")("engine.io-client:websocket"),q=c("ws");b.exports=d;e(d,h);d.prototype.name="websocket";d.prototype.supportsBinary=!0;d.prototype.doOpen=function(){if(this.check()){var c=this.uri(),b={agent:this.agent};b.pfx=this.pfx;b.key=
this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;this.ws=new q(c,void 0,b);void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.binaryType="arraybuffer";this.addEventListeners()}};d.prototype.addEventListeners=function(){var c=this;this.ws.onopen=function(){c.onOpen()};this.ws.onclose=function(){c.onClose()};this.ws.onmessage=function(b){c.onData(b.data)};this.ws.onerror=function(b){c.onError("websocket error",
b)}};"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(d.prototype.onData=function(c){var b=this;setTimeout(function(){h.prototype.onData.call(b,c)},0)});d.prototype.write=function(c){var b=this;this.writable=!1;for(var d=0,e=c.length;d<e;d++)m.encodePacket(c[d],this.supportsBinary,function(c){try{b.ws.send(c)}catch(jc){v("websocket closed before onclose event")}});setTimeout(function(){b.writable=!0;b.emit("drain")},0)};d.prototype.onClose=function(){h.prototype.onClose.call(this)};
d.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()};d.prototype.uri=function(){var c=this.query||{},b=this.secure?"wss":"ws",d="";this.port&&("wss"==b&&443!=this.port||"ws"==b&&80!=this.port)&&(d=":"+this.port);this.timestampRequests&&(c[this.timestampParam]=+new Date);this.supportsBinary||(c.b64=1);c=n.encode(c);c.length&&(c="?"+c);return b+"://"+this.hostname+d+this.path+c};d.prototype.check=function(){return!!q&&!("__initialize"in q&&this.name===d.prototype.name)}},{"../transport":14,
"component-inherit":9,debug:21,"engine.io-parser":24,parseqs:41,ws:66}],20:[function(c,b,e){var d=c("has-cors");b.exports=function(c){var b=c.xdomain,e=c.xscheme;c=c.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!b||d))return new XMLHttpRequest}catch(v){}try{if("undefined"!=typeof XDomainRequest&&!e&&c)return new XDomainRequest}catch(v){}if(!b)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(v){}}},{"has-cors":31}],21:[function(c,b,e){function d(){try{var c=localStorage.debug}catch(m){}return c}
e=b.exports=c("./debug");e.log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)};e.formatArgs=function(){var c=arguments,b=this.useColors;c[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+c[0]+(b?"%c ":" ")+"+"+e.humanize(this.diff);if(!b)return c;b="color: "+this.color;c=[c[0],b,"color: inherit"].concat(Array.prototype.slice.call(c,1));var d=0,f=0;c[0].replace(/%[a-z%]/g,function(c){"%%"!==c&&(d++,"%c"===c&&(f=d))});
c.splice(f,0,b);return c};e.save=function(c){try{null==c?localStorage.removeItem("debug"):localStorage.debug=c}catch(m){}};e.load=d;e.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)};e.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");e.formatters.j=function(c){return JSON.stringify(c)};
e.enable(d())},{"./debug":22}],22:[function(c,b,e){e=b.exports=function(c){function b(){}function f(){var c=+new Date;f.diff=c-(h||c);f.prev=h;h=f.curr=c;null==f.useColors&&(f.useColors=e.useColors());null==f.color&&f.useColors&&(f.color=e.colors[d++%e.colors.length]);var b=Array.prototype.slice.call(arguments);b[0]=e.coerce(b[0]);"string"!==typeof b[0]&&(b=["%o"].concat(b));var m=0;b[0]=b[0].replace(/%([a-z%])/g,function(c,d){if("%%"===c)return c;m++;d=e.formatters[d];"function"===typeof d&&(c=d.call(f,
b[m]),b.splice(m,1),m--);return c});"function"===typeof e.formatArgs&&(b=e.formatArgs.apply(f,b));(f.log||e.log||console.log.bind(console)).apply(f,b)}b.enabled=!1;f.enabled=!0;var m=e.enabled(c)?f:b;m.namespace=c;return m};e.coerce=function(c){return c instanceof Error?c.stack||c.message:c};e.disable=function(){e.enable("")};e.enable=function(c){e.save(c);for(var b=(c||"").split(/[\s,]+/),d=b.length,f=0;f<d;f++)b[f]&&(c=b[f].replace(/\*/g,".*?"),"-"===c[0]?e.skips.push(new RegExp("^"+c.substr(1)+
"$")):e.names.push(new RegExp("^"+c+"$")))};e.enabled=function(c){var b;var d=0;for(b=e.skips.length;d<b;d++)if(e.skips[d].test(c))return!1;d=0;for(b=e.names.length;d<b;d++)if(e.names[d].test(c))return!0;return!1};e.humanize=c("ms");e.names=[];e.skips=[];e.formatters={};var d=0,h},{ms:38}],23:[function(c,b,e){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
h="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");b.exports=function(c){var b=c,e=c.indexOf("["),f=c.indexOf("]");-1!=e&&-1!=f&&(c=c.substring(0,e)+c.substring(e,f).replace(/:/g,";")+c.substring(f,c.length));c=d.exec(c||"");for(var m={},u=14;u--;)m[h[u]]=c[u]||"";-1!=e&&-1!=f&&(m.source=b,m.host=m.host.substring(1,m.host.length-1).replace(/;/g,":"),m.authority=m.authority.replace("[","").replace("]","").replace(/;/g,":"),m.ipv6uri=
!0);return m}},{}],24:[function(c,b,e){(function(b){function d(c,b,d){if(!b)return e.encodeBase64Packet(c,d);var f=new FileReader;f.onload=function(){c.data=f.result;e.encodePacket(c,b,!0,d)};return f.readAsArrayBuffer(c.data)}function f(c,b,d){var e=Array(c.length);d=u(c.length,d);for(var f=function(c,d,f){b(d,function(b,d){e[c]=d;f(b,e)})},h=0;h<c.length;h++)f(h,c[h],d)}var n=c("./keys"),v=c("has-binary"),q=c("arraybuffer.slice"),p=c("base64-arraybuffer"),u=c("after"),y=c("utf8"),Na=navigator.userAgent.match(/Android/i),
k=/PhantomJS/i.test(navigator.userAgent),l=Na||k;e.protocol=3;var wa=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},r=n(wa),ma={type:"error",data:"parser error"},da=c("blob");e.encodePacket=function(c,f,h,m){"function"==typeof f&&(m=f,f=!1);"function"==typeof h&&(m=h,h=null);var n=void 0===c.data?void 0:c.data.buffer||c.data;if(b.ArrayBuffer&&n instanceof ArrayBuffer){if(f){h=c.data;f=new Uint8Array(h);h=new Uint8Array(1+h.byteLength);h[0]=wa[c.type];for(c=0;c<f.length;c++)h[c+
1]=f[c];c=m(h.buffer)}else c=e.encodeBase64Packet(c,m);return c}if(da&&n instanceof b.Blob)return f?l?c=d(c,f,m):(f=new Uint8Array(1),f[0]=wa[c.type],c=new da([f.buffer,c.data]),c=m(c)):c=e.encodeBase64Packet(c,m),c;if(n&&n.base64)return m("b"+e.packets[c.type]+c.data.data);f=wa[c.type];void 0!==c.data&&(f+=h?y.encode(String(c.data)):String(c.data));return m(""+f)};e.encodeBase64Packet=function(c,d){var f="b"+e.packets[c.type];if(da&&c.data instanceof da){var h=new FileReader;h.onload=function(){var c=
h.result.split(",")[1];d(f+c)};return h.readAsDataURL(c.data)}try{var m=String.fromCharCode.apply(null,new Uint8Array(c.data))}catch(om){c=new Uint8Array(c.data);m=Array(c.length);for(var n=0;n<c.length;n++)m[n]=c[n];m=String.fromCharCode.apply(null,m)}f+=b.btoa(m);return d(f)};e.decodePacket=function(c,b,d){if("string"==typeof c||void 0===c){if("b"==c.charAt(0))return e.decodeBase64Packet(c.substr(1),b);if(d)try{c=y.decode(c)}catch(nm){return ma}d=c.charAt(0);return Number(d)==d&&r[d]?1<c.length?
{type:r[d],data:c.substring(1)}:{type:r[d]}:ma}d=(new Uint8Array(c))[0];c=q(c,1);da&&"blob"===b&&(c=new da([c]));return{type:r[d],data:c}};e.decodeBase64Packet=function(c,d){var e=r[c.charAt(0)];if(!b.ArrayBuffer)return{type:e,data:{base64:!0,data:c.substr(1)}};c=p.decode(c.substr(1));"blob"===d&&da&&(c=new da([c]));return{type:e,data:c}};e.encodePayload=function(c,b,d){"function"==typeof b&&(d=b,b=null);var h=v(c);if(b&&h)return da&&!l?e.encodePayloadAsBlob(c,d):e.encodePayloadAsArrayBuffer(c,d);
if(!c.length)return d("0:");f(c,function(c,d){e.encodePacket(c,h?b:!1,!0,function(c){d(null,c.length+":"+c)})},function(c,b){return d(b.join(""))})};e.decodePayload=function(c,b,d){if("string"!=typeof c)return e.decodePayloadAsBinary(c,b,d);"function"===typeof b&&(d=b,b=null);if(""==c)return d(ma,0,1);var f="";for(var h,m,n=0,v=c.length;n<v;n++)if(m=c.charAt(n),":"!=m)f+=m;else{if(""==f||f!=(h=Number(f)))return d(ma,0,1);m=c.substr(n+1,h);if(f!=m.length)return d(ma,0,1);if(m.length){f=e.decodePacket(m,
b,!0);if(ma.type==f.type&&ma.data==f.data)return d(ma,0,1);if(!1===d(f,n+h,v))return}n+=h;f=""}if(""!=f)return d(ma,0,1)};e.encodePayloadAsArrayBuffer=function(c,b){if(!c.length)return b(new ArrayBuffer(0));f(c,function(c,b){e.encodePacket(c,!0,!0,function(c){return b(null,c)})},function(c,d){c=d.reduce(function(c,b){b="string"===typeof b?b.length:b.byteLength;return c+b.toString().length+b+2},0);var f=new Uint8Array(c),e=0;d.forEach(function(c){var b="string"===typeof c,d=c;if(b){d=new Uint8Array(c.length);
for(var h=0;h<c.length;h++)d[h]=c.charCodeAt(h);d=d.buffer}b?f[e++]=0:f[e++]=1;c=d.byteLength.toString();for(h=0;h<c.length;h++)f[e++]=parseInt(c[h]);f[e++]=255;d=new Uint8Array(d);for(h=0;h<d.length;h++)f[e++]=d[h]});return b(f.buffer)})};e.encodePayloadAsBlob=function(c,b){f(c,function(c,b){e.encodePacket(c,!0,!0,function(c){var d=new Uint8Array(1);d[0]=1;if("string"===typeof c){for(var f=new Uint8Array(c.length),e=0;e<c.length;e++)f[e]=c.charCodeAt(e);c=f.buffer;d[0]=0}f=(c instanceof ArrayBuffer?
c.byteLength:c.size).toString();var h=new Uint8Array(f.length+1);for(e=0;e<f.length;e++)h[e]=parseInt(f[e]);h[f.length]=255;da&&(c=new da([d.buffer,h.buffer,c]),b(null,c))})},function(c,d){return b(new da(d))})};e.decodePayloadAsBinary=function(c,b,d){"function"===typeof b&&(d=b,b=null);for(var f=[],h=!1;0<c.byteLength;){for(var m=new Uint8Array(c),n=0===m[0],v="",p=1;255!=m[p];p++){if(310<v.length){h=!0;break}v+=m[p]}if(h)return d(ma,0,1);c=q(c,2+v.length);v=parseInt(v);m=q(c,0,v);if(n)try{m=String.fromCharCode.apply(null,
new Uint8Array(m))}catch(pm){for(n=new Uint8Array(m),m="",p=0;p<n.length;p++)m+=String.fromCharCode(n[p])}f.push(m);c=q(c,v)}var u=f.length;f.forEach(function(c,f){d(e.decodePacket(c,b,!0),f,u)})}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./keys":25,after:1,"arraybuffer.slice":2,"base64-arraybuffer":5,blob:6,"has-binary":30,utf8:60}],25:[function(c,b,e){b.exports=Object.keys||function(c){var b=[],d=Object.prototype.hasOwnProperty,
f;for(f in c)d.call(c,f)&&b.push(f);return b}},{}],26:[function(c,b,e){function d(c){m.call(this);c=c||{};this.config={chunksize:16384,pacing:0};for(var b in c)this.config[b]=c[b];this.channel=this.file=null}function h(){m.call(this);this.receiveBuffer=[];this.received=0;this.metadata={};this.channel=null}var m=c("wildemitter");c=c("util");c.inherits(d,m);d.prototype.send=function(c,b){var d=this;this.file=c;this.channel=b;var f="number"!==typeof b.bufferedAmountLowThreshold,e=0,h=function(){var m=
new window.FileReader;m.onload=function(){return function(m){d.channel.send(m.target.result);d.emit("progress",e,c.size,m.target.result);c.size>e+m.target.result.byteLength?f?window.setTimeout(h,d.config.pacing):b.bufferedAmount<=b.bufferedAmountLowThreshold&&window.setTimeout(h,0):(d.emit("progress",c.size,c.size,null),d.emit("sentFile"));e+=d.config.chunksize}}(c);var n=c.slice(e,e+d.config.chunksize);m.readAsArrayBuffer(n)};f||(b.bufferedAmountLowThreshold=8*this.config.chunksize,b.addEventListener("bufferedamountlow",
h));window.setTimeout(h,0)};c.inherits(h,m);h.prototype.receive=function(c,b){var d=this;c&&(this.metadata=c);this.channel=b;b.binaryType="arraybuffer";this.channel.onmessage=function(c){d.received+=c.data.byteLength;d.receiveBuffer.push(c.data);d.emit("progress",d.received,d.metadata.size,c.data);d.received===d.metadata.size?(d.emit("receivedFile",new window.Blob(d.receiveBuffer),d.metadata),d.receiveBuffer=[]):d.received>d.metadata.size&&(console.error("received more than expected, discarding..."),
d.receiveBuffer=[])}};b.exports={};b.exports.support="undefined"!==typeof window&&window&&window.File&&window.FileReader&&window.Blob;b.exports.Sender=d;b.exports.Receiver=h},{util:63,wildemitter:65}],27:[function(c,b,e){var d={};b.exports=function(c,b){var e=2===arguments.length,f=e?b:c;if("undefined"===typeof window||"http:"===window.location.protocol){var h=Error("NavigatorUserMediaError");h.name="HTTPS_REQUIRED";return f(h)}if(window.navigator.userAgent.match("Chrome")){var m=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],
10),u=33,y=!window.chrome.webstore;window.navigator.userAgent.match("Linux")&&(u=35);sessionStorage.getScreenMediaJSExtensionId?chrome.runtime.sendMessage(sessionStorage.getScreenMediaJSExtensionId,{type:"getScreen",id:1},null,function(b){b&&""!==b.sourceId?(c=e&&c||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3}}},c.video.mandatory.chromeMediaSourceId=b.sourceId,window.navigator.mediaDevices.getUserMedia(c).then(function(c){f(null,
c)}).catch(function(c){f(c)})):(b=Error("NavigatorUserMediaError"),b.name="NotAllowedError",f(b))}):window.cefGetScreenMedia?window.cefGetScreenMedia(function(b){b?(c=e&&c||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},c.video.mandatory.chromeMediaSourceId=b,window.navigator.mediaDevices.getUserMedia(c).then(function(c){f(null,c)}).catch(function(c){f(c)})):
(b=Error("cefGetScreenMediaError"),b.name="CEF_GETSCREENMEDIA_CANCELED",f(b))}):y||26<=m&&m<=u?(c=e&&c||{video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3,chromeMediaSource:"screen"}}},window.navigator.mediaDevices.getUserMedia(c).then(function(c){f(null,c)}).catch(function(c){f(c)})):(m=window.setTimeout(function(){h=Error("NavigatorUserMediaError");h.name="EXTENSION_UNAVAILABLE";return f(h)},1E3),d[m]=[f,e?c:null],window.postMessage({type:"getScreen",
id:m},"*"))}else window.navigator.userAgent.match("Firefox")&&(33<=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10)?(c=e&&c||{video:{mozMediaSource:"window",mediaSource:"window"}},window.navigator.mediaDevices.getUserMedia(c).then(function(c){f(null,c);var b=c.currentTime,d=window.setInterval(function(){c||window.clearInterval(d);if(c.currentTime==b&&(window.clearInterval(d),c.onended))c.onended();b=c.currentTime},500)}).catch(function(c){f(c)})):(h=Error("NavigatorUserMediaError"),
h.name="EXTENSION_UNAVAILABLE"))};"undefined"!==typeof window&&window.addEventListener("message",function(c){if(c.origin==window.location.origin)if("gotScreen"==c.data.type&&d[c.data.id]){var b=d[c.data.id],f=b[1],e=b[0];delete d[c.data.id];""===c.data.sourceId?(c=Error("NavigatorUserMediaError"),c.name="NotAllowedError",e(c)):(f=f||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},
f.video.mandatory.chromeMediaSourceId=c.data.sourceId,window.navigator.mediaDevices.getUserMedia(f).then(function(c){e(null,c)}).catch(function(c){e(c)}))}else"getScreenPending"==c.data.type&&window.clearTimeout(c.data.id)})},{}],28:[function(c,b,e){b.exports=function(){return this}()},{}],29:[function(c,b,e){var d=c("wildemitter"),h;"undefined"!==typeof window&&(h=window.AudioContext||window.webkitAudioContext);var m=null;b.exports=function(c,b){var f=new d;if(!h)return f;b=b||{};var e=b.smoothing||
.1,n=b.interval||50,v=b.threshold,Na=b.play;b=b.history||10;var k=!0;m||(m=new h);var l=m.createAnalyser();l.fftSize=512;l.smoothingTimeConstant=e;var wa=new Float32Array(l.frequencyBinCount);c.jquery&&(c=c[0]);if(c instanceof HTMLAudioElement||c instanceof HTMLVideoElement){var r=m.createMediaElementSource(c);"undefined"===typeof Na&&(Na=!0)}else r=m.createMediaStreamSource(c);v=v||-50;r.connect(l);Na&&l.connect(m.destination);f.speaking=!1;f.setThreshold=function(c){v=c};f.setInterval=function(c){n=
c};f.stop=function(){k=!1;f.emit("volume_change",-100,v);f.speaking&&(f.speaking=!1,f.emit("stopped_speaking"));l.disconnect();r.disconnect()};f.speakingHistory=[];for(c=0;c<b;c++)f.speakingHistory.push(0);var ma=function(){setTimeout(function(){if(k){var c=-Infinity;l.getFloatFrequencyData(wa);for(var b=4,d=wa.length;b<d;b++)wa[b]>c&&0>wa[b]&&(c=wa[b]);f.emit("volume_change",c,v);b=0;if(c>v&&!f.speaking){for(d=f.speakingHistory.length-3;d<f.speakingHistory.length;d++)b+=f.speakingHistory[d];2<=b&&
(f.speaking=!0,f.emit("speaking"))}else if(c<v&&f.speaking){for(d=0;d<f.speakingHistory.length;d++)b+=f.speakingHistory[d];0==b&&(f.speaking=!1,f.emit("stopped_speaking"))}f.speakingHistory.shift();f.speakingHistory.push(0+(c>v));ma()}},n)};ma();return f}},{wildemitter:65}],30:[function(c,b,e){(function(d){var f=c("isarray");b.exports=function(c){function b(c){if(!c)return!1;if(d.Buffer&&d.Buffer.isBuffer(c)||d.ArrayBuffer&&c instanceof ArrayBuffer||d.Blob&&c instanceof Blob||d.File&&c instanceof
File)return!0;if(f(c))for(var e=0;e<c.length;e++){if(b(c[e]))return!0}else if(c&&"object"==typeof c)for(e in c.toJSON&&(c=c.toJSON()),c)if(Object.prototype.hasOwnProperty.call(c,e)&&b(c[e]))return!0;return!1}return b(c)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{isarray:33}],31:[function(c,b,e){c=c("global");try{b.exports="XMLHttpRequest"in c&&"withCredentials"in new c.XMLHttpRequest}catch(f){b.exports=!1}},{global:28}],
32:[function(c,b,e){var d=[].indexOf;b.exports=function(c,b){if(d)return c.indexOf(b);for(var f=0;f<c.length;++f)if(c[f]===b)return f;return-1}},{}],33:[function(c,b,e){b.exports=Array.isArray||function(c){return"[object Array]"==Object.prototype.toString.call(c)}},{}],34:[function(c,b,e){(function(c){function b(c){if(b[c]!==v)return b[c];if("bug-string-char-index"==c)var f=!1;else if("json"==c)f=b("json-stringify")&&b("json-parse");else{var e;if("json-stringify"==c){f=p.stringify;var h="function"==
typeof f&&u;if(h){(e=function(){return 1}).toJSON=e;try{h="0"===f(0)&&"0"===f(new Number)&&'""'==f(new String)&&f(d)===v&&f(v)===v&&f()===v&&"1"===f(e)&&"[1]"==f([e])&&"[null]"==f([v])&&"null"==f(null)&&"[null,null,null]"==f([v,d,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==f({a:[e,!0,!1,null,"\x00\b\n\f\r\t"]})&&"1"===f(null,e)&&"[\n 1,\n 2\n]"==f([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==f(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==f(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==
f(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==f(new Date(-1))}catch(Te){h=!1}}f=h}if("json-parse"==c){f=p.parse;if("function"==typeof f)try{if(0===f("0")&&!f(!1)){e=f('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var m=5==e.a.length&&1===e.a[0];if(m){try{m=!f('"\t"')}catch(Te){}if(m)try{m=1!==f("01")}catch(Te){}if(m)try{m=1!==f("1.")}catch(Te){}}}}catch(Te){m=!1}f=m}}return b[c]=!!f}var d={}.toString,f,v,q="object"==typeof JSON&&JSON,p="object"==typeof e&&e&&!e.nodeType&&e;p&&q?
(p.stringify=q.stringify,p.parse=q.parse):p=c.JSON=q||{};var u=new Date(-0xc782b5b800cec);try{u=-109252==u.getUTCFullYear()&&0===u.getUTCMonth()&&1===u.getUTCDate()&&10==u.getUTCHours()&&37==u.getUTCMinutes()&&6==u.getUTCSeconds()&&708==u.getUTCMilliseconds()}catch(qm){}if(!b("json")){var y=b("bug-string-char-index");if(!u)var k=Math.floor,l=[0,31,59,90,120,151,181,212,243,273,304,334],jc=function(c,b){return l[b]+365*(c-1970)+k((c-1969+(b=+(1<b)))/4)-k((c-1901+b)/100)+k((c-1601+b)/400)};(f={}.hasOwnProperty)||
(f=function(c){var b={};if((b.__proto__=null,b.__proto__={toString:1},b).toString!=d)f=function(c){var b=this.__proto__;c=c in(this.__proto__=null,this);this.__proto__=b;return c};else{var e=b.constructor;f=function(c){var b=(this.constructor||e).prototype;return c in this&&!(c in b&&this[c]===b[c])}}b=null;return f.call(this,c)});var r={"boolean":1,number:1,string:1,undefined:1};var t=function(c,b){var e=0,h,m;(h=function(){this.valueOf=0}).prototype.valueOf=0;var n=new h;for(m in n)f.call(n,m)&&
e++;h=n=null;e?t=2==e?function(c,b){var e={},h="[object Function]"==d.call(c),m;for(m in c)h&&"prototype"==m||f.call(e,m)||!(e[m]=1)||!f.call(c,m)||b(m)}:function(c,b){var e="[object Function]"==d.call(c),h,m;for(h in c)e&&"prototype"==h||!f.call(c,h)||(m="constructor"===h)||b(h);(m||f.call(c,h="constructor"))&&b(h)}:(n="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),t=function(c,b){var e="[object Function]"==d.call(c),h,m;if(m=!e&&"function"!=
typeof c.constructor)m=typeof c.hasOwnProperty,m="object"==m?!!c.hasOwnProperty:!r[m];m=m?c.hasOwnProperty:f;for(h in c)e&&"prototype"==h||!m.call(c,h)||b(h);for(e=n.length;h=n[--e];m.call(c,h)&&b(h));});return t(c,b)};if(!b("json-stringify")){var ma={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},da=function(c,b){return("000000"+(b||0)).slice(-c)},A=function(c){var b='"',d=0,f=c.length,e=10<f&&y,h;for(e&&(h=c.split(""));d<f;d++){var m=c.charCodeAt(d);switch(m){case 8:case 9:case 10:case 12:case 13:case 34:case 92:b+=
ma[m];break;default:b=32>m?b+("\\u00"+da(2,m.toString(16))):b+(e?h[d]:y?c.charAt(d):c[d])}}return b+'"'},x=function(c,b,e,h,m,n,q){var p;try{var u=b[c]}catch(sm){}if("object"==typeof u&&u){var y=d.call(u);if("[object Date]"!=y||f.call(u,"toJSON"))"function"==typeof u.toJSON&&("[object Number]"!=y&&"[object String]"!=y&&"[object Array]"!=y||f.call(u,"toJSON"))&&(u=u.toJSON(c));else if(u>-1/0&&u<1/0){if(jc){var Na=k(u/864E5);for(y=k(Na/365.2425)+1970-1;jc(y+1,0)<=Na;y++);for(p=k((Na-jc(y,0))/30.42);jc(y,
p+1)<=Na;p++);Na=1+Na-jc(y,p);var l=(u%864E5+864E5)%864E5;var id=k(l/36E5)%24;var r=k(l/6E4)%60;var wa=k(l/1E3)%60;l%=1E3}else y=u.getUTCFullYear(),p=u.getUTCMonth(),Na=u.getUTCDate(),id=u.getUTCHours(),r=u.getUTCMinutes(),wa=u.getUTCSeconds(),l=u.getUTCMilliseconds();u=(0>=y||1E4<=y?(0>y?"-":"+")+da(6,0>y?-y:y):da(4,y))+"-"+da(2,p+1)+"-"+da(2,Na)+"T"+da(2,id)+":"+da(2,r)+":"+da(2,wa)+"."+da(3,l)+"Z"}else u=null}e&&(u=e.call(b,c,u));if(null===u)return"null";y=d.call(u);if("[object Boolean]"==y)return""+
u;if("[object Number]"==y)return u>-1/0&&u<1/0?""+u:"null";if("[object String]"==y)return A(""+u);if("object"==typeof u){for(c=q.length;c--;)if(q[c]===u)throw TypeError();q.push(u);var ma=[];b=n;n+=m;if("[object Array]"==y){p=0;for(c=u.length;p<c;p++)y=x(p,u,e,h,m,n,q),ma.push(y===v?"null":y);c=ma.length?m?"[\n"+n+ma.join(",\n"+n)+"\n"+b+"]":"["+ma.join(",")+"]":"[]"}else t(h||u,function(c){var b=x(c,u,e,h,m,n,q);b!==v&&ma.push(A(c)+":"+(m?" ":"")+b)}),c=ma.length?m?"{\n"+n+ma.join(",\n"+n)+"\n"+
b+"}":"{"+ma.join(",")+"}":"{}";q.pop();return c}};p.stringify=function(c,b,f){var e;if("function"==typeof b||"object"==typeof b&&b)if("[object Function]"==(e=d.call(b)))var h=b;else if("[object Array]"==e){var m={};for(var n=0,v=b.length,q;n<v;q=b[n++],(e=d.call(q),"[object String]"==e||"[object Number]"==e)&&(m[q]=1));}if(f)if("[object Number]"==(e=d.call(f))){if(0<(f-=f%1)){var p="";for(10<f&&(f=10);p.length<f;p+=" ");}}else"[object String]"==e&&(p=10>=f.length?f:f.slice(0,10));return x("",(q=
{},q[""]=c,q),h,m,p,"",[])}}if(!b("json-parse")){var z=String.fromCharCode,B={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},w,E,C=function(){w=E=null;throw SyntaxError();},F=function(){for(var c=E,b=c.length,d,f,e,h,m;w<b;)switch(m=c.charCodeAt(w),m){case 9:case 10:case 13:case 32:w++;break;case 123:case 125:case 91:case 93:case 58:case 44:return d=y?c.charAt(w):c[w],w++,d;case 34:d="@";for(w++;w<b;)if(m=c.charCodeAt(w),32>m)C();else if(92==m)switch(m=c.charCodeAt(++w),m){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:d+=
B[m];w++;break;case 117:f=++w;for(e=w+4;w<e;w++)m=c.charCodeAt(w),48<=m&&57>=m||97<=m&&102>=m||65<=m&&70>=m||C();d+=z("0x"+c.slice(f,w));break;default:C()}else{if(34==m)break;m=c.charCodeAt(w);for(f=w;32<=m&&92!=m&&34!=m;)m=c.charCodeAt(++w);d+=c.slice(f,w)}if(34==c.charCodeAt(w))return w++,d;C();default:f=w;45==m&&(h=!0,m=c.charCodeAt(++w));if(48<=m&&57>=m){for(48==m&&(m=c.charCodeAt(w+1),48<=m&&57>=m)&&C();w<b&&(m=c.charCodeAt(w),48<=m&&57>=m);w++);if(46==c.charCodeAt(w)){for(e=++w;e<b&&(m=c.charCodeAt(e),
48<=m&&57>=m);e++);e==w&&C();w=e}m=c.charCodeAt(w);if(101==m||69==m){m=c.charCodeAt(++w);43!=m&&45!=m||w++;for(e=w;e<b&&(m=c.charCodeAt(e),48<=m&&57>=m);e++);e==w&&C();w=e}return+c.slice(f,w)}h&&C();if("true"==c.slice(w,w+4))return w+=4,!0;if("false"==c.slice(w,w+5))return w+=5,!1;if("null"==c.slice(w,w+4))return w+=4,null;C()}return"$"},D=function(c){var b,d;"$"==c&&C();if("string"==typeof c){if("@"==(y?c.charAt(0):c[0]))return c.slice(1);if("["==c){for(b=[];;d||(d=!0)){c=F();if("]"==c)break;d&&
(","==c?(c=F(),"]"==c&&C()):C());","==c&&C();b.push(D(c))}return b}if("{"==c){for(b={};;d||(d=!0)){c=F();if("}"==c)break;d&&(","==c?(c=F(),"}"==c&&C()):C());","!=c&&"string"==typeof c&&"@"==(y?c.charAt(0):c[0])&&":"==F()||C();b[c.slice(1)]=D(F())}return b}C()}return c},H=function(c,b,d){d=G(c,b,d);d===v?delete c[b]:c[b]=d},G=function(c,b,f){var e=c[b],h;if("object"==typeof e&&e)if("[object Array]"==d.call(e))for(h=e.length;h--;)H(e,h,f);else t(e,function(c){H(e,c,f)});return f.call(c,b,e)};p.parse=
function(c,b){var f;w=0;E=""+c;c=D(F());"$"!=F()&&C();w=E=null;return b&&"[object Function]"==d.call(b)?G((f={},f[""]=c,f),"",b):c}}}})(this)},{}],35:[function(c,b,e){function d(c){var b=!0;c.getTracks().forEach(function(c){b="ended"===c.readyState&&b});return b}function h(){if("undefined"===typeof window||!window.navigator.mozGetUserMedia)return!1;var c=window.navigator.userAgent.match(/Firefox\/(\d+)\./);return 50>(c&&1<=c.length&&parseInt(c[1],10))}function m(c){q.call(this);var b=this.config=
{detectSpeakingEvents:!1,audioFallback:!1,media:{audio:!0,video:!0},harkOptions:null,logger:p},d;for(d in c)c.hasOwnProperty(d)&&(this.config[d]=c[d]);this.logger=b.logger;this._log=this.logger.log.bind(this.logger,"LocalMedia:");this._logerror=this.logger.error.bind(this.logger,"LocalMedia:");this.localStreams=[];this.localScreens=[];navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||this._logerror("Your browser does not support local media capture.");this._audioMonitors=[];this.on("localStreamStopped",
this._stopAudioMonitor.bind(this));this.on("localScreenStopped",this._stopAudioMonitor.bind(this))}e=c("util");var n=c("hark"),v=c("getscreenmedia"),q=c("wildemitter"),p=c("mockconsole");e.inherits(m,q);m.prototype.start=function(c,b){var f=this,e=c||this.config.media;this.emit("localStreamRequested",e);navigator.mediaDevices.getUserMedia(e).then(function(c){e.audio&&f.config.detectSpeakingEvents&&f._setupAudioMonitor(c,f.config.harkOptions);f.localStreams.push(c);c.getTracks().forEach(function(b){b.addEventListener("ended",
function(){d(c)&&f._removeStream(c)})});f.emit("localStream",c);if(b)return b(null,c)}).catch(function(c){if(f.config.audioFallback&&"NotFoundError"===c.name&&!1!==e.video)e.video=!1,f.start(e,b);else if(f.emit("localStreamRequestFailed",e),b)return b(c,null)})};m.prototype.stop=function(c){this.stopStream(c);this.stopScreenShare(c)};m.prototype.stopStream=function(c){var b=this;c?-1<this.localStreams.indexOf(c)&&(c.getTracks().forEach(function(c){c.stop()}),h()&&this._removeStream(c)):this.localStreams.forEach(function(c){c.getTracks().forEach(function(c){c.stop()});
h()&&b._removeStream(c)})};m.prototype.startScreenShare=function(c,b){var d=this;this.emit("localScreenRequested");"function"!==typeof c||b||(b=c,c=null);v(c,function(c,f){c?d.emit("localScreenRequestFailed"):(d.localScreens.push(f),f.getTracks().forEach(function(c){c.addEventListener("ended",function(){var c=!0;f.getTracks().forEach(function(b){c="ended"===b.readyState&&c});c&&d._removeStream(f)})}),d.emit("localScreen",f));if(b)return b(c,f)})};m.prototype.stopScreenShare=function(c){var b=this;
c?-1<this.localScreens.indexOf(c)&&(c.getTracks().forEach(function(c){c.stop()}),h()&&this._removeStream(c)):this.localScreens.forEach(function(c){c.getTracks().forEach(function(c){c.stop()});h()&&b._removeStream(c)})};m.prototype.mute=function(){this._audioEnabled(!1);this.emit("audioOff")};m.prototype.unmute=function(){this._audioEnabled(!0);this.emit("audioOn")};m.prototype.pauseVideo=function(){this._videoEnabled(!1);this.emit("videoOff")};m.prototype.resumeVideo=function(){this._videoEnabled(!0);
this.emit("videoOn")};m.prototype.pause=function(){this.mute();this.pauseVideo()};m.prototype.resume=function(){this.unmute();this.resumeVideo()};m.prototype._audioEnabled=function(c){this.localStreams.forEach(function(b){b.getAudioTracks().forEach(function(b){b.enabled=!!c})})};m.prototype._videoEnabled=function(c){this.localStreams.forEach(function(b){b.getVideoTracks().forEach(function(b){b.enabled=!!c})})};m.prototype.isAudioEnabled=function(){var c=!0;this.localStreams.forEach(function(b){b.getAudioTracks().forEach(function(b){c=
c&&b.enabled})});return c};m.prototype.isVideoEnabled=function(){var c=!0;this.localStreams.forEach(function(b){b.getVideoTracks().forEach(function(b){c=c&&b.enabled})});return c};m.prototype._removeStream=function(c){var b=this.localStreams.indexOf(c);-1<b?(this.localStreams.splice(b,1),this.emit("localStreamStopped",c)):(b=this.localScreens.indexOf(c),-1<b&&(this.localScreens.splice(b,1),this.emit("localScreenStopped",c)))};m.prototype._setupAudioMonitor=function(c,b){this._log("Setup audio");b=
n(c,b);var d=this,f;b.on("speaking",function(){d.emit("speaking")});b.on("stopped_speaking",function(){f&&clearTimeout(f);f=setTimeout(function(){d.emit("stoppedSpeaking")},1E3)});b.on("volume_change",function(c,b){d.emit("volumeChange",c,b)});this._audioMonitors.push({audio:b,stream:c})};m.prototype._stopAudioMonitor=function(c){var b=-1;this._audioMonitors.forEach(function(d,f){d.stream===c&&(b=f)});-1<b&&(this._audioMonitors[b].audio.stop(),this._audioMonitors.splice(b,1))};b.exports=m},{getscreenmedia:27,
hark:29,mockconsole:37,util:63,wildemitter:65}],36:[function(c,b,e){(function(c){function d(c,b){c.set(b[0],b[1]);return c}function f(c,b){c.add(b);return c}function n(c,b){for(var d=-1,f=c?c.length:0;++d<f&&!1!==b(c[d],d,c););return c}function v(c,b,d,f){var e=-1,h=c?c.length:0;for(f&&h&&(d=c[++e]);++e<h;)d=b(d,c[e],e,c);return d}function q(c){var b=!1;if(null!=c&&"function"!=typeof c.toString)try{b=!!(c+"")}catch(cb){}return b}function p(c){var b=-1,d=Array(c.size);c.forEach(function(c,f){d[++b]=
[f,c]});return d}function u(c,b){return function(d){return c(b(d))}}function y(c){var b=-1,d=Array(c.size);c.forEach(function(c){d[++b]=c});return d}function k(c){var b=-1,d=c?c.length:0;for(this.clear();++b<d;){var f=c[b];this.set(f[0],f[1])}}function l(c){var b=-1,d=c?c.length:0;for(this.clear();++b<d;){var f=c[b];this.set(f[0],f[1])}}function r(c){var b=-1,d=c?c.length:0;for(this.clear();++b<d;){var f=c[b];this.set(f[0],f[1])}}function wa(c){this.__data__=new l(c)}function t(c,b,d){var f=c[b];
J.call(c,b)&&(f===d||f!==f&&d!==d)&&(void 0!==d||b in c)||(c[b]=d)}function ma(c,b){for(var d=c.length;d--;){var f=c[d][0];if(f===b||f!==f&&b!==b)return d}return-1}function da(c,b){return c&&E(b,O(b),c)}function w(c,b,d,f,e,h,m){var v;f&&(v=h?f(c,e,h,m):f(c));if(void 0!==v)return v;if(!P(c))return c;if(e=Ja(c)){if(v=H(c),!b)return B(c,v)}else{var p=qa(c),u="[object Function]"==p||"[object GeneratorFunction]"==p;if(Ta(c))return x(c,b);if("[object Object]"==p||"[object Arguments]"==p||u&&!h){if(q(c))return h?
c:{};v=G(u?{}:c);if(!b)return C(c,da(v,c))}else{if(!I[p])return h?c:{};v=K(c,p,w,b)}}m||(m=new wa);if(h=m.get(c))return h;m.set(c,v);if(!e)var y=d?A(c,O,Fa):O(c);n(y||c,function(e,h){y&&(h=e,e=c[h]);t(v,h,w(e,b,d,f,h,c,m))});return v}function A(c,b,d){b=b(c);if(!Ja(c)){c=d(c);d=-1;for(var f=c.length,e=b.length;++d<f;)b[e+d]=c[d]}return b}function x(c,b){if(b)return c.slice();b=new c.constructor(c.length);c.copy(b);return b}function z(c){var b=new c.constructor(c.byteLength);(new fa(b)).set(new fa(c));
return b}function B(c,b){var d=-1,f=c.length;for(b||(b=Array(f));++d<f;)b[d]=c[d];return b}function E(c,b,d,f){d||(d={});for(var e=-1,h=b.length;++e<h;){var m=b[e],n=f?f(d[m],c[m],m,d,c):void 0;t(d,m,void 0===n?c[m]:n)}return d}function C(c,b){return E(c,Fa(c),b)}function F(c,b){c=c.__data__;var d=typeof b;return("string"==d||"number"==d||"symbol"==d||"boolean"==d?"__proto__"!==b:null===b)?c["string"==typeof b?"string":"hash"]:c.map}function D(c,b){c=null==c?void 0:c[b];b=!P(c)||ea&&ea in c?!1:(M(c)||
q(c)?aa:R).test(Lc(c));return b?c:void 0}function H(c){var b=c.length,d=c.constructor(b);b&&"string"==typeof c[0]&&J.call(c,"index")&&(d.index=c.index,d.input=c.input);return d}function G(c){"function"!=typeof c.constructor||vi(c)?c={}:(c=ja(c),c=P(c)?la(c):{});return c}function K(c,b,e,h){var m=c.constructor;switch(b){case "[object ArrayBuffer]":return z(c);case "[object Boolean]":case "[object Date]":return new m(+c);case "[object DataView]":return b=h?z(c.buffer):c.buffer,new c.constructor(b,c.byteOffset,
c.byteLength);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return b=h?z(c.buffer):c.buffer,new c.constructor(b,c.byteOffset,c.length);case "[object Map]":return b=h?e(p(c),!0):p(c),v(b,d,new c.constructor);case "[object Number]":case "[object String]":return new m(c);case "[object RegExp]":return b=
new c.constructor(c.source,Q.exec(c)),b.lastIndex=c.lastIndex,b;case "[object Set]":return b=h?e(y(c),!0):y(c),v(b,f,new c.constructor);case "[object Symbol]":return xa?Object(xa.call(c)):{}}}function vi(c){var b=c&&c.constructor;return c===("function"==typeof b&&b.prototype||V)}function Lc(c){if(null!=c){try{return W.call(c)}catch(Ga){}return c+""}return""}function wi(c){var b;if(b=null!=c)b=c.length,b="number"==typeof b&&-1<b&&0==b%1&&9007199254740991>=b;return b&&!M(c)}function M(c){c=P(c)?ba.call(c):
"";return"[object Function]"==c||"[object GeneratorFunction]"==c}function P(c){var b=typeof c;return!!c&&("object"==b||"function"==b)}function O(c){if(wi(c)){var b;(b=Ja(c))||(b=!!c&&"object"==typeof c&&wi(c)&&J.call(c,"callee")&&(!Z.call(c,"callee")||"[object Arguments]"==ba.call(c)));if(b){b=c.length;for(var d=String,f=-1,e=Array(b);++f<b;)e[f]=d(f);b=e}else b=[];d=b.length;f=!!d;for(var h in c){if(!(e=!J.call(c,h))&&(e=f)&&!(e="length"==h)){e=h;var m=d;m=null==m?9007199254740991:m;e=!!m&&("number"==
typeof e||X.test(e))&&-1<e&&0==e%1&&e<m}e||b.push(h)}c=b}else if(vi(c)){h=[];for(b in Object(c))J.call(c,b)&&"constructor"!=b&&h.push(b);c=h}else c=ra(c);return c}function N(){return[]}function L(){return!1}var Q=/\w*$/,R=/^\[object .+?Constructor\]$/,X=/^(?:0|[1-9]\d*)$/,I={};I["[object Arguments]"]=I["[object Array]"]=I["[object ArrayBuffer]"]=I["[object DataView]"]=I["[object Boolean]"]=I["[object Date]"]=I["[object Float32Array]"]=I["[object Float64Array]"]=I["[object Int8Array]"]=I["[object Int16Array]"]=
I["[object Int32Array]"]=I["[object Map]"]=I["[object Number]"]=I["[object Object]"]=I["[object RegExp]"]=I["[object Set]"]=I["[object String]"]=I["[object Symbol]"]=I["[object Uint8Array]"]=I["[object Uint8ClampedArray]"]=I["[object Uint16Array]"]=I["[object Uint32Array]"]=!0;I["[object Error]"]=I["[object Function]"]=I["[object WeakMap]"]=!1;var U="object"==typeof self&&self&&self.Object===Object&&self;c="object"==typeof c&&c&&c.Object===Object&&c||U||Function("return this")();var S=(U="object"==
typeof e&&e&&!e.nodeType&&e)&&"object"==typeof b&&b&&!b.nodeType&&b;U=S&&S.exports===U;S=Array.prototype;var Y=Function.prototype,V=Object.prototype,T=c["__core-js_shared__"],ea=function(){var c=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),W=Y.toString,J=V.hasOwnProperty,ba=V.toString,aa=RegExp("^"+W.call(J).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");Y=U?c.Buffer:void 0;U=c.Symbol;var fa=c.Uint8Array,
ja=u(Object.getPrototypeOf,Object),la=Object.create,Z=V.propertyIsEnumerable,ka=S.splice;S=Object.getOwnPropertySymbols;Y=Y?Y.isBuffer:void 0;var ra=u(Object.keys,Object),ha=D(c,"DataView"),sa=D(c,"Map"),ca=D(c,"Promise"),oa=D(c,"Set");c=D(c,"WeakMap");var ia=D(Object,"create"),Aa=Lc(ha),Ca=Lc(sa),va=Lc(ca),pa=Lc(oa),za=Lc(c),xa=(U=U?U.prototype:void 0)?U.valueOf:void 0;k.prototype.clear=function(){this.__data__=ia?ia(null):{}};k.prototype["delete"]=function(c){return this.has(c)&&delete this.__data__[c]};
k.prototype.get=function(c){var b=this.__data__;return ia?(c=b[c],"__lodash_hash_undefined__"===c?void 0:c):J.call(b,c)?b[c]:void 0};k.prototype.has=function(c){var b=this.__data__;return ia?void 0!==b[c]:J.call(b,c)};k.prototype.set=function(c,b){this.__data__[c]=ia&&void 0===b?"__lodash_hash_undefined__":b;return this};l.prototype.clear=function(){this.__data__=[]};l.prototype["delete"]=function(c){var b=this.__data__;c=ma(b,c);if(0>c)return!1;c==b.length-1?b.pop():ka.call(b,c,1);return!0};l.prototype.get=
function(c){var b=this.__data__;c=ma(b,c);return 0>c?void 0:b[c][1]};l.prototype.has=function(c){return-1<ma(this.__data__,c)};l.prototype.set=function(c,b){var d=this.__data__,f=ma(d,c);0>f?d.push([c,b]):d[f][1]=b;return this};r.prototype.clear=function(){this.__data__={hash:new k,map:new (sa||l),string:new k}};r.prototype["delete"]=function(c){return F(this,c)["delete"](c)};r.prototype.get=function(c){return F(this,c).get(c)};r.prototype.has=function(c){return F(this,c).has(c)};r.prototype.set=
function(c,b){F(this,c).set(c,b);return this};wa.prototype.clear=function(){this.__data__=new l};wa.prototype["delete"]=function(c){return this.__data__["delete"](c)};wa.prototype.get=function(c){return this.__data__.get(c)};wa.prototype.has=function(c){return this.__data__.has(c)};wa.prototype.set=function(c,b){var d=this.__data__;if(d instanceof l){d=d.__data__;if(!sa||199>d.length)return d.push([c,b]),this;d=this.__data__=new r(d)}d.set(c,b);return this};var Fa=S?u(S,Object):N,qa=function(c){return ba.call(c)};
if(ha&&"[object DataView]"!=qa(new ha(new ArrayBuffer(1)))||sa&&"[object Map]"!=qa(new sa)||ca&&"[object Promise]"!=qa(ca.resolve())||oa&&"[object Set]"!=qa(new oa)||c&&"[object WeakMap]"!=qa(new c))qa=function(c){var b=ba.call(c);if(c=(c="[object Object]"==b?c.constructor:void 0)?Lc(c):void 0)switch(c){case Aa:return"[object DataView]";case Ca:return"[object Map]";case va:return"[object Promise]";case pa:return"[object Set]";case za:return"[object WeakMap]"}return b};var Ja=Array.isArray,Ta=Y||L;
b.exports=function(c){return w(c,!0,!0)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],37:[function(c,b,e){c="assert count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd time timeEnd trace warn".split(" ");e=c.length;for(var d=function(){},h={};e--;)h[c[e]]=d;b.exports=h},{}],38:[function(c,b,e){function d(c){if(c=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(c)){var b=
parseFloat(c[1]);switch((c[2]||"ms").toLowerCase()){case "years":case "year":case "y":return b*m;case "days":case "day":case "d":return 864E5*b;case "hours":case "hour":case "h":return 36E5*b;case "minutes":case "minute":case "m":return 6E4*b;case "seconds":case "second":case "s":return 1E3*b;case "ms":return b}}}function h(c,b,d){if(!(c<b))return c<1.5*b?Math.floor(c/b)+" "+d:Math.ceil(c/b)+" "+d+"s"}var m=315576E5;b.exports=function(c,b){b=b||{};return"string"==typeof c?d(c):b.long?h(c,864E5,"day")||
h(c,36E5,"hour")||h(c,6E4,"minute")||h(c,1E3,"second")||c+" ms":864E5<=c?Math.round(c/864E5)+"d":36E5<=c?Math.round(c/36E5)+"h":6E4<=c?Math.round(c/6E4)+"m":1E3<=c?Math.round(c/1E3)+"s":c+"ms"}},{}],39:[function(c,b,e){var d=Object.prototype.hasOwnProperty;e.keys=Object.keys||function(c){var b=[],f;for(f in c)d.call(c,f)&&b.push(f);return b};e.values=function(c){var b=[],f;for(f in c)d.call(c,f)&&b.push(c[f]);return b};e.merge=function(c,b){for(var f in b)d.call(b,f)&&(c[f]=b[f]);return c};e.length=
function(c){return e.keys(c).length};e.isEmpty=function(c){return 0==e.length(c)}},{}],40:[function(c,b,e){(function(c){var d=/^[\],:{}\s]*$/,f=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,e=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,v=/(?:^|:|,)(?:\s*\[)+/g,q=/^\s+/,p=/\s+$/;b.exports=function(b){if("string"!=typeof b||!b)return null;b=b.replace(q,"").replace(p,"");if(c.JSON&&JSON.parse)return JSON.parse(b);if(d.test(b.replace(f,"@").replace(e,"]").replace(v,"")))return(new Function("return "+
b))()}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],41:[function(c,b,e){e.encode=function(c){var b="",d;for(d in c)c.hasOwnProperty(d)&&(b.length&&(b+="&"),b+=encodeURIComponent(d)+"="+encodeURIComponent(c[d]));return b};e.decode=function(c){var b={};c=c.split("&");for(var d=0,f=c.length;d<f;d++){var e=c[d].split("=");b[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return b}},{}],42:[function(c,b,e){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
h="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");b.exports=function(c){c=d.exec(c||"");for(var b={},f=14;f--;)b[h[f]]=c[f]||"";return b}},{}],43:[function(c,b,e){function d(){throw Error("setTimeout has not been defined");}function h(){throw Error("clearTimeout has not been defined");}function m(c){if(y===setTimeout)return setTimeout(c,0);if((y===d||!y)&&setTimeout)return y=setTimeout,setTimeout(c,0);try{return y(c,0)}catch(da){try{return y.call(null,
c,0)}catch(Hk){return y.call(this,c,0)}}}function n(c){if(k===clearTimeout)return clearTimeout(c);if((k===h||!k)&&clearTimeout)return k=clearTimeout,clearTimeout(c);try{return k(c)}catch(da){try{return k.call(null,c)}catch(Hk){return k.call(this,c)}}}function v(){r&&wa&&(r=!1,wa.length?l=wa.concat(l):t=-1,l.length&&q())}function q(){if(!r){var c=m(v);r=!0;for(var b=l.length;b;){wa=l;for(l=[];++t<b;)wa&&wa[t].run();t=-1;b=l.length}wa=null;r=!1;n(c)}}function p(c,b){this.fun=c;this.array=b}function u(){}
c=b.exports={};try{var y="function"===typeof setTimeout?setTimeout:d}catch(ma){y=d}try{var k="function"===typeof clearTimeout?clearTimeout:h}catch(ma){k=h}var l=[],r=!1,wa,t=-1;c.nextTick=function(c){var b=Array(arguments.length-1);if(1<arguments.length)for(var d=1;d<arguments.length;d++)b[d-1]=arguments[d];l.push(new p(c,b));1!==l.length||r||m(q)};p.prototype.run=function(){this.fun.apply(null,this.array)};c.title="browser";c.browser=!0;c.env={};c.argv=[];c.version="";c.versions={};c.on=u;c.addListener=
u;c.once=u;c.off=u;c.removeListener=u;c.removeAllListeners=u;c.emit=u;c.prependListener=u;c.prependOnceListener=u;c.listeners=function(c){return[]};c.binding=function(c){throw Error("process.binding is not supported");};c.cwd=function(){return"/"};c.chdir=function(c){throw Error("process.chdir is not supported");};c.umask=function(){return 0}},{}],44:[function(c,b,e){function d(c,b){var d=this,e;m.call(this);c=c||{};c.iceServers=c.iceServers||[];this.enableChromeNativeSimulcast=!1;b&&b.optional&&
window.chrome&&null===navigator.appVersion.match(/Chromium\//)&&b.optional.forEach(function(c){c.enableChromeNativeSimulcast&&(d.enableChromeNativeSimulcast=!0)});this.enableMultiStreamHacks=!1;b&&b.optional&&window.chrome&&b.optional.forEach(function(c){c.enableMultiStreamHacks&&(d.enableMultiStreamHacks=!0)});this.restrictBandwidth=0;b&&b.optional&&b.optional.forEach(function(c){c.andyetRestrictBandwidth&&(d.restrictBandwidth=c.andyetRestrictBandwidth)});this.batchIceCandidates=0;b&&b.optional&&
b.optional.forEach(function(c){c.andyetBatchIce&&(d.batchIceCandidates=c.andyetBatchIce)});this.batchedIceCandidates=[];b&&b.optional&&window.chrome&&b.optional.forEach(function(c){c.andyetFasterICE&&(d.eliminateDuplicateCandidates=c.andyetFasterICE)});b&&b.optional&&b.optional.forEach(function(c){c.andyetDontSignalCandidates&&(d.dontSignalCandidates=c.andyetDontSignalCandidates)});this.assumeSetLocalSuccess=!1;b&&b.optional&&b.optional.forEach(function(c){c.andyetAssumeSetLocalSuccess&&(d.assumeSetLocalSuccess=
c.andyetAssumeSetLocalSuccess)});window.navigator.mozGetUserMedia&&b&&b.optional&&(this.wtFirefox=0,b.optional.forEach(function(c){c.andyetFirefoxMakesMeSad&&(d.wtFirefox=c.andyetFirefoxMakesMeSad,0<d.wtFirefox&&(d.firefoxcandidatebuffer=[]))}));this.pc=new RTCPeerConnection(c,b);this.getLocalStreams="function"===typeof this.pc.getLocalStreams?this.pc.getLocalStreams.bind(this.pc):function(){return[]};this.getSenders="function"===typeof this.pc.getSenders?this.pc.getSenders.bind(this.pc):function(){return[]};
this.getRemoteStreams="function"===typeof this.pc.getRemoteStreams?this.pc.getRemoteStreams.bind(this.pc):function(){return[]};this.getReceivers="function"===typeof this.pc.getReceivers?this.pc.getReceivers.bind(this.pc):function(){return[]};this.addStream=this.pc.addStream.bind(this.pc);this.removeStream=function(c){"function"===typeof d.pc.removeStream?d.pc.removeStream.apply(d.pc,arguments):"function"===typeof d.pc.removeTrack&&c.getTracks().forEach(function(c){d.pc.removeTrack(c)})};"function"===
typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc));this.pc.onremovestream=this.emit.bind(this,"removeStream");this.pc.onremovetrack=this.emit.bind(this,"removeTrack");this.pc.onaddstream=this.emit.bind(this,"addStream");this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded");this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange");this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange");this.pc.onicecandidate=this._onIce.bind(this);
this.pc.ondatachannel=this._onDataChannel.bind(this);this.localDescription={contents:[]};this.remoteDescription={contents:[]};this.config={debug:!1,sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1};this.iceCredentials={local:{},remote:{}};for(e in c)this.config[e]=c[e];if(this.config.debug)this.on("*",function(){(c.logger||console).log("PeerConnection event:",arguments)});this.hadRemoteIPv6Candidate=this.hadLocalIPv6Candidate=this.hadRemoteRelayCandidate=this.hadLocalRelayCandidate=this.hadRemoteStunCandidate=
this.hadLocalStunCandidate=!1;this._remoteDataChannels=[];this._localDataChannels=[];this._candidateBuffer=[]}e=c("util");var h=c("sdp-jingle-json"),m=c("wildemitter"),n=c("lodash.clonedeep");e.inherits(d,m);Object.defineProperty(d.prototype,"signalingState",{get:function(){return this.pc.signalingState}});Object.defineProperty(d.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}});d.prototype._role=function(){return this.isInitiator?"initiator":"responder"};d.prototype.addStream=
function(c){this.localStream=c;this.pc.addStream(c)};d.prototype._checkLocalCandidate=function(c){c=h.toCandidateJSON(c);"srflx"==c.type?this.hadLocalStunCandidate=!0:"relay"==c.type&&(this.hadLocalRelayCandidate=!0);-1!=c.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)};d.prototype._checkRemoteCandidate=function(c){c=h.toCandidateJSON(c);"srflx"==c.type?this.hadRemoteStunCandidate=!0:"relay"==c.type&&(this.hadRemoteRelayCandidate=!0);-1!=c.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)};d.prototype.processIce=
function(c,b){b=b||function(){};var d=this;if("closed"===this.pc.signalingState)return b();if(c.contents||c.jingle&&c.jingle.contents){var e=this.remoteDescription.contents.map(function(c){return c.name});(c.contents||c.jingle.contents).forEach(function(c){var f=c.transport||{},m=f.candidates||[],n=e.indexOf(c.name),v=c.name,q=d.remoteDescription.contents.find(function(b){return b.name===c.name}),p=function(){m.forEach(function(c){c=h.toCandidateSDP(c);d.pc.addIceCandidate(new RTCIceCandidate({candidate:c,
sdpMLineIndex:n,sdpMid:v}),function(){},function(c){d.emit("error",c)});d._checkRemoteCandidate(c)});b()};d.iceCredentials.remote[c.name]&&f.ufrag&&d.iceCredentials.remote[c.name].ufrag!==f.ufrag?q?(q.transport.ufrag=f.ufrag,q.transport.pwd=f.pwd,f={type:"offer",jingle:d.remoteDescription},f.sdp=h.toSessionSDP(f.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"incoming"}),d.pc.setRemoteDescription(new RTCSessionDescription(f),function(){p()},function(c){d.emit("error",c)})):d.emit("error",
"ice restart failed to find matching content"):p()})}else{c.candidate&&0!==c.candidate.candidate.indexOf("a=")&&(c.candidate.candidate="a="+c.candidate.candidate);if(this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(c.candidate),b();d.pc.addIceCandidate(new RTCIceCandidate(c.candidate),function(){},function(c){d.emit("error",c)});d._checkRemoteCandidate(c.candidate.candidate);b()}};d.prototype.offer=
function(c,b){var d=this,f=2===arguments.length,e=f&&c?c:{offerToReceiveAudio:1,offerToReceiveVideo:1};b=(b=f?b:c)||function(){};if("closed"===this.pc.signalingState)return b("Already closed");this.pc.createOffer(function(c){var f={type:"offer",sdp:c.sdp};d.assumeSetLocalSuccess&&(d.emit("offer",f),b(null,f));d._candidateBuffer=[];d.pc.setLocalDescription(c,function(){if(d.config.useJingle){var e=h.toSessionJSON(c.sdp,{role:d._role(),direction:"outgoing"});e.sid=d.config.sid;d.localDescription=e;
e.contents.forEach(function(c){var b=c.transport||{};b.ufrag&&(d.iceCredentials.local[c.name]={ufrag:b.ufrag,pwd:b.pwd})});f.jingle=e}f.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&d._checkLocalCandidate(c)});d.assumeSetLocalSuccess||(d.emit("offer",f),b(null,f))},function(c){d.emit("error",c);b(c)})},function(c){d.emit("error",c);b(c)},e)};d.prototype.handleOffer=function(c,b){b=b||function(){};var d=this;c.type="offer";if(c.jingle){this.enableChromeNativeSimulcast&&c.jingle.contents.forEach(function(c){"video"===
c.name&&(c.application.googConferenceFlag=!0)});this.enableMultiStreamHacks&&c.jingle.contents.forEach(function(c){if("video"===c.name){var b=c.application.sources||[];if(0===b.length||"3735928559"!==b[0].ssrc)b.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),c.application.sources=b}});if(0<d.restrictBandwidth&&2<=c.jingle.contents.length&&"video"===c.jingle.contents[1].name){var f=c.jingle.contents[1];f.application&&f.application.bandwidth&&
f.application.bandwidth.bandwidth||(c.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:d.restrictBandwidth.toString()},c.sdp=h.toSessionSDP(c.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"outgoing"}))}c.jingle.contents.forEach(function(c){var b=c.transport||{};b.ufrag&&(d.iceCredentials.remote[c.name]={ufrag:b.ufrag,pwd:b.pwd})});c.sdp=h.toSessionSDP(c.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"incoming"});d.remoteDescription=c.jingle}c.sdp.split("\r\n").forEach(function(c){0===
c.indexOf("a=candidate:")&&d._checkRemoteCandidate(c)});d.pc.setRemoteDescription(new RTCSessionDescription(c),function(){b()},b)};d.prototype.answerAudioOnly=function(c){this._answer({mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},c)};d.prototype.answerBroadcastOnly=function(c){this._answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},c)};d.prototype.answer=function(c,b){var d=2===arguments.length;this._answer(d&&c?c:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},
d?b:c)};d.prototype.handleAnswer=function(c,b){b=b||function(){};var d=this;c.jingle&&(c.sdp=h.toSessionSDP(c.jingle,{sid:d.config.sdpSessionID,role:d._role(),direction:"incoming"}),d.remoteDescription=c.jingle,c.jingle.contents.forEach(function(c){var b=c.transport||{};b.ufrag&&(d.iceCredentials.remote[c.name]={ufrag:b.ufrag,pwd:b.pwd})}));c.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&d._checkRemoteCandidate(c)});d.pc.setRemoteDescription(new RTCSessionDescription(c),function(){d.wtFirefox&&
window.setTimeout(function(){d.firefoxcandidatebuffer.forEach(function(c){d.pc.addIceCandidate(new RTCIceCandidate(c),function(){},function(c){d.emit("error",c)});d._checkRemoteCandidate(c.candidate)});d.firefoxcandidatebuffer=null},d.wtFirefox);b(null)},b)};d.prototype.close=function(){this.pc.close();this._localDataChannels=[];this._remoteDataChannels=[];this.emit("close")};d.prototype._answer=function(c,b){b=b||function(){};var d=this;if(!this.pc.remoteDescription)throw Error("remoteDescription not set");
if("closed"===this.pc.signalingState)return b("Already closed");d.pc.createAnswer(function(c){var f=[];if(d.enableChromeNativeSimulcast&&(c.jingle=h.toSessionJSON(c.sdp,{role:d._role(),direction:"outgoing"}),2<=c.jingle.contents.length&&"video"===c.jingle.contents[1].name)){var e=c.jingle.contents[1].application.sourceGroups||[],m=!1;e.forEach(function(c){"SIM"==c.semantics&&(m=!0)});if(!m&&c.jingle.contents[1].application.sources.length){var v=JSON.parse(JSON.stringify(c.jingle.contents[1].application.sources[0]));
v.ssrc=""+Math.floor(4294967295*Math.random());c.jingle.contents[1].application.sources.push(v);f.push(c.jingle.contents[1].application.sources[0].ssrc);f.push(v.ssrc);e.push({semantics:"SIM",sources:f});f=JSON.parse(JSON.stringify(v));f.ssrc=""+Math.floor(4294967295*Math.random());c.jingle.contents[1].application.sources.push(f);e.push({semantics:"FID",sources:[v.ssrc,f.ssrc]});c.jingle.contents[1].application.sourceGroups=e;c.sdp=h.toSessionSDP(c.jingle,{sid:d.config.sdpSessionID,role:d._role(),
direction:"outgoing"})}}var q={type:"answer",sdp:c.sdp};d.assumeSetLocalSuccess&&(e=n(q),d.emit("answer",e),b(null,e));d._candidateBuffer=[];d.pc.setLocalDescription(c,function(){if(d.config.useJingle){var f=h.toSessionJSON(c.sdp,{role:d._role(),direction:"outgoing"});f.sid=d.config.sid;d.localDescription=f;q.jingle=f}d.enableChromeNativeSimulcast&&(q.jingle||(q.jingle=h.toSessionJSON(c.sdp,{role:d._role(),direction:"outgoing"})),q.jingle.contents[1].application.sources.forEach(function(c,b){c.parameters=
c.parameters.map(function(c){"msid"===c.key&&(c.value+="-"+Math.floor(b/2));return c})}),q.sdp=h.toSessionSDP(q.jingle,{sid:d.sdpSessionID,role:d._role(),direction:"outgoing"}));q.sdp.split("\r\n").forEach(function(c){0===c.indexOf("a=candidate:")&&d._checkLocalCandidate(c)});d.assumeSetLocalSuccess||(f=n(q),d.emit("answer",f),b(null,f))},function(c){d.emit("error",c);b(c)})},function(c){d.emit("error",c);b(c)},c)};d.prototype._onIce=function(c){var b=this;if(c.candidate){if(!this.dontSignalCandidates){c=
c.candidate;var d={candidate:{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex}};this._checkLocalCandidate(c.candidate);var f=h.toCandidateJSON(c.candidate);if(this.eliminateDuplicateCandidates&&"relay"===f.type){var e=this._candidateBuffer.filter(function(c){return"relay"===c.type}).map(function(c){return c.foundation+":"+c.component});var m=e.indexOf(f.foundation+":"+f.component);if(-1<m&&f.priority>>24>=e[m].priority>>24)return}if("max-bundle"===this.config.bundlePolicy&&(e=
this._candidateBuffer.filter(function(c){return f.type===c.type}).map(function(c){return c.address+":"+c.port}),m=e.indexOf(f.address+":"+f.port),-1<m))return;if("require"!==this.config.rtcpMuxPolicy||"2"!==f.component){this._candidateBuffer.push(f);if(b.config.useJingle&&(c.sdpMid||(c.sdpMid=b.pc.remoteDescription&&"offer"===b.pc.remoteDescription.type?b.remoteDescription.contents[c.sdpMLineIndex].name:b.localDescription.contents[c.sdpMLineIndex].name),b.iceCredentials.local[c.sdpMid]||h.toSessionJSON(b.pc.localDescription.sdp,
{role:b._role(),direction:"outgoing"}).contents.forEach(function(c){var d=c.transport||{};d.ufrag&&(b.iceCredentials.local[c.name]={ufrag:d.ufrag,pwd:d.pwd})}),d.jingle={contents:[{name:c.sdpMid,creator:b._role(),transport:{transportType:"iceUdp",ufrag:b.iceCredentials.local[c.sdpMid].ufrag,pwd:b.iceCredentials.local[c.sdpMid].pwd,candidates:[f]}}]},0<b.batchIceCandidates)){0===b.batchedIceCandidates.length&&window.setTimeout(function(){var c={};b.batchedIceCandidates.forEach(function(b){b=b.contents[0];
c[b.name]||(c[b.name]=b);c[b.name].transport.candidates.push(b.transport.candidates[0])});var d={jingle:{contents:[]}};Object.keys(c).forEach(function(b){d.jingle.contents.push(c[b])});b.batchedIceCandidates=[];b.emit("ice",d)},b.batchIceCandidates);b.batchedIceCandidates.push(d.jingle);return}this.emit("ice",d)}}}else this.emit("endOfCandidates")};d.prototype._onDataChannel=function(c){c=c.channel;this._remoteDataChannels.push(c);this.emit("addChannel",c)};d.prototype.createDataChannel=function(c,
b){c=this.pc.createDataChannel(c,b);this._localDataChannels.push(c);return c};d.prototype.getStats=function(){if("function"===typeof arguments[0]){var c=arguments[0];this.pc.getStats().then(function(b){c(null,b)},function(b){c(b)})}else return this.pc.getStats.apply(this.pc,arguments)};b.exports=d},{"lodash.clonedeep":36,"sdp-jingle-json":45,util:63,wildemitter:65}],45:[function(c,b,e){var d=c("./lib/tosdp"),h=c("./lib/tojson");e.toIncomingSDPOffer=function(c){return d.toSessionSDP(c,{role:"responder",
direction:"incoming"})};e.toOutgoingSDPOffer=function(c){return d.toSessionSDP(c,{role:"initiator",direction:"outgoing"})};e.toIncomingSDPAnswer=function(c){return d.toSessionSDP(c,{role:"initiator",direction:"incoming"})};e.toOutgoingSDPAnswer=function(c){return d.toSessionSDP(c,{role:"responder",direction:"outgoing"})};e.toIncomingMediaSDPOffer=function(c){return d.toMediaSDP(c,{role:"responder",direction:"incoming"})};e.toOutgoingMediaSDPOffer=function(c){return d.toMediaSDP(c,{role:"initiator",
direction:"outgoing"})};e.toIncomingMediaSDPAnswer=function(c){return d.toMediaSDP(c,{role:"initiator",direction:"incoming"})};e.toOutgoingMediaSDPAnswer=function(c){return d.toMediaSDP(c,{role:"responder",direction:"outgoing"})};e.toCandidateSDP=d.toCandidateSDP;e.toMediaSDP=d.toMediaSDP;e.toSessionSDP=d.toSessionSDP;e.toIncomingJSONOffer=function(c,b){return h.toSessionJSON(c,{role:"responder",direction:"incoming",creators:b})};e.toOutgoingJSONOffer=function(c,b){return h.toSessionJSON(c,{role:"initiator",
direction:"outgoing",creators:b})};e.toIncomingJSONAnswer=function(c,b){return h.toSessionJSON(c,{role:"initiator",direction:"incoming",creators:b})};e.toOutgoingJSONAnswer=function(c,b){return h.toSessionJSON(c,{role:"responder",direction:"outgoing",creators:b})};e.toIncomingMediaJSONOffer=function(c,b){return h.toMediaJSON(c,{role:"responder",direction:"incoming",creator:b})};e.toOutgoingMediaJSONOffer=function(c,b){return h.toMediaJSON(c,{role:"initiator",direction:"outgoing",creator:b})};e.toIncomingMediaJSONAnswer=
function(c,b){return h.toMediaJSON(c,{role:"initiator",direction:"incoming",creator:b})};e.toOutgoingMediaJSONAnswer=function(c,b){return h.toMediaJSON(c,{role:"responder",direction:"outgoing",creator:b})};e.toCandidateJSON=h.toCandidateJSON;e.toMediaJSON=h.toMediaJSON;e.toSessionJSON=h.toSessionJSON},{"./lib/tojson":48,"./lib/tosdp":49}],46:[function(c,b,e){e.lines=function(c){return c.split("\r\n").filter(function(c){return 0<c.length})};e.findLine=function(c,b,d){for(var f=c.length,e=0;e<b.length;e++)if(b[e].substr(0,
f)===c)return b[e];if(!d)return!1;for(b=0;b<d.length;b++)if(d[b].substr(0,f)===c)return d[b];return!1};e.findLines=function(c,b,d){for(var e=[],f=c.length,h=0;h<b.length;h++)b[h].substr(0,f)===c&&e.push(b[h]);if(e.length||!d)return e;for(b=0;b<d.length;b++)d[b].substr(0,f)===c&&e.push(d[b]);return e};e.mline=function(c){c=c.substr(2).split(" ");for(var b={media:c[0],port:c[1],proto:c[2],formats:[]},d=3;d<c.length;d++)c[d]&&b.formats.push(c[d]);return b};e.rtpmap=function(c){c=c.substr(9).split(" ");
var b={id:c.shift()};c=c[0].split("/");b.name=c[0];b.clockrate=c[1];b.channels=3==c.length?c[2]:"1";return b};e.sctpmap=function(c){c=c.substr(10).split(" ");return{number:c.shift(),protocol:c.shift(),streams:c.shift()}};e.fmtp=function(c){for(var b,d=c.substr(c.indexOf(" ")+1).split(";"),e=[],f=0;f<d.length;f++)b=d[f].split("="),c=b[0].trim(),b=b[1],c&&b?e.push({key:c,value:b}):c&&e.push({key:"",value:c});return e};e.crypto=function(c){c=c.substr(9).split(" ");return{tag:c[0],cipherSuite:c[1],keyParams:c[2],
sessionParams:c.slice(3).join(" ")}};e.fingerprint=function(c){c=c.substr(14).split(" ");return{hash:c[0],value:c[1]}};e.extmap=function(c){c=c.substr(9).split(" ");var b={},d=c.shift(),e=d.indexOf("/");0<=e?(b.id=d.substr(0,e),b.senders=d.substr(e+1)):(b.id=d,b.senders="sendrecv");b.uri=c.shift()||"";return b};e.rtcpfb=function(c){c=c.substr(10).split(" ");var b={};b.id=c.shift();b.type=c.shift();"trr-int"===b.type?b.value=c.shift():b.subtype=c.shift()||"";b.parameters=c;return b};e.candidate=function(c){c=
0===c.indexOf("a=candidate:")?c.substring(12).split(" "):c.substring(10).split(" ");for(var b={foundation:c[0],component:c[1],protocol:c[2].toLowerCase(),priority:c[3],ip:c[4],port:c[5],type:c[7],generation:"0"},d=8;d<c.length;d+=2)"raddr"===c[d]?b.relAddr=c[d+1]:"rport"===c[d]?b.relPort=c[d+1]:"generation"===c[d]?b.generation=c[d+1]:"tcptype"===c[d]&&(b.tcpType=c[d+1]);b.network="1";return b};e.sourceGroups=function(c){for(var b=[],d=0;d<c.length;d++){var e=c[d].substr(13).split(" ");b.push({semantics:e.shift(),
sources:e})}return b};e.sources=function(c){for(var b=[],d={},e=0;e<c.length;e++){var f=c[e].substr(7).split(" "),q=f.shift();if(!d[q]){var p={ssrc:q,parameters:[]};b.push(p);d[q]=p}f=f.join(" ").split(":");p=f.shift();f=f.join(":")||null;d[q].parameters.push({key:p,value:f})}return b};e.groups=function(c){for(var b=[],d,e=0;e<c.length;e++)d=c[e].substr(8).split(" "),b.push({semantics:d.shift(),contents:d});return b};e.bandwidth=function(c){c=c.substr(2).split(":");var b={};b.type=c.shift();b.bandwidth=
c.shift();return b};e.msid=function(c){c=c.substr(7);var b=c.split(" ");return{msid:c,mslabel:b[0],label:b[1]}}},{}],47:[function(c,b,e){b.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",
responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],48:[function(c,b,e){var d=c("./senders"),h=c("./parsers"),m=Math.random();e._setIdCounter=function(c){m=c};e.toSessionJSON=function(c,b){var d,f=b.creators||[],m=b.role||"initiator";b=b.direction||"outgoing";
var n=c.split("\r\nm=");for(d=1;d<n.length;d++)n[d]="m="+n[d],d!==n.length-1&&(n[d]+="\r\n");var v=n.shift()+"\r\n",k=h.lines(v);c={};var l=[];for(d=0;d<n.length;d++)l.push(e.toMediaJSON(n[d],v,{role:m,direction:b,creator:f[d]||"initiator"}));c.contents=l;f=h.findLines("a=group:",k);f.length&&(c.groups=h.groups(f));return c};e.toMediaJSON=function(c,b,f){var m=f.creator||"initiator",n=f.role||"initiator",q=f.direction||"outgoing",v=h.lines(c);c=h.lines(b);b=h.mline(v[0]);m={creator:m,name:b.media,
application:{applicationType:"rtp",media:b.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==b.media&&(m.application={applicationType:"datachannel"},m.transport.sctp=[]);var k=m.application,l=m.transport;if(b=h.findLine("a=mid:",v))m.name=b.substr(6);h.findLine("a=sendrecv",v,c)?m.senders="both":h.findLine("a=sendonly",v,c)?m.senders=d[n][q].sendonly:h.findLine("a=recvonly",v,c)?m.senders=d[n][q].recvonly:
h.findLine("a=inactive",v,c)&&(m.senders="none");if("rtp"==k.applicationType){if(b=h.findLine("b=",v))k.bandwidth=h.bandwidth(b);if(b=h.findLine("a=ssrc:",v))k.ssrc=b.substr(7).split(" ")[0];h.findLines("a=rtpmap:",v).forEach(function(c){var b=h.rtpmap(c);b.parameters=[];b.feedback=[];h.findLines("a=fmtp:"+b.id,v).forEach(function(c){b.parameters=h.fmtp(c)});h.findLines("a=rtcp-fb:"+b.id,v).forEach(function(c){b.feedback.push(h.rtcpfb(c))});k.payloads.push(b)});h.findLines("a=crypto:",v,c).forEach(function(c){k.encryption.push(h.crypto(c))});
h.findLine("a=rtcp-mux",v)&&(k.mux=!0);h.findLines("a=rtcp-fb:*",v).forEach(function(c){k.feedback.push(h.rtcpfb(c))});h.findLines("a=extmap:",v).forEach(function(c){c=h.extmap(c);c.senders=d[n][q][c.senders];k.headerExtensions.push(c)});b=h.findLines("a=ssrc-group:",v);k.sourceGroups=h.sourceGroups(b||[]);b=h.findLines("a=ssrc:",v);var r=k.sources=h.sources(b||[]);if(b=h.findLine("a=msid:",v)){var t=h.msid(b);["msid","mslabel","label"].forEach(function(c){for(var b=0;b<r.length;b++){for(var d=!1,
e=0;e<r[b].parameters.length;e++)r[b].parameters[e].key===c&&(d=!0);d||r[b].parameters.push({key:c,value:t[c]})}})}h.findLine("a=x-google-flag:conference",v,c)&&(k.googConferenceFlag=!0)}b=h.findLines("a=fingerprint:",v,c);var ma=h.findLine("a=setup:",v,c);b.forEach(function(c){c=h.fingerprint(c);ma&&(c.setup=ma.substr(8));l.fingerprints.push(c)});b=h.findLine("a=ice-ufrag:",v,c);f=h.findLine("a=ice-pwd:",v,c);b&&f&&(l.ufrag=b.substr(12),l.pwd=f.substr(10),l.candidates=[],h.findLines("a=candidate:",
v,c).forEach(function(c){l.candidates.push(e.toCandidateJSON(c))}));"datachannel"==k.applicationType&&h.findLines("a=sctpmap:",v).forEach(function(c){c=h.sctpmap(c);l.sctp.push(c)});return m};e.toCandidateJSON=function(c){c=h.candidate(c.split("\r\n")[0]);c.id=(m++).toString(36).substr(0,12);return c}},{"./parsers":46,"./senders":47}],49:[function(c,b,e){var d=c("./senders");e.toSessionSDP=function(c,b){var d=b.sid||c.sid||Date.now(),f=b.time||Date.now(),h=["v=0","o=- "+d+" "+f+" IN IP4 0.0.0.0",
"s=-","t=0 0"];d=c.contents||[];var m=!1;d.forEach(function(c){c.application.sources&&c.application.sources.length&&(m=!0)});m&&h.push("a=msid-semantic: WMS *");(c.groups||[]).forEach(function(c){h.push("a=group:"+c.semantics+" "+c.contents.join(" "))});d.forEach(function(c){h.push(e.toMediaSDP(c,b))});return h.join("\r\n")+"\r\n"};e.toMediaSDP=function(c,b){var f=[],h=b.role||"initiator",m=b.direction||"outgoing",p=c.application;b=c.transport;var u=p.payloads||[],k=b&&b.fingerprints||[],l=[];"datachannel"==
p.applicationType?(l.push("application"),l.push("1"),l.push("DTLS/SCTP"),b.sctp&&b.sctp.forEach(function(c){l.push(c.number)})):(l.push(p.media),l.push("1"),0<k.length?l.push("UDP/TLS/RTP/SAVPF"):p.encryption&&0<p.encryption.length?l.push("RTP/SAVPF"):l.push("RTP/AVPF"),u.forEach(function(c){l.push(c.id)}));f.push("m="+l.join(" "));f.push("c=IN IP4 0.0.0.0");p.bandwidth&&p.bandwidth.type&&p.bandwidth.bandwidth&&f.push("b="+p.bandwidth.type+":"+p.bandwidth.bandwidth);"rtp"==p.applicationType&&f.push("a=rtcp:1 IN IP4 0.0.0.0");
b&&(b.ufrag&&f.push("a=ice-ufrag:"+b.ufrag),b.pwd&&f.push("a=ice-pwd:"+b.pwd),k.forEach(function(c){f.push("a=fingerprint:"+c.hash+" "+c.value);c.setup&&f.push("a=setup:"+c.setup)}),b.sctp&&b.sctp.forEach(function(c){f.push("a=sctpmap:"+c.number+" "+c.protocol+" "+c.streams)}));"rtp"==p.applicationType&&f.push("a="+(d[h][m][c.senders]||"sendrecv"));f.push("a=mid:"+c.name);p.sources&&p.sources.length&&(p.sources[0].parameters||[]).forEach(function(c){"msid"===c.key&&f.push("a=msid:"+c.value)});p.mux&&
f.push("a=rtcp-mux");(p.encryption||[]).forEach(function(c){f.push("a=crypto:"+c.tag+" "+c.cipherSuite+" "+c.keyParams+(c.sessionParams?" "+c.sessionParams:""))});p.googConferenceFlag&&f.push("a=x-google-flag:conference");u.forEach(function(c){var b="a=rtpmap:"+c.id+" "+c.name+"/"+c.clockrate;c.channels&&"1"!=c.channels&&(b+="/"+c.channels);f.push(b);if(c.parameters&&c.parameters.length){b=["a=fmtp:"+c.id];var d=[];c.parameters.forEach(function(c){d.push((c.key?c.key+"=":"")+c.value)});b.push(d.join(";"));
f.push(b.join(" "))}c.feedback&&c.feedback.forEach(function(b){"trr-int"===b.type?f.push("a=rtcp-fb:"+c.id+" trr-int "+(b.value?b.value:"0")):f.push("a=rtcp-fb:"+c.id+" "+b.type+(b.subtype?" "+b.subtype:""))})});p.feedback&&p.feedback.forEach(function(c){"trr-int"===c.type?f.push("a=rtcp-fb:* trr-int "+(c.value?c.value:"0")):f.push("a=rtcp-fb:* "+c.type+(c.subtype?" "+c.subtype:""))});(p.headerExtensions||[]).forEach(function(c){f.push("a=extmap:"+c.id+(c.senders?"/"+d[h][m][c.senders]:"")+" "+c.uri)});
(p.sourceGroups||[]).forEach(function(c){f.push("a=ssrc-group:"+c.semantics+" "+c.sources.join(" "))});(p.sources||[]).forEach(function(c){for(var b=0;b<c.parameters.length;b++){var d=c.parameters[b];f.push("a=ssrc:"+(c.ssrc||p.ssrc)+" "+d.key+(d.value?":"+d.value:""))}});(b.candidates||[]).forEach(function(c){f.push(e.toCandidateSDP(c))});return f.join("\r\n")};e.toCandidateSDP=function(c){var b=[];b.push(c.foundation);b.push(c.component);b.push(c.protocol.toUpperCase());b.push(c.priority);b.push(c.ip);
b.push(c.port);var d=c.type;b.push("typ");b.push(d);("srflx"===d||"prflx"===d||"relay"===d)&&c.relAddr&&c.relPort&&(b.push("raddr"),b.push(c.relAddr),b.push("rport"),b.push(c.relPort));c.tcpType&&"TCP"==c.protocol.toUpperCase()&&(b.push("tcptype"),b.push(c.tcpType));b.push("generation");b.push(c.generation||"0");return"a=candidate:"+b.join(" ")}},{"./senders":47}],50:[function(c,b,e){b.exports=c("./lib/")},{"./lib/":51}],51:[function(c,b,e){function d(c,b){"object"==typeof c&&(b=c,c=void 0);b=b||
{};c=h(c);var d=c.source,e=c.id;b.forceNew||b["force new connection"]||!1===b.multiplex?(v("ignoring socket cache for %s",d),b=n(d,b)):(q[e]||(v("new io instance for %s",d),q[e]=n(d,b)),b=q[e]);return b.socket(c.path)}var h=c("./url"),m=c("socket.io-parser"),n=c("./manager"),v=c("debug")("socket.io-client");b.exports=e=d;var q=e.managers={};e.protocol=m.protocol;e.connect=d;e.Manager=c("./manager");e.Socket=c("./socket")},{"./manager":52,"./socket":54,"./url":55,debug:10,"socket.io-parser":57}],52:[function(c,
b,e){function d(c,b){if(!(this instanceof d))return new d(c,b);c&&"object"==typeof c&&(b=c,c=void 0);b=b||{};b.path=b.path||"/socket.io";this.nsps={};this.subs=[];this.opts=b;this.reconnection(!1!==b.reconnection);this.reconnectionAttempts(b.reconnectionAttempts||Infinity);this.reconnectionDelay(b.reconnectionDelay||1E3);this.reconnectionDelayMax(b.reconnectionDelayMax||5E3);this.randomizationFactor(b.randomizationFactor||.5);this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),
jitter:this.randomizationFactor()});this.timeout(null==b.timeout?2E4:b.timeout);this.readyState="closed";this.uri=c;this.connected=[];this.encoding=!1;this.packetBuffer=[];this.encoder=new n.Encoder;this.decoder=new n.Decoder;(this.autoConnect=!1!==b.autoConnect)&&this.open()}c("./url");var h=c("engine.io-client"),m=c("./socket");e=c("component-emitter");var n=c("socket.io-parser"),v=c("./on"),q=c("component-bind");c("object-component");var p=c("debug")("socket.io-client:manager"),k=c("indexof"),
l=c("backo2");b.exports=d;d.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var c in this.nsps)this.nsps[c].emit.apply(this.nsps[c],arguments)};d.prototype.updateSocketIds=function(){for(var c in this.nsps)this.nsps[c].id=this.engine.id};e(d.prototype);d.prototype.reconnection=function(c){if(!arguments.length)return this._reconnection;this._reconnection=!!c;return this};d.prototype.reconnectionAttempts=function(c){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=
c;return this};d.prototype.reconnectionDelay=function(c){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=c;this.backoff&&this.backoff.setMin(c);return this};d.prototype.randomizationFactor=function(c){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=c;this.backoff&&this.backoff.setJitter(c);return this};d.prototype.reconnectionDelayMax=function(c){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=c;this.backoff&&
this.backoff.setMax(c);return this};d.prototype.timeout=function(c){if(!arguments.length)return this._timeout;this._timeout=c;return this};d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};d.prototype.open=d.prototype.connect=function(c){p("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;p("opening %s",this.uri);var b=this.engine=h(this.uri,this.opts),d=this;this.readyState="opening";this.skipReconnect=
!1;var e=v(b,"open",function(){d.onopen();c&&c()}),f=v(b,"error",function(b){p("connect_error");d.cleanup();d.readyState="closed";d.emitAll("connect_error",b);if(c){var e=Error("Connection error");e.data=b;c(e)}else d.maybeReconnectOnOpen()});if(!1!==this._timeout){var m=this._timeout;p("connect attempt will timeout after %d",m);var n=setTimeout(function(){p("connect attempt timed out after %d",m);e.destroy();b.close();b.emit("error","timeout");d.emitAll("connect_timeout",m)},m);this.subs.push({destroy:function(){clearTimeout(n)}})}this.subs.push(e);
this.subs.push(f);return this};d.prototype.onopen=function(){p("open");this.cleanup();this.readyState="open";this.emit("open");var c=this.engine;this.subs.push(v(c,"data",q(this,"ondata")));this.subs.push(v(this.decoder,"decoded",q(this,"ondecoded")));this.subs.push(v(c,"error",q(this,"onerror")));this.subs.push(v(c,"close",q(this,"onclose")))};d.prototype.ondata=function(c){this.decoder.add(c)};d.prototype.ondecoded=function(c){this.emit("packet",c)};d.prototype.onerror=function(c){p("error",c);
this.emitAll("error",c)};d.prototype.socket=function(c){var b=this.nsps[c];if(!b){b=new m(this,c);this.nsps[c]=b;var d=this;b.on("connect",function(){b.id=d.engine.id;~k(d.connected,b)||d.connected.push(b)})}return b};d.prototype.destroy=function(c){c=k(this.connected,c);~c&&this.connected.splice(c,1);this.connected.length||this.close()};d.prototype.packet=function(c){p("writing packet %j",c);var b=this;b.encoding?b.packetBuffer.push(c):(b.encoding=!0,this.encoder.encode(c,function(c){for(var d=0;d<
c.length;d++)b.engine.write(c[d]);b.encoding=!1;b.processPacketQueue()}))};d.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var c=this.packetBuffer.shift();this.packet(c)}};d.prototype.cleanup=function(){for(var c;c=this.subs.shift();)c.destroy();this.packetBuffer=[];this.encoding=!1;this.decoder.destroy()};d.prototype.close=d.prototype.disconnect=function(){this.skipReconnect=!0;this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};
d.prototype.onclose=function(c){p("close");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",c);this._reconnection&&!this.skipReconnect&&this.reconnect()};d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var c=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();p("will wait %dms before reconnect attempt",
b);this.reconnecting=!0;var d=setTimeout(function(){c.skipReconnect||(p("attempting reconnect"),c.emitAll("reconnect_attempt",c.backoff.attempts),c.emitAll("reconnecting",c.backoff.attempts),c.skipReconnect||c.open(function(b){b?(p("reconnect attempt error"),c.reconnecting=!1,c.reconnect(),c.emitAll("reconnect_error",b.data)):(p("reconnect success"),c.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(d)}})}};d.prototype.onreconnect=function(){var c=this.backoff.attempts;this.reconnecting=
!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",c)}},{"./on":53,"./socket":54,"./url":55,backo2:4,"component-bind":7,"component-emitter":8,debug:10,"engine.io-client":11,indexof:32,"object-component":39,"socket.io-parser":57}],53:[function(c,b,e){b.exports=function(c,b,d){c.on(b,d);return{destroy:function(){c.removeListener(b,d)}}}},{}],54:[function(c,b,e){function d(c,b){this.io=c;this.nsp=b;this.json=this;this.ids=0;this.acks={};this.io.autoConnect&&this.open();this.receiveBuffer=
[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0}var h=c("socket.io-parser");e=c("component-emitter");var m=c("to-array"),n=c("./on"),v=c("component-bind"),q=c("debug")("socket.io-client:socket"),p=c("has-binary");b.exports=d;var k={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},l=e.prototype.emit;e(d.prototype);d.prototype.subEvents=function(){if(!this.subs){var c=this.io;this.subs=
[n(c,"open",v(this,"onopen")),n(c,"packet",v(this,"onpacket")),n(c,"close",v(this,"onclose"))]}};d.prototype.open=d.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==this.io.readyState)this.onopen();return this};d.prototype.send=function(){var c=m(arguments);c.unshift("message");this.emit.apply(this,c);return this};d.prototype.emit=function(c){if(k.hasOwnProperty(c))return l.apply(this,arguments),this;var b=m(arguments),d=h.EVENT;p(b)&&(d=h.BINARY_EVENT);
d={type:d,data:b};"function"==typeof b[b.length-1]&&(q("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),d.id=this.ids++);this.connected?this.packet(d):this.sendBuffer.push(d);return this};d.prototype.packet=function(c){c.nsp=this.nsp;this.io.packet(c)};d.prototype.onopen=function(){q("transport is open - connecting");"/"!=this.nsp&&this.packet({type:h.CONNECT})};d.prototype.onclose=function(c){q("close (%s)",c);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",
c)};d.prototype.onpacket=function(c){if(c.nsp==this.nsp)switch(c.type){case h.CONNECT:this.onconnect();break;case h.EVENT:this.onevent(c);break;case h.BINARY_EVENT:this.onevent(c);break;case h.ACK:this.onack(c);break;case h.BINARY_ACK:this.onack(c);break;case h.DISCONNECT:this.ondisconnect();break;case h.ERROR:this.emit("error",c.data)}};d.prototype.onevent=function(c){var b=c.data||[];q("emitting event %j",b);null!=c.id&&(q("attaching ack callback to event"),b.push(this.ack(c.id)));this.connected?
l.apply(this,b):this.receiveBuffer.push(b)};d.prototype.ack=function(c){var b=this,d=!1;return function(){if(!d){d=!0;var e=m(arguments);q("sending ack %j",e);var f=p(e)?h.BINARY_ACK:h.ACK;b.packet({type:f,id:c,data:e})}}};d.prototype.onack=function(c){q("calling ack %s with %j",c.id,c.data);this.acks[c.id].apply(this,c.data);delete this.acks[c.id]};d.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};d.prototype.emitBuffered=function(){var c;
for(c=0;c<this.receiveBuffer.length;c++)l.apply(this,this.receiveBuffer[c]);this.receiveBuffer=[];for(c=0;c<this.sendBuffer.length;c++)this.packet(this.sendBuffer[c]);this.sendBuffer=[]};d.prototype.ondisconnect=function(){q("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};d.prototype.destroy=function(){if(this.subs){for(var c=0;c<this.subs.length;c++)this.subs[c].destroy();this.subs=null}this.io.destroy(this)};d.prototype.close=d.prototype.disconnect=function(){this.connected&&
(q("performing disconnect (%s)",this.nsp),this.packet({type:h.DISCONNECT}));this.destroy();if(this.connected)this.onclose("io client disconnect");return this}},{"./on":53,"component-bind":7,"component-emitter":8,debug:10,"has-binary":30,"socket.io-parser":57,"to-array":59}],55:[function(c,b,e){(function(d){var e=c("parseuri"),f=c("debug")("socket.io-client:url");b.exports=function(c,b){var h=c;b=b||d.location;null==c&&(c=b.protocol+"//"+b.host);"string"==typeof c&&("/"==c.charAt(0)&&(c="/"==c.charAt(1)?
b.protocol+c:b.hostname+c),/^(https?|wss?):\/\//.test(c)||(f("protocol-less url %s",c),c="undefined"!=typeof b?b.protocol+"//"+c:"https://"+c),f("parse %s",c),h=e(c));h.port||(/^(http|ws)$/.test(h.protocol)?h.port="80":/^(http|ws)s$/.test(h.protocol)&&(h.port="443"));h.path=h.path||"/";h.id=h.protocol+"://"+h.host+":"+h.port;h.href=h.protocol+"://"+h.host+(b&&b.port==h.port?"":":"+h.port);return h}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?
window:{})},{debug:10,parseuri:42}],56:[function(c,b,e){(function(b){var d=c("isarray"),f=c("./is-buffer");e.deconstructPacket=function(c){function b(c){if(!c)return c;if(f(c)){var h={_placeholder:!0,num:e.length};e.push(c);return h}if(d(c)){h=Array(c.length);for(var m=0;m<c.length;m++)h[m]=b(c[m]);return h}if("object"==typeof c&&!(c instanceof Date)){h={};for(m in c)h[m]=b(c[m]);return h}return c}var e=[];c.data=b(c.data);c.attachments=e.length;return{packet:c,buffers:e}};e.reconstructPacket=function(c,
b){function e(c){if(c&&c._placeholder)return b[c.num];if(d(c))for(var f=0;f<c.length;f++)c[f]=e(c[f]);else if(c&&"object"==typeof c)for(f in c)c[f]=e(c[f]);return c}c.data=e(c.data);c.attachments=void 0;return c};e.removeBlobs=function(c,e){function h(c,v,q){if(!c)return c;if(b.Blob&&c instanceof Blob||b.File&&c instanceof File){m++;var p=new FileReader;p.onload=function(){q?q[v]=this.result:n=this.result;--m||e(n)};p.readAsArrayBuffer(c)}else if(d(c))for(p=0;p<c.length;p++)h(c[p],p,c);else if(c&&
"object"==typeof c&&!f(c))for(p in c)h(c[p],p,c)}var m=0,n=c;h(n);m||e(n)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./is-buffer":58,isarray:33}],57:[function(c,b,e){function d(){}function h(c){var b=!1;var d=""+c.type;if(e.BINARY_EVENT==c.type||e.BINARY_ACK==c.type)d+=c.attachments,d+="-";c.nsp&&"/"!=c.nsp&&(b=!0,d+=c.nsp);null!=c.id&&(b&&(d+=",",b=!1),d+=c.id);null!=c.data&&(b&&(d+=","),d+=p.stringify(c.data));q("encoded %j as %s",
c,d);return d}function m(c,b){k.removeBlobs(c,function(c){var d=k.deconstructPacket(c);c=h(d.packet);d=d.buffers;d.unshift(c);b(d)})}function n(){this.reconstructor=null}function v(c){this.reconPack=c;this.buffers=[]}var q=c("debug")("socket.io-parser"),p=c("json3");c("isarray");b=c("component-emitter");var k=c("./binary"),l=c("./is-buffer");e.protocol=4;e.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" ");e.CONNECT=0;e.DISCONNECT=1;e.EVENT=2;e.ACK=3;e.ERROR=4;e.BINARY_EVENT=
5;e.BINARY_ACK=6;e.Encoder=d;e.Decoder=n;d.prototype.encode=function(c,b){q("encoding packet %j",c);e.BINARY_EVENT==c.type||e.BINARY_ACK==c.type?m(c,b):(c=h(c),b([c]))};b(n.prototype);n.prototype.add=function(c){if("string"==typeof c){a:{var b={},d=0;b.type=Number(c.charAt(0));if(null==e.types[b.type])c={type:e.ERROR,data:"parser error"};else{if(e.BINARY_EVENT==b.type||e.BINARY_ACK==b.type){for(var f="";"-"!=c.charAt(++d)&&(f+=c.charAt(d),d!=c.length););if(f!=Number(f)||"-"!=c.charAt(d))throw Error("Illegal attachments");
b.attachments=Number(f)}if("/"==c.charAt(d+1))for(b.nsp="";++d;){f=c.charAt(d);if(","==f)break;b.nsp+=f;if(d==c.length)break}else b.nsp="/";f=c.charAt(d+1);if(""!==f&&Number(f)==f){for(b.id="";++d;){f=c.charAt(d);if(null==f||Number(f)!=f){--d;break}b.id+=c.charAt(d);if(d==c.length)break}b.id=Number(b.id)}if(c.charAt(++d))try{b.data=p.parse(c.substr(d))}catch(dc){c={type:e.ERROR,data:"parser error"};break a}q("decoded %s as %j",c,b);c=b}}e.BINARY_EVENT==c.type||e.BINARY_ACK==c.type?(this.reconstructor=
new v(c),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",c)):this.emit("decoded",c)}else if(l(c)||c.base64)if(this.reconstructor){if(c=this.reconstructor.takeBinaryData(c))this.reconstructor=null,this.emit("decoded",c)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+c);};n.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};v.prototype.takeBinaryData=function(c){this.buffers.push(c);
return this.buffers.length==this.reconPack.attachments?(c=k.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),c):null};v.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},{"./binary":56,"./is-buffer":58,"component-emitter":8,debug:10,isarray:33,json3:34}],58:[function(c,b,e){(function(c){b.exports=function(b){return c.Buffer&&c.Buffer.isBuffer(b)||c.ArrayBuffer&&b instanceof ArrayBuffer}}).call(this,"undefined"!==typeof global?global:"undefined"!==
typeof self?self:"undefined"!==typeof window?window:{})},{}],59:[function(c,b,e){b.exports=function(c,b){for(var d=[],e=(b=b||0)||0;e<c.length;e++)d[e-b]=c[e];return d}},{}],60:[function(c,b,e){(function(c){(function(d){function f(c){for(var b=[],d=0,e=c.length,f,h;d<e;)f=c.charCodeAt(d++),55296<=f&&56319>=f&&d<e?(h=c.charCodeAt(d++),56320==(h&64512)?b.push(((f&1023)<<10)+(h&1023)+65536):(b.push(f),d--)):b.push(f);return b}function h(c){if(55296<=c&&57343>=c)throw Error("Lone surrogate U+"+c.toString(16).toUpperCase()+
" is not a scalar value");}function v(){if(A>=w)throw Error("Invalid byte index");var c=t[A]&255;A++;if(128==(c&192))return c&63;throw Error("Invalid continuation byte");}function q(){if(A>w)throw Error("Invalid byte index");if(A==w)return!1;var c=t[A]&255;A++;if(0==(c&128))return c;if(192==(c&224)){var b=v();c=(c&31)<<6|b;if(128<=c)return c;throw Error("Invalid continuation byte");}if(224==(c&240)){b=v();var d=v();c=(c&15)<<12|b<<6|d;if(2048<=c)return h(c),c;throw Error("Invalid continuation byte");
}if(240==(c&248)){b=v();d=v();var e=v();c=(c&15)<<18|b<<12|d<<6|e;if(65536<=c&&1114111>=c)return c}throw Error("Invalid UTF-8 detected");}var p="object"==typeof e&&e,k="object"==typeof b&&b&&b.exports==p&&b,l="object"==typeof c&&c;if(l.global===l||l.window===l)d=l;var r=String.fromCharCode,t,w,A;l={version:"2.0.0",encode:function(c){c=f(c);for(var b=c.length,d=-1,e,m="";++d<b;){e=c[d];if(0==(e&4294967168))e=r(e);else{var n="";0==(e&4294965248)?n=r(e>>6&31|192):0==(e&4294901760)?(h(e),n=r(e>>12&15|
224),n+=r(e>>6&63|128)):0==(e&4292870144)&&(n=r(e>>18&7|240),n+=r(e>>12&63|128),n+=r(e>>6&63|128));e=n+=r(e&63|128)}m+=e}return m},decode:function(c){t=f(c);w=t.length;A=0;c=[];for(var b;!1!==(b=q());)c.push(b);b=c.length;for(var d=-1,e,h="";++d<b;)e=c[d],65535<e&&(e-=65536,h+=r(e>>>10&1023|55296),e=56320|e&1023),h+=r(e);return h}};if(p&&!p.nodeType)if(k)k.exports=l;else{d={}.hasOwnProperty;for(var x in l)d.call(l,x)&&(p[x]=l[x])}else d.utf8=l})(this)}).call(this,"undefined"!==typeof global?global:
"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],61:[function(c,b,e){b.exports="function"===typeof Object.create?function(c,b){c.super_=b;c.prototype=Object.create(b.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}})}:function(c,b){c.super_=b;var d=function(){};d.prototype=b.prototype;c.prototype=new d;c.prototype.constructor=c}},{}],62:[function(c,b,e){b.exports=function(c){return c&&"object"===typeof c&&"function"===typeof c.copy&&"function"===
typeof c.fill&&"function"===typeof c.readUInt8}},{}],63:[function(c,b,e){(function(b,d){function f(c,b){var d={seen:[],stylize:v};3<=arguments.length&&(d.depth=arguments[2]);4<=arguments.length&&(d.colors=arguments[3]);x(b)?d.showHidden=b:b&&e._extend(d,b);E(d.showHidden)&&(d.showHidden=!1);E(d.depth)&&(d.depth=2);E(d.colors)&&(d.colors=!1);E(d.customInspect)&&(d.customInspect=!0);d.colors&&(d.stylize=h);return p(d,c,d.depth)}function h(c,b){return(b=f.styles[b])?"\u001b["+f.colors[b][0]+"m"+c+"\u001b["+
f.colors[b][1]+"m":c}function v(c,b){return c}function q(c){var b={};c.forEach(function(c,d){b[c]=!0});return b}function p(c,b,d){if(c.customInspect&&b&&G(b.inspect)&&b.inspect!==e.inspect&&(!b.constructor||b.constructor.prototype!==b)){var f=b.inspect(d,c);B(f)||(f=p(c,f,d));return f}if(f=k(c,b))return f;var h=Object.keys(b),m=q(h);c.showHidden&&(h=Object.getOwnPropertyNames(b));if(H(b)&&(0<=h.indexOf("message")||0<=h.indexOf("description")))return l(b);if(0===h.length){if(G(b))return c.stylize("[Function"+
(b.name?": "+b.name:"")+"]","special");if(C(b))return c.stylize(RegExp.prototype.toString.call(b),"regexp");if(D(b))return c.stylize(Date.prototype.toString.call(b),"date");if(H(b))return l(b)}f="";var n=!1,v=["{","}"];A(b)&&(n=!0,v=["[","]"]);G(b)&&(f=" [Function"+(b.name?": "+b.name:"")+"]");C(b)&&(f=" "+RegExp.prototype.toString.call(b));D(b)&&(f=" "+Date.prototype.toUTCString.call(b));H(b)&&(f=" "+l(b));if(0===h.length&&(!n||0==b.length))return v[0]+f+v[1];if(0>d)return C(b)?c.stylize(RegExp.prototype.toString.call(b),
"regexp"):c.stylize("[Object]","special");c.seen.push(b);h=n?r(c,b,d,m,h):h.map(function(e){return t(c,b,d,m,e,n)});c.seen.pop();return w(h,f,v)}function k(c,b){if(E(b))return c.stylize("undefined","undefined");if(B(b))return b="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",c.stylize(b,"string");if(z(b))return c.stylize(""+b,"number");if(x(b))return c.stylize(""+b,"boolean");if(null===b)return c.stylize("null","null")}function l(c){return"["+Error.prototype.toString.call(c)+
"]"}function r(c,b,d,e,f){for(var h=[],m=0,n=b.length;m<n;++m)Object.prototype.hasOwnProperty.call(b,String(m))?h.push(t(c,b,d,e,String(m),!0)):h.push("");f.forEach(function(f){f.match(/^\d+$/)||h.push(t(c,b,d,e,f,!0))});return h}function t(c,b,d,e,f,h){var m,n;b=Object.getOwnPropertyDescriptor(b,f)||{value:b[f]};b.get?n=b.set?c.stylize("[Getter/Setter]","special"):c.stylize("[Getter]","special"):b.set&&(n=c.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(e,f)||(m="["+f+"]");n||
(0>c.seen.indexOf(b.value)?(n=null===d?p(c,b.value,null):p(c,b.value,d-1),-1<n.indexOf("\n")&&(n=h?n.split("\n").map(function(c){return"  "+c}).join("\n").substr(2):"\n"+n.split("\n").map(function(c){return"   "+c}).join("\n"))):n=c.stylize("[Circular]","special"));if(E(m)){if(h&&f.match(/^\d+$/))return n;m=JSON.stringify(""+f);m.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(m=m.substr(1,m.length-2),m=c.stylize(m,"name")):(m=m.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),m=c.stylize(m,
"string"))}return m+": "+n}function w(c,b,d){var e=0;return 60<c.reduce(function(c,b){e++;0<=b.indexOf("\n")&&e++;return c+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)?d[0]+(""===b?"":b+"\n ")+" "+c.join(",\n  ")+" "+d[1]:d[0]+b+" "+c.join(", ")+" "+d[1]}function A(c){return Array.isArray(c)}function x(c){return"boolean"===typeof c}function z(c){return"number"===typeof c}function B(c){return"string"===typeof c}function E(c){return void 0===c}function C(c){return F(c)&&"[object RegExp]"===Object.prototype.toString.call(c)}
function F(c){return"object"===typeof c&&null!==c}function D(c){return F(c)&&"[object Date]"===Object.prototype.toString.call(c)}function H(c){return F(c)&&("[object Error]"===Object.prototype.toString.call(c)||c instanceof Error)}function G(c){return"function"===typeof c}function I(c){return 10>c?"0"+c.toString(10):c.toString(10)}function P(){var c=new Date,b=[I(c.getHours()),I(c.getMinutes()),I(c.getSeconds())].join(":");return[c.getDate(),N[c.getMonth()],b].join(" ")}var M=/%[sdj%]/g;e.format=
function(c){if(!B(c)){for(var b=[],d=0;d<arguments.length;d++)b.push(f(arguments[d]));return b.join(" ")}d=1;var e=arguments,h=e.length;b=String(c).replace(M,function(c){if("%%"===c)return"%";if(d>=h)return c;switch(c){case "%s":return String(e[d++]);case "%d":return Number(e[d++]);case "%j":try{return JSON.stringify(e[d++])}catch(rm){return"[Circular]"}default:return c}});for(var m=e[d];d<h;m=e[++d])b=null!==m&&F(m)?b+(" "+f(m)):b+(" "+m);return b};e.deprecate=function(c,f){if(E(d.process))return function(){return e.deprecate(c,
f).apply(this,arguments)};if(!0===b.noDeprecation)return c;var h=!1;return function(){if(!h){if(b.throwDeprecation)throw Error(f);b.traceDeprecation?console.trace(f):console.error(f);h=!0}return c.apply(this,arguments)}};var K={},O;e.debuglog=function(c){E(O)&&(O=b.env.NODE_DEBUG||"");c=c.toUpperCase();if(!K[c])if((new RegExp("\\b"+c+"\\b","i")).test(O)){var d=b.pid;K[c]=function(){var b=e.format.apply(e,arguments);console.error("%s %d: %s",c,d,b)}}else K[c]=function(){};return K[c]};e.inspect=f;
f.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};f.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};e.isArray=A;e.isBoolean=x;e.isNull=function(c){return null===c};e.isNullOrUndefined=function(c){return null==c};e.isNumber=z;e.isString=B;e.isSymbol=function(c){return"symbol"===
typeof c};e.isUndefined=E;e.isRegExp=C;e.isObject=F;e.isDate=D;e.isError=H;e.isFunction=G;e.isPrimitive=function(c){return null===c||"boolean"===typeof c||"number"===typeof c||"string"===typeof c||"symbol"===typeof c||"undefined"===typeof c};e.isBuffer=c("./support/isBuffer");var N="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");e.log=function(){console.log("%s - %s",P(),e.format.apply(e,arguments))};e.inherits=c("inherits");e._extend=function(c,b){if(!b||!F(b))return c;for(var d=Object.keys(b),
e=d.length;e--;)c[d[e]]=b[d[e]];return c}}).call(this,c("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":62,_process:43,inherits:61}],64:[function(c,b,e){if(window.mozRTCPeerConnection||navigator.mozGetUserMedia){var d="moz";var h=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)}else if(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)d="webkit",h=navigator.userAgent.match(/Chrom(e|ium)/)&&
parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10);c=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;e=window.mozRTCIceCandidate||window.RTCIceCandidate;var m=window.mozRTCSessionDescription||window.RTCSessionDescription,n=window.webkitMediaStream||window.MediaStream,v="https:"===window.location.protocol&&("webkit"===d&&26<=h||"moz"===d&&33<=h),q=window.AudioContext||window.webkitAudioContext,p=document.createElement("video");p=p&&p.canPlayType&&
"probably"===p.canPlayType('video/webm; codecs="vp8", vorbis');var k=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;b.exports={prefix:d,browserVersion:h,support:!!c&&!!k,supportRTCPeerConnection:!!c,supportVp8:p,supportGetUserMedia:!!k,supportDataChannel:!!(c&&c.prototype&&c.prototype.createDataChannel),supportWebAudio:!(!q||!q.prototype.createMediaStreamSource),supportMediaStream:!(!n||!n.prototype.removeTrack),supportScreenSharing:!!v,AudioContext:q,
PeerConnection:c,SessionDescription:m,IceCandidate:e,MediaStream:n,getUserMedia:k}},{}],65:[function(c,b,e){function d(){}b.exports=d;d.mixin=function(c){c=c.prototype||c;c.isWildEmitter=!0;c.on=function(c,b,d){this.callbacks=this.callbacks||{};var e=3===arguments.length,f=e?arguments[2]:arguments[1];f._groupName=e?arguments[1]:void 0;(this.callbacks[c]=this.callbacks[c]||[]).push(f);return this};c.once=function(c,b,d){function e(){f.off(c,e);m.apply(this,arguments)}var f=this,h=3===arguments.length,
m=h?arguments[2]:arguments[1];this.on(c,h?arguments[1]:void 0,e);return this};c.releaseGroup=function(c){this.callbacks=this.callbacks||{};var b,d;for(b in this.callbacks){var e=this.callbacks[b];var f=0;for(d=e.length;f<d;f++)e[f]._groupName===c&&(e.splice(f,1),f--,d--)}return this};c.off=function(c,b){this.callbacks=this.callbacks||{};var d=this.callbacks[c];if(!d)return this;if(1===arguments.length)return delete this.callbacks[c],this;var e=d.indexOf(b);d.splice(e,1);0===d.length&&delete this.callbacks[c];
return this};c.emit=function(c){this.callbacks=this.callbacks||{};var b=[].slice.call(arguments,1),d=this.callbacks[c],e=this.getWildcardCallbacks(c),f;if(d){var h=d.slice();d=0;for(f=h.length;d<f&&h[d];++d)h[d].apply(this,b)}if(e)for(h=e.slice(),d=0,f=h.length;d<f&&h[d];++d)h[d].apply(this,[c].concat(b));return this};c.getWildcardCallbacks=function(c){this.callbacks=this.callbacks||{};var b,d=[];for(b in this.callbacks){var e=b.split("*");if("*"===b||2===e.length&&c.slice(0,e[0].length)===e[0])d=
d.concat(this.callbacks[b])}return d}};d.mixin(d)},{}],66:[function(c,b,e){function d(c,b,d){return b?new h(c,b):new h(c)}c=function(){return this}();var h=c.WebSocket||c.MozWebSocket;b.exports=h?d:null;h&&(d.prototype=h.prototype)},{}],67:[function(c,b,e){function d(c){var b=!0;c.getTracks().forEach(function(c){b="ended"===c.readyState&&b});return b}function h(c){var b=this;v.call(this);this.id=c.id;this.parent=c.parent;this.type=c.type||"video";this.oneway=c.oneway||!1;this.sharemyscreen=c.sharemyscreen||
!1;this.browserPrefix=c.prefix;this.stream=c.stream;this.enableDataChannels=void 0===c.enableDataChannels?this.parent.config.enableDataChannels:c.enableDataChannels;this.receiveMedia=c.receiveMedia||this.parent.config.receiveMedia;this.channels={};this.sid=c.sid||Date.now().toString();this.pc=new n(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints);this.pc.on("ice",this.onIceCandidate.bind(this));this.pc.on("endOfCandidates",function(c){b.send("endOfCandidates",
c)});this.pc.on("offer",function(c){b.parent.config.nick&&(c.nick=b.parent.config.nick);b.send("offer",c)});this.pc.on("answer",function(c){b.parent.config.nick&&(c.nick=b.parent.config.nick);b.send("answer",c)});this.pc.on("addStream",this.handleRemoteStreamAdded.bind(this));this.pc.on("addChannel",this.handleDataChannelAdded.bind(this));this.pc.on("removeStream",this.handleStreamRemoved.bind(this));this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded"));this.pc.on("iceConnectionStateChange",
this.emit.bind(this,"iceConnectionStateChange"));this.pc.on("iceConnectionStateChange",function(){switch(b.pc.iceConnectionState){case "failed":"offer"===b.pc.pc.localDescription.type&&(b.parent.emit("iceFailed",b),b.send("connectivityError"))}});this.pc.on("signalingStateChange",this.emit.bind(this,"signalingStateChange"));this.logger=this.parent.logger;"screen"===c.type?this.parent.localScreens&&this.parent.localScreens[0]&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),
this.pc.addStream(this.parent.localScreens[0]),this.broadcaster=c.broadcaster):this.parent.localStreams.forEach(function(c){b.pc.addStream(c)});this.on("channelOpen",function(c){"https://simplewebrtc.com/protocol/filetransfer#inband-v1"===c.protocol&&(c.onmessage=function(d){d=JSON.parse(d.data);var e=new q.Receiver;e.receive(d,c);b.emit("fileTransfer",d,e);e.on("receivedFile",function(c,b){e.channel.close()})})});this.on("*",function(){b.parent.emit.apply(b.parent,arguments)})}e=c("util");var m=
c("webrtcsupport"),n=c("rtcpeerconnection"),v=c("wildemitter"),q=c("filetransfer");e.inherits(h,v);h.prototype.handleMessage=function(c){var b=this;this.logger.log("getting",c.type,c);c.prefix&&(this.browserPrefix=c.prefix);"offer"===c.type?(this.nick||(this.nick=c.payload.nick),delete c.payload.nick,this.pc.handleOffer(c.payload,function(c){c||b.pc.answer(function(c,b){})})):"answer"===c.type?(this.nick||(this.nick=c.payload.nick),delete c.payload.nick,this.pc.handleAnswer(c.payload)):"candidate"===
c.type?this.pc.processIce(c.payload):"connectivityError"===c.type?this.parent.emit("connectivityError",b):"mute"===c.type?this.parent.emit("mute",{id:c.from,name:c.payload.name}):"unmute"===c.type&&this.parent.emit("unmute",{id:c.from,name:c.payload.name})};h.prototype.send=function(c,b){b={to:this.id,sid:this.sid,broadcaster:this.broadcaster,roomType:this.type,type:c,payload:b,prefix:m.prefix};this.logger.log("sending",c,b);this.parent.emit("message",b)};h.prototype.sendDirectly=function(c,b,d){d=
{type:b,payload:d};this.logger.log("sending via datachannel",c,b,d);c=this.getDataChannel(c);if("open"!=c.readyState)return!1;c.send(JSON.stringify(d));return!0};h.prototype._observeDataChannel=function(c){var b=this;c.onclose=this.emit.bind(this,"channelClose",c);c.onerror=this.emit.bind(this,"channelError",c);c.onmessage=function(d){b.emit("channelMessage",b,c.label,JSON.parse(d.data),c,d)};c.onopen=this.emit.bind(this,"channelOpen",c)};h.prototype.getDataChannel=function(c,b){if(!m.supportDataChannel)return this.emit("error",
Error("createDataChannel not supported"));var d=this.channels[c];b||(b={});if(d)return d;d=this.channels[c]=this.pc.createDataChannel(c,b);this._observeDataChannel(d);return d};h.prototype.onIceCandidate=function(c){if(!this.closed)if(c){var b=this.parent.config.peerConnectionConfig;"moz"===m.prefix&&b&&b.iceTransports&&c.candidate&&c.candidate.candidate&&0>c.candidate.candidate.indexOf(b.iceTransports)?this.logger.log("Ignoring ice candidate not matching pcConfig iceTransports type: ",b.iceTransports):
this.send("candidate",c)}else this.logger.log("End of candidates.")};h.prototype.start=function(){this.enableDataChannels&&this.getDataChannel("simplewebrtc");this.pc.offer(this.receiveMedia,function(c,b){})};h.prototype.icerestart=function(){var c=this.receiveMedia;c.mandatory.IceRestart=!0;this.pc.offer(c,function(c,b){})};h.prototype.end=function(){this.closed||(this.pc.close(),this.handleStreamRemoved())};h.prototype.handleRemoteStreamAdded=function(c){var b=this;this.stream?this.logger.warn("Already have a remote stream"):
(this.stream=c.stream,this.stream.getTracks().forEach(function(c){c.addEventListener("ended",function(){d(b.stream)&&b.end()})}),this.parent.emit("peerStreamAdded",this))};h.prototype.handleStreamRemoved=function(){var c=this.parent.peers.indexOf(this);-1<c&&(this.parent.peers.splice(c,1),this.closed=!0,this.parent.emit("peerStreamRemoved",this))};h.prototype.handleDataChannelAdded=function(c){this.channels[c.label]=c;this._observeDataChannel(c)};h.prototype.sendFile=function(c){var b=new q.Sender,
d=this.getDataChannel("filetransfer"+(new Date).getTime(),{protocol:"https://simplewebrtc.com/protocol/filetransfer#inband-v1"});d.onopen=function(){d.send(JSON.stringify({size:c.size,name:c.name}));b.send(c,d)};d.onclose=function(){console.log("sender received transfer");b.emit("complete")};return b};b.exports=h},{filetransfer:26,rtcpeerconnection:44,util:63,webrtcsupport:64,wildemitter:65}],68:[function(c,b,e){function d(c){var b=this,d=c||{},e=this.config={url:"https://sandbox.simplewebrtc.com:443/",
socketio:{},connection:null,debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!1,peerVolumeWhenSpeaking:.25,media:{video:!0,audio:!0},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},localVideo:{autoplay:!0,mirror:!0,muted:!0}},f;var l=c.debug?c.logger||console:c.logger||q;this.logger=l;for(f in d)d.hasOwnProperty(f)&&(this.config[f]=d[f]);this.capabilities=n;m.call(this);var p=null===this.config.connection?this.connection=
new k(this.config):this.connection=this.config.connection;p.on("connect",function(){b.emit("connectionReady",p.getSessionid());b.sessionReady=!0;b.testReadiness()});p.on("message",function(c){var d=b.webrtc.getPeers(c.from,c.roomType);if("offer"===c.type){d.length&&d.forEach(function(b){b.sid==c.sid&&(e=b)});if(!e){var e=b.webrtc.createPeer({id:c.from,sid:c.sid,type:c.roomType,enableDataChannels:b.config.enableDataChannels&&"screen"!==c.roomType,sharemyscreen:"screen"===c.roomType&&!c.broadcaster,
broadcaster:"screen"!==c.roomType||c.broadcaster?null:b.connection.getSessionid()});b.emit("createdPeer",e)}e.handleMessage(c)}else d.length&&d.forEach(function(b){c.sid?b.sid===c.sid&&b.handleMessage(c):b.handleMessage(c)})});p.on("remove",function(c){c.id!==b.connection.getSessionid()&&b.webrtc.removePeers(c.id,c.type)});c.logger=this.logger;c.debug=!1;this.webrtc=new h(c);"mute unmute pauseVideo resumeVideo pause resume sendToAll sendDirectlyToAll getPeers".split(" ").forEach(function(c){b[c]=
b.webrtc[c].bind(b.webrtc)});this.webrtc.on("*",function(){b.emit.apply(b,arguments)});if(e.debug)this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:"));this.webrtc.on("localStream",function(){b.testReadiness()});this.webrtc.on("message",function(c){b.connection.emit("message",c)});this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this));this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this));this.config.adjustPeerVolume&&(this.webrtc.on("speaking",
this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1)));p.on("stunservers",function(c){b.webrtc.config.peerConnectionConfig.iceServers=c;b.emit("stunservers",c)});p.on("turnservers",function(c){b.webrtc.config.peerConnectionConfig.iceServers=b.webrtc.config.peerConnectionConfig.iceServers.concat(c);b.emit("turnservers",c)});this.webrtc.on("iceFailed",function(c){});this.webrtc.on("connectivityError",function(c){});this.webrtc.on("audioOn",
function(){b.webrtc.sendToAll("unmute",{name:"audio"})});this.webrtc.on("audioOff",function(){b.webrtc.sendToAll("mute",{name:"audio"})});this.webrtc.on("videoOn",function(){b.webrtc.sendToAll("unmute",{name:"video"})});this.webrtc.on("videoOff",function(){b.webrtc.sendToAll("mute",{name:"video"})});this.webrtc.on("localScreen",function(c){var d=document.createElement("video"),e=b.getRemoteVideoContainer();d.oncontextmenu=function(){return!1};d.id="localScreen";v(c,d);e&&e.appendChild(d);b.emit("localScreenAdded",
d);b.connection.emit("shareScreen");b.webrtc.peers.forEach(function(c){"video"===c.type&&(c=b.webrtc.createPeer({id:c.id,type:"screen",sharemyscreen:!0,enableDataChannels:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},broadcaster:b.connection.getSessionid()}),b.emit("createdPeer",c),c.start())})});this.webrtc.on("localScreenStopped",function(c){b.getLocalScreen()&&b.stopScreenShare()});this.webrtc.on("channelMessage",function(c,d,e){"volume"==e.type&&b.emit("remoteVolumeChange",c,e.volume)});
this.config.autoRequestMedia&&this.startLocalVideo()}var h=c("./webrtc"),m=c("wildemitter"),n=c("webrtcsupport"),v=c("attachmediastream"),q=c("mockconsole"),k=c("./socketioconnection");d.prototype=Object.create(m.prototype,{constructor:{value:d}});d.prototype.leaveRoom=function(){if(this.roomName){for(this.connection.emit("leave");this.webrtc.peers.length;)this.webrtc.peers[0].end();this.getLocalScreen()&&this.stopScreenShare();this.emit("leftRoom",this.roomName);this.roomName=void 0}};d.prototype.disconnect=
function(){this.connection.disconnect();delete this.connection};d.prototype.handlePeerStreamAdded=function(c){var b=this,d=this.getRemoteVideoContainer(),e=v(c.stream);c.videoEl=e;e.id=this.getDomId(c);d&&d.appendChild(e);this.emit("videoAdded",e,c);window.setTimeout(function(){b.webrtc.isAudioEnabled()||c.send("mute",{name:"audio"});b.webrtc.isVideoEnabled()||c.send("mute",{name:"video"})},250)};d.prototype.handlePeerStreamRemoved=function(c){var b=this.getRemoteVideoContainer(),d=c.videoEl;this.config.autoRemoveVideos&&
b&&d&&b.removeChild(d);d&&this.emit("videoRemoved",d,c)};d.prototype.getDomId=function(c){return[c.id,c.type,c.broadcaster?"broadcasting":"incoming"].join("_")};d.prototype.setVolumeForAll=function(c){this.webrtc.peers.forEach(function(b){b.videoEl&&(b.videoEl.volume=c)})};d.prototype.joinRoom=function(c,b){var d=this;this.roomName=c;this.connection.emit("join",c,function(e,f){console.log("join CB",e);P(f);if(e)d.emit("error",e);else{if(!f.xtra){Ya();Wb();Ue(x.errorLoading,"#ff0000");return}w.room=
f.xtra;var h,m;for(h in f.clients){var n=f.clients[h];for(m in n)if(n[m]){var v=d.webrtc.createPeer({id:h,type:m,enableDataChannels:d.config.enableDataChannels&&"screen"!==m,receiveMedia:{offerToReceiveAudio:"screen"!==m&&d.config.receiveMedia.offerToReceiveAudio?1:0,offerToReceiveVideo:d.config.receiveMedia.offerToReceiveVideo}});d.emit("createdPeer",v);v.start()}}}b&&b(e,f);d.emit("joinedRoom",c)})};d.prototype.getEl=function(c){return"string"===typeof c?document.getElementById(c):c};d.prototype.startLocalVideo=
function(){var c=this;this.webrtc.start(this.config.media,function(b,d){b?c.emit("localMediaError",b):v(d,c.getLocalVideoContainer(),c.config.localVideo)})};d.prototype.stopLocalVideo=function(){this.webrtc.stop()};d.prototype.getLocalVideoContainer=function(){var c=this.getEl(this.config.localVideoEl);if(c&&"VIDEO"===c.tagName)return c.oncontextmenu=function(){return!1},c;if(c){var b=document.createElement("video");b.oncontextmenu=function(){return!1};c.appendChild(b);return b}};d.prototype.getRemoteVideoContainer=
function(){return this.getEl(this.config.remoteVideosEl)};d.prototype.shareScreen=function(c){this.webrtc.startScreenShare(c)};d.prototype.getLocalScreen=function(){return this.webrtc.localScreens&&this.webrtc.localScreens[0]};d.prototype.stopScreenShare=function(){this.connection.emit("unshareScreen");var c=document.getElementById("localScreen"),b=this.getRemoteVideoContainer();this.config.autoRemoveVideos&&b&&c&&b.removeChild(c);c&&this.emit("videoRemoved",c);this.getLocalScreen()&&this.webrtc.stopScreenShare();
this.webrtc.peers.forEach(function(c){c.broadcaster&&c.end()})};d.prototype.testReadiness=function(){this.sessionReady&&(this.config.media.video||this.config.media.audio?0<this.webrtc.localStreams.length&&this.emit("readyToCall",this.connection.getSessionid()):this.emit("readyToCall",this.connection.getSessionid()))};d.prototype.createRoom=function(c,b){this.roomName=c;this.connection.emit("create",w.room,b)};d.prototype.sendFile=function(){if(!n.dataChannel)return this.emit("error",Error("DataChannelNotSupported"))};
b.exports=d},{"./socketioconnection":69,"./webrtc":70,attachmediastream:3,mockconsole:37,webrtcsupport:64,wildemitter:65}],69:[function(c,b,e){function d(c){this.connection=h.connect(c.url,c.socketio)}var h=c("socket.io-client");d.prototype.on=function(c,b){this.connection.on(c,b)};d.prototype.emit=function(){this.connection.emit.apply(this.connection,arguments)};d.prototype.getSessionid=function(){return this.connection.id};d.prototype.disconnect=function(){return this.connection.disconnect()};b.exports=
d},{"socket.io-client":50}],70:[function(c,b,e){function d(c){var b=this,d=c||{};this.config={debug:!1,peerConnectionConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[]},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},enableDataChannels:!0};var e;c=c.debug?c.logger||console:c.logger||m;this.logger=c;for(e in d)d.hasOwnProperty(e)&&(this.config[e]=d[e]);h.support||this.logger.error("Your browser doesn't seem to support WebRTC");this.peers=[];
n.call(this,this.config);this.on("speaking",function(){b.hardMuted||b.peers.forEach(function(c){c.enableDataChannels&&(c=c.getDataChannel("hark"),"open"==c.readyState&&c.send(JSON.stringify({type:"speaking"})))})});this.on("stoppedSpeaking",function(){b.hardMuted||b.peers.forEach(function(c){c.enableDataChannels&&(c=c.getDataChannel("hark"),"open"==c.readyState&&c.send(JSON.stringify({type:"stoppedSpeaking"})))})});this.on("volumeChange",function(c,d){b.hardMuted||b.peers.forEach(function(b){b.enableDataChannels&&
(b=b.getDataChannel("hark"),"open"==b.readyState&&b.send(JSON.stringify({type:"volume",volume:c})))})});if(this.config.debug)this.on("*",function(c,d,e){(b.config.logger===m?console:b.logger).log("event:",c,d,e)})}e=c("util");var h=c("webrtcsupport"),m=c("mockconsole"),n=c("localmedia"),v=c("./peer");e.inherits(d,n);d.prototype.createPeer=function(c){c.parent=this;c=new v(c);this.peers.push(c);return c};d.prototype.removePeers=function(c,b){this.getPeers(c,b).forEach(function(c){c.end()})};d.prototype.getPeers=
function(c,b){return this.peers.filter(function(d){return(!c||d.id===c)&&(!b||d.type===b)})};d.prototype.sendToAll=function(c,b){this.peers.forEach(function(d){d.send(c,b)})};d.prototype.sendDirectlyToAll=function(c,b,d){this.peers.forEach(function(e){e.enableDataChannels&&e.sendDirectly(c,b,d)})};b.exports=d},{"./peer":67,localmedia:35,mockconsole:37,util:63,webrtcsupport:64}]},{},[68])(68)})},E,va,x={},w={name:localStorage.name,color:localStorage.color||"#ff0000"},Mc=function(){};console.log("%c nehhon %c POWER ",
"background: #00ffd4; color: #000; font-size:20px","background: #000; color: #00ffd4; font-size:20px");console.log("%c Author: Ruben ","background: #000; color: #00ffd4; font-size:20px");console.log("%c webmaster@nehhon.com ","background: #00ffd4; color: #000; font-size:20px");console.log("%c @nehhon ","background: #000; color: #00ffd4; font-size:20px");void 0===localStorage.fullscreen&&(localStorage.fullscreen=!0);console.log=Mc;console.error=Mc;console.warn=Mc;console.info=Mc;var t=function(b){return document.getElementById(b)};
(function(){var b=!!window.opr||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),c="undefined"!==typeof InstallTrigger,d=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),e=!!document.documentMode,f=!e&&!!window.StyleMedia,h=!!window.chrome&&!!window.chrome.webstore,m;b?m="Opera":c?m="Firefox":d?m="Safari":e?m="IE":f?m="Edge":h&&(m="Chrome");w.navLang=navigator.language||navigator.userLanguage;b=w.navLang.substr(0,2);c={es:["Tzared","Juego de estrategia en tiempo real para navegadores web, juega solo o con amigos",
"tzared,jugar,multijugador,juego,online,navegador web,tzar"],it:["Tzared","Gioco di strategia in tempo reale per browser web, giocare da soli o con gli amici","tzared,giocare,multigiocatore,gioco,online,navigatore,tzar,web"],pl:["Tzared","Gra strategiczna w czasie rzeczywistym dla przegl\u0105darek internetowych, bawi\u0107 si\u0119 samotnie lub z przyjaci\u00f3\u0142mi","tzared,gra,multiplayer,online,tzar,przegl\u0105darka internetowa"],ru:["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u043b\u044f \u0432\u0435\u0431-\u0431\u0440\u0430\u0443\u0437\u0435\u0440\u043e\u0432, \u0438\u0433\u0440\u0430\u0442\u044c \u0432 \u043e\u0434\u0438\u043d\u043e\u0447\u043a\u0443 \u0438\u043b\u0438 \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438",
"\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u044c\u0442\u0438\u043f\u043b\u0435\u0435\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u0435\u0440,\u043e\u0433\u043d\u0451\u043c \u0438 \u043c\u0435\u0447\u043e\u043c"],pt:["Tzared","Jogo de estrat\u00e9gia em tempo real para navegadores da web, jogar sozinho ou com amigos","tzared,jogar,multiplayer,jogo,online,navegador web,tzar"],bg:["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0447\u0435\u0441\u043a\u0430 \u0438\u0433\u0440\u0430 \u0432 \u0440\u0435\u0430\u043b\u043d\u043e \u0432\u0440\u0435\u043c\u0435 \u0437\u0430 \u0443\u0435\u0431 \u0431\u0440\u0430\u0443\u0437\u044a\u0440\u0438, \u0438\u0433\u0440\u0430\u0439\u0442\u0435 \u0441\u0430\u043c\u0438 \u0438\u043b\u0438 \u0441 \u043f\u0440\u0438\u044f\u0442\u0435\u043b\u0438",
"\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u0442\u0438\u043f\u043b\u0435\u0439\u044a\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u044a\u0440"],de:["Tzared","Echtzeit-Strategiespiel f\u00fcr Webbrowser, alleine oder mit Freunden spielen","tzared,multiplayer,spiel,online,Webbrowser,tzar"],en:["Tzared","Real-time strategy game for web browsers, play alone or with friends","tzared,play,multiplayer,game,online,browser,tzar,web"]};c[b]||(b=
"en");document.getElementsByTagName("html")[0].lang=b;c=c[location.search.split("lang=")[1]||"en"];document.getElementsByTagName("title")[0].innerHTML=c[0];document.getElementsByTagName("meta").description=c[1];document.getElementsByTagName("meta").keywords=c[2];w.lang="en es it pt ru pl bg de".split(" ").indexOf(b);0>w.lang&&(w.lang=0);w.langstr=b;w.race=0;w.navigator=m;w.mx=151;w.onlineID=null;w.temperature=0})();var xi=Mc,zi=function(g){g--;var c=new XMLHttpRequest;c.open("GET","/nehhon/"+
w.langstr+".json",!0);c.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");c.onreadystatechange=function(){if(4==c.readyState&&200==c.status){var g=JSON.parse(c.response);xi=function(){for(var c=B,b=0;b<c.length;b++){var d=c[b].name;g[d]&&(c[b].name=g[d])}for(b=0;b<C.length;b++)c=C[b],g[c.name[0]]&&g[c.name[1]]&&(c.name[0]=g[c.name[0]],c.name[1]=g[c.name[1]]);g=null};for(var e=[],f=0;0>f;f++)"undefined"!=typeof b[f]&&null!=b[f].tech&&(e.push(b[f].tech.name),Object.freeze(b[f].tech));
for(f=0;f<e.length;f++)e[f][0]=g[e[f][0]],e[f][1]=g[e[f][1]];e=Object.keys(x);for(f=0;f<e.length;f++){var h=e[f];void 0!=g[x[h]]&&(x[h]=g[x[h]])}Object.freeze(x);for(f=0;f<Za.length;f++)Za[f]=g[Za[f]];for(f=0;f<0*Fg.length;f++)Fg[f]=g[Fg[f]];Object.freeze(Za);yi()}};c.send()},yi=function(){for(var b=["refreshButton",x.refresh,"optionsButton",x.options,"startButton",x.play,"backButton",x.back,"closeButton",x.close,"quitButton",x.quit,"continueButton",x.continue],c=0,d=b.length;c<d;c+=2)for(var e=document.getElementsByClassName(b[c]),
f=0,h=e.length;f<h;f++)e[f].innerHTML=b[c+1];b=["alertok",x.ok,"sendMessageH2",x.chatMsg,"mapsizeOption",x.mapSize,"startingResourcesOption",x.startingResources,"goldWord",x.gold,"stoneWord",x.stone,"foodWord",x.food,"woodWord",x.wood,"gameMenu",x.menu,"infiniteWord",x.infinite,"backToGame",x.backToGame,"backToGameS",x.backToGame,"musicVolume",x.musicVolume,"soundVolume",x.soundVolume,"menueditor",x.menu,"terrainOption",x.terrainOption,"saveGame",x.savegame,"playrecord",x.loadRecord,"seeStats",x.stats,
"selectBuilds",x.builds,"selectUnits",x.units,"selectItems",x.items,"selectNature",x.nature,"gamesFound",x.gamesFound,"strSearch",x.strSearch.split("| ")[1],"strCreate",x.strCreate.split("| ")[1],"strRandomMap",x.randomMap,"strcusMap",x.strcusMap,"strMapEditor",x.mapMaking,"h2cusmap",x.strcusMap,"h2rndMap",x.randomMap,"mapProps",x.options,"mapRules",x.rules,"editCustom",x.editMap,"strSettings",x.strSettings];c=0;for(d=b.length;c<d;c+=2)document.getElementById(b[c]).innerHTML=b[c+1]};0<w.lang?(zi(w.lang),
zi.translated=!0):yi();var P=console.log,Rk=document.getElementById("alerttitle"),Sk=document.getElementById("alerttext"),Tk=document.getElementById("alert"),pd=function(b,c,d){Tk.style.display="block";Rk.innerHTML=c||x.warning;Sk.innerHTML=b;d?document.getElementById("alertok").style.display="none":document.getElementById("alertok").style.display="block";t("basic").style.filter="blur(94px)"},ki,Bi=function(b,c,d){var g=new XMLHttpRequest;g.open("GET",b,!0);g.responseType="arraybuffer";g.setRequestHeader("Content-type",
" text / plain; charset = dropbox - cors - hack");g.onload=function(){c.length?S[c]=Ai(g.response):S.xtra[c]=Ai(g.response);S.load++;Ub&&S.load===S.images&&Ub()};d&&(g.onprogress=function(c){d(c)});g.send("")},Ai=function(b){performance.now();b=new Uint16Array(b);var c=b.length,g=b[c-4]+65536*b[c-3],e=b[c-2]+65536*b[c-1];c-=2;var f=-1;e=new Uint8Array(4*e);for(var h=0;g<c;g++){var m=b[g];if(65533<m){65535==m?(m=b[g+1],g+=1):(m=b[g+1]+65536*b[g+2],g+=2);for(var n=0;n<m;n++)e[h++]=f&255,e[h++]=f>>8&
255,e[h++]=f>>16&255,e[h++]=f>>24&255}else m=b[2*m]+65536*b[2*m+1],e[h++]=m&255,e[h++]=m>>8&255,e[h++]=m>>16&255,e[h++]=m>>24&255,f=m}return e},yc=function(){var b=["mpc0k7ep2l0v0j2/icons.png","iea7wlmxml6pus0/images.json","avpm3elzmphq5b1/graphics.nh17","agjeb95idjel2dr/terrainData.json?v5","xg1qh97bjrm61x0/grass.nh17"];b=b.concat(Gg);var c=b.length;yc.max=c;for(var d=0;d<c;d++)Uk("https://dl.dropboxusercontent.com/s/"+b[d]);this.innerHTML="0%";this.disabled=!0;yc.button=this};yc.loaded=0;var Uk=
function(b){var c=new XMLHttpRequest;c.open("GET",b,!0);c.responseType="arraybuffer";c.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");c.onload=function(){yc.loaded++;yc.button.innerHTML=~~(100*yc.loaded/yc.max+.5)+"%"};c.send("")},S={size:512,load:0,xtra:[]},Ub;S.xtraRes=[];var T={page:0,length:8,leftButton:document.getElementById("aleft"),rightButton:document.getElementById("aright"),stock:document.getElementById("stock")},l;(function(){var b=0,c=0,d=function(g){g.target.loadedSize||
(c+=g.total,g.target.lastLoaded=0,g.target.loadedSize=!0);b+=g.loaded-g.target.lastLoaded;g.target.lastLoaded=g.loaded;t("loadingtext").innerHTML=x.loadgraphics+~~(100*b/c)+"%"},e=function(c){var b=!!c.icons;S.images=Object.keys(c).length;if(b){var g=new XMLHttpRequest;g.open("GET",c.icons,!0);g.responseType="arraybuffer";g.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");g.onreadystatechange=function(){if(4===g.readyState&&200===g.status){var c=new Uint8Array(g.response);
c=new Blob([c],{type:"image/png"});var b=new Image;b.src=URL.createObjectURL(c);S.load++;T.icons=b;Ub&&S.load===S.images&&Ub();Date.now()}};g.onprogress=function(c){d(c)};g.send("")}Date.now();var e=new XMLHttpRequest;e.open("GET",c.imageJSON,!0);b&&e.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");e.onreadystatechange=function(){4==this.readyState&&200==this.status&&(S.load++,Ub&&S.load===S.images&&Ub(),l=JSON.parse(e.response))};e.onprogress=function(c){d(c)};e.send(!0);
Bi(c.common,"common",d)};(function(){var c=!1;"serviceWorker"in navigator?(console.log("CLIENT: service worker registration in progress."),navigator.serviceWorker.register("/sworker.js").then(function(c){console.log("CLIENT: service worker registration complete.")},function(c){P(c);console.log("CLIENT: service worker registration failure.")}),navigator.serviceWorker.oncontrollerchange=function(){console.log("page controlled by:",navigator.serviceWorker.controller);location.reload(!0)}):console.log("CLIENT: service worker is not supported.");
ki=function(){S.started=!0;c||(c=!0,e({icons:"https://dl.dropboxusercontent.com/s/mpc0k7ep2l0v0j2/icons.png",imageJSON:"https://dl.dropboxusercontent.com/s/iea7wlmxml6pus0/images.json",common:"https://dl.dropboxusercontent.com/s/avpm3elzmphq5b1/graphics.nh17"}))}})()})();var tg={grass:{json:"agjeb95idjel2dr/terrainData.json?v5",main:"xg1qh97bjrm61x0/grass.nh17"},snow:{json:"hwja6mugluokbkh/terrainData.json?v3",main:"1x2cwzm0i7v2sz8/terrain.nh17?v1"},last:""},Ve,Ik=function(){S.images+=2;var b=tg[t("terrainSelect").value];
tg.last=t("terrainSelect").value;var c=new XMLHttpRequest;c.open("GET","https://dl.dropboxusercontent.com/s/"+b.json,!0);c.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");c.onreadystatechange=function(){if(4==this.readyState&&200==this.status){S.xtraRes[0]=JSON.parse(c.response);ic=S.xtraRes[0];var b=ic.specialColor;Ve=new Float32Array(yb(b[0]/255,b[1]/255,b[2]/255,.9));S.load++;b="rgb("+b[0]+","+b[1]+","+b[2]+")";t("msgs1").style.color=b;t("playersinfo").style.color=
b;t("topinfo").style.color=b;Ub&&S.load===S.images&&Ub()}};c.send(!0);Bi("https://dl.dropboxusercontent.com/s/"+b.main,0,!1)},nc,qd,We,zc,Xe,Hg,Pd,Ci,Qd,Di,Ei,K,Ye,Rd,Va,Ig,Ha,pa,Ze={},Gg="kwf09yi8p5vq1px/Tzar%20Soundtrack%201.mp3 0d7r5b6yq8rvzxa/Tzar%20Soundtrack%202.mp3 6sc2lejtpq5hn1p/Tzar%20Soundtrack%203.mp3 0r454nszfs18sk8/Tzar%20Soundtrack%204.mp3 2qza05mvhvojepw/Tzar%20Soundtrack%205.mp3 55yuwxmo3ebav3v/Tzar%20Soundtrack%206.mp3 d9ifze8utu7b1d4/Tzar%20Soundtrack%207.mp3 ewnlwat5mpm3a6i/Tzar%20Soundtrack%208.mp3 emy8tmk7wrbxqik/Tzar%20Soundtrack%209.mp3 0ryt8t85pu140ys/Tzar%20Soundtrack%2010.mp3 ux3nmflf1efo0si/sr1.mp3 mb8leyhrlx3a8ep/sr2.mp3 uepj5sz037fs6jm/sr3.mp3 aqgug89aiyh78ym/sr4.mp3 v4mnk06t1cm5g2x/sr5.mp3 nnkkl7jddynbbg8/sr6.mp3 0foqk5c3t91c0ll/sr7.mp3 cacamdny4wwisyj/sr8.mp3 m8mbt8r1vlj2i9l/sr9.mp3 ubig3no0l96pnxp/sr10.mp3 jajip2pw72hwz5q/1.mp3 eub8hy6mtuw12vk/2.mp3 mml4nqhhj0ph30d/3.mp3 p72cdqjbjc7oa6v/4.mp3 m895z5a7e1stzg1/5.mp3 ya1yue1ti1ehyo8/6.mp3 lfq7ac9jvtcb8tr/7.mp3 onxh886y06v9c1m/8.mp3 u01v2nu5u1mooma/9.mp3 hfvvah4t7ngs942/10.mp3 zghe44ohag94non/INTRO.mp3 bjdukzb5x2d148f/OUTRO.mp3 m335ymfbydtah6n/WIN1.mp3 j0nl2nra3633p0m/WIN2.mp3 9igi2qh7ixqej07/ATTACK.WAV d48c9woeedsefpq/BALLISTA.WAV toc4s5nzofcrl7a/BLDGDONE.WAV c8k3wd0wmlgxzbj/CHAT%20LOCATION.WAV ser4l9wo87txp9k/TECHDONE.WAV 9f37sjm7co5ccuj/UNITDONE.WAV 6xn0s3j79267158/CHAT.WAV v39gv0xmfobxhm6/E_CASTLE1.WAV 2d9cjalgge5ig3g/E_CATHEDRAL1.WAV xmfkvzft63m3ivi/E_CATHEDRAL2.WAV vzzhxrrqftezh2b/E_FARM1.WAV ftrazbogpf8foip/E_CHURCH1.WAV 961xangoq096ta1/E_FARM2.WAV 5927kzdwz5znu6o/E_HARBOR1.WAV wwjtlgwpm230rqx/E_LUMBER1.WAV a4buxao1lfo5txs/E_MAGETOWER1.WAV mgcz1j57ijivnrx/E_MAGETOWER2.WAV mlqr06rsg0ebg5c/E_MAGETOWER3.WAV jcut9rj4pedruuf/E_MARKET1.WAV m7rpubt227a2mqm/E_SHIPYARD1.WAV dtlikm0f72bqts6/E_STABLES1.WAV 189t8l14j3gfbcd/E_STORAGE1.WAV 6u92t20jjl2ibax/E_OUTPOST1.WAV o6psq5jg611te7h/E_STORAGE2.WAV jpnp0pwsjfajpqh/E_TAVERN1.WAV omdobwnv6ijrdk6/E_WARACADEMY1.WAV xfph6w0wl72iy14/E_WORKSHOP1.WAV m9nzrabgjly054c/EVILCASTLE.WAV o1vdoiexa6q41kd/GATE1.WAV 0i8okhmc24fie1i/GATE2.WAV gcic4rgv7th76g5/GATE3.WAV 1gcczjnk6800a0w/GATE4.WAV s35f76gtwm27r2t/GATE5.WAV jkkktkeqcinw0qk/GATE6.WAV 0qsz059kx5x0fna/GATEWAY.WAV dx4ykguy0c2gkec/HOUSE1.WAV 0bu3c206awygol8/HOUSE2.WAV ixuujwh5i34jqyn/HOUSE3.WAV gtsdx7aq1qo1af9/HOUSE4.WAV y89q2pti77rnl62/HOUSE5.WAV slzdb82f2pq9efh/MERCHANT.WAV hxb9ppcht4b1agh/MINE1.WAV kmvph19wybjvtk3/MONASTERY1.WAV trjbjumhpdq2r6c/MONASTERY2.WAV xdzl5qyez51vp0i/R_CATHEDRAL1.WAV 0jfe5axwda2zy9m/R_CHURCH1.WAV jp0ya01e6lovbpv/SHAOLIN2.WAV sa97rwaqc4bczzg/SHAOLIN.WAV ba9yor9562k8rmk/CHOP%201.WAV 0yq403uktwmaskq/CHOP%202.WAV oumccxj3ppx74lb/CHOP%203.WAV zjlmh6oyt9z80vn/CHOP%204.WAV 8q3x45ooavhgdxf/CHOP%205.WAV tyyuf0ai2b7td9d/CHOP%206.WAV mxk7ilq612mco8y/CHOP%207.WAV vi1nql8csgxue0d/CHOP%208.WAV ptkzwv8er5r250q/CHOP%209.WAV e47rp6twlz7cvor/CHOP%2010.WAV swpbug0t56ool1r/CHOP%2011.WAV 2ddruqf84gi974h/DIG%201.WAV mdv1kf8bb7e6bwj/DIG%202.WAV u7h8iw95x8ufogy/DIG%203.WAV myb354s27trhsgb/MINE%201.WAV 3jca7grtu2uphde/MINE%202.WAV 0sgl0kc77mryj1j/MINE%203.WAV ry9mlisv1lqqp9d/HIT%201.WAV 2ufyfcq4wu9bk1i/HIT%202.WAV cqzlr7gy6mj0k66/HIT%203.WAV i86tqxj1sz91cru/HIT%204.WAV vf604r6t01qe6zd/HIT%205.WAV mnslicm4wy9wdj0/HIT%206.WAV p1ta2wlhfse37db/HIT%207.WAV emwp2hib6msgj22/GHOST1.WAV lrsl9rbxku5cjg7/GHOST2.WAV txbl2bb91s38dqx/GOLEM1.WAV pcfkaldpd7hfrjp/GOLEM2.WAV ivfai5ayu6q99yx/H%20SWORD%201.WAV gedtsneew008x4h/H%20SWORD%202.WAV 57xjkhtc93001et/H%20SWORD%203.WAV ni97b3dbi91yr8b/H%20SWORD%204.WAV 0ls1kz4but9zl51/H%20SWORD%205.WAV ks9mme9djnvdyi5/H%20SWORD%206.WAV hlinmaxi6xj6mv2/H%20SWORD%207.WAV hlinmaxi6xj6mv2/H%20SWORD%207.WAV dt4o378w3100sfu/H%20SWORD%208.WAV ks909spplow4fjz/H%20SWORD%209.WAV w2xfv47ffd7sb72/H%20SWORD%2010.WAV ypapwgz03m7utmq/H%20SWORD%2011.WAV zdcr00adm5qc6hs/H%20SWORD%2012.WAV y90qo1djcx5bzxa/HAND1.WAV 56vhwy7iiu9cpzy/HAND2.WAV 6zhms0m94qg4mvt/HAND3.WAV 41wm4r3cpgjaxly/HAND4.WAV tt4q17tzh6i7u1g/MAGE%20ATTACK.WAV ldhx6mr9upxefci/MESSIAH.WAV 07mie3az1eg1xxh/ORC%20SWORD%201.WAV 9v7spriyxf9szgh/ORC%20SWORD%202.WAV gcfojobbzl2drpn/ORC%20SWORD%203.WAV x0wz0zwpye9i5y3/ORC%20SWORD%204.WAV 2300jmtwppvm452/ORC%20SWORD%205.WAV 3yz2rottu8o8ggt/ORC%20SWORD%206.WAV x5s65vpufpj8t06/ORC%20SWORD%20V1.WAV 0nrb17mzbu3lxtc/ORC%20SWORD%20V2.WAV cypkkpihc1w1hcq/ORC%20SWORD%20V3.WAV y8umilh5cud7jih/SHIP%20CANNON%201.WAV 09kjxvpfn9bdprd/SHIP%20CANNON%202.WAV atj8b8w1k24aqfm/SHIP%20CANNON%203.WAV 6ju34h2pw3nhg7s/SHIP%20CANNON%204.WAV l18s2fbq9q6nzpm/SHIP%20CANNON%205.WAV vrgh4puvgdbpwae/SHIP%20CANNON%206.WAV tmbpku710qnx85q/SHIP%20CANNON%207.WAV 2nomenens1x41lf/SIEGE.WAV 8t9zd51oee3n6vw/SWORD%201.WAV gmwu6lxjaf4mxvv/SWORD%202.WAV tfjzh0u37b60xfc/SWORD%203.WAV s0w71lijsebscys/SWORD%204.WAV 63xcxvtf6fz4nmv/SWORD%205.WAV qpqihts3djiavqd/SWORD%206.WAV zw2cqwnqq5bo3aw/SWORD%207.WAV ub1hntg5qh5h58k/SWORD%208.WAV r4viyma73vblsf5/SWORD%209.WAV 8lxp86hri1yejyt/SWORD%2010.WAV r63199ryslobulc/SWORD%2011.WAV ph48z41qbgbaina/SWORD%2012.WAV o87veypm8qensdd/SWORD%2013.WAV fwapbo29d97mer1/SWORD%2014.WAV tyzv9eybfmt378i/SWORD%2015.WAV 0164fmqamf7yr9s/SWORD%2016.WAV c9renf4qsr56ab4/V%20SWORD%201.WAV gge4f1nb5o7m9qd/V%20SWORD%202.WAV wo0f0ul88unnh01/V%20SWORD%203.WAV q48z5txon4bv76v/V%20SWORD%204.WAV kibmb5mtp1oasan/V%20SWORD%205.WAV 360bl44ii251dus/V%20SWORD%206.WAV oya931j5cn584vn/V%20SWORD%207.WAV rgh3xwlvihecsur/ADRAGON2.WAV jafi9t4hdx4gjnu/ADRAGON3.WAV p7yau58i9x9tznf/ARROW%201.WAV 16jf0mu2c4902ad/ARROW%202.WAV 3gf1vmhszlzsvp6/ARROW%203.WAV hastp290kjpatul/ARROW%204.WAV rzf63kcptscqqb6/ARROW%205.WAV ueysrsca11dznn1/ARROW%206.WAV 2l7ncb4kro91hjp/ARROW%20V1.WAV 6z1zfcuve202wlt/ARROW%20V2.WAV 4al06dvukghp9p8/ARROW%20V3.WAV y3cj0obmsklz7kb/ARROW%20V4.WAV zopzovz1zdos9qn/BEAR1.WAV glbc40fzxrz7x4u/BEAR2.WAV mq7830e9lsw539i/BEAR3.WAV s5h4p53936jqf0m/BEAR4.WAV at4kj0gz88632rt/BEAR5.WAV uq2u4sgg8g6tmou/MWORKSHOP.WAV 09hjcqjlhkgwjsi/DESTROY%20BUILDING.WAV rxan7ebabmxn77z/DESTROY%20MINE.WAV pcwbjrjklna7q57/LIGHTING2.WAV uv2jv59kstujpap/LIGHTING.WAV 6omy17asgyyvcdg/METEOR.WAV r193yz5l7k7yb2i/SMALL%20EXPLOSION.WAV os6jelw7rx49obm/WATER%20BLOP.WAV tjdz2vmlil8c8ud/SPY%20KILL%201.WAV z9tqra8z2pj8fto/SPY%20KILL%203.WAV l85d5424o8s1tq3/SPY%20KILL%202.WAV 97k844atrp03l71/PRIEST%20ATTACK.WAV 2rs81eunjj79t8m/LIGHTNING.WAV i16vdcztiiyd9pl/INVISIBLE.WAV 01a581w494e6nc3/HEAL.WAV v0f62hdvhy2vhiw/FREEZE.WAV e9xkwqnmq1h3xii/FLAME%20BALL.WAV yn1958raqi2el4a/CURSE.WAV 455t0hvitbn4nns/CRUSADE.WAV 1wl7qmtar3y1j2v/CONFUSION.WAV fz21lqeozbq043o/BLESS.WAV xyq2n7ixn80pyn5/WHIRLPOOL.WAV 1t99pip34fvthkq/TURN%20TO%20STONE.WAV jdclsge6rjo7vgo/TEACH.WAV xt7pqtetzsvtgai/SUMMON10.WAV yxcdbheu9s6sqbp/SUMMON9.WAV oum26s9h0mkg6ya/SUMMON8.WAV 46cvrb8px83r1ze/SUMMON7.WAV of68oo8ne7cgdtw/SUMMON6.WAV 3awiprcaujqvohu/SUMMON5.WAV 5kq2b6q3d8ncpww/SUMMON4.WAV avx69olt3m6rrnr/SUMMON3.WAV m08n1qafeiyqe05/SUMMON2.WAV ui2kvbd47bfmx2b/SUMMON1.WAV k8qekk7sutmpcot/REVEAL.WAV 0q9fghfa9qhq5qw/RESSURECT.WAV cb1pq0ssnmj4jic/COWDIE1.WAV f7wgvizjaklyf7n/COWDIE2.WAV cb1pq0ssnmj4jic/COWDIE1.WAV y5zib4fpfywsurg/COWDIE3.WAV oy9j73ss27gix5z/COWDIE4.WAV 1eyn0em70qu0f2i/DIE%201.WAV 27kh2wyo2o9znoz/DIE%202.WAV u572ytnhxy4km3h/DIE%203.WAV 182gaz77ml2mei7/DIE%204.WAV wpvdhtxbe6yy29z/DIE%205.WAV un94l6ebn0l9y2p/DIE%206.WAV 3k2ph5z9vm6ytvz/DIE%207.WAV hjnvqvyet103hf7/DIE%208.WAV umjfyhfxku3dwvp/DIE%209.WAV x1evcyyuhwy2vd3/DIE%2010.WAV xzk59hp6c4wdk3t/DRAGON%20DIE%201.WAV ar7eck4ow8r5w3s/DRAGON%20DIE%202.WAV emwp2hib6msgj22/GHOST1.WAV lrsl9rbxku5cjg7/GHOST2.WAV 6at0jqhx4dza704/GOLEM.WAV h5ydq4j2zdpkiu8/H%20DIE%201.WAV 1bp2u30m504f314/H%20DIE%202.WAV r5kdxiuj8chfl55/H%20DIE%203.WAV 0gubmigjng965ss/H%20DIE%204.WAV 4xzstnrfwevpx21/H%20DIE%205.WAV pnrvg1i5b0jf50i/H%20DIE%206.WAV wkzig2jil3z2hgi/H%20DIE%207.WAV ue13nwsyc6t5ox9/H%20DIE%208.WAV dxk8rptrddombo8/H%20DIE%209.WAV tsdk3uma1x5rz2v/H%20DIE%2010.WAV i3x6klg1g1tx9xx/MAGE.WAV t7c9h3ntknga8i7/ORC%20DIE%201.WAV zwf40uvu5rdu1wy/ORC%20DIE%202.WAV p9gga0rk3ftkkdf/SHIP%20SINK.WAV 5ihoed06p5cm26r/SIEGE%20DIE%201.WAV tahsd6hynfrv1qg/SIEGE%20DIE%202.WAV xboh1sh4rbvx88r/SIEGE%20DIE%203.WAV 4chclvk26ech3mz/SIEGE%20DIE%204.WAV w401vbbvvj99msr/SKELETON%20DIE%201.WAV 0ff119o39785ttm/SKELETON%20DIE%202.WAV 6lxfa75vtxfl2bb/SKELETON%20DIE%203.WAV f3aokr2ngvqpfit/SKELETON%20DIE%204.WAV omfzz21cazinkkm/MESSIAH_ATTACK.WAV 1w2vexiw5aqtrw4/C%20DIE%201.WAV h32280ztxrrz5aa/C%20DIE%202.WAV rq5rgbwaynrdtfc/C%20DIE%203.WAV usywc7awecnolh0/C%20DIE%204.WAV x33opiu95eb78ie/C%20DIE%205.WAV 4lo6hly2n52aq5b/CAMELDIE1.WAV gwsglwtm1fg2eqf/CAMELDIE2.WAV u3mxrmlb10sje2u/CAMELDIE3.WAV nw0ipg198lvq519/BAT%20ATTACK.WAV hukqtscgut9xic7/BAT%20CMD.WAV 77915sxy83vzump/BAT%20DIE.WAV".split(" "),
sg=function(){if(!nc){var b=function(c,b,g){b=b.split("/")[1].split(".")[0].toLowerCase();Ze[b]=c;!g||g.music&&g.mid!=Ha.id||(pa(b,g.x,g.y,g.k,g.music,g.date),g.date=0)},c=function(c,b,g){this.context=c;this.urlList=b;this.onload=g;this.loadCount=0};c.prototype.loadBuffer=function(c,g){var d=new XMLHttpRequest;d.open("GET",h+c,!0);d.responseType="arraybuffer";d.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");var e=this;d.onreadystatechange=function(){4===d.readyState&&
200===d.status&&e.context.decodeAudioData(d.response).then(function(d){d&&b(d,c,g)})};d.send()};for(var d=0,e=Gg.length;d<e;d++){var f=Gg[d];Ze[f.split("/")[1].split(".")[0].toLowerCase()]=f}qd="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206 arrow%20v1 arrow%20v2 arrow%20v3 arrow%20v4".split(" ");We="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206".split(" ");zc="sword%201 sword%202 sword%203 sword%204 sword%205 sword%206 sword%207 sword%208 sword%209 sword%2010 sword%2011 sword%2012 sword%2013 sword%2014 sword%2015 sword%2016 v%20sword%201 v%20sword%202 v%20sword%203 v%20sword%204 v%20sword%205 v%20sword%206 v%20sword%207".split(" ");
Xe=["siege"];Hg=["hand1","hand2","hand3","hand4"];Pd="h%20sword%201 h%20sword%202 h%20sword%203 h%20sword%204 h%20sword%205 h%20sword%206 h%20sword%207 h%20sword%208 h%20sword%209 h%20sword%2010 h%20sword%2011 h%20sword%2012".split(" ");Ci=["ork%20sword%20v1","ork%20sword%20v2","ork%20sword%20v3"];Qd="ship%20cannon%201 ship%20cannon%202 ship%20cannon%203 ship%20cannon%204 ship%20cannon%205 ship%20cannon%206 ship%20cannon%207".split(" ");Di=["ghost%201","ghost%202"];Ei=["mage%20attack"];K=["destroy%20building"];
Ye=["siege%20die%201","siege%20die%202","siege%20die%203","siege%20die%204"];Rd="h%20die%201 h%20die%202 h%20die%203 h%20die%204 h%20die%205 h%20die%206 h%20die%207 h%20die%208 h%20die%209 h%20die%2010".split(" ");Va="die%201 die%202 die%203 die%204 die%205 die%206 die%207 die%208 die%209 die%2010".split(" ");Ig=["e_barrack1"];var h="https://dl.dropboxusercontent.com/s/";if("undefined"!==typeof AudioContext){window.AudioContext=window.AudioContext||window.webkitAudioContext;nc=new AudioContext;var m=
nc.createGain();var n=nc.createGain();var v=new c(nc,void 0,b);P("Sound: OK");m.gain.value=parseInt(document.getElementById("musicRange").value)/100;n.gain.value=parseInt(document.getElementById("soundRange").value)/100}Ha=function(){if(!r.editor){Ha.id++;localStorage.setItem("favMusic",musicSelect.mversion.value);var c=Ha.list[musicSelect.mversion.value];c&&pa(c[~~(c.length*Math.random())],0,0,void 0,1,0,Ha.id)}};document.getElementById("musicRange").oninput=function(){m.gain.value=parseInt(document.getElementById("musicRange").value)/
100};document.getElementById("soundRange").oninput=function(){n.gain.value=parseInt(document.getElementById("soundRange").value)/100};Ha.reset=function(){Ha.stop();Ha()};Ha.stop=function(){Ha.active&&(Ha.active.stop(),clearTimeout(Ha.intv))};Ha.id=0;Ha.list={originalMusic1:[1,2,3,4,5,6,7,8,9,10,"outro"],originalMusic:"tzar%20soundtrack%201 tzar%20soundtrack%202 tzar%20soundtrack%203 tzar%20soundtrack%204 tzar%20soundtrack%205 tzar%20soundtrack%206 tzar%20soundtrack%207 tzar%20soundtrack%208 tzar%20soundtrack%209 tzar%20soundtrack%2010".split(" "),
sharpRain:"sr1 sr2 sr3 sr4 sr5 sr6 sr7 sr8 sr9 sr10".split(" ")};pa=function(c,b,g,d,e,f,h){var q=c;if((c=Ze[c])&&"loading"!==c&&!r.canceled){var k=-rb+(window.innerWidth-w.mx)/2,l=-Da+window.innerHeight/2;if(c.duration){if(r.started)if(64<r.now()-c.lastPlayed||!c.lastPlayed)c.lastPlayed=r.now();else return;if(!(!e&&"attack"!=q&&f&&600<Date.now()-f)){if(b){b=-k+32*b;g=-l+32*g;l=ba;if(b*b+g*g>Math.pow(2E3,2))return!1;b/=80;g/=80;l/=8}else l=g=b=0;void 0!==d&&d!==w.kingdom||r.mute||(d=nc.createBufferSource(),
d.buffer=c,e?(d.connect(m),m.connect(nc.destination),Ha.active=d,Ha.intv=setTimeout(Ha,~~(1E3*c.duration)+1E3)):(c=nc.createPanner(),c.panningModel="HRTF",c.setPosition(b,g,l),d.connect(c),c.connect(n),n.connect(nc.destination)),d.start(0))}}else Ze[q]="loading",e={x:b,y:g,k:d,music:e,date:Date.now(),mid:h},v.loadBuffer(c,e)}};c=document.getElementById("musicSelect").getElementsByTagName("input");d=0;for(e=c.length;d<e;d++)c[d].onchange=Ha.reset}},Sd=function(b,c,d,e){b.img===e.url&&(pa(c+~~(Math.random()*
d+1),b.x32,b.y32),setTimeout(Sd,db(e),b,c,d,e))};"use strict";var Vk=function(b){for(var c=[],g=0,e=[b.icons],f=0,h=e.length;f<h;f++)for(var m=e[f],n=0,v=m.length;n<v;n++)if(m[n]){var q=m[n];q.doneBy||(q.doneBy=[]);q.doneBy.put(b);c[g++]=q;q.xtra&&(e.put(q.xtra),h++)}b.habilities=c},Wk=function(b,c){return c.balanceTotal-b.balanceTotal},Jg=function(b,c){return c.priority-b.priority},Xk=function(b,c){return b-c},$e=function(b,c){if(!b.url.attack||b.attackOnly&&!b.attackOnly[c.type])return 0;var g=
25*~~(db(b.url.attack)/25);b=b.attack*((rd[b.type][c.type]||0)+1);b-=c.defence;1>b&&(b=1);return~~(c.health/b)*g},Ka=function(b){this.kingdom=b.k;this.aggressive=this.perfection=1;this.cantBuild={};b.IAD=Ka.arr.length;Ka.arr.put(this)};Ka.prototype.valorateLost=function(b){this.script.put({order:b.nu,obj:b,priority:1})};var Kg=function(b,c,d,e,f){var g=d.obj.cost;e[0]+=g[0];e[1]+=g[1];e[2]+=g[2];e[3]+=g[3];b[b.length]={order:d,priority:c.priority,name:d.obj.name,obj:d.obj,pTime:c.obj.time,required:1,
doner:f};b.changed=!0},Lg=function(b,c,d,e,f){var g=[b],m=[],n={},v=f.target;m.put(b);for(var q=0;q<g.length;q++){var k=g[q];k.availables&&(k.availables=void 0);if((b=k.order)&&!n[k.order.id]&&(n[k.order.id]=1,!d[b.id])){var l=b.requireObj;if(l)for(var y=0,r=l.length;y<r;y++)if(b=l[y],b.tech)c[b.nu.id]||d[b.nu.id]||Kg(g,k,b.nu,v);else{var t=e[b.type];t.length||Kg(g,k,b.nu,v)}if(l=b.doneBy)for(y=0,r=l.length;y<r;y++)b=l[y],t=e[b.type],t.length||b.race!=f.racestr||Kg(g,k,b.nu,v,1);q&&!k.doner&&m.put(k)}}return m},
Mg={food:2,wood:1,gold:0,stone:3},Nc=function(b,c){b=b.order;var g=b.obj,e=Nc.tech;g.build?e=Nc.build:g.tech||(e=Nc.unit);return e(b,c)};Nc.unit=function(b,c){b=b.doneBy;if(c.pop<c.popMax)for(var g=0,e=b.length;g<e;g++)for(var f=c[b[g].type],h=0,m=f.length;h<m;h++)if(f[h].free)return f[h].free=0,[f[h]];return!1};Nc.tech=function(b,c){b=b.doneBy;for(var g=0,e=b.length;g<e;g++)for(var f=c[b[g].type],h=0,m=f.length;h<m;h++)if(f[h].free)return f[h].free=0,[f[h]];return!1};Nc.build=function(b,c){b=b.doneBy;
for(var g=0,e=b.length;g<e;g++)for(var f=c[b[g].type],h=0,m=f.length;h<m;h++)if(f[h].free)return f[h].free=0,[f[h]];return!1};var Ac=function(b,c){if(b){var g=b.order,e=g.obj,f=Ac.unit;e.tech?f=Ac.tech:e.build&&(f=Ac.build);return f(g,c,b)}};Ac.build=function(b,c){var g=Ka.arr[c.IAD];if(4<=g.cantBuild[b.obj.type]&&c.stats.buildsLosed==g.buildsLosed)return!1;for(var e=[],f=b.doneBy,h=lb[c.k],m=0,n=f.length;m<n;m++)for(var v=h[f[m].type],k=0,l=v.length;k<l;k++){var u=A[v[k]];if(!u.func&&!u.in){e.put(u.id);
break}}if(!e.length)return!1;f=E;u=b.obj;b=u.space;h=u.validator.check;v=c.origin[0];l=c.origin[1];var y=l-1,r=v-1,t=-1;m=1;for(var w=v,x=l;0>t&&40>v-w;){--w;--x;var z=2*m+1,B=2*m+1;k=0;for(n=z*B;k<n;k++){var C=k%z,F=~~(k/z);if(!C||!F||C==z-1||F==B-1){C+=w;F+=x;var D=(C-v)*(C-v)+(F-l)*(F-l);if(1600>D&&h(C,F,b,y,r,900>D,c.k)){t=C+F*f;break}}}m++}if(0>t)return g.cantBuild[u.type]||(g.cantBuild[u.type]=0),g.cantBuild[u.type]++,g.buildsLosed=c.stats.buildsLosed,!1;g.cantBuild[u.type]&&(g.cantBuild[u.type]=
0);ea(sd,[t,u.type],e);return!0};Ac.tech=function(b,c){var g=b.doneBy;c=lb[c.k];for(var e=[],f=0,h=g.length;f<h;f++)for(var m=c[g[f].type],n=0,v=m.length;n<v;n++){var k=A[m[n]];k.working||k.techStart||!k.built||e.put(k.id)}if(!e.length)return!1;ea(Ng,[b.obj.id,b.id],e[0]);return!0};Ac.unit=function(b,c,d){d=b.doneBy;c=lb[c.k];for(var g=[],f=0,h=d.length;f<h;f++)for(var m=c[d[f].type],n=0,v=m.length;n<v;n++){var k=A[m[n]];k.working||k.techStart||!k.built||g.put(k.id)}if(!g.length)return!1;ea(af,[b.obj.type,
1,0],g[0]);return!0};Ka.prototype.leaveMeAloneIKnowWhatToDo=function(){performance.now();var b=F[this.kingdom],c=b.resources,d=lb[this.kingdom],e=E;if(b.origin){for(var f=b.origin[0],h=b.origin[1],m=h-1,n=f-1,v=f-40,k=h-40,l=0,u=6400,y=0;y<u;y++){var t=y%80+v,w=~~(y/80)+k;1600>(f-t)*(f-t)+(h-w)*(h-w)&&(!(t>=n&&t<=n+2)||w>=m&&w<=m+2)&&0===M[t+w*e]&&ka(t,w)&&l++}var x=[];performance.now();for(var z=0,D=0,ma=B.length;D<ma;D++){var da=B[D];if(!da.build&&!da.item&&!da.boat&&da.url.attack&&da.race==b.racestr&&
8!=da.type){x.put(da);da.balanceSum=0;da.bestBalance=-1;da.balanceDefence={};for(var H=Infinity,G=da.attDist,I=0;I<ma;I++){var K=B[I];if(!K.build&&!K.item&&!K.boat&&K.race==b.racestr&&K.url.attack&&8!=K.type&&(z=$e(K,da))){var O=$e(da,K);O&&(z-=O,z+=2E3*G,z<H&&(H=z,da.bestBalance=K),da.balanceSum+=z)}}}da.balanceTotal=da.balanceSum}x.sort(Wk);da=x[0];for(var N=1E3,L={},xc=[],Q=0,U=N;!L[da.type];)L[da.type]=1,xc[Q++]=da,xc[Q++]=N,K=da.bestBalance,N=~~(N*$e(K,da)/$e(da,K)+.5),U+=N,da=K;xc.nu=U-N;for(var R=
b.target,S=C,X=S.length,J=[],V=0;V<X;V++){var T=S[V],ba;if(!(ba=!T.type||T.upgrade||T.type==Y||void 0!==Mg[T.value]&&b.resources[T.value]>=R[T.value])){a:{for(var ea=T.nu.doneBy,W=0,aa=ea.length;W<aa;W++)if(ea[W].race==b.racestr){var fa=!0;break a}fa=!1}ba=!fa}ba||J.put({order:T.nu,obj:T,original:1,priority:1E-10})}var ja=[];y=0;u=xc.length;for(var la=xc.nu;y<u;y+=2){var sa=~~(.5+xc[y+1]/la*250)-d[xc[y].type].length,Z=xc[y];Z=Z.nu;for(var ha=0;ha<sa;ha++)J.put({order:Z,priority:1-ha/sa,obj:Z.obj,
original:1})}var ia=0,ra=0,oa=b.target,qa={};ra++;oa[0]=0;oa[1]=0;oa[2]=0;oa[3]=0;y=ia=ja.length=0;for(u=J.length;y<u;y++){var Aa=J[y].priority,Ca=Lg(J[y],b.technology.actived,b.technology.hidden,d,b);ha=0;for(var va=Ca.length;ha<va;ha++){Z=Ca[ha];Z.original||(Z.priority=Aa);var pa=1;void 0!==Z.priority&&(pa=Z.priority);var xa=Z.obj;xa.increase&&void 0!==Mg[xa.value]&&(pa=xa.increase*pa/c[Mg[xa.value]]);pa/=xa.time;Z.priority=pa;if(!(0>=Z.priority)){var za=Z.order.id;!qa[za]||Z.original?(qa[za]=ia,
ja[ia++]=Z):ja[qa[za]].priority+=Z.priority}}}var Fa=!1;ja.sort(Jg);var Ja={},Ta={},ta={},na=[],Ha=B.length;for(y=0;y<Ha;ta[y++]=0);for(y=0;y<ja.length;y++){var ca=ja[y];Z=ca.order;var kb=ca.obj;if(ca.original||ca.required)ca.obj.tech||ta[ca.obj.type]++,na.put(ca);var ua=Z.doneBy,Pa=kb.time;ha=0;for(u=ua.length;1>ha;ha++){var ya=ua[ha],Ma=ya.time;if(kb){for(var Za=ya,Ia=d[ya.type],Ea=Ka.process,$a=Pa,ab=Ia.length,La=!1,eb=Infinity,Sa=0;Sa<ab;Sa++){var Ga=A[Ia[Sa]],cb=0;Ga.build&&(Ga.working||Ga.techStart||
!Ga.built)&&(Ga.built?(cb=(Ga.c-r.cycle)*Bc.speed,cb/=1E3):(cb=Ga.time*(Ga.maxHealth-Ga.health)/Ga.maxHealth,Ga.workers&&Ga.workers.length&&(cb/=Ga.workers.length)));Ga.build||!Ga.func&&!Ga.in||(cb=Infinity);Ga.nato!=Ea?(Ga.nato=Ea,Ga.natoTime=0):cb+=Ga.natoTime;cb<eb&&(eb=cb,La=Ga)}La&&eb<=Za.time?(La.natoTime+=$a,Fa=La):Fa=!1}if(!Fa){Ja[ya.type]||(Ja[ya.type]=[],Ta[ya.type]=[]);var wb=Ja[ya.type],ib=Ta[ya.type];ta[ya.type]||(ta[ya.type]=0);var Ba=!1,jb=0;for(va=wb.length+1;jb<va;jb++){if(void 0==
wb[jb]){var Ya={order:ya.nu,priority:0,obj:ya};ja.put(Ya);na.put(Ya);wb[jb]=0;ib[jb]=Ya;ta[ya.type]++;Ba=!0}if(wb[jb]+Pa<=Ma||Ba){wb[jb]+=Pa;ib[jb].priority+=ca.priority;break}}}}}na.sort(Jg);var Ua=0;y=0;for(u=na.length;y<u;y++)if(ca=na[y].obj,ca.build){var Wa=ca.space[ca.space.length-1]+2;Ua+=Wa*((ca.space.length-1)/Wa+2)}P(Ua,l);if(Ua>l){var pb=l/Ua*.7;y=0;for(u=B.length;y<u;y++)B[y].build&&(ca=ta[y])&&((ca=~~(ca*pb))||(ca=1),ta[y]=ca)}y=0;for(u=na.length;y<u;y++)ca=na[y].obj,ca.build&&(ta[ca.type]?
ta[ca.type]--:na[y]=0);for(var db=0;1>db;db++){var gb=[],qb={},ub={},Xa={pop:0,popMax:200},Qa={},Va=[[]],sb=[0];y=0;for(u=d.length;y<u;y++){Qa[y]=0;ca=d[y];var ob=[];Xa[y]=ob;jb=0;for(va=ca.length;jb<va;jb++)ob[jb]={free:1,type:y}}for(ia=0;ia<sb.length;ia++){var tb=sb[ia],rb=Va[tb];y=0;for(u=rb.length;y<u;y++){var Da=rb[y],mb=Da.list;jb=0;for(va=mb.length;jb<va;jb++)ca=mb[jb],ca.used||(Qa[ca.type]++,ca.used=1,gb.put(ca.action),!ca.action||ca.action.obj.build||ca.action.obj.tech||Xa.pop++),ca.free=
1;if(Da.obj.tech){qb[Da.obj.nu.id]=1;var Ra=Da.obj;"popLimit"==Ra.value&&(Xa.popMax+=Ra.increase)}else Xa[Da.obj.type].put({free:1,type:Da.obj.type,action:Da.action})}y=0;for(u=na.length;y<u;y++)if(ca=na[y]){var bb=ca.obj;if(1===Lg(ca,qb,ub,Xa,b).length&&(mb=Nc(ca,Xa))){var Oa=ca.obj.time+tb;Va[Oa]||(Va[Oa]=[],sb.put(Oa));if(ca.obj.tech){if(ub[ca.order.id])continue;ub[ca.order.id]=1}if(ca.original||ca.required)gb.put(ca),bb.build||bb.tech||Xa.pop++;Va[Oa].put({list:mb,obj:ca.obj,action:ca});na[y]=
void 0}}sb.sort(Xk)}na=gb;na.sort(Jg)}this.script=na}};var Og=function(){for(var b=0,c=Ka.arr,d=c.length;b<d;c[b++].maintenance());Ia({func:Og},Ka.time,1);Ka.process++};Ka.prototype.maintenance=function(){var b=this.script;if(b){var c=F[this.kingdom],d=c.technology,e=d.actived,f=d.hidden,h=lb[c.k];d=E;var m={};if(c.values.pop+c.unitLoading>c.values.popMax&&c.values.popMax<=c.values.popLimit){for(var n=mb[c.race].house.nu,v=1,k=0,l=Td.length;k<l;k++)v+=h[Td[k].type].length*Td[k].population;v+c.unitLoading>
c.values.popMax&&v<=c.values.popLimit&&Ac({order:n,priority:1,obj:n.obj},c)}k=0;for(l=b.length;k<l;k++)(n=b[k])&&!m[n.order.id]&&1===Lg(n,e,f,h,c).length&&(Ac(n,c)?b[k]=0:m[n.order.id]=1);b=!1;m=Infinity;var u=c.diplomacy;f=c.origin[0];h=c.origin[1];e=lb[c.k];k=1;for(l=F.length;k<l;k++)if(u[k]&&!F[k].death){n=F[k];v=n.origin[0]-f;var y=n.origin[1]-h;c=v*v+y*y;c<m&&(m=c,b=n)}if(b){c=[];k=v=0;for(l=e.length;k<l;k++)for(y=e[k],m=0,u=y.length;m<u;m++)n=A[y[m]],void 0!=n.func||n.standardFunc!=R||n.death||
(c[v++]=n.id);if(60<c.length){e=b.origin[0];u=b.origin[1];n=[40,0,-40,0,0,40,0,-40];m=Infinity;k=0;for(l=n.length;k<l;k+=2)if(v=n[k],y=n[k+1],v+=f+10*Math.sign(v),y+=h+10*Math.sign(y),(v-e)*(v-e)+(u-y)*(u-y)<m&&ka(v,y)){m=(v-e)*(v-e)+(u-y)*(u-y);var r=v+y*d}l=r%d;f=~~(r/d);h=-1;v=Infinity;e=lb[b.k];k=0;for(length=e.length;k<length;k++)for(b=e[k],m=0,y=b.length;m<y;m++)n=A[b[m]],u=(n.x32-l)*(n.x32-l)+(n.y32-f)*(n.y32-f),u<v&&(v=u,h=n.x32+n.y32*d);-1<h&&ea(Fi,[r,h],c)}}}};var Fi=function(b,c){var g=
E,e=b[0];b=b[1];var f=b%g;g=~~(b/g);for(var h=0,m=c.length;h<m;h++){var n=A[c[h]];6400<(n.x32-f)*(n.x32-f)+(n.y32-g)*(n.y32-g)?ra(-e,n,Ud,n.url.move):ra(-b,n,Ud,n.url.move)}Pg(c);Ia({func:Gi,data:{list:c,xy:-b}},3E4,1)},Gi=function(b){var c=b.list;b=b.xy;for(var g=0,e=c.length;g<e;g++){var f=A[c[g]];f.death||ra(b,f,Ud,f.url.move)}},Yk=function(b,c,d,e){var g=E,h;for(h=2;60>=h;h+=2){b--;c--;for(var m=0;m<=h;){var n=M[b+m+g*c];if(2<n&&n!=e&&A[n].type==d)return n;n=M[b+m+g*(c+h)];if(2<n&&n!=e&&A[n].type==
d)return n;m++}for(m=0;m<h-1;){m++;n=M[b+g*(c+m)];if(2<n&&n!=e&&A[n].type==d)return n;n=M[b+h+g*(c+m)];if(2<n&&n!=e&&A[n].type==d)return n}}return!1},Hi=function(b){var c=b.x32+b.y32*E,g=F[b.kingdom].diplomacy;!b.invisible&&hc[c]&&(c=A[hc[c]],g[c.kingdom]&&oc(b.id,[c.id],0,td))},Hd=function(b){var c=Qg(b.id);return c?(oc(c,[b.id],0,td),!0):!1},Qg=function(b,c){b=A[b];if(!b.freezed&&!b.invisible&&!1!==b.built){var g=b.x32,e=b.y32,f=F[b.kingdom].diplomacy,h=b.sight;b.build&&(h=b.attDist);var m=E,n=
2*h+1,k=!!b.confused,l=0;c&&(l=h-c);for(var p=Infinity,u=!1,y=0,r=n*n;y<r;y++){var t=y%n-h,w=~~(y/n)-h,x=Math.sqrt(t*t+w*w);if(x<=h&&x>=l){t+=g;w+=e;for(var z=0;3>z;z++){c=eb[z][t+m*w];var B=A[c];if((B&&B.kingdom&&(f[B.kingdom]||B.confused)||k)&&!(B.death||B.invisible||b.attackOnly&&!b.attackOnly[B.type]||c==b.id||B.item)){var C=rd[b.type][B.type];C||(C=0);B=x*x+.05*B.health-(C+1)*b.attack;B<p&&(u=c,p=B)}}}}return u}},Zk=function(b){b.setupINTV(Ii,b.id,1E3)},Ii=function(b){b=A[b];var c=b.free;c||
(c=Ji);var g=E,e=b.x32,f=b.y32,h=[];h.length=F.length;for(var m=h.length,n=0;n<m;h[n++]=0);n=0;for(var k=c.length;n<k;n+=2){var l=c[n]+e,p=c[n+1]+f;ka(l,p)&&(l=A[M[l+p*g]],l.nocapture||l.build||h[l.kingdom]++)}g=c=0;for(n=1;n<m;n++)h[n]>c&&(g=n,c=h[n]);c&&b.kingdom!=g&&b.changeKingdom(g);Xb(b,1E3)},bf,$k=[1,1],Ki=function(){return 25*(Date.now()-r.loadDate+r.pausedTime+r.deltaTime)/Bc.speed},$b=function(b){if(!(b&&r.online||$b.bySystem&&b))if(0===r.paused){r.paused=1;void 0!=bf&&clearInterval(bf);
var c=r.now();r.pausedTime+=Date.now();b||($b.bySystem=1);r.now=function(){return c}}else r.pausedTime-=Date.now(),r.paused=0,$b.bySystem=0,b&&(document.getElementById("alert").style.display="none"),bf=setInterval(Bc,Bc.speed),r.now=Ki};$b.bySystem=0;var Bb=function(b,c){var g=!1;if(1>b){b*=-1;var e=~~(b/va),f=b%va}else g=b;b=0;for(var h=c.length;b<h;b++){var m=A[c[b]];m.build||m.cow&&m.workers.length||g==m.id||(m.action=null,m.distance=0,m.mv&&null!=m.xf?(g?(m.xf=g,m.yf=!0):(m.xf=f,m.yf=e),m.nodes=
void 0):m.x32==f&&m.y32==e?m.stay():(m.dix=(f-m.x32)/Math.abs(f-m.x32),m.diy=(e-m.y32)/Math.abs(e-m.y32),g?(m.xf=g,m.yf=!0):(m.xf=f,m.yf=e),m.mv=!0,m.setupINTV(Vd,m.id,0),Rg(m),m.action=null))}},Rg=function(b){b.stock&&0!==b.stock[0]?(b.mimg=b.url[b.stock[4].url],b.stock[3]===Oc&&(b.mimg=b.url.milk)):b.mimg=b.url.move};Bb.cursor=7;Bb.allowPos=1;var Xb=function(b,c,d){c=~~(c/25)+r.cycle;d=Pc[c];d||(d=[],Pc[c]=d);var g=d.length;b.c=c;d[g]=b.id;b.timestamp=r.now()},Pc={},cf=function(b){var c=A[b[0]];
if(!c.death){var g=b[1],e=b[2],f=b[3];c.cow&&"milk"==g&&c.workers&&c.workers.length||(c[g]+=F[c.kingdom].values[e],e=c[g+"Max"],c[g]>e&&2!==c.blocked&&(c[g]=e));"mana"==g&&(e=c.manaTask)&&e[2]<=c[g]&&(P(e),ra(e[1],c,Yb[e[0]],c.url.move),c.manaTask=void 0,c.blockedAction(1));aa(c.id,1);Ia({func:cf,data:b},f,1)}},Ia=function(b,c,d){b.func.url||P(b.func);b.func=b.func.url;d&&(c=~~(c/25)+r.cycle);d=Qc[c];d||(d=[],Qc[c]=d);d.put(b)},Qc={},Vd=function(b){b=A[b];var c=E,g=!1;b.waiting&&Rg(b);var e=b.y32,
f=b.x32;Sg(1,b,"zone");var h=Yb[b.action];Ra(b,32*e);var m=eb[b.zLevel],n=f+e*c;Hi(b);if(b.id===m[n]){var k=b.size;if(2>k)m[n]=b.radix;else for(var l=k*k,p=-c,u=0;u<l;u++){var y=u%k;0===y&&(p+=c);m[n+y+p]=0}}if(b.stop)return m[n]=b.id,b.stay(),b.stop=void 0,0;if(b.kx||b.ky){var r=b.kx||0,t=b.ky||0;l=!1;if(0!==m[r+f+(t+e)*c])return b.aspettare()}else{h&&h.rev&&(l=h.rev(b))&&(b.action=l[0],h=Yb[b.action],b.xf=l[1],b.yf=!0);if(!0===b.yf){l=b.xf;var w=A[l];if(!w||w.death&&(!h||!h.available))return m[n]=
b.id,b.stay();u=!0;p=!1;if(h&&h.available){p=h.available(b,w);u=p[2];if(!1===p)return b.aspettare();if("kill"===p)return m[n]=b.id,b.stay()}else w.death||(p=Cb(w,b,50,b.radix));b.xf!==l&&(w=A[b.xf]);if(!w||w.death||w.in)return m[n]=b.id,b.stay();if(!u&&(x+z*c===n||h))return b.aspettare();var x=p[0],z=p[1];if(h&&h.distance){var B=h.distance;B=0>B?b.attDist:F[b.kingdom].values[B];p=Tg(w,f,e);Wd(f,e,p%E,~~(p/E),B)&&(g=2)}b==w&&(g=2)}else{x=b.xf;z=b.yf;l=m[x+z*c];if(2<l&&(!h||h&&h.rev)){l=A[l];p=Cb(l,
b,50,b.radix);if(!1===p)return m[n]=b.id,b.stay();x=p[0];z=p[1]}h&&h.distance&&(B=h.distance,B=0>B?b.attDist:F[b.kingdom].values[B],Wd(f,e,x,z,B)&&(g=2))}l=x+z*c;p=x;u=z;if(b.nodes){var C=b.nodes;20<C.length&&(C.length=2);u=C[C.length-2];p=u%c;u=~~(u/c);y=C[C.length-1];if(f+e*c==p+u*c||m[y]==b.radix||m[p+u*c]!==b.radix)C.length-=2,C.length?(u=C[C.length-2],p=u%c,u=~~(u/c)):(p=x,u=z,b.nodes=void 0)}if(!g){r=p;t=u;y=b.radix;C=E;var D=f+e*C,H=r+t*C,G,I=r-f,K=t-e,O=Math.sqrt(I*I+K*K);for(G=0;16>G;G++){var N=
~~(8*Ug(D%C-r,~~(D/C)-t)+.5)%8;if(D===H)break;var P=m[D+ac[N]];if(P===y||df(P))D+=ac[N];else if(P=m[D+ac[(N+1)%8]],P===y||df(P))D+=ac[(N+1)%8];else{var M=N-1;-1===M&&(M=7);P=m[D+ac[M]];if(P===y||df(P))D+=ac[M];else{D+=ac[N];break}}if(!G)var L=D;Xd&&ud(D%C,~~(D/C),"stone")}N=0;P=-1;if(m[D]>y){2<m[D]&&(P=D);var Q=[D],U=1,T=0,R={};R[D]=2;for(var J=Infinity,S=-Infinity,X=0;void 0!==(M=Q[T++]);){Xd&&ud(M%C,~~(M/C),"food");G=M%C;var V=~~(M/C);G=((G-r)*K-(V-t)*I)/O;G<J?(J=G,N=M):G>S&&(S=G,X=M);for(G=0;4>
G;G++)if(D=M+Li[G],ka(D%C,~~(D/C))&&!R[D]&&m[D]!==y&&!df(m[D]))for(H=0;8>H;H++)if(m[D+ac[H]]===y){Q[U++]=D;R[D]=2;break}}Xd&&ud(N%C,~~(N/C),"gold");Xd&&ud(X%C,~~(X/C),"gold");M=Math.pow(J,2)<=Math.pow(S,2)?N:X;J=-Infinity;for(H=0;8>H;H++){D=M+ac[H];if(G=m[D]===y)G=E,Q=M+ac[H],G=1<Math.abs(M%G-Q%G)||1<Math.abs(~~(M/G)-~~(Q/G))?!1:!0;G&&(G=D%C,V=~~(D/C),G=((G-r)*K-(V-t)*I)/O,Math.pow(G,2)>J&&(N=D,J=Math.pow(G,2)))}Xd&&ud(N%C,~~(N/C),"wood")}t=[L,N,P];L=t[0];r=t[1];y=t[2];r&&(b.nodes?(b.nodes.put(r),
b.nodes.put(y)):b.nodes=[r,y]);void 0!==L?(r=-f+L%c,t=-e+~~(L/c)):t=r=1;if(1<Math.abs(r)||1<Math.abs(t))return b.aspettare();if(m[f+r+(e+t)*c]!==b.radix||!ka(f+r,e+t)){L=[f+1,e,f-1,e,f+1,e+1,f+1,e-1,f,e-1,f-1,e+1,f,e+1,f-1,e-1];r=E;t=Infinity;for(y=0;y<L.length;y+=2)if(0===m[L[y]+L[y+1]*r]&&ka(L[y],L[y+1])&&t>=(L[y]-p)*(L[y]-p)+(L[y+1]-u)*(L[y+1]-u)){t=(L[y]-p)*(L[y]-p)+(L[y+1]-u)*(L[y+1]-u);var Y=y}p=[L[Y],L[Y+1]];r=p[0]-f;t=p[1]-e;r=0<r?1:0>r?-1:0;t=0<t?1:0>t?-1:0;if(m[f+r+(e+t)*c]!==b.radix||!ka(f+
r,e+t))return b.aspettare()}}}if(n==l||g)if(m[f+e*c]=b.id,b.x32=f,b.y32=e,h){if(h.distance&&2!==g)return b.aspettare();b.stay(1);w||(w=x+z*c);b.action=void 0;h(w,b,B)}else b.stay();else{if(0===r&&0===t)return b.aspettare();b.setupDir(r,t);g=b.spd;Z(b,b.mimg,-1,b.spd/b.__proto__.spd);b.dix=r*g;b.diy=t*g;e+=t;f+=r;b.x32=f;b.y32=e;b.distance++;Xb(b,~~(32E3/g));Cc(b,r*g,t*g,0);n=f+e*c;if(2>k)m[n]=b.id;else for(l=k*k,p=-c,u=0;u<l;u++)y=u%k,0===y&&(p+=c),m[n+y+p]=b.id}},Bc=function(){if(!r.editor){var b=
r.cycle;r.now();var c=Date.now();if(r.demo){var d=r.record[b];if(d)for(var e=0;e<d.length;e+=3)ef[d[e]](d[e+1],d[e+2])}if(d=Qc[b]){for(e=0;e<d.length;e++){var f=d[e];Yb[f.func](f.data)}delete Qc[b]}if(d=Pc[b]){for(e=0;e<d.length;e++)f=A[d[e]],f.c===b&&(f.death?P("anti stall:",Yb[f.func].name,f.func,f):(f.c=void 0,Yb[f.func](f.funcObj)));delete Pc[b]}r.cycle++;if(r.online&&0===r.cycle%8)var h=Vg();Wg+=Date.now()-c;0===r.cycle%40&&(b=r.now()/1E3,c=~~(b/60)%60,d=~~(b/3600),b=~~(b%60),1===(b+"").length&&
(b="0"+b),d=0!=d?d+":":"",t("topinfo").innerHTML="<span>CPU:"+(Wg/10).toFixed(2)+"%</span> <span>"+~~(Xg/Yg+.5)+"FPS</span> <span>"+d+c+":"+b+"</span>",Xg=Yg=Wg=0);!h&&!r.automatic&&r.now()-(r.cycle-1)*Bc.speed>=Bc.speed&&Bc()}};Bc.speed=25;var Wg=0,Yg=0,Xg=0,ac,Li,ud=function(b,c,d){d=Object.assign({},xb[d]);d.x32=b;d.y32=c;d.z32=2;Xa(d);Rb.new(d,500)},df=function(b){return(b=A[b])&&19===b.func&&!b.waiting?!0:!1},Xd,Ug=function(b,c){b=.5-Math.atan2(c,b)/(2*Math.PI);1==b&&(b=0);return b},yb=function(b,
c,d,e){return[b,c,d,e,b,c,d,e,b,c,d,e,b,c,d,e]},ff=new Float32Array(yb(1,0,0,.75)),al=new Float32Array(yb(1,1,1,.5)),Mi=new Float32Array(yb(0,1,0,.75)),bl=new Float32Array(yb(0,1,0,.9)),cl=new Float32Array(yb(.3515625,.29296875,.21875,.9)),Ni=new Float32Array(yb(0,1,1,.9)),Zg=new Float32Array(yb(1,1,1,.5)),Oi=new Float32Array(yb(.3,.3,.3,.9)),Pi=new Float32Array(yb(.7,.2,.2,.9));Ni.noAlpha=1;Oi.noAlpha=1;Pi.noAlpha=1;var W=function(b){ea(af,[b,4*Db.shift+1,Eb],G[0])},af=function(b,c){var g=b[0],e=
b[1],f=b[2];b=B[g];c=A[c];var h=c.icons.indexOf(b.nu);if(!(0>h)){performance.now();if(0==f)for(f=0;f<e;f++){var m=F[c.kingdom],n=m.mod[g].cost||b.cost;if(m.paypal(n))return!1;c.waitlist||(c.waitlist=[]);c.waitlist.push(g,-h-1);c.work||(c.work={});c.work[h]||(c.work[h]=0);c.work[h]++;c.working=1;m.unitLoading++;2==c.waitlist.length&&(n=1E3*b.time,c.setupINTV(Yd,c.id,n))}else{if(!c.work)return;var k=c.waitlist;m=F[c.kingdom];for(f=0;f<e;f++){n=m.mod[g].cost||b.cost;m.setupResources(n,-1);n=k.lastIndexOf(g);
if(0>n)break;k.splice(n,2);P(c.work[h]);c.work[h]--;if(0==k.length){c.c=-1;c.working=0;break}m.unitLoading--;0===n&&(n=1E3*B[k[0]].time,c.setupINTV(Yd,c.id,n))}}aa(c.id)}},Qi=0,Yd=function(b){b=A[b];var c=b.kingdom;c=F[c];var g=c.values.pop>=c.values.popMax?x.houseLimit:x.popLimit;if(c.values.pop>=c.values.popMax||c.values.pop>=c.values.popLimit)return document.getElementById("msgs1").getElementsByTagName("li"),3E4<Date.now()-Qi&&c.k==w.kingdom&&nb(g,0,5),Qi=Date.now(),c.onFreePop.put(b.id);c.unitLoading--;
c=b.waitlist[0];g=B[c];b.work[-b.waitlist[1]-1]--;b.waitlist.splice(0,2);0<b.waitlist.length?b.setupINTV(Yd,b.id,1E3*g.time):b.working=0;Rc(c,b);aa(b.id)},Ea=function(){if(0==Eb){var b=A[G[0]];ea($g,[b.mlistID[Wa.nu],!0],b.id)}},$a=function(){if(0==Eb){var b=A[G[0]];ea($g,[b.hlistID[Wa.nu],!1],b.id)}},Ri=function(b,c,d){var g=1.6,f=0;1===c&&(d=0,g=3.6,f=620);return[f+~~(g*b[0]*c+.5)+120*d,~~(g*b[1]*c+.5),~~(g*b[2]*c+.5),~~(g*b[3]*c+.5)]},$g=function(b,c){var g=b[0];b=b[1];c=A[c];var e=F[c.kingdom];
if(e.values.pop>=e.values.popMax)return nb(x.popLimit,0,5);if(b)var f=e.values.fameTech;e=4;var h=9*b;h||(h=1);if(b)var m=c.mlist,n=c.mlistID;else m=c.hlist,n=c.hlistID;var k=n.indexOf(g);if(!(0>k)){g=m[k].unit;m.splice(k,1);n.splice(k,1);n=Ri(B[g].cost,h,f);if(F[c.kingdom].paypal(n))return 0;T.active==m&&la(m);for(n=0;n<h;n++)k=Rc(g,c),f?k.level=e:b||(e=16,k.level=e,m=Si[k.race],k.name=m[k.id%m.length],Ti(k))}},Rc=function(b,c,d,e){var g=E,h=c.kingdom;c.rnd||ah(c);var m=-1,n=-1;if(c.point&&!c.disallowPoint){var k=
c.point[0],l=c.point[1];m=Ui(c,k,l,B[b].radix,B[b].rbase())[0]}else m=Ui(c,m,n,B[b].radix,B[b].rbase())[1],m=m[Vi(c,m.length)];n=~~(m/g);b=new Sc(b,h,m%g,n,0,!1,e);Zd(h);d||pa("unitdone",0,0,b.kingdom);if(c.point&&(c=bh(k,l,b,!0),d=c[1],c[0]))c[0](d,[b.id]);return b},gf=0,hf=0,Vb,Qa,Od,O=function(b){Q=function(){};b=B[b];Vb=!1;var c=X;Z(c,b.img);c.active=!0;Qa=b;Od=!1;document.addEventListener("mousemove",Dg);document.addEventListener("mousedown",Se)},Se=function(b){var c=Qa.validator,g=Qa.space,
e=Ca[Qa.img];if(0==b.button&&151<b.pageX){e=Fb(b.pageX-w.mx-.5*e[8]/ba,b.pageY-.5*e[9]/ba);var f=~~(.03125*e[1]);e=~~(.03125*e[0]);c(e,f,g,w.kingdom)[1]&&(Vb=!0,X.active=!0,X.x=-9999,X.y=-9999,Q=151<b.pageX?0:sb,document.removeEventListener("mousedown",Se),ea(sd,[e+E*f,Qa.type,Od],G),Db.shift&&(Od?ui(Od):O(Qa.type)));Q=function(){}}else X.active=!0,X.x=-9999,X.y=-9999,Vb=!0,Q=151<b.pageX?0:sb,document.removeEventListener("mousedown",Se)},Dg=function(b){var c=Qa.validator,g=Qa.space,e=Ca[Qa.img];if(Vb)document.removeEventListener("mousemove",
Dg);else{var f=b.pageX,h=b.pageY;if(f!=gf||h!=hf)X.active=!0,gf=f,hf=h,f=Fb(b.pageX-w.mx-.5*e[8]/ba,b.pageY-.5*e[9]/ba),h=~~(.03125*f[1]),f=~~(.03125*f[0]),b=32*f,e=32*h,(c=!c(f,h,g,Gb.k)[1])?c!=Dc&&(Dc=c,k.bindBuffer(k.ARRAY_BUFFER,ub),k.bufferSubData(k.ARRAY_BUFFER,16*X.bufferID,ff)):c!=Dc&&(Dc=c,k.bindBuffer(k.ARRAY_BUFFER,ub),k.bufferSubData(k.ARRAY_BUFFER,16*X.bufferID,Mi)),X.x=b,X.y=e}},sd=function(b,c){var g=b[0],e=g%va,f=~~(g/va),h=r.editor?w.kingdom:A[c[0]].kingdom;g=b[1];var m=B[g].cost,
n=F[h];if(!r.editor&&n.paypal(m))return!1;b=new Sc(g,h,e,f,0,!r.editor,b[2]);if(!0===b.invalid||r.editor)return!1;b.waitlist=[];if(20===g)b.built=1,e=A[c[0]],ra(b.id,e,Tc,e.url.move),Q=function(){Q=sb};else for(b.health=1,Z(b,b.bimg),b=b.id,g=0,f=c.length;g<f;g++)e=A[c[g]],e.buildList?(e.buildList.put(b),e.func!==jf.url&&(h=kf(e.buildList,e.x32,e.y32))&&ra(h,e,Uc,e.url.move)):(e.buildList=[b],e.func!==jf.url&&ra(b,e,Uc,e.url.move))},Dc=null,dh=function(b){Q=function(){};b=B[b];Vb=!1;var c=X;Qa=b;
Z(c,b.img);document.addEventListener("mousemove",Wi);document.addEventListener("mousedown",ch)},ch=function(b){var c=E,g=Ca[Qa.img];if(0==b.button&&151<b.pageX){b=Fb(b.pageX-w.mx-.5*g[8]/ba,b.pageY-.5*g[9]/ba);var e=~~(.03125*b[1]);b=~~(.03125*b[0]);k.bindBuffer(k.ARRAY_BUFFER,ub);k.bufferSubData(k.ARRAY_BUFFER,0,cl);var f=J[2];J[2]=32;J[5]=32;J[8]=32;J[11]=32;X.wall=b+e*c;var h=b;document.addEventListener("mouseup",function v(b){vb.forced=!1;b=Fa[3*w.kingdom];var g=Fa[3*w.kingdom+1],d=Fa[3*w.kingdom+
2];z[0]=b;z[1]=g;z[2]=d;z[3]=.5;z[4]=b;z[5]=g;z[6]=d;z[7]=.5;z[8]=b;z[9]=g;z[10]=d;z[11]=.5;z[12]=b;z[13]=g;z[14]=d;z[15]=.5;k.bindBuffer(k.ARRAY_BUFFER,ub);k.bufferSubData(k.ARRAY_BUFFER,0,z);J[2]=f;J[5]=f;J[8]=f;J[11]=f;var n=~~(J[9]/32),l=~~(J[10]/32);g=Math.abs(h-n);d=Math.abs(e-l);g&&--g;d&&--d;b=1;n=n<h?n:h;var r=l<e?l:e;l=[n+r*c];for(var t=0;t<g+1;t++)l[b++]=n+t+r*c,d&&(l[b++]=n+t+(r+d)*c);for(t=1;t<d;t++)l[b++]=n+(r+t)*c,g&&(l[b++]=n+(r+t)*c+g);for(t=1;t<b;t++)g=l[t],Vb=!0,Q=function(){Q=
sb},Ec(2),ea(sd,[g,Qa.type],G);X.active=!0;X.x=-9999;X.y=-9999;Db.shift&&dh(Qa.type);document.removeEventListener("mouseup",v)});document.removeEventListener("mousedown",ch);Vb=!0}else X.active=!0,X.x=-9999,X.y=-9999,Vb=!0,Q=151<b.pageX?0:sb,document.removeEventListener("mousedown",ch)},Wi=function(b){var c=E,g=Ca[Qa.img];if(Vb)document.removeEventListener("mousemove",Wi);else{var e=b.pageX,f=b.pageY;if(e!=gf||f!=hf){var h=!0;gf=e;hf=f;X.active=!0;b=Fb(b.pageX-w.mx-.5*g[8]/ba,b.pageY-.5*g[9]/ba);
g=~~(b[1]/32);b=~~(b[0]/32);e=32*b;f=32*g;0==M[b+g*c]&&(h=!1);h?h!=Dc&&(Dc=h,k.bindBuffer(k.ARRAY_BUFFER,ub),k.bufferSubData(k.ARRAY_BUFFER,16*X.bufferID,ff)):h!=Dc&&(Dc=h,k.bindBuffer(k.ARRAY_BUFFER,ub),k.bufferSubData(k.ARRAY_BUFFER,16*X.bufferID,Mi));X.x=e;X.y=f}}},eh=function(b,c){b=0;for(var g=c.length;b<g;b++){var e=A[c[b]];e.xf?e.stop=1:e.stay()}},lf=function(b,c){b=A[c[0]];b.techStart=0;b.c=void 0;if(c=b.techID){var g=F[b.kingdom].technology.hidden;-1<c&&(g[c]=0);F[b.kingdom].setupResources(C[b.activeTech].cost,
-1)}else F[b.kingdom].setupResources(b.lcost,-1)},H=function(b){var c=A[G[0]];if(F[c.kingdom].paypal(C[b].cost))return!1;ea(Ng,[b,Wa.lastFunc.id],c.id)},Ng=function(b,c){var g=b[0];b=b[1];var e=C[g],f=A[c];e.upgrade&&(b=-1);f.activeTech=g;f.techID=b;f.setupINTV(e.type,[g,b,c],1E3*e.time);f.techStart=f.c-r.cycle;g=F[A[c].kingdom].technology.hidden;-1<b&&(g[b]=1);aa(c)},Y=function(b){var c=b[1],g=A[b[2]];b=C[b[0]];pc(g,b,c)},$d=function(b){var c=b[1],g=A[b[2]];b=C[b[0]];var e=B[b.obj],f=F[g.kingdom].mod[e.type];
Xi(g);g.img=e.img;g.attack=f.attack||e.attack;g.health=g.health/g.maxHealth*e.health;g.maxHealth=e.health;g.__proto__=e;Xa(g);pc(g,b,c)},mf=function(b){var c=b[1],g=A[b[2]];b=C[b[0]];if(b.actvintv)for(var e=b.actvintv,f=0,h=e.length;f<h;f++){var m=e[f];F[g.kingdom].technology.disabled[m.id]=0;for(var n=m.builds,k=lb[g.kingdom],l=0,p=n.length;l<p;l++)for(var u=k[n[l]],y=0,r=u.length;y<r;y++)m(A[u[y]])}pc(g,b,c)},ab=function(b,c){var g=b[1];c=A[b[2]];b=C[b[0]];F[c.kingdom].values[b.value]+=b.increase;
"popMax"==b.value&&Zd(c.kingdom);pc(c,b,g)},Yi=function(b,c){var g=b[1];c=A[b[2]];b=C[b[0]];for(var e=b.group,f=F[c.kingdom].mod,h=0,m=e.length;h<m;h++)for(var n=f[e[h].type],k=0,l=b.values,p=l.length;k<p;k+=2){var u=l[k],y=l[k+1];n[u]||(n[u]=e[h][u]||0);n[u]+=y}pc(c,b,g)},ob=function(b,c){var g=b[1];c=A[b[2]];b=C[b[0]];for(var e=b.group,f=F[c.kingdom].mod,h=0,m=e.length;h<m;h++){var n=f[e[h].type];n[b.value]||(n[b.value]=e[h][b.value]||0);n[b.value]+=b.increase}pc(c,b,g)},nf=function(b,c){var g=
b[1];c=A[b[2]];b=C[b[0]];for(var e=F[c.kingdom].mod,f=b.mulp,h=0,m=b.group.length;h<m;h++){var n=b.group[h],k=e[n.type].cost||n.cost;e[n.type].cost=f?[~~(k[0]*f),~~(k[1]*f),~~(k[2]*f),~~(k[3]*f)]:[k[0]-b.decrease[0],k[1]-b.decrease[1],k[2]-b.decrease[2],k[3]-b.decrease[3]]}pc(c,b,g)},fh=function(b,c){var g=b[1];c=A[b[2]];b=C[b[0]];for(var e=F[c.kingdom].mod,f=0,h=b.decrease,m=h.length;f<m;f+=2){var n=h[f],k=h[f+1],l=e[n.type].cost||n.cost;e[n.type].cost=[l[0]-k[0],l[1]-k[1],l[2]-k[2],l[3]-k[3]]}pc(c,
b,g)},pc=function(b,c,d){b.techStart=void 0;b.activeTech=void 0;b.techID=void 0;b.func=void 0;var g=F[b.kingdom].technology,f=g.disabled;g.investigated[d]=1;pa("techdone",0,0,b.kingdom);if(c=c.next){d=!1;g=0;for(var h=c.length;g<h;g++){var m=c[g].id;f[m]--;la.actv[m]&&(d=!0)}d&&la(T.active)}aa(b.id)};"use strict";var Fc,dl={icon:"food",img:"item_meat",url:"meat"},el={icon:"milk",img:"milk",url:"milk"},fl={icon:"gold",img:"item_gold",url:"gold"},gl={icon:"stone",img:"item_stone",url:"stone"},Zi={icon:"wood",
img:"item_tree",url:"tree"},hl={icon:"food",img:"item_food",url:"food"},ae=function(b,c,d,e){b=lb[b];var g=Fc[c];c=[];c.length=g.length;for(var h=0,m=g.length;h<m;c[h]=b[g[h++]]);b=Infinity;g=-1;for(h=0;h<c.length;h++){m=c[h];for(var n=m.length,k=0;k<n;k++){var l=A[m[k]],p=l.x32,u=l.y32,y=l.space;l=y[y.length-1];y=(y.length-1)/l;l*=.5;y*=.5;p+=l;u+=y;l=.5*(l+y);p=Math.sqrt((p-d)*(p-d)+(u-e)*(u-e))-l;b>=p&&(b=p,g=m[k])}}return g},ja,il=function(b){if("string"==typeof b){for(var c=1,g=0,e=b.length;g<
e;g++)c+=c*(b.charCodeAt(g)/65535)*(g+1);b=c+e}var f=4294967295-b,h=4294967295+b;g=0;ja=function(){h+=g;f-=g++;h=36969*(h&65535)+(h>>16)&4294967295;f=18E3*(f&65535)+(f>>16)&4294967295;return((h<<16)+f&4294967295)/4294967295+.5}},Vi=function(b,c){b=b.rnd;var g=b[0],e=b[1],f=b[2];g+=f;e-=f;g=36969*(g&65535)+(g>>16)&4294967295;e=18E3*(e&65535)+(e>>16)&4294967295;b[0]=g;b[1]=e;b[2]++;return~~((((g<<16)+e&4294967295)/4294967295+.5)*c)},Ec=function(b){b!=jl&&(document.body.className="ncursor"+b)},jl=-1,
vd=function(b,c){for(var g=0,e=c.length;g<e;g++){var f=A[c[g]];ra(b,f,be,f.url.move)}};vd.spLevel=function(b){var c=0;2<Ja[b]&&(c=Ja[b]);return c};var be=function(b,c){c.stay55();if(c.inventory&&c.invMax===c.inventory.length||!b.item)return 1;Ja[b.x32+b.y32*E]=b.radix;Ra(b,NaN);if(c.peon&&b.contain){var g=b.contain[1],e=b.contain[0];c.stock&&$i(c);var f=E;var h=Infinity;for(var m=!1,n=0;121>n;n++){var k=n%11-5;var l=~~(n/11)-5,p=k*k+l*l;k+=c.x32;l+=c.y32;p<h&&(k=Ja[k+f*l],0<k&&(k=A[k],k.contain&&
(h=p,m=k.id)))}h=m;f=b.contain[2];b.die(1);c.stock=[e,g,h,be,f];b=ae(c.kingdom,g,c.x32,c.y32);ra(b,c,qc,c.url[f.url]);aa(c.id);return 1}c.addItem(b);aa(c.id)},$i=function(b){var c=aj(b.x32,b.y32),g=~~(c/E);c%=E;c=new Sc(52,b.kingdom,c,g,0);Z(c,l[b.stock[4].img]);c.contain=[b.stock[0],2,b.stock[4]]},bj=function(b,c){b=0;for(var g=c.length;b<g;b++){var e=A[c[b]];e.xf?e.stop=2:(e.stop=2,e.stay(),e.stop=void 0)}},wd=function(b,c){var g=E;b=A[b];for(var e=0,f=c.length;e<f;e++){var h=A[c[e]],m=eb[h.zLevel],
n=h.x32+h.y32*g;if(0!==m[n]||!b.build){n=b.build?gh(h,h.x32,h.y32):gh(h,b.x32,b.y32);if(!1===n)continue;h.x32=n%E;h.y32=~~(n/E)}h.item&&(b.attack-=h.attack||0,b.defence-=h.defence||0);h.url.idle&&Z(h,h.url.idle,1);m[n]=h.id;h.in=0;b.inventory.quit(h.id);m=1;h.z32&&(m=h.z32);Ra(h,32*h.y32*m)}aa(b.id,1)},ce=function(b,c){b=A[b];if(1===b.invType)for(var g=0,e=c.length;g<e;g++){var f=A[c[g]];f!=b&&ra(b.id,f,hh,f.url.move)}},hh=function(b,c){var g=b.inventory;if(g.length<b.invMax){var e=c.x32,f=c.y32;
c.stay55();c.rbase()[e+f*E]=c.radix;g.put(c.id);Ra(c,NaN);c.in=b.id;de(c.id);aa(b.id)}else c.stay55()},xd=function(b,c){for(var g=c.length,e=0;e<g;e++){var f=A[c[e]];f.buildList=!1;ra(b,f,Uc,f.url.move)}},Uc=function(b,c){if(b.dummy&&b.dummy.built)return c.stay55();if(b.health<b.maxHealth)c.dix=0,c.diy=0,c.mv=!0,c.setupDirBuild(b),Z(c,c.url.build,1),c.setupINTV(jf,{u:b.id,a:c.id},db(c.img)),Sd(c,"hit%20",7,c.img);else{if(c.buildList&&(b=kf(c.buildList,c.x32,c.y32)))return ra(b,c,Uc,c.url.move),0;
c.stay55()}},of=function(b,c){return c[b]&&13==A[c[b]].type||13==A[M[b]].type?!0:!1},jf=function(b){var c=A[b.u];b=A[b.a];var g=b.x32,e=b.y32,f=c.x32+c.y32*E;if(c.death)return b.stay();var h=c.maxHealth,m=h/c.time*F[b.kingdom].values.buildSpeed;if(1===c.health){for(var n=c.onbuild1,k=c.id,q=c.getRadix(),p=0,u=n.length;p<u;p++)if(2<q[n[p]]){Xb(b,db(b.img));return}var y=Hb[c.kingdom];p=0;for(u=n.length;p<u;p++)q[n[p]]=k,y[n[p]]=void 0;lb[c.kingdom][c.type].put(c.id);rc(c)}c.health+=m;m=c.health;0==
c.built&&(y=~~(4*m/h),y>c.d&&(c.d=y,Z(c,c.img)));if(m>=h){m=c.health=h;aa(c.id);if(!c.built){c.d=0;n=c.url;y=Hb[c.kingdom];13===c.type&&(of(f-1,y)&&of(f+1,y)?(n=l.wood_horz,c.child=void 0):of(f+E,y)&&of(f-E,y)&&(n=l.wood_vert,c.child=void 0));c.built=1;c.img=n;Xa(c);if(n=c.onbuildValid)for(q=c.validator.dimension,p=0,u=n.length;p<u;q[n[p++]]=0);cj(c);pa("bldgdone",0,0,c.kingdom);aa(c.id)}c.action=void 0;(f=b.buildList)&&f.quit(c.id);if(!f||b.buildList&&0===b.buildList.length)b.buildList=dj(b),f=b.buildList;
if(g=kf(f,g,e))return ra(g,b,Uc,b.url.move),0;b.buildList.length=0;b.stay();b.stock&&b.stock[0]&&Z(b,b.url[b.stock[4].url])}else aa(c.id),Xb(b,db(b.img));G[0]==c&&(Gc.innerHTML=m+"/"+h,ua.value=m)},pf=function(b,c){if(2<b)for(var g=0,e=c.length;g<e;g++){var f=A[c[g]];ra(b,f,Tc,f.url.move)}},fe=function(b,c){var g=b;b=A[b];if(b.field)for(e=0,b=c.length;e<b;e++)f=A[c[e]],ra(g,f,Tc,f.url.move);else if(0===b.res||3===b.res){var e=0;for(b=c.length;e<b;e++){var f=A[c[e]];ra(g,f,ee,f.url.move)}}else if(1===
b.res)for(e=0,b=c.length;e<b;e++)f=A[c[e]],ra(g,f,Vc,f.url.move);else if(2===b.res)for(e=0,b=c.length;e<b;e++)f=A[c[e]],ra(g,f,Oc,f.url.move)},oc=function(b,c,d,e){d=e||ge;if(!(3>b||(b=A[b],void 0!=b.res||b.magicGateway))){e=0;for(var g=c.length;e<g;e++){var h=A[c[e]];h==b||h.attackOnly&&!h.attackOnly[b.type]||h.bat&&b.build||b.stoned||(h.build?d(b,h):ra(b.id,h,d,h.url.move))}}},Vc=function(b,c){if(0<b.health){var g=c.x32,e=c.y32;c.mv=!0;c.setupDir(b.x32-g,b.y32-e);Z(c,c.url.cut,1);c.dix=0;c.diy=
0;Sd(c,"chop%20",11,c.img);c.setupINTV(ej,{u:b.id,a:c.id},7E3);b.addWorker(c)}else c.stay55()},ej=function(b){var c=E,g=A[b.u];b=A[b.a];var e=F[b.kingdom].values.wood;g.workers.quit(b.id);var f=ae(b.kingdom,1,b.x32,b.y32);g.health-=e;b.mv=!1;aa(g.id);if(1>g.health){e+=g.health;M[g.x32+g.y32*c]=0;c=A[f];c=ta(c.x32,c.y32);for(var h=g.health=0,m=g.workers.slice(0),n=m.length;h<n;h++){var k=A[m[h]];c?ra(c,k,Vc,b.url.move):k.stay()}b.stock=[e,1,c,Vc,Zi];b.mv=!1;ra(f,b,qc,b.url.tree);aa(b.id,1);g.workers.length=
0;g.die()}else b.stock=[e,1,g.id,Vc,Zi],ra(f,b,qc,b.url.tree),aa(b.id,1);if(0>f)return b.stay()},Tc=function(b,c){c.mv=!0;c.setupDir(b.x32-c.x32,b.y32-c.y32);Z(c,c.url.dig,1);Sd(c,"dig%20",3,c.img);c.setupINTV(fj,{u:b.id,a:c.id},7E3)},fj=function(b){var c=A[b.u];b=A[b.a];var g=F[b.kingdom].values.food,e=ae(b.kingdom,2,b.x32,b.y32);b.mv=!1;b.stock=[g,2,c.id,Tc,hl];ra(e,b,qc,b.url.food);aa(b.id,1);if(0>e)return b.stay()},Oc=function(b,c){c.mv=!0;c.setupDir(b.x32-c.x32,b.y32-c.y32);Z(c,c.url.milk1,1);
c.stock=[0,2,b.id,Oc,el];c.setupINTV(ih,{u:b.id,a:c.id},1E3);b.addWorker(c);b.d=8-c.d;b.stay()},ih=function(b){var c=A[b.u];b=A[b.a];c.milk-=3;var g=b.x32,e=b.y32;b.stock[0]+=3;aa(b.id,1);if(0>=c.milk||c.death){if(50<b.stock[0]&&(b.stock[0]=50),b.mv=!1,c=ae(b.kingdom,2,g,e),ra(c,b,qc,b.url.milk),0>c)return b.stay()}else Xb(b,1E3)},Ud=function(b,c){c.stay55()},td=function(b,c){ge(b,c)},ge=function(b,c){if(1!==b.death&&b!=c){if(b.dummy&&!F[c.kingdom].values.experience)return c.stay55();c.invisible&&
yd(c.id);if(!0!==c.build){c.mv=1;var g=b.x32-c.x32,e=b.y32-c.y32;b.space&&(e=Tg(b,c.x32,c.y32),g=e%E-c.x32,e=~~(e/E)-c.y32);c.setupDir(g,e,c.d2attack);c.url.attack&&Z(c,c.url.attack,1)}c.setupINTV(jh,{u:b.id,a:c.id},db(c.img),b);b.addWorker(c)}else c.stay55()};ge.distance=-1;td.distance=-1;var kh=function(b,c){var g=F[b.kingdom];if(g.values.experience&&(!c||0!=g.diplomacy[c.kingdom]||c.dummy)){if(0==b.level||null==b.level)b.level=0,b.levelProgress=0;b.levelProgress++;b.levelProgress>=~~(b.level/g.values.experience)&&
b.level<g.values.maxLevel&&(b.level++,b.health+=g.values.healthJump,b.maxHealth+=g.values.healthJump,b.levelProgress=0,b.attack+=b.level,b.defence+=b.level%2,aa(b.id,1))}},Ti=function(b){var c=b.level;b.attack+=c;b.defence+=~~(.5*c)},jh=function(b){var c=A[b.u];b=A[b.a];var g=b.attDist,e=c.x32-b.x32,f=c.y32-b.y32,h=c.x32,m=c.y32,n=!b.build;if(b.attackSound){var k=b.attackSound;pa(k[~~(k.length*Math.random())],b.x32,b.y32)}n&&!c.build&&b.setupDir(e,f,b.d2attack);Z(b,b.img,1);if(c.death||b.level&&8<=
b.level&&c.dummy||c.dummy&&b.level&&b.level>=F[b.kingdom].values.maxLevel)return b.stay();if(1<g&&!b.dragon){n=!0;var l=Ca[b.attimg]}else n=!1;if(c.build||Wd(c.x32,c.y32,b.x32,b.y32,g)){c.onattack(b);g=b.attack*((rd[b.type][c.type]||0)+1);if(n){c.space&&(e=Tg(c,b.x32,b.y32),h=e%E,m=~~(e/E),e=h-b.x32,f=m-b.y32);n=0;if(b.arrow||b.ball){k=gj;var p=Ug(-e,-f);var u=e;var y=f;var t=411/Math.sqrt(u*u+y*y);u*=t;y*=t;var w=Math.sqrt(1024*e*e+f*f*1024)/Math.sqrt(u*u+y*y);b.ball&&(l[1]=l[0]/w)}else{var x=2;
k=qf;n=u=r.gravity;p=Math.PI/180*60;t=Math.cos(p);p=b.attackDeg;p*=Math.PI/180;y=Math.sin(p);w=Math.cos(p);p=32*Math.sqrt(e*e+f*f);u=w*Math.sqrt(u*p/(y*w*2));w=p/u;y=-Math.sin(Math.atan2(-e,-f));p=Ug(-e,-f);u*=y;n=Math.abs(n*t*y);y=(32*f-n*w*w*.5)/w}w=Math.round(1E3*w);t={x32:b.x32+.5,y32:b.y32+.5,img:l.url,mv:b.ball,d:0,rotation:-p+1.5,xf:h,yf:m,obj:c.id,attack:g,range:x};Xa(t);Cc(t,u,y,n);Ia({func:k,data:t},w,1)}t||c.damage(g,b);if(c.dummy){if(50<=b.dummyDamage||!b.dummyDamage)b.dummyDamage=0;b.dummyDamage+=
g;50<=b.dummyDamage&&kh(b,c)}c.death?(b.action=null,c.build||b.build||kh(b,c),Hd(b)||b.stay()):Xb(b,db(b.img))}else b.build&&(Hd(b)||b.stay()),b.mv=!1,0!==b.state&&ra(c.id,b,ge,b.url.move)},ee=function(b,c){0<b.health?(c.dix=0,c.diy=0,c.mv=1,c.setupDirBuild(b),Z(c,c.url.kirka,1),Sd(c,"mine%20",3,c.img),c.setupINTV(hj,{u:b.id,a:c.id},7E3),b.addWorker(c)):c.stay()},hj=function(b){var c=A[b.u];b=A[b.a];var g=c.res,e=F[b.kingdom].values[0==g?"gold":"stone"],f=b.x32,h=b.y32;c.health-=e/F[b.kingdom].values.miningPerf;
aa(c.id);1>c.health&&(e=c.health+e,c.health=0,c.d=3,c.die());b.mv=!1;f=ae(b.kingdom,g,f,h);0==g?(b.stock=[e,g,c.id,ee,fl],ra(f,b,qc,b.url.gold)):(b.stock=[e,g,c.id,ee,gl],ra(f,b,qc,b.url.stone));aa(b.id,1);if(0>f)return b.stay()},ra=function(b,c,d,e){c.cow&&c.workers.length||(c.action=d.url,c.distance=0,c.nodes=void 0,0<b?(c.xf=b,c.yf=!0):(b*=-1,c.xf=b%E,c.yf=~~(b/E)),c.func!=Vd.url&&(e==c.url.move?Rg(c):c.mimg=e,c.dix=0,c.diy=0,c.mv=!0,c.setupINTV(Vd,c.id,0)))},sf=function(b,c){P(b);rf(c,b,kl)};
sf.allowPos=1;var kl=function(b,c){wd(c.id,c.inventory.slice(0));c.stay55()},Tg=function(b,c,d){var g=b.space||$k,f=g.length-1,h=g[f],m=b.x32;b=b.y32-1;for(var n=Infinity,k=0,l=0;l<f;l++){var p=l%h;p||b++;var u=(m+p-c)*(m+p-c)+(b-d)*(b-d);u<n&&g[l]&&(k=m+p+b*E,n=u)}return k},gh=function(b,c,d){var g=E,f=b.radix,h=eb[b.zLevel];for(b=2;60>=b;b+=2){c--;d--;for(var m=0;m<=b;){var n=c+m+g*d;if(h[n]===f)return n;n=c+m+g*(d+b);if(h[n]===f)return n;m++}for(m=0;m<b-1;){m++;n=c+g*(d+m);if(h[n]===f)return n;
n=c+b+g*(d+m);if(h[n]===f)return n}}return!1},aj=function(b,c){var g=E,e,f=Ja;for(e=2;60>=e;e+=2){b--;c--;for(var h=0;h<=e;){var m=b+h+g*c;if(0===f[m]&&0===M[m])return m;m=b+h+g*(c+e);if(0===f[m]&&0===M[m])return m;h++}for(h=0;h<e-1;){h++;m=b+g*(c+h);if(0===f[m]&&0===M[m])return m;m=b+e+g*(c+h);if(0===f[m]&&0===M[m])return m}}return!1},Cb=function(b,c,d,e){var g=c.x32,h=c.y32,m=E,n=g+h*m,k=b.x32,l=b.y32,p=b.space;if(p){var u=p[p.length-1];p=(p.length-1)/u;b=b.free}else p=u=1,b=Ji;c=c.rbase();for(var y,
r=Infinity,t=-1,w=!1,x=0;x<d&&-1==t;){if(0==x&&b){for(var z=[],A=0,B=b.length;A<B;A+=2){var C=b[A]+k;y=b[A+1]+l;if(ka(C,y)&&(c[C+y*m]===e||C+y*m==n))a:{var D=z;C+=y*m;y=g;for(var F=h,G=E,H=Math.pow(C%G-y,2)+Math.pow(~~(C/G)-F,2),I=0,K=D.length;I<K;I++)if(Math.pow(D[I]%G-y,2)+Math.pow(~~(D[I]/G)-F,2)>H){D.splice(I,0,C);break a}D.put(C)}}z[0]&&(t=z[0]);if(-1<t){w=!0;break}if(1==d)break}x++;--k;--l;z=u+2*x;D=p+2*x;A=0;for(B=z*D;A<B;A++)y=A%z,F=~~(A/z),y&&F&&y!=z-1&&F!=D-1||(y+=k,F+=l,C=y+F*m,c[C]==e&&
ka(y,F)&&(y=(y-g)*(y-g)+(F-h)*(F-h),r>y&&(r=y,t=C)))}return-1<t?[t%m,~~(t/m),w]:!1},Ui=function(b,c,d,e,f){performance.now();var g=E,m=b.x32,n=b.y32,k=b.space,l=[],p=0;if(k){var u=k[k.length-1];k=(k.length-1)/u;var y=b.free}else k=u=1;b=-1==c?-Infinity:Infinity;for(var r=-1,t=0,w=0;0==l.length;){if(y&&0==w){for(var x=0,z=y.length;x<z;x+=2){var A=y[x]+m,B=y[x+1]+n;ka(A,B)&&f[A+B*g]===e&&(l[p++]=A+B*g,t=(A-c)*(A-c)+(B-d)*(B-d),b>t&&(b=t,r=A+B*g))}if(l.length)break}w++;--m;--n;for(x=0;x<u+2*w;x++)f[m+
n*g+x]==e&&ka(m+x,n)&&(l[p++]=m+x+n*g,t=(m+x-c)*(m+x-c)+(n-d)*(n-d),b>t&&(b=t,r=m+x+n*g)),f[m+(n+k+2*w-1)*g+x]==e&&ka(m+x,n+k+2*w-1)&&(l[p++]=m+(n+k+2*w-1)*g+x,t=(m+x-c)*(m+x-c)+(n+k+2*w-1-d)*(n+k+2*w-1-d),b>t&&(b=t,r=m+(n+k+2*w-1)*g+x));for(x=1;x<k+2*w-1;x++)f[m+(n+x)*g]==e&&ka(m,n+x)&&(l[p++]=m+(n+x)*g,t=(m-c)*(m-c)+(n+x-d)*(n+x-d),b>t&&(b=t,r=m+(n+x)*g)),f[m+u+2*w-1+(n+x)*g]==e&&ka(m+u+2*w-1,n+x)&&(l[p++]=m+u+2*w-1+(n+x)*g,b>t&&(b=t,r=m+u+2*w-1+(n+x)*g))}return[r,l]},Ji=[-1,0,-1,-1,0,-1,1,-1,1,
0,1,1,0,1,-1,1],kf=function(b,c,d){for(var g=Infinity,f=!1,h=0,m=b.length;h<m;h++){var n=b[h],k=A[b[h]];if(0!=k.built||k.death)h--,m--,b.quit(n);else{var l=k.x32;k=k.y32;k=(l-c)*(l-c)+(k-d)*(k-d);g>=k&&(g=k,f=n)}}return f},ij=function(b){for(var c=0,g=b.length;c<g;c++){var e=A[b[c]];e.spd=e.__proto__.spd}},Pg=function(b){for(var c=Infinity,g=0,e=b.length;g<e;g++){var f=A[b[g]];f.spd<c&&(c=f.spd)}lh(c,b)},mh=function(b,c){rf(c,b,qc)},qc=function(b,c){b=F[c.kingdom];b.resources[c.stock[1]]+=c.stock[0];
b.stats.resources[c.stock[1]]+=c.stock[0];tf(c.kingdom);c.func=1;var g=c.stock[3];b=A[c.stock[2]];if(g==Oc){var e=E;for(var f,h=Infinity,m=!1,n=0;961>n;n++){var k=n%31-15,l=~~(n/31)-15,p=k*k+l*l;k+=c.x32;l+=c.y32;p<h&&(f=Ja[k+e*l],0<f&&0===M[k+e*l]&&(f=A[f],f.contain&&"meat"==f.contain[2].url&&(h=p,m=f)))}if(e=m)g=be,b=e}else"meat"==c.stock[4].url&&!1===c.stock[2]&&(e=jj(c.x32,c.y32,!0))&&(g=Oc,b=e,c.stock[2]=1);if(!1===c.stock[2])return c.stock=void 0,c.stay();c.stock=void 0;ra(b.id,c,g,c.url.move);
aa(c.id,1)};fe.cursor=6;oc.cursor=1;xd.cursor=9;vd.cursor=5;ce.cursor=7;sf.cursor=7;pf.cursor=6;mh.cursor=6;var dj=function(b){var c=E,g=b.kingdom,e=b.x32,f=b.y32;e-=16;f-=16;for(var h={},m=[],n=0,k=Hb[g],l=0;1024>l;l++){b=l%32+e;var p=~~(l/32)+f;ka(b,p)&&(b=k[b+p*c],void 0!==b&&(b=A[b],b.kingdom!=g||!1!==b.built||h[b.id]||(m[n++]=b.id,h[b.id]=1)))}return m};Vc.available=function(b,c){var g=F[b.kingdom].values.wood;if(c.death||1>c.health-g&&c.workers.length)c=ta(c.x32,c.y32),b.xf=c,c=A[c];return Cb(c,
b,1,b.radix)};ee.available=function(b,c){if(!c.death){var g=Cb(c,b,1,b.radix);if(g[2])return g}for(var e=c.x32,f=c.y32,h=0;5>h;){c=Yk(e,f,c.type,c.id);if(!1===c)break;c=A[c];g=Cb(c,b,1,b.radix);if(g[2])return b.xf=c.id,g;h++}return!1};Tc.available=function(b,c){if(c.death)return!1;b=c.x32+1;c=c.y32+1;return 0===M[b+c*E]?[b,c,1]:!1};Uc.available=function(b,c){var g=b.x32,e=b.y32;if(!c.death&&!c.built){var f=Cb(c,b,1,b.radix);if(f[2])return f}b.buildList?(f=b.buildList,f.quit(c.id)):(b.buildList=dj(b),
f=b.buildList);c=kf(f,g,e);if(!c)return"kill";b.xf=c;c=A[c];return Cb(c,b,1,b.radix)};Ud.rev=function(b){return 0===b.distance%3&&(b=Qg(b.id,1))?[td.url,b]:!1};td.available=function(b,c){if(0===b.distance%3){var g=Qg(b.id);g&&(b.xf=g,c=A[g])}return Cb(c,b,5,b.radix)};be.available=function(b,c){if(c.death)return!1;b=c.x32;c=c.y32;return 0===M[b+c*E]?[b,c,1]:!1};Oc.available=function(b,c){if(c.workers.length||c.milk<50/1.5||c.death){c=jj(b.x32,b.y32);if(!c)return!1;b.xf=c.id}return Cb(c,b,5,b.radix)};
hh.available=function(b,c){if(c.death)return b.stay(),!1;var g=1;c.boat&&(g=2);return(b=Cb(c,b,g,b.radix))?(b[2]=1,b):!1};var jj=function(b,c,d){for(var g=E,f,h=Infinity,m=!1,n=0;441>n;n++){f=n%21-10;var k=~~(n/21)-10,l=f*f+k*k;f+=b;k+=c;l<h&&(f=M[f+g*k],0<f&&(f=A[f],f.cow&&(!f.workers.length&&f.milk>=50/1.5||d)&&(h=l,m=f)))}return m},rf=function(b,c,d){for(var g=0,f=b.length;g<f;g++){var h=A[b[g]];ra(c,h,d,h.url.move)}},vf=function(b,c){Sa(c,b,uf)};vf.noObj=1;var uf=function(b,c){he(c,-b,77,uf)},
xf=function(b,c){Sa(c,b,wf)};xf.noObj=1;var wf=function(b,c){he(c,-b,130,wf)},zf=function(b,c){Sa(c,b,yf)};zf.noObj=1;var yf=function(b,c){he(c,-b,78,yf)},Bf=function(b,c){Sa(c,b,Af)};Bf.noObj=1;Bf.cursor=10;var Af=function(b,c){he(c,-b,132,Af)},Df=function(b,c){Sa(c,b,Cf)};Df.cursor=10;Df.noObj=1;var Cf=function(b,c){he(c,-b,131,Cf)},he=function(b,c,d,e){var g=E,h=F[b.kingdom],m=B[d],n=B[d].cost,k=b.mana>b.manaMax;if(zb(b)||b.checkMana(n[4],c,e,n)){k||h.paypal(n);e=d;c*=-1;k=c%g;var l=~~(c/g),p=
k,u=l,y=eb[m.zLevel],r=~~(b.mana/n[4])+1;1<r&&(h.resources[0]-=n[0]*(r-1),b.mana-=n[4]*(r-1));for(h=0;h<r;h++)0!==y[c]&&(d=gh(m,k,l),p=d%g,u=~~(d/g)),pa("summon"+~~(10*Math.random()+1),p,u),d=new Sc(e,b.kingdom,p,u,0),d.setupChild(Zb.spawn);b.setupDir(-b.x32+d.x32,-b.y32+d.y32);b.setupSpellIMG()}else h.paypal(n);aa(b.id)},Wd=function(b,c,d,e,f){return~~Math.sqrt((b-d)*(b-d)+(c-e)*(c-e))<=f},nh=function(b,c){Sa(c,b,Ef)};nh.cursor=0;var Ef=function(b,c){b.build||b.terrain||b.nofreeze||!zb(c)&&!c.checkMana(50,
b.id,Ef)||(b.freezed=1,b.stoned=1,Ra(b,32*b.y32),b.stay(),Z(b,b.img,0),b.setupChild(Zb.turnStone),zd(b,Oi),de(b.id),c.setupDir(-c.x32+b.x32,-c.y32+b.y32),c.setupSpellIMG(),pa("turn%20to%20stone",c.x32,c.y32),Ia({func:kj,data:b.id},24E4,1))},kj=function(b){b=A[b];b.freezed=0;rc(b);b.stoned=0},oh=function(b,c){Sa(c,b,ie)},ie=function(b,c){b.health<b.maxHealth&&!b.build?(c.setupDir(b.x32-c.x32,b.y32-c.y32),P("heal",db(c.img)),c.setupSpellIMG(!0),c.setupINTV(ll,{u:b.id,a:c.id},0),b.addWorker(c)):c.stay()},
mj=function(){Sa(list,obj,lj)},lj=function(){},ll=function(b){var c=A[b.a];b=A[b.u];var g=F[c.kingdom].values.healingRange;pa("heal",c.x32,c.y32);if(!Wd(b.x32,b.y32,c.x32,c.y32,g))return ra(b.id,c,ie,c.url.move);if(zb(c)||c.checkMana(4,b.id,ie)){c.setupDir(b.x32-c.x32,b.y32-c.y32);b.health+=6;b.setupChild(Zb.heal);if(b.health>=b.maxHealth)return b.health=b.maxHealth,aa(b.id,1),aa(c.id,1),c.stay();aa(b.id,1);aa(c.id,1);Xb(c,db(c.url.spell))}},Gf=function(b,c){Sa(c,b,Ff)};Gf.cursor=10;var nj=function(g,
c){g=A[g];c=A[c];if(g.inventory.quit(c.id)){c=b[c.spell];g.icons==g.__proto__.icons&&(g.icons=g.icons.slice(0));g.icons.put(c);var d=g.icons;d.olegal||(d.olegal={});d.olegal[c.id]=1;aa(g.id)}},je=function(b,c){var g=c[1];c=A[c[0]];A[b].nopotion||A[b].build||(ra(b,c,oj,c.url.move),c.actionItem=g)};je.item=1;var oj=function(b,c){var g=A[c.actionItem];c.actionItem=void 0;g.attack&&(b.attack+=g.attack);g.defence&&(b.defence+=g.defence);g.mana&&(b.mana||(b.mana=0,b.manaMax=0,b.update?b.update.push("mana",
"manaSpeed",1E3):b.update=["mana","manaSpeed",1E3],Ia({func:cf,data:[b.id,"mana","manaSpeed",1E3]},1E3,1)),b.manaMax+=g.mana,b.mana+=g.mana);g.level&&(b.level||(b.level=0),b.level+=g.level,b.attack+=g.level,b.defence+=~~g.level);pa("bless",b.x32,b.y32);c.inventory.quit(g.id);c.stay55();aa(c.id)};je.cursor=10;oh.cursor=10;vf.cursor=10;xf.cursor=10;zf.cursor=10;var qh=function(b,c){Sa(c,b,ph)};qh.cursor=1;var ph=function(b,c){if(b.isSpy&&b==c)c.stay55();else if(zb(c)||c.checkMana(90,b.id,ph))c.setupDir(-c.x32+
b.x32,-c.y32+b.y32),Z(c,c.url.attack,1),Ia({func:pj,data:[b,c]},db(c.img)-25,1)},pj=function(g){var c=g[1];g=g[0];g.die(1);var d=g.getRadix();d[c.x32+c.y32*E]=c.radix;c.x32=g.x32;c.y32=g.y32;c.d=g.d;c.name=c.name;c.attack=g.attack;c.defence=g.defence;c.update=c.update;c.mana=0;c.manaMax=c.manaMax;d[c.x32+c.y32*E]=c.id;Ra(c,32*c.y32);c.__proto__=g.__proto__;Z(c,c.url.idle);d=g.icons.slice(0);d.quit(b.menuBuilds);d.quit(b.menuBuilds1);d.quit(b.menuBuilds2);d.put(b.impersonate);d.put(b.revealSelf);c.icons=
d;c.spy||(c.spy=c.kingdom);c.kingdom!==g.kingdom&&c.changeKingdom(g.kingdom);c.setupChild(Zb.impersonate);aa(c.id)},qj=function(b){b=A[b];if(b.spy){var c=B[2];b.attack=c.attack;b.defence=c.defence;b.__proto__=c;b.icons=c.icons;b.kingdom!==b.spy?b.changeKingdom(b.spy):b.stay();Z(b,b.url.idle);aa(b.id);b.spy=void 0}};Gf.allowPos=1;var Ff=function(b,c){if(b.id){var g=b.id,e=b.x32;b=b.y32}else g=-b,e=b%E,b=~~(b/E);if(zb(c)||c.checkMana(60,g,Ff)){c.setupDir(-c.x32+e,-c.y32+b);c.setupSpellIMG();g=8;e-=
.5*g;b-=.5*g;var f=[];g+=1;var h=g*g;pa("bless",c.x32,c.y32);for(c=0;c<h;c++)for(var m=1;3>m;m++){var n=A[eb[m][c%g+e+(~~(c/g)+b)*E]];n.build||n.terrain||(n.setupChild(Zb.bless),n.blessed||(n.blessed=1,n.attack+=5,aa(n.id,1),f.put(n)))}Ia({func:rj,data:f},3E4,1)}},Sa=function(b,c,d){if(b[1]&&A[b[1]].item){var g=b[1];b.length--;rf(b,c,d);A[b[0]].actionItem=g}else rf(b,c,d)},zb=function(b){var c=b.actionItem;if(!c)return!1;c=A[c];c.attack&&(c.attack--,0===c.attack&&(b.inventory.quit(c.id),aa(b.id)));
return!0},rj=function(b){for(var c=0,g=b.length;c<g;c++){var e=b[c];e.blessed=void 0;e.attack-=5;aa(e.id,1)}},If=function(b,c){Sa(c,b,Hf)};If.cursor=10;var Hf=function(b,c){b.freezed||!zb(c)&&!c.checkMana(50,b.id,Hf)?c.stay55():(c.setupDir(-c.x32+b.x32,-c.y32+b.y32),c.setupSpellIMG(),pa("invisible",b.x32,b.y32),b.invisible||(zd(b,Zg),b.invisible=1,b.stay()),aa(b.id),Ia({func:yd,data:b.id},5E4,1))},yd=function(b){b=A[b];b.death||(b.invisible=void 0,rc(b))},rh=function(b,c){Sa(c,b,Jf)};rh.cursor=0;
var Jf=function(b,c){if(zb(c)||c.checkMana(50,b.id,Jf))c.setupDir(-c.x32+b.x32,-c.y32+b.y32),c.setupSpellIMG(),pa("lightning",c.x32,c.y32),b.damage(50,c)},Lf=function(b,c){Sa(c,b,Kf)};Lf.cursor=0;Lf.noObj=1;var Kf=function(b,c){var g=E;if(b.id){var e=b.id,f=b.x32;b=b.y32}else e=-b,f=b%g,b=~~(b/g);if(zb(c)||c.checkMana(50,e,Kf)){c.setupDir(-c.x32+f,-c.y32+b);c.setupSpellIMG();pa("flame%20ball",f,b);e=f-c.x32;f=b-c.y32;b=Math.sqrt(e*e+f*f);e/=b;f/=b;for(var h=c.x32+.5,m=c.y32+.5,n=[],k=[],l=0,p,u,y=
0;y<b;y++)p=h+e*y,u=m+f*y,k.put(p),k.put(u),p=~~p,u=~~u,n[l++]=p+u*g,n[l++]=~~(p+f)+~~(u+e)*g,n[l++]=~~(p-f)+~~(u-e)*g;for(y=0;y<0*n.length;y++)ud(n[y]%g,~~(n[y]/g),"food");Ia({func:sh,data:{list:n,anim:k,i:2,a:c}},1E3,1)}},th=function(b,c){Sa(c,b,ke)};th.cursor=10;var ke=function(b,c){c.setupDir(-c.x32+b.x32,-c.y32+b.y32);c.setupSpellIMG(!0);c.setupINTV(ml,{u:b.id,a:c.id},0);b.addWorker(c)},ml=function(b){var c=A[b.a];b=A[b.u];if(!Wd(b.x32,b.y32,c.x32,c.y32,F[c.kingdom].values.teachDistance))return ra(b.id,
c,ke,c.url.move);if(b.level>=c.level)return c.stay();if(zb(c)||c.checkMana(10,b.id,ke))pa("teach",c.x32,c.y32),c.setupDir(b.x32-c.x32,b.y32-c.y32),b.setupChild(Zb.curse,!1,bl),kh(b,!1),aa(b.id,1),aa(c.id,1),Xb(c,db(c.url.spell))},Nf=function(b,c){Sa(c,b,Mf)};Nf.cursor=0;Nf.noObj=1;var Mf=function(b,c){var g=E;if(b.id){var e=b.id,f=b.x32;b=b.y32}else e=-b,f=b%g,b=~~(b/g);if(zb(c)||c.checkMana(70,e,Mf)){c.setupDir(-c.x32+f,-c.y32+b);c.setupSpellIMG();e=f;var h=b;f-=8;b-=8;for(var m=0;256>m;m++){var n=
f+m%16,k=~~(m/16)+b,l=n+k*g;ka(n,k)&&64>=Math.pow(n-e,2)+Math.pow(k-h,2)&&Of[l]&&0===M[l]&&(P(n,k),new Sc(60,c.kingdom,n,k,0))}}},sh=function(b){var c=b.list,g=b.anim,e=b.i,f=b.a,h={x32:g[2*e],y32:g[2*e+1],d:0,img:l.flame_trail,mv:1,z32:2,alpha:!0};Xa(h);Rb.new(h,db(h.img));for(h=0;3>h;h++){var m=A[M[c[h+3*e]]];m.health&&m.damage(96,f)}b.i++;b.i<.5*g.length&&Ia({func:sh,data:b},50,1)},Qf=function(b,c){Sa(c,b,Pf)};Qf.cursor=0;Qf.noObj=1;var Pf=function(b,c){if(b.id){var g=b.id,e=b.x32;b=b.y32}else g=
-b,e=b%E,b=~~(b/E);if(zb(c)||c.checkMana(60,g,Pf))c.setupDir(-c.x32+e,-c.y32+b),c.setupSpellIMG(),pa("freeze",e,b),Ia({func:sj,data:[e,b]},1E3,1)},Sf=function(b,c){Sa(c,b,Rf)};Sf.cursor=0;Sf.noObj=1;var Rf=function(b,c){if(b.id){var g=b.id,e=b.x32;b=b.y32}else g=-b,e=b%E,b=~~(b/E);if(zb(c)||c.checkMana(70,g,Rf)){c.setupDir(-c.x32+e,-c.y32+b);c.setupSpellIMG();pa("confusion",e,b);c=4;e-=.5*c;b-=.5*c;g=E;var f=[];c+=1;for(var h=c*c,m=0;m<h;m++)for(var k=1;3>k;k++){var l=A[eb[k][m%c+e+(~~(m/c)+b)*g]];
l.build||l.terrain||l.stoned||(l.confused=1,l.invisible&&yd(l),zd(l,Pi),l.stay(),f.put(l),de(l.id))}h&&1===G.length&&aa(G[0]);f.length&&Ia({func:tj,data:f},2E4,1)}},tj=function(b){for(var c=0,g=b.length;c<g;c++){var e=b[c];e.confused=void 0;e.death||(Z(e,e.img,1),rc(e),e.stay(),gb==e&&(gb=void 0,G[0]=e.id,aa(e.id)))}},sj=function(b){var c=6,g=b[0]-.5*c,e=b[1]-.5*c,f=E,h=[];c+=1;var m=c*c;b={img:l.freeze_expl,d:0,mv:1,x32:b[0],y32:b[1]};Xa(b);Rb.new(b,db(b.img));for(var k=0;k<m;k++)for(var v=1;3>v;v++)b=
A[eb[v][k%c+g+(~~(k/c)+e)*f]],b.build||b.terrain||b.nofreeze||b.stoned||(b.freezed=1,Ra(b,32*b.y32),b.stay(),Z(b,b.img,0),b.invisible&&yd(b),zd(b,Ni),b.health-=40,1>b.health&&(b.health=1),h.put(b),de(b.id));m&&1===G.length&&aa(G[0]);Ia({func:uj,data:h},2E4,1)},uj=function(b){for(var c=0,g=b.length;c<g;c++){var e=b[c];e.freezed=void 0;e.death||(Z(e,e.img,1),rc(e),gb==e&&(gb=void 0,G[0]=e.id,aa(e.id)))}},Uf=function(b,c){P(c);Sa(c,b,Tf)};Uf.cursor=0;Uf.noObj=1;var Tf=function(b,c){P(b,c);if(b.id){var g=
b.id,e=b.x32;b=b.y32}else g=-b,e=b%E,b=~~(b/E);if(zb(c)||c.checkMana(100,g,Tf))c.setupDir(-c.x32+e,-c.y32+b),c.setupSpellIMG(),uh(e,b,3,20,4500,c.id)},uh=function(b,c,d,e,f,h){for(var g=l.fire_rain,k=r.gravity,v=Date.now(),q=uh.rnd,p=Math.PI,u=performance.now(),y=0;y<e;y++){var t=2*q()*p,w=d*q(),x=b+w*Math.cos(t);t=c+w*Math.sin(t);w=~~(y/e*f);ka(x,t)&&Ia({func:vj,data:{x32:x,y32:t-6,dix:0,diy:140,img:g,mv:1,d:0,timestamp:v,finnish:Infinity,aceleration:k,attack:40,xf:x,yf:t,range:2,kingdom:0,obj:h,
crashTime:(Math.sqrt(19600+384*k)-140)/k*1E3}},w,1)}P(performance.now()-u)},vj=function(b){Ia({func:qf,data:b},b.crashTime,1);Xa(b,0,b.diy,r.gravity)};uh.rnd=function(){var b=4096,c=2048;return function(){c=36969*(c&65535)+(c>>16)&4294967295;b=18E3*(b&65535)+(b>>16)&4294967295;return((c<<16)+b&4294967295)/4294967296+.5}}();var gj=function(b){A[b.obj].damage(b.attack,A[b.obj]);Sb(b);Ib.put(b.bufferID)},wj=function(b){b=A[b];b.bufferID&&(Sb(b),Ib.put(b.bufferID));Of[b.x32+b.y32*E]=void 0},qf=function(b){var c=
E,g=b.xf,e=b.yf,f=b.attack;b.mv=1;b.func=void 0;b.x32=g;b.y32=e;Cc(b,0,0,0);Ra(b,2);g=~~g;e=~~e;var h=g+e*c,m=M[h];ec[h]?(b.img=l.expl_small_water,pa("water%blop",b.x32,b.y32)):(b.img=l.expl_small_hole,pa("small%20explosion",b.x32,b.y32));Z(b,b.img,1);Rb.new(b,xj(Ca[b.img]));if(2<m){var k=A[m];k.damage(f,A[b.obj])}h=b.range;m=2*h+1;for(var v=0,q=m*m;v<q;v++){k=v%m-h;var p=~~(v/m)-h,u=~~Math.sqrt(k*k+p*p);u<h&&(k+=g,p+=e,k=M[k+p*c],2<k&&(k=A[k],k.damage(f*(1-u/h),A[b.obj])))}},nl=function(b){if(0<
G.length){var c=A[G[0]],g=0,e=0,f=0,h=0;void 0!==c.dix&&(b=.001*(b-c.timestamp),h=c.dix,f=c.diy,g=h*b,e=f*b);if(c.space){var m=c.space;b=m[m.length-1];m=(m.length-1)/b}else m=b=1;g+=32*(c.x32+.5*b-Math.sign(h))+.5*-tzar.width+.5;e+=32*(c.y32+.5*m-Math.sign(f))+.5*-tzar.height+.5;rb=~~-g;Da=~~-e;nd(-rb,-Da)}},yj=function(){};ie.distance="healingRange";uf.distance="createGolemRange";Ff.distance="blessDistance";Pf.distance="freezeDistance";Rf.distance="confusionDistance";Hf.distance="invisibilityDistance";
Jf.distance="lightningDistance";yf.distance="createBatDistance";wf.distance="createDragonDistance";Cf.distance="createCarpetDistance";Af.distance="createJinnDistance";Ef.distance="turnToStoneDistance";Kf.distance="flameBoltDistance";Tf.distance="fireRainDistance";Mf.distance="freezeDistance";ke.distance="teachDistance";var F=[];var kc=function(b,c,d,e,f,h,m){this.name=b;this.k=F.length;this.color=c;this.status="";this.stats={dmgInflicted:0,dmgTaken:0,resources:[0,0,0,0],score:0,unitsKilled:0,unitsLosed:0,
buildsLosed:0,buildsDestroyed:0,unitCount:new Uint32Array(B.length),unitCountMax:new Uint32Array(B.length),unitCountDeath:new Uint32Array(B.length),goldTraded:0,goldConverted:0,stoneTraded:0};this.team=m;this.resources=h||[5E4,5E4,5E4,5E4];this.values={gold:10,wood:10,food:10,stone:10,buildSpeed:1,experience:0,healthJump:0,maxLevel:4,pop:0,popMax:1,popLimit:200,healingRange:1,blessDistance:9,createGolemRange:5,freezeDistance:13,invisibilityDistance:9,createBatDistance:16,lightningDistance:12,createDragonDistance:4,
turnToStoneDistance:21,flameBoltDistance:19,fameTech:0,confusionDistance:13,manaSpeed:2,milkSpeed:2,cowSpeed:2,stealCow:0,miningPerf:1,fireRainDistance:15,createCarpetDistance:3,createJinnDistance:3,teachDistance:2};this.race=e;this.racestr=vh[e];this.IA=f||0;this.diplomacy=d;this.control={};this.control[this.k]=1;this.onFreePop=[];b=[];b.length0function=ol;this.unitLoading=0;this.target=[0,0,0,0];this.crusade={number:0,list:b};this.technology={hidden:{},disabled:{},actived:{},investigated:{}};this.mod=
c=[];zj[this.racestr]++;b=0;for(d=B.length;b<d;c[b++]={});F[F.length]=this;b=this.k;c=[];Hb[b]={};lb[b]=c;for(d=0;d<B.length;d++)c[d]=[];c=this.color;Fa[3*b]=c[0]/255;Fa[3*b+1]=c[1]/255;Fa[3*b+2]=c[2]/255};kc.prototype.setupResources=function(b,c){var g=this.resources;c||(c=1);g[0]-=b[0]*c;g[1]-=b[1]*c;g[2]-=b[2]*c;g[3]-=b[3]*c;tf(this.k)};var lb=[];var Hb=[];var Fa=[];kc.prototype.check=function(){if(this.values.pop)return!0;for(var b=pl,c=lb[this.k],d=0,e=B.length;d<e;d++)if(!b[d]&&0<c[d].length)return!0;
this.die()};kc.prototype.checkPopArray=function(){this.onFreePop.length&&Yd(this.onFreePop.shift())};kc.prototype.die=function(){this.death||(this.death=1,this.status="defeated",Aj(),nb(Ad(x.playerDefeated,this.name),0,5))};kc.prototype.paypal=function(b){var c=this.resources,g=!1;c[0]<b[0]&&(nb(Ad(x.notEnough,x.gold),0,5),g=!0);c[1]<b[1]&&(nb(Ad(x.notEnough,x.wood),0,5),g=!0);c[2]<b[2]&&(nb(Ad(x.notEnough,x.food),0,5),g=!0);c[3]<b[3]&&(nb(Ad(x.notEnough,x.stone),0,5),g=!0);if(g)return g;c[0]-=b[0];
c[1]-=b[1];c[2]-=b[2];c[3]-=b[3];tf(this.k)};var tf=function(b){if(b==w.kingdom){var c=F[b].resources;b=c[0];var g=c[1],e=c[2];c=c[3];Infinity==b&&(b="***");Infinity==g&&(g="***");Infinity==e&&(e="***");Infinity==c&&(c="***");ql.innerHTML=b;rl.innerHTML=g;sl.innerHTML=e;tl.innerHTML=c}},pl={13:1,20:1,21:1,22:1,27:1,32:1,35:1,36:1,43:1,44:1,55:1,56:1,57:1},Gb;var Bj=[];(function(){var b="",c=new Image;c.src="data:image/gif;base64,R0lGODlhIQB2AfcAAAAAABAIAAgAABEhACE6ABkbChAQAAgIABAQCO/vlN7epf/6hZSQUv76n721a//rY/XmhnNjECklEP7oecW1Y+7ZeP/rhvvrljEpCCgiB+/Wa97OjP/WSu3YhyEZAIhzLf/WWOnHWv7baL2lVt3Db/vsvUo3BGtSCGhVIdq1SnhjKdy4V62USuvIaPzad/felO/XlzopAGtaMe3Kd/zbiOjMhv/9+JxzGWNKECEZCP/JSuu5Sc6lSMynV4tzPdSyaK2UWjEhADopCNacKWNKGVdCGf/IVuu4VruUSPzJZ7qYU0IqABkQAGdFB2tKEFI6D5tzKMqVN9unSNyrVlRDI/nLd7JwACkZAOaUEDEhCMSMMZRrKYlkJ/u3SJt0M8yYRquDQO66Zu3MlrWcc5haAItSAf+lGUIqCGNCEJdjGXpTGJxrIfisOGtKGcSNOtacQruHOfu6VsiYVOm6dPvLh/rZqTohAHdHB3NKEFo6D0kxEJRjIc6MMalzKYRaIZxrKXlTIuCcP6x5M+umR1I6GX5aKdacSuqqVdedUollNK2HVUopAFQxBXtKEGtCEMmBJ7h2J3NKGdeNNMOCMWNBGZRjKf2rR86MOtaUQpdpMt6cSrqFQkk0GnVWL9OjZolVGeeQLJ5jIKdqJ4xaIeCTObd6NembRt6UQsWEPGlHIf+tUsuMQ9aUSppyRzEZAGU1BkopCHNCEDohCFIxECkZCPeXM3tKGdKDMIRSIZxjKlo6Gc6EOoxaKahwNt6USjUkE/zLmUIgACEQAIZLEtZ2H5ZUF2Y6ELlpIN9/KGtBGUUpEHVKIRkQCNaMRntCEHNCGZdZI86MUjoZAFQoBs5qIF0xECUZEE8hAHQ0CIQ9C5RHD65TFb5cGXY6EDEZCHtCGYRKIVIxGSkQAEohCEIfCVIpEKJEEUUpGWgnBzoZCEIzKzEQABkIAHMpCIw0CyEQCFsZAlEZBikQCDQZECEHAD4PATEQCGshEDEIAPNGKRkAABAAABkICBAICAgICP///yH5BAEAAP8ALAAAAAAhAHYBAAj/AP8JHEiwIEEBBhMqXPiP3QGEAwVAZKgQYoBwLAIMpIUCwESKE5lI/CeA0woU+wTSIvHk40IBD/9x+vHrnYB9+358EbdPwDsavfi5NMiEChcA/5i0QIKrzTsANeQoC+DzAhJvKYcK3AeoAheqAlbo0XNGlpIKR5axEyChwwo/U7UK+EWiAxRdgH5RGnWpD6ArwpCUWlaES40WX0pRompQwIcXLbR8ObKi1BdUcXatMsZuFCUuUtxKidLr11ABT5Ag+tIHjK5MYb5UilPqlK0rVwKkmiJFyyVBpgsyCRCAEpIvyubJC4CkCq9Rh3JhqiRSAJQvcPgIUgaTIIofMvL8/5hCKwfEHmEiDcq0CtosdklHjeoDaSpSgQKoWGjRowMYWh4JlEgYm4wyhR+buaKLAEwoQ4gfs9CikUBM/OBWCytEAuBESIThhyZbVGILOU+QJEAOhFBCyy/44QDDDFKsgJwwqRA0oBejiBJJMmecYSIAOSxjjzf4jeLCFNi9ocxugAyk3hSVhIILGmd4U6KJ77yTAzu/cMIOZXBQ4gcsRXyRhB4CPXEJHT2U4kUyeggzS0QCABAAHD0koUIP/HkjzwH/+ODCFz7qUQoNM3zBVB5X+GjQLGBQtkIHSTxDXAB5wGFBGEUUcUsVF8SWSzJZyJLQTZUc0cIMK7ghhAAZ/P9DySAWuBCHKYdcMMMUgkQSZxGnyiPFF27wIAUX9hgQQBu4DOKCrVLQUMURboySBxNonurFCmn4UYoWfsiT0l6TDBLHIWGEgeQfaAQhREXhrADHLLrgIsgswgiURySiuCEFK4dg4oYoz5yhlUDiRCEFJfZk0UYeNgkkizGfiCJKKajAkYstswTQpEKzVsIOO+Rk4Y1IAglzRh7OQFOKIKF8wmgWClHVhyRFBOARLbRMxI4wsDgSSh99jJKMLKfNxY4abgiii851fiQAO64Yc4woebiCckE5qFCFEnB8IcUWv2zdmDDDSCMRg40RIkgILVAmxRPvTJjQPuwA4FG+pzL/w8UkYGCXzC8BJkSVnSBloYssnMxSsgEHU2RQFjoH4I0wkUuuEAB4Z655RZ8rVAIgzIQeehx0RMKE6Z9XkcQspbNOESZ0xAG77BQFAoztseOukO6WlNO77waZUocls+RAvEKHHJ/88gk1X4sxtEBvUBh1sGGM8tYTNIgNtXzC/T9kVA99IOA/f0cJtYxPPB82gHLHP03QYAU93fOBzDE5bGLKK90byB1I4Q3zdS8PjGhCCaxgQOjdwQZWMAMtzIAFmlmPBmzIAiX+8YohlKEM81teGXg2kDLYgAZkCOBAmlCLWtxHhf/4IAxnSMMa2vCGOMyhDnfIwx768B82QEMN/2dgg3fN0BNhsAERZtgKRMDABsaYISvCAIMSPINIAczEEeRQhxK8woLWe8UOLrGCElzAFukIIB+O8IgpXGAOr0hHH6yXiyQkRgwwSMIdvGGx5anBCFNYhSjmMIcj3MAbgIDE8jQRBkQIYg3j2YEUZBELLRAPCUk4hBy4kAs5wEFh8nDEG6KAuyZkcgpwaEQvFCGIK3jjDIx4xA5wd4QjBPITjviDMITBjiysCAMvDF0f4iCFUkBDDx6QhTVmIY/CyY4eSZACKi5BjgA0QgtbkEUDZReFHexAHOKoRAPC0IZXLm8ZIBCHzvTgiVKlwhrLO4cx9oEUAGSAFnKYAhf6of9CABxAEDtIhCxMAMMA7OEMPSiGGmDIiDF0AAnQgOEBQFEDRgSzeyYoBqZ+yNGOevSjIA2pSAVygic0gXVLkFwT3BGPeIQOHYx4wkUL0gRzcCMe2KiH5tCBDnfo7R/kUIg79hcPdLhUcuiwqUvrwQiDtJQatQiEOdxBAKQO9RgR6GlCpsENZOgAGdxoRzAo8tSoTpUA7RhIPYo6VB3ooAuSaCpFuOpVsLZDrsFohzt4So0u6MAIICjGWBligra+Na7uYEQw3OGOf5iAG2z46wOksA10UAQdff1rYBlbD3MU4x/40EYtACuCB1SWIo+NrBEmy9MMcIMa7sAHPh6hAxD/GIEDoOAGNggrWtKaFh3C2AYoGCvbY7CBDaAgRjF2S9ha1Pa2oMgGPhhRC9hqY6/aSC4xZMHchZgAG9g4bnKLEQ/hgsIc1KCGOeqhjW6wFJwUwYY7skuM7b5iG1A9BlSJgQ5yoMMY2CiA5kyAjm24Nx5LcAc12BAIZBx3G8HARgbEEVTJYWMc4/gvNmiBDmKAQge1YEMXkGEOciDucxgex4QZUY/6dsEIx60FMnA3DmwwIwCMYIQ5zEGMOOiADSGuMOsC8F1s5HjHo+1CLUABCuIFYLc7tikpunAL4Q4Deozdhja2wQ1zwOMRw7gy8eABj20Uoxxchgc5lKGM5cGj/7NnCEA3wgqAJaQUeu2gypPRUY9pbMN6AchCBhAQjAybo3tkzkA83lEAIXcvB9gQRwGkMdJKW/rSBlHGDFhHAxZRJAdV2PTnfhCGbSbkHZqgQRg0hwgXaMLTDBEGL1ywK4qsIgxJyISpDSKMZEBCD0VIxEIooQxvbCMZuy6IN6YSgGQPJAuY24ezB+IndsDCCFFUSB6mAIt3sAOLmnsGJXRBhSIAQhB9EIUXEkGIZETI0Zr7hS5IMYELXKABF6hAC5JwhC+0wZes08UXBpEEC1igAQ2oVRICAYdKKAPeklvGwI0wgYM3YAJJiMMb4MALPUw7Ictwg7lEgHFTTCEJYf9wQy9SUZOA/yEQcQDBD/KRD3f4AA598MMTaPEO1inDW4OwRCvu4Y56qAMQe2iDMnIgD9Z5IxJ9MIUlOsGJeajj6J/QxS+Y8XGD0IISezhFF7rwB3VQAQqTiESEEADuz3ljFkDvgghEYIRBKGbpzADj52ThsJfL3QVGOAIXnpAFZuRddjl4Ai5IYQkjiICYfvA4M3ouO1n8IhKCGIQRkmCJLwBi6c32nTcI0Qdz1V0QRaBc1xkiC13AwQinJwQz2o67TCjDGKUwRR+MUQ0JWO8Qn3+HhNjxiVNA7xBfqIaQx5EHTKyCeGCYAiXSSJB08IIUgsBdKwyBC9oLRBm5sLv/7MCQiDYrJBWtyASm189+9tvBDq4QBwyfMApW9CEZ7EhJ98Cwik3EYRKrYFHdkwhV8AW4kASiYAqRMDLWIwc0gAu2cAi4oAm84DmjVgV5IIHNMApnMFOy4zWbAAiH8AyowAj0MCfQowRzEAmHUAi84AhXQFCycyUCUgWZgAu5gAbGcAWuIDtEcAjAIhDJcAg/wAuVoAbV4ArsIIOh8wRy4AJBIBBnsAoX8AOb4AXGEAz7YCqs4wMQgAhX8A9nUAoXQANToARqwAhUIzsmsAoJEAZjsQs00AAFWAnGsEu4kwdxkAATcASkEAYNoGqCEAvBIADZYjqUoAaHAAEYlyuq/2aAsCAAjsI6eTAKbnAIKFcFVRAGhvAHeSAMYYg7JuAIorAKU4AIYcAKXyAKO+iBnyMOjKAGfyAKvVAKm5ALjhAMAPAxuLMP0jANxjAMgiAI0OAIsPAzy+MRrjANwwAN0MB74uCKoaM3+jANxVAMdrAW0mg6nPMK9KA3zgQ9HgGOdmM94LiN7ZeO6riO7HhpvdALgJAKNdI9QFAKq7AKqggGhQBrvvMDM2AKvsAK94gKm5AJ50A8PwADdBAGAMkKqECQmyAInOA7JFACM3AIhzAIlXBurLAJBTmRsvMDJVADh7ADEPACiZAKuXePnYA7P2ADdRAGgzAHNqAA35AKnP+QCJ1ABbjDRSUQBhipATZwBLkAADc2ALgDBh1AA3FzBKkQAhuwCalQjrKDCPl2BILgD9TQC60QDa0gYL6TCj/QAodwDgDACZsADK3ADAiwPKmQCVQQO5nQCe/Qb9XglsFEBb9QBz8gCLYAQ79ABXy5ChukQr/QCTDgCaUQDoBJBWLgCZkAkgH0C4nwmJnAmIbZCmIgB51AldDzC62gCOqQAZ65PL/wCwdAHDN0Ke3Ymq75mrAZm7ApmbhDmwSRCqdQmOFgfp9DCKigC5kGCKUADsogAnCFmQwRB3GgBxeDC6aWBctwBtzwAA1gCZFAEV0wAQ1wDNWQDJRnEAeQBZD/YAkuUJ28aRCWUHGWgAzCoHeZJgi7kJ4NcAsKUQsNIAKmIAmiAJwMkQOUwC+3cAQQkAwGkQsL0AWQMArQoCGSkwM8MwvVMAu+QhCzoAbdMA16oE3uwzq4EAeqcJ7W06ElIALQAKLLE4E0cAvpUJq+MwtWMw4BsDoq9A4ZyqIU8XV/UAqScJ9GwIsDMQopQAKBMAkv0waHyDX+VApJUAITEAi8gJwDoQzHcAQlQAeDwAVTYaL/ACBMcABwMAinIApQShCyAAldkACJEAAHACQJoQx/gAzKcABuUApaOhDGIAnHAADdoA0kVBCzIAmWwAbcAADLkAx1+n1/wAS/wAeg/0ANBaEMcKAKpoAJnZAFAKAHhzoQyaAzlPAFpkAKkGBBunEJojALT2GUR6oQlKM3utALl0CnysMMB7AM5sMzY7oQv2A+DqML72B+zMCPxMMJB7B6slmsxnqsyNqO+0AfvoMOxcANxIAMknALx9AHoHgEgzAIxxA6jNAIj0AKRxCI0hIGkjAM7JAG5UmHpvA5mNMIXeAGaeAIS3AF4tAEWfMIoGAEFjcDbyA5IoEbxMEOTMAEAssEwuAEofAIjyAJSfAsUyA5+ReF//AJgjAJdwaKrrAIefAKd3AHogAH/fo5dyAGJWAJ1BAD/yAM4mAHMWAHgLFLBksRFisQV0ADSf8wCKGwCLgzCW/AB4GABsPxD3aQbq/wCnbwOVwABsYyAzRgK4MQBIUDGOIgo/8AB1uABqJAgwQhDksjBWFQBS5QBVGAOaIACYvwBGcQA4wgCF57CHFACqJwZwkBAMGwDccACX2xD0EgCpJgBC5gAWVYBdIyGsVAD/LHEPtwDdjwCX2wFsWQBpCgsNN6CZOQBp8QC9JwBVTLEAHADoygM0zgCuswDdfAU9LQE5wTDD34OewQAK6gfzPEN8k6u7Rbu7Z7u7ibu5rTB+LAhSr0LNPAN4VgqbuoBJ+FOyKwAq9gCAYXBqUwAxVAAz8wDdhwvKxTDCFgAUlwb67TAmEwA47/kA2LKzsNsABJAHtx0AWB0AMkQAl5EwvOwDoJB3tG0AWDQApTAAaYQxw/FTrl6wIZ1wWgQAqIsARrozcWWBAAbARxMAiSgAibsL/nKDthgK2kgAmIYAwSoY11gjtTsAluoAmlQBX0cAYqEBO+AwdKoASMIBH0Cgap4AqhiDtKoAiuQBUHgAcqsAAO0AEMQDxMIA514hEBIAwU8ASfcAUJ/DlXUAFPYLfXsBYBdAbbUAWmEAoC2D2u8AoAPAmfIMXdIwClUAWaAA0trEKycAhVAAmOgDkBZAe4EAY/8AmRqEJnAAdzIAiOcMMqxAhfMAqzQDl2nMRqaqO4kxtLrLuK/7zIjBxSsLAIROIEgMkCUqAOUDANAbQFH8ACK+ACbfAJAqEGLLBQvpMBbbACK9AFXOAov7ADR+s7A5ACPAACg2ALRiQNtHANy+MNn5AMsMAEJ2UQetAGbcAIsAAFn0MLJsAOdiBXBgEASAAIPdAK5ODMC+EIjjANWSACSDEWZSEQX0ACYcADK2AIMkIR2VAEKwA0D8AEe9EXfyEMAGAMSRACIdArM7wQAXAEI8AFM9AGXnAZmbEZ7JC8UoAEUfAJqWo4gGABSqABI6AHmyAbtGEbuNEHe4AHdWYQd2DCjKAJLoAEIr0CUiAFhFAERQgd0kEd7CAPApBsDDABLSAA5P/gLCtAGVPwB0TgA+mxHu3xHuxwDbsGAJsQAl2gN8swCFMgKVJgDHpAIAaCIMagIAshDVzQBVpwAFywADCCylOQCZSgB53gISAiIiTCEOGgN1CgBUUbBVGgDFygBt7wDlwQBjiiIzwyiQnxCgLACK7gCrvIBYSwCUXwBHP9JFEyJVWitQzRD81w0mYyFkygJmziJnAiJ5rzCrLwDD4hKIQyD4aCKIqCC4yi1wvxCvQkDrSQKZvSKZ8SKl8wKqXCOgbgDbNSK7eSK7vSK7/CED4ABipQEMziLNAiLdRiLdiyEMxwBF1gouRiLuiiLl/ALu6yENOQCG0ACwmxL/3yLwFJMzAFkzmguBATUzEXkzEb0zE+yjoqwzIuAzMycwXuyTo/EzRDUzRHk8gVQTVWgzVao98vgTZqIxGbuzx4g8CyC2h1YsiN/DkBAQA7";
var d=document.createElement("canvas"),e=d.getContext("2d");c.onload=function(){d.width=33;d.height=34;for(var g=0;11>g;g++)e.drawImage(c,0,34*g,33,34,0,0,33,34),Bj[g]=d.toDataURL("image/png"),b+=".ncursor"+g+"{cursor:url('"+Bj[g]+"'), default}",e.clearRect(0,0,33,34);document.getElementsByTagName("style")[0].innerHTML=b};Ec(2)})();var le=function(b,c){t(b).style.display="block";le.actived=b;c.actual="potion";c.id=0;c.amount=100;c.func()};le.actived="";var fa={potion:{bak:1,max:4,ord:["level","mana",
"attack","defence"]},sword:{bak:5,max:3,ord:["attack","attackBow","defence"]},book:{bak:8,max:18,ord:"fireRain lightning healing createCarpet createBat bless freeze confusion invisibility createGolem magicVision raiseDead turnToStone whirlpool createDragon flameBolt teach createJinn".split(" ")}};t("mgbook").onclick=function(){fa.actual="book";fa.id=0;fa.amount=b[fa.book.ord[fa.id]].obj.spcost[0];fa.func()};t("mgpotion").onclick=function(){fa.actual="potion";fa.id=0;fa.amount=100;fa.func()};t("mgsword").onclick=
function(){fa.actual="sword";fa.id=0;fa.amount=100;fa.func()};t("mgdecline").onclick=function(){t("magicworkshopmenu").style.display="none"};t("mgitem").onmousedown=function(g){var c=1;g.button&&(c*=-1);g=fa[fa.actual].max;0>fa.id+c&&(fa.id=g);fa.id=(fa.id+c)%g;"book"==fa.actual&&(fa.amount=b[fa.book.ord[fa.id]].obj.spcost[0]);fa.func()};t("mgaccept").onclick=function(){ea(Cj,[fa.actual,fa.id,parseInt(t("mgamount").innerHTML)],G[0])};var Cj=function(b,c){c=A[c];var g=b[2],e=[g,0,0,0];Gb.paypal(e)||
(g=~~(250*g),"book"==b[0]&&(g*=2),c.setupINTV(Dj,[b,c.id],g),c.lcost=e,c.techStart=c.c-r.cycle,aa(c.id)&&(t("magicworkshopmenu").style.display="none"))},vl={defence:6,mana:0,level:2,health:1,attack:5},wl={attack:"sword",attackBow:"bow",defence:"shield"},xl={attack:.5,mana:1,defence:.5,level:.2},Dj=function(g){var c=A[g[1]],d=g[0][0],e=fa[d].ord[g[0][1]];g=g[0][2];c.lcost=void 0;"sword"==d&&(d=wl[e]);"attackBow"==e&&(e="attack");d=Object.assign({},xb[d]);if(d.potion)d.d=vl[e],d[e]=~~(g*xl[e]);else if(d.book){var f=
b[e],h=f.obj;d.spell=e;d.attack=~~(g/h.spcost[0]);d.name=h.name;d.iconID=f.iconIDbook}else d[e]=~~(.25*g),250<d[e]&&(d[e]=250);P(d);Rc(52,c,!0,d);c.techStart=void 0;aa(c.id)};t("mgamount").onmousedown=function(g){var c=10;"book"==fa.actual&&(c=b[fa.book.ord[fa.id]].obj.spcost[0]);var d=c;g.button&&(c*=-1);Db.shift&&(c*=5);fa.amount+=c;0>=fa.amount&&(fa.amount=d);t("mgamount").innerHTML=fa.amount};fa.func=function(){t("mgitem").style.backgroundPositionY=-48*(fa.id+fa[fa.actual].bak)+"px";t("mgamount").innerHTML=
fa.amount};var Vf=[0,0,0,0,0,0,0,0],Eb,md,ya=[document.getElementById("order1"),document.getElementById("order2"),document.getElementById("order3"),document.getElementById("order4"),document.getElementById("order5"),document.getElementById("order6"),document.getElementById("order7"),document.getElementById("order8")],Ej=document.getElementById("bottominfo"),me=ya[0],ne=ya[1],oe=ya[2],pe=ya[3],qe=ya[4],re=ya[5],se=ya[6],te=ya[7];me.addEventListener("mousedown",function(){me.style.transform="translate(2px,2px)"});
ne.addEventListener("mousedown",function(){ne.style.transform="translate(2px,2px)"});oe.addEventListener("mousedown",function(){oe.style.transform="translate(2px,2px)"});pe.addEventListener("mousedown",function(){pe.style.transform="translate(2px,2px)"});qe.addEventListener("mousedown",function(){qe.style.transform="translate(2px,2px)"});re.addEventListener("mousedown",function(){re.style.transform="translate(2px,2px)"});se.addEventListener("mousedown",function(){se.style.transform="translate(2px,2px)"});
te.addEventListener("mousedown",function(){te.style.transform="translate(2px,2px)"});me.addEventListener("mouseup",function(b){Eb=b.button;Wa(0)});ne.addEventListener("mouseup",function(b){Eb=b.button;Wa(1)});oe.addEventListener("mouseup",function(b){Eb=b.button;Wa(2)});pe.addEventListener("mouseup",function(b){Eb=b.button;Wa(3)});qe.addEventListener("mouseup",function(b){Eb=b.button;Wa(4)});re.addEventListener("mouseup",function(b){Eb=b.button;Wa(5)});se.addEventListener("mouseup",function(b){Eb=
b.button;Wa(6)});te.addEventListener("mouseup",function(b){Eb=b.button;Wa(7)});document.getElementById("stock").addEventListener("click",function(b){Fj(A[G[0]])});var Fj=function(b,c){if(0==T.stockActive||c){if(c=b.inventory,c.length){var g=[];g.length=c.length;for(var e=0,f=c.length;e<f;g[e]=A[c[e++]]);la(g,b,1)}}else la(b.icons,b)};(function(){for(var b={},c=0,d=ya.length;c<d;b={l:b.l},c++)b.l=c,ya[c].addEventListener("mouseenter",function(c){return function(){var b=T.displayed[c.l],g=A[G[0]];if(g&&
g.kingdom)var d=F[g.kingdom];if(b){if(void 0!==b.unit){g=B[b.unit];var e={name:g.name,cost:Ri(g.cost,b.hero||b.merc,d.values.fameTech)}}else e=b.obj;T.stockActive&&Wc(T.active[c.l].id,1,1);if(e&&e.name){var k=e.name;g="<span>";g=2==k.length?g+(k[0]+" - "+k[1]):g+k;if(k=e.cost){!e.tech&&d.mod[e.type]&&d.mod[e.type].cost&&(k=d.mod[e.type].cost);g+=" - (";for(d=0;5>d;d++)k[d]&&(g+=k[d]+"<img class='resource' src='"+yl[d]+"' /> ");g=g.substring(0,g.length-1);g+=")"}g+="</span>";G.length&&(F[A[G[0]].kingdom].technology.disabled[b.id]&&
(g+="<span class='red'>"+x.requires+": "+b.require+"</span>"),e.type==ob&&(g+="<span class='increase'>+"+e.increase+"</span>"),(d=T.active.cut)&&d[b.objName]&&(g+="<span class='shotcut'>"+d[b.objName].toLocaleUpperCase()+"</span>"),Ej.innerHTML=g)}}}}(b)),ya[c].addEventListener("mouseout",function(){T.stockActive&&Wc(G[0],1,1);Ej.innerHTML=""})})();var wh=function(){history.pushState("",document.title,window.location.pathname)},Wb=function(){r.online=0;location.hash="";t("MatchX").style.display="none";
document.getElementById("index").style.display="block";document.getElementById("returnmenu").style.display="none";document.getElementById("game").style.display="none";document.getElementById("chat").style.display="none";document.getElementById("gameFinish").style.display="none";setTimeout(wh,200)},Wa=function(g){var c=Vf[g];Wa.lastFunc=c;Wa.nu=g;if(T.stockActive){c=A[G[0]];var d=A[c.inventory[g]];d&&(d.potion?Db.control?ea(je,c.id,[c.id,d.id]):(Q=je,Q.item=d.id):d.spell?Db.control&&c.mana?ea(nj,c.id,
d.id):(b[d.spell](),Q.item=d.id):(ea(wd,c.id,[d.id]),aa(c.id)))}else c&&c();Wa.lastFunc=void 0;Wa.nu=void 0;ya[g].style.transform=""},hi=function(b){var c=[.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.27,.3,1,.5,.5,.5,1,.62,.62,.62,1,.74,.74,.74,1,.3+.58,.3+.58,.3+.58,1,.94,.94,.94,1,1,1,1,1,1.06,1.06,1.06,1,.3+.82,.3+.82,.3+.82,1,1.08,1.08,1.08,1,1.04,1.04,1.04,1,1,1,1,1,.95,.95,.95,1,.3+.58,.8,.7,1,.3+.54,.72,.6,1,.7,.62,.5,1,.6,.55,.3+.15,1,.5,.44,.42,1,.4,.37,.35,1],g=new Date;
null!=b&&(g=b);b=g.getMinutes()/60;g=g.getHours();document.getElementById("daynighticon").style.backgroundPosition="0 -"+36*g+"px";var e=[c[4*g],c[4*g+1],c[4*g+2],c[4*g+3]];g=(g+1)%24*4;e[0]+=(-e[0]+c[g])*b;e[1]+=(-e[1]+c[g+1])*b;e[2]+=(-e[2]+c[g+2])*b;e[3]+=(-e[3]+c[g+3])*b;return e},rb=0,Da=0,Xc=0,Yc=0,nd=function(b,c){var g=tzar.width,e=tzar.height,f=w.mx/32;b/=32;c/=32;var h=ba*g*.03125,m=ba*e*.03125,k=.03125*g,l=.03125*e,q=b+.5*(k-h),p=c+.5*(l-m);0>q?b=.5*-(k-h):q+h-f*ba>E&&(b=E-h-.5*(k-h)+f*
ba);0>p?c=.5*-(l-m):p+m>va&&(c=va-m-.5*(l-m));h-w.mx>E&&(ba=E/(.03125*g),P(ba));m>va&&(ba=va/(.03125*e),P(ba));rb=32*-b;Da=32*-c},Kc=document.getElementById("minimap"),Wf=function(b){var c=b.pageX-parseInt(Kc.style.left);b=b.pageY-parseInt(Kc.style.top);var g=tzar.height*Ob/(32*va);c=~~(.5+(c-tzar.width*Tb/(32*E)*.5)*E/Tb);b=~~(.5+(b-.5*g)*va/Ob);nd(32*c,32*b);0==md&&document.removeEventListener("mousemove",Wf)};Kc.addEventListener("mousedown",function(b){var c=b.pageX-4,g=b.pageY-31;0==b.button?
(document.addEventListener("mouseup",function h(c){document.removeEventListener("mouseup",h);document.removeEventListener("mousemove",Wf)}),md=!0,Wf(b),document.addEventListener("mousemove",Wf)):2==b.button&&(c=~~(E*(b.pageX-4)/Tb),g=~~(va*(b.pageY-31)/Ob),ea(Bb,c+g*E,G))});var Db={control:0,shift:0,esc:0},xa=function(g,c){g&&!r.editor&&(g=T.active,c=zl[c],g&&g.cut&&(c=b[g.cut[c]]))&&(g=Gb.technology,Eb=0,g.disabled[c.id]||g.hidden[c.id]||(Wa.lastFunc=c,c(),Wa.lastFunc=void 0))},Ue=function(b,c){var g=
document.getElementById("notifybar"),e=document.createElement("div");e.innerHTML=b;c&&(e.style.background=c);g.appendChild(e);setTimeout(Al,11E3,e)},Al=function(b){b.parentNode.removeChild(b)},hb={37:function(b){Xc=b},40:function(b){Yc=-b},39:function(b){Xc=-b},38:function(b){Yc=b},32:function(b){yj=b?nl:function(){}},46:function(b){b||ea(ue,Db.shift,G.slice(0))},16:function(b){Db.shift=b},17:function(b){Db.control=b},27:function(b){Db.esc=b},13:function(b){b&&!r.editor&&("displaynone"==xh.className?
(xh.className="displayblock",yh.focus(),hb.blocked=13):(zh(),xh.className="displaynone",hb.blocked=null))},19:function(b){b||r.online||$b(1)},48:function(b){b&&Db.control&&(ba=1,ng({deltaY:0}))},176:function(b){b&&(r.deltaTime+=3E4)},65:xa,66:xa,67:xa,68:xa,69:xa,70:xa,71:xa,72:xa,73:xa,74:xa,75:xa,76:xa,77:xa,78:xa,79:xa,80:xa,81:xa,82:xa,83:xa,84:xa,85:xa,86:xa,87:xa,88:xa,89:xa,90:xa,219:function(b){b&&Gj(-1)},221:function(b){b&&Gj(1)}},zl={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",
73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z"};hb.blocked=null;(function(){for(var b=[65,37,40,83,39,68,38,87],c=b.length=0,d=b.length;c<d;c+=2)hb[b[c]]=hb[b[c+1]]})();window.addEventListener("beforeunload",function(b){return null});document.oncontextmenu=function(){return!1};var Jb=document.getElementById("attackmenu"),Zc=document.getElementById("defencemenu"),$c=document.getElementById("levelmenu"),Bd=document.getElementById("kingdom"),
ua=document.getElementById("progressone"),Xf=document.getElementById("unitname"),Gc=document.getElementById("progressvalue");document.getElementById("selectedobject");var ue=function(b,c){if(c.length){b=b||r.editor?c.length:1;for(var g=0;g<b;g++)A[c[g]].die()}},Pa=function(g,c){g.sound&&!c&&(c=g.sound,pa(c[~~(c.length*Math.random())]));$c.style.display="none";ve.style.display="none";Bd.style.display="block";ua.style.display="block";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display=
"none";Zc.style.display="none";Xf.innerHTML=g.name;we(g);Bd.innerHTML=F[g.kingdom].name;g.attack?(Jb.style.display="block",Jb.innerHTML=g.attack):Jb.style.display="none";c=g.health;var d=g.maxHealth;Infinity==c?(ua.value=100,ua.max=100,Gc.innerHTML=c):ua.value=c;Infinity==d&&Infinity!=c?(ua.max=100,ua.value=1):Infinity!==d&&(ua.max=d);g.inventory&&g.inventory.length&&(manamenu1.style.display="block",manamenu1.style.backgroundPosition="0px -80px",manamenu1.innerHTML=g.inventory.length);Gc.innerHTML=
~~c+"/"+d;if(!sc(g,w))return la([]);g.point&&(c=g.point,ib.x32=c[0],ib.y32=c[1],Ra(ib,96*(va-1)),ib.show=1);if(!1===g.built)la([b.stopBuilding]),we(g);else if(g.techStart)la([b.stopTech]),we(g),manamenu.style.display="block",manamenu.style.backgroundPosition="0px -200px",manamenu.innerHTML=100-~~(100*(g.c-r.cycle)/g.techStart)+"%",Pa.intv&&clearInterval(Pa.intv),Pa.intv=setInterval(function(){G[0]==g.id?manamenu.innerHTML=100-~~(100*(g.c-r.cycle)/g.techStart)+"%":clearInterval(Pa.intv)},400);else{Fk();
if(g.working){d=g.work;var e=T.page*T.length;c=0;for(var f=T.length;c<f;c++){var h=d[c+e];ya[c].innerHTML=h?h:""}manamenu.style.display="block";manamenu.style.backgroundPosition="0px -200px";var m=1E3*B[g.waitlist[0]].time;c=~~(100*(r.now()-g.timestamp)/m);100<c&&(c=100);manamenu.innerHTML=c+"%";Pa.intv&&clearInterval(Pa.intv);Pa.intv=setInterval(function(){if(G[0]==g.id&&g.working){var c=~~(100*(r.now()-g.timestamp)/m);100<c&&(c=100);manamenu.innerHTML=c+"%"}else clearInterval(Pa.intv)},400)}else for(c=
0,d=T.length;c<d;ya[c++].innerHTML="");la(g.icons,g)}};Pa.intv=!1;var xe=function(){Jb.style.display="none";Zc.style.display="none";$c.style.display="none";ua.style.display="none";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";Xf.innerHTML="";Jb.innerHTML="";Zc.innerHTML="";manamenu.innerHTML="";$c.innerHTML="";Bd.innerHTML="";Gc.innerHTML="";ua.value="";Gc.maxLength="";ve.style.display="none";me.innerHTML="";ne.innerHTML="";oe.innerHTML="";pe.innerHTML=
"";qe.innerHTML="";re.innerHTML="";se.innerHTML="";te.innerHTML="";la([b.origin]);Hj()},Q,gb,Kb,ng,tc={},bh=function(b,c,d,e){var g=d||A[G[0]],h=e?F[g.kingdom]:Gb;if("peon"==(d?g.clss:Kb))var m=!0;if(r.editor)return[sb,k];var k=b+c*E;if(!e&&Q!=sb)return[Q,k];b=M[k];c=0;if(!g)return[c,k];if(2<b||(b=ad[k])&&2<b){var l=A[b];l.invisible||(m&&l.storage&&g.stock?c=mh:m&&void 0!=l.res?c=fe:m&&l.health<l.maxHealth&&!h.diplomacy[l.kingdom]&&l.build&&!l.dummy||l.dummy&&!l.built?c=xd:h.diplomacy[l.kingdom]||
l.dummy&&h.values.experience||l.confused?c=oc:1===l.invType&&!g.build&&!g.boat&&0<l.invMax&&sc(g,l)&&(c=ce))}else b=Ja[k],2<b&&!g.build&&!g.boat&&(l=A[b],l.item?c=vd:l.field&&m?c=pf:1===l.invType&&!g.build&&!g.boat&&0<l.invMax&&sc(g,l)&&(c=ce));0===c&&(g=Hb[g.kingdom],g[k]&&m?(b=g[k],c=xd):(l||(b=-k),c=Bb,Bb.cursor=2));return[c,b]},G=[];G.change=1;var Ij,ql=document.getElementById("gold"),rl=document.getElementById("wood"),sl=document.getElementById("food"),tl=document.getElementById("stone"),J,Ah;
var Bh=!1;var Fb=function(b,c){var g=ba,e=tzar.width,f=tzar.height;b=b*g-rb+.5*(e-g*e);c=c*g-Da+.5*(f-g*f);return[b,c]},vb=function(b){if(b){var c=b.pageX;b=b.pageY;vb.lastX=c;vb.lastY=b}else c=vb.lastX,b=vb.lastY;c=Fb(c-w.mx,b);b=c[1];c=c[0];0==Bh?(window.removeEventListener("mousemove",vb),Ah=!1):Ah=!0;if(1===J[2]||vb.forced)b=32*~~(b/32),c=32*~~(c/32);J[4]=b;J[6]=c;J[9]=c;J[10]=b},Jj=function(b,c){c=A[c];M[b[0]+b[1]*E]==c.id?(c.point=void 0,G[0]==c.id&&(ib.x32=2*E,Ra(ib,128*E),ib.show=0)):(c.point=
b,ib.x32=b[0],ib.y32=b[1],G[0]==c.id&&(Ra(ib,96*(va-1)),ib.show=1))};document.onkeydown=function(b){P(b.keyCode,b);return b.ctrlKey&&b.shiftKey?!1:{116:1,115:1,123:1}[b.keyCode]?!1:!0};var Kj=function(b){if(null==hb.blocked||hb.blocked==b.keyCode){var c=hb[b.keyCode];c&&c(1,b.keyCode)}},Lj=function(b){if(null==hb.blocked||hb.blocked==b.keyCode){var c=hb[b.keyCode];c&&c(0,b.keyCode)}},Mj=function(b){var c=window.innerWidth,g=window.innerHeight,e=b.pageX,f=b.pageY;if(screen.height-10<=g){if(1.2==Math.abs(Xc)||
0==Xc)Xc=1.2*((10>e)-(e>c-10));if(1.2==Math.abs(Yc)||0==Yc)Yc=1.2*((10>f)-(f>g-10))}e=Fb(e-w.mx,f);f=~~(.03125*e[1]);e=~~(.03125*e[0]);b.pageX<w.mx?Ec(2):(b=bh(e,f)[0],0==b||void 0==b.cursor?Ec(2):Ec(b.cursor))},Nj=function(b){if(!Ld)if(b.pageX>w.menumx){if(0==b.button){window.addEventListener("mousemove",vb);b=Fb(b.pageX-w.mx,b.pageY);var c=b[1];b=b[0];void 0!=X.wall&&(b=X.wall,c=32*~~(b/E),b=b%E*32,vb.forced=!0,X.wall=void 0);Bh=!0;J[0]=b;J[1]=c;J[9]=J[0];J[10]=J[1];J[3]=J[0];J[7]=J[1];Yf=!1}}else Yf=
!0},Yf=!1,Bl=function(b){if(b.pageX>w.menumx&&b.pageY>w.menumy&&!md&&0==Yf){Bh=!1;var c=Fb(b.pageX-w.mx,b.pageY),g=~~(c[1]/32);c=~~(c[0]/32);P(c,g);var e=va;if(2==b.button&&!r.editor){if(Q!=sb){Q=sb;return}if(0<G.length)if(e=A[G[0]],1!=e.build||e.arrow){if(0===Q){Q=sb;return}e=bh(c,g);b=e[1];e=e[0];e==Bb&&(c={x32:c,y32:g,d:0,mv:1,img:l.cursor},Xa(c),Rb.new(c,db(c.img)));ea(e,b,G)}else ea(Jj,[c,g],G[0]);return!1}if(0==b.button){if(Q==sb)return sb();b=c+g*e;if(Q.spLevel)b=Q.spLevel(b);else{var f=0;
2<ad[b]?f=ad[b]:2<M[b]?f=M[b]:2<Ja[b]&&(f=Ja[b]);b=f}if(b)Q.allowPos&&A[b].build&&(b=-(c+g*e));else if(Q.allowPos||Q.noObj)b=-(c+g*e);else return Q=sb;Q.noObj&&3<=b&&(b=-(c+g*e));Q.item?(ea(Q,b,[G[0],Q.item]),Q.item=void 0):ea(Q,b,G);Db.shift||(Q=sb)}}Yf=!1},Oj=function(b){Ld||(Bl(b),Cd.actived&&Cd(),J[0]=NaN,J[1]=NaN,J[9]=NaN,J[10]=NaN,J[3]=NaN,J[7]=NaN,k.bindBuffer(k.ARRAY_BUFFER,wc),k.bufferSubData(k.ARRAY_BUFFER,0,J),Lb.actived&&Lb(),md&&(md=!1))},Dh=function(b){b=A[b];b.tempChild.quit(b.selectAnim);
Sb(b.selectAnim);Ch(b.selectAnim);b.selectAnim=void 0},sb=function(){for(var b=0,c=G.length;b<c;Dh(G[b++]));le.actived&&(t(le.actived).style.display="none");gb&&(Dh(gb.id),gb=void 0);G.length=0;Kb=-1;tc={};ve.style.display="none";me.innerHTML="";ne.innerHTML="";oe.innerHTML="";pe.innerHTML="";qe.innerHTML="";re.innerHTML="";se.innerHTML="";te.innerHTML="";Jb.className="";T.page=0;ib.show&&(ib.x32=2*E,Ra(ib,128*E),ib.show=0);var d=E,e=J[0],f=J[1];b=J[9];var h=J[10];if(10>=Math.abs(f-h)&&10>=Math.abs(e-
b)){h=~~(e/32);var m=~~(f/32),k=f,l=e,q=0;for(b=0;3>b;b++){c=eb[b];var p=h,u=m;e=l;f=k;2<c[p+u*d]?(e=p,f=u,q=A[c[e+f*d]]):(.5<=f/32-u?u++:u--,2<c[p+u*d]?(e=p,f=u,q=A[c[e+f*d]]):(.5<=e/32-p?p++:p--,2<c[p+u*d]?(e=p,f=u,q=A[c[e+f*d]]):(u=~~(f/32),2<c[p+u*d]&&(e=p,f=u,q=A[c[e+f*d]]))))}q.id||(q=Hb[w.kingdom][h+m*d])&&(q=A[q]);if(q&&2<q.id&&(!q.invisible||sc(q,w)))if(tc[q.id]=1,G.length=0,q.setupChild(Zb.select,1,Ve),sc(q,w)&&!r.demo){G[0]=q.id;Kb=null!=q.defence?q.clss:-2;if(256>Date.now()-Ij){if(r.editor){Cl(A[G[0]]);
return}if(!q.build)for(d=~~(ba*tzar.width*.03125),e=~~(ba*tzar.height*.03125),h=~~(.03125*-rb+.5*(~~(.03125*tzar.width)-d)),k=~~(.03125*-Da+.5*(~~(.03125*tzar.height)-e)),e*=d,h+=k*E,b=0;b<e;b++)for(f=h+b%d+~~(b/d)*E,m=0;3>m;m++)k=eb[m][f],2<k&&(l=A[k],l.clss!=q.clss||tc[k]||!sc(l,q)||l.item||(l.setupChild(Zb.select,1,Ve),tc[k]=1,G.put(k)))}Ij=Date.now();if(q.build)return Pa(q)}else return gb=q,Wc(q.id),!1}else if(!r.demo)for(e=~~(e/32),b=~~(b/32),f=~~(f/32),h=~~(h/32),e>=b&&(q=e,e=b,b=q),f>=h&&(q=
f,f=h,h=q),b++,q=[1,1,1],l=b-e,b=0,c=l*(h-f+1);b<c;b++)for(h=b%l+e,k=~~(b/l)+f,m=0;3>m;m++)if(p=eb[m][h+k*d],u=A[p])u.selected=1,q[p]||(q[p]=1,u.build||!sc(u,w)||u.item||(G[G.length]=p,u.setupChild(Zb.select,1,Ve),tc[p]=1));1<G.length?Eh(G):1==G.length?Wc(G[0]):(la([]),xe(),Kb=-1,G.length=0)},Pj=[manamenu,manamenu1],Qj={mana:{background:"0px -120px",progress:progressmana},food:{background:"0px -240px"},milk:{background:"0px -280px"},gold:{background:"0px -260px"},stone:{background:"0px -320px"},wood:{background:"0px -340px"}},
yl=["https://i.imgur.com/toj2Nv3.gif","https://i.imgur.com/TwImKWn.gif","https://i.imgur.com/wFIu276.gif","https://i.imgur.com/kIWwIhG.gif","https://i.imgur.com/JBGA2KM.gif"],ve=document.getElementById("unitSpeed"),Wc=function(b,c,d){manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";b=A[b];b.sound&&!d&&(d=b.sound,pa(d[~~(d.length*Math.random())]));Kb=b.clss;b.inventory&&b.inventory.length&&sc(b,w)&&(manamenu1.style.display="block",manamenu1.style.backgroundPosition=
"0px -80px",manamenu1.innerHTML=b.inventory.length);c||(sc(b,w)&&!r.demo?la(b.icons,b):Fh());Bd.style.display="block";Xf.innerHTML=b.name;b.attack&&b.item||void 0!==b.attack?(Jb.innerHTML=b.attack,Jb.style.display="block"):Jb.style.display="none";b.defence&&b.item||void 0!==b.defence?(Zc.innerHTML=b.defence,Zc.style.display="block"):Zc.style.display="none";b.mana&&!b.manaTarget&&(manamenu.style.display="block",manamenu.innerHTML=b.mana,manamenu.style.backgroundPosition="0px -120px");c=0;var g=b.update;
if(g){c=0;for(var f=g.length;c<f;c+=3){var h=g[c],m=Qj[h];d=Pj[c/3];d.innerHTML=b[h];d.style.display="block";d.style.backgroundPosition=m.background;"mana"==h&&b.manaTarget&&(d.innerHTML=~~(100*b.mana/b.manaTarget+.5)+"%",d.style.backgroundPosition="0px -200px");m.progress&&(m.progress.style.display="block",m.progress.value=b[h],m.progress.max=b[h+"Max"])}}b.stock&&(g=b.stock,d=Pj[c/3],d.style.display="block",d.style.backgroundPosition=Qj[g[4].icon].background,d.innerHTML=g[0]);c=b.level?b.level:
0;$c.innerHTML=c;$c.style.display="block";0===c&&(b.item||b.build)&&($c.style.display="none");Bd.innerHTML=F[b.kingdom].name;ua.style.display="block";Rj(b);we(b)},Rj=function(b){var c=b.health;b=b.maxHealth;Infinity==c?(ua.value=100,ua.max=100,Gc.innerHTML=c):(ua.value=c,Infinity==b?(ua.max=100,ua.value=1):ua.max=b,Gc.innerHTML=~~c+"/"+b)},Eh=function(b,c){var d=A[b[0]],g=0,f=0,h=d.clss,m=b.length,k={},l=[];l.cut={};for(var q=0;q<m;q++){d=A[b[q]];g+=d.maxHealth;f+=d.health;Kb=h!=d.clss?-1:!0;for(var p=
d.icons,u=p.length,y=0;y<u;y++){var r=p[y].id;void 0===k[r]?k[r]=1:k[r]++;if(k[r]===m){if(p.cut){r=p.cut;var t=p[y].objName;r[t]&&(l.cut[t]=r[t],l.cut[r[t]]=t)}l.put(p[y])}}}!0===Kb&&(Kb=d.clss);f=Infinity==f?100:~~(f/g*100);Gc.innerHTML=f+"/100(%)";Sj();Xf.innerHTML="";Jb.style.display="none";Zc.style.display="none";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";$c.style.display="none";Bd.innerHTML=m+" "+x.units;ua.style.display="block";ua.value=f;
ua.max=100;c||(!0!==Kb?la(l):la(d.icons))},gi=function(){};new Float32Array(8);var ub,kd,wc,Md,Jd,ba=1,Tj={1:2560,101001:2048,101E3:2048,1001:2048,1E3:2048,100:1536,10010100:1280,10100:1280,1001E4:1280,1E4:1280,10010010:256,10010110:256,10110:256,10111:256,10010111:256,110:512,111:512,11:512,10:512,111E5:2816,11E5:2816,11E6:2816,1E6:2816,1101E4:768,11110100:768,11010100:768,1111E4:768,1E7:3360,1E5:3072,1101E3:1792,1101001:1792,11101E3:1792,11101001:1792,101111:0,1011:0,1111:0,101011:0},Dl=function(b){Sb(b);
Ib.put(b.bufferID)},Rb={table:{},dates:[],new:function(b,c,d){c=Math.floor(c)+r.now();var g=this.table;d||(d=Dl);g[c]||(g[c]=[]);b.animFunc=d;g[c].put(b);this.dates.add(c);this.needOrder=!0}},db=function(b){b=Ca[b];return 0>b[1]?l.delay[b[0]-b[1]-1]:b[0]/b[1]*1E3},Mb=new Float32Array(12),ah=function(b){var c=b.id+r.arje+b.x32+b.y32;b.rnd=[4294967295+c,4294967295-c,0]},Gh=function(b){b=A[b];b.mlist&&Uj(b,!0);b.hlist&&Uj(b,!1)},Uj=function(b,c){if(c)var d=b.mlist,g=b.mlistID,f=Dd.mercenaries;else d=
b.hlist,g=b.hlistID,f=Dd.heroes;d.unshift(f[Vi(b,f.length)]);c?g.unshift(b.mercID++):g.unshift(b.heroID++);8<d.length&&(d.length=8,g.length=8);T.active==d&&la(d);Xb(b,5E4)},Hh=function(g){g=A[g];var c=F[g.kingdom],d=16+4*c.crusade.number;c.crusade.number++;32<d&&(d=32);var e=c.crusade.list;e.length=d;for(var f=0;f<d;f++)(e[f]=Rc(8,g,1)).deleteFromList=e;pa("crusade",g.x32,g.y32);c.technology.disabled[b.createCrusaders.id]=1;aa(g.id)},ol=function(g){F[g.kingdom].technology.disabled[b.createCrusaders.id]=
0},ld,M=[],Ja=[],ad=[],hc={},eb=[];eb.length=3;var Fh=function(){for(var b=T.displayed.length=0,c=T.length;b<c;b++){var d=ya[b];d.className="blocked";d.style.backgroundPosition="48px 96px";Vf[b]=Mc}T.rightButton.className="blocked";T.leftButton.className="blocked";T.stock.className="blocked";T.rightBlocked=1};T.leftButton.onclick=function(){T.page&&(T.page--,la(T.active,0,T.stockActive))};T.rightButton.onclick=function(){T.rightBlocked||(T.page++,la(T.active,0,T.stockActive))};T.displayed=[];var la=
function(b,c,d){d=!!d;c||(c=NaN);var g=b.olegal||NaN;if(c.working&&!d)var f=1;T.active=b;T.displayed.length=0;var h=Gb.technology,m=T.page,k=T.length;Fh();!1!==d&&c?T.stockActive=c:!1===d&&(T.stockActive=!1);la.actv={};b.length<=m*k&&b.length&&(T.page--,m--);for(var l=0,q=0,p;l<k;l++){p=b[l+m*k];if(!p)break;var u=ya[q];if(!d&&(la.actv[p.id]=1,h.hidden[p.id]||p.obj.tech&&f)){k++;continue}u.style.backgroundPosition=48*d+"px "+(-d||1)*p.iconID*48+"px";d||!h.disabled[p.id]||g[p.id]?(u.className="",Vf[q]=
p):u.className="blocked";T.displayed[q]=p;q++}b[l+m*k]&&(T.rightButton.className="",T.rightBlocked=0);0<m&&(T.leftButton.className="");1===G.length&&(c=A[G[0]]);c.inventory&&0<c.inventory.length&&(T.stock.className="")};la.actv={};var fi,oa,ia,og;var k=t("tzar").getContext("webgl2",{antialias:!0,alpha:!1});w.gl=!!k;if(k){var El=k.getExtension("WEBGL_lose_context");k.canvas.addEventListener("webglcontextlost",function(b){setTimeout(function(){El.restoreContext()},2E3);b.preventDefault()},!1);k.canvas.addEventListener("webglcontextrestored",
function(b){P("restored 2")},!1)}var ei,pg,qg,ii,Qe,kg,jg,Pe,Re,Kd,Id,jd,lg,mg,Oa=function(){if(r.canceled)return 0;requestAnimationFrame(Oa);var b=Oa.fp1000,c=Oa.delta,d=Oa.now;performance.now();var e=d;Oa.frameCount++;d=r.now();Oa.now=d;c=(c+(d-e))/1E3;Oa.delta=c;Yg+=c;Xg++;Oa.fp1000=b+c;b=Rb.table;e=Rb.dates;Rb.needOrder&&(e.sort(function(c,b){return c-b}),Rb.needOrder=0);for(var f=0;e[f]<=d+17;f++){for(var h=b[e[f]],m=0,l=h.length;m<l;m++){var v=h[m];v.animFunc(v)}delete b[e[f]];f--;e.shift()}if(0!=
Xc||0!=Yc)rb+=Xc*c*640*ba,Da+=Yc*c*640*ba,nd(-rb,-Da),vb();yj(d);gi();k.uniform1f(ei,d);k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT);if(b=na.length)k.bindFramebuffer(k.FRAMEBUFFER,fb),k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,ii),c=na,c.changed&&(c.typed=new Uint32Array(c),c.changed=!1,k.bufferData(k.ELEMENT_ARRAY_BUFFER,c.typed,k.STATIC_DRAW)),k.enable(k.BLEND),k.blendEquation(k.MAX),k.blendFunc(k.SRC_COLOR,k.SRC_COLOR),k.bindTexture(k.TEXTURE_2D,og),k.drawElements(k.TRIANGLES,b,k.UNSIGNED_INT,0),k.bindTexture(k.TEXTURE_2D,
Lighttexture),k.disable(k.BLEND),k.bindFramebuffer(k.FRAMEBUFFER,null);Vj(pg);e=window.innerWidth;f=window.innerHeight;k.viewport(w.marx,f-Ob-w.mary,Tb,Ob);k.uniform2f(Qe,32*E,32*va);k.uniform2fv(Kd,[0,0]);k.uniform1i(Re,1);k.uniform1f(ld,1);Vj(pg);k.viewport(w.mx,0,e,f);performance.now();k.useProgram(ia);k.bindVertexArray(lg);k.uniform1f(kg,~~((.01*d+.5)%5));k.drawArrays(k.TRIANGLES,0,6);k.viewport(w.marx,f-Ob-w.mary,Tb,Ob);k.uniform1i(Pe,1);k.uniform2fv(Id,[0,0]);k.uniform1f(jd,Tb/32/E);k.drawArrays(k.TRIANGLES,
0,6);k.uniform1i(Pe,0);k.uniform2f(jg,e,f);k.uniform2fv(Id,[rb,Da]);k.uniform1f(jd,1/ba);k.viewport(w.mx,0,e,f);k.useProgram(oa);k.bindVertexArray(mg);if(b=sa.length)k.enable(k.BLEND),k.blendEquation(k.FUNC_ADD),k.blendFunc(k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA),k.bindBuffer(k.ARRAY_BUFFER,wc),e=tzar.width,f=tzar.height,d=-rb+.5*(e-ba*e),c=-Da+.5*(f-ba*f),h=ba*(e-w.mx),m=ba*f,k.bufferSubData(k.ARRAY_BUFFER,0,new Float32Array([d,c,24576,d+h,c,24576,d,c+m,24576,d+h,c+m,24576])),k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,
qg),c=sa,c.changed&&(c.typed=new Uint32Array(c),c.changed=!1,k.bufferData(k.ELEMENT_ARRAY_BUFFER,c.typed,k.STATIC_DRAW)),k.viewport(w.marx,f-Ob-w.mary,Tb,Ob),k.drawElements(k.TRIANGLES,12,k.UNSIGNED_INT,0),k.uniform1i(Re,0),k.uniform2f(Qe,e,f),k.uniform2fv(Kd,[rb,Da]),k.uniform1f(ld,1/ba),k.viewport(w.mx,0,e,f),k.bindBuffer(k.ARRAY_BUFFER,wc),Ah&&!Ih?k.bufferSubData(k.ARRAY_BUFFER,0,J):k.bufferSubData(k.ARRAY_BUFFER,0,new Float32Array([NaN,NaN,24576,NaN,4347,24576,5551,NaN,24576,NaN,NaN,24576])),
k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,qg),c=sa,c.changed&&(c.typed=new Uint32Array(c),c.changed=!1,k.bufferData(k.ELEMENT_ARRAY_BUFFER,c.typed,k.STATIC_DRAW)),k.drawElements(k.TRIANGLES,b,k.UNSIGNED_INT,0),k.disable(k.BLEND);X.active&&(d=X.x,c=X.y,b=96*E,X.wh?(e=X.wh[0]-Ca[X.img][8],f=X.wh[1]-Ca[X.img][9]):f=e=0,Jh(d,c,b,e,f,X.bufferID),X.active=!1);Jc.update&&Jc(1)},Vj=function(b){var c=ha.length;c&&(k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,b),b=ha,b.changed&&(b.typed=new Uint32Array(b),b.changed=!1,k.bufferData(k.ELEMENT_ARRAY_BUFFER,
b.typed,k.STATIC_DRAW)),k.drawElements(k.TRIANGLES,c,k.UNSIGNED_INT,0))},hd=!1;"use strict";var ka=function(b,c){return b<E&&0<=b&&0<=c&&c<va?!0:!1};Array.prototype.put=function(b){this[this.length]=b};var Zb,ye,xb,Kh,bd=function(b,c,d,e){e&&0==bd.cols[e]&&(bd.list.push(e,b),bd.cols[e]=1)};bd.cols={};bd.list=[];var L=function(b){for(var c=Object.keys(b),d=0;d<c.length;d++)b[b[c[d]]]=c[d];return b};window.onerror=bd;var r={},Ca=[],Fl=function(b,c,d,e){for(var g=0,h=Object.keys(b),m=0,k=h.length;m<
k;m++){var l=h[m],q=b[l];if(Array.isArray(q)){b[l]=g;q.url=g;l=Ca[g++]=q;var p=q.deltaY?q.deltaY:0;l.id=e/4;for(var u=6,r=l.length;u<r;u+=6){var t=l[u-2],w=l[u-1],x=l[u+2],z=l[u+3];c[e++]=l[u]/d;c[e++]=(p+l[u+1])/d;c[e++]=t;c[e++]=w;c[e++]=(l[u]+x)/d;c[e++]=(l[u+1]+p)/d;c[e++]=t+x;c[e++]=w;c[e++]=l[u]/d;c[e++]=(l[u+1]+z+p)/d;c[e++]=t;c[e++]=w+z;c[e++]=(l[u]+x)/d;c[e++]=(l[u+1]+z+p)/d;c[e++]=t+x;c[e++]=w+z}}else for(var A=Object.keys(q),B=0,C=A.length;B<C;B++)for(l=q[A[B]],l.id=e/4,l.url=g,q[A[B]]=
g,Ca[g++]=l,p=l.deltaY?l.deltaY:0,u=6,r=l.length;u<r;u+=6)t=l[u-2],w=l[u-1],x=l[u+2],z=l[u+3],c[e++]=l[u]/d,c[e++]=(p+l[u+1])/d,c[e++]=t,c[e++]=w,c[e++]=(l[u]+x)/d,c[e++]=(l[u+1]+p)/d,c[e++]=t+x,c[e++]=w,c[e++]=l[u]/d,c[e++]=(l[u+1]+z+p)/d,c[e++]=t,c[e++]=w+z,c[e++]=(l[u]+x)/d,c[e++]=(l[u+1]+z+p)/d,c[e++]=t+x,c[e++]=w+z}return e},N=function(b,c,d,e){var g=0,h=d.length-1,m=d[h];e=Hb[e];var k=[],l=0,q=!0;ka(b,c)&&ka(b+m-1,c+h/m-1)||(q=!1);for(var p=E,u=0;u<h;u++){g==m&&(g=0,c++);if(d[u]){var r=b+g+
p*c;e[r]&&(q=!1);if(0<M[r]||ec[r])q=!1;k[l++]=r}g++}return[k,q]};N.check=function(b,c,d,e,f,h,m){var g=d.length-1;d=d[g];var k=g/d;g=E;m=Hb[m];d+=2;--b;--c;k=d*(k+2);for(var l=0;l<k;l++){var p=b+l%d,u=c+~~(l/d),r=p+u*g;if(0<M[r]||ec[r]||h&&(p>=f&&p<=f+2||u>=e&&u<=e+2)||!ka(p,u)||m[r])return!1}return!0};var Wj=function(b,c,d){var g=0,f=d.length-1,h=d[f],m=[],k=[],l=0,q=!0;ka(b,c)&&ka(b+h-1,c+f/h-1)||(q=!1);for(var p=0,u=0;u<f;u++){g==h&&(g=0,c++);var r=b+g+E*c;d[u]?(2<M[r]&&(q=!1),m[l++]=r):(k[p++]=
r,2<M[r]&&(q=!1));g++}return[m,q,k]},Xj=function(b,c,d){var g=0,f=d.length-1,h=d[f],m=[],k=0,l=!0;ka(b,c)&&ka(b+h-1,c+f/h-1)||(l=!1);for(var q=0;q<f;q++){g==h&&(g=0,c++);var p=b+g+c*E;if(d[q]&&2<M[p]&&1==A[M[p]].build||0<Ja[p])l=!1;m[k++]=p;g++}return[m,l]},Zf=function(b,c,d){var g=!1,f=0,h=[],m=0,k=d.length-1,l=d[k],q=0,p=!0;ka(b,c)&&ka(b+l-1,c+k/l-1)||(p=!1);for(var u=0;u<k;u++){q==l&&(q=0,c++);if(d[u]){var r=b+q+E*c,t=M[r];2<t&&(p=!1);0<t?f++:g=!0;h[m++]=r}q++}f>.5*(k-1)&&g||(p=!1);return[h,p]},
ze=function(b,c,d){d=!0;ka(b,c)||(d=!1);1!==Ja[b+c*E]&&(d=!1);return[[b+c*E],d]},U=function(b,c,d){d=!0;ka(b,c)||(d=!1);0<M[b+c*E]&&(d=!1);return[[b+c*E],d]},$f=function(b,c,d){d=!0;ka(b,c)||(d=!1);0<ad[b+c*E]&&(d=!1);return[[b+c*E],d]},bc=function(b,c,d){d=!0;ka(b,c)||(d=!1);if(0<Ja[b+c*E]||2==M[b+c*E]||1==M[b+c*E])d=!1;return[[b+c*E],d]},Gl=function(b){for(var c=Object.keys(b),d=S.common.length/1048576,g=0,f=c.length;g<f;g++)b[c[g]].deltaY=512*d},X,C,pb,mb,Jk=function(){X={img:0,x32:-1E3,y32:-1E3,
rgb:[0,0,0,.5],d:0,active:!1};var g=8,c=9;if(!hd){Hl();var d=[b.move,b.attack,b.guard,b.patrol,b.pickUp,b.explore,b.stop,b.stand,b.sameSpeed,b.restoreSpeed];ye={magic_creatures:[58,40,59,5,78,77,60,130,131,132,89,129]};for(var e=Object.keys(ye),f=0,h=e.length;f<h;f++){var m=ye[e[f]],k={};m.obj=k;for(var v=0,q=m.length;v<q;k[m[v++]]=1);}Dd.mercenaries=[b.mercArcher,b.mercFootman,b.mercMaceman,b.mercLongbowman,b.mercPikeman,b.mercKnight,b.mercArcherAsian,b.mercSamurai,b.mercHourseSamurai,b.mercRonin,
b.mercHorseArcher,b.mercChariot,b.mercFootmanArab,b.mercArcherArab,b.mercMacemanArab,b.mercPikemanArab,b.mercCavalry,b.mercEnichar,b.mercJihad];Dd.heroes=[b.mercArcher6,b.mercFootman6,b.mercMaceman6,b.mercLongbowman6,b.mercPikeman6,b.mercKnight6,b.mercArcherAsian6,b.mercSamurai6,b.mercHourseSamurai6,b.mercRonin6,b.mercHorseArcher6,b.mercChariot6,b.mercFootmanArab6,b.mercArcherArab6,b.mercMacemanArab6,b.mercPikemanArab6,b.mercCavalry6,b.mercEnichar6,b.mercJihad6];e=Dd.mercenaries;f=0;for(h=e.length;f<
h;e[f++].merc=9);e=Dd.heroes;f=0;for(h=e.length;f<h;e[f++].hero=1);q=l;q.build2x2[2]=1;q.build3x3[2]=1;q.build4x4[2]=1;q.build5x5[2]=1;q.build6x6[2]=1;q.items1[2]=1;q.build_harbor[2]=1;q.bridge_horz_build[2]=1;q.bridge_vert_build[2]=1;q.sexplosion[0]=13;q.sexplosion[1]=25;q.flame_trail[0]=16;q.flame_trail[1]=25;f=0;for(m=q.flame_trail.length;f<m;f+=6)q.flame_trail[4+f]-=32,q.flame_trail[5+f]-=32;f=0;for(m=q.sexplosion.length;f<m;f+=6)q.sexplosion[4+f]-=48,q.sexplosion[5+f]-=48;q.items1[1]=0;q.books[1]=
0;q.potions[1]=0;q.troll.attack[1]=14;q.ork.attack[1]=14;q.dwarf.attack[1]=14;q.asian_mage.move[1]=14;q.arab_priest.attack=q.arab_priest.spell;q.asian_mage.spell=q.asian_mage.castspell;q.asian_mage.attack=q.asian_mage.castspell;q.asian_mage.spell[1]=13;q.arab_horse_archer.move=q.arab_horse.archer;q.arab_jwarrior.attack[1]=14;q.arab_peasant.attack=q.arab_peasant.attack1;q.arab_peasant.tree=q.arab_peasant.wood;q.asian_peasant.attack=q.asian_peasant.attack1;q.asian_peasant.cut=q.asian_peasant.chop;q.asian_peasant.tree=
q.asian_peasant.wood;q.asian_peasant.dig[1]=14;q.asian_archer.die[1]=14;q.asian_ronin.attack=q.asian_ronin.attack1;f=0;for(m=q.turn_to_stone.length;f<m;f+=6)q.turn_to_stone[4+f]-=56,q.turn_to_stone[5+f]-=64;q.arab_tcguild_c[4]=31;q.arab_tcguild_c[5]=85;q.dragon.idle=q.dragon.move;q.asian_samurai.attack=q.asian_samurai.attack1;q.asian_horsamurai.idle=q.asian_horsamurai.idle1;q.asian_horsarcher.idle=q.asian_horsarcher.idle2;q.asian_priest.attack=q.asian_priest.attack1;q.asian_priest.spell=q.asian_priest.pray;
q.asian_monk.attack[1]=12;q.euro_mage.attack=q.euro_mage.spell;q.euro_ghost.idle=q.euro_ghost.move;q.euro_priest.attack=q.euro_priest.spell;q.arab_mage.spell=q.arab_mage.attack;q.cursor[1]=15;q.star[1]=15;q.select[4]+=3;q.select[5]+=3;q.arab_houses_c[g]=96;q.asia_houses_c[g]=96;q.asia_houses_c[4]-=9;q.asia_houses_c[5]-=15;q.wood_build[2]=1;q.res_gold[2]=1;q.res_gold_s[2]=1;q.res_stone[2]=1;q.res_stone_s[2]=1;q.bridge_horz1[4]=-9;q.bridge_horz1[5]=132;q.bridge_horz1[4]=-9;q.bridge_horz1[5]=132;q.euro_stable_c[4]+=
18;q.euro_stable_c[5]-=10;q.euro_lumbermill_s[4]-=19;q.euro_lumbermill_s[5]-=17;q.wood_tower_c[4]=0;q.wood_tower_c[5]*=1;q.bat.idle=q.bat.move;f=0;for(m=q.curse.length;f<m;f+=6)q.curse[5+f]-=48;f=0;for(m=q.impersonate.length;f<m;f+=6)q.impersonate[5+f]-=48;f=0;for(m=q.bless.length;f<m;f+=6)q.bless[5+f]-=48;f=0;for(m=q.euro_barracks_c.length;f<m;f+=6)q.euro_barracks_c[4+f]+=50;f=0;for(m=q.healing.length;f<m;f+=6)q.healing[5+f]-=48;f=0;for(m=q.expl_small_hole.length;f<m;f+=6)q.expl_small_hole[4+f]-=
4,q.expl_small_hole[5+f]-=34;Date.now();e=[b.createKnight,b.createHorseArcher1,b.createHorseArcher2,b.createHorseSamurai,b.createChariot,b.createEnichar,b.createCavalry]}if(ug){ug=!1;P("TErrain changed");f=0;for(h=S.xtra.length;f<h;f++){q=S.xtraRes[f].coords;Gl(q);q.terrain_water[g]=512;q.terrain_water[c]=512;q.terrain_water[6]+=32;q.terrain_water[7]+=32;v=0;for(m=q.terrain_tree.length;v<m;v+=6)q.terrain_tree[4+v]-=32,q.terrain_tree[5+v]-=96;v=0;for(m=q.terrain_tree_s.length;v<m;v+=6)q.terrain_tree_s[5+
v]-=32;q.terrain_tree[2]=1;Object.assign(l,q)}g=S.size;h=new Float32Array(1048576);q=Fl(l,h,g,0);S.info=h;S.ids=q/16}if(!hd){xb={sword:{name:"Sword",iconID:16,img:l.items1,d:0,dMax:7,attack:1,type:52,sword:1},bow:{name:"Bow",iconID:4,img:l.items1,d:15,dMax:4,attack:1,type:52,sword:1},shield:{name:"Shield",iconID:1,img:l.items1,d:8,dMax:6,defence:1,type:52,shield:1},potion:{name:"Potion",iconID:11,img:l.potions,d:0,dMax:7,type:52,potion:1},book:{name:"Book",iconID:9,img:l.books,d:0,dMax:4,type:52,
book:1},gold:{name:"Gold",iconID:20,img:l.item_gold,d:0,dMax:0,type:52},stone:{name:"Stone",iconID:22,img:l.item_stone,d:0,dMax:0,type:52},food:{name:"Food",iconID:14,img:l.item_food,d:0,dMax:0,type:52},wood:{name:"Wood",iconID:15,img:l.item_tree,d:0,dMax:0,type:52},iron:{name:"Iron",iconID:21,img:l.item_iron,d:0,dMax:0,type:52}};Kh=[xb.sword,xb.potion,xb.book,xb.bow,xb.shield];h=[b.move,b.attack,b.stop,b.stand,b.pickUp,b.explore,b.healing,b.bless];g=[b.attack,b.guard,b.patrol,b.explore,b.stop,b.stand,
b.attackGround,b.steady,b.move];c=[b.buildAcademy,b.buildWorkshop,b.buildWorkshop1,b.buildAcademy1,b.buildWorkshop2,b.buildAcademy2];f=[b.buildMerchands1,b.buildMerchands2,b.buildMerchands];mb={euro:{},asia:{},arab:{},common:{}};B=[{name:"Footman",attack:6,defence:3,health:65,maxHealth:65,img:l.euro_footman.idle,attackSound:zc,invType:0,invMax:8,validator:U,human:12,iconID:36,time:12,sight:5,url:l.euro_footman,icons:d,cost:[0,0,50,0],attDist:1,spd:50,dieSound:Va,clss:"footman",size:1,standardFunc:R,
radix:0,zLevel:1,strID:"e_footman",race:"euro"},{name:"Pikeman",radix:0,attackSound:zc,attack:8,defence:4,health:75,maxHealth:75,img:l.euro_pikeman.idle,invType:0,dieSound:Va,invMax:8,validator:U,human:1,iconID:39,time:18,sight:5,url:l.euro_pikeman,icons:d,cost:[40,0,60,0],attDist:1,spd:50,standardFunc:R,clss:"e_pikeman",zLevel:1,size:1,strID:"e_pikeman",nu:b.createPikeman,race:"euro"},{name:"Spy",radix:0,attack:20,defence:0,mana:100,manaMax:100,health:50,maxHealth:50,img:l.euro_spy.idle,attackSound:["spy%20kill%201",
"spy%20kill%202","spy%20kill%203"],invType:0,invMax:8,validator:U,human:1,dieSound:Va,iconID:41,time:30,sight:12,url:l.euro_spy,icons:[b.move,b.attack,b.guard,b.patrol,b.pickUp,b.explore,b.stop,b.stand,b.impersonate,b.revealSelf],zLevel:1,cost:[120,0,0,0],attDist:1,spd:50,clss:"spy",standardFunc:R,size:1,update:["mana","manaSpeed",1E3],isSpy:1,strID:"spy",nu:b.createSpy,race:"common"},{name:"Maceman",radix:0,attack:8,defence:0,health:120,maxHealth:120,img:l.euro_maceman.idle,attackSound:zc,invType:0,
invMax:8,validator:U,human:1,iconID:37,time:14,dieSound:Va,sight:5,zLevel:1,url:l.euro_maceman,icons:d,cost:[0,0,120,0],attDist:1,spd:50,clss:"maceman",standardFunc:R,size:1,strID:"e_maceman",nu:b.createMaceman,race:"euro"},{radix:0,name:"Archer",attack:5,defence:0,health:50,maxHealth:50,img:l.euro_archer1.idle,invType:0,invMax:8,validator:U,human:1,sight:10,dieSound:Va,arrow:!0,iconID:38,zLevel:1,time:12,url:l.euro_archer1,icons:d,cost:[0,20,40,0],attDist:7,spd:50,clss:"archer",standardFunc:R,attimg:l.arrow1,
attackSound:qd,size:1,strID:"e_archer",nu:b.createArcher,race:"euro"},{radix:0,name:"Wizard",attackSound:Ei,dieSound:["mage"],attack:5,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:l.euro_mage.idle,zLevel:1,invType:0,invMax:8,validator:U,human:1,iconID:42,time:30,sight:15,url:l.euro_mage,icons:[b.stop,b.pickUp,b.explore,b.lightning,b.createBat,b.freeze,b.createGolem,b.invisibility,b.stand,b.attack,b.move],cost:[150,0,0,0],attDist:10,attimg:l.flame_bolt,ball:1,spd:50,clss:"mage",standardFunc:R,
size:1,update:["mana","manaSpeed",1E3],strID:"e_mage",nu:b.createMage,race:"euro"},{radix:0,name:"Longbowman",attack:6,defence:2,health:50,maxHealth:50,img:l.euro_longbowman.idle,zLevel:1,invType:0,invMax:8,dieSound:Va,attackSound:qd,arrow:!0,validator:U,race:"euro",human:1,iconID:35,time:18,sight:18,url:l.euro_longbowman,icons:d,cost:[50,0,90,0],attDist:12,spd:50,standardFunc:R,clss:"longbowman",size:1,d2attack:2,strID:"e_longbowman",attimg:l.arrow1,nu:b.createLongbowman},{radix:0,clss:"tree",name:"Tree",
health:100,maxHealth:100,img:l.terrain_tree,invType:0,invMax:8,zLevel:1,mMapcolor:[11,131,11],validator:U,child:[{img:l.terrain_tree_s,rgb:[0,0,0,.5],alpha:1,x:0,y:0}],iconID:23,url:l.terrain_tree,dimgInfinity:l.terrain_tree,dimgRND:3,icons:[],res:1,race:"common",build:!0,size:1,zolotoy:1,strID:"tree"},{radix:0,name:"Crusader",zLevel:1,dieSound:Rd,attackSound:Pd,attack:14,defence:8,health:180,maxHealth:180,img:l.crus.idle,invType:0,invMax:8,validator:U,human:1,race:"euro",iconID:100,time:19,sight:5,
url:l.crus,icons:d,cost:[0,0,0,0],attDist:1,spd:85,standardFunc:R,clss:"crusader",size:1,strID:"crusader"},{radix:0,name:"Priest",attack:20,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:l.euro_priest.idle,invType:0,zLevel:1,invMax:8,validator:U,human:1,iconID:40,time:30,ball:1,sight:21,dieSound:Va,url:l.euro_priest,icons:h,attackOnly:ye.magic_creatures.obj,cost:[150,0,0,0],attDist:18,race:"euro",spd:50,standardFunc:R,clss:"priest",size:1,update:["mana","manaSpeed",1E3],strID:"e_priest",
nu:b.createPriest,attimg:l.flame_bolt},{radix:0,name:"Peasant",attackSound:Hg,attack:5,defence:0,health:50,maxHealth:50,img:l.euro_peasant.idle,invType:0,invMax:8,dieSound:Va,zLevel:1,validator:U,human:1,race:"euro",iconID:33,time:8,sight:5,url:l.euro_peasant,icons:[b.move,b.menuBuilds,b.repair,b.conquest,b.dcm,b.pickUp,b.explore,b.stop,b.stand,b.attack,b.bribe,b.sameSpeed,b.restoreSpeed],cost:[0,0,50,0],attDist:1,spd:50,clss:"peon",size:1,peon:1,strID:"e_peon",nu:b.createPeon,nocapture:1},{radix:0,
clss:"cathedral",name:"Cathedral",dieSound:K,sound:["e_cathedral1","e_cathedral2"],resistance:700,health:5E3,maxHealth:5E3,img:l.euro_cathedral,invType:0,invMax:8,race:"euro",zLevel:1,validator:N,bimg:l.build5x5,dimg:l.des_5x5,iconID:60,icons:[b.createCrusaders,b.techFanaticism,b.techEspionage,b.techInquisition,b.techHealing,b.techBless,b.techCrusade,b.techMedicine],time:90,sight:8,child:[{img:l.euro_cathedral_c,x:0,y:0},{img:l.euro_cathedral_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],space:new Uint8Array([1,
1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,5]),url:l.euro_cathedral,build:!0,cost:[2E3,0,0,2E3],onbuild:[b.buildChurch],size:1,strID:"cathedral"},{radix:0,name:"Castle",clss:"castle",dieSound:K,sound:["e_castle1"],resistance:700,health:8E3,maxHealth:8E3,img:l.euro_castle,invType:1,invMax:50,race:"euro",zLevel:1,validator:N,bimg:l.build6x6,dimg:l.des_6x6,iconID:59,time:120,sight:12,child:[{img:l.euro_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:l.euro_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[b.createPeon,
b.createSpy,b.emergeAllUnits,b.techFeudalism,b.techArchitecture,b.techLearning],space:new Uint8Array([0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,0,1,1,7]),menu:Pa,url:l.euro_castle,build:!0,cost:[0,1500,0,1500],storage:-1,castle:!0,population:20,size:1,strID:"e_castle"},{radix:0,name:"Wooden Wall",clss:"wall_wood",resistance:700,health:2E3,maxHealth:2E3,img:l.wood_tower,time:6,sight:1,zLevel:1,dieSound:K,validator:U,bimg:l.wood_build,dimgInfinity:l.wood_debris,
iconID:49,icons:[],mx:0,race:"common",my:0,hframe:71,menu:Pa,url:l.wood_tower,wall:1,build:!0,cost:[0,0,20,0],size:1,strID:"woodwall",child:[{img:l.wood_tower_c,x:0,y:0}]},{radix:0,name:"Barracks",clss:"barracks",strID:"e_barrack",sound:Ig,generator:1,resistance:500,health:1400,maxHealth:1400,img:l.euro_barrack,invType:1,invMax:0,dieSound:K,time:60,sight:6,zLevel:1,race:"euro",validator:N,bimg:l.build5x5,dimg:l.des_5x5,child:[{img:l.euro_barracks_c,mv:!0},{img:l.euro_barrack_s,x:0,y:0,rgb:[0,0,0,
.5],alpha:!0}],iconID:57,icons:[b.createFootman,b.createArcher,b.createMaceman,b.createPikeman,b.createLongbowman,b.createKnight],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:l.euro_barrack,build:!0,cost:[0,200,0,200],size:1},{radix:0,strID:"e_lumber",name:"Lumber Mill",sound:["e_lumber1"],clss:"lumber_mill",resistance:500,health:800,maxHealth:800,img:l.euro_lumbermill,invType:1,invMax:0,time:30,race:"euro",sight:4,dieSound:K,zLevel:1,validator:N,bimg:l.build2x2,
dimg:l.des_2x2,iconID:64,child:[{img:l.euro_lumbermill_c,x:0,y:0},{alpha:!0,img:l.euro_lumbermill_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[b.techLongbow,b.techWoodCutting,b.techCrossbow],space:new Uint8Array([1,1,1,1,2]),hframe:98,url:l.euro_lumbermill,build:!0,cost:[0,100,0,0],storage:1,size:1},{radix:0,name:"Mage Tower",strID:"e_magetower",sound:["e_magetower1","e_magetower2","e_magetower3"],clss:"magictower",resistance:700,health:5E3,maxHealth:5E3,img:l.euro_magetower,invType:1,invMax:0,time:90,race:"euro",
dieSound:K,sight:8,validator:N,bimg:l.build5x5,dimg:l.des_5x5,zLevel:1,child:[{img:l.euro_magetower_c,x:0,y:0},{img:l.euro_magetower_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:71,icons:[b.createMage,b.techBat,b.techInvisibility,b.techLightning,b.techFreeze,b.techGolem],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:l.euro_magetower,build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,strID:"e_waracademy",name:"Warriors Guild",sound:["e_waracademy1"],clss:"academy",resistance:700,health:5E3,
maxHealth:5E3,img:l.euro_waracademy,invType:1,invMax:0,race:"euro",time:90,sight:8,dieSound:K,zLevel:1,validator:N,bimg:l.build6x6,dimg:l.des_6x6,iconID:56,child:[{img:l.euro_waracademy_c,x:0,y:0,mv:!0},{img:l.euro_waracademy_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],icons:[b.techHeroism,b.techWarfare,b.techMercenaries,b.techSiegeTactics,b.techBodyBuilding,b.techLeadership,b.techTactics,b.techHeroes,b.techHonor,b.techFame],space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,0,5]),url:l.euro_waracademy,
build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,name:"Storage",strID:"e_storage",sound:["e_storage1","e_storage2"],clss:"storage",resistance:80,health:800,maxHealth:800,img:l.euro_storage,invType:1,invMax:0,time:30,dieSound:K,zLevel:1,sight:5,validator:N,bimg:l.build4x4,dimg:l.des_4x4,iconID:69,race:"euro",icons:[b.techGoldMining,b.techStoneMining],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,4]),url:l.euro_storage,storage:0,build:!0,cost:[0,200,0,0],size:1,child:[{img:l.euro_storage_c,x:0,
y:0},{img:l.euro_storage_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Knight",strID:"e_knight",dieSound:Rd,clss:"knight",attackSound:Pd,attack:12,defence:6,health:120,maxHealth:120,img:l.euro_knight.idle,invType:0,zLevel:1,race:"euro",invMax:8,validator:U,human:1,iconID:43,d2attack:2,time:22,sight:5,url:l.euro_knight,icons:d,cost:[120,0,70,0],attDist:1,spd:85,nu:b.createKnight,standardFunc:R,size:1},{radix:0,name:"Field",clss:"field",strID:"field",instantBuild:1,resistance:80,health:100,maxHealth:100,
img:l.fields,invMax:0,validator:Xj,zLevel:1,iconID:104,race:"common",icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:l.fields,build:!0,field:1,res:2,cost:[0,200,0,0],rndDirection:9,time:0,sight:1,z32:.5,size:1},{radix:0,name:"Golden rocks",mMapcolor:[148,148,0],strID:"gold",sound:["mine1"],clss:"golden_rocks",resistance:0,health:6E3,maxHealth:6E3,img:l.res_gold,invMax:0,validator:N,iconID:20,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:l.res_gold,build:!0,zLevel:1,
race:"common",res:0,cost:[0,0,0,0],time:0,sight:2,dieSound:["destroy%20mine"],size:1,zolotoy:1,child:[{img:l.res_gold_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:l.res_gold},{radix:0,name:"Rocks",strID:"stone",mMapcolor:[132,132,132],sound:["mine1"],clss:"rocks",dieSound:["destroy%20mine"],resistance:0,health:6E3,maxHealth:6E3,img:l.res_stone,invMax:0,validator:N,zLevel:1,iconID:22,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:l.res_stone,build:!0,res:3,cost:[0,0,0,0],
race:"common",time:0,sight:2,size:1,zolotoy:1,child:[{img:l.res_stone_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:l.res_stone},{radix:0,name:"Farm",strID:"e_farm",sound:["e_farm1","e_farm2"],clss:"farm",resistance:0,health:800,maxHealth:800,img:l.euro_farm,invType:1,invMax:0,zLevel:1,validator:N,bimg:l.build4x4,dimg:l.des_4x4,iconID:61,dieSound:K,race:"euro",icons:[b.createCow,b.techCropRotation,b.techDomestication],space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),menu:Pa,url:l.euro_farm,
build:!0,cost:[0,200,0,0],time:30,sight:5,storage:2,size:1,child:[{img:l.euro_farm_c,x:0,y:0}]},{radix:0,name:"Merchants Guild",strID:"e_merchant",sound:["merchant"],clss:"merchants_guild",resistance:0,health:5E3,maxHealth:5E3,img:l.euro_tcguild,invType:1,invMax:0,validator:N,bimg:l.build6x6,zLevel:1,dimg:l.des_6x6,race:"euro",iconID:62,dieSound:K,icons:[b.techMapMaking,b.techTradeRoutes,b.techUsury,b.techSupplyStorage,b.techBribery,b.techTradeTaxes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,0,1,1,1,0,5]),menu:Pa,url:l.euro_tcguild,build:!0,time:90,sight:8,cost:[2E3,0,0,2E3],onbuild:[b.buildMarket],size:1,child:[{img:l.euro_tcguild_c,x:0,y:0},{img:l.euro_tcguild_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Church",clss:"church",strID:"e_church",sound:["e_church1"],resistance:0,health:800,maxHealth:800,img:l.euro_church,invType:1,invMax:0,dieSound:K,validator:N,bimg:l.build3x3,race:"euro",zLevel:1,dimg:l.des_3x3,iconID:139,icons:[b.createPriest],space:new Uint8Array([1,
1,1,1,1,1,1,1,1,3]),menu:Pa,url:l.euro_church,build:!0,cost:[0,0,200,200],time:40,sight:6,size:1,child:[{img:l.euro_church_c,x:0,y:0},{img:l.euro_church_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Blacksmith",clss:"blacksmith",strID:"e_blacksmith",resistance:0,health:800,maxHealth:800,img:l.euro_blacksmith,invType:1,invMax:0,time:40,zLevel:1,sight:5,dieSound:K,validator:N,bimg:l.build4x4,race:"euro",dimg:l.des_4x4,child:[{img:l.euro_blacksmith_c,x:0,y:0}],iconID:58,icons:[b.techPlateArmor,
b.techTemperIron,b.techScaleArmor,b.techHalberd,b.techChainMail],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),menu:Pa,url:l.euro_blacksmith,build:!0,cost:[0,0,200,200],onbuild:c,size:1},{radix:0,name:"Cow",clss:"cow",nu:b.createCow,race:"common",strID:"cow",attack:0,defence:3,health:50,maxHealth:50,img:l.cow.idle,invType:0,invMax:8,zLevel:1,validator:U,iconID:99,time:20,dieSound:["cowdie1","cowdie2","cowdie3","cowdie4"],url:l.cow,icons:[b.move,b.stop],sight:3,cost:[0,0,300,0],attDist:0,
spd:32,res:2,food:300,milk:50,milkMax:50,foodMax:600,size:1,cow:1,update:["milk","milkSpeed",1E3,"food","cowSpeed",1E3]},{radix:0,name:"Stable",sound:["e_stables1"],clss:"stable",strID:"e_stable",onlyRequired:1,resistance:0,health:800,maxHealth:800,invType:1,invMax:0,race:"euro",zLevel:1,validator:N,bimg:l.build4x4,dimg:l.des_4x4,iconID:68,dieSound:K,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,4]),url:l.euro_stables,build:!0,cost:[0,200,0,0],onbuild:e,size:1,time:40,sight:5,img:l.euro_stables,
nu:b.createCow,child:[{img:l.euro_stable_c,x:0,y:0}]},{radix:0,name:"Workshop",sound:["e_workshop1"],clss:"workshop",strID:"e_workshop",zLevel:1,resistance:0,health:800,maxHealth:800,img:l.euro_workshop,invType:1,invMax:0,dieSound:K,validator:N,bimg:l.build4x4,race:"euro",dimg:l.des_4x4,iconID:75,icons:[b.createCatapult,b.createHeavyCatapult,b.createBallist,b.techEngineering,b.techCannonTower],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,4]),url:l.euro_workshop,build:!0,cost:[0,200,200,0],
size:1,time:40,sight:5,child:[{img:l.euro_workshop_c,x:0,y:0}]},{radix:0,name:"Tavern",sound:["e_tavern1"],clss:"tavern",strID:"e_tavern",dieSound:K,resistance:0,health:1E3,maxHealth:1E3,img:l.euro_tavern,invType:1,invMax:0,validator:N,race:"euro",bimg:l.build4x4,dimg:l.des_4x4,zLevel:1,iconID:70,icons:[b.createMercenaries,b.createHeroes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,4]),url:l.euro_tavern,build:1,cost:[0,200,200,0],onbuild:f,actvintv:[b.iniMercenaries,b.iniHeroes],size:1,
time:40,sight:5,child:[{img:l.euro_tavern_c,x:0,y:0}]},{name:"House",sound:["house1","house2","house3","house4","house5"],clss:"house",strID:"e_house",resistance:0,health:75,maxHealth:75,img:l.euro_houses,invType:1,invMax:0,validator:N,bimg:l.build3x3,dimg:l.des_3x3,race:"euro",iconID:73,zLevel:1,dieSound:K,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:l.euro_houses,build:!0,cost:[0,75,0,0],population:10,size:1,time:20,sight:4,child:[{img:l.euro_houses_c,x:0,y:0}]},{name:"Watch Tower",
attackSound:We,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),clss:"watch_tower",strID:"watch_tower",attack:7,health:400,maxHealth:400,img:l.euro_tower_wood_2,state:0,invType:1,race:"common",invMax:0,zLevel:1,dieSound:K,level:0,validator:N,child:[{img:l.euro_tower_wood_2_c,x:0,y:0},{alpha:!0,img:l.euro_tower_wood_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attimg:l.arrow1,attDist:8,bimg:l.build2x2,dimg:l.des_2x2,iconID:53,icons:[b.attack,b.stop,b.upgradeGuildTower],space:new Uint8Array([1,1,1,1,2]),url:l.euro_tower_wood_2,
build:!0,cost:[0,300,0,0],size:1,arrow:!0,time:10,sight:15,standardFunc:R},{name:"Market",sound:["e_market1"],clss:"market",strID:"e_market",resistance:0,health:1400,maxHealth:1400,img:l.euro_market,invType:1,invMax:0,dieSound:K,zLevel:1,validator:N,bimg:l.build4x4,dimg:l.des_4x4,iconID:65,race:"euro",icons:[b.createCaravan],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,4]),url:l.euro_market,build:!0,cost:[0,200,200,0],size:1,time:60,sight:8,child:[{img:l.euro_market_c,x:0,y:0}]},{name:"Outpost",
sound:["e_outpost1"],clss:"outpost",strID:"e_outpost",zLevel:1,resistance:0,health:2E3,maxHealth:2E3,img:l.euro_outpost,invType:1,dieSound:K,invMax:50,validator:N,race:"euro",bimg:l.build4x4,dimg:l.des_4x4,iconID:66,icons:[b.emergeAllUnits],space:new Uint8Array([0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,4]),url:l.euro_outpost,build:!0,cost:[0,200,0,400],size:1,child:[{img:l.euro_outpost_c,x:0,y:0},{img:l.euro_outpost_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:60,sight:8},{name:"Bridge",clss:"bridge",strID:"bridge",
resistance:0,health:1E4,maxHealth:1E4,img:l.bridge_horz,invMax:0,validator:Wj,bimg:l.bridge_horz_build,race:"common",zLevel:1,dieSound:K,child:[{alpha:!0,img:l.bridge_horz_s,x:0,y:0,rgb:[0,0,0,.5]},{img:l.bridge_horz1,x:0,y:0,z:6}],time:22,sight:1,dimg:l.bridge_horz_demol,iconID:44,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,11]),url:l.bridge_horz,build:!0,cost:[0,
200,0,400],size:1},{name:"Dummy",clss:"dummy",strID:"dummy",resistance:0,health:5E3,maxHealth:5E3,img:l.dummy1,invMax:0,validator:U,bimg:l.dummy1_b,iconID:165,icons:[],mx:0,zLevel:1,my:16,hframe:65,race:"common",url:l.dummy1,dimg:l.dummy1_d,build:!0,cost:[0,300,0,0],dummy:!0,child:[{img:l.dummy1_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:10,sight:1},{name:"Catapult",strID:"catapult",dieSound:Ye,clss:"catapult",attackSound:Xe,defence:0,attack:10,health:110,maxHealth:110,img:l.catapult.idle,invMax:0,
radix:0,validator:U,iconID:30,time:30,sight:20,race:"common",url:l.catapult,level:0,zLevel:1,icons:g,cost:[0,600,0,0],nofreeze:1,arrow:!1,attDist:17,spd:40,standardFunc:R,size:1,attimg:l.cat_stone,space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:b.createCatapult},{name:"Ballista",radix:0,strID:"ballista",attackSound:Xe,dieSound:Ye,clss:"ballista",defence:0,attack:60,health:75,maxHealth:75,img:l.ballista.idle,invMax:0,validator:U,iconID:31,time:30,sight:16,nofreeze:1,race:"common",zLevel:1,url:l.ballista,
icons:g,cost:[0,800,0,0],attDist:13,spd:40,standardFunc:R,size:1,attimg:l.arrow_ballista1,space:new Uint8Array([1,1,1,1,2]),attackDeg:30,nu:b.createBallist},{name:"Heavy Catapult",strID:"heavy_catapult",attackSound:Xe,defence:0,attack:25,health:250,maxHealth:250,img:l.h_catapult.idle,invMax:0,radix:0,validator:U,iconID:45,time:60,dieSound:Ye,sight:26,race:"common",url:l.h_catapult,zLevel:1,icons:g,standardFunc:R,cost:[0,1200,0,0],attDist:22,spd:40,nofreeze:1,clss:"heavy_catapult",size:1,attimg:l.cb_metal,
space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:b.createHeavyCatapult},{radix:0,name:"Ghost",strID:"ghost",defence:0,attack:8,health:60,maxHealth:60,img:l.euro_ghost.idle,invType:0,invMax:8,dieSound:["ghost1","ghost2"],validator:U,iconID:178,zLevel:1,race:"common",time:15,attackSound:Di,sight:5,standardFunc:R,url:l.euro_ghost,icons:d,w:1,cost:[40,0,0,0],attDist:1,spd:80,clss:"ghost",size:1,nu:b.createGhost},{name:"Harbor",strID:"e_harbor",resistance:80,health:800,maxHealth:800,img:l.euro_harbor,
invType:1,invMax:0,validator:Zf,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:l.build_harbor,dimg:l.des_harbor,zLevel:1,race:"euro",dieSound:K,iconID:63,icons:[b.createFishingBoat,b.createXebec,b.createHulk,b.createGalleon,b.techLandingTactics],clss:"harbor",url:l.euro_harbor,storage:4,build:!0,cost:[0,200,200,0],child:[{img:l.euro_harbor_c,x:0,y:0},{img:l.euro_harbor_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:60,sight:8},{radix:0,name:"Messiah",strID:"messiah",attack:50,defence:10,mana:1E3,
manaMax:1E3,health:1E3,maxHealth:1E3,img:l.messiah.idle,invType:0,invMax:0,race:"common",validator:U,human:1,iconID:169,zLevel:1,attackSound:["messiah_attack"],dieSound:["messiah"],time:300,sight:26,url:l.messiah,standardFunc:R,icons:d,cost:[2E3,0,0,0],attDist:10,spd:50,clss:"messiah",size:1,update:["mana","manaSpeed",1E3]},{name:"Magic Gateway",sound:["gateway"],strID:"gateway",magicGateway:1,resistance:0,health:Infinity,maxHealth:Infinity,img:l.teleport,invMax:0,validator:N,bimg:l.build4x4,zLevel:1,
dieSound:K,race:"common",iconID:180,clss:"magic_gateway",icons:[b.createOrk,b.createDwarf,b.createGhost,b.createSkeleton],space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,5]),url:l.teleport,build:!0,cost:[0,0,0,0],size:1,time:10,sight:10,zolotoy:1,child:[{img:l.teleport_c,x:0,y:0},{alpha:!0,img:l.teleport_s,x:0,y:0,rgb:[0,0,0,.5]}],standardFunc:Zk},{name:"Guard Tower",strID:"guard_tower",race:"common",clss:"guard_tower",attackSound:We,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),
attack:12,health:1E3,maxHealth:1E3,img:l.euro_tower_wood,state:0,invType:1,invMax:0,dieSound:K,zLevel:1,validator:N,child:[{img:l.euro_tower_wood_c,x:0,y:0},{alpha:!0,img:l.euro_tower_wood_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:12,bimg:l.build2x2,dimg:l.des_2x2,iconID:52,icons:[b.attack,b.stop,b.upgradeStoneTower,b.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:l.euro_tower_wood,build:!0,cost:[0,600,0,0],size:1,arrow:!0,attimg:l.arrow1,time:35,sight:16,standardFunc:R},{name:"Sword",attack:0,
defence:0,health:25,maxHealth:25,img:l.items1,state:0,invMax:0,validator:bc,iconID:16,url:l.items1,icons:[],cost:[0,0,0,0],size:1,zLevel:0,z32:.5,radix:0,race:"common",item:1},{name:"Bow",attack:0,defence:0,health:25,maxHealth:25,img:l.items1,state:0,invMax:0,validator:bc,iconID:4,url:l.items1,icons:[],cost:[0,0,0,0],size:1,z32:.5,zLevel:0,radix:0,race:"common",item:1},{name:"Shield",attack:0,defence:0,health:25,maxHealth:25,img:l.items1,state:0,invMax:0,validator:bc,iconID:1,url:l.items1,icons:[],
cost:[0,0,0,0],zLevel:0,race:"common",radix:0,size:1,z32:.5,item:1},{name:"Potion",attack:0,defence:0,health:25,maxHealth:25,img:l.potions,state:0,invMax:0,validator:bc,iconID:11,url:l.potions,icons:[],radix:0,race:"common",zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Book",attack:0,defence:0,health:25,maxHealth:25,img:l.book1,state:0,invMax:0,validator:bc,iconID:9,zLevel:0,race:"common",radix:0,url:l.books,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Gold",health:1,maxHealth:1,img:l.item_gold,
invMax:0,validator:bc,iconID:20,radix:0,race:"common",zLevel:0,url:l.item_gold,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Stone",health:1,maxHealth:1,img:l.item_stone,invMax:0,validator:bc,iconID:22,race:"common",radix:0,url:l.item_stone,zLevel:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Food",health:15,maxHealth:15,img:l.item_food,invMax:0,mMapcolor:[0,255,255],validator:bc,iconID:14,url:l.item_food,radix:0,race:"common",icons:[],zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},
{name:"Wood",health:1,maxHealth:1,img:l.item_wood,invMax:0,validator:bc,iconID:15,url:l.item_wood,icons:[],race:"common",radix:0,zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Iron",health:1,maxHealth:1,img:l.item_iron,invMax:0,validator:bc,iconID:21,zLevel:0,race:"common",url:l.item_iron,radix:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Keep Tower",strID:"keep_tower",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:16,health:2E3,maxHealth:2E3,img:l.euro_tower_stone,
state:0,invType:1,zLevel:1,attackSound:We,invMax:0,dieSound:K,validator:N,clss:"keep_tower",race:"common",child:[{alpha:!0,img:l.euro_tower_stone_s,x:0,y:0,rgb:[0,0,0,.5]},{img:l.euro_tower_stone_c,x:0,y:0}],attDist:14,bimg:l.build2x2,dimg:l.des_2x2,standardFunc:R,iconID:54,icons:[b.attack,b.stop,b.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:l.euro_tower_stone,build:!0,cost:[0,600,0,0],size:1,arrow:!0,attimg:l.arrow_big1,time:40,sight:18},{name:"Cannon Tower",clss:"tower_stone2",strID:"tower_stone2",
attackSound:Qd,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:40,health:2500,maxHealth:2500,img:l.euro_tower_stone_2,state:0,invType:1,invMax:0,dieSound:K,race:"common",validator:N,zLevel:1,child:[{img:l.euro_tower_stone_2_c,x:0,y:0},{alpha:!0,img:l.euro_tower_stone_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:10,bimg:l.build2x2,dimg:l.des_2x2,iconID:54,icons:[b.attack,b.stop],space:new Uint8Array([1,1,1,1,2]),url:l.euro_tower_stone_2,build:!0,cost:[0,600,0,0],standardFunc:R,size:1,arrow:!1,
attimg:l.hot_cannon,time:45,sight:18,attackDeg:30},{name:"Rocket Tower",strID:"tower_rocket",race:"asia",clss:"tower_rocket",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),zLevel:1,attack:30,health:1400,maxHealth:1400,img:l.rocket_tower,state:0,invType:1,invMax:0,dieSound:K,validator:N,child:[{img:l.rocket_tower_c},{alpha:!0,img:l.rocket_tower_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:20,bimg:l.build2x2,dimg:l.des_2x2,iconID:186,icons:[],space:new Uint8Array([1,1,1,1,2]),url:l.rocket_tower,build:!0,
cost:[0,600,0,0],standardFunc:R,size:1,arrow:!0,attimg:l.arrow_big1,time:60,sight:26},{radix:0,name:"Ork",race:"common",strID:"ork",dieSound:["orc%20die%201","orc%20die%202"],attackSound:Ci,attack:18,defence:2,health:75,maxHealth:75,img:l.ork.idle,invType:0,invMax:8,validator:U,zLevel:1,iconID:143,time:12,sight:5,url:l.ork,standardFunc:R,icons:d,cost:[60,0,0,0],attDist:1,spd:50,clss:"ork",size:1,nu:b.createOrk},{radix:0,name:"Dwarf",race:"common",attack:7,defence:7,health:120,maxHealth:120,img:l.dwarf.idle,
invType:0,strID:"dwarf",invMax:8,zLevel:1,dieSound:Va,validator:U,iconID:185,time:12,sight:3,url:l.dwarf,standardFunc:R,icons:d,cost:[80,0,0,0],attDist:1,spd:50,clss:"dwarf",size:1,nu:b.createDwarf},{radix:0,name:"Skeleton",strID:"skeleton",race:"common",dieSound:["skeleton%20die%201","skeleton%20die%202","skeleton%20die%203","skeleton%20die%204"],attack:4,defence:0,health:40,maxHealth:40,img:l.skeleton.idle,invType:0,zLevel:1,attackSound:zc,invMax:8,nofreeze:1,validator:U,iconID:167,time:12,sight:3,
url:l.skeleton,standardFunc:R,icons:d,cost:[0,0,30,0],attDist:1,spd:50,clss:"skeleton",size:1,nu:b.createSkeleton},{radix:0,name:"Caravan",race:"euro",strID:"e_caravan",attack:0,defence:0,health:350,maxHealth:350,img:l.caravan.idle,invType:1,invMax:8,validator:U,iconID:34,zLevel:1,time:50,sight:7,url:l.caravan,icons:[b.move,b.trade,b.explore,b.stop,b.stand,b.unload],cost:[0,200,400,0],attDist:1,spd:75,clss:"caravan",size:1,nu:b.createCaravan},{name:"Castle",health:8E3,maxHealth:8E3,img:l.asia_castle,
invType:1,strID:"a_castle",zLevel:1,race:"asia",invMax:50,validator:N,bimg:l.build6x6,dimg:l.des_6x6,iconID:164,time:120,sight:12,dieSound:K,clss:"castle",child:[{img:l.asia_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:l.asia_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[b.createPeon1,b.createNinja,b.emergeAllUnits,b.techFeudalism,b.techArchitecture,b.techLearning,b.techBuddhism,b.techGreatWall],space:new Uint8Array([0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,
1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,0,0,8]),menu:Pa,url:l.asia_castle,build:!0,cost:[0,1500,0,1500],storage:-1,castle:!0,population:20,size:1},{name:"Castle",dieSound:K,clss:"castle",strID:"r_castle",race:"arab",health:8E3,maxHealth:8E3,img:l.arab_castle,invType:1,invMax:50,validator:N,bimg:l.build6x6,dimg:l.des_6x6,zLevel:1,iconID:97,time:120,sight:12,child:[{img:l.arab_castle_c}],icons:[b.createPeon2,b.createSpy,b.emergeAllUnits,b.techFeudalism,b.techArchitecture,b.techLearning,b.techSlavery],space:new Uint8Array([0,
0,0,1,1,1,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,0,0,1,1,0,0,0,,8]),menu:Pa,url:l.arab_castle,build:!0,cost:[0,1500,0,1500],storage:-1,castle:!0,population:20,size:1},{radix:0,name:"Peasant",attack:5,defence:0,health:50,maxHealth:50,img:l.asian_peasant.idle,invType:0,invMax:8,attackSound:Hg,race:"asia",validator:U,human:1,strID:"a_peon",iconID:132,dieSound:Va,zLevel:1,time:8,peon:1,sight:5,url:l.asian_peasant,icons:[b.move,b.menuBuilds1,
b.repair,b.conquest,b.dcm,b.pickUp,b.explore,b.stop,b.stand,b.attack,b.sameSpeed,b.restoreSpeed],cost:[0,0,40,0],attDist:1,spd:50,clss:"peon",nocapture:1,size:1},{radix:0,name:"Ninja",race:"asia",attack:12,defence:5,mana:100,manaMax:100,health:90,maxHealth:90,img:l.asian_ninja.idle,invType:0,invMax:8,attackSound:zc,validator:U,human:1,iconID:133,strID:"ninja",dieSound:Va,zLevel:1,time:20,standardFunc:R,sight:10,url:l.asian_ninja,icons:[b.guard,b.patrol,b.pickUp,b.explore,b.stop,b.stand,b.invisibility,
b.murder,b.move,b.attack,b.sameSpeed,b.restoreSpeed],cost:[120,0,0,0],attDist:1,spd:85,clss:"ninja",size:1,update:["mana","manaSpeed",1E3]},{radix:0,name:"Ronin",attack:7,defence:0,health:45,maxHealth:45,img:l.asian_ronin.idle,invType:0,invMax:8,race:"asia",validator:U,human:1,standardFunc:R,iconID:141,strID:"ronin",dieSound:Va,zLevel:1,time:8,sight:5,url:l.asian_ronin,icons:d,cost:[0,0,40,0],attDist:1,spd:50,attackSound:zc,clss:"a_footman",size:1},{radix:0,name:"Archer",attack:5,defence:0,health:50,
maxHealth:50,img:l.asian_archer.idle,invType:0,invMax:8,race:"asia",validator:U,human:1,strID:"a_archer",dieSound:Va,zLevel:1,attimg:l.arrow1,iconID:136,arrow:1,attackSound:qd,time:12,sight:10,url:l.asian_archer,icons:d,cost:[0,20,40,0],standardFunc:R,spd:50,clss:"archer",size:1,attDist:6},{radix:0,name:"Samurai",attack:10,defence:4,health:90,maxHealth:90,img:l.asian_samurai.idle,invType:0,race:"asia",strID:"samurai",invMax:8,attackSound:zc,validator:U,human:1,iconID:142,time:20,standardFunc:R,zLevel:1,
dieSound:Va,sight:6,url:l.asian_samurai,icons:d,cost:[50,0,150,0],attDist:1,spd:50,clss:"a_maceman",size:1},{radix:0,name:"Horse Archer",attack:7,defence:0,health:75,maxHealth:75,img:l.asian_horsarcher.idle,invType:0,race:"asia",invMax:8,validator:U,human:1,attackSound:qd,iconID:183,strID:"a_horse_archer",dieSound:Rd,time:20,standardFunc:R,sight:12,url:l.asian_horsarcher,zLevel:1,icons:d,arrow:1,attimg:l.arrow1,cost:[40,0,120,0],spd:85,clss:"horse_archer",size:1,attDist:7},{radix:0,name:"Horse Samurai",
attack:14,defence:4,health:160,maxHealth:160,img:l.asian_horsamurai.idle,invType:0,invMax:8,validator:U,human:1,iconID:135,race:"asia",standardFunc:R,attackSound:Pd,time:22,zLevel:1,strID:"horse_samurai",dieSound:Rd,sight:5,url:l.asian_horsamurai,icons:d,cost:[75,0,120,0],attDist:1,spd:85,clss:"horse_samurai",size:1},{name:"Barracks",resistance:500,health:1400,maxHealth:1400,img:l.asia_barracks,invType:1,sound:Ig,invMax:0,time:60,dieSound:K,radix:0,sight:6,race:"asia",strID:"a_barrack",validator:N,
zLevel:1,bimg:l.build5x5,dimg:l.des_5x5,child:[{img:l.asia_barracks_c,x:0,y:0,mv:!0},{img:l.asia_barracks_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:146,icons:[b.createRonin,b.createArcher1,b.createSamurai,b.createHorseArcher1,b.createHorseSamurai,b.createChariot],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:l.asia_barracks,build:!0,cost:[0,200,0,200],size:1,clss:"barracks"},{name:"Chariot",attack:4,defence:3,health:180,maxHealth:180,img:l.asian_charriot.idle,invType:0,
radix:0,race:"asia",invMax:8,strID:"chariot",dieSound:["c%20die%201","c%20die%202","c%20die%203","c%20die%204","c%20die%205"],attackSound:Pd,validator:U,human:1,zLevel:1,iconID:175,standardFunc:R,time:8,sight:5,url:l.asian_charriot,icons:d,cost:[0,200,150,0],attDist:1,spd:85,clss:"chariot",size:1},{radix:1,name:"Galleon",attackSound:Qd,attack:35,attDist:12,race:"common",defence:0,health:1200,maxHealth:1200,strID:"galleon",nu:b.createGalleon,img:l.galleon.idle,invType:1,invMax:24,dieSound:["ship%20sink"],
zLevel:0,validator:ze,iconID:32,time:50,boat:!0,attimg:l.cb_metal,attackDeg:20,sight:16,url:l.galleon,icons:[b.move,b.explore,b.unload,b.attack,b.attackGround,b.stop,b.stand,b.stop,b.stand,b.attack,b.steady,b.upgradeShip],cost:[0,1200,800,0],spd:50,nofreeze:1,clss:"galleon",standardFunc:R,size:1,peon:1},{radix:1,name:"Fishing Boat",attackSound:Qd,attack:1,attDist:8,race:"common",defence:0,health:50,boat:!0,nu:b.createFishingBoat,maxHealth:50,img:l.boat.idle,invType:1,invMax:0,strID:"fishing_boat",
dieSound:["ship%20sink"],zLevel:0,validator:ze,iconID:184,nofreeze:1,time:50,sight:16,url:l.boat,icons:[b.move,b.explore,b.stop,b.stand,b.fishing],cost:[0,200,100,0],spd:65,clss:"fishing_boat",size:1},{radix:1,name:"Hulk",attackSound:Qd,attack:18,attDist:10,race:"common",defence:0,health:700,maxHealth:700,strID:"hulk",img:l.hulk.idle,invType:1,boat:!0,nu:b.createHulk,attackDeg:20,invMax:16,dieSound:["ship%20sink"],zLevel:0,validator:ze,iconID:128,time:30,sight:14,attimg:l.cb_metal,url:l.hulk,icons:[b.move,
b.explore,b.unload,b.attack,b.attackGround,b.stop,b.stand,b.stop,b.stand,b.attack,b.steady,b.upgradeShip],cost:[0,500,300,0],spd:65,nofreeze:1,clss:"hulk",standardFunc:R,size:1},{radix:1,name:"Pinque",attackSound:qd,attack:10,race:"common",attDist:8,defence:0,health:300,boat:!0,maxHealth:300,img:l.xebec.idle,attimg:l.arrow1,arrow:!0,strID:"pinque",invType:1,invMax:8,dieSound:["ship%20sink"],zLevel:0,validator:ze,iconID:129,time:20,nofreeze:1,sight:12,url:l.xebec,icons:[b.move,b.explore,b.unload,b.attack,
b.attackGround,b.stop,b.stand,b.stop,b.stand,b.attack,b.steady,b.upgradeShip],cost:[0,300,200,0],spd:80,clss:"xebec",size:1,standardFunc:R,nu:b.createXebec},{radix:0,name:"Stone Golem",strID:"troll",defence:3,attack:25,health:400,maxHealth:400,img:l.troll.idle,invType:0,invMax:0,dieSound:["golem"],validator:U,iconID:144,race:"common",zLevel:1,nofreeze:1,attackSound:["golem1","golem2"],sight:10,standardFunc:R,url:l.troll,icons:d,w:1,cost:[120,0,0,0,600],attDist:1,spd:56,clss:"troll",size:1},{radix:0,
name:"Bat",strID:"bat",defence:0,attack:3,health:20,maxHealth:20,img:l.bat.move,invType:0,invMax:0,race:"common",bat:1,dieSound:["bat%20die"],validator:$f,iconID:105,zLevel:2,attackSound:["bat%20attack"],sight:10,standardFunc:R,url:l.bat,icons:d,w:1,cost:[0,0,0,0,25],attDist:1,spd:128,clss:"bat",size:1,z32:1.5},{race:"arab",invType:0,invMax:8,iconID:138,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_peasant,img:l.arab_peasant.idle,spd:50,validator:U,human:1,icons:[b.move,b.menuBuilds2,
b.repair,b.conquest,b.dcm,b.pickUp,b.explore,b.stop,b.stand,b.attack,b.convertJihad,b.bribe,b.sameSpeed,b.restoreSpeed],name:"Peasant",clss:"peon",cost:[0,0,50,0],attDist:1,time:8,nocapture:1,peon:1,sight:5,health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:172,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_footman,img:l.arab_footman.idle,standardFunc:R,spd:50,validator:U,human:1,attDist:1,icons:d,name:"Footman",clss:"footman",cost:[0,0,50,0],time:12,sight:5,health:50,
attack:6,defence:1},{race:"arab",invType:0,invMax:8,iconID:170,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_archer,img:l.arab_archer.idle,spd:50,validator:U,standardFunc:R,human:1,attimg:l.arrow1,arrow:1,icons:d,name:"Archer",clss:"archer",cost:[0,20,40,0],time:12,sight:10,attDist:6,health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:173,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_spearman,img:l.arab_spearman.idle,spd:50,validator:U,standardFunc:R,
human:1,icons:d,name:"Spearman",clss:"pikeman",attDist:1,cost:[40,0,60,0],time:14,sight:5,health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:174,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,standardFunc:R,url:l.arab_satrap,img:l.arab_satrap.idle,spd:50,validator:U,human:1,icons:d,name:"Satrap",attDist:1,clss:"maceman",cost:[0,0,120,0],time:14,sight:5,health:120,attack:8,defence:0},{race:"arab",invType:0,invMax:8,iconID:171,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,
url:l.arab_cavalry,standardFunc:R,img:l.arab_cavalry.idle,spd:85,validator:U,human:1,attDist:1,icons:d,name:"Cavalry",clss:"heavy_cavalry",cost:[60,0,100,0],time:14,sight:5,health:90,attack:10,defence:4},{race:"arab",invType:0,invMax:8,iconID:168,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_horse_archer,img:l.arab_horse_archer.idle,spd:85,validator:U,human:1,standardFunc:R,icons:d,name:"Horse Archer",clss:"horse_archer",cost:[50,0,100,0],time:14,attimg:l.arrow1,arrow:1,sight:12,attDist:7,
health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:179,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_jwarrior,img:l.arab_jwarrior.idle,spd:50,validator:U,human:1,standardFunc:R,icons:d,name:"Jihad warrior",attDist:1,clss:"jihad_warrior",cost:[0,0,100,0],time:8,sight:5,health:75,attack:10,defence:2},{race:"arab",invType:0,invMax:8,iconID:176,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_priest,img:l.arab_priest.idle,standardFunc:R,spd:50,mana:100,validator:U,
human:1,icons:h,name:"Priest",clss:"priest",cost:[150,0,0,0],time:30,sight:21,attDist:18,health:60,attack:20,update:["mana","manaSpeed",1E3],manaMax:100,defence:0,attimg:l.flame_bolt,ball:1,attackOnly:ye.magic_creatures.obj},{race:"arab",invType:0,invMax:0,iconID:105,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:0,img:0,testing:1,illegal:1,spd:50,validator:U,human:1,icons:[],name:"Spy",clss:"spy",cost:150,time:30,sight:12,health:50,attack:20,defence:0},{race:"arab",invType:0,invMax:8,iconID:188,
zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,attimg:l.flame_bolt,url:l.arab_mage,img:l.arab_mage.idle,spd:50,validator:U,human:1,icons:[b.stop,b.pickUp,b.explore,b.createCarpet,b.createJinn,b.fireRain,b.magicVision,b.raiseDead,b.attack,b.stand,b.move],standardFunc:R,name:"Mage",clss:"mage",ball:1,mana:100,manaMax:100,update:["mana","manaSpeed",1E3],cost:[150,0,0,0],time:30,sight:15,attDist:10,health:60,attack:8,defence:0},{race:"arab",invType:1,invMax:8,iconID:126,zLevel:1,dieSound:[],attackSound:[],
size:1,radix:0,url:l.arab_caravan,img:l.arab_caravan.idle,spd:75,validator:U,human:1,icons:[],name:"Caravan",clss:"trader",cost:[0,0,500,0],time:30,sight:5,health:150},{race:"arab",invType:0,invMax:8,iconID:177,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_enichar,img:l.arab_enichar.idle,spd:85,validator:U,human:1,standardFunc:R,icons:d,name:"Enichar",attDist:1,clss:"enichar",cost:[80,0,120,0],time:25,sight:5,health:130,attack:18,defence:4},{race:"arab",invType:1,invMax:0,iconID:82,
zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,population:10,url:l.arab_houses,validator:N,build:1,icons:[],child:[{img:l.arab_houses_c}],name:"House",clss:"house",cost:[0,75,0,0],time:20,sight:4,resistance:50,health:500},{race:"arab",invType:1,invMax:0,iconID:85,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.arab_lumbermill,validator:N,build:1,icons:[b.techWoodCutting,b.techCrossbow],
child:[{img:l.arab_lumbermill_c}],name:"Lumber Mill",clss:"lumber",cost:[0,100,0,0],storage:1,time:30,sight:4,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:96,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_storage,validator:N,build:1,storage:0,icons:[b.techGoldMining,b.techStoneMining],child:[{img:l.arab_storage_c},{alpha:!0,img:l.arab_storage_s,rgb:[0,0,0,.5]}],name:"Storage",clss:"storage",cost:[0,
200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:80,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_farm,validator:N,build:1,icons:[b.createCow,b.techCropRotation,b.techDomestication,b.techCowPoaching,b.ridingHorses,b.techHorseManShip],child:[{img:l.arab_farm_c}],name:"Farm",storage:2,clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,
invMax:0,iconID:81,zLevel:1,dieSound:K,validator:Zf,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:l.build_harbor,dimg:l.des_harbor,radix:0,url:l.arab_harbour,build:1,icons:[b.createFishingBoat,b.createXebec,b.createHulk,b.techLandingTactics],child:[{img:l.arab_harbour_c},{alpha:!0,img:l.arab_harbour_s,rgb:[0,0,0,.5]}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,iconID:79,zLevel:1,dieSound:K,space:new Uint8Array([1,
1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.arab_blacksmith,validator:N,build:1,icons:[b.techTemperIron,b.techScaleArmor,b.techScimitar,b.techChainMail,b.techHalberd],child:[{img:l.arab_blacksmith_c},{alpha:!0,img:l.arab_blacksmith_s,rgb:[0,0,0,.5]}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,150,0],onbuild:c,time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:95,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,
dimg:l.des_4x4,radix:0,url:l.arab_workshop,validator:N,build:1,icons:[b.createCatapult,b.createBallist,b.techEngineering,b.techCannonTower],child:[{img:l.arab_workshop_c},{alpha:!0,img:l.arab_workshop_s,rgb:[0,0,0,.5]}],name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:140,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.arab_church,validator:N,build:1,icons:[b.createPriest2],
child:[{img:l.arab_church_c},{alpha:!0,img:l.arab_church_s,rgb:[0,0,0,.5]}],name:"Church",clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"arab",invType:1,invMax:0,iconID:92,zLevel:1,dieSound:K,space:new Uint8Array([0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_tavern,validator:N,build:1,icons:[b.createMercenaries,b.createHeroes],child:[{img:l.arab_tavern_c}],name:"Tavern",clss:"tavern",cost:[0,200,200,0],onbuild:f,actvintv:[b.iniMercenaries,
b.iniHeroes],time:40,sight:5,resistance:150,health:1E3},{race:"arab",invType:1,invMax:0,iconID:87,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_market,validator:N,build:1,icons:[b.createCaravan2],child:[{img:l.arab_market_c}],name:"Market",clss:"market",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,iconID:98,zLevel:1,dieSound:K,space:new Uint8Array([0,1,1,1,0,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.arab_barracks,validator:N,build:1,icons:[b.createFootman2,b.createArcher2,b.createSatrap,b.createPikeman2,b.createHorseArcher2,b.createCavalry,b.createEnichar,b.createJihad],child:[{img:l.arab_barracks_c},{alpha:!0,img:l.arab_barracks_s,rgb:[0,0,0,.5]}],name:"Barracks",clss:"barrack",cost:[0,0,200,200],time:60,sight:6,resistance:500,health:1400},{race:"arab",invType:1,invMax:0,iconID:91,zLevel:1,dieSound:K,space:new Uint8Array([1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_stables,validator:N,build:1,icons:[],child:[{img:l.arab_stables_c}],name:"Stable",clss:"stable",cost:[0,200,200,0],time:40,onbuild:e,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:50,iconID:89,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_outpost,validator:N,build:1,icons:[b.emergeAllUnits],child:[{img:l.arab_outpost_c,
mv:1},{alpha:!0,img:l.arab_outpost_s,rgb:[0,0,0,.5]}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},{race:"arab",invType:1,invMax:0,iconID:105,zLevel:1,dieSound:K,space:23213123,bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:0,img:0,validator:N,build:1,icons:[],child:[{img:3213123}],name:"NULL",testing:1,clss:"castle",cost:[0,1500,0,1500],time:120,sight:12,resistance:1E3,health:8E3},{race:"arab",invType:1,invMax:0,iconID:88,zLevel:1,dieSound:K,space:new Uint8Array([0,
0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,0,6]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.arab_mosque,validator:N,build:1,icons:[b.techFanaticism,b.techEspionage,b.techHealing,b.techBless,b.techJihad],child:[{img:l.arab_mosque_c},{alpha:!0,img:l.arab_mosque_s,rgb:[0,0,0,.5]}],name:"Mosque",onbuild:[b.buildChurch2],clss:"mosque",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:86,zLevel:1,dieSound:K,space:new Uint8Array([0,
1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_magetower,validator:N,build:1,icons:[b.createMage2,b.techCarpet,b.techMagicWorkshop,b.techFireRain,b.techMagicVision,b.techNecromancy,b.techJinn],child:[{img:l.arab_magetower_c},{alpha:!0,img:l.arab_magetower_s,rgb:[0,0,0,.5]}],name:"Mage Guild",clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:93,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.arab_tc_guild,validator:N,build:1,icons:[b.techUsury,b.techTradeRoutes,b.techSupplyStorage,b.techBribery,b.techOreFloatation],child:[{img:l.arab_tcguild_c},{alpha:!0,img:l.arab_tc_guild_s,rgb:[0,0,0,.5]}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,0,2E3],time:90,onbuild:[b.buildMarket2],sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:94,zLevel:1,dieSound:K,space:new Uint8Array([1,
1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.arab_waracademy,validator:N,build:1,icons:[b.techHeroism,b.techWarfare,b.techMercenaries,b.techRiddingHorses,b.techBodyBuilding,b.techLeadership,b.techHeroes,b.techJanissary,b.techHonor,b.techFame],child:[{img:l.arab_waracademy_c},{alpha:!0,img:l.arab_waracademy_s,rgb:[0,0,0,.5]}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,
invMax:0,iconID:158,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.arab_magicworkshop,validator:N,build:1,icons:[b.createObjects],child:[{img:l.arab_magicworkshop_c},{alpha:!0,img:l.arab_magicworkshop_s,rgb:[0,0,0,.5]}],name:"Magic Workshop",disallowPoint:!0,clss:"magicworkshop",cost:[0,0,0,300],time:20,sight:5,resistance:200,health:1200},{race:"asia",invType:1,invMax:0,iconID:161,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,
0,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.asia_houses,validator:N,build:1,icons:[],child:[{img:l.asia_houses_c}],name:"House",clss:"house",cost:[0,75,0,0],population:10,time:20,sight:4,resistance:50,health:500},{race:"asia",invType:1,invMax:0,iconID:149,zLevel:1,dieSound:K,space:new Uint8Array([0,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,storage:1,url:l.asia_lumbermill,validator:N,build:1,icons:[b.techWoodCutting,b.techCrossbow],child:[{img:l.asia_lumbermill_c},{img:l.asia_lumbermill_s,
rgb:[0,0,0,.5],alpha:!0}],name:"Lumber Mill",clss:"lumber",cost:[0,100,0,0],time:30,sight:4,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:154,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_storage,storage:0,validator:N,build:1,icons:[b.techGoldMining,b.techStoneMining],child:[{img:l.asia_storage_s,rgb:[0,0,0,.5],alpha:!0},{img:l.asia_storage_c}],name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,
sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:147,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,storage:2,url:l.asia_farm,validator:N,build:1,icons:[b.techCropRotation,b.ridingHorses,b.irrigation],child:[{img:l.asia_farm_c}],name:"Farm",clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:148,zLevel:1,dieSound:K,space:new Uint8Array([0,1,1,1,1,
1,1,1,1,3]),validator:Zf,bimg:l.build_harbor,dimg:l.des_harbor,radix:0,url:l.asia_harbor,build:1,icons:[b.createFishingBoat,b.createXebec,b.createHulk,b.techLandingTactics],child:[{img:l.asia_harbor_c},{img:l.asia_harbor_s,rgb:[0,0,0,.5],alpha:!0}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:145,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,
radix:0,url:l.asia_blacksmith,validator:N,build:1,icons:[b.techTemperIron,b.techScaleArmor,b.techArmoredChariot,b.techChainMail],child:[{img:l.asia_blacksmith_c},{img:l.asia_blacksmith_s,rgb:[0,0,0,.5],alpha:!0}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,150,0],time:40,sight:5,onbuild:c,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:157,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_workshop,validator:N,
build:1,icons:[b.createCatapult,b.createBallist,b.techEngineering,b.techCannonTower],child:[{img:l.asia_workshop_c,x:0,y:0},{img:l.asia_workshop_s,rgb:[0,0,0,.5],alpha:!0}],name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:162,zLevel:1,dieSound:K,space:new Uint8Array([0,1,1,0,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,1,0,0,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asian_monastery,validator:N,build:1,icons:[b.createMonk,
b.createPriest1],child:[{img:l.asian_monastery_c},{img:l.asian_monastery_s,rgb:[0,0,0,.5],alpha:!0}],name:"Monastery",clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"asia",invType:1,invMax:0,iconID:155,zLevel:1,dieSound:K,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_tavern,validator:N,build:1,icons:[b.createMercenaries,b.createHeroes],child:[{img:l.asia_tavern_c},{img:l.asia_tavern_s,rgb:[0,0,0,.5],alpha:!0}],
onbuild:f,name:"Tavern",clss:"tavern",actvintv:[b.iniMercenaries,b.iniHeroes],cost:[0,200,200,0],time:40,sight:5,resistance:150,health:1E3},{race:"asia",invType:1,invMax:0,iconID:150,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_market,validator:N,build:1,icons:[],child:[{img:l.asia_market_c}],name:"Market",clss:"market",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:153,
zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_stables,validator:N,build:1,icons:[],child:[{img:l.asia_stables_c,mv:!0},{img:l.asia_stables_s,rgb:[0,0,0,.5],alpha:!0}],name:"Stable",clss:"stable",onbuild:e,cost:[0,200,200,0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:151,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.asia_outpost,
validator:N,build:1,icons:[b.emergeAllUnits],child:[{img:l.asia_outpost_c,mv:1},{img:l.asia_outpost_s,rgb:[0,0,0,.5],alpha:!0}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},{race:"asia",invType:1,invMax:0,iconID:163,zLevel:1,dieSound:K,space:new Uint8Array([0,0,1,1,0,0,0,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,0,6]),bimg:l.build6x6,dimg:l.des_6x6,radix:0,url:l.asia_shao_lin,validator:N,build:1,icons:[b.techMeditation,b.techKungFu,b.techHealing,
b.techPhilosophy,b.techNinjas,b.techMastery,b.techTournaments,b.techMedicine],child:[{img:l.asia_shao_lin_c},{img:l.asia_shao_lin_s,rgb:[0,0,0,.5],alpha:!0}],name:"Shao Linn",onbuild:[b.buildChurch1],clss:"shaolinn",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:152,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asia_wizardguild,validator:N,build:1,icons:[b.createMage1,
b.techConcentration,b.techWhirlpool,b.techFlameBolt,b.techTurnToStone,b.techConfusion,b.techDragon],child:[{img:l.asia_wizardguild_c},{img:l.asia_wizardguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Mage Guild",clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:159,zLevel:1,dieSound:K,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asia_tcguild,validator:N,build:1,icons:[b.techTradeRoutes,
b.techUsury,b.techJewelry,b.techSupplyStorage,b.techBanking,b.techChemistry,b.techSeaFood,b.techGunPowder,b.techRocketArrow],child:[{img:l.asia_tcguild_c,mv:!0},{img:l.asia_tcguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,0,2E3],time:90,onbuild:[b.buildMarket1],sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:156,zLevel:1,dieSound:K,space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,
radix:0,url:l.asia_warguild,validator:N,build:1,icons:[b.techBushido,b.techHeroism,b.techWarfare,b.techMercenaries,b.techLeadership,b.techTactics,b.techHeroes,b.techHonor,b.techSunTzu],child:[{img:l.asia_warguild_c,mv:!0},{img:l.asia_warguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:0,invMax:0,iconID:166,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.asian_priest,img:l.asian_priest.idle,
spd:50,validator:U,human:1,icons:[b.attack,b.stop,b.stand,b.pickUp,b.explore,b.healing,b.teach,b.move],name:"Priest",clss:"priest",cost:[170,0,0,0],time:30,sight:21,health:120,standardFunc:R,attDist:1,attack:10,defence:10,mana:100,update:["mana","manaSpeed",1E3],manaMax:100},{race:"asia",invType:0,invMax:0,iconID:187,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.asian_monk,img:l.asian_monk.idle,spd:50,validator:U,human:1,icons:d,name:"Monk",standardFunc:R,clss:"monk",cost:[0,0,200,0],time:20,
sight:5,health:90,attack:6,defence:6,attDist:1},{race:"asia",invType:0,invMax:0,iconID:134,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.asian_mage,img:l.asian_mage.idle,spd:50,attimg:l.flame_bolt,validator:U,standardFunc:R,human:1,icons:[b.stop,b.pickUp,b.explore,b.confusion,b.turnToStone,b.whirlpool,b.flameBolt,b.createDragon,b.attack,b.stand,b.move],name:"Mage",clss:"mage",cost:[150,0,0,0],ball:1,time:30,sight:15,mana:100,attDist:10,health:60,attack:8,defence:0,update:["mana","manaSpeed",
1E3],manaMax:100},{radix:0,name:"Dragon",strID:"dragon",defence:0,attack:25,health:300,maxHealth:300,img:l.dragon.idle,invType:0,invMax:0,dieSound:[],sSizex:2,sSizey:2,dragon:1,iconID:160,race:"common",zLevel:2,nofreeze:1,attackSound:[],sight:12,standardFunc:R,url:l.dragon,icons:d,cost:[80,0,0,0,800],attDist:2,spd:128,clss:"drg",size:1,z32:1.5,validator:$f},{radix:0,name:"Carpet",strID:"carpet",defence:0,attack:0,health:90,maxHealth:90,img:l.carpet.idle,invType:1,invMax:8,dieSound:[],iconID:131,race:"common",
zLevel:2,nofreeze:1,attackSound:[],sight:8,url:l.carpet,icons:[b.move,b.unload,b.explore,b.stop,b.stand],cost:[80,0,0,0,500],attDist:2,spd:120,clss:"carpet",size:1,z32:1.5,validator:$f},{radix:0,name:"Jinn",strID:"jinn",defence:5,attack:20,health:300,maxHealth:300,img:l.arab_jinn.idle,invType:0,invMax:0,dieSound:[],validator:U,iconID:182,race:"common",zLevel:1,nofreeze:1,attackSound:[],sight:8,standardFunc:R,url:l.arab_jinn,icons:d,w:1,cost:[80,0,0,0,300],attDist:1,spd:85,clss:"jinn",size:1}];rd=
{};Lh={arr:[]};pb={euro:[],asia:[],arab:[],common:[]};Td=[];Fc=[[],[],[],[],[],[]];q=0;for(k=B.length;q<k;q++){m=B[q];B[q].type=q;var p=m.space;m.name.split(" ").join("");m.population&&Td.put(m);rd[q]={};void 0!==m.storage&&(-1<m.storage?(0===m.storage&&Fc[3].put(q),Fc[m.storage].put(q)):(Fc[0].put(q),Fc[1].put(q),Fc[2].put(q),Fc[3].put(q)));mb[m.race][m.name.toLowerCase().split(" ").join("")]=m;m.icons.menuName=m.strID;Lh[m.name]=q;Lh.arr.put(q);m.img||(m.img=m.url);m.maxHealth=m.health;m.race&&
pb[m.race].put(m);f=0;e=m.icons;for(h=e.length;f<h;f++)(g=e[f])&&g.obj&&(g.orderOrigin=m);if(p){f=[];m.free=f;g=p[p.length-1];c=(p.length-1)/g;m=g+2;h=c+2;e=new Uint8Array(m*h);for(v=0;v<c;v++)for(var u=0;u<g;u++)e[(v+1)*m+u+1]=p[u+v*g];v=0;for(h*=m;v<h;v++)!e[v]&&(e[v+1]||e[v-1]||e[v+1+m]||e[v+1-m]||e[v-1+m]||e[v-1-m]||e[v+m]||e[v-m])&&(f.put(v%m-1),f.put(~~(v/m)-1))}}pb.euro=pb.euro.concat(pb.common);pb.asia=pb.asia.concat(pb.common);pb.arab=pb.arab.concat(pb.common);pb[0]=pb.euro;pb[1]=pb.arab;
pb[2]=pb.asian;e=mb.euro;h=mb.asia;g=mb.arab;c=mb.common;mb[0]=mb.euro;mb[1]=mb.arab;mb[2]=mb.asia;hd||(d.cut=L({a:"attack",g:"guard",r:"patrol",p:"pickUp",e:"explore",s:"stop",n:"stand"}),e.tavern.icons.cut=L({t:"trade1",g:"gamble",m:"createMercenaries",h:"createHeroes",l:"loan"}),e.castle.icons.cut=L({p:"createPeon",s:"createSpy",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning"}),h.castle.icons.cut=L({p:"createPeon1",n:"createNina",e:"emergeAllUnits",d:"techFeudalism",
a:"techArchitecture",l:"techLearning",b:"techBudhism",w:"techGreatwall"}),g.castle.icons.cut=L({p:"createPeon2",s:"createSpy",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning",y:"techSlavery"}),e.barracks.icons.cut=L({f:"createFootman",a:"createArcher",m:"createMaceman",p:"createPikeman",l:"createLongbowman",k:"createKnight"}),h.barracks.icons.cut=L({r:"createRonin",a:"createArcher1",s:"createSamurai",h:"createHorseArcher1",o:"createHorseSamurai",c:"createChariot"}),g.barracks.icons.cut=
L({f:"createFootman2",a:"createArcher2",s:"createSatrap",p:"createPikeman2",h:"createHorseArcher2",c:"createCavalry",j:"createEnichar",d:"createJihad"}),e.magetower.icons.cut=L({m:"createMage"}),h.mageguild.icons.cut=L({m:"createMage1"}),g.mageguild.icons.cut=L({m:"createMage2"}),e.peasant.icons.cut=L({b:"menuBuilds",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",i:"bribe"}),g.peasant.icons.cut=L({b:"menuBuilds2",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",
s:"stop",n:"stand",a:"attack",j:"become_jihadw",i:"bribe"}),h.peasant.icons.cut=L({b:"menuBuilds1",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",t:"trade"}),e.priest.icons.cut=L({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",b:"bless"}),g.priest.icons.cut=L({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",b:"bless"}),h.priest.icons.cut=L({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",r:"raiseexp"}),e.wizard.icons.cut=
L({m:"move",a:"attack",s:"stop",n:"stand",l:"lightning",b:"createBat",f:"freeze",t:"createGolem",i:"invisibility"}),g.mage.icons.cut=L({m:"move",a:"attack",s:"stop",n:"stand",c:"spell_spawncarpet",j:"spell_spawnjin",r:"spell_firerain",v:"spell_magicvision",d:"raisedead"}),h.mage.icons.cut=L({m:"move",a:"attack",s:"stop",n:"stand",h:"spell_hypnotize",t:"spell_turntostone",w:"spell_whirlpool",f:"spell_flamebolt",d:"spell_spawndragon"}),c.spy.icons.cut=L({a:"attack",g:"guard",r:"patrol",p:"pick_item",
e:"explore",n:"stand",s:"stop"}),h.monk.icons.cut=L({a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",s:"stop",n:"stand"}),h.ninja.icons.cut=L({a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",s:"stop",n:"stand",c:"cloak",u:"murder"}),c.catapult.icons.cut=L({a:"attack",g:"guard",p:"patrol",e:"explore",s:"stop",n:"stand",r:"attack_ground",h:"hold_steady"}),e.market.icons.cut=L({c:"createCaravan"}),g.market.icons.cut=L({c:"createCaravan2"}),h.market.icons.cut=L({b:"market_items",s:"market_sell"}),
e.workshop.icons.cut=L({c:"createCatapult",h:"createHeavyCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),g.workshop.icons.cut=L({c:"createCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),h.workshop.icons.cut=L({c:"createCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),e.church.icons.cut=L({p:"createPriest"}),g.church.icons.cut=L({p:"createPriest2"}),h.monastery.icons.cut=L({m:"createMonk",p:"createPriest1"}),g.magicworkshop.icons.cut=
L({i:"build_item"}),d=L({c:"buildCastle",s:"buildStorage",b:"buildBarrack",k:"buildBlacksmith",f:"buildFarm",l:"buildLumbermill",p:"buildWorkshop",e:"buildCathedral",u:"buildChurch",n:"buildTavern",m:"buildMageTower",a:"buildStable",r:"buildHarbor",o:"buildOutpost",i:"buildFields",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse",g:"buildGateWood",y:"buildDummy"}),f=L({c:"buildCastle2",k:"buildBlacksmith2",f:"buildFarm2",n:"buildTavern2",b:"buildBarrack2",p:"buildWorkshop2",s:"buildStorage2",
a:"buildStable2",l:"buildLumbermill2",r:"buildHarbor2",o:"buildOutpost2",u:"buildChurch2",e:"buildMosque",i:"buildFields",m:"buildMageTower2",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse2",g:"buildGateWood"}),q=L({c:"buildCastle1",f:"buildFarm1",e:"buildShaolinn",n:"buildTavern1",b:"buildBarrack1",p:"buildWorkshop1",s:"buildStorage1",k:"buildBlacksmith1",a:"buildStable1",l:"buildLumbermill1",r:"buildHarbor1",o:"buildOutpost1",u:"buildChurch1",i:"buildFields",m:"buildMageTower1",
w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse1",g:"buildGateWood"}),Ae.cut=q,Be.cut=q,Ce.cut=d,De.cut=d,Ee.cut=d,Fe.cut=q,Ge.cut=d,He.cut=q,Ie.cut=f,Je.cut=f,Ke.cut=f,Le.cut=f,e.lumbermill.icons.cut=L({b:"techLongbow",w:"techWoodCutting",c:"techCrossbow"}),g.lumbermill.icons.cut=L({w:"techWoodCutting",c:"techCrossbow"}),h.lumbermill.icons.cut=L({w:"techWoodCutting",c:"techCrossbow"}),e.blacksmith.icons.cut=L({p:"techPlateArmor",t:"techTemperIron",s:"techScaleArmor",h:"techHalberd",
c:"techChainMail"}),g.blacksmith.icons.cut=L({t:"techTemperIron",a:"techScaleArmor",s:"techScimitar",c:"techChainMail",h:"techHalberd"}),h.blacksmith.icons.cut=L({t:"techTemperIron",a:"techScaleArmor",r:"techArmoredChariot",c:"techChainMail"}),e.outpost.icons.cut=L({e:"emergeAllUnits"}),g.outpost.icons.cut=L({e:"emergeAllUnits"}),h.outpost.icons.cut=L({e:"emergeAllUnits"}),c.watchtower.icons.cut=L({a:"attack",s:"stop",g:"upgradeGuildTower"}),c.guardtower.icons.cut=L({a:"attack",s:"stop",g:"upgradeStoneTower",
c:"upgradeCannonTower"}),c.keeptower.icons.cut=L({a:"attack",s:"stop",c:"upgradeCannonTower"}),c.cannontower.icons.cut=L({a:"attack",r:"attack_ground",s:"stop",h:"holdfire"}),h.rockettower.icons.cut=L({a:"attack",r:"attack_ground",s:"stop",f:"fireatwill"}),e.harbor.icons.cut=L({f:"createFishingBoat",x:"createXebec",h:"createHulk",g:"createGalleon",t:"te_landingtactics"}),g.harbor.icons.cut=L({f:"createFishingBoat",h:"createHulk",x:"createXebec",t:"te_landingtactics"}),h.harbor.icons.cut=L({f:"createFishingBoat",
h:"createHulk",x:"createXebec"}),e.farm.icons.cut=L({c:"createCow",f:"techCropRotation",d:"techDomestication"}),g.farm.icons.cut=L({c:"createCow",f:"techDomestication",d:"techDomestication",p:"techCowPoaching",r:"ridingHorses",h:"techHorseManShip"}),h.farm.icons.cut=L({f:"techDomestication",a:"ridingHorses",i:"irrigation"}),e.storage.icons.cut=L({g:"techGoldMining",s:"techStoneMining"}),g.storage.icons.cut=L({g:"techGoldMining",s:"techStoneMining"}),h.storage.icons.cut=L({g:"techGoldMining",s:"techStoneMining"}),
e.cathedral.icons.cut=L({c:"createCrusaders"}),c.magicgateway.icons.cut=L({o:"createOrk",d:"createDwarf",g:"createGhost",s:"createSkeleton"}));d=[e.knight,h.horsesamurai,g.cavalry,g.enichar,e.crusader,h.chariot,h.horsearcher,g.horsearcher];f=[h.horsesamurai,e.crusader,g.enichar];q=[e.knight,g.cavalry,h.chariot,h.horsearcher,g.horsearcher];m=[e.longbowman,g.archer,h.archer,e.archer];v=[c.catapult,c.ballista,c.heavycatapult];k=[c.galleon,c.hulk,c.pinque,c.fishingboat];p=[c.galleon,c.hulk,c.pinque];
u=[g.satrap,e.maceman];var r=[e.longbowman,g.archer,h.archer,e.archer,h.horsearcher,g.horsearcher,c.pinque,c.watchtower,c.keeptower,c.guardtower],t=[c.stonegolem,c.ork,c.dwarf,c.skeleton,c.ghost,c.dragon,c.jinn,c.bat,e.wizard,g.mage,h.mage],w=[e.peasant,h.peasant,g.peasant,e.footman,g.footman,h.ronin,e.pikeman,g.spearman,g.satrap,e.maceman,g.cavalry,g.jihadwarrior,c.spy,g.enichar,h.horsesamurai,h.monk,h.chariot,h.ninja,c.stonegolem,c.ork,c.dwarf,c.jinn,c.skeleton,c.ghost,e.knight,e.crusader],x=[c.watchtower,
c.keeptower,c.guardtower,c.cannontower],z=[c.cannontower,h.rockettower],A=[e.cathedral,e.castle,c.woodenwall,e.barracks,e.lumbermill,e.magetower,e.warriorsguild,e.storage,e.farm,e.merchantsguild,e.church,e.blacksmith,e.stable,e.workshop,e.tavern,e.house,c.watchtower,e.market,e.outpost,c.bridge,e.harbor,c.guardtower,c.keeptower,c.cannontower,h.rockettower,h.castle,g.castle,h.barracks,g.house,g.lumbermill,g.storage,g.farm,g.harbor,g.blacksmith,g.workshop,g.church,g.tavern,g.market,g.barracks,g.stable,
g.outpost,g.mosque,g.mageguild,g.merchantsguild,g.warriorsguild,g.magicworkshop,h.house,h.lumbermill,h.storage,h.farm,h.harbor,h.blacksmith,h.workshop,h.monastery,h.tavern,h.market,h.stable,h.outpost,h.shaolinn,h.mageguild,h.merchantsguild,h.warriorsguild],D=[e.cathedral,e.castle,c.woodenwall,e.barracks,e.lumbermill,e.magetower,e.warriorsguild,e.storage,e.farm,e.merchantsguild,e.church,e.blacksmith,e.stable,e.workshop,e.tavern,e.house,c.watchtower,e.market,e.outpost,c.bridge,e.harbor,h.castle,g.castle,
h.barracks,g.house,g.lumbermill,g.storage,g.farm,g.harbor,g.blacksmith,g.workshop,g.church,g.tavern,g.market,g.barracks,g.stable,g.outpost,g.mosque,g.mageguild,g.merchantsguild,g.warriorsguild,g.magicworkshop,h.house,h.lumbermill,h.storage,h.farm,h.harbor,h.blacksmith,h.workshop,h.monastery,h.tavern,h.market,h.stable,h.outpost,h.shaolinn,h.mageguild,h.merchantsguild,h.warriorsguild],E=[c.catapult,c.heavycatapult],F=[e.pikeman,g.spearman],G=[h.monk,h.priest],H=[c.woodenwall],I=[e.peasant,h.peasant,
g.peasant],M=[e.wizard,g.mage,h.mage],O=[e.footman,g.footman,h.ronin],Q=[e.priest,g.priest,h.priest];Zb={bless:{img:l.bless,d:0,mv:1},star:{img:l.star,d:0,mv:1},heal:{img:l.healing,d:0,mv:1},impersonate:{img:l.impersonate,d:0,mv:1},select:{img:l.select,d:0,mv:0,select:1,z32:.8},spawn:{img:l.spawn,d:0,mv:1},curse:{img:l.curse,d:0,mv:1},turnStone:{img:l.turn_to_stone,d:0,mv:1}};var J=function(c,b,d){for(var g=c.length,e=0,f=b.length;e<f;e++)for(var h=0;h<g;h++)rd[c[h].type][b[e].type]=d};J(z,p,4);J(p,
p,3);J(p,D,3);J(p,x,3);J(p,H,5);J(p,v,2);J(E,D,4);J(E,k,4);J(E,x,6);J(E,v,4);J(E,H,9);J([h.samurai],f,.5);J([h.samurai],q,.3);J([h.ronin],I,1);J(F,d,6);J(O,F,1.5);J(O,m,1.5);J(O,[g.jihadwarrior],1);J([g.satrap],I,2);J(u,v,1.5);J(r,[c.dragon],.75);J(r,[c.bat],1);J(r,[e.pikeman],-.75);J(r,u,1);J(r,[h.chariot],-.3);J(r,G,.5);J(M,Q,4);J(Q,M,3);J(Q,t,3);J(w,[c.bat],-.2);J(w,[c.dragon],-.5);J([c.stonegolem],A,1);J([c.dwarf],A,4);J(t,[h.priest],-.5);ib={img:l.gath_point,x32:-10,y32:-10,d:0,mv:!0};rg=[ib];
m=qa;d=Object.keys(m);for(f=0;f<B.length;f++)for(v=B[f],q=0;q<d.length;q++)v[d[q]]=m[d[q]];d=[e.archer,e.longbowman,h.archer,h.horsearcher,g.archer,g.horsearcher];f=[e.footman,e.maceman,e.knight,e.crusader,e.pikeman,g.jihadwarrior,g.cavalry,g.footman,g.enichar,e.peasant,g.peasant,g.satrap,g.spearman,c.spy,h.chariot,h.monk,h.samurai,h.ronin,h.horsesamurai,h.ninja,h.peasant,c.skeleton,c.ghost,c.ork,c.dwarf];q=[e.footman,e.maceman,e.knight,e.crusader,e.pikeman,g.jihadwarrior,g.cavalry,g.footman,g.enichar,
e.peasant,g.peasant,g.satrap,g.spearman,c.spy,h.chariot,h.monk,h.samurai,h.ronin,h.horsesamurai,h.ninja,h.peasant,e.archer,e.longbowman,h.archer,h.horsearcher,g.archer,g.horsearcher,e.wizard,g.mage,h.mage,e.priest,g.priest,h.priest,c.skeleton,c.ghost,c.ork,c.dwarf];C=[{name:["Longbow","Allows the production of longbowmen"],next:[b.createLongbowman],cost:[400,0,0,0],time:45,type:Y},{name:["Gold Mining","Increases gold production"],increase:2,value:"gold",cost:[400,0,0,0],time:20,type:ab},{name:["Stone Mining",
"Increases stone production"],increase:2,value:"stone",cost:[400,0,0,0],time:20,type:ab},{name:["Wood Cutting","Increases wood production"],increase:2,value:"wood",cost:[400,0,0,0],time:20,type:ab},{name:["Temper Iron","Increases hand-to-hand units' attack power"],increase:2,value:"attack",cost:[400,0,0,0],time:30,group:f,next:[b.techHalberd],type:ob},{name:["Scale Armor","Increases unit's defense"],increase:1,value:"defence",cost:[400,0,0,0],time:30,group:q,next:[b.techChainMail],type:ob},{name:["Halberd",
"Allows the production of spear units"],next:[b.createPikeman,b.createPikeman2],cost:[400,0,0,0],time:30,type:Y},{name:["Domestication","Allows the production of cows"],next:[b.createCow],cost:[300,0,0,0],time:20,type:Y},{name:["Crop Rotation","Increases the production of fields"],increase:2,value:"food",cost:[400,0,0,0],time:20,type:ab,next:[b.irrigation]},{name:["Chain Mail","Increases unit's defense"],increase:2,value:"defence",cost:[400,0,0,0],time:30,group:q,type:ob},{name:["Plate Armor","Allows the production of knights"],
next:[b.createKnight],cost:[400,0,0,0],time:60,type:Y},{name:["Crossbow","Increases arrow units' attack power"],increase:2,value:"attack",cost:[400,0,0,0],time:30,group:d,type:ob},{name:["Feudalism","Makes peasants cheaper"],cost:[300,0,0,0],time:30,decrease:[h.peasant,[0,0,8,0],e.peasant,[0,0,10,0],g.peasant,[0,0,10,0]],type:fh,next:[b.techSlavery]},{name:["Architecture","Peasants build faster, and allows stone wall, gate and towers"],increase:.5,value:"buildSpeed",cost:[300,0,0,0],time:30,type:ab,
next:[b.upgradeStoneTower,b.techGreatWall,b.buildBridge]},{name:["Learning","Allows units to gather experience"],increase:1,value:"experience",cost:[400,0,0,0],time:30,type:ab,next:[b.buildAcademy,b.buildAcademy1,b.buildAcademy2]},{name:["Convert Resources",""],cost:[400,0,0,0],time:30},{name:["Map Making","Allows the production of galleons"],cost:[800,0,0,0],time:30,type:Y},{name:["Trade Routes","Allows trading"],cost:[400,0,0,0],time:30,type:Y,next:[b.techTradeTaxes]},{name:["Trade Taxes","Increases trade profit"],
cost:[400,0,0,0],time:30},{name:["Usury","Allows the obtaining of loans in taverns"],cost:[300,0,0,0],time:30,type:mf,changeicon:38,next:[b.techBanking]},{name:["Supply Storage","Increases the population limit"],cost:[500,0,0,0],time:30,increase:50,type:ab,value:"popLimit",next:[b.techSeaFood]},{name:["Bribery","Allows the bribing of enemy units"],cost:[600,0,0,0],time:60,type:Y,next:[b.bribe]},{name:["Heroism","Allows unlimited experience"],cost:[500,0,0,0],time:30,increase:Infinity,value:"maxLevel",
type:ab,next:[b.techLeadership]},{name:["Warfare","Gain experience faster"],cost:[400,0,0,0],time:30,type:ab,increase:1,value:"experience",next:[b.techTactics]},{name:["Tactics","Gain experience faster"],cost:[800,0,0,0],time:30,type:Y,next:[b.buildDummy,b.techSunTzu]},{name:["Mercenaries","Allows the recruitment of units in taverns"],cost:[600,0,0,0],time:30,type:mf,next:[b.techHeroes,b.createMercenaries],actvintv:[b.iniMercenaries]},{name:["Heroes' Quest","Allows the recruitment of heroes in taverns"],
cost:[800,0,0,0],time:30,type:mf,next:[b.techFame,b.createHeroes],actvintv:[b.iniHeroes]},{name:["Fame","Recruit better units from taverns"],cost:[500,0,0,0],time:30,value:"fameTech",increase:1,type:ab},{name:["Siege Tactics","Allows the production of heavy catapults"],cost:[1200,0,0,0],time:60,type:Y,next:[b.createHeavyCatapult]},{name:["Body Building","Increases unit's hit points at every new level"],cost:[800,0,0,0],time:60,value:"healthJump",increase:5,type:ab},{name:["Espionage","Allows the production of a spy"],
cost:[400,0,0,0],time:30,type:Y,next:[b.createSpy]},{name:["Fanaticism","Increases the building's resistance"],cost:[400,0,0,0],time:30,type:ob,group:[],increase:5,value:"resistance",next:[b.techCrusade,b.techJihad]},{name:["Crusade","Allows the preaching of a crusade"],cost:[1200,0,0,0],time:180,type:Y,next:[b.createCrusaders]},{name:["Inquisition","Increases priest attack"],cost:[400,0,0,0],time:30,type:ob,group:[e.priest,g.priest,h.priest],increase:5,value:"attack"},{name:["Healing","Allows healing of units"],
cost:[400,0,0,0],time:30,next:[b.techMedicine,b.healing],type:Y},{name:["Medicine","Allows remote healing of units"],cost:[500,0,0,0],time:30,value:"healingRange",increase:5,type:ab},{name:["Bless","Temporarily increases unit attack skill"],cost:[400,0,0,0],time:30,type:Y,next:[b.bless]},{name:["Invisibility","Invisibility spell"],cost:[500,0,0,0],time:30,type:Y,next:[b.invisibility]},{name:["Bat","Researches bat summoning"],cost:[400,0,0,0],time:240,type:Y,next:[b.createBat]},{name:["Freeze","Freeze spell"],
cost:[800,0,0,0],time:30,type:Y,next:[b.freeze]},{name:["Lightning","Lightning spell"],cost:[400,0,0,0],time:30,type:Y,next:[b.lightning]},{name:["Stone Golem","Researches stone golem summoning"],cost:[800,0,0,0],time:120,type:Y,next:[b.createGolem]},{name:"Upgrade to Guard Tower",cost:[0,600,0,0],time:20,type:$d,obj:44,upgrade:1},{name:"Upgrade to Stone Tower",cost:[0,0,0,500],time:30,type:$d,obj:55,upgrade:1},{name:"Upgrade to Cannon Tower",cost:[0,0,0,500],time:30,type:$d,obj:56,upgrade:1},{name:["Buddhism"],
cost:[400,0,0,0],time:30,type:Y,next:[b.buildCathedral1]},{name:["Cannon Tower","Allows the building of cannon towers"],next:[b.upgradeCannonTower],cost:[400,0,0,0],time:30,type:Y},{name:["Engineering","Increases siege weapon's attack"],increase:5,value:"attack",cost:[400,0,0,0],time:30,group:[c.ballista,c.catapult,c.heavycatapult],type:ob},{name:["Great Wall","Makes stone walls, towers and gates stronger"],cost:[600,0,0,0],time:30,type:Y},{name:["Art of Riding","Allows the production of horse archers"],
cost:[500,0,0,0],time:30,type:Y,next:[b.createHorseArcher1,b.createHorseArcher2,b.techHorseManShip]},{name:["Irrigation","Increases field production"],increase:4,value:"food",cost:[400,0,0,0],time:30,type:ab},{name:["Armored Chariot","Allows the production of armored chariots"],cost:[500,0,0,0],time:60,type:Y,next:[b.createChariot]},{name:["Meditation","Makes monks cheaper"],cost:[300,0,0,0],time:30,decrease:[0,0,50,0],type:nf,next:[b.techPhilosophy],group:[h.monk]},{name:["Kung-Fu","Increases the attack of all kung-fu units"],
cost:[400,0,0,0],time:30,type:ob,increase:1,value:"attack",group:[h.peasant,h.ninja,h.monk,h.priest],next:[b.techMastery,b.techNinjas,b.techTournaments]},{name:["Tournaments","Allows sharing of experience between kung-fu units"],cost:[800,0,0,0],time:30,type:Y,next:[]},{name:["Philosophy","Allows the production of more experienced monks"],cost:[400,0,0,0],time:30,type:ob,increase:2,value:"level",group:[h.monk,h.priest],next:[b.createPriest1]},{name:["Ninjas","Allows the production of ninjas"],cost:[500,
0,0,0],time:30,type:Y,next:[b.createNinja]},{name:["Mastery","Allows priests to teach kung-fu units"],cost:[500,0,0,0],time:30,type:Y,next:[b.teach]},{name:["Concentration","Allows faster manna restoration"],cost:[600,0,0,0],time:80,type:Y,next:[b.techConfusion]},{name:["Confusion","Researches the Confusion spell"],cost:[400,0,0,0],time:30,type:Y,next:[b.confusion]},{name:["Whirlpool","Researches the Whirlpool spell"],cost:[300,0,0,0],time:30,type:Y,next:[b.whirlpool]},{name:["Dragon","Researches Dragon summoning"],
cost:[800,0,0,0],time:300,type:Y,next:[b.createDragon]},{name:["Turn to Stone","Researches the Turn to Stone spell"],cost:[300,0,0,0],time:30,type:Y,next:[b.turnToStone]},{name:["Flame Bolt","Researches the Flame Bolt spell"],cost:[400,0,0,0],time:30,type:Y,next:[b.techDragon,b.flameBolt]},{name:["Jewelry","Allows trading of items"],cost:[400,0,0,0],time:30,type:Y,next:[b.sellItems,b.buyItems]},{name:["Banking","Increases trade profit"],cost:[600,0,0,0],time:30,type:Y},{name:["Chemistry","Increases arrow units' attack power"],
cost:[500,0,0,0],time:30,type:ob,group:d,increase:1,value:"attack",next:[b.techGunPowder]},{name:["Sea Food","Increases the population limit"],cost:[500,0,0,0],time:30,increase:50,type:ab,value:"popLimit"},{name:["Gun Powder","Increases cannon tower's attack power"],cost:[500,0,0,0],time:30,type:ob,increase:10,value:"attack",group:[c.cannontower],next:[b.techRocketArrow]},{name:["Rocket Arrow","Allows the building of rocket tower"],cost:[800,0,0,0],time:30,type:Y,next:[b.buildRocketTower]},{name:["Bushido",
"Allows the production of horse samurai"],cost:[800,0,0,0],time:120,type:Y,next:[b.createHorseSamurai]},{name:["Leadership","Units around a hero gain experience"],cost:[600,0,0,0],time:30,type:Y,next:[b.techHonor]},{name:["Honor","Hero vs. hero attack bonus"],cost:[500,0,0,0],time:30,type:Y},{name:["Sun Tzu's Book","Increases the speed of learning"],cost:[800,0,0,0],time:30,type:ab,increase:1,value:"experience"},{name:["Cow Poaching","Allows peasants to steal cows"],cost:[200,0,0,0],time:30,type:ab,
increase:1,value:"stealCows"},{name:["Horsemanship","Makes mounted units cheaper"],cost:[500,0,0,0],time:30,type:nf,mulp:.75,group:[h.horsearcher,g.cavalry,g.horsearcher]},{name:["Scimitar","Increases sword attack power and allows the production of satraps"],cost:[400,0,0,0],time:30,type:ob,increase:1,value:"attack",group:f,next:[b.createSatrap]},{name:["Jihad","Allows the production of Jihad Warriors"],cost:[1200,0,0,0],time:30,type:Y,next:[b.createJihad,b.convertJihad]},{name:["Magic Carpet","Researches Magic Carpet summoning"],
cost:[300,0,0,0],time:30,type:Y,next:[b.createCarpet,b.techJinn]},{name:["Magic Workshop","Allows the building of a magic workshop"],cost:[1200,0,0,0],time:180,type:Y,next:[b.buildMagicWorkshop]},{name:["Rain of Fire",""],cost:[800,0,0,0],time:60,type:Y,next:[b.fireRain]},{name:["Magic Vision","Researches the Magic Vision spell"],cost:[400,0,0,0],time:30,type:Y,next:[b.magicVision]},{name:["Necromancy","Researches the Raise the Dead spell"],cost:[400,0,0,0],time:30,type:Y,next:[b.raiseDead]},{name:["Jinn",
"Researches Jinn summoning"],cost:[600,0,0,0],time:300,type:Y,next:[b.createJinn]},{name:["Ore Enrichment","Increases mine production"],cost:[800,0,0,0],time:30,type:ab,increase:1,value:"miningPerf"},{name:["Riding Horses","Increases the mounted units' attack and defense power"],cost:[500,0,0,0],time:30,type:Yi,values:["attack",2,"defence",1],group:[h.horsearcher,g.cavalry,g.horsearcher],next:[b.techJanissary]},{name:["Janissary","Allows the production of Janissaries"],cost:[1200,0,0,0],time:120,
type:Y,next:[b.createEnichar]},{name:["Slavery","Makes peasants cheaper"],cost:[200,0,0,0],time:30,decrease:[h.peasant,[0,0,7,0],e.peasant,[0,0,8,0],g.peasant,[0,0,8,0]],type:fh}];xi();b.buildMarket.disabled=1;Yj();q=0;for(k=B.length;q<k;q++)if(m=B[q],m.onbuild)for(e=m.onbuild,f=0,h=e.length;f<h;f++)g=e[f],g.obj.race==m.race&&(g.disabled=1,g.require=m.name,g.requireObj||(g.requireObj=[]),g.requireObj.put(m));f=0;for(h=C.length;f<h;f++)if(g=C[f],g.tech=1,g.id=f,g.next)for(e=g.next,v=0,q=e.length;v<
q;v++)m=e[v],m.disabled?(m.disabled++,m.require+=", "+g.name[0],m.requireObj.put(g)):(m.requireObj=[g],m.disabled=1,m.require=g.name[0]);f=0;e=B;for(h=e.length;f<h;Vk(e[f++]));}new kc("",[255,255,255],[0],!0)},B,rd,Lh,ib,rg,Td,Mh=8,z=new Float32Array(16),Sc=function(b,c,d,e,f,h,m){var g=B[b];if(h=h&&!g.instantBuild)this.built=!1;var k=F[c],l=k.mod[b],p=Object.keys(l);this.__proto__=g;this.kingdom=c;this.d=f;this.x32=d;this.y32=e;this.taskList=[];f=0;for(var u=p.length;f<u;this[p[f]]=l[p[f++]]);if(m)for(l=
Object.keys(m),f=0,u=l.length;f<u;this[l[f]]=m[l[f++]]);0<g.invMax&&(this.inventory=[]);g.build||(this.mv=1);m=k.technology.disabled;l=g.actvintv;this.workers=[];this.id=u=A.length;g.rndDirection&&(this.d=u*d%g.rndDirection);this.build||k.values.pop++;d=g.validator(d,e,g.space,c);if(d[1]||h){e=g.validator.dimension;p=d[0];if(h){e=Ja;this.onbuild1=p;var t=Hb[c];f=0;for(g=p.length;f<g;f++)t[p[f]]=u}else for(f=0,g=p.length;f<g;e[p[f++]]=u);if(d[2])if(p=d[2],h){P(p);f=0;for(g=p.length;f<g;e[p[f++]]=u);
this.onbuildValid=p}else for(f=0,g=p.length;f<g;e[p[f++]]=0);}else return this.invalid=!0,!1;A[u]=this;h||lb[c][b].put(u);if(this.update&&!r.custom)for(b=this.update,f=0,u=b.length;f<u;f+=3)Ia({func:cf,data:[this.id,b[f],b[f+1],b[f+2]]},b[f+2],1);if(l)for(b=0,g=l.length;b<g;b++)c=l[b],m[c.id]||c(this);h?(Xa(this),w.kingdom==this.kingdom?zd(this,al):zd(this,Zg)):Xa(this);this.level&&!this.potion&&Ti(this);!this.standardFunc||this.func||r.editor||this.standardFunc(this);Hi(this);h=k.stats;h.unitCount[this.type]++;
k=h.unitCount[this.type]-h.unitCountDeath[this.type];k>h.unitCountMax[this.type]&&(h.unitCountMax[this.type]=k)},cj=function(b){var c=F[b.kingdom];if(b.population){var d=b.population;c.values.popMax+=d;Zd(b.kingdom);for(var g=0;g<d;g++)c.checkPopArray()}if(b.onbuild)for(b=b.onbuild,d=c.technology,c=d.disabled,d=d.actived,g=0;g<b.length;g++){var f=b[g].id;d[f]||(d[f]=0);d[f]++;d[f]-1||(c[f]--,!c[f]&&la.actv[f]&&la(T.active))}},Ib=[],V=new Float32Array(12),Nh=function(b,c,d){var g=b.length;b[g]=c;b[g+
1]=c+1;b[g+2]=c+2;b[g+3]=c+1;b[g+4]=c+2;b[g+5]=c+3;b.changed=!0;d.typeBuffer=b;d.elemtId=g},zd=function(b,c){var d=c[3];if(c.noAlpha)g=ha;else{b.alpha=!0;var g=sa}if(b.typeBuffer!==g){if(c==Zg){if(Gb.diplomacy[b.kingdom]){Sb(b);return}c=new Float32Array(yb(Fa[3*b.kingdom],Fa[3*b.kingdom+1],Fa[3*b.kingdom+2],d+1))}Sb(b);Nh(g,b.bufferID,b)}k.bindBuffer(k.ARRAY_BUFFER,ub);k.bufferSubData(k.ARRAY_BUFFER,16*b.bufferID,c)},rc=function(b){var c=ag(b,b.kingdom),d=c[0],g=c[1],f=c[2];c=c[3];var h=b.bufferID;
Zj(d,g,f,c,b.bufferID);1>c?(b.alpha=!0,d=sa):d=ha;b.typeBuffer!==d&&(Sb(b),Nh(d,h,b));if(b.child&&(!1!==b.built||!b.build))for(var m=b.child,k=0,l=m.length;k<l;k++)h+=4,c=ag(m[k],b.kingdom),d=c[0],g=c[1],f=c[2],c=c[3],Zj(d,g,f,c,h)},ag=function(b,c){if(null!=b.rgb){var d=b.rgb;b=d[0];var g=d[1];c=d[2];d=d[3]}else Ca[b.img][3]?(b=Fa[3*c],g=Fa[3*c+1],c=Fa[3*c+2],d=2):(b.mMapcolor?(c=b.mMapcolor,b=c[0]/255,g=c[1]/255,c=c[2]/255):(b=Fa[3*c],g=Fa[3*c+1],c=Fa[3*c+2]),d=1);return[b,g,c,d]},ak=function(){if(Ib.length){var b=
Ib[Ib.length-1];Ib.length--}else b=Mh,Mh+=4;return b},Xa=function(b,c,d,e){void 0==c&&(e=d=c=0);var g=Ca[b.img],h=1;if(b.bufferID){var m=b.bufferID;h=0}else m=ak();b.bufferID=m;g||P(b);var l=g[2]*b.d*6+4,v=g[4+l],q=g[5+l];l=g[0];var p=g[1];0<=p&&(p*=.001);var u=g.id+4*b.d*g[2],t=-1;b.mv&&(t=r.now());z[0]=u;z[1]=t;z[2]=l;z[3]=p;z[4]=u+1;z[5]=t;z[6]=l;z[7]=p;z[8]=u+2;z[9]=t;z[10]=l;z[11]=p;z[12]=u+3;z[13]=t;z[14]=l;z[15]=p;var w=32*b.x32,x=32*b.y32;l=32*b.y32;null!=b&&null!=b.z32&&(l*=b.z32);var A=
ha;k.bindBuffer(k.ARRAY_BUFFER,kd);k.bufferSubData(k.ARRAY_BUFFER,16*m,z);k.bindBuffer(k.ARRAY_BUFFER,wc);if(b.rotation){var B=b.rotation;B*=2*Math.PI;var C=.5*g[8];p=.5*g[9];g=-1*l;u=-C;t=-p;var D=0*V.length;V[D]=u*Math.cos(B)-p*Math.sin(B)+w;V[D+1]=p*Math.cos(B)+u*Math.sin(B)+x;V[D+2]=g;V[D+3]=u*Math.cos(B)-t*Math.sin(B)+w;V[D+4]=t*Math.cos(B)+u*Math.sin(B)+x;V[D+5]=g;V[D+6]=C*Math.cos(B)-p*Math.sin(B)+w;V[D+7]=p*Math.cos(B)+C*Math.sin(B)+x;V[D+8]=g;V[D+9]=C*Math.cos(B)-t*Math.sin(B)+w;V[D+10]=
t*Math.cos(B)+C*Math.sin(B)+x;V[D+11]=g}else b.wh?(B=b.wh[0],C=b.wh[1],B-=v,C-=q,V[0]=w,V[1]=x,V[2]=l,V[3]=w+B,V[4]=x,V[5]=l,V[6]=w,V[7]=x+C,V[8]=l,V[9]=w+B,V[10]=x+C):(V[0]=w,V[1]=x,V[2]=l,V[3]=w,V[4]=x,V[5]=l,V[6]=w,V[7]=x,V[8]=l,V[9]=w,V[10]=x),V[11]=l;k.bufferSubData(k.ARRAY_BUFFER,12*m,V);t=ag(b,b.kingdom);g=t[0];p=t[1];u=t[2];t=t[3];if(1>t||b.alpha)b.alpha=!0,A=sa;k.bindBuffer(k.ARRAY_BUFFER,ub);z[0]=g;z[1]=p;z[2]=u;z[3]=t;z[4]=g;z[5]=p;z[6]=u;z[7]=t;z[8]=g;z[9]=p;z[10]=u;z[11]=t;z[12]=g;z[13]=
p;z[14]=u;z[15]=t;k.bufferSubData(k.ARRAY_BUFFER,16*m,z);k.bindBuffer(k.ARRAY_BUFFER,Jd);B=r.now();z[0]=c;z[1]=d;z[2]=e;z[3]=B;z[4]=c;z[5]=d;z[6]=e;z[7]=B;z[8]=c;z[9]=d;z[10]=e;z[11]=B;z[12]=c;z[13]=d;z[14]=e;z[15]=B;k.bufferSubData(k.ARRAY_BUFFER,16*m,z);h&&Nh(A,m,b);if(b.child&&!1!==b.built)for(c=l,d=b.child.length,e=[],b.childLoc=e,h=0;h<d;h++){A=b.child[h];g=Ca[A.img];l=g[2]*b.d*6+4;B=g[4+l];C=g[5+l];l=g[0];p=g[1];0<=p&&(p*=.001);u=g.id+4*b.d;t=-1;A.mv&&(t=1);z[0]=u;z[1]=t;z[2]=l;z[3]=p;z[4]=
u+1;z[5]=t;z[6]=l;z[7]=p;z[8]=u+2;z[9]=t;z[10]=l;z[11]=p;z[12]=u+3;z[13]=t;z[14]=l;z[15]=p;t=ag(A,b.kingdom);g=t[0];p=t[1];u=t[2];t=t[3];D=w;var E=x;A.wh1&&(B=A.wh[0],C=A.wh[1]);A.center&&(D-=.5*~~(B-v),E-=.5*~~(C-q));m=ak();k.bindBuffer(k.ARRAY_BUFFER,kd);k.bufferSubData(k.ARRAY_BUFFER,16*m,z);k.bindBuffer(k.ARRAY_BUFFER,ub);z[0]=g;z[1]=p;z[2]=u;z[3]=t;z[4]=g;z[5]=p;z[6]=u;z[7]=t;z[8]=g;z[9]=p;z[10]=u;z[11]=t;z[12]=g;z[13]=p;z[14]=u;z[15]=t;k.bufferSubData(k.ARRAY_BUFFER,16*m,z);l=A.z?32*A.z+c:c;
k.bindBuffer(k.ARRAY_BUFFER,wc);V[0]=D;V[1]=E;V[2]=l;V[3]=D;V[4]=E;V[5]=l;V[6]=D;V[7]=E;V[8]=l;V[9]=D;V[10]=E;V[11]=l;k.bufferSubData(k.ARRAY_BUFFER,12*m,V);k.bindBuffer(k.ARRAY_BUFFER,Jd);z[0]=0;z[1]=0;z[2]=0;z[3]=0;z[4]=0;z[5]=0;z[6]=0;z[7]=0;z[8]=0;z[9]=0;z[10]=0;z[11]=0;z[12]=0;z[13]=0;z[14]=0;z[15]=0;k.bufferSubData(k.ARRAY_BUFFER,16*m,z);l=1>t?sa:A.light?na:ha;e.put(l);B=l.length;e.put(B);l[B]=m;l[B+1]=m+1;l[B+2]=m+2;l[B+3]=m+1;l[B+4]=m+2;l[B+5]=m+3;l.changed=!0}},Cc=function(b,c,d,e){var g=
r.now(),h=b.bufferID;z[0]=c;z[1]=d;z[2]=e;z[3]=g;z[4]=c;z[5]=d;z[6]=e;z[7]=g;z[8]=c;z[9]=d;z[10]=e;z[11]=g;z[12]=c;z[13]=d;z[14]=e;z[15]=g;k.bindBuffer(k.ARRAY_BUFFER,Jd);k.bufferSubData(k.ARRAY_BUFFER,16*h,z);k.bindBuffer(k.ARRAY_BUFFER,null);if(b.tempChild)for(g=0,b=b.tempChild,h=b.length;g<h;Cc(b[g++],c,d,e));},Jh=function(b,c,d,e,f,h){Mb[0]=b;Mb[1]=c;Mb[2]=d;Mb[3]=b+e;Mb[4]=c;Mb[5]=d;Mb[6]=b;Mb[7]=c+f;Mb[8]=d;Mb[9]=b+e;Mb[10]=c+f;Mb[11]=d;k.bindBuffer(k.ARRAY_BUFFER,wc);k.bufferSubData(k.ARRAY_BUFFER,
12*h,Mb);k.bindBuffer(k.ARRAY_BUFFER,null)},Zj=function(b,c,d,e,f){z[0]=b;z[1]=c;z[2]=d;z[3]=e;z[4]=b;z[5]=c;z[6]=d;z[7]=e;z[8]=b;z[9]=c;z[10]=d;z[11]=e;z[12]=b;z[13]=c;z[14]=d;z[15]=e;k.bindBuffer(k.ARRAY_BUFFER,ub);k.bufferSubData(k.ARRAY_BUFFER,16*f,z);k.bindBuffer(k.ARRAY_BUFFER,null)},Ra=function(b,c,d){void 0==d&&(d=32);b.z32&&(c*=b.z32);var g=b.x32*d;d*=b.y32;b.wh?Jh(g,d,c,b.wh[0]-Ca[b.img][8],b.wh[1]-Ca[b.img][9],b.bufferID):Jh(g,d,c,0,0,b.bufferID);if(b.tempChild)for(c=b.tempChild,g=0,d=
c.length;g<d;g++){var f=c[g];f.x32=b.x32;f.y32=b.y32;Ra(f,32*b.y32)}},qa={getRadix:function(){return eb[this.zLevel]},checkMana:function(b,c,d,e){if(!this.mana)return!1;if(0>this.mana-b)return this.manaTask=[d.url,c,b],this.stay55(),b>this.manaMax&&e&&(this.blockedCost=e,c=this.setupChild(Zb.curse,1),this.blocked=2,this.blockedimg=c,this.manaTarget=b,k.bindBuffer(k.ARRAY_BUFFER,ub),k.bufferSubData(k.ARRAY_BUFFER,16*this.bufferID,ff),k.bufferSubData(k.ARRAY_BUFFER,16*c.bufferID,ff)),!1;this.mana-=
b;return!0}},sc=function(b,c){return r.editor?!0:b.freezed||b.confused?!1:F[b.spy||b.kingdom].control[c.spy||c.kingdom]};qa.changeKingdom=function(b){lb[this.kingdom][this.type].quit(this.id);tc[this.id]&&(tc[this.id]=0,G.quit(this.id),0==G.length&&(la([]),xe(),Kb=-1),Dh(this.id));this.kingdom=b;rc(this);this.childBuild&&(this.childBuild=0);this.build&&!this.arrow||this.stay();lb[b][this.type].put(this.id)};qa.aspettare=function(){this.nodes=void 0;this.getRadix()[this.x32+this.y32*E]=this.id;this.waiting=
!0;Z(this,this.url.idle);Cc(this,0,0,0);Xb(this,~~(32E3/this.spd))};qa.addItem=function(b){var c=this.inventory;c&&(c[c.length]=b.id,b.sword||b.shield)&&(b.attack&&(this.attack+=b.attack),b.defence&&(this.defence+=b.defence))};qa.showInventory=function(){Fh();for(var b=this.inventory,c=0;8>c;c++){var d=b[c];if(!d)break;var e=ya[c];e.style.backgroundPosition="0px "+48*d.iconID+"px";e.className="";Vf[c]=null}};qa.deleteItem=function(b){this.inventory.quit(b.id);this.attack-=b.attack;this.defence-=b.defence};
qa.useItem=function(b){48==b.type&&(this.health+=b.lives,this.health>this.maxHealth&&(this.maxHealth=this.health),this.inventory.quit(b.id))};qa.onattack=function(b){!this.attack||this.freezed||this.death||this.func!=Hd.url&&this.func||oc(b.id,[this.id],1)};qa.setupINTV=function(b,c,d,e){this.funcObj=c;b.url||P(b,b.url);di(this);this.changeFunc(b.url,e);this.deleteWorker();Xb(this,d);return d};qa.damage=function(b,c){if(!(this.zolotoy||this.death||this.stoned)){this.defence&&(b-=this.defence);1>b&&
(b=1);this.health-=b;c=F[c.kingdom].stats;c.dmgInflicted+=b;var d=F[this.kingdom].stats;d.dmgTaken+=b;1>this.health?(this.build?(d.buildsLosed++,c.buildsKilled++):(d.unitsLosed++,c.unitsKilled++),this.die()):aa(this.id,1)}};var aa=function(b,c){if(tc[b]||!1===b)return b=G.length,1===b?(b=A[G[0]],T.stockActive==b&&b.inventory.length?(Wc(b.id,1,1),Fj(b,1)):b.build?Pa(b,1):Wc(b.id,c)):1<b?Eh(G,c):Rj(gb),!0};qa.setupSpellIMG=function(b){this.invisible&&yd(this.id);this.url.spell&&(Z(this,this.url.spell,
1),b||Ia({func:bk,data:this.id},db(this.img),1))};var bk=function(b){b=A[b];b.death||b.stay()};qa.setupChild=function(b,c,d){var e={x32:this.x32,y32:this.y32,d:b.d,img:b.img,mv:b.mv,parent:this.id,z32:b.z32};if((this.dix||this.diy)&&!this.waiting){var g=.001*(r.now()-this.timestamp);e.x32+=this.dix*g/32-Math.sign(this.dix);e.y32+=this.diy*g/32-Math.sign(this.diy)}if(b.select){if(this.space)b=this.space[this.space.length-1],h=(this.space.length-1)/b;else{b=this.sSizex||1;var h=this.sSizey||1}this.z32&&
(e.z32=this.z32);e.wh=[32*b-3,32*h-3];this.selectAnim=e}Xa(e);g&&Cc(e,this.dix,this.diy,0);d&&(k.bindBuffer(k.ARRAY_BUFFER,ub),k.bufferSubData(k.ARRAY_BUFFER,16*e.bufferID,d));this.tempChild||(this.tempChild=[]);this.tempChild.put(e);c||Rb.new(e,db(e.img),ck);return e};var ck=function(b){A[b.parent].tempChild.quit(b);Sb(b)};qa.distance=0;var Z=function(b,c,d,e){b.img=c;c=Ca[c];var g=c[0],h=c[1];0<=h&&(h*=.001);e&&(h*=e);c=c.id+4*b.d*c[2];e=-1;1===d?e=r.now():0>d&&(e=1);d=e;b=b.bufferID;z[0]=c;z[1]=
d;z[2]=g;z[3]=h;z[4]=c+1;z[5]=d;z[6]=g;z[7]=h;z[8]=c+2;z[9]=d;z[10]=g;z[11]=h;z[12]=c+3;z[13]=d;z[14]=g;z[15]=h;k.bindBuffer(k.ARRAY_BUFFER,kd);k.bufferSubData(k.ARRAY_BUFFER,16*b,z);k.bindBuffer(k.ARRAY_BUFFER,null)};qa.setupDir=function(b,c,d){b=Math.sign(b);c=Math.sign(c);b=3*(c-1)+(b+1);2==b?this.d=1:-6==b?this.d=5:0==b?this.d=7:-4==b?this.d=3:-1==b?this.d=2:1==b?this.d=0:-5==b?this.d=4:-3==b&&(this.d=6);d&&(this.d=(this.d+d)%8)};qa.setupDirBuild=function(b){var c=M;1==b.health&&0==b.built&&(c=
Hb[b.kingdom]);b=b.id;var d=E,e=this.x32+this.y32*d;c[e+d]==b?this.d=0:c[e-d]==b?this.d=4:c[e+1]==b?this.d=2:c[e-1]==b?this.d=6:c[e+d+1]==b?this.d=1:c[e-d+1]==b?this.d=3:c[e+d-1]==b?this.d=7:c[e-d-1]==b&&(this.d=5)};qa.spdMod=0;var lh=function(b,c){for(var d=c.length,e=0;e<d;e++){var g=A[c[e]];g.build||(g.spd=b)}};qa.changeFunc=function(b,c){var d=this.func;this.func=b;if(Nd){if(void 0!==this.workingOn)var e=A[this.workingOn];(d=Yb[d])&&d.rule&&Sg(-1,this,d.rule,e);(b=Yb[b])&&b.rule&&Sg(1,this,b.rule,
c)}};qa.stay=function(b){this.mv=1;this.time=void 0;this.diy=this.dix=0;this.nodes=this.c=void 0;this.xf=null;Cc(this,0,0,0);b||(this.changeFunc(void 0),this.stock&&0!==this.stock[0]?Z(this,this.img,NaN):Z(this,this.__proto__.img,1),this.buildList&&(this.buildList=void 0),this.deleteWorker(),this.standardFunc&&2!==this.stop&&void 0==this.spy&&this.standardFunc(this))};qa.stay55=function(){this.changeFunc(void 0);this.stock&&0!==this.stock[0]?Z(this,this.img,NaN):Z(this,this.__proto__.img,1);this.deleteWorker();
this.standardFunc&&2!==this.stop&&void 0==this.spy&&this.standardFunc(this)};var Il=[],Sb=function(b){b.elemtId&&(dk(b.elemtId,b.typeBuffer),b.elemtId=void 0,b.typeBuffer=void 0)},Xi=function(b){if(b.childLoc){b=b.childLoc;for(var c=0,d=b.length;c<d;c+=2)dk(b[c+1],b[c])}},dk=function(b,c){c[b]=NaN;c[b+1]=NaN;c[b+2]=NaN;c[b+3]=NaN;c[b+4]=NaN;c[b+5]=NaN;c.changed=!0;Il.put(b)};qa.addWorker=function(b){this.workers.put(b.id);b.workingOn=this.id};qa.deleteWorker=function(){this.workingOn&&(A[this.workingOn].workers.quit(this.id),
this.workingOn=0);this.actionItem&&(this.actionItem=void 0);this.blockedAction()};qa.blockedAction=function(b){var c=this.blocked;if(ek[c])ek[c](this,b)};var ek={2:function(b,c){b.blocked=void 0;rc(b);ck(b.blockedimg);b.blockedimg=void 0;b.manaTarget=void 0;c||(F[b.kingdom].setupResources(b.blockedCost,-1),b.blockedCost=void 0)}},xj=function(b){return l.delay[-b[1]+b[0]-1]},de=function(b){var c=G.length;G.quit(b);if(c!=G.length){var d=A[b];d.selectAnim=void 0;c=0;for(d=d.tempChild;c<d.length;c++){var e=
d[c];Sb(e);var g=d.length;d.quit(e);g!=d.length&&c--}tc[b]=void 0;0==G.length?xe():1==G.length?Wc(b):Eh(G)}gb&&gb.id===b&&(xe(),gb.selectAnim&&(Sb(gb.selectAnim),gb.selectAnim=void 0),gb=void 0)};qa.base=function(b){return eb[this.zLevel][b]};qa.rbase=function(){return eb[this.zLevel]};var Of,Ch=function(b){Ib.put(b.bufferID);if(b.child){var c=0;b=b.childLoc;for(var d=b.length;c<d;c+=2)Ib.put(b[c][b[c+1]])}};qa.die=function(b){if(!this.death){var c=E,d=this.id,e=this.kingdom,g=F[e];this.waitlist&&
(g.unitLoading-=.5*this.waitlist.length);if(this.dieSound&&!r.editor){var h=this.dieSound;pa(h[~~(h.length*Math.random())],this.x32,this.y32)}de(this.id);(this.freezed||this.invisible)&&rc(this);var m=this.x32,k=this.y32;this.death=1;1==this.zLevel&&(Of[m+k*c]=1);this.c=void 0;var v=this.url.die||this.dimg;void 0!=g.IAD&&Ka.arr[g.IAD].valorateLost(this);if(this.food&&!r.editor){var q=100,p=this.food/q,u=~~p,t=~~((p-u)*q);for(h=0;h<p;h++){h==u&&t&&(q=t);var w=aj(m,k),x=~~(w/c);w%=c;w=new Sc(52,e,w,
x,0);Z(w,l.item_meat);w.contain=[q,2,dl]}}g.stats.unitCountDeath[this.type]++;h=this.x32;c=this.y32;b||r.editor?(Sb(this),Ch(this)):v?(this.mv=!0,Z(this,v,1),b=Ca[this.img],v=b[1],v=0>v?xj(b):1E3*b[0]/v,Ia({func:wj,data:this.id},v-25,1),Cc(this,0,0,0),void 0!==this.dix&&(b=.001*(r.now()-this.timestamp),this.x32+=this.dix*b/32-Math.sign(this.dix),this.y32+=this.diy*b/32-Math.sign(this.diy))):this.dimgInfinity?(this.dimgRND&&(this.d=this.id%this.dimgRND),Z(this,this.dimgInfinity)):(Sb(this),Ch(this));
Xi(this);this.techStart&&lf(0,[this.id]);Ra(this,32*this.y32-36);this.x32=h;this.y32=c;this.build||g.values.pop--;this.population&&this.built&&(g.values.popMax-=this.population);k=this.validator(m,k,this.space,this.kingdom);b=k[0];if(this.onbuild&&!r.editor)for(m=this.onbuild,v=g.technology,h=v.disabled,v=v.actived,c=0;c<m.length;c++)e=m[c].id,v[e]--,0===v[e]&&h[e]++;m=this.validator.dimension;h=0;for(v=b.length;h<v;h++)c=b[h],m[c]=ec[c]?ec[c]:0;if(1==this.health&&!this.built)for(c=Hb[this.kingdom],
h=0,v=b.length;h<v;c[b[h++]]=void 0);if(k[2])for(b=k[2],h=0,v=b.length;h<v;h++)c=b[h],ec[c]?(2<m[c]&&A[m[c]].die(1),m[c]=ec[c]):(2<m[c]&&A[m[c]].die(),m[c]=0);lb[this.kingdom][this.type].quit(this.id);di(this);if(this.workers){h=0;m=this.workers.slice(0);for(v=m.length;h<v;h++)k=A[m[h]],k.workingOn===d&&(k.workingOn=0,k.func!==ih.url&&k.stay());this.workers.length=0}this.deleteFromList&&(m=this.deleteFromList,m.quit(this),m.length||m.length0function(this));this.time=void 0;this.changeFunc(void 0);
this.diy=this.dix=0;this.inventory&&0<this.inventory.length&&wd(this.id,this.inventory.slice(0));this.stock&&$i(this);r.editor||(g.check(),Zd(this.kingdom),g.checkPopArray());this.deleteWorker()}};Array.prototype.quit=function(b){b=this.indexOf(b);return-1<b?(this.splice(b,1),!0):!1};Array.prototype.add=function(b){0>this.indexOf(b)&&(this[this.length]=b)};var Za=["European","Arab","Asian"];x={open:"Open",loading:"Loading...",systemAlert:"System Message",notEnough:"Not enough %s",ok:"OK",yes:"Yes",
no:"No",secure:"Are you sure?",gold:"Gold",stone:"Stone",wood:"Wood",food:"Food",mana:"Manna",warning:"Warning",play:"PLAY",close:"CLOSE",gameClosed:"The game was canceled by the server.",loadgraphics:"Downloading graphics...",waitImages:"Downloading graphics",wait:"Wait",audioproblem:"Your browser is not compatible with Web Audio",defeated:"DEFEATED",victorious:"VICTORIOUS",options:"OPTIONS",refresh:"Refresh",back:"BACK",paused:"PAUSED",chatMsg:"CHAT MESSAGE",disconnect:"Disconnect",playerDisconnected:"%s has disconnected!",
connectionError:"Connection error",noP2P:"Engine not loaded",startingResources:"Starting Resources",mapSize:"Map Size",menu:"MENU",quit:"QUIT",downloadAll:"Download all",continue:"Continue",backToGame:"BACK TO GAME",initializing:"Initializing...",requires:"Requires",stop:"Stop",pickItems:"Pick items",move:"Move",stand:"Stand ground",explore:"Explore",patrol:"Patrol",guard:"Guard",errorLoading:"Error loading game.",waitingPlayers:"Waiting for players to connect",musicVolume:"Music Volume",soundVolume:"Sound Volume",
common:"Common",popLimit:"Population limit reached",houseLimit:"Not enough houses",lightning:"Lightning",freeze:"Freeze",bless:"Bless",heal:"Heal",invisibility:"Invisibility",dcm:"Dig, chop or mine",repair:"Repair building",menuBuild:"See what you can build",units:"Units",infinite:"Infinite",gameFull:"Sorry, the game is full.",terrainOption:"Terrain",playerDefeated:"%s has been defeated!",savegame:"SAVE GAME",loadRecord:"Recording",stats:"Stats",builds:"Builds",items:"Items",nature:"Nature",trees:"Trees",
delete:"Delete",create:"Create",username:"Player Name",gameOptions:"GAME OPTIONS",nplayers:"Number of Players",gameName:"Enter Game Name",gamesFound:"Games Found",strSearch:"SEARCH| Search for existing games",strCreate:"CREATE| Create a game",randomMap:"RANDOM MAP",strcusMap:"CUSTOM MAP",strSettings:"SETTINGS",mapMaking:"Map Making",terrain:"Terrain",save:"SAVE",accept:"ACCEPT",team:"Team",color:"Colour",offlinePlay:"For playing offline",AI:"AI Assist",kingdom:"Kingdom",attack:"Attack",defence:"Defence",
health:"Health",maxHealth:"Max health",playing:"Playing",waiting:"Waiting",joining:"Joining...",random:"Random",cancel:"CANCEL",rules:"Rules",events:"Events",actions:"Actions",objAction:"Object action",destroyObj:"Destroy object",defined:"Defined",undefined:"Undefined",destroy:"Destroy",capture:"Capture",moving:"Moving",add:"Add",objOrder:"Order",objZone:"Object in zone",zone:"Zone",editMap:"Edit",mapName:"Map name",description:"Map Description",author:"Author",fullscreen:"Automatic full screen"};
var Si={euro:"Lancelot Arthur Guivain Merlin Blackthorn Morin Golstuck Karambol Kelerick Rockmore Bridport Casevil Stirm Tonis Pelegrim Peresohn Pirk Pharn Gork".split(" "),arab:"Ibn Fadlan;Mohammad;Al Ferissa;Harun Al Rashid;Sindbad;Mellemad;Moarrac;Sakhavan;Bellefars;Mokhac;Norahz;Kerhetin;Maham;Dushesh;Direkh".split(";"),asia:"Ishida Toranaga Ichinzen Haiako Mozuki Hitachi Tosheba Harachiko Marasuma Korodzum Ishinghen Genghis Musa Echibo Ichikahr Yotokan Maraga".split(" "),common:"Fistantilus Skenderbeg Raislin Tenis Morok Sokob Baras Haram Billihz Ynte Orgh Savael Birgos Savator Gandeh Gordor Fessh Gilmi Phergas".split(" ")},
Fg=[x.gold,x.wood,x.food,x.stone,x.mana],Ad=function(b,c,d){d&&(b=b.replace("%d",d));return b.replace("%s",c)},Dd={},Oh,uc,cc={},vg=function(){for(var b="mapx mapwidth goldRes goldValue woodRes woodValue foodRes foodValue stoneRes stoneValue infinity infiniteValue".split(" "),c=0,d=b.length;c<d;c+=2){var e=document.getElementById(b[c+1]).value;"infinity"==b[c]?(e=document.getElementById(b[c+1]).checked,r[b[c]]=e):r[b[c]]=parseInt(e)}r.infinity&&(r.goldRes=Infinity,r.foodRes=Infinity,r.woodRes=Infinity,
r.stoneRes=Infinity);r.mapy=r.mapx;r.gravity=parseFloat(document.getElementById("mapgravity").value)*(580.9/9.8);r.name="";r.arje=555555*Math.random()+1},Lk=function(){r.online&&(fk(x.initializing),r.editor=0);r.mapx||vg();r.pausedTime=0;r.canceled=0;for(var g=Object.keys(b),c=F.length,d=0,e=g.length;d<e;d++){var f=b[g[d]];f.id=d;if(f.disabled)for(var h=0;h<c;F[h++].technology.disabled[d]=f.disabled);if(f.hidden)for(h=0;h<c;F[h++].technology.hidden[d]=1);}var m=performance.now();cd=document.getElementById("msgs1");
r.online||(location.hash="");Aa("playermenu");Aa("index");Ta("menu");Ta("statButton");Aa("mapeditorinfo");Aa("mapeditorinfotop");Ta("resources");Gb=F[w.kingdom];tf(w.kingdom);Oh||(Oh=JSON.parse(JSON.stringify(F.slice(1))));setTimeout(function(){r.cycle?r.deltaTime=25*r.cycle:(r.players=F.length-1,r.date=Date.now(),r.cycle=0,r.kingdoms=F,r.deltaTime=0);r.loadDate=Date.now();r.online||wh();r.now=Ki;r.paused=0;r.pausedTime=0;r.zMax=96*r.mapy;$b();var c=performance.now();r.allow14=!0;E=r.mapx;va=r.mapy;
r.temperature=25;var d=r.temperature;0==w.temperature&&(d+="&deg;C");document.getElementById("temperature").innerHTML=d;ba=1;Jl();xe();Of={};var e=E,g=-e,f=+e;ac=[1,1+g,g,-1+g,-1,-1+f,f,f+1];Li=[g,-1,1,f];r.online&&Ta("content");for(var h=["chat","loading","playermenu","index"],B=h.length,C=0;C<B;document.getElementById(h[C++]).style.display="none");t("loadingtext").innerHTML="Loading terrain";c=performance.now();if(!1!==r.arje){var G=performance.now(),H=E,I=H*va,K=Math.sqrt(I),L=0,O=0,R=0,S=0,T=
0,V=0,Y=0,Z=0,W=0,aa=0,fa=0,ha=0,ia=0,la=100,oa=255,qa=0,pa=0,ka=0,ra=new Int8Array(new ArrayBuffer(I)),na=new Uint32Array([2,3,0,1,1,1,0,1,0,1,0,1,1,1,1,0,0,15,0,1]);for(il(r.arje);W<I;ra[W++]=0);var xa=na.length;for(W=0;W<xa;W+=4)na[W+3]&&(na[W+1]=~~(K/na[W+1]));for(aa=0;aa<xa;aa+=4)for(la=na[aa+1],oa=na[aa],qa=na[aa+2],W=0;W<la;W++)for(ha=~~(ja()*I+.5),T=6*ja()-3,V=6*ja()-3,qa?(Z=ja()*K,ka=~~(ja()*(K/15))+4,Y=~~(100*ja())/4,pa=ka/12):(Z=128*ja(),ka=~~(2.56*ja())+4,Y=~~(100*ja())/2,pa=1),L=ha%H,
O=~~(ha/H),fa=0;fa<Z;fa++)for(100*ja()>Y&&(T=(6*ja()-3)*pa,V=(6*ja()-3)*pa),L+=T,O+=V,R=0;R<ka;R++)for(S=0;S<ka;S++)(R-ka/2)*(R-ka/2)+(S-ka/2)*(S-ka/2)<ka*ka/4&&(ia=~~L+R+(S+~~O)*H,ia>=I?ia%=I:0>ia&&(ia+=I),ra[ia]=oa);var za=performance.now();P("randomtxt1",za-G);P("drawTerrain: ",performance.now()-za);uc=ra}else uc=r.terrain?new Int8Array(r.terrain):new Int8Array(E*va);cc.randomtxt=performance.now()-c;P("randomtxt: ",cc.randomtxt);c=performance.now();t("loadingtext").innerHTML="Creating map";var ya=
E*va*4;M=new Uint32Array(new ArrayBuffer(ya));Ja=new Uint32Array(new ArrayBuffer(ya));ad=new Uint32Array(new ArrayBuffer(ya));hc={};N.dimension=M;ze.dimension=Ja;Wj.dimension=M;Xj.dimension=Ja;U.dimension=M;$f.dimension=ad;bc.dimension=Ja;Zf.dimension=M;eb[0]=Ja;eb[1]=M;eb[2]=ad;cc.createMap=performance.now()-c;P("createMap: ",cc.createMap);t("content").style.display="block";c=performance.now();P(r.allunits);if(!1===r.arje||r.allunits)D=r.allunits;else{var Aa=uc,ta=r.mapx,La=r.mapy,Pa=performance.now(),
ua=0,Da=0,Ua=0,Ha=0,Ia=0,Ea=ta*La,Sa=Math.sqrt(Ea);Da=Ea;D=[];Ed={};var Ma=Kl,Ya=Ll,Za=Ed,$a=Ml,ab=[12,63,62],Ba=[];Da=F.length;for(ua=1;ua<Da;ua++){for(var Va=!0,Wa=F[ua],gb=ab[Wa.race],ca=0;Va&&25>ca;){ca++;Ha=~~(ja()*(ta-15)+.5)+4;Ia=~~(ja()*(La-15)+.5)+4;Va=!1;Ua=Ba.length;for(var kb=0;kb<Ua;kb+=2)60>Math.sqrt((Ha-Ba[kb])*(Ha-Ba[kb])+(Ia-Ba[kb+1])*(Ia-Ba[kb+1]))&&(Va=!0);Va||(Ba.push(Ha+4,Ia+3),Ma(Ha+Ia*ta,{type:gb,kingdom:ua}))}if(25==ca){F.length=ua;break}}var db=2*(Da-1);Da=1*~~(Sa/3.2);for(ua=
0;ua<Da;ua++){var lb=~~(ja()*ta+.5);var mb=~~(ja()*La+.5);var pb=~~(25*ja())+10;var qb=~~(25*ja())+10;for(Wa=0;55>Wa;Wa++){Ha=~~(ja()*pb+~~(lb+18*ja()-9)+.5);Ia=~~(ja()*qb+~~(mb+18*ja()-9)+.5);var Oa=Ha+Ia*ta;Ya(Oa)&&Oa<=Ea&&Ma(Oa,{type:7,d:~~(28*ja()+3)})}}Da=40*~~(Sa/256);for(ua=0;ua<Da;ua++){Oa=~~(ja()*Ea+.5);var Qa=Kh[~~(ja()*Kh.length)],Ka=Object.assign({},Qa);Ka.d+=~~(Qa.dMax*ja());if(Qa.sword||Qa.potion)Ka.attack=~~(6*ja())+1;if(Qa.shield||Qa.potion)Ka.defence=~~(6*ja())+1;if(Qa.book){var ob=
~~(ja()*bg.length);Ka.spell=bg[ob];Ka.iconID=b[bg[ob]].iconIDbook;Ka.name=x[Ka.spell];Ka.attack=~~(6*ja())+1}Ma(Oa,Ka)}Da=3*~~(Sa/256);for(ua=0;ua<Da;ua++)Oa=~~(ja()*Ea),Ya(Oa)&&Ma(Oa,{type:43});var tb=!!r.infinity;for(kb=0;kb<db*(1-tb);kb+=2){var rb=2*Math.round(ja())-1;var Ra=Ba[kb]+10*(2*Math.round(ja())-1)+~~(3*ja());var Ga=Ba[kb+1]+10*rb+~~(3*ja());var cb=Ba[kb]+10*(2*Math.round(ja())-1)+~~(3*ja());var wb=Ba[kb+1]+10*-rb+~~(3*ja());0>Ra?Ra=0:Ra+4>E&&(Ra-=(Ra+4)%Ea);0>Ga?Ga=0:Ga+4>va&&(Ga-=(Ga+
4)%Ea);0>cb?cb=0:cb+4>E&&(cb-=(cb+4)%Ea);0>wb?wb=0:wb+4>va&&(wb-=(wb+4)%Ea);Ma(Ra+Ga*ta,{type:21});Ma(cb+wb*ta,{type:22})}for(kb=0;kb<db;kb+=2)for(Ra=Ba[kb]-25,Ga=Ba[kb+1]-25,cb=0;50>cb;cb++)for(wb=0;50>wb;wb++)if(625>(cb-25)*(cb-25)+(wb-25)*(wb-25)){var bb=cb+Ra+(wb+Ga)*ta;7===$a(bb).type&&(D.quit(Za[bb]),Za[bb]=void 0);1===ic.type[Aa[bb]]&&(Aa[bb]=0)}P("random:",performance.now()-Pa);cc.random=performance.now()-Pa}r.movtable&&!r.demo&&(Pc=r.movtable,Qc=r.movtable2);var Gb=performance.now();t("loadingtext").innerHTML=
"Loading textures";Gk(uc);cc.setupGL=performance.now()-Gb;P("setupGL: ",cc.setupGL);for(var jb=performance.now(),zb=uc,Lb=ic.type,Mb=E*va,Qb=0;Qb<Mb;Qb++)Lb[zb[Qb]]?(Ja[Qb]=1,M[Qb]=1,ec[Qb]=1):0>zb[Qb]&&(ec[Qb]=2,Ja[Qb]=2,M[Qb]=2);var vb=D;if(!r.custom&&vb){for(var Ob=r,Bb=vb,Db="kingdom d type img x32 y32 name iconID attack defence level health maxHealth func funcObj workers workingOn inventory dix diy timestamp working rnd techID techStart activeTech levelProgress c mimg built xf yf action point waitlist mv work death freezed confused sword shield book spy".split(" "),
Eb={},nb=0;nb<Db.length;nb++)Eb[Db[nb]]=nb;var Hb=[],Sb=Bb.length;for(nb=0;nb<Sb;nb++){var Nb=Bb[nb],Ab=Object.keys(Nb),Pb={};Hb.put(Pb);for(var yb=0,Xb=Ab.length;yb<Xb;yb++)Pb[Eb[Ab[yb]]]=Nb[Ab[yb]]}Ob.ini=Hb}r.demo&&(vb=r.ini);if(vb){Qb=0;for(var Zb=vb.length;Qb<Zb;Qb++){var hb=vb[Qb];if(hb.death)A.put(hb);else if(!hb.cancell){var Tb=hb.x32,Ub=hb.y32,Vb=!1===hb.built&&1===hb.health?!0:!1,Wb=hb.kingdom||0,Yb=new Sc(hb.type,Wb,Tb,Ub,0,Vb,hb);Vb||cj(Yb);Yb.castle&&(F[Wb].origin=[Tb+4,Ub+3])}}}Ed=D=
null;P("positioned:",performance.now()-jb);cc.positioned=performance.now()-jb;cc.setupGL=performance.now()-c;P("setupGL: ",cc.setupGL);Xa(ib);Xa(X);Zd(w.kingdom);Aj();gk();window.addEventListener("keydown",Kj);window.addEventListener("keyup",Lj);window.addEventListener("mousemove",Mj);Q=sb;J=new Float32Array(12);var Cb=Ca[l.blank].id;z[0]=Cb;z[1]=0;z[2]=1;z[3]=0;z[4]=Cb;z[5]=0;z[6]=1;z[7]=0;z[8]=Cb;z[9]=0;z[10]=1;z[11]=0;z[12]=Cb;z[13]=0;z[14]=1;z[15]=0;var xb=sa;xb[0]=0;xb[1]=1;xb[2]=2;xb[3]=1;xb[4]=
2;xb[5]=3;k.bindBuffer(k.ARRAY_BUFFER,kd);k.bufferSubData(k.ARRAY_BUFFER,0,z);k.bindBuffer(k.ARRAY_BUFFER,ub);var Rb=3*w.kingdom,Fb=Fa[Rb],Ib=Fa[Rb+1],Jb=Fa[Rb+2];k.bufferSubData(k.ARRAY_BUFFER,0,new Float32Array([Fb,Ib,Jb,.5,Fb,Ib,Jb,.5,Fb,Ib,Jb,.5,Fb,Ib,Jb,.5]));var Kb=96*E;J[2]=Kb;J[5]=Kb;J[8]=Kb;J[11]=Kb;window.addEventListener("mousedown",Nj);window.addEventListener("mouseup",Oj);P("FULL: ",performance.now()-m);r.record||(r.record={});r.online?(pd(Me(),x.waitingPlayers,1),w.admin?dd():ea(dd,
0,0)):cg();r.allow14=!1;bd.list.push(0,JSON.stringify(cc))},300)},Me=function(){for(var b=I.length,c=I,d="",e=0;e<b;e++)Me.obj[c[e].id]||c[e].id==w.onlineID||(d+="<br>"+c[e].name);return d};Me.obj={};var ji=function(){return w.gl?!1:(pd("You can't run WEBGL 2<br>More info <a href='http://webglreport.com/?v=2'>here</a>","Error"),Wb(),!0)},ug=!1,Nd,Kk=function(b){var c={};Nd={events:{defined:c,nodefined:{}}};for(var d={moving:1},e=0,g=0,h=b.length;g<h;g++){var m=b[g];m.activeEvents=0;for(var k=m.events,
l=0,q=k.length;l<q;l++){var p=k[l];p.id=e++;var u=p.list,r=p.to,t=p.type,w=p.zone;p.rule=m;for(var x=p.activeEvents=0,B=u.length;x<B;x++){var z=u[x];c[z]||(c[z]={});z=c[z];if(d[t])z[t]||(z[t]=[]),z[t].put(p);else if("zone"==t){z[t]||(z[t]=[]);for(var A=0;A<w.length;A++)z[t].push(p,w[A][0],w[A][1],w[A][2],w[A][3])}else{z[t]||(z[t]={defined:{}});z=z[t].defined;A=0;for(var C=r.length;A<C;A++)z[r[x]]||(z[r[x]]=[]),z[r[x]].put(p)}}}}},Aj=function(){var b=document.getElementById("playersinfo");b.innerHTML=
"";if(!r.editor)for(var c=1,d=F.length;c<d;c++){var e=F[c],f=e.death?e.name.strike():e.name;b.innerHTML+=f+"<span id='score"+c+"'> 0/0</span><div class='playercolor' style='background:rgb("+e.color[0]+","+e.color[1]+","+e.color[2]+")'></div><br>"}},gk=function(){var b=window.innerWidth-w.mx,c=window.innerHeight,d=F[w.kingdom].origin;d?(b=32*d[0]-.5*b,c=32*d[1]-.5*c):c=b=0;nd(~~b,~~c)},we,Sj,Hj,Jl=function(){var b=document.getElementById("selectedobject").getContext("webgl",{antialias:!1,depth:!1}),
c=b.createShader(b.VERTEX_SHADER);b.shaderSource(c,"void main() {\ngl_Position = vec4(0 ,0, 0, 1);\ngl_PointSize=48.0;\n}");b.compileShader(c);var d=b.createShader(b.FRAGMENT_SHADER);b.shaderSource(d,"precision mediump float;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nuniform float txtCoord;\nvoid main() {\ngl_FragColor = texture2D(u_image, (vec2(\tmod(txtCoord,21.0) ,floor(txtCoord/21.0) ) + gl_PointCoord)*(0.046875));\nif(gl_FragColor.r==gl_FragColor.g&&gl_FragColor.r==gl_FragColor.b) gl_FragColor*=u_color;\n}");
b.compileShader(d);var e=b.createProgram();b.attachShader(e,c);b.attachShader(e,d);b.linkProgram(e);b.useProgram(e);c=b.createTexture();b.bindTexture(b.TEXTURE_2D,c);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texImage2D(b.TEXTURE_2D,0,b.RGB,b.RGB,b.UNSIGNED_BYTE,T.icons);var f=b.getUniformLocation(e,"u_color"),
h=b.getUniformLocation(e,"txtCoord");we=function(c){if(Ca[c.img][3]){var d=c.kingdom;b.uniform4f(f,Fa[3*d],Fa[3*d+1],Fa[3*d+2],1)}else b.uniform4f(f,1,1,1,1);b.uniform1f(h,c.iconID);b.drawArrays(b.POINTS,0,1)};Sj=function(){b.uniform4f(f,1,1,1,1);b.uniform1f(h,189);b.drawArrays(b.POINTS,0,1)};Hj=function(){b.uniform1f(h,0);b.uniform4f(f,0,0,0,0);b.drawArrays(b.POINTS,0,1)}},Tb=128,Ob=128,A=[{terrain:1},{terrain:1},{terrain:1}],ec={},Zd=function(b){b===w.kingdom&&(b=Gb.values.popMax<Gb.values.popLimit?
Gb.values.popMax:Gb.values.popLimit,document.getElementById("pop").innerHTML=Gb.values.pop+"/"+b)};window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(b){window.setTimeout(b,1E3/60)}}();var Ed=D=void 0;var Kl=function(b,c){Ed[b]||(c.x32=b%E,c.y32=~~(b/va),D.put(c),Ed[b]=c)},Ll=function(b){return!D[b]},Ml=function(b){return Ed[b]||NaN},Ma=[];window.addEventListener("offline",function(b){Ue("Offline",
"#ff0000")});window.addEventListener("online",function(b){Ue("Online","#00ff00")});var Ph=function(){Ua.leaveRoom();Ma.length=0},Fd={};(function(){for(var b=["returnmenu","index","Account","accountIframe"],c=0,d=b.length;c<d;Fd[b[c]]=document.getElementById(b[c++]));})();var Nl=function(){location.replace("#"+this.gameID+"Room")},pi=function(b){Ma=[];P("connecting to",b,x.loading);t("game").style.display="block";t("gameName").innerHTML=x.loading;t("returnmenu").style.display="none";t("index").style.display=
"none";vc.innerHTML="";cd.innerHTML="";w.p2p?(Ua.joinRoom(b,xg),sg()):(Ua||mc(),mc.func=function(){pi(b)})},Ol=function(b){t("game").style.display="none";I.length=0;r.online=0;Ph();Wb();b.constructor==String&&pd(b)},zj={euro:0,arab:0,asia:0},mi=function(b,c,d){if(d){c=Qh(d.id);var e=c[1];c=c[0];b=qb(b);c.username||(hk[e].innerHTML=b,c.name=b,d.username=b,fk(x.joining,b,1E3))}},tb=function(b,c){if(c.resend)if(b.destinatary)(c=ed(b.destinatary))&&c.id!=w.onlineID&&(b.bridge=h.id,c.send(b));else{c=c.resend;
for(var d=0,e=c.length;d<e;d++){var g=c[d];b.bridge=h.id;g.send(b)}}else{var h=c;b.bridge&&(h=ed(b.bridge));if(void 0===b.length){if(void 0!==b.func)(0,ef[b.func])(b[1],b[2],h)}else c=b[0],h.orderList[c]=b,tb.done[c]||(tb.done[c]=0),tb.done[c]++,tb.done[c]==Ma.length&&tb.func&&(tb.func=!1,Vg(),$b())}};tb.done=[];var fd=function(b,c,d){d&&(P(d.id,"CAN connect"),fd.ids[b]||(fd.ids[b]=1,w.admin||clearTimeout(fd.intv[b]),P("MAKE BRIDGE"),ed(b).bridge=d,ea(ik,b,0,[d],0)))};fd.ids={};fd.intv={};var ik=
function(b,c,d){d&&(P("BRIDGE"),d.resend||(d.resend=[]),d.resend.put(ed(b)))},ed=function(b){for(var c=0,d=Ma.length;c<d;c++){var e=Ma[c];if(e.id==b)return e}},Ua,jk=function(b){if(!t("usernameForm")){Pb();var c=localStorage.name||"Guest",d=localStorage.color||"#"+Math.floor(16777215*Math.random()).toString(16),e=document.createElement("div");e.id="usernameForm";e.innerHTML="\n            <div>\n            <h2>"+x.username+'</h2>\n            <div>\n<input type="color" id=\'usernameColor\' value="'+
d+'" /><input id=\'usernameVal\' type="text" value="'+c+'" />\n</div>\n<br />\n</div>';c=document.createElement("button");c.innerHTML=x.continue;c.onclick=function(){w.name=qb(t("usernameVal").value);w.color=t("usernameColor").value;localStorage.color=w.color;localStorage.name=w.name;document.body.removeChild(t("usernameForm"));b();Ya()};e.children[0].appendChild(c);document.body.appendChild(e)}},mc=function(){ji()||(w.name?(Qk(),Ua=new SimpleWebRTC({localVideoEl:"",remoteVideosEl:"",autoRequestMedia:!1,
receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},url:"https://solar.tza.red/"}),Ua.on("channelMessage",function(b,c,d){"nehhof"==d.type&&(c=JSON.parse(d.payload),tb(c,b))}),Ua.on("error",function(b){"full"==b&&(Wb(),Ue(x.gameFull,"#ff0000"))}),Ua.on("connectionReady",function(b){var c=Ua.connection.connection;w.p2p=c;c.username=w.name;c.color=w.color;c.on("getRooms",function(b){var c=Object.keys(b),d=t("gameList");if(0<c.length){d.innerHTML="";for(var g=0,m=c.length;g<m;g++){var k=c[g],
l=b[k],q=l.len;if(q){var p=document.createElement("tr"),r="";r=l.playing?r+("<td><div class='redCircle'></div>"+x.playing+"</td>"):r+("<td><div class='redCircle' style=\"background:rgba(0,255,0,.8)\"></div>"+x.waiting+"</td></td>");r+="<td>"+qb(l.description)+"</td><td>"+~~((Date.now()-l.date)/6E4)+" min ago</td><td>"+qb(q)+"/"+qb(l.max)+"</td>";p.innerHTML=r;p.gameID=k;l.playing||(p.onclick=Nl);d.appendChild(p)}}}else d.innerHTML="<tr><td>No games found</td></tr>"});w.onlineID=b;mc.func&&mc.func()}),
Ua.on("createdPeer",function(b){r.started||Mk(b)})):jk(mc))},Pl=function(){sg();Ya();t("game").style.display="block";t("gameName").innerHTML=x.loading;t("returnmenu").style.display="none";t("index").style.display="none";vc.innerHTML="";cd.innerHTML="";Ma=[];ni();w.admin=1;w.room={description:t("gameFormName").value,max:parseInt(t("gameMax").value),public:!0};2>w.room.max&&(w.room.max=2);14<w.room.max&&(w.room.max=14);localStorage.gameDescription=w.room.description;Ua.createRoom(w.onlineID+"b",xg);
r.online=1;document.body.removeChild(t("gameForm"))},kk=function(){Ua||mc();if(w.onlineID){Pb();var b=localStorage.gameDescription||w.name+"'s room",c=document.createElement("div");c.id="gameForm";c.innerHTML="\n<div>\n            <h2>"+x.gameOptions+"</h2>\n            "+x.gameName+': <input id=\'gameFormName\' type="text" value="'+b+'" maxlength="29" /><br />\n'+x.nplayers+': <input id="gameMax" type="number" value="6" max="14" min="2"/><br />\n            </div>';b=document.createElement("button");
b.innerHTML=x.continue;b.onclick=Pl;c.children[0].appendChild(b);document.body.appendChild(c)}else setTimeout(function(){location.hash=""},200),mc.func=kk},lk=function(b){for(var c="kingdom d type img x32 y32 name iconID attack defence level health maxHealth func funcObj workers workingOn inventory dix diy timestamp working rnd techID techStart activeTech levelProgress c mimg built xf yf action point waitlist mv work death freezed confused sword shield book spy".split(" "),d=[],e=b.length,g=0;g<e;g++){var h=
b[g],m=Object.keys(h),k={};d.put(k);for(var l=0,q=m.length;l<q;l++)k[c[m[l]]]=h[m[l]]}return d},Ql=function(b){for(var c=b.length,d=new Uint8Array(c),e=0,g=-1,h=0,m=0;m<c;m++){var k=b[m];if(g===k)h||(d[e++]=255),h++;else{if(h){if(4>h){e--;for(var l=0;l<h;l++)d[e++]=g}else d[e++]=h>>8&255,d[e++]=h&255;h=0}d[e++]=k}g=k}if(h)if(4>h)for(e--,l=0;l<h;l++)d[e++]=g;else d[e++]=h>>8&255,d[e++]=h&255;return d.slice(0,e)},mk=function(b,c){c=JSON.stringify(c);b.sendDirectly("channelMessage","nehhof",c)},Ne=[],
ea=function(b,c,d,e,f){var g;if(!0===f&&r.online&&Ma.length)d.change&&(d=d.slice(0)),Ba(function(){ea(b,c,d,e,55)});else if(void 0===b.location)b();else{if(r.started&&!r.editor){var m=r.record;m[r.cycle]||(m[r.cycle]=[]);var k=m[r.cycle];m=k.length;k[m]=b.location;k[m+1]=c;d.length&&(d=d.slice(0));k[m+2]=d}if(r.online&&Ma.length)if(55===f&&(g=!1),k={func:b.location,1:c,2:d,active:g,rnd:4294967296*Math.random()},r.started&&b!=$b&&b!=cg&&b!=nb)if(e)for(m=0,g=e.length;m<g;m++)f=e[m],k.destinatary=f.id,
f.bridge?mk(f.bridge,k):mk(f,k);else Ne.put(k);else Rh(k),b(c,d);else b(c,d)}},Rl=function(){if(Ma.length){vg();dd.i=0;w.p2p.emit("gameStarted");for(var b={},c=0,d=I.length;c<d;c++)b[I[c].id]=c;ea(Sh,r,b,0,0)}},dd=function(b,c,d){d&&(Me.obj[d.id]=1,b=Me(),""==b?pd(b,x.loading,1):pd(b,x.waitingPlayers,1));w.admin&&(dd.i++,dd.i==I.length&&setTimeout(function(){ea(cg,0,0,0,!0)},100))};dd.i=0;var Rh=function(b){b=JSON.stringify(b);for(var c=0,d=Ma.length;c<d;c++)Ma[c].sendDirectly("channelMessage","nehhof",
b)},gd,Th,Vg=function(){if(!tb.done[gd]||tb.done[gd]<Ma.length)return tb.func=!0,$b(),!0;for(var b=0,c=I.length;b<c;b++){var d=ed(I[b].id);if(b==w.kingdom-1)var e=Th;else{if(!d)continue;e=d.orderList[gd]}for(var f=1,h=e.length;f<h;f++){var m=e[f];ef[m.func](m[1],m[2],d)}}tb.func=!1;Rh(Ne);Th=Ne;gd++;Ne=[gd+1];return!1},cg=function(){document.getElementById("alert").style.display="none";r.started=1;r.date=Date.now();$b();Ha();Ya();gd=0;if(!r.custom||r.demo)for(var b=1,c=F.length;b<c;b++){var d=mb[vh[F[b].race]],
e=d.peasant.type;if(d=A[lb[b][d.castle.type][0]])Rc(e,d,1),Rc(e,d,1),Rc(e,d,1)}Ka.arr=[];Ka.units=[];Ka.time=500;Ka.steps=0;Ka.process=0;if(!r.editor&&!r.demo){for(b=1;b<F.length;b++)F[b].IA&&r.infinity&&new Ka(F[b]);b=0;c=Ka.arr;for(e=c.length;b<e;c[b++].leaveMeAloneIKnowWhatToDo());Og()}r.online&&(Rh([0]),Ne=[1],Th=[0]);Oa()},Sh=function(b,c,d){if(d&&d.admin){d=[I[0]];for(var e=0,g=I.length;e<g;e++)d[c[I[e].id]]=I[e];I=d}pa("bless");r=b;r.infinity&&(r.goldRes=Infinity,r.woodRes=Infinity,r.foodRes=
Infinity,r.stoneRes=Infinity);od()},Ld=!1,Ya=function(){Ld=!1;t("basic").style.filter=""},Pb=function(){Ld=!0;t("basic").style.filter="blur(94px)"};var Sl=function(){Ta("game");I.length=0;r.online=0;Ph();Wb();w.admin=0};var xg=function(b){if(w.admin||b)if(b=Ua.roomName,b+="Room",P("login"),Ya(),0!==Ua.getPeers().length||w.admin){var c=w.room||NaN;r.id=b;r.online=1;ni();Ta("chat");t("gameName").innerHTML=qb(c.description)||"Online Game";t("onlineID").value=location.origin+"/#"+r.id;Aa("returnmenu");
wg();w.admin?(location.replace("#"+r.id),t("buttons").innerHTML='<button id="startbutton">'+x.play+'</button><button id="optionbutton">'+x.options+'</button><button id="closebutton">'+x.close+"</button>",t("startbutton").onclick=Rl,t("optionbutton").onclick=nk,t("closebutton").onclick=Sl):(t("buttons").innerHTML='<button id="quitbutton">'+x.disconnect+"</button>",t("quitbutton").onclick=Ol);Ua.connection.on("remove",function(b){if(b=ed(b.id))if(nb(Ad(x.playerDisconnected,b.username),0,5),r.online){if(r.started)for(var c=
0;c<I.length;c++)if(I[c].id==b.id){F[c+1].die();break}Ma.quit(b);r.started?tb.done[gd]==Ma.length&&tb.func&&(tb.func=!1,Vg(),$b()):(wg(),b.admin&&(Wb(),Ua.leaveRoom(),pd(x.gameClosed)))}})}else location.hash="",Wb()},Ba=function(b){Ba.func.put(b);0===Ba.active&&(ea(ok,0,0,0,0),Ba.date=Date.now(),Ba.received=0,Ba.max=-Infinity,Ba.active=1)};Ba.func=[];Ba.active=0;var ok=function(b,c,d){d&&ea(pk,0,0,[d],0)},Uh={},pk=function(b,c,d){if(d&&(d.ping=~~(.5*(Date.now()-Ba.date)+.5),Uh[d.id]?Uh[d.id].put(d.ping):
Uh[d.id]=[d.ping],d.ping>Ba.max&&(Ba.max=d.ping),Ba.received++,Ba.received==Ma.length)){b=performance.now();c=0;for(d=Ba.func.length;c<d;Ba.func[c++]());P(-b+performance.now());Ba.func.length=0;Ba.active=0}},Vh=document.getElementsByClassName("ucolor"),hk=document.getElementsByClassName("username"),Wh=document.getElementsByClassName("race"),dg=document.getElementsByClassName("team"),lc=document.getElementsByClassName("isconnected"),Ag=function(b,c,d){d&&(c=Qh(d.id),d=c[1],c=c[0],c.race=b%3,c.race||
(c.race=0),Wh[d].innerHTML=Za[c.race])},Qh=function(b){for(var c=0,d=I.length;c<d;c++){var e=I[c];if(e.id==b)return[e,c]}},yg=function(b,c,d){if(d){P(b);c=b.match(/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i);c||(b="ffffff",c=["ffffff","ff","ff","ff"]);d.color=b;d=Qh(d.id);var e=d[1];d=d[0];Vh[e].style.background=b;d.color=[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},zg=function(b,c,d){b=parseInt(b);if(isNaN(b)||!b)b=0;(b%=5)||(b=0);if(d){c=d.id;d=0;for(var e=I.length;d<e;d++){var f=I[d];
if(f.id==c){f.team=b;dg[d].innerHTML=b;break}}}},wg=function(){P("setup MENU");var b=document.getElementById("multiplayertable");b.innerHTML="";for(var c=w.room?w.room.max:14,d=0;d<c;d++)b.innerHTML+='<tr><td class="ucolor"></td><td class="username">'+x.open+'</td><td class="race"></td><td class="team"></td><td class="isconnected"></td></tr>';b=Ua.roomName;b=b.substr(0,b.length-1);var e=[w.p2p];d=0;for(c=Ma.length;d<c;d++){var f=Ma[d];f.admin?e.unshift(f):e.put(f)}for(c=0;c<e.length;c++){f=e[c];I[c]&&
I[c].id==f.id?d=I[c]:(d=parseInt((f.color||"ffffff").substr(1),16),d={color:[d>>16&255,d>>8&255,d&255],ia:0,name:f.username,race:0,team:1,id:f.id,cID:c});f&&f.id?(lc[c].style.background="#00ff00",lc[c].style.boxShadow="0px 0px 30px 0px #00ff00"):(lc[c].style.background="#ff0000",lc[c].style.boxShadow="0px 0px 30px 0px #ff0000");Vh[c].style.background="rgb("+d.color[0]+","+d.color[1]+","+d.color[2]+")";hk[c].innerHTML=d.name;d.id==b&&(f.admin=!0);if(w.onlineID==d.id){dg[c].innerHTML="";f=document.createElement("button");
f.onmousedown=qk;f.iteam=c;f.innerHTML=d.team;dg[c].appendChild(f);f=document.createElement("button");f.onmousedown=rk;f.iteam=c;f.innerHTML=Za[d.race];Wh[c].appendChild(f);f=document.createElement("input");f.type="color";var h=d.color;f.iteam=c;f.value="#"+(16777216+(h[0]<<16)+(h[1]<<8)+h[2]).toString(16).slice(1);Vh[c].appendChild(f);f.onchange=sk;lc[c].style.background="#00ff00";lc[c].style.boxShadow="0px 0px 30px 0px #00ff00"}else dg[c].innerHTML=d.team,Wh[c].innerHTML=Za[d.race];I[c]=d}I.length=
e.length},I=[];window.onhashchange=oi;var cd=document.getElementById("msgs"),vc=document.getElementById("msgs1"),eg=document.getElementById("msginput"),yh=document.getElementById("msginputGame"),xh=document.getElementById("enterwindow");eg.addEventListener("keyup",function(b){13==b.keyCode&&zh()});var nb=function(b,c,d){pa("chat");d&&(r.started?(c=vc,Xh()):c=cd,c.innerHTML=5!==d?c.innerHTML+("<li><span>"+d.username+" \u2014</span> "+qb(b)+"</li>"):c.innerHTML+("<li>"+b+"</li>"),c.scrollTop=c.scrollHeight)},
Xh=function(){11==cd.children.length&&vc.removeChild(vc.children[0]);Xh.intv=setTimeout(function(){vc.children[0]&&vc.removeChild(vc.children[0])},16E3)},qb=function(b){return String(b).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},zh=function(){if(r.started){var b=vc,c=yh.value;yh.value="";Xh()}else b=cd,c=eg.value,eg.value="";""!=c&&(c=qb(c),b.innerHTML+="<li><span>"+w.name+" \u2014</span> "+c+"</li>",ea(nb,c,0,0,0),b.scrollTop=b.scrollHeight)},ef=[Sh,Bb,fe,oc,pf,xd,sd,ri,si,
nb,af,ce,vd,Hh,wd,ue,eh,lf,$g,dd,$b,ok,pk,zg,Jj,function(b,c,d){d&&(b=ed(b))&&b.open&&(P("I CAN connect"),ea(fd,b.id,0,[d],0))},fd,ik,cg,Ng,oh,Gf,qh,qj,mh,sf,vf,Qf,If,rh,zf,bj,je,yg,function(b,c){c=A[c];var d=b[0];b=b[1];var e=E;!1!==d&&(c.kx=d);!1!==b&&(c.ky=b);d=-(c.x32+d+(b+c.y32)*e);c.stop=c.kx||c.ky?!1:!0;Number.isInteger(c.xf)||Bb(d,[c.id])},lh,ij,Pg,Ag,xf,nh,Sf,Lf,mj,Uf,Df,Bf,Nf,th,Cj,nj,Fi,mi];localStorage.favMusic&&(musicSelect.mversion.value=localStorage.favMusic);Sh.antiHack=0;Bb.antiHack=
0;fe.antiHack=0;oc.antiHack=0;pf.antiHack=0;xd.antiHack=0;sd.antiHack=0;Y.antiHack=0;nf.antiHack=0;ab.antiHack=0;ob.antiHack=0;Y.antiHack=0;ri.antiHack=0;si.antiHack=0;nb.antiHack=0;af.antiHack=0;ce.antiHack=0;vd.antiHack=0;$d.antiHack=0;Hh.antiHack=0;wd.antiHack=0;ue.antiHack=0;eh.antiHack=0;lf.antiHack=0;(function(){for(var b=ef,c=0,d=b.length;c<d;c++)b[c].location=c})();var nk=function(){t("mapconfiguration").style.display="block";t("basic").style.filter="blur(94px)"},tk=document.getElementsByClassName("ucolor1"),
Tl=document.getElementsByClassName("username1"),Ul=document.getElementsByClassName("race1"),Vl=document.getElementsByClassName("team1"),qk=function(b){var c=1;2==b.button&&(c=-1);b=this.iteam;I[b].team+=c;0>I[b].team&&(I[b].team=0);this.innerHTML=I[b].team;r.online&&(c=parseInt(this.innerHTML),c%=6,0==c&&(c=1),this.innerHTML=c,ea(zg,c,0,0,2),I[b].team=c)},rk=function(b){b=I[this.iteam];b.race=(b.race+1)%3;this.innerHTML=Za[b.race];ea(Ag,b.race,0,0,2)},sk=function(){this.parentElement.style.background=
this.value;var b=this.value.match(/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i);I[this.iteam].color=[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)];Ma.length&&ea(yg,this.value,0,0,2)},Wl=function(){fc.nu++;fc()},Xl=function(){fc.nu--;0>=fc.nu?fc.nu=1:I.length--;fc()},vh={0:"euro",1:"arab",2:"asia"},uk=[["a","e","i","o","u"],"bcdfghjklmnpqrstvwxyz".split("")],fc=function(){if(w.name){document.getElementById("returnmenu").style.display="block";document.getElementById("oneplayertbody").innerHTML=
"";document.getElementById("oneplayertbody").innerHTML+='<tr><td></td><td id="addremove"><button id="addPlayer">+</button><button id="removePlayer">-</button></td><td></td><td></td></tr>';for(var b=fc.nu,c=0;c<b;c++)if(document.getElementById("oneplayertbody").innerHTML+='<tr><td class="ucolor1"></td><td class="username1"></td><td class="race1"><button></button></td><td class="team1"><button></button></td></tr>',!I[c]){var d=~~(16777216*Math.random());I[c]={color:[d>>16&255,d>>8&255,d&255],IA:1,race:~~(3*
Math.random()),team:c}}document.getElementById("addPlayer").onclick=Wl;document.getElementById("removePlayer").onclick=Xl;d=parseInt(w.color.substr(1),16);I[0].color=[d>>16&255,d>>8&255,d&255];I[0].name=w.name;for(c=d=I[0].IA=0;c<b;c++){var e=I[c],f=Si[vh[e.race]];if(e.IA)if(d<f.length)e.name=f[d++];else{f=e;var h=~~(9*Math.random())+2,m=uk[1],k=m[~~(Math.random()*m.length)].toUpperCase();.85<Math.random()&&(k+=m[~~(Math.random()*m.length)]);for(m=0;m<h;m++){var l=uk[m%2];k+=l[~~(Math.random()*l.length)];
.8<Math.random()&&(k+=l[~~(Math.random()*l.length)])}f.name=k}tk[c].style.background="rgb("+e.color[0]+","+e.color[1]+","+e.color[2]+")";Tl[c].innerHTML=e.name;f=Vl[c].getElementsByTagName("button")[0];f.iteam=c;f.onmousedown=qk;f.innerHTML=c;f=Ul[c].getElementsByTagName("button")[0];f.iteam=c;f.onmousedown=rk;f.innerHTML=Za[e.race];e=I[c].color;f=document.createElement("input");f.type="color";f.iteam=c;f.value="#"+(16777216+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1);tk[c].appendChild(f);f.onchange=
sk}}else jk(fc)};fc.nu=4;var fk=function(b,c,d){"granted"!=Notification.permission&&Notification.requestPermission(function(b){});var e=new Notification(b,{icon:"https://i.imgur.com/SWtWteN.png",body:c,requireInteraction:!0});d||(d=7550);setTimeout(function(){e.close()},d)},ic,Hc=function(b){if(ka(b%E,~~(b/E))&&(b=uc[b],0<=b&&!ic.type[b]))return!0},Jc=function(b){if(b){Jc.update=!1;b=uc;for(var c=E,d=[],e={},f=0,g=E*va;f<g;f++){var m=b[f];if(ic.type[m]||0>m){var l=0;Hc(f-1-c)&&(l+=1E7);Hc(f-c)&&(l+=
1E6);Hc(f-c+1)&&(l+=1E5);Hc(f-1)&&(l+=1E4);Hc(f+1)&&(l+=1E3);Hc(f-1+c)&&(l+=100);Hc(f+c)&&(l+=10);Hc(f+1+c)&&(l+=1);l?void 0!==Tj[l]&&(d.add(f),e[d.length-1]=-Tj[l]/256-2):0>m&&(b[f]=3)}}f=0;for(len=d.length;f<len;b[d[f]]=e[f++]);k.useProgram(ia);k.activeTexture(k.TEXTURE1);c=k.createTexture();k.bindTexture(k.TEXTURE_2D,c);k.texImage2D(k.TEXTURE_2D,0,k.R8I,E,va,0,k.RED_INTEGER,k.BYTE,b);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,
k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.REPEAT);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.REPEAT);k.bindTexture(k.TEXTURE_2D,null);k.bindTexture(k.TEXTURE_2D,c);k.uniform1i(k.getUniformLocation(ia,"img_data"),1);k.useProgram(oa);k.activeTexture(k.TEXTURE2)}else Jc.update=!0};Jc.update=!1;var b,Yj,bg,Ae,Be,Ce,De,Ee,Fe,Ge,He,Ie,Je,Ke,Le,Hl=function(){var g={};b={move:function(){Q=Bb;Bb.cursor=7}};b.move.iconID=262;b.move.obj={name:x.move};b.attack=function(){Q=oc};b.attack.iconID=
250;b.attack.obj={name:x.attack};b.guard=function(){Ec(4)};b.guard.iconID=237;b.guard.obj={name:x.guard};b.patrol=function(){Ec(8)};b.patrol.iconID=238;b.patrol.obj={name:x.patrol};b.pickUp=function(){Q=vd};b.pickUp.iconID=240;b.pickUp.obj={name:x.pickItems};b.explore=function(){Ec(7)};b.explore.iconID=40;b.explore.obj={name:x.explore};b.stop=function(){ea(eh,0,G)};b.stop.iconID=160;b.stop.obj={name:x.stop};b.stand=function(){ea(bj,0,G)};b.stand.iconID=27;b.stand.obj={name:x.stand};b.attackGround=
function(){};b.attackGround.iconID=100;b.steady=function(){};b.steady.iconID=21;b.createOrk=function(){W(58)};b.createOrk.iconID=120;b.createDwarf=function(){W(59)};b.createDwarf.iconID=117;b.createSkeleton=function(){W(60)};b.createSkeleton.iconID=87;b.createGhost=function(){W(40)};b.createGhost.iconID=222;b.createFootman=function(){W(0)};b.createFootman.iconID=182;b.createArcher=function(){W(4)};b.createArcher.iconID=185;b.createMaceman=function(){W(3)};b.createMaceman.iconID=186;b.createPikeman=
function(){W(1)};b.createPikeman.iconID=183;b.createLongbowman=function(){W(6)};b.createLongbowman.iconID=184;b.createKnight=function(){W(19)};b.createKnight.iconID=180;b.iniMercenaries=function(b){b.mlist=[];b.mlistID=[];b.mercID=0;ah(b);b.setupINTV(Gh,b.id,2E3)};b.iniMercenaries.builds=[30];b.iniHeroes=function(b){b.hlist=[];b.hlistID=[];b.heroID=0;ah(b);b.setupINTV(Gh,b.id,2E3)};b.iniHeroes.builds=[30];b.mercFootmanArab=function(){Ea()};b.mercFootmanArab.iconID=49;b.mercFootmanArab.unit=80;b.mercFootmanArab.obj=
{};b.mercArcherArab=function(){Ea()};b.mercArcherArab.iconID=52;b.mercArcherArab.unit=85;b.mercArcherArab.obj={};b.mercMacemanArab=function(){Ea()};b.mercMacemanArab.iconID=116;b.mercMacemanArab.obj={};b.mercMacemanArab.unit=83;b.mercPikemanArab=function(){Ea()};b.mercPikemanArab.iconID=52;b.mercPikemanArab.unit=82;b.mercPikemanArab.obj={};b.mercCavalry=function(){Ea()};b.mercCavalry.iconID=133;b.mercCavalry.unit=84;b.mercCavalry.obj={};b.mercEnichar=function(){Ea()};b.mercEnichar.iconID=123;b.mercEnichar.unit=
91;b.mercEnichar.obj={};b.mercJihad=function(){Ea()};b.mercJihad.iconID=236;b.mercJihad.unit=86;b.mercJihad.obj={};b.mercFootmanArab6=function(){$a()};b.mercFootmanArab6.iconID=49;b.mercFootmanArab6.unit=80;b.mercFootmanArab6.obj={};b.mercArcherArab6=function(){$a()};b.mercArcherArab6.iconID=52;b.mercArcherArab6.unit=85;b.mercArcherArab6.obj={};b.mercMacemanArab6=function(){$a()};b.mercMacemanArab6.iconID=116;b.mercMacemanArab6.unit=83;b.mercMacemanArab6.obj={};b.mercPikemanArab6=function(){$a()};
b.mercPikemanArab6.iconID=52;b.mercPikemanArab6.unit=82;b.mercPikemanArab6.obj={};b.mercCavalry6=function(){$a()};b.mercCavalry6.iconID=133;b.mercCavalry6.unit=84;b.mercCavalry6.obj={};b.mercEnichar6=function(){$a()};b.mercEnichar6.iconID=123;b.mercEnichar6.unit=91;b.mercEnichar6.obj={};b.mercJihad6=function(){$a()};b.mercJihad6.iconID=236;b.mercJihad6.unit=86;b.mercJihad6.obj={};b.mercFootman=function(){Ea()};b.mercFootman.iconID=182;b.mercFootman.unit=0;b.mercArcher=function(){Ea()};b.mercArcher.iconID=
185;b.mercArcher.unit=4;b.mercMaceman=function(){Ea()};b.mercMaceman.iconID=186;b.mercMaceman.unit=3;b.mercPikeman=function(){Ea()};b.mercPikeman.iconID=183;b.mercPikeman.unit=1;b.mercLongbowman=function(){Ea()};b.mercLongbowman.iconID=184;b.mercLongbowman.unit=6;b.mercKnight=function(){Ea()};b.mercKnight.iconID=180;b.mercKnight.unit=19;b.mercFootman6=function(){$a()};b.mercFootman6.iconID=182;b.mercFootman6.unit=0;b.mercFootman6.obj={};b.mercArcher6=function(){$a()};b.mercArcher6.iconID=185;b.mercArcher6.unit=
4;b.mercArcher6.obj={};b.mercMaceman6=function(){$a()};b.mercMaceman6.iconID=186;b.mercMaceman6.unit=3;b.mercMaceman6.obj={};b.mercPikeman6=function(){$a()};b.mercPikeman6.iconID=183;b.mercPikeman6.unit=1;b.mercPikeman6.obj={};b.mercLongbowman6=function(){$a()};b.mercLongbowman6.iconID=184;b.mercLongbowman6.unit=6;b.mercLongbowman6.obj={};b.mercKnight6=function(){$a()};b.mercKnight6.iconID=180;b.mercKnight6.unit=19;b.mercKnight6.obj={};b.mercArcherAsian6=function(){$a()};b.mercArcherAsian6.iconID=
53;b.mercArcherAsian6.unit=67;b.mercArcherAsian6.obj={};b.mercSamurai6=function(){$a()};b.mercSamurai6.iconID=122;b.mercSamurai6.unit=68;b.mercSamurai6.obj={};b.mercHourseSamurai6=function(){$a()};b.mercHourseSamurai6.iconID=121;b.mercHourseSamurai6.unit=70;b.mercHourseSamurai6.obj={};b.mercRonin6=function(){$a()};b.mercRonin6.iconID=54;b.mercRonin6.unit=66;b.mercRonin6.obj={};b.mercHorseArcher6=function(){$a()};b.mercHorseArcher6.iconID=52;b.mercHorseArcher6.unit=69;b.mercHorseArcher6.obj={};b.mercChariot6=
function(){$a()};b.mercChariot6.iconID=79;b.mercChariot6.unit=72;b.mercChariot6.obj={};b.mercArcherAsian=function(){Ea()};b.mercArcherAsian.iconID=53;b.mercArcherAsian.unit=67;b.mercArcherAsian.obj={};b.mercSamurai=function(){Ea()};b.mercSamurai.iconID=122;b.mercSamurai.unit=68;b.mercSamurai.obj={};b.mercHourseSamurai=function(){Ea()};b.mercHourseSamurai.iconID=121;b.mercHourseSamurai.unit=70;b.mercHourseSamurai.obj={};b.mercRonin=function(){Ea()};b.mercRonin.iconID=54;b.mercRonin.unit=66;b.mercRonin.obj=
{};b.mercHorseArcher=function(){Ea()};b.mercHorseArcher.iconID=52;b.mercHorseArcher.unit=69;b.mercHorseArcher.obj={};b.mercChariot=function(){Ea()};b.mercChariot.iconID=79;b.mercChariot.unit=72;b.mercChariot.obj={};b.createPeon=function(){W(10)};b.createPeon.iconID=187;b.sameSpeed=function(){ea(Pg,G)};b.sameSpeed.iconID=82;b.restoreSpeed=function(){ea(ij,G)};b.restoreSpeed.iconID=88;b.createSpy=function(){W(2)};b.createSpy.iconID=162;b.emergeAllUnits=function(){var b=G[0];ea(wd,b,A[b].inventory.slice(0))};
b.emergeAllUnits.iconID=261;b.techFeudalism=function(){H(12)};b.techFeudalism.iconID=233;b.techArchitecture=function(){H(13)};b.techArchitecture.iconID=226;b.techLearning=function(){H(14)};b.techLearning.iconID=129;b.createPeon1=function(){W(64)};b.createPeon1.iconID=55;b.createPeon2=function(){W(79)};b.createPeon2.iconID=132;b.createNinja=function(){W(65)};b.createNinja.iconID=51;b.techArmoredChariot=function(){H(51)};b.techArmoredChariot.iconID=79;b.techBuddhism=function(){H(45)};b.techBuddhism.iconID=
127;b.techGreatWall=function(){H(48)};b.techGreatWall.iconID=80;b.ridingHorses=function(){H(49)};b.ridingHorses.iconID=64;b.irrigation=function(){H(50)};b.irrigation.iconID=72;b.createHorseArcher2=function(){W(85)};b.createHorseArcher2.iconID=52;b.techMeditation=function(){H(52)};b.techMeditation.iconID=71;b.techKungFu=function(){H(53)};b.techKungFu.iconID=228;b.techTournaments=function(){H(54)};b.techTournaments.iconID=73;b.techPhilosophy=function(){H(55)};b.techPhilosophy.iconID=68;b.techNinjas=
function(){H(56)};b.techNinjas.iconID=56;b.techMastery=function(){H(57)};b.techMastery.iconID=69;b.techGoldMining=function(){H(1)};b.techGoldMining.iconID=58;b.techStoneMining=function(){H(2)};b.techStoneMining.iconID=57;b.createCrusaders=function(){ea(Hh,G[0],0)};b.createCrusaders.iconID=221;b.techFanaticism=function(){H(31)};b.techFanaticism.iconID=235;b.techCrusade=function(){H(32)};b.techCrusade.iconID=93;b.techEspionage=function(){H(30)};b.techEspionage.iconID=215;b.techInquisition=function(){H(33)};
b.techInquisition.iconID=97;b.techHealing=function(){H(34)};b.techHealing.iconID=219;b.healing=function(){Q=oh};b.healing.iconID=219;b.healing.iconIDbook=201;b.teach=function(){Q=th};b.teach.iconID=23;b.teach.iconIDbook=217;b.techBless=function(){H(36)};b.techBless.iconID=159;b.bless=function(){Q=Gf};b.bless.iconID=159;b.bless.iconIDbook=204;b.techMedicine=function(){H(35)};b.techMedicine.iconID=220;b.createMage=function(){W(5)};b.createMage.iconID=156;b.techBat=function(){H(38)};b.techBat.iconID=
168;b.techGolem=function(){H(41)};b.techGolem.iconID=119;b.techInvisibility=function(){H(37)};b.techInvisibility.iconID=217;b.techLightning=function(){H(40)};b.techLightning.iconID=143;b.techFreeze=function(){H(39)};b.techFreeze.iconID=130;b.techHeroism=function(){H(22)};b.techHeroism.iconID=136;b.techWarfare=function(){H(23)};b.techWarfare.iconID=108;b.techTactics=function(){H(24)};b.techTactics.iconID=257;b.techMercenaries=function(){H(25)};b.techMercenaries.iconID=95;b.techHeroes=function(){H(26)};
b.techHeroes.iconID=96;b.techFame=function(){H(27)};b.techFame.iconID=111;b.techSiegeTactics=function(){H(28)};b.techSiegeTactics.iconID=258;b.techBodyBuilding=function(){H(29)};b.techBodyBuilding.iconID=101;b.createPriest=function(){W(9)};b.createPriest.iconID=155;b.createCow=function(){W(27)};b.createCow.iconID=163;b.techCropRotation=function(){H(8)};b.techCropRotation.iconID=227;b.techDomestication=function(){H(7)};b.techDomestication.iconID=157;b.techMapMaking=function(){H(16)};b.techMapMaking.iconID=
89;b.techTradeRoutes=function(){H(17)};b.techTradeRoutes.iconID=102;b.techTradeTaxes=function(){H(18)};b.techTradeTaxes.iconID=110;b.techUsury=function(){H(19)};b.techUsury.iconID=105;b.techSupplyStorage=function(){H(20)};b.techSupplyStorage.iconID=62;b.techBribery=function(){H(21)};b.techBribery.iconID=109;b.bribe=function(){};b.bribe.iconID=128;b.createCaravan=function(){W(61)};b.createCaravan.iconID=169;b.createCaravan2=function(){W(90)};b.createCaravan2.iconID=134;b.createFootman2=function(){W(80)};
b.createFootman2.iconID=49;b.createArcher2=function(){W(81)};b.createArcher2.iconID=43;b.createSatrap=function(){W(83)};b.createSatrap.iconID=116;b.createPikeman2=function(){W(82)};b.createPikeman2.iconID=42;b.createHorseArcher2=function(){W(85)};b.createHorseArcher2.iconID=124;b.createCavalry=function(){W(84)};b.createCavalry.iconID=133;b.createEnichar=function(){W(91)};b.createEnichar.iconID=123;b.createJihad=function(){W(86)};b.createJihad.iconID=236;b.trade=function(){};b.trade.iconID=161;b.unload=
function(){Q=sf};b.unload.iconID=148;b.createMercenaries=function(){la(A[G[0]].mlist)};b.createMercenaries.iconID=95;b.createHeroes=function(){la(A[G[0]].hlist)};b.createHeroes.iconID=96;b.upgradeGuildTower=function(){H(42)};b.upgradeGuildTower.iconID=171;b.upgradeStoneTower=function(){H(43)};b.upgradeStoneTower.iconID=178;b.upgradeCannonTower=function(){H(44)};b.upgradeCannonTower.iconID=178;b.createCatapult=function(){W(37)};b.createCatapult.iconID=152;b.createHeavyCatapult=function(){W(39)};b.createHeavyCatapult.iconID=
153;b.createBallist=function(){W(38)};b.createBallist.iconID=154;b.techEngineering=function(){H(47)};b.techEngineering.iconID=92;b.techCannonTower=function(){H(46)};b.techCannonTower.iconID=178;b.techPlateArmor=function(){H(10)};b.techPlateArmor.iconID=131;b.techTemperIron=function(){H(4)};b.techTemperIron.iconID=266;b.techHalberd=function(){H(6)};b.techHalberd.iconID=113;b.techScaleArmor=function(){H(5)};b.techScaleArmor.iconID=251;b.techChainMail=function(){H(9)};b.techChainMail.iconID=252;b.techLongbow=
function(){H(0)};b.techLongbow.iconID=259;b.techWoodCutting=function(){H(3)};b.techWoodCutting.iconID=107;b.techCrossbow=function(){H(11)};b.techCrossbow.iconID=112;b.createFishingBoat=function(){W(74)};b.createFishingBoat.iconID=48;b.createXebec=function(){W(76)};b.createXebec.iconID=166;b.upgradeShip=function(){};b.upgradeShip.iconID=268;b.fishing=function(){};b.fishing.iconID=41;b.createHulk=function(){W(75)};b.createHulk.iconID=165;b.createGalleon=function(){W(73)};b.createGalleon.iconID=164;
b.techLandingTactics=function(){};b.techLandingTactics.iconID=98;b.techConcentration=function(){H(58)};b.techConcentration.iconID=75;b.techConfusion=function(){H(59)};b.techConfusion.iconID=76;b.techWhirlpool=function(){H(60)};b.techWhirlpool.iconID=78;b.techDragon=function(){H(61)};b.techDragon.iconID=115;b.techTurnToStone=function(){H(62)};b.techTurnToStone.iconID=77;b.techFlameBolt=function(){H(63)};b.techFlameBolt.iconID=25;b.techJewelry=function(){H(64)};b.techJewelry.iconID=230;b.techBanking=
function(){H(65)};b.techBanking.iconID=74;b.techChemistry=function(){H(66)};b.techChemistry.iconID=225;b.techSeaFood=function(){H(67)};b.techSeaFood.iconID=67;b.techGunPowder=function(){H(68)};b.techGunPowder.iconID=212;b.techRocketArrow=function(){H(69)};b.techRocketArrow.iconID=47;b.techBushido=function(){H(70)};b.techBushido.iconID=60;b.techLeadership=function(){H(71)};b.techLeadership.iconID=114;b.techHonor=function(){H(72)};b.techHonor.iconID=94;b.techSunTzu=function(){H(73)};b.techSunTzu.iconID=
66;b.createRonin=function(){W(66)};b.createRonin.iconID=54;b.createArcher1=function(){W(67)};b.createArcher1.iconID=53;b.createSamurai=function(){W(68)};b.createSamurai.iconID=122;b.createHorseArcher1=function(){W(69)};b.createHorseArcher1.iconID=52;b.createMonk=function(){W(128)};b.createMonk.iconID=45;b.createMage1=function(){W(129)};b.createMage1.iconID=50;b.createPriest1=function(){W(127)};b.createPriest1.iconID=44;b.createPriest2=function(){W(87)};b.createPriest2.iconID=125;b.buyItems=function(){};
b.buyItems.iconID=31;b.sellItems=function(){};b.sellItems.iconID=30;b.createHorseSamurai=function(){W(70)};b.createHorseSamurai.iconID=121;b.createChariot=function(){W(72)};b.createChariot.iconID=79;b.stopTech=function(){ea(lf,0,G);Pa(A[G[0]])};b.stopTech.iconID=160;b.repair=function(){Q=xd};b.repair.iconID=145;b.conquest=function(){};b.conquest.iconID=249;b.dcm=function(){Q=fe};b.dcm.iconID=260;b.buildBarrack=function(){O(14)};b.buildBarrack.iconID=205;b.buildBarrack1=function(){O(71)};b.buildBarrack1.iconID=
205;b.buildBarrack2=function(){O(102)};b.buildBarrack2.iconID=205;b.buildTower=function(){O(32)};b.buildTower.iconID=170;b.buildStorage=function(){O(18)};b.buildStorage.iconID=200;b.buildLumbermill=function(){O(15)};b.buildLumbermill.iconID=199;b.buildLumbermill2=function(){O(93)};b.buildLumbermill2.iconID=199;b.buildFields=function(){O(20)};b.buildFields.iconID=265;b.buildCastle=function(){O(12)};b.buildCastle.iconID=206;b.buildCastle1=function(){O(62)};b.buildCastle1.iconID=206;b.buildCastle2=function(){O(63)};
b.buildCastle2.iconID=206;b.buildAcademy=function(){O(17)};b.buildAcademy.iconID=204;b.buildCathedral=function(){O(11)};b.buildCathedral.iconID=191;b.buildCathedral2=function(){O(106)};b.buildCathedral2.iconID=189;b.buildMerchands=function(){O(24)};b.buildMerchands.iconID=198;b.buildMerchands2=function(){O(108)};b.buildMerchands2.iconID=198;b.buildChurch=function(){O(25)};b.buildChurch.iconID=197;b.buildMarket=function(){O(33)};b.buildMarket.iconID=194;b.buildMageTower=function(){O(16)};b.buildMageTower.iconID=
192;b.buildMageTower2=function(){O(107)};b.buildMageTower2.iconID=192;b.buildDummy=function(){O(36)};b.buildDummy.iconID=65;b.buildFarm=function(){O(23)};b.buildFarm.iconID=193;b.buildBlacksmith=function(){O(26)};b.buildBlacksmith.iconID=202;b.buildWorkshop=function(){O(29)};b.buildWorkshop.iconID=201;b.buildWorkshop2=function(){O(98)};b.buildWorkshop2.iconID=201;b.buildStable=function(){O(28)};b.buildStable.iconID=196;b.buildStable2=function(){O(103)};b.buildStable2.iconID=196;b.buildTavern=function(){O(30)};
b.buildTavern.iconID=208;b.buildHouse=function(){O(31)};b.buildHouse.iconID=195;b.buildHarbor=function(){O(41)};b.buildHarbor.iconID=188;b.buildOutpost=function(){O(34)};b.buildOutpost.iconID=158;b.buildWoodWall=function(){dh(13)};b.buildWoodWall.iconID=210;b.buildWoodGate=function(){};b.buildWoodGate.iconID=209;b.buildWoodGate.disabled=2;b.buildBridge=function(){O(35)};b.buildBridge.iconID=176;bg="freeze invisibility lightning turnToStone bless healing".split(" ");b.freeze=function(){Q=Qf};b.freeze.iconID=
99;b.freeze.obj={name:x.freeze};b.freeze.iconIDbook=205;b.confusion=function(){Q=Sf};b.confusion.iconID=76;b.confusion.obj={name:"Confusion",spcost:[120,0,0,0]};b.confusion.iconIDbook=206;b.turnToStone=function(){Q=nh};b.turnToStone.iconID=77;b.turnToStone.iconIDbook=213;b.turnToStone.obj={name:"Turn to Stone",spcost:[40,0,0,0]};b.whirlpool=function(){Q=mj};b.whirlpool.iconID=78;b.whirlpool.iconIDbook=214;b.whirlpool.obj={name:"Whirlpool",spcost:[80,0,0,0]};b.flameBolt=function(){Q=Lf};b.flameBolt.iconID=
25;b.flameBolt.obj={name:"Flame Bolt",spcost:[120,0,0,0]};b.flameBolt.iconIDbook=216;b.createDragon=function(){Q=xf};b.createDragon.iconID=115;b.createDragon.obj={name:"Spawn Dragon",spcost:[320,0,0,0]};b.createDragon.iconIDbook=215;b.lightning=function(){Q=rh};b.lightning.iconID=263;b.lightning.obj={name:x.lightning,spcost:[80,0,0,0]};b.lightning.iconIDbook=200;b.createBat=function(){Q=zf};b.createBat.iconID=168;b.createBat.iconIDbook=203;b.createGolem=function(){Q=vf};b.createGolem.iconID=119;b.createGolem.iconIDbook=
209;b.autoInvisibility=function(){Q=If};b.autoInvisibility.iconID=217;b.autoInvisibility.obj={name:x.invisibility};b.invisibility=function(){Q=If};b.invisibility.iconID=217;b.invisibility.iconIDbook=208;b.impersonate=function(){Q=qh};b.impersonate.iconID=32;b.impersonate.obj={name:"Impersonate"};b.revealSelf=function(){ea(qj,G[0],0)};b.revealSelf.iconID=33;b.revealSelf.obj={name:"Reveal your true self"};b.buildHouse1=function(){O(111)};b.buildHouse1.iconID=195;b.buildHouse2=function(){O(92)};b.buildHouse2.iconID=
195;b.buildLumbermill1=function(){O(112)};b.buildLumbermill1.iconID=199;b.buildStorage1=function(){O(113)};b.buildStorage1.iconID=200;b.buildStorage2=function(){O(94)};b.buildStorage2.iconID=200;b.buildFarm1=function(){O(114)};b.buildFarm1.iconID=193;b.buildFarm2=function(){O(95)};b.buildFarm2.iconID=193;b.buildHarbor1=function(){O(115)};b.buildHarbor1.iconID=188;b.buildHarbor2=function(){O(96)};b.buildHarbor2.iconID=188;b.buildBlacksmith1=function(){O(116)};b.buildBlacksmith1.iconID=202;b.buildBlacksmith2=
function(){O(97)};b.buildBlacksmith2.iconID=202;b.buildWorkshop1=function(){O(117)};b.buildWorkshop1.iconID=201;b.buildChurch1=function(){O(118)};b.buildChurch1.iconID=197;b.buildChurch2=function(){O(99)};b.buildChurch2.iconID=197;b.buildTavern1=function(){O(119)};b.buildTavern1.iconID=208;b.buildTavern2=function(){O(100)};b.buildTavern2.iconID=208;b.buildMarket1=function(){O(120)};b.buildMarket1.iconID=194;b.buildMarket2=function(){O(101)};b.buildMarket2.iconID=194;b.buildStable1=function(){O(121)};
b.buildStable1.iconID=196;b.buildOutpost1=function(){O(122)};b.buildOutpost1.iconID=158;b.buildOutpost2=function(){O(104)};b.buildOutpost2.iconID=158;b.buildCathedral1=function(){O(123)};b.buildCathedral1.iconID=190;b.buildMageTower1=function(){O(124)};b.buildMageTower1.iconID=192;b.createObjects=function(){le("magicworkshopmenu",fa)};b.createObjects.iconID=20;b.createObjects.obj={};b.buildMagicWorkshop=function(){O(110)};b.buildMagicWorkshop.iconID=46;b.buildMerchands1=function(){O(125)};b.buildMerchands1.iconID=
198;b.buildAcademy1=function(){O(126)};b.buildAcademy1.iconID=204;b.buildAcademy2=function(){O(109)};b.buildAcademy2.iconID=204;b.buildRocketTower=function(){O(57)};b.buildRocketTower.iconID=47;b.murder=function(){O(57)};b.murder.iconID=28;b.convertJihad=function(){};b.convertJihad.iconID=236;b.convertJihad.obj={};b.menuCommonBuild2=function(){la(Ie)};b.menuCommonBuild2.iconID=17;Ie=[b.buildFarm2,b.buildBlacksmith2,b.buildWorkshop2,b.buildStable2,b.buildTavern2,b.buildHouse2];Ie.menuName="a_build";
b.menuCommonBuild2.xtra=Ie;b.menuSpecialBuild2=function(){la(Je)};b.menuSpecialBuild2.iconID=15;Je=[b.buildCastle2,b.buildAcademy2,b.buildCathedral2,b.buildMerchands2,b.buildChurch2,b.buildMarket2,b.buildMageTower2,b.buildMagicWorkshop];Je.menuName="a_build";b.menuSpecialBuild2.xtra=Je;b.menuOtherBuild2=function(){la(Ke)};b.menuOtherBuild2.iconID=16;Ke=[b.buildHarbor2,b.buildOutpost2,b.buildWoodWall,b.buildWoodGate,b.buildBridge];Ke.menuName="e_build";b.menuOtherBuild2.xtra=Ke;b.menuBuilds2=function(){la(Le)};
b.menuBuilds2.iconID=245;Le=[b.menuSpecialBuild2,b.menuCommonBuild2,b.menuOtherBuild2,b.buildBarrack2,b.buildTower,b.buildStorage2,b.buildLumbermill2,b.buildFields];Le.menuName="a_build";b.menuBuilds2.xtra=Le;b.origin=gk;b.origin.iconID=255;b.createCarpet=function(){Q=Df};b.createCarpet.iconID=146;b.createCarpet.iconIDbook=202;b.createJinn=function(){Q=Bf};b.createJinn.iconID=118;b.createJinn.iconIDbook=218;b.magicVision=function(){};b.magicVision.iconID=223;b.magicVision.iconIDbook=210;b.fireRain=
function(){Q=Uf};b.fireRain.iconID=264;b.fireRain.iconIDbook=199;b.raiseDead=function(){Q=Nf};b.raiseDead.iconID=87;b.raiseDead.iconIDbook=211;b.createMage2=function(){W(89)};b.createMage2.iconID=126;b.techCowPoaching=function(){H(74)};b.techCowPoaching.iconID=85;b.techHorseManShip=function(){H(75)};b.techHorseManShip.iconID=231;b.techScimitar=function(){H(76)};b.techScimitar.iconID=84;b.techJihad=function(){H(77)};b.techJihad.iconID=236;b.techCarpet=function(){H(78)};b.techCarpet.iconID=146;b.techMagicWorkshop=
function(){H(79)};b.techMagicWorkshop.iconID=86;b.techFireRain=function(){H(80)};b.techFireRain.iconID=264;b.techMagicVision=function(){H(81)};b.techMagicVision.iconID=224;b.techNecromancy=function(){H(82)};b.techNecromancy.iconID=87;b.techJinn=function(){H(83)};b.techJinn.iconID=118;b.techOreFloatation=function(){H(84)};b.techOreFloatation.iconID=106;b.techRiddingHorses=function(){H(85)};b.techRiddingHorses.iconID=232;b.techJanissary=function(){H(86)};b.techJanissary.iconID=81;b.buildMagicItems=
function(){};b.buildMagicItems.iconID=20;b.techSlavery=function(){H(87)};b.techSlavery.iconID=135;b.stopBuilding=function(){ea(ue,0,G)};b.stopBuilding.iconID=160;b.menuSpecialBuild1=function(){la(Ae)};b.menuSpecialBuild1.iconID=15;Ae=[b.buildCastle1,b.buildAcademy1,b.buildCathedral1,b.buildMerchands1,b.buildChurch1,b.buildMarket1,b.buildMageTower1,b.buildRocketTower,b.buildDummy];Ae.menuName="a_build";b.menuSpecialBuild1.xtra=Ae;b.menuCommonBuild1=function(){la(Be)};b.menuCommonBuild1.iconID=17;Be=
[b.buildFarm1,b.buildBlacksmith1,b.buildWorkshop1,b.buildStable1,b.buildTavern1,b.buildHouse1];Be.menuName="a_build";b.menuCommonBuild1.xtra=Be;b.menuSpecialBuild=function(){la(Ce)};b.menuSpecialBuild.iconID=15;Ce=[b.buildCastle,b.buildAcademy,b.buildCathedral,b.buildMerchands,b.buildChurch,b.buildMarket,b.buildMageTower,b.buildDummy];Ce.menuName="e_build";b.menuSpecialBuild.xtra=Ce;b.menuCommonBuild=function(){la(De)};b.menuCommonBuild.iconID=17;De=[b.buildFarm,b.buildBlacksmith,b.buildWorkshop,
b.buildStable,b.buildTavern,b.buildHouse];De.menuName="e_build";b.menuCommonBuild.xtra=De;b.menuOtherBuild=function(){la(Ee)};b.menuOtherBuild.iconID=16;Ee=[b.buildHarbor,b.buildOutpost,b.buildWoodWall,b.buildWoodGate,b.buildBridge];Ee.menuName="e_build";b.menuOtherBuild.xtra=Ee;b.menuOtherBuild1=function(){la(Fe)};b.menuOtherBuild1.iconID=16;Fe=[b.buildHarbor1,b.buildOutpost1,b.buildWoodWall,b.buildWoodGate,b.buildBridge];Fe.menuName="e_build";b.menuOtherBuild1.xtra=Fe;b.menuBuilds=function(){la(Ge)};
Ge=[b.menuSpecialBuild,b.menuCommonBuild,b.menuOtherBuild,b.buildBarrack,b.buildTower,b.buildStorage,b.buildLumbermill,b.buildFields];Ge.menuName="e_build";b.menuBuilds.iconID=245;b.menuBuilds.xtra=Ge;b.menuBuilds1=function(){la(He)};b.menuBuilds1.iconID=245;He=[b.menuSpecialBuild1,b.menuCommonBuild1,b.menuOtherBuild1,b.buildBarrack1,b.buildTower,b.buildStorage1,b.buildLumbermill1,b.buildFields];He.menuName="a_build";b.menuBuilds1.xtra=He;Yj=function(){b.fishing.obj={};b.impersonate.obj={};b.techGreatWall.obj=
C[48];b.revealSelf.obj={};b.trade.obj={};b.unload.obj={};b.mercFootman6.obj={};b.murder.obj={};b.mercArcher6.obj={};b.mercMaceman6.obj={};b.mercPikeman6.obj={};b.mercLongbowman6.obj={};b.sameSpeed.obj={name:"Same speed"};b.restoreSpeed.obj={name:"Restore speed"};b.mercKnight6.obj={};b.attackGround.obj={};b.steady.obj={};b.bribe.obj={};b.createPriest1.obj=B[127];b.createPriest2.obj=B[87];b.createFootman2.obj=B[80];b.createArcher2.obj=B[81];b.createSatrap.obj=B[83];b.createPikeman2.obj=B[82];b.createHorseArcher2.obj=
B[85];b.createCavalry.obj=B[84];b.createEnichar.obj=B[91];b.createJihad.obj=B[86];b.createMonk.obj=B[128];b.healing.obj={name:x.heal,spcost:[20,0,0,0]};b.bless.obj={name:x.bless,spcost:[20,0,0,0]};b.stopTech.obj={};b.conquest.obj={};b.dcm.obj={name:x.dcm};b.repair.obj={name:x.repair};b.menuOtherBuild.obj={};b.menuOtherBuild1.obj={};b.menuOtherBuild2.obj={};b.sellItems.obj={};b.buyItems.obj={};b.menuBuilds.obj={name:x.menuBuild};b.menuCommonBuild.obj={};b.menuSpecialBuild.obj={};b.techMastery.obj=
C[57];b.techNinjas.obj=C[56];b.teach.obj={name:"Teach",spcost:[20,0,0,0]};b.techPhilosophy.obj=C[55];b.techKungFu.obj=C[53];b.techTournaments.obj=C[54];b.techMeditation.obj=C[52];b.menuCommonBuild1.obj={};b.menuCommonBuild2.obj={};b.createMage1.obj=B[129];b.menuSpecialBuild1.obj={};b.menuSpecialBuild2.obj={};b.menuBuilds1.obj={name:x.menuBuild};b.menuBuilds2.obj={name:x.menuBuild};b.stopBuilding.obj={};b.freeze.obj={name:x.freeze,spcost:[200,0,0,0]};b.invisibility.obj={name:x.invisibility,spcost:[40,
0,0,0]};b.autoInvisibility.obj={name:x.invisibility};b.createHeroes.obj={};b.createMercenaries.obj={};b.upgradeShip.obj={};b.techMedicine.obj=C[35];b.techBless.obj=C[36];b.buildHouse1.obj=B[111];b.techHealing.obj=C[34];b.techInquisition.obj=C[33];b.techArmoredChariot.obj=C[51];b.techRocketArrow.obj=C[69];b.techJewelry.obj=C[64];b.techGunPowder.obj=C[68];b.techSeaFood.obj=C[67];b.techChemistry.obj=C[66];b.techBanking.obj=C[65];b.createMage.obj=B[5];b.techBat.obj=C[38];b.techGolem.obj=C[41];b.techInvisibility.obj=
C[37];b.techLightning.obj=C[40];b.techFreeze.obj=C[39];b.techHeroism.obj=C[22];b.createHorseSamurai.obj=B[70];b.createChariot.obj=B[72];b.createHorseArcher1.obj=B[69];b.createHorseArcher2.obj=B[85];b.createSamurai.obj=B[68];b.createArcher1.obj=B[67];b.techConfusion.obj=C[59];b.techConcentration.obj=C[58];b.techWhirlpool.obj=C[60];b.techDragon.obj=C[61];b.techTurnToStone.obj=C[62];b.techFlameBolt.obj=C[63];b.createRonin.obj=B[66];b.buildStorage.obj=B[18];b.buildStorage1.obj=B[113];b.buildStorage2.obj=
B[94];b.buildFields.obj=B[20];b.buildLumbermill.obj=B[15];b.buildLumbermill1.obj=B[112];b.buildLumbermill2.obj=B[93];b.buildTower.obj=B[32];b.buildBarrack1.obj=B[71];b.buildBarrack.obj=B[14];b.buildBarrack2.obj=B[102];b.buildDummy.obj=B[36];b.buildRocketTower.obj=B[57];b.buildMageTower.obj=B[16];b.buildMageTower1.obj=B[124];b.buildMageTower2.obj=B[107];b.buildMarket.obj=B[33];b.buildMarket1.obj=B[120];b.buildMarket2.obj=B[101];b.buildChurch.obj=B[25];b.buildChurch1.obj=B[118];b.buildChurch2.obj=B[99];
b.buildMerchands.obj=B[24];b.irrigation.obj=C[50];b.ridingHorses.obj=C[49];b.buildMerchands1.obj=B[125];b.buildMerchands2.obj=B[108];b.buildCathedral.obj=B[11];b.buildCathedral1.obj=B[123];b.buildCathedral2.obj=B[106];b.buildAcademy.obj=B[17];b.buildAcademy1.obj=B[126];b.buildAcademy2.obj=B[109];b.buildCastle.obj=B[12];b.magicVision.obj={name:"Magic Vision",spcost:[20,0,0,0]};b.fireRain.obj={name:"Fire Rain",spcost:[200,0,0,0]};b.raiseDead.obj={name:"Raise the Dead",spcost:[40,0,0,0]};b.createJinn.obj=
{name:"Spawn Jinn",spcost:[320,0,0,0]};b.createCarpet.obj={name:"Spawn Magic Carpet",spcost:[320,0,0,0]};b.buildCastle1.obj=B[62];b.buildCastle2.obj=B[63];b.buildHouse.obj=B[31];b.buildHouse2.obj=B[92];b.buildTavern.obj=B[30];b.buildTavern1.obj=B[119];b.buildTavern2.obj=B[100];b.buildStable.obj=B[28];b.buildStable1.obj=B[121];b.buildStable2.obj=B[103];b.buildFarm.obj=B[23];b.buildFarm1.obj=B[114];b.buildFarm2.obj=B[95];b.buildWorkshop.obj=B[29];b.buildWorkshop1.obj=B[117];b.buildWorkshop2.obj=B[98];
b.buildBlacksmith.obj=B[26];b.buildBlacksmith1.obj=B[116];b.buildBlacksmith2.obj=B[97];b.buildBridge.obj=B[35];b.buildHarbor.obj=B[41];b.buildHarbor1.obj=B[115];b.buildHarbor2.obj=B[96];b.createMage2.obj=B[89];b.buildMagicItems.obj={};b.techJanissary.obj=C[86];b.techRiddingHorses.obj=C[85];b.techOreFloatation.obj=C[84];b.techJinn.obj=C[83];b.techNecromancy.obj=C[82];b.techMagicVision.obj=C[81];b.techFireRain.obj=C[80];b.techMagicWorkshop.obj=C[79];b.techCarpet.obj=C[78];b.techJihad.obj=C[77];b.techScimitar.obj=
C[76];b.techHorseManShip.obj=C[75];b.techCowPoaching.obj=C[74];b.buildWoodGate.obj={};b.buildWoodWall.obj=B[13];b.buildOutpost.obj=B[34];b.buildOutpost1.obj=B[122];b.buildOutpost2.obj=B[104];b.createGolem.obj={name:"Spawn Stone Golem",spcost:[480,0,0,0]};b.techSunTzu.obj=C[73];b.techBushido.obj=C[70];b.techLeadership.obj=C[71];b.techHonor.obj=C[72];b.createBat.obj={name:"Spawn Bat",spcost:[40,0,0,0]};b.techGoldMining.obj=C[1];b.techStoneMining.obj=C[2];b.emergeAllUnits.obj={};b.origin.obj={name:"Origin"};
b.createOrk.obj=B[58];b.createDwarf.obj=B[59];b.createSkeleton.obj=B[60];b.createGhost.obj=B[40];b.createFootman.obj=B[0];b.createArcher.obj=B[4];b.techSlavery.obj=C[87];b.createMaceman.obj=B[3];b.createPikeman.obj=B[1];b.createLongbowman.obj=B[6];b.createKnight.obj=B[19];b.mercFootman.obj=g;b.mercArcher.obj=g;b.mercMaceman.obj=g;b.mercPikeman.obj=g;b.mercLongbowman.obj=g;b.mercKnight.obj=g;b.createPeon.obj=B[10];b.createSpy.obj=B[2];b.techFeudalism.obj=C[12];b.techArchitecture.obj=C[13];b.techLearning.obj=
C[14];b.createPeon1.obj=B[64];b.createPeon2.obj=B[79];b.createNinja.obj=B[65];b.techBuddhism.obj=C[45];b.createCrusaders.obj={};b.buildMagicWorkshop.obj=B[110];b.techFanaticism.obj=C[31];b.techCrusade.obj=C[32];b.techEspionage.obj=C[30];b.techChainMail.obj=C[9];b.techHalberd.obj=C[6];b.techLongbow.obj=C[0];b.techScaleArmor.obj=C[5];b.techTemperIron.obj=C[4];b.techPlateArmor.obj=C[10];b.techLandingTactics.obj={};b.createGalleon.obj=B[73];b.createHulk.obj=B[75];b.createXebec.obj=B[76];b.createFishingBoat.obj=
B[74];b.techCrossbow.obj=C[11];b.techWoodCutting.obj=C[3];b.techCannonTower.obj=C[46];b.techEngineering.obj=C[47];b.createBallist.obj=B[38];b.createHeavyCatapult.obj=B[39];b.createCatapult.obj=B[37];b.upgradeCannonTower.obj=C[44];b.upgradeStoneTower.obj=C[43];b.upgradeGuildTower.obj=C[42];b.createCaravan.obj=B[61];b.createCaravan2.obj=B[90];b.techBribery.obj=C[21];b.techSupplyStorage.obj=C[20];b.techUsury.obj=C[19];b.techCropRotation.obj=C[8];b.createCow.obj=B[27];b.techDomestication.obj=C[7];b.techTradeTaxes.obj=
C[18];b.techTradeRoutes.obj=C[17];b.techMapMaking.obj=C[16];b.createPriest.obj=B[9];b.techBodyBuilding.obj=C[29];b.techSiegeTactics.obj=C[28];b.techFame.obj=C[27];b.techHeroes.obj=C[26];b.techMercenaries.obj=C[25];b.techTactics.obj=C[24];b.techWarfare.obj=C[23];for(var c=Object.keys(b),d=0,e=c.length;d<e;d++){var f=b[c[d]];f.objName=c[d];f.obj&&(f.obj.nu=f)}}},Sg=function(b,c,d,e){if(Nd&&!r.editor){var f=Nd.events.defined[c.id];if(f&&f[d])if(f=f[d],"zone"==d)for(b=0,e=f.length;b<e;b+=5){d=f[b];var g=
f[b+2],m=f[b+3],k=f[b+4];c.x32>=f[b+1]&&c.x32<=m&&c.y32>=g&&c.y32<=k?(c.inZone||(c.inZone={}),c.inZone[d.id]||fg([f[b]],1),c.inZone[d.id]=1):c.inZone&&c.inZone[d.id]&&(c.inZone[d.id]=0,fg([f[b]],-1))}else{if(!e)return fg(f,b);P(e.name);c=f.defined;c[e.id]&&fg(c[e.id],b)}}},fg=function(b,c){for(var d=b.length,e=0;e<d;e++){var f=b[e],g=f.rule,m=f.activeEvents;f.activeEvents+=c;0===m?g.activeEvents++:0===f.activeEvents&&g.activeEvents--;if(1==c&&g.activeEvents==g.events.length)for(f=0,g=g.actions,m=
g.length;f<m;f++){var k=g[f];P("action:",k.type);if(vk[k.type])vk[k.type](k.to[0],k.list)}}},vk={attack:oc,move:Bb},Ic={};t("selectUnits").onclick=function(){t("mapeditorinfoUnits").style.display="block";t("mapeditorinfoBuilds").style.display="none";t("mapeditorinfoItems").style.display="none";t("mapeditorinfoNature").style.display="none"};t("selectBuilds").onclick=function(){t("mapeditorinfoUnits").style.display="none";t("mapeditorinfoBuilds").style.display="block";t("mapeditorinfoItems").style.display=
"none";t("mapeditorinfoNature").style.display="none"};t("selectItems").onclick=function(){t("mapeditorinfoUnits").style.display="none";t("mapeditorinfoBuilds").style.display="none";t("mapeditorinfoItems").style.display="block";t("mapeditorinfoNature").style.display="none"};t("selectNature").onclick=function(){t("mapeditorinfoUnits").style.display="none";t("mapeditorinfoBuilds").style.display="none";t("mapeditorinfoItems").style.display="none";t("mapeditorinfoNature").style.display="block"};Ic.start=
function(){Pb();var b=document.createElement("div");b.id="mapForm";b.innerHTML="\n            <div>\n            <h2>"+x.gameOptions+"</h2>\n            <table>\n<tr><td>"+x.mapSize+': </td><td><input type="number" id=\'editorSize\' min="10" value="256" /></td></tr>\n<tr><td>'+x.random+' </td><td>\n<label class="container">\n  <input type="checkbox" id="editorRandom">\n  <span class="checkmark"></span>\n</label>\n</td></tr>\n<tr><td>'+x.nplayers+': </td><td><input id="editorPlayers" type="number" min="1" value="3"></td></tr>\n</table>\n</div>';
var c=document.createElement("button");c.innerHTML=x.continue;c.onclick=Ic.func;b.children[0].appendChild(c);c=document.createElement("button");c.innerHTML=x.cancel;c.onclick=Yl;b.children[0].appendChild(c);document.body.appendChild(b)};var Yl=function(){location.hash="";setTimeout(wh,200);document.body.removeChild(this.parentElement.parentElement);Ya()};Ic.func=function(){P(r.arje);if(void 0==r.arje){Ya();t("editorRandom").checked?r.arje=555555*Math.random()+1:r.arje=!1;r.mapx=parseInt(t("editorSize").value);
r.mapy=r.mapx;r.goldRes=Infinity;r.foodRes=Infinity;r.woodRes=Infinity;r.stoneRes=Infinity;r.gravity=580.9/9.8*9.8;I=[];for(var b=0,c=parseInt(t("editorPlayers").value);b<c;b++)I[b]={color:[~~(256*Math.random()),~~(256*Math.random()),~~(256*Math.random())],IA:!1,name:"Tzar "+(b+1),race:0,team:0};document.body.removeChild(t("mapForm"))}r.editor=1;if(od(0,Ic.func)){t("statButton").style.display="none";t("menu").style.display="none";t("resources").style.display="none";t("mapeditorinfotop").style.display=
"block";t("mapeditorinfo").style.display="block";var d=document.getElementById("mapeditorinfoUnits");d.style.display="block";gg();if(!Ic.preload){Ic.preload=!0;var e={},f={},h=B,m={euro:Za[0],arab:Za[1],asia:Za[2],common:x.common};e[Za[0]]=[];e[Za[1]]=[];e[Za[2]]=[];e[x.common]=[];f[Za[0]]=[];f[Za[1]]=[];f[Za[2]]=[];f[x.common]=[];b=0;for(c=h.length;b<c;b++){var k=h[b];!k.race||k.illegal||7==k.type||k.item||(k.build?f[m[k.race]].put(b):e[m[k.race]].put(b))}for(k=0;2>k;k++){h=Object.keys(e);var l=
{};b=0;for(c=h.length;b<c;l={ul$20:l.ul$20},b++){var q=document.createElement("h1");q.innerHTML=h[b];l.ul$20=document.createElement("ul");q.onclick=function(b){return function(){Cg(b.ul$20)}}(l);l.ul$20.style.display="none";for(var p=e[h[b]],u=Object.keys(p),w={},z=0,A=u.length;z<A;w={tcreate:w.tcreate},z++)m=document.createElement("li"),m.innerHTML=B[p[u[z]]].name,w.tcreate=p[u[z]],m.onclick=function(b){return function(){var c=b.tcreate;B[c].wall?dh(c):O(c)}}(w),l.ul$20.appendChild(m);d.appendChild(q);
d.appendChild(l.ul$20)}e=f;d=t("mapeditorinfoBuilds")}h=Object.keys(xb);d=t("mapeditorinfoItems");ul=document.createElement("ul");e={};b=0;for(c=h.length;b<c;e={u$21:e.u$21},b++)m=document.createElement("li"),e.u$21=xb[h[b]],m.onclick=function(b){return function(){ui(b.u$21)}}(e),m.innerHTML=e.u$21.name,ul.appendChild(m);d.appendChild(ul);d=t("mapeditorinfoNature");q=document.createElement("h1");q.innerHTML=x.trees;ul=document.createElement("ul");q.onclick=function(){Cg(ul)};ul.style.display="none";
m=document.createElement("li");ul.appendChild(m);d.appendChild(q);d.appendChild(ul);m.onclick=function(){Yh(Zl)};m.innerHTML=x.delete;m=document.createElement("li");ul.appendChild(m);m.onclick=function(){Yh($l)};m.innerHTML=x.create;q=document.createElement("h1");q.innerHTML=x.terrain;var C=document.createElement("ul");q.onclick=function(){Cg(C)};C.style.display="none";d.appendChild(q);d.appendChild(C);c=ic.texturesRandomMap;d={};b=0;for(c=c.length;b<c;d={l:d.l},b++)m=document.createElement("li"),
C.appendChild(m),m.innerHTML=b,d.l=b,m.onclick=function(b){return function(){Yh(Zh);Zh.active=b.l}}(d)}}};var gg=function(){var b=t("selectKingdom");b.innerHTML="";for(var c=1,d=F.length;c<d;c++){var e=F[c];1===c&&(b.style.background="rgba("+e.color[0]+","+e.color[1]+","+e.color[2]+",1)");b.innerHTML+='<option value="'+c+'" style="background:rgba('+e.color[0]+","+e.color[1]+","+e.color[2]+',1)">'+e.name+"</option>"}};t("selectKingdom").onchange=function(){w.kingdom=parseInt(this.value);var b=F[w.kingdom].color;
this.style.background="rgba("+b[0]+","+b[1]+","+b[2]+",.8)"};var Cl=function(b){Pb();var c=document.createElement("div"),d=document.createElement("div");c.id="unitProps";var e="<table>"+('\n<tr><td>Name </td><td><input data-prop="name" type="text" value="'+b.name+'" /></td></tr>\n<tr><td>'+x.health+' </td><td><input data-prop="health" type="number" value="'+b.health+'" /></td></tr>\n<tr><td>'+x.maxHealth+'</td> <td><input data-prop="maxHealth" type="number" value="'+b.maxHealth+'" /></td></tr>\n');
if(b.build||b.item)if(b.item){if(b.sword||b.shield)e+="\n<tr><td>"+x.attack+'</td><td><input data-prop="attack" type="number" value="'+(b.attack||0)+'" /></td></tr>\n<tr><td>'+x.defence+'</td> <td><input data-prop="defence" type="number" value="'+(b.defence||0)+'" /></td></tr>\n'}else e+="<tr><td>"+x.kingdom+' </td><td><select id="selectKingdom2">'+t("selectKingdom").innerHTML+"</select></td></tr>";else e+="\n<tr><td>"+x.attack+'</td><td><input data-prop="attack" type="number" value="'+(b.attack||
0)+'" /></td></tr>\n<tr><td>'+x.defence+'</td> <td><input data-prop="defence" type="number" value="'+(b.defence||0)+'" /></td></tr>\n<tr><td>'+x.mana+' <td><input data-prop="mana" type="number" value="'+(b.mana||0)+'" /></td></tr>\n<tr><td>'+x.kingdom+' </td><td><select id="selectKingdom2">'+t("selectKingdom").innerHTML+"</select></td></tr>\n";d.innerHTML=e+"</table>";e=document.createElement("button");e.innerHTML=x.ok;e.onclick=function(){for(var c=t("unitProps").getElementsByTagName("input"),d=
0,e=c.length;d<e;d++)if(c[d]){var g=c[d].value;"number"==c[d].type&&(g=parseInt(g));var k=c[d].dataset.prop;b.__proto__[k]!=g&&(b[k]=g)}c=parseInt(t("selectKingdom2").value);c!=b.kingdom&&b.changeKingdom(c);document.body.removeChild(t("unitProps"));Ya()};d.appendChild(e);c.appendChild(d);document.body.appendChild(c);P(b.kingdom);t("selectKingdom2")&&(t("selectKingdom2").value=b.kingdom)},Aa=function(b){document.getElementById(b).style.display="none"},Ta=function(b){document.getElementById(b).style.display=
"block"},Ih,Yh=function(b){Ih=!0;Q=function(){};var c=X;c.img=l.blank;var d=32*Gd();c.wh=[d,d];Xa(c);c.active=!0;document.addEventListener("mousemove",gc);document.addEventListener("mousedown",wk);gc.active=b},wk=function(b){if(2==b.buttons||b.pageX<w.menumx||b.pageY<w.menumy)return xk();gc(b)},Gj=function(b){if(r.editor){var c=parseInt(t("brushSize").value)+b;c>t("brushSize").max?t("brushSize").value=t("brushSize").max:1>c?t("brushSize").value=1:(t("brushSize").value=c,X.wh&&(X.wh[0]+=32*b,X.wh[1]+=
32*b,X.active=!0))}},Gd=function(){return parseInt(t("brushSize").value)},Zh=function(b,c,d){b=Gd();for(var e=b*b,f=E,g=uc,m=Zh.active,k=ic.type,l=0;l<e;l++){var q=c+l%b,p=d+~~(l/b);ka(q,p)&&(q+=p*f,g[q]=m,k[m]&&(2<M[q]&&A[M[q]].die(),2<Ja[q]&&A[Ja[q]].die()))}Jc()},$l=function(b,c,d){b=Gd();for(var e=b*b,f=E,g=0;g<e;g++){var m=c+g%b,k=d+~~(g/b);ka(m,k)&&(0===M[m+k*f]?.2>Math.random()&&sd([m+k*f,7,{d:3+~~(28*Math.random())}]):(m=A[M[m+k*f]],7==m.type&&m.die()))}},Zl=function(b,c,d){b=Gd();for(var e=
b*b,f=E,g=0;g<e;g++){var m=c+g%b,k=d+~~(g/b);ka(m,k)&&(m=A[M[m+k*f]],7==m.type&&m.die())}},gc=function(b){var c=32*Gd();c=Fb(b.pageX-w.mx-.5*c/ba,b.pageY-.5*c/ba);var d=~~(.03125*c[1]);c=~~(.03125*c[0]);X.x=32*c;X.y=32*d;X.active=!0;if(0!==b.buttons){if(2==b.buttons)return xk();gc.last!==c+d*E&&gc.active&&gc.active(b,c,d);gc.last=c+d*E}},xk=function(){X.active=!0;X.x=-9999;X.y=-9999;Ih=!1;if(gc.active){var b=32*Gd();Fb(event.pageX-w.mx-.5*b/ba,event.pageY-.5*b/ba);gc.active=!1}X.wh=void 0;document.removeEventListener("mousedown",
wk);document.removeEventListener("mousemove",gc)};t("mapProps").onclick=function(){t("mapPropsWindow").style.display="block";Pb();if(""==t("mapPropsWindow").innerHTML){var b=document.createElement("div");t("mapPropsWindow").appendChild(b);var c=document.createElement("table");b.appendChild(c);c=document.createElement("div");c.innerHTML=x.mapName;var d=document.createElement("input");d.value=r.name||x.strcusMap;d.id="mapName";d.type="text";b.appendChild(c);b.appendChild(d);c=document.createElement("div");
c.innerHTML=x.description;d=document.createElement("textarea");d.type="text";d.value=r.description||"";d.id="mapDescription";b.appendChild(c);b.appendChild(d);c=document.createElement("div");c.innerHTML=x.author;d=document.createElement("input");d.id="mapAuthor";d.value=r.author||"";d.type="text";b.appendChild(c);b.appendChild(d);b.appendChild(document.createElement("p"));c=document.createElement("button");c.onclick=yk;c.innerHTML=x.close;b.appendChild(c)}$h()};var yk=function(){P(this);this.parentElement.parentElement.style.display=
"none";Ya()},Ak={objAction:{id:"edobjAction",msg:x.objAction,func:function(){za.active.type="attack";Ta("selectionEvents");Aa("eventZone");Ta("unitListDiv2");t("byButton2").style.display="inline-block";t("byButton1").style.display="inline-block";za.active.zone=void 0}},objZone:{id:"edobjAction",msg:x.objZone,func:function(){za.active.type="zone";za.active.to.length=0;Aa("selectionEvents");t("eventZone").style.display="inline-block";Aa("byButton2");Aa("byButton1");Aa("unitListDiv2");zk()}}},Cd=function(b){if(b)Aa("mapRulesWindow"),
Ya(),Cd.actived=!0;else if(Cd.actived){Ta("mapRulesWindow");Pb();b=~~(J[0]/32);var c=~~(J[1]/32),d=~~(J[9]/32),e=~~(J[10]/32);if(b<d)var f=b,g=d;else f=d,g=b;if(c<e)var m=c,k=e;else m=e,k=c;za.active.zone||(za.active.zone=[]);za.active.zone.put([f,m,g,k]);P(b,c,d,e);zk();Cd.actived=!1}},zk=function(){var b=t("zoneList");b.innerHTML="";var c=za.active.zone;if(c)for(var d=c.length,e=0;e<d;e++){var f=c[e],h=document.createElement("div"),m=document.createElement("button");m.innerHTML="x";m.obj=f;m.pObj=
c;m.spObj=!0;m.onclick=ai;h.innerHTML=f[0]+"x "+f[1]+"y -> "+f[2]+"x "+f[3]+"y";h.appendChild(m);b.appendChild(h)}};t("mapRules").onclick=function(){t("mapRulesWindow").style.display="block";Pb();if(""==t("mapRulesWindow").innerHTML){var b=document.createElement("div");b.innerHTML='\n<div id="mapEvent">\n<h4>'+x.events+'</h4>\n<select id="eventOptions" style="display:none">\n<option value="objAction">'+x.objAction+'</option>\n<option value="objZone">'+x.objZone+'</option>\n</select>\n<div id="eventScreen">\n</div>\n<div id="eventLayout">\n</div>\n<button id="addEvent">+</button>\n</div>\n<div id="mapActions">\n<h4>'+
x.actions+'</h4>\n<select id="actionOptions" style="display:none">\n<option value="objOrder">'+x.objOrder+'</option>\n</select>\n<div id="actionScreen">\n</div>\n<div id="actionLayout">\n</div>\n<button id="addAction">+</button>\n</div>\n<h4>'+x.rules+"</h4>\n";var c=document.createElement("div");c.id="rulist";b.appendChild(c);c=document.createElement("button");c.onclick=am;c.innerHTML="+";b.appendChild(c);c.id="addRule";b.appendChild(document.createElement("p"));c=document.createElement("button");
c.onclick=yk;c.innerHTML=x.close;b.appendChild(c);t("mapRulesWindow").appendChild(b);t("addEvent").onclick=bm;t("addAction").onclick=cm;t("eventOptions").onchange=function(){var b=Ak[this.value];za.div=b.id;Ta(za.div);za.active.name=this.value;b.func&&b.func();b=t("eventScreen").getElementsByTagName("button");for(var c=!1,d=0,e=b.length;d<e;d++){var f=b[d];if(f.sdiv)if("none"==f.style.display)f.sdiv.style.display="none";else{if(!c)f.onclick();c=!0}}hg(Nb.active,"eventLayout")};t("actionOptions").onchange=
function(){bb.active.name=this.value;hg(Nb.active,"actionLayout")};b=document.createElement("div");b.id="edobjAction";var d=document.createElement("select");d.innerHTML='\n<option value="attack">'+x.attack+'</option>\n<option value="destroy">'+x.destroy+'</option>\n<option value="moving">'+x.moving+'</option>\n<option value="capture">'+x.capture+"</option>\n";d.value="attack";d.id="selectionEvents";d.onchange=dm;var e=document.createElement("section"),f=document.createElement("section"),h=document.createElement("section"),
m=document.createElement("section"),k=document.createElement("section");c=document.createElement("button");c.innerHTML=x.add;c.onclick=Cd;var l=document.createElement("div");l.className="unitList";l.id="zoneList";h.appendChild(c);h.appendChild(l);l=document.createElement("div");l.className="unitList";l.id="unitListDiv";l.spType=za;c=document.createElement("button");c.innerHTML=x.add;c.onclick=function(){Lb(this)};c.button=l;c.style.margin="10px";e.appendChild(c);c=document.createElement("button");
c.innerHTML=x.defined;c.onclick=Ab;c.sdiv=e;b.appendChild(c);c.onclick();c=document.createElement("button");c.innerHTML=x.undefined;c.onclick=Ab;c.sdiv=f;b.appendChild(c);e.appendChild(l);b.appendChild(e);b.appendChild(f);b.appendChild(document.createElement("p"));b.appendChild(d);b.appendChild(document.createElement("p"));l=document.createElement("div");l.className="unitList";l.id="unitListDiv2";l.spType=za;c=document.createElement("button");c.innerHTML=x.add;c.onclick=function(){Lb(this)};c.button=
l;c.style.margin="10px";m.appendChild(c);c=document.createElement("button");c.innerHTML=x.defined;c.onclick=Ab;c.sdiv=m;c.id="byButton1";b.appendChild(c);c=document.createElement("button");c.innerHTML=x.undefined;c.onclick=Ab;c.id="byButton2";c.sdiv=k;b.appendChild(c);m.appendChild(l);c=document.createElement("button");c.innerHTML=x.zone;c.onclick=Ab;c.sdiv=h;c.id="eventZone";c.style.display="none";b.appendChild(c);b.appendChild(h);b.appendChild(m);b.appendChild(k);t("eventScreen").appendChild(b);
Aa("mapEvent");Aa("mapActions");b=document.createElement("div");b.id="edobjOrder";d=document.createElement("select");d.innerHTML='\n<option value="move">'+x.move+'</option>\n<option value="attack">'+x.attack+"</option>\n";d.value="move";d.id="selectionActions";d.onchange=em;e=document.createElement("section");f=document.createElement("section");m=document.createElement("section");k=document.createElement("section");l=document.createElement("div");l.className="unitList";l.id="unitListDivAction";l.spType=
bb;c=document.createElement("button");c.innerHTML=x.add;c.onclick=function(){Lb(this)};c.button=l;c.style.margin="10px";e.appendChild(c);c=document.createElement("button");c.innerHTML=x.defined;c.onclick=Ab;c.sdiv=e;b.appendChild(c);c=document.createElement("button");c.innerHTML=x.undefined;c.onclick=Ab;c.sdiv=f;b.appendChild(c);e.appendChild(l);b.appendChild(e);b.appendChild(f);c.onclick();b.appendChild(document.createElement("p"));b.appendChild(d);b.appendChild(document.createElement("p"));l=document.createElement("div");
l.className="unitList";l.id="unitListDivAction2";l.spType=bb;c=document.createElement("button");c.innerHTML=x.add;c.onclick=function(){Lb(this)};c.button=l;c.style.margin="10px";m.appendChild(c);c=document.createElement("button");c.innerHTML=x.defined;c.onclick=Ab;c.sdiv=m;c.id="toButton1";b.appendChild(c);c=document.createElement("button");c.innerHTML=x.undefined;c.onclick=Ab;c.id="toButton2";c.sdiv=k;b.appendChild(c);m.appendChild(l);b.appendChild(m);b.appendChild(k);c.onclick();t("actionScreen").appendChild(b);
Aa("mapEvent");Aa("mapActions")}};var Bk={moving:1},dm=function(){Bk[this.value]?(Aa("byButton2"),Aa("byButton1"),Aa("unitListDiv2")):(Ta("unitListDiv2"),t("byButton2").style.display="inline-block",t("byButton1").style.display="inline-block");za.active.type=this.value},em=function(){Bk[this.value]?(Aa("toButton2"),Aa("toButton1"),Aa("unitListDivAction2")):(Ta("unitListDivAction2"),t("toButton2").style.display="inline-block",t("toButton1").style.display="inline-block");bb.active.type=this.value},Lb=
function(b){if(b)Aa("mapRulesWindow"),Ya(),Lb.actived=b.button;else if(Lb.actived){Ta("mapRulesWindow");Pb();b=Lb.actived.spType.active;b="unitListDiv2"==Lb.actived.id||"unitListDivAction2"==Lb.actived.id?b.to:b.list;for(var c={},d=0,e=b.length;d<e;d++)c[b[d]]=1;d=0;for(e=G.length;d<e;d++)c[G[d]]||b.put(G[d]);Oe(Lb.actived,b);Lb.actived=!1}},Oe=function(b,c){b.innerHTML="";for(var d=0,e=c.length;d<e;d++){var f=document.createElement("div");f.innerHTML=A[c[d]].name;var g=document.createElement("button");
g.onclick=ai;g.innerHTML="x";g.pObj=c;g.spObj=!0;g.obj=c[d];f.appendChild(g);b.appendChild(f)}},Ab=function(){Ab.active&&(Ab.active.className="");Ab.active=this;this.className="spSelect";for(var b=this.parentElement.getElementsByTagName("section"),c=0,d=b.length;c<d;c++)b[c].style.display="none";this.sdiv.style.display="block"},Nb=function(){var b=this.editorRule;b.deleted||(Ta("mapEvent"),Ta("mapActions"),Aa("eventOptions"),Nb.active&&(Nb.div.className=""),this.className="spSelect",Nb.active=b,Nb.div=
this,hg(b,"eventLayout"),hg(b,"actionLayout"),za.div&&Aa(za.div),za.div1=void 0)},za=function(){var b=this.editorRule;b.deleted||(Ta("eventOptions"),za.div1&&(za.div1.className=""),this.className="spSelect",za.active=b,t("selectionEvents").value=b.type,za.div1=this,t("eventOptions").value=b.name,za.div=Ak[b.name].id,Ta(za.div),Oe(t("unitListDiv"),b.list),Oe(t("unitListDiv2"),b.to))},bb=function(){var b=this.editorRule;b.deleted||(Ta("actionOptions"),bb.div1&&(bb.div1.className=""),this.className=
"spSelect",bb.active=b,t("selectionActions").value=b.type,bb.div1=this,t("actionOptions").value=b.name,bb.div="ed"+b.name,Ta(bb.div),Oe(t("unitListDivAction"),b.list),Oe(t("unitListDivAction2"),b.to))},hg=function(b,c){t(c).innerHTML="";if("eventLayout"==c){b=b.events;var d=za,e=Nb.active.events}else b=b.actions,d=bb,e=Nb.active.actions;for(var f=0,g=b.length;f<g;f++){var m=document.createElement("div");ig(m,b[f],d,e);t(c).appendChild(m)}},bm=function(){var b=Nb.active,c={name:"objAction",list:[],
to:[],type:"attack"};b.events.put(c);var d=document.createElement("div");ig(d,c,za,b.events);t("eventLayout").appendChild(d);if(za.div1)za.div1.onclick()},cm=function(){var b=Nb.active,c={name:"objOrder",list:[],to:[],type:"move"};b.actions.put(c);var d=document.createElement("div");ig(d,c,bb,b.actions);t("actionLayout").appendChild(d);if(bb.div1)bb.div1.onclick()},ig=function(b,c,d,e){b.innerHTML=c.events?c.name:x[c.name];b.onclick=d;b.editorRule=c;d=document.createElement("button");d.innerHTML=
"x";d.obj=c;d.pObj=e;d.onclick=ai;b.appendChild(d)},am=function(){r.rules||(r.rules=[]);var b={name:"Rule"+r.rules.length,events:[],actions:[]};r.rules.put(b);var c=document.createElement("div");ig(c,b,Nb,r.rules);t("rulist").appendChild(c)},ai=function(){this.pObj.quit(this.obj);this.obj.deleted=!0;this.parentElement.parentElement.removeChild(this.parentElement);if(!this.spObj)if(this.pObj!==r.rules)Nb.div.onclick();else Aa("mapEvent"),Aa("mapActions")};t("infiniteValue").onchange=function(){var b=
this.checked;t("goldValue").disabled=b;t("stoneValue").disabled=b;t("woodValue").disabled=b;t("foodValue").disabled=b};t("infiniteValue").onchange();var $h=function(){var b=t("mapPropsWindow").getElementsByTagName("table")[0];b.innerHTML="";b.innerHTML+="<tr><td>"+x.color+"</td><td>"+x.username+"</td><td>"+x.AI+"</td><td>"+x.team+"</td></tr>";for(var c=1,d=F.length;c<d;c++){var e=F[c],f=e.color;f="#"+(16777216+(f[0]<<16)+(f[1]<<8)+f[2]).toString(16).slice(1);b.innerHTML+='<tr><td><input style="background:'+
f+'" type="color" value="'+f+'" /></td><td><input type="text" value="'+e.name+'"></td><td><label class="container">\n  <input type="checkbox">\n  <span class="checkmark"></span>\n</label></td><td><input type="number" min="0" value="'+e.team+'"></td></tr>'}b.innerHTML+="<tr><td><button id='editorAdd'>+</button><button id='editorDelete'>-</button></td></tr>";t("editorAdd").onclick=fm;t("editorDelete").onclick=gm;b=b.getElementsByTagName("input");c=0;for(d=F.length-1;c<d;c++)f=4*c,e=F[c+1],b[f].onchange=
hm,b[f+1].onchange=im,b[f+2].onchange=jm,b[f+2].checked=e.IA,b[f+3].onchange=km,b[f].team=c+1,b[f+1].team=c+1,b[f+2].team=c+1,b[f+3].team=c+1},fm=function(){new kc("Tzar "+F.length,[~~(256*Math.random()),~~(256*Math.random()),~~(256*Math.random())],[0],0,!0,[r.goldRes,r.woodRes,r.foodRes,r.stoneRes],2);gg();$h()},gm=function(){if(2<F.length){for(var b=F.length-1,c=3,d=A.length;c<d;c++){var e=A[c];e.kingdom==b&&e.die()}F.length--;gg();$h()}},hm=function(){var b=F[this.team],c=parseInt(this.value.substr(1),
16),d=c>>16&255,e=c>>8&255;c&=255;b.color=[d,e,c];var f=this.team;b=lb[f];F[f].color=[d,e,c];f*=3;Fa[f]=d/255;Fa[f+1]=e/255;Fa[f+2]=c/255;d=0;for(e=b.length;d<e;d++){c=b[d];f=0;for(var h=c.length;f<h;f++)rc(A[c[f]])}gg()},im=function(){F[this.team].name=this.value},jm=function(){F[this.team].IA=this.checked?!0:!1},km=function(){var b=F[this.team];b.team=parseInt(this.value);for(var c=F.length,d=1;d<c;d++){var e=F[d];e.team!==b.team&&(e.diplomacy[b.k]=1,b.diplomacy[e.k]=1)}};ve.onchange=function(b){ea(lh,
parseInt(ve.value)/100,G)};t("mapload").onchange=function(b){b=document.getElementById("mapload").files[0];var c=new FileReader;c.onload=function(){var b=new Uint8Array(this.result);P(b[0]);var c=b[1]+(b[2]<<8)+(b[3]<<16)+(b[4]<<24),f=new TextDecoder("utf-8");f=JSON.parse(Nk(f.decode(b.slice(5,c+5))));if(!1===f.arje){b=b.slice(c+5,c+5+Math.pow(f.mapx,2));var g=Math.pow(f.mapx,2);c=b.length;g=g?new Uint8Array(g):[];for(var m=0,k=0;k<c;k++){var l=b[k];if(255!==l)g[m++]=l;else{l=b[k-1];for(var q=(b[k+
1]<<8)+b[k+2],p=0;p<q;p++)g[m++]=l;k+=2}}f.terrain=g}f.allunits&&(f.allunits=lk(f.allunits));f.ini&&(f.ini=lk(f.ini));Ta("customMapcont");t("editCustom").style.display="inline-table";La=f;La.kingdomStart?(t("seeStats").style.display="inline-table",t("playrecord").style.display="inline-table"):(t("seeStats").style.display="none",t("playrecord").style.display="none");null===La.goldRes&&(La.goldRes=Infinity);null===La.stoneRes&&(La.stoneRes=Infinity);null===La.foodRes&&(La.foodRes=Infinity);null===La.woodRes&&
(La.woodRes=Infinity);f=document.getElementById("custombody");f.innerHTML="";b=La.kingdoms;c=0;for(g=b.length;c<g;c++)m=b[c],k=m.color,f.innerHTML+="<tr><td style='background:rgb("+k[0]+","+k[1]+","+k[2]+')\' class="ucolor1"></td><td class="username1">'+m.name+'</td><td style="display:none" class="race1">'+m.race+'</td><td class="team1">'+m.team+"</td></tr>"};c.readAsArrayBuffer(b)};var La,lm=function(b){var c={Blue:189,Red:13506841,Green:3257600,Purple:11337925,Yellow:16768512,Cyan:46517,Orange:16751649,
Gray:5921370},d=b.split(["[Player"]),e=b.split("GameDuration =")[1].split("[")[0].split(" min")[0].split(" ")[1],f=[];b=[];for(var g=1,m=d.length;g<m;g++){var k=d[g].split("\n"),l={};f[g-1]=l;for(var q=0,p=k.length;q<p;q++){var r=k[q];r=r.split(" = ");if(r[1]&&q){r[1]=r[1].trim();"Color"==r[0]&&(r[1]=c[r[1]]);"Type"==t&&"Status"!==r[0]&&b.put("N");r[1]=encodeURIComponent(r[1]);b.put(r[1]);l[r[0]]=r[1];var t=r[0]}}}c=f[0].Name+"'s Game";var w=new XMLHttpRequest;w.open("POST",baseUrl+"php/stats.php",
!0);w.setRequestHeader("Content-type","application/x-www-form-urlencoded");w.onreadystatechange=function(){200===w.status&&4===w.readyState&&(location.hash="MatchX"+w.responseText)};b=b.join("<");w.send("arr="+b+"&time="+6E4*e+"&name="+c+"&players="+f.length)},bi=function(b,c){for(var d=0,e=0,f=b.length;e<f;e++)d+=c[b[e]];return d},ci=function(b,c,d){var e=["",d];performance.now();for(var f=0,g=b.length;f<g;f++){var m=b[f],k=m.stats,l=k.resources,q=k.unitCountMax,p=24*f+2,r=m.color,w=m.IA;w=w?"IA":
"Human";e[p]=(r[0]<<16)+(r[1]<<8)+r[2];e[p+1]=m.name;e[p+1]=m.name;e[p+2]=w;e[p+3]=m.status;e[p+4]=m.team;e[p+5]=Za[m.race];e[p+6]=k.score;e[p+7]=l[0];e[p+8]=l[1];e[p+9]=l[2];e[p+10]=l[3];e[p+11]=k.dmgInflicted;e[p+12]=k.dmgTaken;e[p+13]=k.unitsKilled;e[p+14]=k.unitsLosed;e[p+15]=k.buildsDestroyed;e[p+16]=k.buildsLosed;e[p+17]=bi([10,79,64],q);e[p+18]=bi([32,44],q);e[p+19]=bi([55,56],q);e[p+20]=0;e[p+21]=0;e[p+22]=0;e[p+23]=0}Ck(e,c);c&&setTimeout(function(){"block"==t("ingameStats").style.display&&
ci(b,c,d)},500)},Ck=function(b,c){for(var d="<tr style='background:#000;'><td style='    padding-right: 150px;'>Name</td><td>Type</td><td>Status</td><td>Team</td><td>Race</td><td>Score</td><td>Gold</td><td>Wood</td><td>Food</td><td>Stone</td><td title='Damage Inflicted'>D.I</td><td title='Damage Taken'>D.T</td><td title='Units Killed'>U.K</td><td title='Units Losed'>U.L</td><td title='Buildings Destroyed'>B.D</td><td title='Buildings Losed'>B.L</td><td title='Maximum Peasants'>M.P</td><td title='Maximum Towers'>M.T</td><td title='Maximum Stone Towers'>M.S.T</td><td title='Gold Traded'>G.T</td><td title='Stone Traded'>S.T</td><td title='Gold Converted'>G.C</td><td title='Stone Converted'>S.C</td></tr>",
e=2,f=b.length;e<f;e++)if((e-2)%24)0!==(e-3)%24&&(g=~~((e-2)/24)%2?"style = 'background:rgba(0,0,0,0.45)'":"style = 'background:rgba(0,0,0,0.65)'"),d+="<td "+g+">"+qb(decodeURIComponent(b[e]))+"</td>";else{e-2&&(d+="</tr>");g=parseInt(qb(decodeURIComponent(b[e])));var g="style = 'background:rgba("+Math.floor(g/65536)+","+Math.floor(g/256)%256+","+g%256+",0.45)'";d+="<tr>"}d+="</tr>";c?(t("ingameStats").style.display="block",t("statsGame").innerHTML="<tbody>"+d+"</tbody>",c=t("statsGame").getElementsByTagName("td")):
(t("MatchX").style.display="block",t("returnmenu").style.display="block",t("statsTable").innerHTML="<tbody>"+d+"</tbody>",c=t("statsTable").getElementsByTagName("td"));b=[];e=0;for(f=c.length;e<f;e++)d=e%23,4<d&&23<e&&(b[d-5]||(b[d-5]=[]),b[d-5].put(c[e]));e=0;for(f=b.length;e<f;e++){c=b[e];c.sort(Pk);d=c.length;if(!c[1])break;c[0].innerHTML!=c[1].innerHTML&&(c[0].style.background="rgba(127,0,0,0.45)");c[d-1].innerHTML!=c[d-2].innerHTML&&(c[d-1].style.background="rgba(0,127,0,0.45)")}};t("statsLoad").onchange=
function(){var b=document.getElementById("statsLoad").files[0],c=new FileReader;c.onloadend=function(b){lm(b.target.result)};b&&c.readAsText(b,"ascii")};var Ok=function(b){var c=new XMLHttpRequest;c.open("POST",baseUrl+"php/loadstat.php",!0);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");Dk(c,function(b){Ck(b.responseText.split("<"))});P(b);c.send("id="+b)},Dk=function(b,c){b.onreadystatechange=function(){4===b.readyState&&(200===b.status?c(b):alert("Error: "+b.status))}};
t("deleteUnit").onclick=function(){ea(ue,1,G.slice(0))};t("rotatebutton").onclick=function(){for(var b=G,c=0,d=b.length;c<d;c++){var e=A[b[c]];e.build||(e.d=(e.d+1)%8,Z(e,e.img))}};t("gameMenu").onclick=li;t("menueditor").onclick=li;t("quitButton1").onclick=function(){ti("playingMenu");r.online&&Ph();I.length=0;G=[];gb=void 0;clearInterval(bf);F=[];hc={};Mh=8;Ya();r={canceled:!0};I.length=0;A=[{terrain:1},{terrain:1},{terrain:1}];Qc={};Pc={};ec={};Ib.length=0;lb=[];Hb=[];Fa=[];w.admin=!1;Gb=w.kingdom=
void 0;zj={euro:0,arab:0,asia:0};Ha.stop();cd=document.getElementById("msgs");eg=document.getElementById("msginput");window.removeEventListener("mousemove",vb);window.removeEventListener("keydown",Kj);window.removeEventListener("keyup",Lj);window.removeEventListener("mousemove",Mj);window.removeEventListener("mousedown",Nj);window.removeEventListener("mouseup",Oj);Wb();document.getElementById("playermenu").style.display="block";document.getElementById("playingMenu").style.display="none"};t("backToGame").onclick=
function(){t("playingMenu").style.display="none";Ya()};t("backToGameS").onclick=function(){ti("ingameStats");Ya()};t("statButton").onclick=function(){ci(F.slice(1),!0,r.now());Pb()};t("returnmenu1").onclick=Wb;t("returnmenu").onclick=Wb;t("refreshButton1").onclick=Bg;t("sendmsg").onclick=zh;t("start1").onclick=nk;t("start2").onclick=od;t("alertok").onclick=function(){t("alert").style.display="none";Ya()};t("saveGame").onclick=function(){r.editor&&(r.arje=!1,t("mapDescription")&&(r.description=t("mapDescription").value,
r.name=t("mapName").value,r.author=t("mapAuthor").value));delete r.terrain;var b=r,c=A,d=[];d.length=c.length-3;for(var e=3,f=c.length;e<f;e++){var h=c[e],k=B[h.type],l={0:h.kingdom,1:h.d,2:h.type,3:h.img,4:h.x32,5:h.y32};h.name!==k.name&&(l[6]=h.name);h.iconID!==k.iconID&&(l[7]=h.iconID);h.attack!==k.attack&&(l[8]=h.attack);h.defence!==k.defence&&(l[9]=h.defence);h.level!==k.level&&(l[10]=h.level);h.health!==k.health&&(l[11]=h.health);h.maxHealth!==k.maxHealth&&(l[12]=h.maxHealth);h.func&&(l[13]=
h.func);h.funcObj&&(l[14]=h.funcObj);h.workers&&h.workers.length&&(l[15]=h.workers);h.workingOn&&(l[16]=h.workingOn);h.inventory&&h.inventory.length&&(l[17]=h.inventory);h.dix&&(l[18]=h.dix);h.diy&&(l[19]=h.diy);h.timestamp&&(l[20]=h.timestamp);h.working&&(l[21]=h.working);h.rnd&&(l[22]=h.rnd);h.techID&&(l[23]=h.techID);h.techStart&&(l[24]=h.techStart);h.activeTech&&(l[25]=h.activeTech);h.levelProgress&&(l[26]=h.levelProgress);h.c&&(l[27]=h.c);h.mimg&&(l[28]=h.mimg);void 0!==h.built&&(l[29]=h.built);
void 0!==h.xf&&(l[30]=h.xf);void 0!==h.yf&&(l[31]=h.yf);void 0!==h.action&&(l[32]=h.action);h.point&&(l[33]=h.point);h.waitlist&&(l[34]=h.waitlist);h.mv&&(l[35]=h.mv);h.work&&(l[36]=h.work);h.death&&(l[37]=h.death);h.freezed&&(l[38]=h.freezed);h.confused&&(l[39]=h.confused);h.sword&&(l[40]=h.sword);h.shield&&(l[41]=h.shield);h.book&&(l[42]=h.book);h.spy&&(l[43]=h.spy);d[e-3]=l}b.allunits=d;r.movtable=Pc;r.movtable2=Qc;r.kingdomStart||r.editor||(r.kingdomStart=Oh);r.kingdoms=F.slice(1);Infinity==r.goldRes&&
Infinity==r.stoneRes&&Infinity==r.foodRes&&Infinity==r.woodRes&&(r.infinity=!0);c=r;c=JSON.stringify(c);b={};c=(c+"").split("");d=[];f=c[0];h=256;for(k=1;k<c.length;k++)e=c[k],null!=b[f+e]?f+=e:(d.push(1<f.length?b[f]:f.charCodeAt(0)),b[f+e]=h,h++,f=e);d.push(1<f.length?b[f]:f.charCodeAt(0));for(k=0;k<d.length;k++)d[k]=String.fromCharCode(d[k]);c=d.join("");b=(new TextEncoder).encode(c);b=[new Uint8Array([55]),new Uint8Array((new Uint32Array([b.length])).buffer),b];0==r.arje&&b.put(Ql(uc));b=new Blob(b,
{type:"application/octet-binary"});b=URL.createObjectURL(b);c=document.createElement("a");document.body.appendChild(c);c.style="display: none";c.href=b;c.download="savegame.tzared";c.click();r.allunits=void 0};t("closeButton1").onclick=function(){t("mapconfiguration").style.display="none";Ya()};t("createGame1").onclick=kk;t("copyButton").onclick=function(){document.getElementById("onlineID").select();document.execCommand("Copy")};t("startCustom").onclick=function(){r=Object.assign({},La);r.editor=
!1;r.custom=!0;r.online=!1;La=void 0;Aa("customMapcont");od(!1,!1)};t("editCustom").onclick=function(){r=Object.assign({},La);r.custom=!0;Ic.func();La=void 0;Aa("customMapcont")};t("playrecord").onclick=function(){r=Object.assign({},La);r.online=!1;r.custom=!0;r.demo=!0;r.cycle=0;r.editor=!1;La=void 0;Aa("customMapcont");od(!1,!1)};t("seeStats").onclick=function(){ci(La.kingdoms,!1,25*La.cycle);location.hash="MatchX"};var mm=function(){P(this,this.checked);localStorage[this.localProp]=this.checked},
Ek=function(){"color"==this.type&&(this.style.backgroundColor=this.value);w[this.localProp]=this.value;localStorage[this.localProp]=this.value},qi={MatchHistory:function(){document.getElementById("returnmenu").style.display="block";var b=new XMLHttpRequest;b.open("GET",baseUrl+"php/latest.php",!0);Dk(b,function(b){b=b.responseText.split("|");for(var c=b.length-1,e="",f=0;f<c;f+=5)e+="<tr id='statList"+qb(decodeURIComponent(b[f]))+"'><td>"+qb(decodeURIComponent(b[f+1]))+"</td><td>"+qb(decodeURIComponent(b[f+
2]))+"</td><td>"+qb(decodeURIComponent(b[f+3]))+"</td><td>"+parseInt(qb(decodeURIComponent(b[f+4])))/6E4+" min</td></tr>";document.getElementById("matchtable").innerHTML="<tbody>"+e+"</tbody>";e={};for(f=0;f<c;e={l:e.l},f+=5)e.l=qb(decodeURIComponent(b[f])),t("statList"+e.l).onclick=function(b){return function(){location.hash="MatchX"+b.l}}(e)});b.send(null)},GameList:Bg,RandomMap:fc,Twitter:function(){document.getElementById("returnmenu").style.display="block"},Account:function(){Fd.returnmenu.style.display=
"block";""==Fd.Account.innerHTML&&(Fd.Account.innerHTML='<iframe id="accountIframe"></iframe>',Fd.accountIframe=document.getElementById("accountIframe"));Fd.accountIframe.src=baseUrl+w.langCodeUrl+"account/?iframe=1"},MapEditor:Ic.start,CustomMap:function(){document.getElementById("returnmenu").style.display="block"},Settings:function(){var b=t("Settings");if(""==b.innerHTML){var c=document.createElement("h2");c.innerHTML=x.strSettings;b.appendChild(c);c=document.createElement("div");var d=document.createElement("span");
d.innerHTML=x.color;c.appendChild(d);var e=document.createElement("input");e.type="color";e.value=localStorage.color;e.onchange=Ek;e.localProp="color";e.style.backgroundColor=localStorage.color;c.appendChild(e);d=document.createElement("span");d.innerHTML=x.username;c.appendChild(d);e=document.createElement("input");e.type="text";e.value=localStorage.name;e.onchange=Ek;e.localProp="name";c.appendChild(e);d=document.createElement("span");d.innerHTML=x.offlinePlay;c.appendChild(d);d=document.createElement("button");
d.innerHTML=x.downloadAll;d.onclick=yc;c.appendChild(d);d=document.createElement("span");d.innerHTML=x.fullscreen;c.appendChild(d);var f=document.createElement("label");f.className="container";d=document.createElement("span");d.className="checkmark";e=document.createElement("input");e.type="checkbox";e.checked="true"==localStorage.fullscreen?!0:!1;e.onchange=mm;e.localProp="fullscreen";f.appendChild(e);f.appendChild(d);c.appendChild(f);b.appendChild(c)}Ta("returnmenu")}};oi();var Yb=[Mc,Ff,Vc,Tc,
ie,uf,Pf,Hf,yf,wf,Ef,Rf,Kf,lj,Tf,Af,Cf,Mf,ke,Vd,Hd,Ii,cf,Og,Gi,kj,qf,pj,rj,yd,sh,sj,tj,uj,vj,qf,bk,gj,wj,Yd,hj,jf,ej,fj,ih,jh,be,qc,hh,Uc,Tc,ee,Vc,Oc,td,ge,Y,function(b){var c=b[1],d=A[b[2]];b=C[b[0]];F[d.kingdom].technology.hidden[b.id.id]=0;pc(d,b,c);la.actv[b.id.id]&&aa(!1)},$d,mf,ab,Yi,ob,nf,fh,Ud,Gh,Dj,oj,ph,Jf];(function(){for(var b=0,c=Yb.length;b<c;b++)Yb[b].url=b})();Vd.rule="moving";jh.rule="attack"})();
