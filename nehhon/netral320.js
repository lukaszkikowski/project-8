/*
 JSON v3.2.6 | http://bestiejs.github.io/json3 | Copyright 2012-2013, Kit Cambridge | http://kit.mit-license.org  https://mths.be/utf8js v2.0.0 by @mathias */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(z,K,ka){z!=Array.prototype&&z!=Object.prototype&&(z[K]=ka.value)};$jscomp.getGlobal=function(z){return"undefined"!=typeof window&&window===z?z:"undefined"!=typeof global&&null!=global?global:z};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var z=0;return function(K){return $jscomp.SYMBOL_PREFIX+(K||"")+z++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var z=$jscomp.global.Symbol.iterator;z||(z=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[z]&&$jscomp.defineProperty(Array.prototype,z,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(z){var K=0;return $jscomp.iteratorPrototype(function(){return K<z.length?{done:!1,value:z[K++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(z){$jscomp.initSymbolIterator();z={next:z};z[$jscomp.global.Symbol.iterator]=function(){return this};return z};$jscomp.iteratorFromArray=function(z,K){$jscomp.initSymbolIterator();z instanceof String&&(z+="");var ka=0,ra={next:function(){if(ka<z.length){var A=ka++;return{value:K(A,z[A]),done:!1}}ra.next=function(){return{done:!0,value:void 0}};return ra.next()}};ra[Symbol.iterator]=function(){return ra};return ra};
$jscomp.polyfill=function(z,K,ka,ra){if(K){ka=$jscomp.global;z=z.split(".");for(ra=0;ra<z.length-1;ra++){var A=z[ra];A in ka||(ka[A]={});ka=ka[A]}z=z[z.length-1];ra=ka[z];K=K(ra);K!=ra&&null!=K&&$jscomp.defineProperty(ka,z,{configurable:!0,writable:!0,value:K})}};$jscomp.polyfill("Array.prototype.keys",function(z){return z?z:function(){return $jscomp.iteratorFromArray(this,function(z){return z})}},"es6","es3");
$jscomp.polyfill("Object.getOwnPropertySymbols",function(z){return z?z:function(){return[]}},"es6","es5");$jscomp.findInternal=function(z,K,ka){z instanceof String&&(z=String(z));for(var ra=z.length,A=0;A<ra;A++){var Va=z[A];if(K.call(ka,Va,A,z))return{i:A,v:Va}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(z){return z?z:function(z,ka){return $jscomp.findInternal(this,z,ka).v}},"es6","es3");$jscomp.owns=function(z,K){return Object.prototype.hasOwnProperty.call(z,K)};
$jscomp.polyfill("Object.assign",function(z){return z?z:function(z,ka){for(var K=1;K<arguments.length;K++){var A=arguments[K];if(A)for(var Va in A)$jscomp.owns(A,Va)&&(z[Va]=A[Va])}return z}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(z){return z?z:function(){return $jscomp.iteratorFromArray(this,function(z,ka){return ka})}},"es8","es3");$jscomp.polyfill("Math.sign",function(z){return z?z:function(z){z=Number(z);return 0===z||isNaN(z)?z:0<z?1:-1}},"es6","es3");
$jscomp.polyfill("Number.isFinite",function(z){return z?z:function(z){return"number"!==typeof z?!1:!isNaN(z)&&Infinity!==z&&-Infinity!==z}},"es6","es3");$jscomp.polyfill("Number.isInteger",function(z){return z?z:function(z){return Number.isFinite(z)?z===Math.floor(z):!1}},"es6","es3");$jscomp.makeIterator=function(z){$jscomp.initSymbolIterator();var K=z[Symbol.iterator];return K?K.call(z):$jscomp.arrayIterator(z)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(z){function K(){this.batch_=null}function ka(z){return z instanceof A?z:new A(function(A,Qa){A(z)})}if(z&&!$jscomp.FORCE_POLYFILL_PROMISE)return z;K.prototype.asyncExecute=function(z){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(z);return this};K.prototype.asyncExecuteBatch_=function(){var z=this;this.asyncExecuteFunction(function(){z.executeBatch_()})};var ra=$jscomp.global.setTimeout;K.prototype.asyncExecuteFunction=function(z){ra(z,
0)};K.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var z=this.batch_;this.batch_=[];for(var A=0;A<z.length;++A){var K=z[A];delete z[A];try{K()}catch(ke){this.asyncThrow_(ke)}}}this.batch_=null};K.prototype.asyncThrow_=function(z){this.asyncExecuteFunction(function(){throw z;})};var A=function(z){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var A=this.createResolveAndReject_();try{z(A.resolve,A.reject)}catch(je){A.reject(je)}};A.prototype.createResolveAndReject_=
function(){function z(z){return function(Qa){K||(K=!0,z.call(A,Qa))}}var A=this,K=!1;return{resolve:z(this.resolveTo_),reject:z(this.reject_)}};A.prototype.resolveTo_=function(z){if(z===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(z instanceof A)this.settleSameAsPromise_(z);else{a:switch(typeof z){case "object":var K=null!=z;break a;case "function":K=!0;break a;default:K=!1}K?this.resolveToNonPromiseObj_(z):this.fulfill_(z)}};A.prototype.resolveToNonPromiseObj_=function(z){var A=
void 0;try{A=z.then}catch(je){this.reject_(je);return}"function"==typeof A?this.settleSameAsThenable_(A,z):this.fulfill_(z)};A.prototype.reject_=function(z){this.settle_(2,z)};A.prototype.fulfill_=function(z){this.settle_(1,z)};A.prototype.settle_=function(z,A){if(0!=this.state_)throw Error("Cannot settle("+z+", "+A|"): Promise already settled in state"+this.state_);this.state_=z;this.result_=A;this.executeOnSettledCallbacks_()};A.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var z=
this.onSettledCallbacks_,A=0;A<z.length;++A)z[A].call(),z[A]=null;this.onSettledCallbacks_=null}};var Va=new K;A.prototype.settleSameAsPromise_=function(z){var A=this.createResolveAndReject_();z.callWhenSettled_(A.resolve,A.reject)};A.prototype.settleSameAsThenable_=function(z,A){var K=this.createResolveAndReject_();try{z.call(A,K.resolve,K.reject)}catch(ke){K.reject(ke)}};A.prototype.then=function(z,K){function ka(z,A){return"function"==typeof z?function(A){try{ra(z(A))}catch(le){Qa(le)}}:A}var ra,
Qa,Va=new A(function(z,A){ra=z;Qa=A});this.callWhenSettled_(ka(z,ra),ka(K,Qa));return Va};A.prototype.catch=function(z){return this.then(void 0,z)};A.prototype.callWhenSettled_=function(z,A){function K(){switch(ka.state_){case 1:z(ka.result_);break;case 2:A(ka.result_);break;default:throw Error("Unexpected state: "+ka.state_);}}var ka=this;null==this.onSettledCallbacks_?Va.asyncExecute(K):this.onSettledCallbacks_.push(function(){Va.asyncExecute(K)})};A.resolve=ka;A.reject=function(z){return new A(function(A,
K){K(z)})};A.race=function(z){return new A(function(A,K){for(var ra=$jscomp.makeIterator(z),Va=ra.next();!Va.done;Va=ra.next())ka(Va.value).callWhenSettled_(A,K)})};A.all=function(z){var K=$jscomp.makeIterator(z),ra=K.next();return ra.done?ka([]):new A(function(z,A){function Va(A){return function(K){Qa[A]=K;Bd--;0==Bd&&z(Qa)}}var Qa=[],Bd=0;do Qa.push(void 0),Bd++,ka(ra.value).callWhenSettled_(Va(Qa.length-1),A),ra=K.next();while(!ra.done)})};return A},"es6","es3");
(function(){var z;function K(d,b,f){this.context=d;this.urlList=b;this.onload=f;this.loadCount=0}function ka(d,b,f){b=b.split(".")[0].toLowerCase();Nf[b]=d;!f||f.music&&f.mid!=Ra.id||(pa(b,f.x,f.y,f.k,f.music,f.date),f.date=0)}function ra(d,b){var f=G,e;for(e=2;60>=e;e+=2){d--;b--;for(var h=0;h<=e;){if(2<Y[d+h+f*b]&&1==w[Y[d+h+f*b]].res&&ia(d+h,b))return Y[d+h+f*b];if(2<Y[d+h+f*(b+e)]&&1==w[Y[d+h+f*(b+e)]].res&&ia(d+h,b+e))return Y[d+h+f*(b+e)];h++}for(h=0;h<e-1;){h++;if(2<Y[d+f*(b+h)]&&1==w[Y[d+
f*(b+h)]].res&&ia(d,b+h))return Y[d+f*(b+h)];if(2<Y[d+e+f*(b+h)]&&1==w[Y[d+e+f*(b+h)]].res&&ia(d+e,b+h))return Y[d+e+f*(b+h)]}}return!1}function A(d,b){if(!Cd(d)){var f=d.x32,e=d.y32,h=d.sight;d.build&&(h=d.attDist);var c=G,k=2*h+1,n=k*k,u=d.id,D={};d.callList||(d.callList=[]);for(var y=0;y<n;y++){var r=y%k-h,fa=~~(y/k)-h;if(Math.sqrt(Math.pow(r,2)+Math.pow(fa,2))<=h){r+=f;fa+=e;var R=r+fa*c;ia(r,fa)&&(kc[R]?(r=w[kc[R]],D[r.id]||b||(r.callList||T(r),r.callList.put(d.id),r.callList.put(d.x32+d.y32*
c),D[r.id]=1)):kc[R]=u)}}}}function Va(d){if(d.callList){for(var b=d.x32,f=d.y32,e=d.sight,h=G,c=2*e+1,k=c*c,n=d.id,u=0;u<k;u++){var D=u%c-e,y=~~(u/c)-e;Math.sqrt(Math.pow(D,2)+Math.pow(y,2))<=e&&(D+=b,y+=f,D+=y*h,kc[D]==n&&(kc[D]=void 0))}b=d.callList;d.callList=void 0;u=0;for(k=b.length;u<k;u+=2)d=w[b[u]],d.x32+d.y32*h==b[u+1]&&d.callList&&A(d,!0);b.length=0}}function Qa(){for(var d=0,b=aa.length;d<b;aa[d++].className="");}function Fj(){if(""==q("playingMenu").innerHTML){q("playingMenu").innerHTML=
'<div>\n<ul>\n<li id="backToGame">'+t.backToGame+'</li>\n<li style="display:none" id="saveGameCache">'+t.save+' (cache)</li>\n<li id="saveGame">'+t.downloadmap+'</li>\n<li id="fullscreenmenu">'+t.fullscreen2+'</li>\n<li id="quitButton1">'+t.quit+"</li>\n</ul>\n<div>\n<span>"+t.musicVolume+'</span><br/><input type="range" id="musicRange" value="'+localStorage.musicRange+'"/><br/><br/>\n<form id="musicSelect">\n<input type="radio" name="mversion" value="originalMusic" checked /> Original<br/>\n<input type="radio" name="mversion" value="sharpRain" /> Original - <a href="https://www.youtube.com/user/rainheart666787/featured" target="_blank" rel="noopener noreferrer">Sharp Rain</a> Version<br/>\n<input type="radio" name="mversion" value="originalMusic1" /> Original - Alternative One<br/>\n<input type="radio" name="mversion" value="mute" /> Mute\n</form>\n<br />\n<span>'+
t.soundVolume+'</span><br/><input type="range" id="soundRange" value="'+localStorage.soundRange+'"/><br/>\n</div>\n</div>\n';q("quitButton1").onclick=je;q("saveGame").onclick=Ij;q("saveGameCache").onclick=ym;q("backToGame").onclick=function(){ma("playingMenu");sa()};q("fullscreenmenu").onclick=Jj;q("musicRange").oninput=function(){me.gain.value=parseInt(q("musicRange").value)/100;localStorage.musicRange=q("musicRange").value};q("soundRange").oninput=function(){ne.gain.value=parseInt(q("soundRange").value)/
100;localStorage.soundRange=q("soundRange").value};localStorage.favMusic&&(q("musicSelect").mversion.value=localStorage.favMusic);for(var d=q("musicSelect").getElementsByTagName("input"),b=0,f=d.length;b<f;b++)d[b].onchange=Ra.reset}p.demo&&ma("saveGame")||Ca("saveGame");q("playingMenu").style.display="block";kb()}function je(){Bd("playingMenu");p.online&&yh();na.length=0;C=[];Wa=void 0;dd.obj={};bb.done.length=0;clearInterval(Of);E=[];kc={};Dd.maxPing=200;sa();p={canceled:!0};na.length=0;w=[{terrain:1},
{terrain:1},{terrain:1}];ed={};fd={};Xa={};Ed.length=0;va=[];Bb=[];cb=[];x.admin=!1;Nb=x.kingdom=void 0;Fd.intv&&clearInterval(Fd.intv);Kj={euro:0,arab:0,asia:0};Ra.stop();lc=q("msgs");Pf=q("msginput");window.removeEventListener("mousemove",Hb);window.removeEventListener("keydown",Lj);window.removeEventListener("keyup",Mj);window.removeEventListener("mousemove",Nj);window.removeEventListener("mousedown",Oj);window.removeEventListener("mouseup",Pj);window.removeEventListener("wheel",zh);window.removeEventListener("resize",
oe);db();q("playermenu").style.display="block";q("playingMenu").style.display="none"}function ke(d){T("setup:",d);d.toSend=[];d.orderList=[];var b=eb.roomName;b=b.substr(0,b.length-1);d.id==b&&(d.admin=!0);d.sendDirectly("channelMessage","nehhof",{});T(d.channels.channelMessage);d.channels.channelMessage.onopen=function(){Da.put(d);pa("attack");Ah(1);T("DATACHANNEL OPEN");setTimeout(function(){I(pe,Qf(),0,[d]);x.admin&&(I(Rf,x.room.max,0,[d]),la?Qj(la.compressed):I(gd,p,!1),ba.put(d.id),I(Ob,ba,0))},
500)};d.channels.channelMessage.onerror=function(d){T(d)}}function Gj(){q("buttons").innerHTML="";q("gameName").innerHTML=""}function xh(){x.p2p?(sa(),x.p2p.emit("getRooms"),q("returnmenu").style.display="block"):(eb||mc(),mc.func=xh)}function Hj(){var d=location,b=d.hash.substr(1);""==b&&(q("returnmenu").style.display="none");if("MatchX"==b.substr(0,6))6<b.length&&zm(b.substr(6-b.length));else if("Room"==d.hash.substr(-4))d=d.hash.substr(1),x.admin||Rj(d.substr(0,d.length-4));else if(Sj[b])Sj[b]();
else d.hash=""}function Bd(d){d=q(d);d.style.display="none"==d.style.display?"block":"none"}function wh(d){d.style.display="none"==d.style.display?"block":"none"}function le(d){return v.locateFile?v.locateFile(d,nc):nc+d}function Tj(d,b){b||(b=16);return Math.ceil(d/b)*b}function Bh(d,b){d||qe("Assertion failed: "+b)}function Uj(d){for(var b=0,f=0;f<d.length;++f){var e=d.charCodeAt(f);55296<=e&&57343>=e&&(e=65536+((e&1023)<<10)|d.charCodeAt(++f)&1023);127>=e?++b:b=2047>=e?b+2:65535>=e?b+3:2097151>=
e?b+4:67108863>=e?b+5:b+6}var h=b+1;b=Vj(h);f=Ch;e=b;if(0<h){h=e+h-1;for(var c=0;c<d.length;++c){var k=d.charCodeAt(c);if(55296<=k&&57343>=k){var n=d.charCodeAt(++c);k=65536+((k&1023)<<10)|n&1023}if(127>=k){if(e>=h)break;f[e++]=k}else{if(2047>=k){if(e+1>=h)break;f[e++]=192|k>>6}else{if(65535>=k){if(e+2>=h)break;f[e++]=224|k>>12}else{if(2097151>=k){if(e+3>=h)break;f[e++]=240|k>>18}else{if(67108863>=k){if(e+4>=h)break;f[e++]=248|k>>24}else{if(e+5>=h)break;f[e++]=252|k>>30;f[e++]=128|k>>24&63}f[e++]=
128|k>>18&63}f[e++]=128|k>>12&63}f[e++]=128|k>>6&63}f[e++]=128|k&63}}f[e]=0}return b}function Dh(d,b){0<d%b&&(d+=b-d%b);return d}function Eh(){v.HEAP8=Ch=new Int8Array(zb);v.HEAP16=new Int16Array(zb);v.HEAP32=Gc=new Int32Array(zb);v.HEAPU8=new Uint8Array(zb);v.HEAPU16=new Uint16Array(zb);v.HEAPU32=new Uint32Array(zb);v.HEAPF32=new Float32Array(zb);v.HEAPF64=new Float64Array(zb)}function Gd(d){for(;0<d.length;){var b=d.shift();if("function"==typeof b)b();else{var f=b.func;"number"===typeof f?void 0===
b.arg?v.dynCall_v(f):v.dynCall_vi(f,b.arg):f(void 0===b.arg?null:b.arg)}}}function Sf(d){return String.prototype.startsWith?d.startsWith("data:application/octet-stream;base64,"):0===d.indexOf("data:application/octet-stream;base64,")}function Hd(d){this.name="ExitStatus";this.message="Program terminated with exit("+d+")";this.status=d}function Fh(d){function b(){if(!v.calledRun&&(v.calledRun=!0,!Gh)){Tf||(Tf=!0,Gd(Hh));Gd(Am);if(v.onRuntimeInitialized)v.onRuntimeInitialized();v._main&&Wj&&v.callMain(d);
if(v.postRun)for("function"==typeof v.postRun&&(v.postRun=[v.postRun]);v.postRun.length;)Xj.unshift(v.postRun.shift());Gd(Xj)}}d=d||v.arguments;if(!(0<hd)){if(v.preRun)for("function"==typeof v.preRun&&(v.preRun=[v.preRun]);v.preRun.length;)Yj.unshift(v.preRun.shift());Gd(Yj);0<hd||v.calledRun||(v.setStatus?(v.setStatus("Running..."),setTimeout(function(){setTimeout(function(){v.setStatus("")},1);b()},1)):b())}}function qe(d){if(v.onAbort)v.onAbort(d);void 0!==d?(Zj(d),Yb(d),d=JSON.stringify(d)):d=
"";Gh=!0;throw"abort("+d+"). Build with -s ASSERTIONS=1 for more info.";}function Bm(){for(var d=C,b=0,f=d.length;b<f;b++){var e=w[d[b]];e.build||(e.d=(e.d+1)%8,ta(e,e.img))}}function ak(d){P=function(){};Hc=!1;var b=ja;b.d=d.d;ta(b,d.img);b.active=!0;Ha=B[52];re=d;document.addEventListener("mousemove",Ih);document.addEventListener("mousedown",se)}function Cm(d,b){return d.innerHTML-b.innerHTML}var Gm=function(){(function(d){"object"===typeof exports&&"undefined"!==typeof module?module.exports=d():
"function"===typeof define&&define.amd?define([],d):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).SimpleWebRTC=d()})(function(){return function h(b,f,e){function c(g,n){if(!f[g]){if(!b[g]){var u="function"==typeof require&&require;if(!n&&u)return u(g,!0);if(k)return k(g,!0);n=Error("Cannot find module '"+g+"'");throw n.code="MODULE_NOT_FOUND",n;}n=f[g]={exports:{}};b[g][0].call(n.exports,function(e){var f=b[g][1][e];return c(f?f:e)},n,
n.exports,h,b,f,e)}return f[g].exports}for(var k="function"==typeof require&&require,n=0;n<e.length;n++)c(e[n]);return c}({1:[function(b,f,e){function h(){}f.exports=function(b,e,f){function c(b,h){if(0>=c.count)throw Error("after called too many times");--c.count;b?(g=!0,e(b),e=f):0!==c.count||g||e(null,h)}var g=!1;f=f||h;c.count=b;return 0===b?e():c}},{}],2:[function(b,f,e){f.exports=function(b,e,f){var h=b.byteLength;e=e||0;f=f||h;if(b.slice)return b.slice(e,f);0>e&&(e+=h);0>f&&(f+=h);f>h&&(f=
h);if(e>=h||e>=f||0===h)return new ArrayBuffer(0);b=new Uint8Array(b);h=new Uint8Array(f-e);for(var c=0;e<f;e++,c++)h[c]=b[e];return h.buffer}},{}],3:[function(b,f,e){f.exports=function(b,e,f){var h,c=e;e={autoplay:!0,mirror:!1,muted:!1,audio:!1,disableContextMenu:!1};if(f)for(h in f)e[h]=f[h];c?"audio"===c.tagName.toLowerCase()&&(e.audio=!0):c=document.createElement(e.audio?"audio":"video");e.disableContextMenu&&(c.oncontextmenu=function(b){b.preventDefault()});e.autoplay&&(c.autoplay="autoplay");
e.muted&&(c.muted=!0);!e.audio&&e.mirror&&["","moz","webkit","o","ms"].forEach(function(b){c.style[b?b+"Transform":"transform"]="scaleX(-1)"});c.srcObject=b;return c}},{}],4:[function(b,f,e){function h(b){b=b||{};this.ms=b.min||100;this.max=b.max||1E4;this.factor=b.factor||2;this.jitter=0<b.jitter&&1>=b.jitter?b.jitter:0;this.attempts=0}f.exports=h;h.prototype.duration=function(){var b=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),f=Math.floor(e*this.jitter*b);
b=0==(Math.floor(10*e)&1)?b-f:b+f}return Math.min(b,this.max)|0};h.prototype.reset=function(){this.attempts=0};h.prototype.setMin=function(b){this.ms=b};h.prototype.setMax=function(b){this.max=b};h.prototype.setJitter=function(b){this.jitter=b}},{}],5:[function(b,f,e){(function(b){e.encode=function(e){e=new Uint8Array(e);var f,h=e.length,c="";for(f=0;f<h;f+=3)c+=b[e[f]>>2],c+=b[(e[f]&3)<<4|e[f+1]>>4],c+=b[(e[f+1]&15)<<2|e[f+2]>>6],c+=b[e[f+2]&63];2===h%3?c=c.substring(0,c.length-1)+"=":1===h%3&&(c=
c.substring(0,c.length-2)+"==");return c};e.decode=function(e){var f=.75*e.length,h=e.length,c=0;"="===e[e.length-1]&&(f--,"="===e[e.length-2]&&f--);var g=new ArrayBuffer(f),y=new Uint8Array(g);for(f=0;f<h;f+=4){var r=b.indexOf(e[f]);var fa=b.indexOf(e[f+1]);var R=b.indexOf(e[f+2]);var Ic=b.indexOf(e[f+3]);y[c++]=r<<2|fa>>4;y[c++]=(fa&15)<<4|R>>2;y[c++]=(R&3)<<6|Ic&63}return g}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],6:[function(b,f,e){(function(b){function e(b){for(var e=
0;e<b.length;e++){var f=b[e];if(f.buffer instanceof ArrayBuffer){var h=f.buffer;if(f.byteLength!==h.byteLength){var c=new Uint8Array(f.byteLength);c.set(new Uint8Array(h,f.byteOffset,f.byteLength));h=c.buffer}b[e]=h}}}function h(b,f){f=f||{};var h=new u;e(b);for(var c=0;c<b.length;c++)h.append(b[c]);return f.type?h.getBlob(f.type):h.getBlob()}function c(b,f){e(b);return new Blob(b,f||{})}var u=b.BlobBuilder||b.WebKitBlobBuilder||b.MSBlobBuilder||b.MozBlobBuilder;try{var D=2===(new Blob(["hi"])).size}catch(fa){D=
!1}var y;if(y=D)try{y=2===(new Blob([new Uint8Array([1,2])])).size}catch(fa){y=!1}var r=u&&u.prototype.append&&u.prototype.getBlob;b=D?y?b.Blob:c:r?h:void 0;f.exports=b}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],7:[function(b,f,e){var h=[].slice;f.exports=function(b,e){"string"==typeof e&&(e=b[e]);if("function"!=typeof e)throw Error("bind() requires a function");var f=h.call(arguments,2);return function(){return e.apply(b,
f.concat(h.call(arguments)))}}},{}],8:[function(b,f,e){function h(b){if(b){for(var e in h.prototype)b[e]=h.prototype[e];return b}}f.exports=h;h.prototype.on=h.prototype.addEventListener=function(b,e){this._callbacks=this._callbacks||{};(this._callbacks[b]=this._callbacks[b]||[]).push(e);return this};h.prototype.once=function(b,e){function f(){h.off(b,f);e.apply(this,arguments)}var h=this;this._callbacks=this._callbacks||{};f.fn=e;this.on(b,f);return this};h.prototype.off=h.prototype.removeListener=
h.prototype.removeAllListeners=h.prototype.removeEventListener=function(b,e){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var f=this._callbacks[b];if(!f)return this;if(1==arguments.length)return delete this._callbacks[b],this;for(var h,c=0;c<f.length;c++)if(h=f[c],h===e||h.fn===e){f.splice(c,1);break}return this};h.prototype.emit=function(b){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),f=this._callbacks[b];if(f){f=f.slice(0);for(var h=
0,c=f.length;h<c;++h)f[h].apply(this,e)}return this};h.prototype.listeners=function(b){this._callbacks=this._callbacks||{};return this._callbacks[b]||[]};h.prototype.hasListeners=function(b){return!!this.listeners(b).length}},{}],9:[function(b,f,e){f.exports=function(b,e){var f=function(){};f.prototype=e.prototype;b.prototype=new f;b.prototype.constructor=b}},{}],10:[function(b,f,e){function h(b){return h.enabled(b)?function(e){e instanceof Error&&(e=e.stack||e.message);var f=new Date,c=f-(h[b]||
f);h[b]=f;e=b+" "+e+" +"+h.humanize(c);window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}f.exports=h;h.names=[];h.skips=[];h.enable=function(b){try{localStorage.debug=b}catch(D){}for(var e=(b||"").split(/[\s,]+/),f=e.length,c=0;c<f;c++)b=e[c].replace("*",".*?"),"-"===b[0]?h.skips.push(new RegExp("^"+b.substr(1)+"$")):h.names.push(new RegExp("^"+b+"$"))};h.disable=function(){h.enable("")};h.humanize=function(b){return 36E5<=b?(b/36E5).toFixed(1)+
"h":6E4<=b?(b/6E4).toFixed(1)+"m":1E3<=b?(b/1E3|0)+"s":b+"ms"};h.enabled=function(b){for(var e=0,f=h.skips.length;e<f;e++)if(h.skips[e].test(b))return!1;e=0;for(f=h.names.length;e<f;e++)if(h.names[e].test(b))return!0;return!1};try{window.localStorage&&h.enable(localStorage.debug)}catch(g){}},{}],11:[function(b,f,e){f.exports=b("./lib/")},{"./lib/":12}],12:[function(b,f,e){f.exports=b("./socket");f.exports.parser=b("engine.io-parser")},{"./socket":13,"engine.io-parser":24}],13:[function(b,f,e){(function(e){function h(b,
f){if(!(this instanceof h))return new h(b,f);f=f||{};b&&"object"==typeof b&&(f=b,b=null);b&&(b=r(b),f.host=b.host,f.secure="https"==b.protocol||"wss"==b.protocol,f.port=b.port,b.query&&(f.query=b.query));this.secure=null!=f.secure?f.secure:e.location&&"https:"==location.protocol;f.host&&(b=f.host.split(":"),f.hostname=b.shift(),b.length?f.port=b.pop():f.port||(f.port=this.secure?"443":"80"));this.agent=f.agent||!1;this.hostname=f.hostname||(e.location?location.hostname:"localhost");this.port=f.port||
(e.location&&location.port?location.port:this.secure?443:80);this.query=f.query||{};"string"==typeof this.query&&(this.query=R.decode(this.query));this.upgrade=!1!==f.upgrade;this.path=(f.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!f.forceJSONP;this.jsonp=!1!==f.jsonp;this.forceBase64=!!f.forceBase64;this.enablesXDR=!!f.enablesXDR;this.timestampParam=f.timestampParam||"t";this.timestampRequests=f.timestampRequests;this.transports=f.transports||["polling","websocket"];this.readyState=
"";this.writeBuffer=[];this.callbackBuffer=[];this.policyPort=f.policyPort||843;this.rememberUpgrade=f.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=f.onlyBinaryUpgrades;this.pfx=f.pfx||null;this.key=f.key||null;this.passphrase=f.passphrase||null;this.cert=f.cert||null;this.ca=f.ca||null;this.ciphers=f.ciphers||null;this.rejectUnauthorized=f.rejectUnauthorized||null;this.open()}var c=b("./transports"),n=b("component-emitter"),u=b("debug")("engine.io-client:socket"),D=b("indexof"),
y=b("engine.io-parser"),r=b("parseuri"),fa=b("parsejson"),R=b("parseqs");f.exports=h;h.priorWebsocketSuccess=!1;n(h.prototype);h.protocol=y.protocol;h.Socket=h;h.Transport=b("./transport");h.transports=b("./transports");h.parser=b("engine.io-parser");h.prototype.createTransport=function(b){u('creating transport "%s"',b);var e=this.query,f={},h;for(h in e)e.hasOwnProperty(h)&&(f[h]=e[h]);f.EIO=y.protocol;f.transport=b;this.id&&(f.sid=this.id);return new c[b]({agent:this.agent,hostname:this.hostname,
port:this.port,secure:this.secure,path:this.path,query:f,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})};h.prototype.open=function(){if(this.rememberUpgrade&&h.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))var b=
"websocket";else{if(0==this.transports.length){var e=this;setTimeout(function(){e.emit("error","No transports available")},0);return}b=this.transports[0]}this.readyState="opening";try{b=this.createTransport(b)}catch(Sb){this.transports.shift();this.open();return}b.open();this.setTransport(b)};h.prototype.setTransport=function(b){u("setting transport %s",b.name);var e=this;this.transport&&(u("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=b;
b.on("drain",function(){e.onDrain()}).on("packet",function(b){e.onPacket(b)}).on("error",function(b){e.onError(b)}).on("close",function(){e.onClose("transport close")})};h.prototype.probe=function(b){function e(){if(R.onlyBinaryUpgrades){var e=!this.supportsBinary&&R.transport.supportsBinary;D=D||e}D||(u('probe transport "%s" opened',b),r.send([{type:"ping",data:"probe"}]),r.once("packet",function(e){D||("pong"==e.type&&"probe"==e.data?(u('probe transport "%s" pong',b),R.upgrading=!0,R.emit("upgrading",
r),r&&(h.priorWebsocketSuccess="websocket"==r.name,u('pausing current transport "%s"',R.transport.name),R.transport.pause(function(){D||"closed"==R.readyState||(u("changing transport and sending upgrade packet"),y(),R.setTransport(r),r.send([{type:"upgrade"}]),R.emit("upgrade",r),r=null,R.upgrading=!1,R.flush())}))):(u('probe transport "%s" failed',b),e=Error("probe error"),e.transport=r.name,R.emit("upgradeError",e)))}))}function f(){D||(D=!0,y(),r.close(),r=null)}function c(e){var h=Error("probe error: "+
e);h.transport=r.name;f();u('probe transport "%s" failed because of error: %s',b,e);R.emit("upgradeError",h)}function g(){c("transport closed")}function k(){c("socket closed")}function n(b){r&&b.name!=r.name&&(u('"%s" works - aborting "%s"',b.name,r.name),f())}function y(){r.removeListener("open",e);r.removeListener("error",c);r.removeListener("close",g);R.removeListener("close",k);R.removeListener("upgrading",n)}u('probing transport "%s"',b);var r=this.createTransport(b,{probe:1}),D=!1,R=this;h.priorWebsocketSuccess=
!1;r.once("open",e);r.once("error",c);r.once("close",g);this.once("close",k);this.once("upgrading",n);r.open()};h.prototype.onOpen=function(){u("socket open");this.readyState="open";h.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){u("starting upgrade probes");for(var b=0,e=this.upgrades.length;b<e;b++)this.probe(this.upgrades[b])}};h.prototype.onPacket=function(b){if("opening"==this.readyState||
"open"==this.readyState)switch(u('socket receive: type "%s", data "%s"',b.type,b.data),this.emit("packet",b),this.emit("heartbeat"),b.type){case "open":this.onHandshake(fa(b.data));break;case "pong":this.setPing();break;case "error":var e=Error("server error");e.code=b.data;this.emit("error",e);break;case "message":this.emit("data",b.data),this.emit("message",b.data)}else u('packet received with socket readyState "%s"',this.readyState)};h.prototype.onHandshake=function(b){this.emit("handshake",b);
this.id=b.sid;this.transport.query.sid=b.sid;this.upgrades=this.filterUpgrades(b.upgrades);this.pingInterval=b.pingInterval;this.pingTimeout=b.pingTimeout;this.onOpen();"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};h.prototype.onHeartbeat=function(b){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){if("closed"!=e.readyState)e.onClose("ping timeout")},b||e.pingInterval+e.pingTimeout)};
h.prototype.setPing=function(){var b=this;clearTimeout(b.pingIntervalTimer);b.pingIntervalTimer=setTimeout(function(){u("writing ping packet - expecting pong within %sms",b.pingTimeout);b.ping();b.onHeartbeat(b.pingTimeout)},b.pingInterval)};h.prototype.ping=function(){this.sendPacket("ping")};h.prototype.onDrain=function(){for(var b=0;b<this.prevBufferLen;b++)if(this.callbackBuffer[b])this.callbackBuffer[b]();this.writeBuffer.splice(0,this.prevBufferLen);this.callbackBuffer.splice(0,this.prevBufferLen);
this.prevBufferLen=0;0==this.writeBuffer.length?this.emit("drain"):this.flush()};h.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(u("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};h.prototype.write=h.prototype.send=function(b,e){this.sendPacket("message",b,e);return this};h.prototype.sendPacket=function(b,e,f){"closing"!=
this.readyState&&"closed"!=this.readyState&&(b={type:b,data:e},this.emit("packetCreate",b),this.writeBuffer.push(b),this.callbackBuffer.push(f),this.flush())};h.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){var b=function(){h.once("upgrade",e);h.once("upgradeError",e)},e=function(){h.removeListener("upgrade",e);h.removeListener("upgradeError",e);f()},f=function(){h.onClose("forced close");u("socket closing - telling transport to close");h.transport.close()};this.readyState=
"closing";var h=this;if(this.writeBuffer.length)this.once("drain",function(){this.upgrading?b():f()});else this.upgrading?b():f()}return this};h.prototype.onError=function(b){u("socket error %j",b);h.priorWebsocketSuccess=!1;this.emit("error",b);this.onClose("transport error",b)};h.prototype.onClose=function(b,e){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){u('socket close with reason: "%s"',b);var f=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);
setTimeout(function(){f.writeBuffer=[];f.callbackBuffer=[];f.prevBufferLen=0},0);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",b,e)}};h.prototype.filterUpgrades=function(b){for(var e=[],f=0,h=b.length;f<h;f++)~D(this.transports,b[f])&&e.push(b[f]);return e}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./transport":14,
"./transports":15,"component-emitter":8,debug:21,"engine.io-parser":24,indexof:32,parsejson:40,parseqs:41,parseuri:23}],14:[function(b,f,e){function h(b){this.path=b.path;this.hostname=b.hostname;this.port=b.port;this.secure=b.secure;this.query=b.query;this.timestampParam=b.timestampParam;this.timestampRequests=b.timestampRequests;this.readyState="";this.agent=b.agent||!1;this.socket=b.socket;this.enablesXDR=b.enablesXDR;this.pfx=b.pfx;this.key=b.key;this.passphrase=b.passphrase;this.cert=b.cert;
this.ca=b.ca;this.ciphers=b.ciphers;this.rejectUnauthorized=b.rejectUnauthorized}var c=b("engine.io-parser");b=b("component-emitter");f.exports=h;b(h.prototype);h.timestamps=0;h.prototype.onError=function(b,e){b=Error(b);b.type="TransportError";b.description=e;this.emit("error",b);return this};h.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this};h.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),
this.onClose();return this};h.prototype.send=function(b){if("open"==this.readyState)this.write(b);else throw Error("Transport not open");};h.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};h.prototype.onData=function(b){b=c.decodePacket(b,this.socket.binaryType);this.onPacket(b)};h.prototype.onPacket=function(b){this.emit("packet",b)};h.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":8,"engine.io-parser":24}],15:[function(b,
f,e){(function(f){var h=b("xmlhttprequest"),c=b("./polling-xhr"),n=b("./polling-jsonp"),u=b("./websocket");e.polling=function(b){var e=!1,g=!1,k=!1!==b.jsonp;f.location&&(g="https:"==location.protocol,(e=location.port)||(e=g?443:80),e=b.hostname!=location.hostname||e!=b.port,g=b.secure!=g);b.xdomain=e;b.xscheme=g;if("open"in new h(b)&&!b.forceJSONP)return new c(b);if(!k)throw Error("JSONP disabled");return new n(b)};e.websocket=u}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?
self:"undefined"!==typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(b,f,e){(function(e){function h(){}function c(b){n.call(this,b);this.query=this.query||{};r||(e.___eio||(e.___eio=[]),r=e.___eio);this.index=r.length;var f=this;r.push(function(b){f.onData(b)});this.query.j=this.index;e.document&&e.addEventListener&&e.addEventListener("beforeunload",function(){f.script&&(f.script.onerror=h)},!1)}var n=b("./polling"),u=b("component-inherit");
f.exports=c;var D=/\n/g,y=/\\n/g,r;u(c,n);c.prototype.supportsBinary=!1;c.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.iframe=this.form=null);n.prototype.doClose.call(this)};c.prototype.doPoll=function(){var b=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);e.async=!0;e.src=this.uri();e.onerror=function(e){b.onError("jsonp poll error",
e)};var f=document.getElementsByTagName("script")[0];f.parentNode.insertBefore(e,f);this.script=e;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var b=document.createElement("iframe");document.body.appendChild(b);document.body.removeChild(b)},100)};c.prototype.doWrite=function(b,e){function f(){h();e()}function h(){if(c.iframe)try{c.form.removeChild(c.iframe)}catch(Kh){c.onError("jsonp polling iframe removal error",Kh)}try{u=document.createElement('<iframe src="javascript:0" name="'+
c.iframeId+'">')}catch(Kh){u=document.createElement("iframe"),u.name=c.iframeId,u.src="javascript:0"}u.id=c.iframeId;c.form.appendChild(u);c.iframe=u}var c=this;if(!this.form){var g=document.createElement("form"),k=document.createElement("textarea"),n=this.iframeId="eio_iframe_"+this.index,u;g.className="socketio";g.style.position="absolute";g.style.top="-1000px";g.style.left="-1000px";g.target=n;g.method="POST";g.setAttribute("accept-charset","utf-8");k.name="d";g.appendChild(k);document.body.appendChild(g);
this.form=g;this.area=k}this.form.action=this.uri();h();b=b.replace(y,"\\\n");this.area.value=b.replace(D,"\\n");try{this.form.submit()}catch(Kh){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==c.iframe.readyState&&f()}:this.iframe.onload=f}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-inherit":9}],17:[function(b,f,e){(function(e){function h(){}function c(b){y.call(this,
b);if(e.location){var f="https:"==location.protocol,h=location.port;h||(h=f?443:80);this.xd=b.hostname!=e.location.hostname||h!=b.port;this.xs=b.secure!=f}}function n(b){this.method=b.method||"GET";this.uri=b.uri;this.xd=!!b.xd;this.xs=!!b.xs;this.async=!1!==b.async;this.data=void 0!=b.data?b.data:null;this.agent=b.agent;this.isBinary=b.isBinary;this.supportsBinary=b.supportsBinary;this.enablesXDR=b.enablesXDR;this.pfx=b.pfx;this.key=b.key;this.passphrase=b.passphrase;this.cert=b.cert;this.ca=b.ca;
this.ciphers=b.ciphers;this.rejectUnauthorized=b.rejectUnauthorized;this.create()}function u(){for(var b in n.requests)n.requests.hasOwnProperty(b)&&n.requests[b].abort()}var D=b("xmlhttprequest"),y=b("./polling"),r=b("component-emitter"),fa=b("component-inherit"),R=b("debug")("engine.io-client:polling-xhr");f.exports=c;f.exports.Request=n;fa(c,y);c.prototype.supportsBinary=!0;c.prototype.request=function(b){b=b||{};b.uri=this.uri();b.xd=this.xd;b.xs=this.xs;b.agent=this.agent||!1;b.supportsBinary=
this.supportsBinary;b.enablesXDR=this.enablesXDR;b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;return new n(b)};c.prototype.doWrite=function(b,e){b=this.request({method:"POST",data:b,isBinary:"string"!==typeof b&&void 0!==b});var f=this;b.on("success",e);b.on("error",function(b){f.onError("xhr post error",b)});this.sendXhr=b};c.prototype.doPoll=function(){R("xhr poll");var b=this.request(),
e=this;b.on("data",function(b){e.onData(b)});b.on("error",function(b){e.onError("xhr poll error",b)});this.pollXhr=b};r(n.prototype);n.prototype.create=function(){var b={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;var f=this.xhr=new D(b),h=this;try{R("xhr open %s: %s",this.method,this.uri);f.open(this.method,this.uri,
this.async);this.supportsBinary&&(f.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?f.setRequestHeader("Content-type","application/octet-stream"):f.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(Jh){}"withCredentials"in f&&(f.withCredentials=!0);this.hasXDR()?(f.onload=function(){h.onLoad()},f.onerror=function(){h.onError(f.responseText)}):f.onreadystatechange=function(){if(4==f.readyState)if(200==f.status||1223==f.status)h.onLoad();else setTimeout(function(){h.onError(f.status)},
0)};R("xhr data %s",this.data);f.send(this.data)}catch(Jh){setTimeout(function(){h.onError(Jh)},0);return}e.document&&(this.index=n.requestsCount++,n.requests[this.index]=this)};n.prototype.onSuccess=function(){this.emit("success");this.cleanup()};n.prototype.onData=function(b){this.emit("data",b);this.onSuccess()};n.prototype.onError=function(b){this.emit("error",b);this.cleanup(!0)};n.prototype.cleanup=function(b){if("undefined"!=typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=this.xhr.onerror=
h:this.xhr.onreadystatechange=h;if(b)try{this.xhr.abort()}catch(Uf){}e.document&&delete n.requests[this.index];this.xhr=null}};n.prototype.onLoad=function(){try{try{var b=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(Sb){}var e="application/octet-stream"===b?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(Sb){this.onError(Sb)}if(null!=e)this.onData(e)};n.prototype.hasXDR=function(){return"undefined"!==typeof e.XDomainRequest&&!this.xs&&this.enablesXDR};n.prototype.abort=
function(){this.cleanup()};e.document&&(n.requestsCount=0,n.requests={},e.attachEvent?e.attachEvent("onunload",u):e.addEventListener&&e.addEventListener("beforeunload",u,!1))}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-emitter":8,"component-inherit":9,debug:21,xmlhttprequest:20}],18:[function(b,f,e){function h(b){var e=b&&b.forceBase64;if(!D||e)this.supportsBinary=!1;c.call(this,b)}var c=b("../transport"),
k=b("parseqs"),n=b("engine.io-parser");e=b("component-inherit");var u=b("debug")("engine.io-client:polling");f.exports=h;var D=null!=(new (b("xmlhttprequest"))({xdomain:!1})).responseType;e(h,c);h.prototype.name="polling";h.prototype.doOpen=function(){this.poll()};h.prototype.pause=function(b){function e(){u("paused");f.readyState="paused";b()}var f=this;this.readyState="pausing";if(this.polling||!this.writable){var h=0;this.polling&&(u("we are currently polling - waiting to pause"),h++,this.once("pollComplete",
function(){u("pre-pause polling complete");--h||e()}));this.writable||(u("we are currently writing - waiting to pause"),h++,this.once("drain",function(){u("pre-pause writing complete");--h||e()}))}else e()};h.prototype.poll=function(){u("polling");this.polling=!0;this.doPoll();this.emit("poll")};h.prototype.onData=function(b){var e=this;u("polling got data %s",b);n.decodePayload(b,this.socket.binaryType,function(b,f,h){if("opening"==e.readyState)e.onOpen();if("close"==b.type)return e.onClose(),!1;
e.onPacket(b)});"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))};h.prototype.doClose=function(){function b(){u("writing close packet");e.write([{type:"close"}])}var e=this;"open"==this.readyState?(u("transport open - closing"),b()):(u("transport not open - deferring close"),this.once("open",b))};h.prototype.write=function(b){var e=this;this.writable=!1;var f=function(){e.writable=!0;
e.emit("drain")};e=this;n.encodePayload(b,this.supportsBinary,function(b){e.doWrite(b,f)})};h.prototype.uri=function(){var b=this.query||{},e=this.secure?"https":"http",f="";!1!==this.timestampRequests&&(b[this.timestampParam]=+new Date+"-"+c.timestamps++);this.supportsBinary||b.sid||(b.b64=1);b=k.encode(b);this.port&&("https"==e&&443!=this.port||"http"==e&&80!=this.port)&&(f=":"+this.port);b.length&&(b="?"+b);return e+"://"+this.hostname+f+this.path+b}},{"../transport":14,"component-inherit":9,debug:21,
"engine.io-parser":24,parseqs:41,xmlhttprequest:20}],19:[function(b,f,e){function h(b){b&&b.forceBase64&&(this.supportsBinary=!1);c.call(this,b)}var c=b("../transport"),k=b("engine.io-parser"),n=b("parseqs");e=b("component-inherit");var u=b("debug")("engine.io-client:websocket"),D=b("ws");f.exports=h;e(h,c);h.prototype.name="websocket";h.prototype.supportsBinary=!0;h.prototype.doOpen=function(){if(this.check()){var b=this.uri(),e={agent:this.agent};e.pfx=this.pfx;e.key=this.key;e.passphrase=this.passphrase;
e.cert=this.cert;e.ca=this.ca;e.ciphers=this.ciphers;e.rejectUnauthorized=this.rejectUnauthorized;this.ws=new D(b,void 0,e);void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.binaryType="arraybuffer";this.addEventListeners()}};h.prototype.addEventListeners=function(){var b=this;this.ws.onopen=function(){b.onOpen()};this.ws.onclose=function(){b.onClose()};this.ws.onmessage=function(e){b.onData(e.data)};this.ws.onerror=function(e){b.onError("websocket error",e)}};"undefined"!=typeof navigator&&
/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(h.prototype.onData=function(b){var e=this;setTimeout(function(){c.prototype.onData.call(e,b)},0)});h.prototype.write=function(b){var e=this;this.writable=!1;for(var f=0,h=b.length;f<h;f++)k.encodePacket(b[f],this.supportsBinary,function(b){try{e.ws.send(b)}catch(Uf){u("websocket closed before onclose event")}});setTimeout(function(){e.writable=!0;e.emit("drain")},0)};h.prototype.onClose=function(){c.prototype.onClose.call(this)};h.prototype.doClose=
function(){"undefined"!==typeof this.ws&&this.ws.close()};h.prototype.uri=function(){var b=this.query||{},e=this.secure?"wss":"ws",f="";this.port&&("wss"==e&&443!=this.port||"ws"==e&&80!=this.port)&&(f=":"+this.port);this.timestampRequests&&(b[this.timestampParam]=+new Date);this.supportsBinary||(b.b64=1);b=n.encode(b);b.length&&(b="?"+b);return e+"://"+this.hostname+f+this.path+b};h.prototype.check=function(){return!!D&&!("__initialize"in D&&this.name===h.prototype.name)}},{"../transport":14,"component-inherit":9,
debug:21,"engine.io-parser":24,parseqs:41,ws:66}],20:[function(b,f,e){var h=b("has-cors");f.exports=function(b){var e=b.xdomain,f=b.xscheme;b=b.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||h))return new XMLHttpRequest}catch(u){}try{if("undefined"!=typeof XDomainRequest&&!f&&b)return new XDomainRequest}catch(u){}if(!e)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(u){}}},{"has-cors":31}],21:[function(b,f,e){function h(){try{var b=localStorage.debug}catch(k){}return b}e=f.exports=
b("./debug");e.log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)};e.formatArgs=function(){var b=arguments,f=this.useColors;b[0]=(f?"%c":"")+this.namespace+(f?" %c":" ")+b[0]+(f?"%c ":" ")+"+"+e.humanize(this.diff);if(!f)return b;f="color: "+this.color;b=[b[0],f,"color: inherit"].concat(Array.prototype.slice.call(b,1));var h=0,c=0;b[0].replace(/%[a-z%]/g,function(b){"%%"!==b&&(h++,"%c"===b&&(c=h))});b.splice(c,
0,f);return b};e.save=function(b){try{null==b?localStorage.removeItem("debug"):localStorage.debug=b}catch(k){}};e.load=h;e.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)};e.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");e.formatters.j=function(b){return JSON.stringify(b)};e.enable(h())},
{"./debug":22}],22:[function(b,f,e){e=f.exports=function(b){function f(){}function g(){var b=+new Date;g.diff=b-(c||b);g.prev=c;c=g.curr=b;null==g.useColors&&(g.useColors=e.useColors());null==g.color&&g.useColors&&(g.color=e.colors[h++%e.colors.length]);var f=Array.prototype.slice.call(arguments);f[0]=e.coerce(f[0]);"string"!==typeof f[0]&&(f=["%o"].concat(f));var k=0;f[0]=f[0].replace(/%([a-z%])/g,function(b,h){if("%%"===b)return b;k++;h=e.formatters[h];"function"===typeof h&&(b=h.call(g,f[k]),f.splice(k,
1),k--);return b});"function"===typeof e.formatArgs&&(f=e.formatArgs.apply(g,f));(g.log||e.log||console.log.bind(console)).apply(g,f)}f.enabled=!1;g.enabled=!0;var k=e.enabled(b)?g:f;k.namespace=b;return k};e.coerce=function(b){return b instanceof Error?b.stack||b.message:b};e.disable=function(){e.enable("")};e.enable=function(b){e.save(b);for(var f=(b||"").split(/[\s,]+/),h=f.length,c=0;c<h;c++)f[c]&&(b=f[c].replace(/\*/g,".*?"),"-"===b[0]?e.skips.push(new RegExp("^"+b.substr(1)+"$")):e.names.push(new RegExp("^"+
b+"$")))};e.enabled=function(b){var f;var h=0;for(f=e.skips.length;h<f;h++)if(e.skips[h].test(b))return!1;h=0;for(f=e.names.length;h<f;h++)if(e.names[h].test(b))return!0;return!1};e.humanize=b("ms");e.names=[];e.skips=[];e.formatters={};var h=0,c},{ms:38}],23:[function(b,f,e){var h=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
c="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");f.exports=function(b){var e=b,f=b.indexOf("["),g=b.indexOf("]");-1!=f&&-1!=g&&(b=b.substring(0,f)+b.substring(f,g).replace(/:/g,";")+b.substring(g,b.length));b=h.exec(b||"");for(var k={},r=14;r--;)k[c[r]]=b[r]||"";-1!=f&&-1!=g&&(k.source=e,k.host=k.host.substring(1,k.host.length-1).replace(/;/g,":"),k.authority=k.authority.replace("[","").replace("]","").replace(/;/g,":"),k.ipv6uri=
!0);return k}},{}],24:[function(b,f,e){(function(f){function h(b,f,h){if(!f)return e.encodeBase64Packet(b,h);var c=new FileReader;c.onload=function(){b.data=c.result;e.encodePacket(b,f,!0,h)};return c.readAsArrayBuffer(b.data)}function c(b,e,f){var h=Array(b.length);f=r(b.length,f);for(var c=function(b,f,c){e(f,function(e,f){h[b]=f;c(e,h)})},g=0;g<b.length;g++)c(g,b[g],f)}var n=b("./keys"),u=b("has-binary"),D=b("arraybuffer.slice"),y=b("base64-arraybuffer"),r=b("after"),fa=b("utf8"),R=navigator.userAgent.match(/Android/i),
l=/PhantomJS/i.test(navigator.userAgent),m=R||l;e.protocol=3;var p=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},q=n(p),t={type:"error",data:"parser error"},w=b("blob");e.encodePacket=function(b,c,g,k){"function"==typeof c&&(k=c,c=!1);"function"==typeof g&&(k=g,g=null);var n=void 0===b.data?void 0:b.data.buffer||b.data;if(f.ArrayBuffer&&n instanceof ArrayBuffer){if(c){g=b.data;c=new Uint8Array(g);g=new Uint8Array(1+g.byteLength);g[0]=p[b.type];for(b=0;b<c.length;b++)g[b+1]=c[b];
b=k(g.buffer)}else b=e.encodeBase64Packet(b,k);return b}if(w&&n instanceof f.Blob)return c?m?b=h(b,c,k):(c=new Uint8Array(1),c[0]=p[b.type],b=new w([c.buffer,b.data]),b=k(b)):b=e.encodeBase64Packet(b,k),b;if(n&&n.base64)return k("b"+e.packets[b.type]+b.data.data);c=p[b.type];void 0!==b.data&&(c+=g?fa.encode(String(b.data)):String(b.data));return k(""+c)};e.encodeBase64Packet=function(b,h){var c="b"+e.packets[b.type];if(w&&b.data instanceof w){var g=new FileReader;g.onload=function(){var b=g.result.split(",")[1];
h(c+b)};return g.readAsDataURL(b.data)}try{var k=String.fromCharCode.apply(null,new Uint8Array(b.data))}catch(qo){b=new Uint8Array(b.data);k=Array(b.length);for(var n=0;n<b.length;n++)k[n]=b[n];k=String.fromCharCode.apply(null,k)}c+=f.btoa(k);return h(c)};e.decodePacket=function(b,f,h){if("string"==typeof b||void 0===b){if("b"==b.charAt(0))return e.decodeBase64Packet(b.substr(1),f);if(h)try{b=fa.decode(b)}catch(po){return t}h=b.charAt(0);return Number(h)==h&&q[h]?1<b.length?{type:q[h],data:b.substring(1)}:
{type:q[h]}:t}h=(new Uint8Array(b))[0];b=D(b,1);w&&"blob"===f&&(b=new w([b]));return{type:q[h],data:b}};e.decodeBase64Packet=function(b,e){var h=q[b.charAt(0)];if(!f.ArrayBuffer)return{type:h,data:{base64:!0,data:b.substr(1)}};b=y.decode(b.substr(1));"blob"===e&&w&&(b=new w([b]));return{type:h,data:b}};e.encodePayload=function(b,f,h){"function"==typeof f&&(h=f,f=null);var g=u(b);if(f&&g)return w&&!m?e.encodePayloadAsBlob(b,h):e.encodePayloadAsArrayBuffer(b,h);if(!b.length)return h("0:");c(b,function(b,
h){e.encodePacket(b,g?f:!1,!0,function(b){h(null,b.length+":"+b)})},function(b,e){return h(e.join(""))})};e.decodePayload=function(b,f,h){if("string"!=typeof b)return e.decodePayloadAsBinary(b,f,h);"function"===typeof f&&(h=f,f=null);if(""==b)return h(t,0,1);var c="";for(var g,k,n=0,u=b.length;n<u;n++)if(k=b.charAt(n),":"!=k)c+=k;else{if(""==c||c!=(g=Number(c)))return h(t,0,1);k=b.substr(n+1,g);if(c!=k.length)return h(t,0,1);if(k.length){c=e.decodePacket(k,f,!0);if(t.type==c.type&&t.data==c.data)return h(t,
0,1);if(!1===h(c,n+g,u))return}n+=g;c=""}if(""!=c)return h(t,0,1)};e.encodePayloadAsArrayBuffer=function(b,f){if(!b.length)return f(new ArrayBuffer(0));c(b,function(b,f){e.encodePacket(b,!0,!0,function(b){return f(null,b)})},function(b,e){b=e.reduce(function(b,e){e="string"===typeof e?e.length:e.byteLength;return b+e.toString().length+e+2},0);var h=new Uint8Array(b),c=0;e.forEach(function(b){var e="string"===typeof b,f=b;if(e){f=new Uint8Array(b.length);for(var g=0;g<b.length;g++)f[g]=b.charCodeAt(g);
f=f.buffer}e?h[c++]=0:h[c++]=1;b=f.byteLength.toString();for(g=0;g<b.length;g++)h[c++]=parseInt(b[g]);h[c++]=255;f=new Uint8Array(f);for(g=0;g<f.length;g++)h[c++]=f[g]});return f(h.buffer)})};e.encodePayloadAsBlob=function(b,f){c(b,function(b,f){e.encodePacket(b,!0,!0,function(b){var e=new Uint8Array(1);e[0]=1;if("string"===typeof b){for(var h=new Uint8Array(b.length),c=0;c<b.length;c++)h[c]=b.charCodeAt(c);b=h.buffer;e[0]=0}h=(b instanceof ArrayBuffer?b.byteLength:b.size).toString();var g=new Uint8Array(h.length+
1);for(c=0;c<h.length;c++)g[c]=parseInt(h[c]);g[h.length]=255;w&&(b=new w([e.buffer,g.buffer,b]),f(null,b))})},function(b,e){return f(new w(e))})};e.decodePayloadAsBinary=function(b,f,h){"function"===typeof f&&(h=f,f=null);for(var c=[],g=!1;0<b.byteLength;){for(var k=new Uint8Array(b),n=0===k[0],u="",r=1;255!=k[r];r++){if(310<u.length){g=!0;break}u+=k[r]}if(g)return h(t,0,1);b=D(b,2+u.length);u=parseInt(u);k=D(b,0,u);if(n)try{k=String.fromCharCode.apply(null,new Uint8Array(k))}catch(ro){for(n=new Uint8Array(k),
k="",r=0;r<n.length;r++)k+=String.fromCharCode(n[r])}c.push(k);b=D(b,u)}var y=c.length;c.forEach(function(b,c){h(e.decodePacket(b,f,!0),c,y)})}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./keys":25,after:1,"arraybuffer.slice":2,"base64-arraybuffer":5,blob:6,"has-binary":30,utf8:60}],25:[function(b,f,e){f.exports=Object.keys||function(b){var e=[],f=Object.prototype.hasOwnProperty,h;for(h in b)f.call(b,h)&&e.push(h);return e}},
{}],26:[function(b,f,e){function h(b){k.call(this);b=b||{};this.config={chunksize:16384,pacing:0};for(var e in b)this.config[e]=b[e];this.channel=this.file=null}function c(){k.call(this);this.receiveBuffer=[];this.received=0;this.metadata={};this.channel=null}var k=b("wildemitter");b=b("util");b.inherits(h,k);h.prototype.send=function(b,e){var f=this;this.file=b;this.channel=e;var h="number"!==typeof e.bufferedAmountLowThreshold,c=0,g=function(){var k=new window.FileReader;k.onload=function(){return function(k){f.channel.send(k.target.result);
f.emit("progress",c,b.size,k.target.result);b.size>c+k.target.result.byteLength?h?window.setTimeout(g,f.config.pacing):e.bufferedAmount<=e.bufferedAmountLowThreshold&&window.setTimeout(g,0):(f.emit("progress",b.size,b.size,null),f.emit("sentFile"));c+=f.config.chunksize}}(b);var n=b.slice(c,c+f.config.chunksize);k.readAsArrayBuffer(n)};h||(e.bufferedAmountLowThreshold=8*this.config.chunksize,e.addEventListener("bufferedamountlow",g));window.setTimeout(g,0)};b.inherits(c,k);c.prototype.receive=function(b,
e){var f=this;b&&(this.metadata=b);this.channel=e;e.binaryType="arraybuffer";this.channel.onmessage=function(b){f.received+=b.data.byteLength;f.receiveBuffer.push(b.data);f.emit("progress",f.received,f.metadata.size,b.data);f.received===f.metadata.size?(f.emit("receivedFile",new window.Blob(f.receiveBuffer),f.metadata),f.receiveBuffer=[]):f.received>f.metadata.size&&(console.error("received more than expected, discarding..."),f.receiveBuffer=[])}};f.exports={};f.exports.support="undefined"!==typeof window&&
window&&window.File&&window.FileReader&&window.Blob;f.exports.Sender=h;f.exports.Receiver=c},{util:63,wildemitter:65}],27:[function(b,f,e){var h={};f.exports=function(b,e){var f=2===arguments.length,c=f?e:b;if("undefined"===typeof window||"http:"===window.location.protocol){var g=Error("NavigatorUserMediaError");g.name="HTTPS_REQUIRED";return c(g)}if(window.navigator.userAgent.match("Chrome")){var k=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),r=33,fa=!window.chrome.webstore;
window.navigator.userAgent.match("Linux")&&(r=35);sessionStorage.getScreenMediaJSExtensionId?chrome.runtime.sendMessage(sessionStorage.getScreenMediaJSExtensionId,{type:"getScreen",id:1},null,function(e){e&&""!==e.sourceId?(b=f&&b||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3}}},b.video.mandatory.chromeMediaSourceId=e.sourceId,window.navigator.mediaDevices.getUserMedia(b).then(function(b){c(null,b)}).catch(function(b){c(b)})):
(e=Error("NavigatorUserMediaError"),e.name="NotAllowedError",c(e))}):window.cefGetScreenMedia?window.cefGetScreenMedia(function(e){e?(b=f&&b||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},b.video.mandatory.chromeMediaSourceId=e,window.navigator.mediaDevices.getUserMedia(b).then(function(b){c(null,b)}).catch(function(b){c(b)})):(e=Error("cefGetScreenMediaError"),
e.name="CEF_GETSCREENMEDIA_CANCELED",c(e))}):fa||26<=k&&k<=r?(b=f&&b||{video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3,chromeMediaSource:"screen"}}},window.navigator.mediaDevices.getUserMedia(b).then(function(b){c(null,b)}).catch(function(b){c(b)})):(k=window.setTimeout(function(){g=Error("NavigatorUserMediaError");g.name="EXTENSION_UNAVAILABLE";return c(g)},1E3),h[k]=[c,f?b:null],window.postMessage({type:"getScreen",id:k},"*"))}else window.navigator.userAgent.match("Firefox")&&
(33<=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10)?(b=f&&b||{video:{mozMediaSource:"window",mediaSource:"window"}},window.navigator.mediaDevices.getUserMedia(b).then(function(b){c(null,b);var e=b.currentTime,f=window.setInterval(function(){b||window.clearInterval(f);if(b.currentTime==e&&(window.clearInterval(f),b.onended))b.onended();e=b.currentTime},500)}).catch(function(b){c(b)})):(g=Error("NavigatorUserMediaError"),g.name="EXTENSION_UNAVAILABLE"))};"undefined"!==typeof window&&
window.addEventListener("message",function(b){if(b.origin==window.location.origin)if("gotScreen"==b.data.type&&h[b.data.id]){var e=h[b.data.id],f=e[1],c=e[0];delete h[b.data.id];""===b.data.sourceId?(b=Error("NavigatorUserMediaError"),b.name="NotAllowedError",c(b)):(f=f||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},f.video.mandatory.chromeMediaSourceId=
b.data.sourceId,window.navigator.mediaDevices.getUserMedia(f).then(function(b){c(null,b)}).catch(function(b){c(b)}))}else"getScreenPending"==b.data.type&&window.clearTimeout(b.data.id)})},{}],28:[function(b,f,e){f.exports=function(){return this}()},{}],29:[function(b,f,e){var h=b("wildemitter"),c;"undefined"!==typeof window&&(c=window.AudioContext||window.webkitAudioContext);var k=null;f.exports=function(b,e){var f=new h;if(!c)return f;e=e||{};var g=e.smoothing||.1,n=e.interval||50,u=e.threshold,
R=e.play;e=e.history||10;var l=!0;k||(k=new c);var m=k.createAnalyser();m.fftSize=512;m.smoothingTimeConstant=g;var p=new Float32Array(m.frequencyBinCount);b.jquery&&(b=b[0]);if(b instanceof HTMLAudioElement||b instanceof HTMLVideoElement){var q=k.createMediaElementSource(b);"undefined"===typeof R&&(R=!0)}else q=k.createMediaStreamSource(b);u=u||-50;q.connect(m);R&&m.connect(k.destination);f.speaking=!1;f.setThreshold=function(b){u=b};f.setInterval=function(b){n=b};f.stop=function(){l=!1;f.emit("volume_change",
-100,u);f.speaking&&(f.speaking=!1,f.emit("stopped_speaking"));m.disconnect();q.disconnect()};f.speakingHistory=[];for(b=0;b<e;b++)f.speakingHistory.push(0);var t=function(){setTimeout(function(){if(l){var b=-Infinity;m.getFloatFrequencyData(p);for(var e=4,h=p.length;e<h;e++)p[e]>b&&0>p[e]&&(b=p[e]);f.emit("volume_change",b,u);e=0;if(b>u&&!f.speaking){for(h=f.speakingHistory.length-3;h<f.speakingHistory.length;h++)e+=f.speakingHistory[h];2<=e&&(f.speaking=!0,f.emit("speaking"))}else if(b<u&&f.speaking){for(h=
0;h<f.speakingHistory.length;h++)e+=f.speakingHistory[h];0==e&&(f.speaking=!1,f.emit("stopped_speaking"))}f.speakingHistory.shift();f.speakingHistory.push(0+(b>u));t()}},n)};t();return f}},{wildemitter:65}],30:[function(b,f,e){(function(e){var h=b("isarray");f.exports=function(b){function f(b){if(!b)return!1;if(e.Buffer&&e.Buffer.isBuffer(b)||e.ArrayBuffer&&b instanceof ArrayBuffer||e.Blob&&b instanceof Blob||e.File&&b instanceof File)return!0;if(h(b))for(var c=0;c<b.length;c++){if(f(b[c]))return!0}else if(b&&
"object"==typeof b)for(c in b.toJSON&&(b=b.toJSON()),b)if(Object.prototype.hasOwnProperty.call(b,c)&&f(b[c]))return!0;return!1}return f(b)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{isarray:33}],31:[function(b,f,e){b=b("global");try{f.exports="XMLHttpRequest"in b&&"withCredentials"in new b.XMLHttpRequest}catch(h){f.exports=!1}},{global:28}],32:[function(b,f,e){var h=[].indexOf;f.exports=function(b,e){if(h)return b.indexOf(e);
for(var f=0;f<b.length;++f)if(b[f]===e)return f;return-1}},{}],33:[function(b,f,e){f.exports=Array.isArray||function(b){return"[object Array]"==Object.prototype.toString.call(b)}},{}],34:[function(b,f,e){(function(b){function f(b){if(f[b]!==u)return f[b];if("bug-string-char-index"==b)var e=!1;else if("json"==b)e=f("json-stringify")&&f("json-parse");else{var c;if("json-stringify"==b){e=y.stringify;var g="function"==typeof e&&r;if(g){(c=function(){return 1}).toJSON=c;try{g="0"===e(0)&&"0"===e(new Number)&&
'""'==e(new String)&&e(h)===u&&e(u)===u&&e()===u&&"1"===e(c)&&"[1]"==e([c])&&"[null]"==e([u])&&"null"==e(null)&&"[null,null,null]"==e([u,h,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==e({a:[c,!0,!1,null,"\x00\b\n\f\r\t"]})&&"1"===e(null,c)&&"[\n 1,\n 2\n]"==e([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==e(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==e(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==e(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==e(new Date(-1))}catch(Vf){g=
!1}}e=g}if("json-parse"==b){e=y.parse;if("function"==typeof e)try{if(0===e("0")&&!e(!1)){c=e('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var k=5==c.a.length&&1===c.a[0];if(k){try{k=!e('"\t"')}catch(Vf){}if(k)try{k=1!==e("01")}catch(Vf){}if(k)try{k=1!==e("1.")}catch(Vf){}}}}catch(Vf){k=!1}e=k}}return f[b]=!!e}var h={}.toString,c,u,D="object"==typeof JSON&&JSON,y="object"==typeof e&&e&&!e.nodeType&&e;y&&D?(y.stringify=D.stringify,y.parse=D.parse):y=b.JSON=D||{};var r=new Date(-0xc782b5b800cec);
try{r=-109252==r.getUTCFullYear()&&0===r.getUTCMonth()&&1===r.getUTCDate()&&10==r.getUTCHours()&&37==r.getUTCMinutes()&&6==r.getUTCSeconds()&&708==r.getUTCMilliseconds()}catch(so){}if(!f("json")){var fa=f("bug-string-char-index");if(!r)var R=Math.floor,l=[0,31,59,90,120,151,181,212,243,273,304,334],m=function(b,e){return l[e]+365*(b-1970)+R((b-1969+(e=+(1<e)))/4)-R((b-1901+e)/100)+R((b-1601+e)/400)};(c={}.hasOwnProperty)||(c=function(b){var e={};if((e.__proto__=null,e.__proto__={toString:1},e).toString!=
h)c=function(b){var e=this.__proto__;b=b in(this.__proto__=null,this);this.__proto__=e;return b};else{var f=e.constructor;c=function(b){var e=(this.constructor||f).prototype;return b in this&&!(b in e&&this[b]===e[b])}}e=null;return c.call(this,b)});var p={"boolean":1,number:1,string:1,undefined:1};var q=function(b,e){var f=0,g,k;(g=function(){this.valueOf=0}).prototype.valueOf=0;var n=new g;for(k in n)c.call(n,k)&&f++;g=n=null;f?q=2==f?function(b,e){var f={},g="[object Function]"==h.call(b),k;for(k in b)g&&
"prototype"==k||c.call(f,k)||!(f[k]=1)||!c.call(b,k)||e(k)}:function(b,e){var f="[object Function]"==h.call(b),g,k;for(g in b)f&&"prototype"==g||!c.call(b,g)||(k="constructor"===g)||e(g);(k||c.call(b,g="constructor"))&&e(g)}:(n="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),q=function(b,e){var f="[object Function]"==h.call(b),g,k;if(k=!f&&"function"!=typeof b.constructor)k=typeof b.hasOwnProperty,k="object"==k?!!b.hasOwnProperty:!p[k];k=
k?b.hasOwnProperty:c;for(g in b)f&&"prototype"==g||!k.call(b,g)||e(g);for(f=n.length;g=n[--f];k.call(b,g)&&e(g));});return q(b,e)};if(!f("json-stringify")){var t={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},w=function(b,e){return("000000"+(e||0)).slice(-b)},v=function(b){var e='"',f=0,h=b.length,c=10<h&&fa,g;for(c&&(g=b.split(""));f<h;f++){var k=b.charCodeAt(f);switch(k){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=t[k];break;default:e=32>k?e+("\\u00"+w(2,k.toString(16))):
e+(c?g[f]:fa?b.charAt(f):b[f])}}return e+'"'},x=function(b,e,f,g,k,n,r){var y;try{var D=e[b]}catch(uo){}if("object"==typeof D&&D){var fa=h.call(D);if("[object Date]"!=fa||c.call(D,"toJSON"))"function"==typeof D.toJSON&&("[object Number]"!=fa&&"[object String]"!=fa&&"[object Array]"!=fa||c.call(D,"toJSON"))&&(D=D.toJSON(b));else if(D>-1/0&&D<1/0){if(m){var l=R(D/864E5);for(fa=R(l/365.2425)+1970-1;m(fa+1,0)<=l;fa++);for(y=R((l-m(fa,0))/30.42);m(fa,y+1)<=l;y++);l=1+l-m(fa,y);var Ic=(D%864E5+864E5)%864E5;
var p=R(Ic/36E5)%24;var Uf=R(Ic/6E4)%60;var t=R(Ic/1E3)%60;Ic%=1E3}else fa=D.getUTCFullYear(),y=D.getUTCMonth(),l=D.getUTCDate(),p=D.getUTCHours(),Uf=D.getUTCMinutes(),t=D.getUTCSeconds(),Ic=D.getUTCMilliseconds();D=(0>=fa||1E4<=fa?(0>fa?"-":"+")+w(6,0>fa?-fa:fa):w(4,fa))+"-"+w(2,y+1)+"-"+w(2,l)+"T"+w(2,p)+":"+w(2,Uf)+":"+w(2,t)+"."+w(3,Ic)+"Z"}else D=null}f&&(D=f.call(e,b,D));if(null===D)return"null";fa=h.call(D);if("[object Boolean]"==fa)return""+D;if("[object Number]"==fa)return D>-1/0&&D<1/0?
""+D:"null";if("[object String]"==fa)return v(""+D);if("object"==typeof D){for(b=r.length;b--;)if(r[b]===D)throw TypeError();r.push(D);var Sb=[];e=n;n+=k;if("[object Array]"==fa){y=0;for(b=D.length;y<b;y++)fa=x(y,D,f,g,k,n,r),Sb.push(fa===u?"null":fa);b=Sb.length?k?"[\n"+n+Sb.join(",\n"+n)+"\n"+e+"]":"["+Sb.join(",")+"]":"[]"}else q(g||D,function(b){var e=x(b,D,f,g,k,n,r);e!==u&&Sb.push(v(b)+":"+(k?" ":"")+e)}),b=Sb.length?k?"{\n"+n+Sb.join(",\n"+n)+"\n"+e+"}":"{"+Sb.join(",")+"}":"{}";r.pop();return b}};
y.stringify=function(b,e,f){var c;if("function"==typeof e||"object"==typeof e&&e)if("[object Function]"==(c=h.call(e)))var g=e;else if("[object Array]"==c){var k={};for(var n=0,u=e.length,r;n<u;r=e[n++],(c=h.call(r),"[object String]"==c||"[object Number]"==c)&&(k[r]=1));}if(f)if("[object Number]"==(c=h.call(f))){if(0<(f-=f%1)){var y="";for(10<f&&(f=10);y.length<f;y+=" ");}}else"[object String]"==c&&(y=10>=f.length?f:f.slice(0,10));return x("",(r={},r[""]=b,r),g,k,y,"",[])}}if(!f("json-parse")){var z=
String.fromCharCode,B={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},A,G,E=function(){A=G=null;throw SyntaxError();},F=function(){for(var b=G,e=b.length,f,h,c,g,k;A<e;)switch(k=b.charCodeAt(A),k){case 9:case 10:case 13:case 32:A++;break;case 123:case 125:case 91:case 93:case 58:case 44:return f=fa?b.charAt(A):b[A],A++,f;case 34:f="@";for(A++;A<e;)if(k=b.charCodeAt(A),32>k)E();else if(92==k)switch(k=b.charCodeAt(++A),k){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:f+=
B[k];A++;break;case 117:h=++A;for(c=A+4;A<c;A++)k=b.charCodeAt(A),48<=k&&57>=k||97<=k&&102>=k||65<=k&&70>=k||E();f+=z("0x"+b.slice(h,A));break;default:E()}else{if(34==k)break;k=b.charCodeAt(A);for(h=A;32<=k&&92!=k&&34!=k;)k=b.charCodeAt(++A);f+=b.slice(h,A)}if(34==b.charCodeAt(A))return A++,f;E();default:h=A;45==k&&(g=!0,k=b.charCodeAt(++A));if(48<=k&&57>=k){for(48==k&&(k=b.charCodeAt(A+1),48<=k&&57>=k)&&E();A<e&&(k=b.charCodeAt(A),48<=k&&57>=k);A++);if(46==b.charCodeAt(A)){for(c=++A;c<e&&(k=b.charCodeAt(c),
48<=k&&57>=k);c++);c==A&&E();A=c}k=b.charCodeAt(A);if(101==k||69==k){k=b.charCodeAt(++A);43!=k&&45!=k||A++;for(c=A;c<e&&(k=b.charCodeAt(c),48<=k&&57>=k);c++);c==A&&E();A=c}return+b.slice(h,A)}g&&E();if("true"==b.slice(A,A+4))return A+=4,!0;if("false"==b.slice(A,A+5))return A+=5,!1;if("null"==b.slice(A,A+4))return A+=4,null;E()}return"$"},C=function(b){var e,f;"$"==b&&E();if("string"==typeof b){if("@"==(fa?b.charAt(0):b[0]))return b.slice(1);if("["==b){for(e=[];;f||(f=!0)){b=F();if("]"==b)break;f&&
(","==b?(b=F(),"]"==b&&E()):E());","==b&&E();e.push(C(b))}return e}if("{"==b){for(e={};;f||(f=!0)){b=F();if("}"==b)break;f&&(","==b?(b=F(),"}"==b&&E()):E());","!=b&&"string"==typeof b&&"@"==(fa?b.charAt(0):b[0])&&":"==F()||E();e[b.slice(1)]=C(F())}return e}E()}return b},H=function(b,e,f){f=I(b,e,f);f===u?delete b[e]:b[e]=f},I=function(b,e,f){var c=b[e],g;if("object"==typeof c&&c)if("[object Array]"==h.call(c))for(g=c.length;g--;)H(c,g,f);else q(c,function(b){H(c,b,f)});return f.call(b,e,c)};y.parse=
function(b,e){var f;A=0;G=""+b;b=C(F());"$"!=F()&&E();A=G=null;return e&&"[object Function]"==h.call(e)?I((f={},f[""]=b,f),"",e):b}}}})(this)},{}],35:[function(b,f,e){function h(b){var e=!0;b.getTracks().forEach(function(b){e="ended"===b.readyState&&e});return e}function c(){if("undefined"===typeof window||!window.navigator.mozGetUserMedia)return!1;var b=window.navigator.userAgent.match(/Firefox\/(\d+)\./);return 50>(b&&1<=b.length&&parseInt(b[1],10))}function k(b){D.call(this);var e=this.config=
{detectSpeakingEvents:!1,audioFallback:!1,media:{audio:!0,video:!0},harkOptions:null,logger:y},f;for(f in b)b.hasOwnProperty(f)&&(this.config[f]=b[f]);this.logger=e.logger;this._log=this.logger.log.bind(this.logger,"LocalMedia:");this._logerror=this.logger.error.bind(this.logger,"LocalMedia:");this.localStreams=[];this.localScreens=[];navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||this._logerror("Your browser does not support local media capture.");this._audioMonitors=[];this.on("localStreamStopped",
this._stopAudioMonitor.bind(this));this.on("localScreenStopped",this._stopAudioMonitor.bind(this))}e=b("util");var n=b("hark"),u=b("getscreenmedia"),D=b("wildemitter"),y=b("mockconsole");e.inherits(k,D);k.prototype.start=function(b,e){var f=this,c=b||this.config.media;this.emit("localStreamRequested",c);navigator.mediaDevices.getUserMedia(c).then(function(b){c.audio&&f.config.detectSpeakingEvents&&f._setupAudioMonitor(b,f.config.harkOptions);f.localStreams.push(b);b.getTracks().forEach(function(e){e.addEventListener("ended",
function(){h(b)&&f._removeStream(b)})});f.emit("localStream",b);if(e)return e(null,b)}).catch(function(b){if(f.config.audioFallback&&"NotFoundError"===b.name&&!1!==c.video)c.video=!1,f.start(c,e);else if(f.emit("localStreamRequestFailed",c),e)return e(b,null)})};k.prototype.stop=function(b){this.stopStream(b);this.stopScreenShare(b)};k.prototype.stopStream=function(b){var e=this;b?-1<this.localStreams.indexOf(b)&&(b.getTracks().forEach(function(b){b.stop()}),c()&&this._removeStream(b)):this.localStreams.forEach(function(b){b.getTracks().forEach(function(b){b.stop()});
c()&&e._removeStream(b)})};k.prototype.startScreenShare=function(b,e){var f=this;this.emit("localScreenRequested");"function"!==typeof b||e||(e=b,b=null);u(b,function(b,h){b?f.emit("localScreenRequestFailed"):(f.localScreens.push(h),h.getTracks().forEach(function(b){b.addEventListener("ended",function(){var b=!0;h.getTracks().forEach(function(e){b="ended"===e.readyState&&b});b&&f._removeStream(h)})}),f.emit("localScreen",h));if(e)return e(b,h)})};k.prototype.stopScreenShare=function(b){var e=this;
b?-1<this.localScreens.indexOf(b)&&(b.getTracks().forEach(function(b){b.stop()}),c()&&this._removeStream(b)):this.localScreens.forEach(function(b){b.getTracks().forEach(function(b){b.stop()});c()&&e._removeStream(b)})};k.prototype.mute=function(){this._audioEnabled(!1);this.emit("audioOff")};k.prototype.unmute=function(){this._audioEnabled(!0);this.emit("audioOn")};k.prototype.pauseVideo=function(){this._videoEnabled(!1);this.emit("videoOff")};k.prototype.resumeVideo=function(){this._videoEnabled(!0);
this.emit("videoOn")};k.prototype.pause=function(){this.mute();this.pauseVideo()};k.prototype.resume=function(){this.unmute();this.resumeVideo()};k.prototype._audioEnabled=function(b){this.localStreams.forEach(function(e){e.getAudioTracks().forEach(function(e){e.enabled=!!b})})};k.prototype._videoEnabled=function(b){this.localStreams.forEach(function(e){e.getVideoTracks().forEach(function(e){e.enabled=!!b})})};k.prototype.isAudioEnabled=function(){var b=!0;this.localStreams.forEach(function(e){e.getAudioTracks().forEach(function(e){b=
b&&e.enabled})});return b};k.prototype.isVideoEnabled=function(){var b=!0;this.localStreams.forEach(function(e){e.getVideoTracks().forEach(function(e){b=b&&e.enabled})});return b};k.prototype._removeStream=function(b){var e=this.localStreams.indexOf(b);-1<e?(this.localStreams.splice(e,1),this.emit("localStreamStopped",b)):(e=this.localScreens.indexOf(b),-1<e&&(this.localScreens.splice(e,1),this.emit("localScreenStopped",b)))};k.prototype._setupAudioMonitor=function(b,e){this._log("Setup audio");e=
n(b,e);var f=this,h;e.on("speaking",function(){f.emit("speaking")});e.on("stopped_speaking",function(){h&&clearTimeout(h);h=setTimeout(function(){f.emit("stoppedSpeaking")},1E3)});e.on("volume_change",function(b,e){f.emit("volumeChange",b,e)});this._audioMonitors.push({audio:e,stream:b})};k.prototype._stopAudioMonitor=function(b){var e=-1;this._audioMonitors.forEach(function(f,h){f.stream===b&&(e=h)});-1<e&&(this._audioMonitors[e].audio.stop(),this._audioMonitors.splice(e,1))};f.exports=k},{getscreenmedia:27,
hark:29,mockconsole:37,util:63,wildemitter:65}],36:[function(b,f,e){(function(b){function h(b,e){b.set(e[0],e[1]);return b}function c(b,e){b.add(e);return b}function n(b,e){for(var f=-1,h=b?b.length:0;++f<h&&!1!==e(b[f],f,b););return b}function u(b,e,f,h){var c=-1,g=b?b.length:0;for(h&&g&&(f=b[++c]);++c<g;)f=e(f,b[c],c,b);return f}function D(b){var e=!1;if(null!=b&&"function"!=typeof b.toString)try{e=!!(b+"")}catch(wo){}return e}function y(b){var e=-1,f=Array(b.size);b.forEach(function(b,h){f[++e]=
[h,b]});return f}function r(b,e){return function(f){return b(e(f))}}function fa(b){var e=-1,f=Array(b.size);b.forEach(function(b){f[++e]=b});return f}function R(b){var e=-1,f=b?b.length:0;for(this.clear();++e<f;){var h=b[e];this.set(h[0],h[1])}}function l(b){var e=-1,f=b?b.length:0;for(this.clear();++e<f;){var h=b[e];this.set(h[0],h[1])}}function m(b){var e=-1,f=b?b.length:0;for(this.clear();++e<f;){var h=b[e];this.set(h[0],h[1])}}function p(b){this.__data__=new l(b)}function q(b,e,f){var h=b[e];
ba.call(b,e)&&(h===f||h!==h&&f!==f)&&(void 0!==f||e in b)||(b[e]=f)}function t(b,e){for(var f=b.length;f--;){var h=b[f][0];if(h===e||h!==h&&e!==e)return f}return-1}function w(b,e){return b&&G(e,K(e),b)}function v(b,e,f,h,c,g,k){var u;h&&(u=g?h(b,c,g,k):h(b));if(void 0!==u)return u;if(!M(b))return b;if(c=Ja(b)){if(u=H(b),!e)return B(b,u)}else{var y=wa(b),r="[object Function]"==y||"[object GeneratorFunction]"==y;if(Da(b))return x(b,e);if("[object Object]"==y||"[object Arguments]"==y||r&&!g){if(D(b))return g?
b:{};u=I(r?{}:b);if(!e)return E(b,w(u,b))}else{if(!J[y])return g?b:{};u=L(b,y,v,e)}}k||(k=new p);if(g=k.get(b))return g;k.set(b,u);if(!c)var R=f?A(b,K,Oa):K(b);n(R||b,function(c,g){R&&(g=c,c=b[g]);q(u,g,v(c,e,f,h,g,b,k))});return u}function A(b,e,f){e=e(b);if(!Ja(b)){b=f(b);f=-1;for(var h=b.length,c=e.length;++f<h;)e[c+f]=b[f]}return e}function x(b,e){if(e)return b.slice();e=new b.constructor(b.length);b.copy(e);return e}function z(b){var e=new b.constructor(b.byteLength);(new da(e)).set(new da(b));
return e}function B(b,e){var f=-1,h=b.length;for(e||(e=Array(h));++f<h;)e[f]=b[f];return e}function G(b,e,f,h){f||(f={});for(var c=-1,g=e.length;++c<g;){var k=e[c],n=h?h(f[k],b[k],k,f,b):void 0;q(f,k,void 0===n?b[k]:n)}return f}function E(b,e){return G(b,Oa(b),e)}function F(b,e){b=b.__data__;var f=typeof e;return("string"==f||"number"==f||"symbol"==f||"boolean"==f?"__proto__"!==e:null===e)?b["string"==typeof e?"string":"hash"]:b.map}function C(b,e){b=null==b?void 0:b[e];e=!M(b)||ja&&ja in b?!1:(T(b)||
D(b)?ca:P).test(id(b));return e?b:void 0}function H(b){var e=b.length,f=b.constructor(e);e&&"string"==typeof b[0]&&ba.call(b,"index")&&(f.index=b.index,f.input=b.input);return f}function I(b){"function"!=typeof b.constructor||bk(b)?b={}:(b=oa(b),b=M(b)?la(b):{});return b}function L(b,e,f,g){var k=b.constructor;switch(e){case "[object ArrayBuffer]":return z(b);case "[object Boolean]":case "[object Date]":return new k(+b);case "[object DataView]":return e=g?z(b.buffer):b.buffer,new b.constructor(e,
b.byteOffset,b.byteLength);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return e=g?z(b.buffer):b.buffer,new b.constructor(e,b.byteOffset,b.length);case "[object Map]":return e=g?f(y(b),!0):y(b),u(e,h,new b.constructor);case "[object Number]":case "[object String]":return new k(b);case "[object RegExp]":return e=
new b.constructor(b.source,Y.exec(b)),e.lastIndex=b.lastIndex,e;case "[object Set]":return e=g?f(fa(b),!0):fa(b),u(e,c,new b.constructor);case "[object Symbol]":return ua?Object(ua.call(b)):{}}}function bk(b){var e=b&&b.constructor;return b===("function"==typeof e&&e.prototype||Z)}function id(b){if(null!=b){try{return ma.call(b)}catch(vo){}return b+""}return""}function ck(b){var e;if(e=null!=b)e=b.length,e="number"==typeof e&&-1<e&&0==e%1&&9007199254740991>=e;return e&&!T(b)}function T(b){b=M(b)?
ia.call(b):"";return"[object Function]"==b||"[object GeneratorFunction]"==b}function M(b){var e=typeof b;return!!b&&("object"==e||"function"==e)}function K(b){if(ck(b)){var e;(e=Ja(b))||(e=!!b&&"object"==typeof b&&ck(b)&&ba.call(b,"callee")&&(!ka.call(b,"callee")||"[object Arguments]"==ia.call(b)));if(e){e=b.length;for(var f=String,h=-1,c=Array(e);++h<e;)c[h]=f(h);e=c}else e=[];f=e.length;h=!!f;for(var g in b){if(!(c=!ba.call(b,g))&&(c=h)&&!(c="length"==g)){c=g;var k=f;k=null==k?9007199254740991:
k;c=!!k&&("number"==typeof c||W.test(c))&&-1<c&&0==c%1&&c<k}c||e.push(g)}b=e}else if(bk(b)){g=[];for(e in Object(b))ba.call(b,e)&&"constructor"!=e&&g.push(e);b=g}else b=U(b);return b}function Q(){return[]}function S(){return!1}var Y=/\w*$/,P=/^\[object .+?Constructor\]$/,W=/^(?:0|[1-9]\d*)$/,J={};J["[object Arguments]"]=J["[object Array]"]=J["[object ArrayBuffer]"]=J["[object DataView]"]=J["[object Boolean]"]=J["[object Date]"]=J["[object Float32Array]"]=J["[object Float64Array]"]=J["[object Int8Array]"]=
J["[object Int16Array]"]=J["[object Int32Array]"]=J["[object Map]"]=J["[object Number]"]=J["[object Object]"]=J["[object RegExp]"]=J["[object Set]"]=J["[object String]"]=J["[object Symbol]"]=J["[object Uint8Array]"]=J["[object Uint8ClampedArray]"]=J["[object Uint16Array]"]=J["[object Uint32Array]"]=!0;J["[object Error]"]=J["[object Function]"]=J["[object WeakMap]"]=!1;var O="object"==typeof self&&self&&self.Object===Object&&self;b="object"==typeof b&&b&&b.Object===Object&&b||O||Function("return this")();
var X=(O="object"==typeof e&&e&&!e.nodeType&&e)&&"object"==typeof f&&f&&!f.nodeType&&f;O=X&&X.exports===O;X=Array.prototype;var V=Function.prototype,Z=Object.prototype,ea=b["__core-js_shared__"],ja=function(){var b=/[^.]+$/.exec(ea&&ea.keys&&ea.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:""}(),ma=V.toString,ba=Z.hasOwnProperty,ia=Z.toString,ca=RegExp("^"+ma.call(ba).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");V=O?b.Buffer:
void 0;O=b.Symbol;var da=b.Uint8Array,oa=r(Object.getPrototypeOf,Object),la=Object.create,ka=Z.propertyIsEnumerable,ta=X.splice;X=Object.getOwnPropertySymbols;V=V?V.isBuffer:void 0;var U=r(Object.keys,Object),ra=C(b,"DataView"),N=C(b,"Map"),na=C(b,"Promise"),ha=C(b,"Set");b=C(b,"WeakMap");var ya=C(Object,"create"),Ea=id(ra),pa=id(N),va=id(na),Ca=id(ha),qa=id(b),ua=(O=O?O.prototype:void 0)?O.valueOf:void 0;R.prototype.clear=function(){this.__data__=ya?ya(null):{}};R.prototype["delete"]=function(b){return this.has(b)&&
delete this.__data__[b]};R.prototype.get=function(b){var e=this.__data__;return ya?(b=e[b],"__lodash_hash_undefined__"===b?void 0:b):ba.call(e,b)?e[b]:void 0};R.prototype.has=function(b){var e=this.__data__;return ya?void 0!==e[b]:ba.call(e,b)};R.prototype.set=function(b,e){this.__data__[b]=ya&&void 0===e?"__lodash_hash_undefined__":e;return this};l.prototype.clear=function(){this.__data__=[]};l.prototype["delete"]=function(b){var e=this.__data__;b=t(e,b);if(0>b)return!1;b==e.length-1?e.pop():ta.call(e,
b,1);return!0};l.prototype.get=function(b){var e=this.__data__;b=t(e,b);return 0>b?void 0:e[b][1]};l.prototype.has=function(b){return-1<t(this.__data__,b)};l.prototype.set=function(b,e){var f=this.__data__,h=t(f,b);0>h?f.push([b,e]):f[h][1]=e;return this};m.prototype.clear=function(){this.__data__={hash:new R,map:new (N||l),string:new R}};m.prototype["delete"]=function(b){return F(this,b)["delete"](b)};m.prototype.get=function(b){return F(this,b).get(b)};m.prototype.has=function(b){return F(this,
b).has(b)};m.prototype.set=function(b,e){F(this,b).set(b,e);return this};p.prototype.clear=function(){this.__data__=new l};p.prototype["delete"]=function(b){return this.__data__["delete"](b)};p.prototype.get=function(b){return this.__data__.get(b)};p.prototype.has=function(b){return this.__data__.has(b)};p.prototype.set=function(b,e){var f=this.__data__;if(f instanceof l){f=f.__data__;if(!N||199>f.length)return f.push([b,e]),this;f=this.__data__=new m(f)}f.set(b,e);return this};var Oa=X?r(X,Object):
Q,wa=function(b){return ia.call(b)};if(ra&&"[object DataView]"!=wa(new ra(new ArrayBuffer(1)))||N&&"[object Map]"!=wa(new N)||na&&"[object Promise]"!=wa(na.resolve())||ha&&"[object Set]"!=wa(new ha)||b&&"[object WeakMap]"!=wa(new b))wa=function(b){var e=ia.call(b);if(b=(b="[object Object]"==e?b.constructor:void 0)?id(b):void 0)switch(b){case Ea:return"[object DataView]";case pa:return"[object Map]";case va:return"[object Promise]";case Ca:return"[object Set]";case qa:return"[object WeakMap]"}return e};
var Ja=Array.isArray,Da=V||S;f.exports=function(b){return v(b,!0,!0)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],37:[function(b,f,e){b="assert count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd time timeEnd trace warn".split(" ");e=b.length;for(var h=function(){},c={};e--;)c[b[e]]=h;f.exports=c},{}],38:[function(b,f,e){function h(b){if(b=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(b)){var e=
parseFloat(b[1]);switch((b[2]||"ms").toLowerCase()){case "years":case "year":case "y":return e*k;case "days":case "day":case "d":return 864E5*e;case "hours":case "hour":case "h":return 36E5*e;case "minutes":case "minute":case "m":return 6E4*e;case "seconds":case "second":case "s":return 1E3*e;case "ms":return e}}}function c(b,e,f){if(!(b<e))return b<1.5*e?Math.floor(b/e)+" "+f:Math.ceil(b/e)+" "+f+"s"}var k=315576E5;f.exports=function(b,e){e=e||{};return"string"==typeof b?h(b):e.long?c(b,864E5,"day")||
c(b,36E5,"hour")||c(b,6E4,"minute")||c(b,1E3,"second")||b+" ms":864E5<=b?Math.round(b/864E5)+"d":36E5<=b?Math.round(b/36E5)+"h":6E4<=b?Math.round(b/6E4)+"m":1E3<=b?Math.round(b/1E3)+"s":b+"ms"}},{}],39:[function(b,f,e){var h=Object.prototype.hasOwnProperty;e.keys=Object.keys||function(b){var e=[],f;for(f in b)h.call(b,f)&&e.push(f);return e};e.values=function(b){var e=[],f;for(f in b)h.call(b,f)&&e.push(b[f]);return e};e.merge=function(b,e){for(var f in e)h.call(e,f)&&(b[f]=e[f]);return b};e.length=
function(b){return e.keys(b).length};e.isEmpty=function(b){return 0==e.length(b)}},{}],40:[function(b,f,e){(function(b){var e=/^[\],:{}\s]*$/,h=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,c=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,u=/(?:^|:|,)(?:\s*\[)+/g,D=/^\s+/,y=/\s+$/;f.exports=function(f){if("string"!=typeof f||!f)return null;f=f.replace(D,"").replace(y,"");if(b.JSON&&JSON.parse)return JSON.parse(f);if(e.test(f.replace(h,"@").replace(c,"]").replace(u,"")))return(new Function("return "+
f))()}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],41:[function(b,f,e){e.encode=function(b){var e="",f;for(f in b)b.hasOwnProperty(f)&&(e.length&&(e+="&"),e+=encodeURIComponent(f)+"="+encodeURIComponent(b[f]));return e};e.decode=function(b){var e={};b=b.split("&");for(var f=0,h=b.length;f<h;f++){var c=b[f].split("=");e[decodeURIComponent(c[0])]=decodeURIComponent(c[1])}return e}},{}],42:[function(b,f,e){var h=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
c="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");f.exports=function(b){b=h.exec(b||"");for(var e={},f=14;f--;)e[c[f]]=b[f]||"";return e}},{}],43:[function(b,f,e){function h(){throw Error("setTimeout has not been defined");}function c(){throw Error("clearTimeout has not been defined");}function k(b){if(l===setTimeout)return setTimeout(b,0);if((l===h||!l)&&setTimeout)return l=setTimeout,setTimeout(b,0);try{return l(b,0)}catch(Em){try{return l.call(null,
b,0)}catch(Fm){return l.call(this,b,0)}}}function n(b){if(R===clearTimeout)return clearTimeout(b);if((R===c||!R)&&clearTimeout)return R=clearTimeout,clearTimeout(b);try{return R(b)}catch(Em){try{return R.call(null,b)}catch(Fm){return R.call(this,b)}}}function u(){p&&q&&(p=!1,q.length?m=q.concat(m):t=-1,m.length&&D())}function D(){if(!p){var b=k(u);p=!0;for(var e=m.length;e;){q=m;for(m=[];++t<e;)q&&q[t].run();t=-1;e=m.length}q=null;p=!1;n(b)}}function y(b,e){this.fun=b;this.array=e}function r(){}b=
f.exports={};try{var l="function"===typeof setTimeout?setTimeout:h}catch(Dm){l=h}try{var R="function"===typeof clearTimeout?clearTimeout:c}catch(Dm){R=c}var m=[],p=!1,q,t=-1;b.nextTick=function(b){var e=Array(arguments.length-1);if(1<arguments.length)for(var f=1;f<arguments.length;f++)e[f-1]=arguments[f];m.push(new y(b,e));1!==m.length||p||k(D)};y.prototype.run=function(){this.fun.apply(null,this.array)};b.title="browser";b.browser=!0;b.env={};b.argv=[];b.version="";b.versions={};b.on=r;b.addListener=
r;b.once=r;b.off=r;b.removeListener=r;b.removeAllListeners=r;b.emit=r;b.prependListener=r;b.prependOnceListener=r;b.listeners=function(b){return[]};b.binding=function(b){throw Error("process.binding is not supported");};b.cwd=function(){return"/"};b.chdir=function(b){throw Error("process.chdir is not supported");};b.umask=function(){return 0}},{}],44:[function(b,f,e){function h(b,e){var f=this,c;k.call(this);b=b||{};b.iceServers=b.iceServers||[];this.enableChromeNativeSimulcast=!1;e&&e.optional&&
window.chrome&&null===navigator.appVersion.match(/Chromium\//)&&e.optional.forEach(function(b){b.enableChromeNativeSimulcast&&(f.enableChromeNativeSimulcast=!0)});this.enableMultiStreamHacks=!1;e&&e.optional&&window.chrome&&e.optional.forEach(function(b){b.enableMultiStreamHacks&&(f.enableMultiStreamHacks=!0)});this.restrictBandwidth=0;e&&e.optional&&e.optional.forEach(function(b){b.andyetRestrictBandwidth&&(f.restrictBandwidth=b.andyetRestrictBandwidth)});this.batchIceCandidates=0;e&&e.optional&&
e.optional.forEach(function(b){b.andyetBatchIce&&(f.batchIceCandidates=b.andyetBatchIce)});this.batchedIceCandidates=[];e&&e.optional&&window.chrome&&e.optional.forEach(function(b){b.andyetFasterICE&&(f.eliminateDuplicateCandidates=b.andyetFasterICE)});e&&e.optional&&e.optional.forEach(function(b){b.andyetDontSignalCandidates&&(f.dontSignalCandidates=b.andyetDontSignalCandidates)});this.assumeSetLocalSuccess=!1;e&&e.optional&&e.optional.forEach(function(b){b.andyetAssumeSetLocalSuccess&&(f.assumeSetLocalSuccess=
b.andyetAssumeSetLocalSuccess)});window.navigator.mozGetUserMedia&&e&&e.optional&&(this.wtFirefox=0,e.optional.forEach(function(b){b.andyetFirefoxMakesMeSad&&(f.wtFirefox=b.andyetFirefoxMakesMeSad,0<f.wtFirefox&&(f.firefoxcandidatebuffer=[]))}));this.pc=new RTCPeerConnection(b,e);this.getLocalStreams="function"===typeof this.pc.getLocalStreams?this.pc.getLocalStreams.bind(this.pc):function(){return[]};this.getSenders="function"===typeof this.pc.getSenders?this.pc.getSenders.bind(this.pc):function(){return[]};
this.getRemoteStreams="function"===typeof this.pc.getRemoteStreams?this.pc.getRemoteStreams.bind(this.pc):function(){return[]};this.getReceivers="function"===typeof this.pc.getReceivers?this.pc.getReceivers.bind(this.pc):function(){return[]};this.addStream=this.pc.addStream.bind(this.pc);this.removeStream=function(b){"function"===typeof f.pc.removeStream?f.pc.removeStream.apply(f.pc,arguments):"function"===typeof f.pc.removeTrack&&b.getTracks().forEach(function(b){f.pc.removeTrack(b)})};"function"===
typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc));this.pc.onremovestream=this.emit.bind(this,"removeStream");this.pc.onremovetrack=this.emit.bind(this,"removeTrack");this.pc.onaddstream=this.emit.bind(this,"addStream");this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded");this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange");this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange");this.pc.onicecandidate=this._onIce.bind(this);
this.pc.ondatachannel=this._onDataChannel.bind(this);this.localDescription={contents:[]};this.remoteDescription={contents:[]};this.config={debug:!1,sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1};this.iceCredentials={local:{},remote:{}};for(c in b)this.config[c]=b[c];if(this.config.debug)this.on("*",function(){(b.logger||console).log("PeerConnection event:",arguments)});this.hadRemoteIPv6Candidate=this.hadLocalIPv6Candidate=this.hadRemoteRelayCandidate=this.hadLocalRelayCandidate=this.hadRemoteStunCandidate=
this.hadLocalStunCandidate=!1;this._remoteDataChannels=[];this._localDataChannels=[];this._candidateBuffer=[]}e=b("util");var c=b("sdp-jingle-json"),k=b("wildemitter"),n=b("lodash.clonedeep");e.inherits(h,k);Object.defineProperty(h.prototype,"signalingState",{get:function(){return this.pc.signalingState}});Object.defineProperty(h.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}});h.prototype._role=function(){return this.isInitiator?"initiator":"responder"};h.prototype.addStream=
function(b){this.localStream=b;this.pc.addStream(b)};h.prototype._checkLocalCandidate=function(b){b=c.toCandidateJSON(b);"srflx"==b.type?this.hadLocalStunCandidate=!0:"relay"==b.type&&(this.hadLocalRelayCandidate=!0);-1!=b.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)};h.prototype._checkRemoteCandidate=function(b){b=c.toCandidateJSON(b);"srflx"==b.type?this.hadRemoteStunCandidate=!0:"relay"==b.type&&(this.hadRemoteRelayCandidate=!0);-1!=b.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)};h.prototype.processIce=
function(b,e){e=e||function(){};var f=this;if("closed"===this.pc.signalingState)return e();if(b.contents||b.jingle&&b.jingle.contents){var h=this.remoteDescription.contents.map(function(b){return b.name});(b.contents||b.jingle.contents).forEach(function(b){var g=b.transport||{},k=g.candidates||[],n=h.indexOf(b.name),u=b.name,y=f.remoteDescription.contents.find(function(e){return e.name===b.name}),r=function(){k.forEach(function(b){b=c.toCandidateSDP(b);f.pc.addIceCandidate(new RTCIceCandidate({candidate:b,
sdpMLineIndex:n,sdpMid:u}),function(){},function(b){f.emit("error",b)});f._checkRemoteCandidate(b)});e()};f.iceCredentials.remote[b.name]&&g.ufrag&&f.iceCredentials.remote[b.name].ufrag!==g.ufrag?y?(y.transport.ufrag=g.ufrag,y.transport.pwd=g.pwd,g={type:"offer",jingle:f.remoteDescription},g.sdp=c.toSessionSDP(g.jingle,{sid:f.config.sdpSessionID,role:f._role(),direction:"incoming"}),f.pc.setRemoteDescription(new RTCSessionDescription(g),function(){r()},function(b){f.emit("error",b)})):f.emit("error",
"ice restart failed to find matching content"):r()})}else{b.candidate&&0!==b.candidate.candidate.indexOf("a=")&&(b.candidate.candidate="a="+b.candidate.candidate);if(this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(b.candidate),e();f.pc.addIceCandidate(new RTCIceCandidate(b.candidate),function(){},function(b){f.emit("error",b)});f._checkRemoteCandidate(b.candidate.candidate);e()}};h.prototype.offer=
function(b,e){var f=this,h=2===arguments.length,g=h&&b?b:{offerToReceiveAudio:1,offerToReceiveVideo:1};e=(e=h?e:b)||function(){};if("closed"===this.pc.signalingState)return e("Already closed");this.pc.createOffer(function(b){var h={type:"offer",sdp:b.sdp};f.assumeSetLocalSuccess&&(f.emit("offer",h),e(null,h));f._candidateBuffer=[];f.pc.setLocalDescription(b,function(){if(f.config.useJingle){var g=c.toSessionJSON(b.sdp,{role:f._role(),direction:"outgoing"});g.sid=f.config.sid;f.localDescription=g;
g.contents.forEach(function(b){var e=b.transport||{};e.ufrag&&(f.iceCredentials.local[b.name]={ufrag:e.ufrag,pwd:e.pwd})});h.jingle=g}h.sdp.split("\r\n").forEach(function(b){0===b.indexOf("a=candidate:")&&f._checkLocalCandidate(b)});f.assumeSetLocalSuccess||(f.emit("offer",h),e(null,h))},function(b){f.emit("error",b);e(b)})},function(b){f.emit("error",b);e(b)},g)};h.prototype.handleOffer=function(b,e){e=e||function(){};var f=this;b.type="offer";if(b.jingle){this.enableChromeNativeSimulcast&&b.jingle.contents.forEach(function(b){"video"===
b.name&&(b.application.googConferenceFlag=!0)});this.enableMultiStreamHacks&&b.jingle.contents.forEach(function(b){if("video"===b.name){var e=b.application.sources||[];if(0===e.length||"3735928559"!==e[0].ssrc)e.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),b.application.sources=e}});if(0<f.restrictBandwidth&&2<=b.jingle.contents.length&&"video"===b.jingle.contents[1].name){var h=b.jingle.contents[1];h.application&&h.application.bandwidth&&
h.application.bandwidth.bandwidth||(b.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:f.restrictBandwidth.toString()},b.sdp=c.toSessionSDP(b.jingle,{sid:f.config.sdpSessionID,role:f._role(),direction:"outgoing"}))}b.jingle.contents.forEach(function(b){var e=b.transport||{};e.ufrag&&(f.iceCredentials.remote[b.name]={ufrag:e.ufrag,pwd:e.pwd})});b.sdp=c.toSessionSDP(b.jingle,{sid:f.config.sdpSessionID,role:f._role(),direction:"incoming"});f.remoteDescription=b.jingle}b.sdp.split("\r\n").forEach(function(b){0===
b.indexOf("a=candidate:")&&f._checkRemoteCandidate(b)});f.pc.setRemoteDescription(new RTCSessionDescription(b),function(){e()},e)};h.prototype.answerAudioOnly=function(b){this._answer({mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},b)};h.prototype.answerBroadcastOnly=function(b){this._answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},b)};h.prototype.answer=function(b,e){var f=2===arguments.length;this._answer(f&&b?b:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},
f?e:b)};h.prototype.handleAnswer=function(b,e){e=e||function(){};var f=this;b.jingle&&(b.sdp=c.toSessionSDP(b.jingle,{sid:f.config.sdpSessionID,role:f._role(),direction:"incoming"}),f.remoteDescription=b.jingle,b.jingle.contents.forEach(function(b){var e=b.transport||{};e.ufrag&&(f.iceCredentials.remote[b.name]={ufrag:e.ufrag,pwd:e.pwd})}));b.sdp.split("\r\n").forEach(function(b){0===b.indexOf("a=candidate:")&&f._checkRemoteCandidate(b)});f.pc.setRemoteDescription(new RTCSessionDescription(b),function(){f.wtFirefox&&
window.setTimeout(function(){f.firefoxcandidatebuffer.forEach(function(b){f.pc.addIceCandidate(new RTCIceCandidate(b),function(){},function(b){f.emit("error",b)});f._checkRemoteCandidate(b.candidate)});f.firefoxcandidatebuffer=null},f.wtFirefox);e(null)},e)};h.prototype.close=function(){this.pc.close();this._localDataChannels=[];this._remoteDataChannels=[];this.emit("close")};h.prototype._answer=function(b,e){e=e||function(){};var f=this;if(!this.pc.remoteDescription)throw Error("remoteDescription not set");
if("closed"===this.pc.signalingState)return e("Already closed");f.pc.createAnswer(function(b){var h=[];if(f.enableChromeNativeSimulcast&&(b.jingle=c.toSessionJSON(b.sdp,{role:f._role(),direction:"outgoing"}),2<=b.jingle.contents.length&&"video"===b.jingle.contents[1].name)){var g=b.jingle.contents[1].application.sourceGroups||[],k=!1;g.forEach(function(b){"SIM"==b.semantics&&(k=!0)});if(!k&&b.jingle.contents[1].application.sources.length){var u=JSON.parse(JSON.stringify(b.jingle.contents[1].application.sources[0]));
u.ssrc=""+Math.floor(4294967295*Math.random());b.jingle.contents[1].application.sources.push(u);h.push(b.jingle.contents[1].application.sources[0].ssrc);h.push(u.ssrc);g.push({semantics:"SIM",sources:h});h=JSON.parse(JSON.stringify(u));h.ssrc=""+Math.floor(4294967295*Math.random());b.jingle.contents[1].application.sources.push(h);g.push({semantics:"FID",sources:[u.ssrc,h.ssrc]});b.jingle.contents[1].application.sourceGroups=g;b.sdp=c.toSessionSDP(b.jingle,{sid:f.config.sdpSessionID,role:f._role(),
direction:"outgoing"})}}var r={type:"answer",sdp:b.sdp};f.assumeSetLocalSuccess&&(g=n(r),f.emit("answer",g),e(null,g));f._candidateBuffer=[];f.pc.setLocalDescription(b,function(){if(f.config.useJingle){var h=c.toSessionJSON(b.sdp,{role:f._role(),direction:"outgoing"});h.sid=f.config.sid;f.localDescription=h;r.jingle=h}f.enableChromeNativeSimulcast&&(r.jingle||(r.jingle=c.toSessionJSON(b.sdp,{role:f._role(),direction:"outgoing"})),r.jingle.contents[1].application.sources.forEach(function(b,e){b.parameters=
b.parameters.map(function(b){"msid"===b.key&&(b.value+="-"+Math.floor(e/2));return b})}),r.sdp=c.toSessionSDP(r.jingle,{sid:f.sdpSessionID,role:f._role(),direction:"outgoing"}));r.sdp.split("\r\n").forEach(function(b){0===b.indexOf("a=candidate:")&&f._checkLocalCandidate(b)});f.assumeSetLocalSuccess||(h=n(r),f.emit("answer",h),e(null,h))},function(b){f.emit("error",b);e(b)})},function(b){f.emit("error",b);e(b)},b)};h.prototype._onIce=function(b){var e=this;if(b.candidate){if(!this.dontSignalCandidates){b=
b.candidate;var f={candidate:{candidate:b.candidate,sdpMid:b.sdpMid,sdpMLineIndex:b.sdpMLineIndex}};this._checkLocalCandidate(b.candidate);var h=c.toCandidateJSON(b.candidate);if(this.eliminateDuplicateCandidates&&"relay"===h.type){var g=this._candidateBuffer.filter(function(b){return"relay"===b.type}).map(function(b){return b.foundation+":"+b.component});var k=g.indexOf(h.foundation+":"+h.component);if(-1<k&&h.priority>>24>=g[k].priority>>24)return}if("max-bundle"===this.config.bundlePolicy&&(g=
this._candidateBuffer.filter(function(b){return h.type===b.type}).map(function(b){return b.address+":"+b.port}),k=g.indexOf(h.address+":"+h.port),-1<k))return;if("require"!==this.config.rtcpMuxPolicy||"2"!==h.component){this._candidateBuffer.push(h);if(e.config.useJingle&&(b.sdpMid||(b.sdpMid=e.pc.remoteDescription&&"offer"===e.pc.remoteDescription.type?e.remoteDescription.contents[b.sdpMLineIndex].name:e.localDescription.contents[b.sdpMLineIndex].name),e.iceCredentials.local[b.sdpMid]||c.toSessionJSON(e.pc.localDescription.sdp,
{role:e._role(),direction:"outgoing"}).contents.forEach(function(b){var f=b.transport||{};f.ufrag&&(e.iceCredentials.local[b.name]={ufrag:f.ufrag,pwd:f.pwd})}),f.jingle={contents:[{name:b.sdpMid,creator:e._role(),transport:{transportType:"iceUdp",ufrag:e.iceCredentials.local[b.sdpMid].ufrag,pwd:e.iceCredentials.local[b.sdpMid].pwd,candidates:[h]}}]},0<e.batchIceCandidates)){0===e.batchedIceCandidates.length&&window.setTimeout(function(){var b={};e.batchedIceCandidates.forEach(function(e){e=e.contents[0];
b[e.name]||(b[e.name]=e);b[e.name].transport.candidates.push(e.transport.candidates[0])});var f={jingle:{contents:[]}};Object.keys(b).forEach(function(e){f.jingle.contents.push(b[e])});e.batchedIceCandidates=[];e.emit("ice",f)},e.batchIceCandidates);e.batchedIceCandidates.push(f.jingle);return}this.emit("ice",f)}}}else this.emit("endOfCandidates")};h.prototype._onDataChannel=function(b){b=b.channel;this._remoteDataChannels.push(b);this.emit("addChannel",b)};h.prototype.createDataChannel=function(b,
e){b=this.pc.createDataChannel(b,e);this._localDataChannels.push(b);return b};h.prototype.getStats=function(){if("function"===typeof arguments[0]){var b=arguments[0];this.pc.getStats().then(function(e){b(null,e)},function(e){b(e)})}else return this.pc.getStats.apply(this.pc,arguments)};f.exports=h},{"lodash.clonedeep":36,"sdp-jingle-json":45,util:63,wildemitter:65}],45:[function(b,f,e){var h=b("./lib/tosdp"),c=b("./lib/tojson");e.toIncomingSDPOffer=function(b){return h.toSessionSDP(b,{role:"responder",
direction:"incoming"})};e.toOutgoingSDPOffer=function(b){return h.toSessionSDP(b,{role:"initiator",direction:"outgoing"})};e.toIncomingSDPAnswer=function(b){return h.toSessionSDP(b,{role:"initiator",direction:"incoming"})};e.toOutgoingSDPAnswer=function(b){return h.toSessionSDP(b,{role:"responder",direction:"outgoing"})};e.toIncomingMediaSDPOffer=function(b){return h.toMediaSDP(b,{role:"responder",direction:"incoming"})};e.toOutgoingMediaSDPOffer=function(b){return h.toMediaSDP(b,{role:"initiator",
direction:"outgoing"})};e.toIncomingMediaSDPAnswer=function(b){return h.toMediaSDP(b,{role:"initiator",direction:"incoming"})};e.toOutgoingMediaSDPAnswer=function(b){return h.toMediaSDP(b,{role:"responder",direction:"outgoing"})};e.toCandidateSDP=h.toCandidateSDP;e.toMediaSDP=h.toMediaSDP;e.toSessionSDP=h.toSessionSDP;e.toIncomingJSONOffer=function(b,e){return c.toSessionJSON(b,{role:"responder",direction:"incoming",creators:e})};e.toOutgoingJSONOffer=function(b,e){return c.toSessionJSON(b,{role:"initiator",
direction:"outgoing",creators:e})};e.toIncomingJSONAnswer=function(b,e){return c.toSessionJSON(b,{role:"initiator",direction:"incoming",creators:e})};e.toOutgoingJSONAnswer=function(b,e){return c.toSessionJSON(b,{role:"responder",direction:"outgoing",creators:e})};e.toIncomingMediaJSONOffer=function(b,e){return c.toMediaJSON(b,{role:"responder",direction:"incoming",creator:e})};e.toOutgoingMediaJSONOffer=function(b,e){return c.toMediaJSON(b,{role:"initiator",direction:"outgoing",creator:e})};e.toIncomingMediaJSONAnswer=
function(b,e){return c.toMediaJSON(b,{role:"initiator",direction:"incoming",creator:e})};e.toOutgoingMediaJSONAnswer=function(b,e){return c.toMediaJSON(b,{role:"responder",direction:"outgoing",creator:e})};e.toCandidateJSON=c.toCandidateJSON;e.toMediaJSON=c.toMediaJSON;e.toSessionJSON=c.toSessionJSON},{"./lib/tojson":48,"./lib/tosdp":49}],46:[function(b,f,e){e.lines=function(b){return b.split("\r\n").filter(function(b){return 0<b.length})};e.findLine=function(b,e,f){for(var h=b.length,c=0;c<e.length;c++)if(e[c].substr(0,
h)===b)return e[c];if(!f)return!1;for(e=0;e<f.length;e++)if(f[e].substr(0,h)===b)return f[e];return!1};e.findLines=function(b,e,f){for(var h=[],c=b.length,g=0;g<e.length;g++)e[g].substr(0,c)===b&&h.push(e[g]);if(h.length||!f)return h;for(e=0;e<f.length;e++)f[e].substr(0,c)===b&&h.push(f[e]);return h};e.mline=function(b){b=b.substr(2).split(" ");for(var e={media:b[0],port:b[1],proto:b[2],formats:[]},f=3;f<b.length;f++)b[f]&&e.formats.push(b[f]);return e};e.rtpmap=function(b){b=b.substr(9).split(" ");
var e={id:b.shift()};b=b[0].split("/");e.name=b[0];e.clockrate=b[1];e.channels=3==b.length?b[2]:"1";return e};e.sctpmap=function(b){b=b.substr(10).split(" ");return{number:b.shift(),protocol:b.shift(),streams:b.shift()}};e.fmtp=function(b){for(var e,f=b.substr(b.indexOf(" ")+1).split(";"),c=[],h=0;h<f.length;h++)e=f[h].split("="),b=e[0].trim(),e=e[1],b&&e?c.push({key:b,value:e}):b&&c.push({key:"",value:b});return c};e.crypto=function(b){b=b.substr(9).split(" ");return{tag:b[0],cipherSuite:b[1],keyParams:b[2],
sessionParams:b.slice(3).join(" ")}};e.fingerprint=function(b){b=b.substr(14).split(" ");return{hash:b[0],value:b[1]}};e.extmap=function(b){b=b.substr(9).split(" ");var e={},f=b.shift(),c=f.indexOf("/");0<=c?(e.id=f.substr(0,c),e.senders=f.substr(c+1)):(e.id=f,e.senders="sendrecv");e.uri=b.shift()||"";return e};e.rtcpfb=function(b){b=b.substr(10).split(" ");var e={};e.id=b.shift();e.type=b.shift();"trr-int"===e.type?e.value=b.shift():e.subtype=b.shift()||"";e.parameters=b;return e};e.candidate=function(b){b=
0===b.indexOf("a=candidate:")?b.substring(12).split(" "):b.substring(10).split(" ");for(var e={foundation:b[0],component:b[1],protocol:b[2].toLowerCase(),priority:b[3],ip:b[4],port:b[5],type:b[7],generation:"0"},f=8;f<b.length;f+=2)"raddr"===b[f]?e.relAddr=b[f+1]:"rport"===b[f]?e.relPort=b[f+1]:"generation"===b[f]?e.generation=b[f+1]:"tcptype"===b[f]&&(e.tcpType=b[f+1]);e.network="1";return e};e.sourceGroups=function(b){for(var e=[],f=0;f<b.length;f++){var c=b[f].substr(13).split(" ");e.push({semantics:c.shift(),
sources:c})}return e};e.sources=function(b){for(var e=[],f={},c=0;c<b.length;c++){var h=b[c].substr(7).split(" "),D=h.shift();if(!f[D]){var y={ssrc:D,parameters:[]};e.push(y);f[D]=y}h=h.join(" ").split(":");y=h.shift();h=h.join(":")||null;f[D].parameters.push({key:y,value:h})}return e};e.groups=function(b){for(var e=[],f,c=0;c<b.length;c++)f=b[c].substr(8).split(" "),e.push({semantics:f.shift(),contents:f});return e};e.bandwidth=function(b){b=b.substr(2).split(":");var e={};e.type=b.shift();e.bandwidth=
b.shift();return e};e.msid=function(b){b=b.substr(7);var e=b.split(" ");return{msid:b,mslabel:e[0],label:e[1]}}},{}],47:[function(b,f,e){f.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",
responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],48:[function(b,f,e){var c=b("./senders"),g=b("./parsers"),k=Math.random();e._setIdCounter=function(b){k=b};e.toSessionJSON=function(b,f){var c,h=f.creators||[],k=f.role||"initiator";f=f.direction||"outgoing";
var n=b.split("\r\nm=");for(c=1;c<n.length;c++)n[c]="m="+n[c],c!==n.length-1&&(n[c]+="\r\n");var u=n.shift()+"\r\n",l=g.lines(u);b={};var m=[];for(c=0;c<n.length;c++)m.push(e.toMediaJSON(n[c],u,{role:k,direction:f,creator:h[c]||"initiator"}));b.contents=m;h=g.findLines("a=group:",l);h.length&&(b.groups=g.groups(h));return b};e.toMediaJSON=function(b,f,h){var k=h.creator||"initiator",n=h.role||"initiator",u=h.direction||"outgoing",D=g.lines(b);b=g.lines(f);f=g.mline(D[0]);k={creator:k,name:f.media,
application:{applicationType:"rtp",media:f.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==f.media&&(k.application={applicationType:"datachannel"},k.transport.sctp=[]);var l=k.application,m=k.transport;if(f=g.findLine("a=mid:",D))k.name=f.substr(6);g.findLine("a=sendrecv",D,b)?k.senders="both":g.findLine("a=sendonly",D,b)?k.senders=c[n][u].sendonly:g.findLine("a=recvonly",D,b)?k.senders=c[n][u].recvonly:
g.findLine("a=inactive",D,b)&&(k.senders="none");if("rtp"==l.applicationType){if(f=g.findLine("b=",D))l.bandwidth=g.bandwidth(f);if(f=g.findLine("a=ssrc:",D))l.ssrc=f.substr(7).split(" ")[0];g.findLines("a=rtpmap:",D).forEach(function(b){var e=g.rtpmap(b);e.parameters=[];e.feedback=[];g.findLines("a=fmtp:"+e.id,D).forEach(function(b){e.parameters=g.fmtp(b)});g.findLines("a=rtcp-fb:"+e.id,D).forEach(function(b){e.feedback.push(g.rtcpfb(b))});l.payloads.push(e)});g.findLines("a=crypto:",D,b).forEach(function(b){l.encryption.push(g.crypto(b))});
g.findLine("a=rtcp-mux",D)&&(l.mux=!0);g.findLines("a=rtcp-fb:*",D).forEach(function(b){l.feedback.push(g.rtcpfb(b))});g.findLines("a=extmap:",D).forEach(function(b){b=g.extmap(b);b.senders=c[n][u][b.senders];l.headerExtensions.push(b)});f=g.findLines("a=ssrc-group:",D);l.sourceGroups=g.sourceGroups(f||[]);f=g.findLines("a=ssrc:",D);var p=l.sources=g.sources(f||[]);if(f=g.findLine("a=msid:",D)){var q=g.msid(f);["msid","mslabel","label"].forEach(function(b){for(var e=0;e<p.length;e++){for(var f=!1,
c=0;c<p[e].parameters.length;c++)p[e].parameters[c].key===b&&(f=!0);f||p[e].parameters.push({key:b,value:q[b]})}})}g.findLine("a=x-google-flag:conference",D,b)&&(l.googConferenceFlag=!0)}f=g.findLines("a=fingerprint:",D,b);var t=g.findLine("a=setup:",D,b);f.forEach(function(b){b=g.fingerprint(b);t&&(b.setup=t.substr(8));m.fingerprints.push(b)});f=g.findLine("a=ice-ufrag:",D,b);h=g.findLine("a=ice-pwd:",D,b);f&&h&&(m.ufrag=f.substr(12),m.pwd=h.substr(10),m.candidates=[],g.findLines("a=candidate:",
D,b).forEach(function(b){m.candidates.push(e.toCandidateJSON(b))}));"datachannel"==l.applicationType&&g.findLines("a=sctpmap:",D).forEach(function(b){b=g.sctpmap(b);m.sctp.push(b)});return k};e.toCandidateJSON=function(b){b=g.candidate(b.split("\r\n")[0]);b.id=(k++).toString(36).substr(0,12);return b}},{"./parsers":46,"./senders":47}],49:[function(b,f,e){var c=b("./senders");e.toSessionSDP=function(b,f){var c=f.sid||b.sid||Date.now(),h=f.time||Date.now(),g=["v=0","o=- "+c+" "+h+" IN IP4 0.0.0.0",
"s=-","t=0 0"];c=b.contents||[];var k=!1;c.forEach(function(b){b.application.sources&&b.application.sources.length&&(k=!0)});k&&g.push("a=msid-semantic: WMS *");(b.groups||[]).forEach(function(b){g.push("a=group:"+b.semantics+" "+b.contents.join(" "))});c.forEach(function(b){g.push(e.toMediaSDP(b,f))});return g.join("\r\n")+"\r\n"};e.toMediaSDP=function(b,f){var h=[],g=f.role||"initiator",k=f.direction||"outgoing",y=b.application;f=b.transport;var r=y.payloads||[],l=f&&f.fingerprints||[],R=[];"datachannel"==
y.applicationType?(R.push("application"),R.push("1"),R.push("DTLS/SCTP"),f.sctp&&f.sctp.forEach(function(b){R.push(b.number)})):(R.push(y.media),R.push("1"),0<l.length?R.push("UDP/TLS/RTP/SAVPF"):y.encryption&&0<y.encryption.length?R.push("RTP/SAVPF"):R.push("RTP/AVPF"),r.forEach(function(b){R.push(b.id)}));h.push("m="+R.join(" "));h.push("c=IN IP4 0.0.0.0");y.bandwidth&&y.bandwidth.type&&y.bandwidth.bandwidth&&h.push("b="+y.bandwidth.type+":"+y.bandwidth.bandwidth);"rtp"==y.applicationType&&h.push("a=rtcp:1 IN IP4 0.0.0.0");
f&&(f.ufrag&&h.push("a=ice-ufrag:"+f.ufrag),f.pwd&&h.push("a=ice-pwd:"+f.pwd),l.forEach(function(b){h.push("a=fingerprint:"+b.hash+" "+b.value);b.setup&&h.push("a=setup:"+b.setup)}),f.sctp&&f.sctp.forEach(function(b){h.push("a=sctpmap:"+b.number+" "+b.protocol+" "+b.streams)}));"rtp"==y.applicationType&&h.push("a="+(c[g][k][b.senders]||"sendrecv"));h.push("a=mid:"+b.name);y.sources&&y.sources.length&&(y.sources[0].parameters||[]).forEach(function(b){"msid"===b.key&&h.push("a=msid:"+b.value)});y.mux&&
h.push("a=rtcp-mux");(y.encryption||[]).forEach(function(b){h.push("a=crypto:"+b.tag+" "+b.cipherSuite+" "+b.keyParams+(b.sessionParams?" "+b.sessionParams:""))});y.googConferenceFlag&&h.push("a=x-google-flag:conference");r.forEach(function(b){var e="a=rtpmap:"+b.id+" "+b.name+"/"+b.clockrate;b.channels&&"1"!=b.channels&&(e+="/"+b.channels);h.push(e);if(b.parameters&&b.parameters.length){e=["a=fmtp:"+b.id];var f=[];b.parameters.forEach(function(b){f.push((b.key?b.key+"=":"")+b.value)});e.push(f.join(";"));
h.push(e.join(" "))}b.feedback&&b.feedback.forEach(function(e){"trr-int"===e.type?h.push("a=rtcp-fb:"+b.id+" trr-int "+(e.value?e.value:"0")):h.push("a=rtcp-fb:"+b.id+" "+e.type+(e.subtype?" "+e.subtype:""))})});y.feedback&&y.feedback.forEach(function(b){"trr-int"===b.type?h.push("a=rtcp-fb:* trr-int "+(b.value?b.value:"0")):h.push("a=rtcp-fb:* "+b.type+(b.subtype?" "+b.subtype:""))});(y.headerExtensions||[]).forEach(function(b){h.push("a=extmap:"+b.id+(b.senders?"/"+c[g][k][b.senders]:"")+" "+b.uri)});
(y.sourceGroups||[]).forEach(function(b){h.push("a=ssrc-group:"+b.semantics+" "+b.sources.join(" "))});(y.sources||[]).forEach(function(b){for(var e=0;e<b.parameters.length;e++){var f=b.parameters[e];h.push("a=ssrc:"+(b.ssrc||y.ssrc)+" "+f.key+(f.value?":"+f.value:""))}});(f.candidates||[]).forEach(function(b){h.push(e.toCandidateSDP(b))});return h.join("\r\n")};e.toCandidateSDP=function(b){var e=[];e.push(b.foundation);e.push(b.component);e.push(b.protocol.toUpperCase());e.push(b.priority);e.push(b.ip);
e.push(b.port);var f=b.type;e.push("typ");e.push(f);("srflx"===f||"prflx"===f||"relay"===f)&&b.relAddr&&b.relPort&&(e.push("raddr"),e.push(b.relAddr),e.push("rport"),e.push(b.relPort));b.tcpType&&"TCP"==b.protocol.toUpperCase()&&(e.push("tcptype"),e.push(b.tcpType));e.push("generation");e.push(b.generation||"0");return"a=candidate:"+e.join(" ")}},{"./senders":47}],50:[function(b,f,e){f.exports=b("./lib/")},{"./lib/":51}],51:[function(b,f,e){function c(b,e){"object"==typeof b&&(e=b,b=void 0);e=e||
{};b=g(b);var f=b.source,c=b.id;e.forceNew||e["force new connection"]||!1===e.multiplex?(u("ignoring socket cache for %s",f),e=n(f,e)):(D[c]||(u("new io instance for %s",f),D[c]=n(f,e)),e=D[c]);return e.socket(b.path)}var g=b("./url"),k=b("socket.io-parser"),n=b("./manager"),u=b("debug")("socket.io-client");f.exports=e=c;var D=e.managers={};e.protocol=k.protocol;e.connect=c;e.Manager=b("./manager");e.Socket=b("./socket")},{"./manager":52,"./socket":54,"./url":55,debug:10,"socket.io-parser":57}],52:[function(b,
f,e){function c(b,e){if(!(this instanceof c))return new c(b,e);b&&"object"==typeof b&&(e=b,b=void 0);e=e||{};e.path=e.path||"/socket.io";this.nsps={};this.subs=[];this.opts=e;this.reconnection(!1!==e.reconnection);this.reconnectionAttempts(e.reconnectionAttempts||Infinity);this.reconnectionDelay(e.reconnectionDelay||1E3);this.reconnectionDelayMax(e.reconnectionDelayMax||5E3);this.randomizationFactor(e.randomizationFactor||.5);this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),
jitter:this.randomizationFactor()});this.timeout(null==e.timeout?2E4:e.timeout);this.readyState="closed";this.uri=b;this.connected=[];this.encoding=!1;this.packetBuffer=[];this.encoder=new n.Encoder;this.decoder=new n.Decoder;(this.autoConnect=!1!==e.autoConnect)&&this.open()}b("./url");var g=b("engine.io-client"),k=b("./socket");e=b("component-emitter");var n=b("socket.io-parser"),u=b("./on"),D=b("component-bind");b("object-component");var y=b("debug")("socket.io-client:manager"),r=b("indexof"),
l=b("backo2");f.exports=c;c.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var b in this.nsps)this.nsps[b].emit.apply(this.nsps[b],arguments)};c.prototype.updateSocketIds=function(){for(var b in this.nsps)this.nsps[b].id=this.engine.id};e(c.prototype);c.prototype.reconnection=function(b){if(!arguments.length)return this._reconnection;this._reconnection=!!b;return this};c.prototype.reconnectionAttempts=function(b){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=
b;return this};c.prototype.reconnectionDelay=function(b){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=b;this.backoff&&this.backoff.setMin(b);return this};c.prototype.randomizationFactor=function(b){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=b;this.backoff&&this.backoff.setJitter(b);return this};c.prototype.reconnectionDelayMax=function(b){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=b;this.backoff&&
this.backoff.setMax(b);return this};c.prototype.timeout=function(b){if(!arguments.length)return this._timeout;this._timeout=b;return this};c.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};c.prototype.open=c.prototype.connect=function(b){y("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;y("opening %s",this.uri);var e=this.engine=g(this.uri,this.opts),f=this;this.readyState="opening";this.skipReconnect=
!1;var c=u(e,"open",function(){f.onopen();b&&b()}),h=u(e,"error",function(e){y("connect_error");f.cleanup();f.readyState="closed";f.emitAll("connect_error",e);if(b){var c=Error("Connection error");c.data=e;b(c)}else f.maybeReconnectOnOpen()});if(!1!==this._timeout){var k=this._timeout;y("connect attempt will timeout after %d",k);var n=setTimeout(function(){y("connect attempt timed out after %d",k);c.destroy();e.close();e.emit("error","timeout");f.emitAll("connect_timeout",k)},k);this.subs.push({destroy:function(){clearTimeout(n)}})}this.subs.push(c);
this.subs.push(h);return this};c.prototype.onopen=function(){y("open");this.cleanup();this.readyState="open";this.emit("open");var b=this.engine;this.subs.push(u(b,"data",D(this,"ondata")));this.subs.push(u(this.decoder,"decoded",D(this,"ondecoded")));this.subs.push(u(b,"error",D(this,"onerror")));this.subs.push(u(b,"close",D(this,"onclose")))};c.prototype.ondata=function(b){this.decoder.add(b)};c.prototype.ondecoded=function(b){this.emit("packet",b)};c.prototype.onerror=function(b){y("error",b);
this.emitAll("error",b)};c.prototype.socket=function(b){var e=this.nsps[b];if(!e){e=new k(this,b);this.nsps[b]=e;var f=this;e.on("connect",function(){e.id=f.engine.id;~r(f.connected,e)||f.connected.push(e)})}return e};c.prototype.destroy=function(b){b=r(this.connected,b);~b&&this.connected.splice(b,1);this.connected.length||this.close()};c.prototype.packet=function(b){y("writing packet %j",b);var e=this;e.encoding?e.packetBuffer.push(b):(e.encoding=!0,this.encoder.encode(b,function(b){for(var f=0;f<
b.length;f++)e.engine.write(b[f]);e.encoding=!1;e.processPacketQueue()}))};c.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var b=this.packetBuffer.shift();this.packet(b)}};c.prototype.cleanup=function(){for(var b;b=this.subs.shift();)b.destroy();this.packetBuffer=[];this.encoding=!1;this.decoder.destroy()};c.prototype.close=c.prototype.disconnect=function(){this.skipReconnect=!0;this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};
c.prototype.onclose=function(b){y("close");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",b);this._reconnection&&!this.skipReconnect&&this.reconnect()};c.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var b=this;if(this.backoff.attempts>=this._reconnectionAttempts)y("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();y("will wait %dms before reconnect attempt",
e);this.reconnecting=!0;var f=setTimeout(function(){b.skipReconnect||(y("attempting reconnect"),b.emitAll("reconnect_attempt",b.backoff.attempts),b.emitAll("reconnecting",b.backoff.attempts),b.skipReconnect||b.open(function(e){e?(y("reconnect attempt error"),b.reconnecting=!1,b.reconnect(),b.emitAll("reconnect_error",e.data)):(y("reconnect success"),b.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(f)}})}};c.prototype.onreconnect=function(){var b=this.backoff.attempts;this.reconnecting=
!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",b)}},{"./on":53,"./socket":54,"./url":55,backo2:4,"component-bind":7,"component-emitter":8,debug:10,"engine.io-client":11,indexof:32,"object-component":39,"socket.io-parser":57}],53:[function(b,f,e){f.exports=function(b,e,f){b.on(e,f);return{destroy:function(){b.removeListener(e,f)}}}},{}],54:[function(b,f,e){function c(b,e){this.io=b;this.nsp=e;this.json=this;this.ids=0;this.acks={};this.io.autoConnect&&this.open();this.receiveBuffer=
[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0}var g=b("socket.io-parser");e=b("component-emitter");var k=b("to-array"),n=b("./on"),u=b("component-bind"),D=b("debug")("socket.io-client:socket"),y=b("has-binary");f.exports=c;var r={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},l=e.prototype.emit;e(c.prototype);c.prototype.subEvents=function(){if(!this.subs){var b=this.io;this.subs=
[n(b,"open",u(this,"onopen")),n(b,"packet",u(this,"onpacket")),n(b,"close",u(this,"onclose"))]}};c.prototype.open=c.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==this.io.readyState)this.onopen();return this};c.prototype.send=function(){var b=k(arguments);b.unshift("message");this.emit.apply(this,b);return this};c.prototype.emit=function(b){if(r.hasOwnProperty(b))return l.apply(this,arguments),this;var e=k(arguments),f=g.EVENT;y(e)&&(f=g.BINARY_EVENT);
f={type:f,data:e};"function"==typeof e[e.length-1]&&(D("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),f.id=this.ids++);this.connected?this.packet(f):this.sendBuffer.push(f);return this};c.prototype.packet=function(b){b.nsp=this.nsp;this.io.packet(b)};c.prototype.onopen=function(){D("transport is open - connecting");"/"!=this.nsp&&this.packet({type:g.CONNECT})};c.prototype.onclose=function(b){D("close (%s)",b);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",
b)};c.prototype.onpacket=function(b){if(b.nsp==this.nsp)switch(b.type){case g.CONNECT:this.onconnect();break;case g.EVENT:this.onevent(b);break;case g.BINARY_EVENT:this.onevent(b);break;case g.ACK:this.onack(b);break;case g.BINARY_ACK:this.onack(b);break;case g.DISCONNECT:this.ondisconnect();break;case g.ERROR:this.emit("error",b.data)}};c.prototype.onevent=function(b){var e=b.data||[];D("emitting event %j",e);null!=b.id&&(D("attaching ack callback to event"),e.push(this.ack(b.id)));this.connected?
l.apply(this,e):this.receiveBuffer.push(e)};c.prototype.ack=function(b){var e=this,f=!1;return function(){if(!f){f=!0;var c=k(arguments);D("sending ack %j",c);var h=y(c)?g.BINARY_ACK:g.ACK;e.packet({type:h,id:b,data:c})}}};c.prototype.onack=function(b){D("calling ack %s with %j",b.id,b.data);this.acks[b.id].apply(this,b.data);delete this.acks[b.id]};c.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};c.prototype.emitBuffered=function(){var b;
for(b=0;b<this.receiveBuffer.length;b++)l.apply(this,this.receiveBuffer[b]);this.receiveBuffer=[];for(b=0;b<this.sendBuffer.length;b++)this.packet(this.sendBuffer[b]);this.sendBuffer=[]};c.prototype.ondisconnect=function(){D("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};c.prototype.destroy=function(){if(this.subs){for(var b=0;b<this.subs.length;b++)this.subs[b].destroy();this.subs=null}this.io.destroy(this)};c.prototype.close=c.prototype.disconnect=function(){this.connected&&
(D("performing disconnect (%s)",this.nsp),this.packet({type:g.DISCONNECT}));this.destroy();if(this.connected)this.onclose("io client disconnect");return this}},{"./on":53,"component-bind":7,"component-emitter":8,debug:10,"has-binary":30,"socket.io-parser":57,"to-array":59}],55:[function(b,f,e){(function(e){var c=b("parseuri"),h=b("debug")("socket.io-client:url");f.exports=function(b,f){var g=b;f=f||e.location;null==b&&(b=f.protocol+"//"+f.host);"string"==typeof b&&("/"==b.charAt(0)&&(b="/"==b.charAt(1)?
f.protocol+b:f.hostname+b),/^(https?|wss?):\/\//.test(b)||(h("protocol-less url %s",b),b="undefined"!=typeof f?f.protocol+"//"+b:"https://"+b),h("parse %s",b),g=c(b));g.port||(/^(http|ws)$/.test(g.protocol)?g.port="80":/^(http|ws)s$/.test(g.protocol)&&(g.port="443"));g.path=g.path||"/";g.id=g.protocol+"://"+g.host+":"+g.port;g.href=g.protocol+"://"+g.host+(f&&f.port==g.port?"":":"+g.port);return g}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?
window:{})},{debug:10,parseuri:42}],56:[function(b,f,e){(function(f){var c=b("isarray"),h=b("./is-buffer");e.deconstructPacket=function(b){function e(b){if(!b)return b;if(h(b)){var g={_placeholder:!0,num:f.length};f.push(b);return g}if(c(b)){g=Array(b.length);for(var k=0;k<b.length;k++)g[k]=e(b[k]);return g}if("object"==typeof b&&!(b instanceof Date)){g={};for(k in b)g[k]=e(b[k]);return g}return b}var f=[];b.data=e(b.data);b.attachments=f.length;return{packet:b,buffers:f}};e.reconstructPacket=function(b,
e){function f(b){if(b&&b._placeholder)return e[b.num];if(c(b))for(var h=0;h<b.length;h++)b[h]=f(b[h]);else if(b&&"object"==typeof b)for(h in b)b[h]=f(b[h]);return b}b.data=f(b.data);b.attachments=void 0;return b};e.removeBlobs=function(b,e){function g(b,u,r){if(!b)return b;if(f.Blob&&b instanceof Blob||f.File&&b instanceof File){k++;var y=new FileReader;y.onload=function(){r?r[u]=this.result:n=this.result;--k||e(n)};y.readAsArrayBuffer(b)}else if(c(b))for(y=0;y<b.length;y++)g(b[y],y,b);else if(b&&
"object"==typeof b&&!h(b))for(y in b)g(b[y],y,b)}var k=0,n=b;g(n);k||e(n)}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./is-buffer":58,isarray:33}],57:[function(b,f,e){function c(){}function g(b){var f=!1;var c=""+b.type;if(e.BINARY_EVENT==b.type||e.BINARY_ACK==b.type)c+=b.attachments,c+="-";b.nsp&&"/"!=b.nsp&&(f=!0,c+=b.nsp);null!=b.id&&(f&&(c+=",",f=!1),c+=b.id);null!=b.data&&(f&&(c+=","),c+=y.stringify(b.data));D("encoded %j as %s",
b,c);return c}function k(b,e){r.removeBlobs(b,function(b){var f=r.deconstructPacket(b);b=g(f.packet);f=f.buffers;f.unshift(b);e(f)})}function n(){this.reconstructor=null}function u(b){this.reconPack=b;this.buffers=[]}var D=b("debug")("socket.io-parser"),y=b("json3");b("isarray");f=b("component-emitter");var r=b("./binary"),l=b("./is-buffer");e.protocol=4;e.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" ");e.CONNECT=0;e.DISCONNECT=1;e.EVENT=2;e.ACK=3;e.ERROR=4;e.BINARY_EVENT=
5;e.BINARY_ACK=6;e.Encoder=c;e.Decoder=n;c.prototype.encode=function(b,f){D("encoding packet %j",b);e.BINARY_EVENT==b.type||e.BINARY_ACK==b.type?k(b,f):(b=g(b),f([b]))};f(n.prototype);n.prototype.add=function(b){if("string"==typeof b){a:{var f={},c=0;f.type=Number(b.charAt(0));if(null==e.types[f.type])b={type:e.ERROR,data:"parser error"};else{if(e.BINARY_EVENT==f.type||e.BINARY_ACK==f.type){for(var h="";"-"!=b.charAt(++c)&&(h+=b.charAt(c),c!=b.length););if(h!=Number(h)||"-"!=b.charAt(c))throw Error("Illegal attachments");
f.attachments=Number(h)}if("/"==b.charAt(c+1))for(f.nsp="";++c;){h=b.charAt(c);if(","==h)break;f.nsp+=h;if(c==b.length)break}else f.nsp="/";h=b.charAt(c+1);if(""!==h&&Number(h)==h){for(f.id="";++c;){h=b.charAt(c);if(null==h||Number(h)!=h){--c;break}f.id+=b.charAt(c);if(c==b.length)break}f.id=Number(f.id)}if(b.charAt(++c))try{f.data=y.parse(b.substr(c))}catch(Jh){b={type:e.ERROR,data:"parser error"};break a}D("decoded %s as %j",b,f);b=f}}e.BINARY_EVENT==b.type||e.BINARY_ACK==b.type?(this.reconstructor=
new u(b),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",b)):this.emit("decoded",b)}else if(l(b)||b.base64)if(this.reconstructor){if(b=this.reconstructor.takeBinaryData(b))this.reconstructor=null,this.emit("decoded",b)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+b);};n.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};u.prototype.takeBinaryData=function(b){this.buffers.push(b);
return this.buffers.length==this.reconPack.attachments?(b=r.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),b):null};u.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},{"./binary":56,"./is-buffer":58,"component-emitter":8,debug:10,isarray:33,json3:34}],58:[function(b,f,e){(function(b){f.exports=function(e){return b.Buffer&&b.Buffer.isBuffer(e)||b.ArrayBuffer&&e instanceof ArrayBuffer}}).call(this,"undefined"!==typeof global?global:"undefined"!==
typeof self?self:"undefined"!==typeof window?window:{})},{}],59:[function(b,f,e){f.exports=function(b,e){for(var f=[],c=(e=e||0)||0;c<b.length;c++)f[c-e]=b[c];return f}},{}],60:[function(b,f,e){(function(b){(function(c){function h(b){for(var e=[],f=0,c=b.length,h,g;f<c;)h=b.charCodeAt(f++),55296<=h&&56319>=h&&f<c?(g=b.charCodeAt(f++),56320==(g&64512)?e.push(((h&1023)<<10)+(g&1023)+65536):(e.push(h),f--)):e.push(h);return e}function g(b){if(55296<=b&&57343>=b)throw Error("Lone surrogate U+"+b.toString(16).toUpperCase()+
" is not a scalar value");}function u(){if(t>=q)throw Error("Invalid byte index");var b=p[t]&255;t++;if(128==(b&192))return b&63;throw Error("Invalid continuation byte");}function D(){if(t>q)throw Error("Invalid byte index");if(t==q)return!1;var b=p[t]&255;t++;if(0==(b&128))return b;if(192==(b&224)){var e=u();b=(b&31)<<6|e;if(128<=b)return b;throw Error("Invalid continuation byte");}if(224==(b&240)){e=u();var f=u();b=(b&15)<<12|e<<6|f;if(2048<=b)return g(b),b;throw Error("Invalid continuation byte");
}if(240==(b&248)){e=u();f=u();var c=u();b=(b&15)<<18|e<<12|f<<6|c;if(65536<=b&&1114111>=b)return b}throw Error("Invalid UTF-8 detected");}var y="object"==typeof e&&e,r="object"==typeof f&&f&&f.exports==y&&f,l="object"==typeof b&&b;if(l.global===l||l.window===l)c=l;var m=String.fromCharCode,p,q,t;l={version:"2.0.0",encode:function(b){b=h(b);for(var e=b.length,f=-1,c,k="";++f<e;){c=b[f];if(0==(c&4294967168))c=m(c);else{var n="";0==(c&4294965248)?n=m(c>>6&31|192):0==(c&4294901760)?(g(c),n=m(c>>12&15|
224),n+=m(c>>6&63|128)):0==(c&4292870144)&&(n=m(c>>18&7|240),n+=m(c>>12&63|128),n+=m(c>>6&63|128));c=n+=m(c&63|128)}k+=c}return k},decode:function(b){p=h(b);q=p.length;t=0;b=[];for(var e;!1!==(e=D());)b.push(e);e=b.length;for(var f=-1,c,g="";++f<e;)c=b[f],65535<c&&(c-=65536,g+=m(c>>>10&1023|55296),c=56320|c&1023),g+=m(c);return g}};if(y&&!y.nodeType)if(r)r.exports=l;else{c={}.hasOwnProperty;for(var w in l)c.call(l,w)&&(y[w]=l[w])}else c.utf8=l})(this)}).call(this,"undefined"!==typeof global?global:
"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],61:[function(b,f,e){f.exports="function"===typeof Object.create?function(b,e){b.super_=e;b.prototype=Object.create(e.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}})}:function(b,e){b.super_=e;var f=function(){};f.prototype=e.prototype;b.prototype=new f;b.prototype.constructor=b}},{}],62:[function(b,f,e){f.exports=function(b){return b&&"object"===typeof b&&"function"===typeof b.copy&&"function"===
typeof b.fill&&"function"===typeof b.readUInt8}},{}],63:[function(b,f,e){(function(f,c){function h(b,f){var c={seen:[],stylize:u};3<=arguments.length&&(c.depth=arguments[2]);4<=arguments.length&&(c.colors=arguments[3]);w(f)?c.showHidden=f:f&&e._extend(c,f);x(c.showHidden)&&(c.showHidden=!1);x(c.depth)&&(c.depth=2);x(c.colors)&&(c.colors=!1);x(c.customInspect)&&(c.customInspect=!0);c.colors&&(c.stylize=g);return y(c,b,c.depth)}function g(b,e){return(e=h.styles[e])?"\u001b["+h.colors[e][0]+"m"+b+"\u001b["+
h.colors[e][1]+"m":b}function u(b,e){return b}function D(b){var e={};b.forEach(function(b,f){e[b]=!0});return e}function y(b,f,c){if(b.customInspect&&f&&F(f.inspect)&&f.inspect!==e.inspect&&(!f.constructor||f.constructor.prototype!==f)){var h=f.inspect(c,b);A(h)||(h=y(b,h,c));return h}if(h=r(b,f))return h;var g=Object.keys(f),k=D(g);b.showHidden&&(g=Object.getOwnPropertyNames(f));if(E(f)&&(0<=g.indexOf("message")||0<=g.indexOf("description")))return l(f);if(0===g.length){if(F(f))return b.stylize("[Function"+
(f.name?": "+f.name:"")+"]","special");if(z(f))return b.stylize(RegExp.prototype.toString.call(f),"regexp");if(G(f))return b.stylize(Date.prototype.toString.call(f),"date");if(E(f))return l(f)}h="";var n=!1,u=["{","}"];t(f)&&(n=!0,u=["[","]"]);F(f)&&(h=" [Function"+(f.name?": "+f.name:"")+"]");z(f)&&(h=" "+RegExp.prototype.toString.call(f));G(f)&&(h=" "+Date.prototype.toUTCString.call(f));E(f)&&(h=" "+l(f));if(0===g.length&&(!n||0==f.length))return u[0]+h+u[1];if(0>c)return z(f)?b.stylize(RegExp.prototype.toString.call(f),
"regexp"):b.stylize("[Object]","special");b.seen.push(f);g=n?m(b,f,c,k,g):g.map(function(e){return p(b,f,c,k,e,n)});b.seen.pop();return q(g,h,u)}function r(b,e){if(x(e))return b.stylize("undefined","undefined");if(A(e))return e="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",b.stylize(e,"string");if(v(e))return b.stylize(""+e,"number");if(w(e))return b.stylize(""+e,"boolean");if(null===e)return b.stylize("null","null")}function l(b){return"["+Error.prototype.toString.call(b)+
"]"}function m(b,e,f,c,h){for(var g=[],k=0,n=e.length;k<n;++k)Object.prototype.hasOwnProperty.call(e,String(k))?g.push(p(b,e,f,c,String(k),!0)):g.push("");h.forEach(function(h){h.match(/^\d+$/)||g.push(p(b,e,f,c,h,!0))});return g}function p(b,e,f,c,h,g){var k,n;e=Object.getOwnPropertyDescriptor(e,h)||{value:e[h]};e.get?n=e.set?b.stylize("[Getter/Setter]","special"):b.stylize("[Getter]","special"):e.set&&(n=b.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(c,h)||(k="["+h+"]");n||
(0>b.seen.indexOf(e.value)?(n=null===f?y(b,e.value,null):y(b,e.value,f-1),-1<n.indexOf("\n")&&(n=g?n.split("\n").map(function(b){return"  "+b}).join("\n").substr(2):"\n"+n.split("\n").map(function(b){return"   "+b}).join("\n"))):n=b.stylize("[Circular]","special"));if(x(k)){if(g&&h.match(/^\d+$/))return n;k=JSON.stringify(""+h);k.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(k=k.substr(1,k.length-2),k=b.stylize(k,"name")):(k=k.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),k=b.stylize(k,
"string"))}return k+": "+n}function q(b,e,f){var c=0;return 60<b.reduce(function(b,e){c++;0<=e.indexOf("\n")&&c++;return b+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)?f[0]+(""===e?"":e+"\n ")+" "+b.join(",\n  ")+" "+f[1]:f[0]+e+" "+b.join(", ")+" "+f[1]}function t(b){return Array.isArray(b)}function w(b){return"boolean"===typeof b}function v(b){return"number"===typeof b}function A(b){return"string"===typeof b}function x(b){return void 0===b}function z(b){return B(b)&&"[object RegExp]"===Object.prototype.toString.call(b)}
function B(b){return"object"===typeof b&&null!==b}function G(b){return B(b)&&"[object Date]"===Object.prototype.toString.call(b)}function E(b){return B(b)&&("[object Error]"===Object.prototype.toString.call(b)||b instanceof Error)}function F(b){return"function"===typeof b}function C(b){return 10>b?"0"+b.toString(10):b.toString(10)}function H(){var b=new Date,e=[C(b.getHours()),C(b.getMinutes()),C(b.getSeconds())].join(":");return[b.getDate(),K[b.getMonth()],e].join(" ")}var J=/%[sdj%]/g;e.format=
function(b){if(!A(b)){for(var e=[],f=0;f<arguments.length;f++)e.push(h(arguments[f]));return e.join(" ")}f=1;var c=arguments,g=c.length;e=String(b).replace(J,function(b){if("%%"===b)return"%";if(f>=g)return b;switch(b){case "%s":return String(c[f++]);case "%d":return Number(c[f++]);case "%j":try{return JSON.stringify(c[f++])}catch(to){return"[Circular]"}default:return b}});for(var k=c[f];f<g;k=c[++f])e=null!==k&&B(k)?e+(" "+h(k)):e+(" "+k);return e};e.deprecate=function(b,h){if(x(c.process))return function(){return e.deprecate(b,
h).apply(this,arguments)};if(!0===f.noDeprecation)return b;var g=!1;return function(){if(!g){if(f.throwDeprecation)throw Error(h);f.traceDeprecation?console.trace(h):console.error(h);g=!0}return b.apply(this,arguments)}};var I={},M;e.debuglog=function(b){x(M)&&(M=f.env.NODE_DEBUG||"");b=b.toUpperCase();if(!I[b])if((new RegExp("\\b"+b+"\\b","i")).test(M)){var c=f.pid;I[b]=function(){var f=e.format.apply(e,arguments);console.error("%s %d: %s",b,c,f)}}else I[b]=function(){};return I[b]};e.inspect=h;
h.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};h.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};e.isArray=t;e.isBoolean=w;e.isNull=function(b){return null===b};e.isNullOrUndefined=function(b){return null==b};e.isNumber=v;e.isString=A;e.isSymbol=function(b){return"symbol"===
typeof b};e.isUndefined=x;e.isRegExp=z;e.isObject=B;e.isDate=G;e.isError=E;e.isFunction=F;e.isPrimitive=function(b){return null===b||"boolean"===typeof b||"number"===typeof b||"string"===typeof b||"symbol"===typeof b||"undefined"===typeof b};e.isBuffer=b("./support/isBuffer");var K="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");e.log=function(){console.log("%s - %s",H(),e.format.apply(e,arguments))};e.inherits=b("inherits");e._extend=function(b,e){if(!e||!B(e))return b;for(var f=Object.keys(e),
c=f.length;c--;)b[f[c]]=e[f[c]];return b}}).call(this,b("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":62,_process:43,inherits:61}],64:[function(b,f,e){if(window.mozRTCPeerConnection||navigator.mozGetUserMedia){var c="moz";var g=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)}else if(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)c="webkit",g=navigator.userAgent.match(/Chrom(e|ium)/)&&
parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10);b=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;e=window.mozRTCIceCandidate||window.RTCIceCandidate;var k=window.mozRTCSessionDescription||window.RTCSessionDescription,n=window.webkitMediaStream||window.MediaStream,u="https:"===window.location.protocol&&("webkit"===c&&26<=g||"moz"===c&&33<=g),D=window.AudioContext||window.webkitAudioContext,y=document.createElement("video");y=y&&y.canPlayType&&
"probably"===y.canPlayType('video/webm; codecs="vp8", vorbis');var r=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;f.exports={prefix:c,browserVersion:g,support:!!b&&!!r,supportRTCPeerConnection:!!b,supportVp8:y,supportGetUserMedia:!!r,supportDataChannel:!!(b&&b.prototype&&b.prototype.createDataChannel),supportWebAudio:!(!D||!D.prototype.createMediaStreamSource),supportMediaStream:!(!n||!n.prototype.removeTrack),supportScreenSharing:!!u,AudioContext:D,
PeerConnection:b,SessionDescription:k,IceCandidate:e,MediaStream:n,getUserMedia:r}},{}],65:[function(b,f,e){function c(){}f.exports=c;c.mixin=function(b){b=b.prototype||b;b.isWildEmitter=!0;b.on=function(b,e,f){this.callbacks=this.callbacks||{};var c=3===arguments.length,h=c?arguments[2]:arguments[1];h._groupName=c?arguments[1]:void 0;(this.callbacks[b]=this.callbacks[b]||[]).push(h);return this};b.once=function(b,e,f){function c(){h.off(b,c);k.apply(this,arguments)}var h=this,g=3===arguments.length,
k=g?arguments[2]:arguments[1];this.on(b,g?arguments[1]:void 0,c);return this};b.releaseGroup=function(b){this.callbacks=this.callbacks||{};var e,f;for(e in this.callbacks){var c=this.callbacks[e];var h=0;for(f=c.length;h<f;h++)c[h]._groupName===b&&(c.splice(h,1),h--,f--)}return this};b.off=function(b,e){this.callbacks=this.callbacks||{};var f=this.callbacks[b];if(!f)return this;if(1===arguments.length)return delete this.callbacks[b],this;var c=f.indexOf(e);f.splice(c,1);0===f.length&&delete this.callbacks[b];
return this};b.emit=function(b){this.callbacks=this.callbacks||{};var e=[].slice.call(arguments,1),f=this.callbacks[b],c=this.getWildcardCallbacks(b),h;if(f){var g=f.slice();f=0;for(h=g.length;f<h&&g[f];++f)g[f].apply(this,e)}if(c)for(g=c.slice(),f=0,h=g.length;f<h&&g[f];++f)g[f].apply(this,[b].concat(e));return this};b.getWildcardCallbacks=function(b){this.callbacks=this.callbacks||{};var e,f=[];for(e in this.callbacks){var c=e.split("*");if("*"===e||2===c.length&&b.slice(0,c[0].length)===c[0])f=
f.concat(this.callbacks[e])}return f}};c.mixin(c)},{}],66:[function(b,f,e){function c(b,e,f){return e?new g(b,e):new g(b)}b=window;var g=b.WebSocket||b.MozWebSocket;f.exports=g?c:null;g&&(c.prototype=g.prototype)},{}],67:[function(b,f,e){function c(b){var e=!0;b.getTracks().forEach(function(b){e="ended"===b.readyState&&e});return e}function g(b){var e=this;u.call(this);this.id=b.id;this.parent=b.parent;this.type=b.type||"video";this.oneway=b.oneway||!1;this.sharemyscreen=b.sharemyscreen||!1;this.browserPrefix=
b.prefix;this.stream=b.stream;this.enableDataChannels=void 0===b.enableDataChannels?this.parent.config.enableDataChannels:b.enableDataChannels;this.receiveMedia=b.receiveMedia||this.parent.config.receiveMedia;this.channels={};this.sid=b.sid||Date.now().toString();this.pc=new n(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints);this.pc.on("ice",this.onIceCandidate.bind(this));this.pc.on("endOfCandidates",function(b){e.send("endOfCandidates",b)});this.pc.on("offer",
function(b){e.parent.config.nick&&(b.nick=e.parent.config.nick);e.send("offer",b)});this.pc.on("answer",function(b){e.parent.config.nick&&(b.nick=e.parent.config.nick);e.send("answer",b)});this.pc.on("addStream",this.handleRemoteStreamAdded.bind(this));this.pc.on("addChannel",this.handleDataChannelAdded.bind(this));this.pc.on("removeStream",this.handleStreamRemoved.bind(this));this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded"));this.pc.on("iceConnectionStateChange",this.emit.bind(this,
"iceConnectionStateChange"));this.pc.on("iceConnectionStateChange",function(){switch(e.pc.iceConnectionState){case "failed":"offer"===e.pc.pc.localDescription.type&&(e.parent.emit("iceFailed",e),e.send("connectivityError"))}});this.pc.on("signalingStateChange",this.emit.bind(this,"signalingStateChange"));this.logger=this.parent.logger;"screen"===b.type?this.parent.localScreens&&this.parent.localScreens[0]&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),this.pc.addStream(this.parent.localScreens[0]),
this.broadcaster=b.broadcaster):this.parent.localStreams.forEach(function(b){e.pc.addStream(b)});this.on("channelOpen",function(b){"https://simplewebrtc.com/protocol/filetransfer#inband-v1"===b.protocol&&(b.onmessage=function(f){f=JSON.parse(f.data);var c=new l.Receiver;c.receive(f,b);e.emit("fileTransfer",f,c);c.on("receivedFile",function(b,e){c.channel.close()})})});this.on("*",function(){e.parent.emit.apply(e.parent,arguments)})}e=b("util");var k=b("webrtcsupport"),n=b("rtcpeerconnection"),u=b("wildemitter"),
l=b("filetransfer");e.inherits(g,u);g.prototype.handleMessage=function(b){var e=this;this.logger.log("getting",b.type,b);b.prefix&&(this.browserPrefix=b.prefix);"offer"===b.type?(this.nick||(this.nick=b.payload.nick),delete b.payload.nick,this.pc.handleOffer(b.payload,function(b){b||e.pc.answer(function(b,e){})})):"answer"===b.type?(this.nick||(this.nick=b.payload.nick),delete b.payload.nick,this.pc.handleAnswer(b.payload)):"candidate"===b.type?this.pc.processIce(b.payload):"connectivityError"===
b.type?this.parent.emit("connectivityError",e):"mute"===b.type?this.parent.emit("mute",{id:b.from,name:b.payload.name}):"unmute"===b.type&&this.parent.emit("unmute",{id:b.from,name:b.payload.name})};g.prototype.send=function(b,e){e={to:this.id,sid:this.sid,broadcaster:this.broadcaster,roomType:this.type,type:b,payload:e,prefix:k.prefix};this.logger.log("sending",b,e);this.parent.emit("message",e)};g.prototype.sendDirectly=function(b,e,f){var c={type:e,payload:f};this.logger.log("sending via datachannel",
b,e,c);b=this.getDataChannel(b);if("open"!=b.readyState)return!1;f.func!==mb.location?b.send(JSON.stringify(c)):b.send(f[1].buffer);return!0};g.prototype._observeDataChannel=function(b){var e=this;b.binaryType="arraybuffer";b.onclose=this.emit.bind(this,"channelClose",b);b.onerror=this.emit.bind(this,"channelError",b);b.onmessage=function(f){var c=f.data;c=c.byteLength?{type:"nehhof",payload:{1:new Uint8Array(c),func:mb.location}}:JSON.parse(c);e.emit("channelMessage",e,b.label,c,b,f)};b.onopen=this.emit.bind(this,
"channelOpen",b)};g.prototype.getDataChannel=function(b,e){if(!k.supportDataChannel)return this.emit("error",Error("createDataChannel not supported"));var f=this.channels[b];e||(e={});if(f)return f;f=this.channels[b]=this.pc.createDataChannel(b,e);f.binaryType="arraybuffer";this._observeDataChannel(f);return f};g.prototype.onIceCandidate=function(b){if(!this.closed)if(b){var e=this.parent.config.peerConnectionConfig;"moz"===k.prefix&&e&&e.iceTransports&&b.candidate&&b.candidate.candidate&&0>b.candidate.candidate.indexOf(e.iceTransports)?
this.logger.log("Ignoring ice candidate not matching pcConfig iceTransports type: ",e.iceTransports):this.send("candidate",b)}else this.logger.log("End of candidates.")};g.prototype.start=function(){this.enableDataChannels&&this.getDataChannel("simplewebrtc");this.pc.offer(this.receiveMedia,function(b,e){})};g.prototype.icerestart=function(){var b=this.receiveMedia;b.mandatory.IceRestart=!0;this.pc.offer(b,function(b,e){})};g.prototype.end=function(){this.closed||(this.pc.close(),this.handleStreamRemoved())};
g.prototype.handleRemoteStreamAdded=function(b){var e=this;this.stream?this.logger.warn("Already have a remote stream"):(this.stream=b.stream,this.stream.getTracks().forEach(function(b){b.addEventListener("ended",function(){c(e.stream)&&e.end()})}),this.parent.emit("peerStreamAdded",this))};g.prototype.handleStreamRemoved=function(){var b=this.parent.peers.indexOf(this);-1<b&&(this.parent.peers.splice(b,1),this.closed=!0,this.parent.emit("peerStreamRemoved",this))};g.prototype.handleDataChannelAdded=
function(b){this.channels[b.label]=b;this._observeDataChannel(b)};g.prototype.sendFile=function(b){var e=new l.Sender,f=this.getDataChannel("filetransfer"+(new Date).getTime(),{protocol:"https://simplewebrtc.com/protocol/filetransfer#inband-v1"});f.onopen=function(){f.send(JSON.stringify({size:b.size,name:b.name}));e.send(b,f)};f.onclose=function(){console.log("sender received transfer");e.emit("complete")};return e};f.exports=g},{filetransfer:26,rtcpeerconnection:44,util:63,webrtcsupport:64,wildemitter:65}],
68:[function(b,f,e){function c(b){var e=this,f=b||{},c=this.config={url:"https://sandbox.simplewebrtc.com:443/",socketio:{},connection:null,debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!1,peerVolumeWhenSpeaking:.25,media:{video:!0,audio:!0},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},localVideo:{autoplay:!0,mirror:!0,muted:!0}},h;var r=b.debug?b.logger||console:b.logger||l;this.logger=r;for(h in f)f.hasOwnProperty(h)&&
(this.config[h]=f[h]);this.capabilities=n;k.call(this);var D=null===this.config.connection?this.connection=new y(this.config):this.connection=this.config.connection;D.on("connect",function(){e.emit("connectionReady",D.getSessionid());e.sessionReady=!0;e.testReadiness()});D.on("message",function(b){var f=e.webrtc.getPeers(b.from,b.roomType);if("offer"===b.type){f.length&&f.forEach(function(e){e.sid==b.sid&&(c=e)});if(!c){var c=e.webrtc.createPeer({id:b.from,sid:b.sid,type:b.roomType,enableDataChannels:e.config.enableDataChannels&&
"screen"!==b.roomType,sharemyscreen:"screen"===b.roomType&&!b.broadcaster,broadcaster:"screen"!==b.roomType||b.broadcaster?null:e.connection.getSessionid()});e.emit("createdPeer",c)}c.handleMessage(b)}else f.length&&f.forEach(function(e){b.sid?e.sid===b.sid&&e.handleMessage(b):e.handleMessage(b)})});D.on("remove",function(b){b.id!==e.connection.getSessionid()&&e.webrtc.removePeers(b.id,b.type)});b.logger=this.logger;b.debug=!1;this.webrtc=new g(b);"mute unmute pauseVideo resumeVideo pause resume sendToAll sendDirectlyToAll getPeers".split(" ").forEach(function(b){e[b]=
e.webrtc[b].bind(e.webrtc)});this.webrtc.on("*",function(){e.emit.apply(e,arguments)});if(c.debug)this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:"));this.webrtc.on("localStream",function(){e.testReadiness()});this.webrtc.on("message",function(b){e.connection.emit("message",b)});this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this));this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this));this.config.adjustPeerVolume&&(this.webrtc.on("speaking",
this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1)));D.on("stunservers",function(b){e.webrtc.config.peerConnectionConfig.iceServers=b;e.emit("stunservers",b)});D.on("turnservers",function(b){e.webrtc.config.peerConnectionConfig.iceServers=e.webrtc.config.peerConnectionConfig.iceServers.concat(b);e.emit("turnservers",b)});this.webrtc.on("iceFailed",function(b){});this.webrtc.on("connectivityError",function(b){});this.webrtc.on("audioOn",
function(){e.webrtc.sendToAll("unmute",{name:"audio"})});this.webrtc.on("audioOff",function(){e.webrtc.sendToAll("mute",{name:"audio"})});this.webrtc.on("videoOn",function(){e.webrtc.sendToAll("unmute",{name:"video"})});this.webrtc.on("videoOff",function(){e.webrtc.sendToAll("mute",{name:"video"})});this.webrtc.on("localScreen",function(b){var f=document.createElement("video"),c=e.getRemoteVideoContainer();f.oncontextmenu=function(){return!1};f.id="localScreen";u(b,f);c&&c.appendChild(f);e.emit("localScreenAdded",
f);e.connection.emit("shareScreen");e.webrtc.peers.forEach(function(b){"video"===b.type&&(b=e.webrtc.createPeer({id:b.id,type:"screen",sharemyscreen:!0,enableDataChannels:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},broadcaster:e.connection.getSessionid()}),e.emit("createdPeer",b),b.start())})});this.webrtc.on("localScreenStopped",function(b){e.getLocalScreen()&&e.stopScreenShare()});this.webrtc.on("channelMessage",function(b,f,c){"volume"==c.type&&e.emit("remoteVolumeChange",b,c.volume)});
this.config.autoRequestMedia&&this.startLocalVideo()}var g=b("./webrtc"),k=b("wildemitter"),n=b("webrtcsupport"),u=b("attachmediastream"),l=b("mockconsole"),y=b("./socketioconnection");c.prototype=Object.create(k.prototype,{constructor:{value:c}});c.prototype.leaveRoom=function(){if(this.roomName){for(this.connection.emit("leave");this.webrtc.peers.length;)this.webrtc.peers[0].end();this.getLocalScreen()&&this.stopScreenShare();this.emit("leftRoom",this.roomName);this.roomName=void 0}};c.prototype.disconnect=
function(){this.connection.disconnect();delete this.connection};c.prototype.handlePeerStreamAdded=function(b){var e=this,f=this.getRemoteVideoContainer(),c=u(b.stream);b.videoEl=c;c.id=this.getDomId(b);f&&f.appendChild(c);this.emit("videoAdded",c,b);window.setTimeout(function(){e.webrtc.isAudioEnabled()||b.send("mute",{name:"audio"});e.webrtc.isVideoEnabled()||b.send("mute",{name:"video"})},250)};c.prototype.handlePeerStreamRemoved=function(b){var e=this.getRemoteVideoContainer(),f=b.videoEl;this.config.autoRemoveVideos&&
e&&f&&e.removeChild(f);f&&this.emit("videoRemoved",f,b)};c.prototype.getDomId=function(b){return[b.id,b.type,b.broadcaster?"broadcasting":"incoming"].join("_")};c.prototype.setVolumeForAll=function(b){this.webrtc.peers.forEach(function(e){e.videoEl&&(e.videoEl.volume=b)})};c.prototype.joinRoom=function(b,e){var f=this;this.roomName=b;this.connection.emit("join",b,function(c,h){console.log("join CB",c);if(c)f.emit("error",c);else{if(!h.xtra){sa();db();Id(t.errorLoading,"#ff0000");return}x.room=h.xtra;
var g,k;for(g in h.clients){var n=h.clients[g];for(k in n)if(n[k]){var u=f.webrtc.createPeer({id:g,type:k,enableDataChannels:f.config.enableDataChannels&&"screen"!==k,receiveMedia:{offerToReceiveAudio:"screen"!==k&&f.config.receiveMedia.offerToReceiveAudio?1:0,offerToReceiveVideo:f.config.receiveMedia.offerToReceiveVideo}});f.emit("createdPeer",u);u.start()}}}e&&e(c,h);f.emit("joinedRoom",b)})};c.prototype.getEl=function(b){return"string"===typeof b?document.getElementById(b):b};c.prototype.startLocalVideo=
function(){var b=this;this.webrtc.start(this.config.media,function(e,f){e?b.emit("localMediaError",e):u(f,b.getLocalVideoContainer(),b.config.localVideo)})};c.prototype.stopLocalVideo=function(){this.webrtc.stop()};c.prototype.getLocalVideoContainer=function(){var b=this.getEl(this.config.localVideoEl);if(b&&"VIDEO"===b.tagName)return b.oncontextmenu=function(){return!1},b;if(b){var e=document.createElement("video");e.oncontextmenu=function(){return!1};b.appendChild(e);return e}};c.prototype.getRemoteVideoContainer=
function(){return this.getEl(this.config.remoteVideosEl)};c.prototype.shareScreen=function(b){this.webrtc.startScreenShare(b)};c.prototype.getLocalScreen=function(){return this.webrtc.localScreens&&this.webrtc.localScreens[0]};c.prototype.stopScreenShare=function(){this.connection.emit("unshareScreen");var b=document.getElementById("localScreen"),e=this.getRemoteVideoContainer();this.config.autoRemoveVideos&&e&&b&&e.removeChild(b);b&&this.emit("videoRemoved",b);this.getLocalScreen()&&this.webrtc.stopScreenShare();
this.webrtc.peers.forEach(function(b){b.broadcaster&&b.end()})};c.prototype.testReadiness=function(){this.sessionReady&&(this.config.media.video||this.config.media.audio?0<this.webrtc.localStreams.length&&this.emit("readyToCall",this.connection.getSessionid()):this.emit("readyToCall",this.connection.getSessionid()))};c.prototype.createRoom=function(b,e){this.roomName=b;this.connection.emit("create",x.room,e)};c.prototype.sendFile=function(){if(!n.dataChannel)return this.emit("error",Error("DataChannelNotSupported"))};
f.exports=c},{"./socketioconnection":69,"./webrtc":70,attachmediastream:3,mockconsole:37,webrtcsupport:64,wildemitter:65}],69:[function(b,f,e){function c(b){this.connection=g.connect(b.url,b.socketio)}var g=b("socket.io-client");c.prototype.on=function(b,e){this.connection.on(b,e)};c.prototype.emit=function(){this.connection.emit.apply(this.connection,arguments)};c.prototype.getSessionid=function(){return this.connection.id};c.prototype.disconnect=function(){return this.connection.disconnect()};f.exports=
c},{"socket.io-client":50}],70:[function(b,f,e){function c(b){var e=this,f=b||{};this.config={debug:!1,peerConnectionConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[]},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},enableDataChannels:!0};var c;b=b.debug?b.logger||console:b.logger||k;this.logger=b;for(c in f)f.hasOwnProperty(c)&&(this.config[c]=f[c]);g.support||this.logger.error("Your browser doesn't seem to support WebRTC");this.peers=[];
n.call(this,this.config);this.on("speaking",function(){e.hardMuted||e.peers.forEach(function(b){b.enableDataChannels&&(b=b.getDataChannel("hark"),"open"==b.readyState&&b.send(JSON.stringify({type:"speaking"})))})});this.on("stoppedSpeaking",function(){e.hardMuted||e.peers.forEach(function(b){b.enableDataChannels&&(b=b.getDataChannel("hark"),"open"==b.readyState&&b.send(JSON.stringify({type:"stoppedSpeaking"})))})});this.on("volumeChange",function(b,f){e.hardMuted||e.peers.forEach(function(e){e.enableDataChannels&&
(e=e.getDataChannel("hark"),"open"==e.readyState&&e.send(JSON.stringify({type:"volume",volume:b})))})});if(this.config.debug)this.on("*",function(b,f,c){(e.config.logger===k?console:e.logger).log("event:",b,f,c)})}e=b("util");var g=b("webrtcsupport"),k=b("mockconsole"),n=b("localmedia"),u=b("./peer");e.inherits(c,n);c.prototype.createPeer=function(b){b.parent=this;b=new u(b);this.peers.push(b);return b};c.prototype.removePeers=function(b,e){this.getPeers(b,e).forEach(function(b){b.end()})};c.prototype.getPeers=
function(b,e){return this.peers.filter(function(f){return(!b||f.id===b)&&(!e||f.type===e)})};c.prototype.sendToAll=function(b,e){this.peers.forEach(function(f){f.send(b,e)})};c.prototype.sendDirectlyToAll=function(b,e,f){this.peers.forEach(function(c){c.enableDataChannels&&c.sendDirectly(b,e,f)})};f.exports=c},{"./peer":67,localmedia:35,mockconsole:37,util:63,webrtcsupport:64}]},{},[68])(68)})},G,ha,t={},x={name:localStorage.name,color:localStorage.color||"#ff0000"},Jc=function(){};console.log("%c nehhon %c POWER ",
"background: #00ffd4; color: #000; font-size:20px","background: #000; color: #00ffd4; font-size:20px");console.log("%c webmaster@nehhon.com ","background: #00ffd4; color: #000; font-size:20px");console.log("%c @nehhon ","background: #000; color: #00ffd4; font-size:20px");var q=function(d){return document.getElementById(d)},fb=function(d,b,f){void 0===localStorage[d]&&(localStorage[d]=b);f&&(q(f).value=localStorage[d])};void 0===localStorage.fullscreen&&(localStorage.fullscreen=!0);fb("favMusic","originalMusic");
fb("musicRange",80);fb("soundRange",45);fb("goldRes",400);fb("foodRes",400);fb("stoneRes",400);fb("woodRes",400);fb("nplayed",0);fb("infinity","true");fb("mapSize",256);fb("terrainType","grass");fb("water","0");fb("items","10");fb("peons","3");fb("gateways","1");fb("freePop","1");console.log=Jc;console.error=Jc;console.warn=Jc;console.info=Jc;"tza.red"!==location.hostname&&(location.href="https://tza.red");window.onbeforeunload=function(){return"Are you sure you want to quit?"};var Hm=function(d){d.parentNode.removeChild(d)},
Id=function(d,b){var f=q("notifybar"),e=document.createElement("div");e.innerHTML=d;b&&(e.style.background=b);f.appendChild(e);setTimeout(Hm,11E3,e)};document.body.style.setProperty("--baksp","linear-gradient(60deg, rgba(55, 0, 56, 0.6) 0%, rgba(var(--lred),var(--lgreen),var(--lblue), 0.5) 100%), url(/nehhon/bak2.jpg) fixed repeat");document.body.style.setProperty("--bak2sp","url(/nehhon/bak.jpg) fixed repeat");var dk=function(d){d=parseInt(d.substr(1),16);return[d>>16&255,d>>8&255,d&255]},Im=location;
(function(){var d=!!window.opr||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),b="undefined"!==typeof InstallTrigger,f=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),e=!!document.documentMode,c=!e&&!!window.StyleMedia,g=!!window.chrome&&!!window.chrome.webstore,k;d?k="Opera":b?k="Firefox":f?k="Safari":e?k="IE":c?k="Edge":g&&(k="Chrome");x.navLang=localStorage.language||navigator.language||navigator.userLanguage;"IE"!=k&&"Edge"!=k&&"Safari"!=k||Id("Your browser is not supported",
"#ff0000");d=x.navLang.substr(0,2);b={es:["Tzared","Juego de estrategia en tiempo real para navegadores web, juega solo o con amigos","tzared,jugar,multijugador,juego,online,navegador web,tzar"],it:["Tzared","Gioco di strategia in tempo reale per browser web, giocare da soli o con gli amici","tzared,giocare,multigiocatore,gioco,online,navigatore,tzar,web"],pl:["Tzared","Gra strategiczna w czasie rzeczywistym dla przegl\u0105darek internetowych, bawi\u0107 si\u0119 samotnie lub z przyjaci\u00f3\u0142mi",
"tzared,gra,multiplayer,online,tzar,przegl\u0105darka internetowa"],ru:["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u043b\u044f \u0432\u0435\u0431-\u0431\u0440\u0430\u0443\u0437\u0435\u0440\u043e\u0432, \u0438\u0433\u0440\u0430\u0442\u044c \u0432 \u043e\u0434\u0438\u043d\u043e\u0447\u043a\u0443 \u0438\u043b\u0438 \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438",
"\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u044c\u0442\u0438\u043f\u043b\u0435\u0435\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u0435\u0440,\u043e\u0433\u043d\u0451\u043c \u0438 \u043c\u0435\u0447\u043e\u043c"],pt:["Tzared","Jogo de estrat\u00e9gia em tempo real para navegadores da web, jogar sozinho ou com amigos","tzared,jogar,multiplayer,jogo,online,navegador web,tzar"],bg:["\u0426\u0430\u0440\u0435\u0434","\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0447\u0435\u0441\u043a\u0430 \u0438\u0433\u0440\u0430 \u0432 \u0440\u0435\u0430\u043b\u043d\u043e \u0432\u0440\u0435\u043c\u0435 \u0437\u0430 \u0443\u0435\u0431 \u0431\u0440\u0430\u0443\u0437\u044a\u0440\u0438, \u0438\u0433\u0440\u0430\u0439\u0442\u0435 \u0441\u0430\u043c\u0438 \u0438\u043b\u0438 \u0441 \u043f\u0440\u0438\u044f\u0442\u0435\u043b\u0438",
"\u0446\u0430\u0440\u0435\u0434,\u0438\u0433\u0440\u0430,\u043c\u0443\u043b\u0442\u0438\u043f\u043b\u0435\u0439\u044a\u0440,\u043e\u043d\u043b\u0430\u0439\u043d,\u0431\u0440\u0430\u0443\u0437\u044a\u0440"],de:["Tzared","Echtzeit-Strategiespiel f\u00fcr Webbrowser, alleine oder mit Freunden spielen","tzared,multiplayer,spiel,online,Webbrowser,tzar"],en:["Tzared","Real-time strategy game for web browsers, play alone or with friends","tzared,play,multiplayer,game,online,browser,tzar,web"]};b[d]||(d=
"en");document.getElementsByTagName("html")[0].lang=d;b=b[location.search.split("lang=")[1]||"en"];document.title=b[0];x.title=b[0];document.getElementsByTagName("meta").description=b[1];document.getElementsByTagName("meta").keywords=b[2];x.version="v32.0";x.versionDate=Date.now()-1539368200097;localStorage.version!==x.version&&(localStorage.version=x.version,Id("Updated to "+x.version));q("info").innerHTML="Work in progress - Beta "+x.version+" - Updated "+~~(x.versionDate/864E5)+" days ago";x.lang=
"en es it pt ru pl bg de".split(" ").indexOf(d);0>x.lang&&(x.lang=0);x.langstr=d;x.team=0;x.race=0;x.navigator=k;x.mx=151;x.onlineID=null;x.temperature=0;x.cdn="/nehhon/"})();window.onload=function(){document.getElementById("loadingpage").style="visibility: hidden;\n  opacity: 0;\n  transition: visibility .5s, opacity .5s linear;";setTimeout(function(){document.body.removeChild(document.getElementById("loadingpage"))},1E3)};t={open:"Open",loading:"Loading...",systemAlert:"System Message",notEnough:"Not enough %s",
ok:"OK",yes:"Yes",no:"No",secure:"Are you sure?",gold:"Gold",stone:"Stone",wood:"Wood",food:"Food",mana:"Manna",warning:"Warning",play:"PLAY",grass:"Grass",snow:"Snow",close:"CLOSE",gameClosed:"The game was canceled by the server.",loadgraphics:"Downloading graphics...",waitImages:"Downloading graphics",wait:"Wait",audioproblem:"Your browser is not compatible with Web Audio",defeated:"DEFEATED",victorious:"VICTORIOUS",options:"OPTIONS",refresh:"Refresh",back:"BACK",paused:"PAUSED",chatMsg:"CHAT MESSAGE",
disconnect:"Disconnect",playerDisconnected:"%s has disconnected!",connectionError:"Connection error",noP2P:"Engine not loaded",startingResources:"Starting Resources",mapSize:"Map Size",menu:"MENU",quit:"QUIT",downloadAll:"Download all",continue:"Continue",backToGame:"BACK TO GAME",initializing:"Initializing...",requires:"Requires",stop:"Stop",pickItems:"Pick items",move:"Move",stand:"Stand ground",explore:"Explore",patrol:"Patrol",guard:"Guard",errorLoading:"Error loading game.",waitingPlayers:"Waiting for players to connect",
musicVolume:"Music Volume",soundVolume:"Sound Volume",common:"Common",popLimit:"Population limit reached",houseLimit:"Not enough houses",lightning:"Lightning",freeze:"Freeze",bless:"Bless",heal:"Heal",invisibility:"Invisibility",dcm:"Dig, chop or mine",repair:"Repair building",menuBuild:"See what you can build",units:"Units",infinite:"Infinite",gameFull:"Sorry, the game is full.",terrainOption:"Terrain",playerDefeated:"%s has been defeated!",savegame:"SAVE GAME",loadRecord:"Recording",stats:"Stats",
builds:"Builds",items:"Items",nature:"Nature",trees:"Trees",delete:"Delete",create:"Create",username:"Player Name",gameOptions:"GAME OPTIONS",nplayers:"Number of Players",gameName:"Enter Game Name",gamesFound:"Games Found",strSearch:"SEARCH| Search for existing games",strCreate:"CREATE| Create a game",randomMap:"RANDOM MAP",strcusMap:"CUSTOM MAP",strSettings:"SETTINGS",mapMaking:"Map Making",terrain:"Terrain",save:"SAVE",accept:"ACCEPT",team:"Team",color:"Colour",offlinePlay:"For playing offline",
AI:"AI Assist",kingdom:"Kingdom",attack:"Attack",defence:"Defence",health:"Health",maxHealth:"Max health",playing:"Playing",waiting:"Waiting",joining:"Joining...",random:"Random",cancel:"CANCEL",rules:"Rules",events:"Events",actions:"Actions",objAction:"Object action",destroyObj:"Destroy object",defined:"Defined",undefined:"Undefined",destroy:"Destroy",capture:"Capture",moving:"Moving",add:"Add",objOrder:"Order",objZone:"Object in zone",zone:"Zone",editMap:"Edit",mapName:"Map name",water:"Water",
description:"Map Description",author:"Author",fullscreen:"Automatic full screen",fullscreen2:"Full screen",versionError:"Incorrect game version.",language:"Language",english:"English",spanish:"Espa\u00f1ol",italian:"Italiano",portuguese:"Portugu\u00eas",russian:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439",polish:"Polski",bulgarian:"\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438",german:"Deutsch",up:"Up",down:"Down",kick:"Kick",kicked:"You were kicked off by the server.",nospace:"Not enought space",
peons:"Peasants",gateways:"Magic Gateways",computer:"Computer",addAI:"Add AI",race:"Race",date:"Date",freePop:"Free population",about:"About",loadTerrain:"Loading Terrain...",downloadmap:"Download savegame",timePlayed:"Played time"};var ek=Jc,gk=function(d){d--;var b=new XMLHttpRequest;b.open("GET","/nehhon/"+x.langstr+".json",!0);b.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");b.onreadystatechange=function(){if(4==b.readyState&&200==b.status){var d=JSON.parse(b.response);
ek=function(){for(var b=B,e=0;e<b.length;e++){var f=b[e].name;d[f]&&(b[e].name=d[f])}for(e=0;e<F.length;e++)b=F[e],d[b.name[0]]&&d[b.name[1]]&&(b.name[0]=d[b.name[0]],b.name[1]=d[b.name[1]]);d=null};for(var e=[],h=0;0>h;h++)"undefined"!=typeof c[h]&&null!=c[h].tech&&(e.push(c[h].tech.name),Object.freeze(c[h].tech));for(h=0;h<e.length;h++)e[h][0]=d[e[h][0]],e[h][1]=d[e[h][1]];e=Object.keys(t);for(h=0;h<e.length;h++){var g=e[h];void 0!=d[t[g]]&&(t[g]=d[t[g]])}Object.freeze(t);for(h=0;h<Ia.length;h++)Ia[h]=
d[Ia[h]];for(h=0;h<0*Lh.length;h++)Lh[h]=d[Lh[h]];Object.freeze(Ia);fk()}};b.send()},fk=function(){for(var d=["refreshButton",t.refresh,"optionsButton",t.options,"startButton",t.play,"backButton",t.back,"closeButton",t.close,"quitButton",t.quit,"continueButton",t.continue],b=0,f=d.length;b<f;b+=2)for(var e=document.getElementsByClassName(d[b]),c=0,g=e.length;c<g;c++)e[c].innerHTML=d[b+1];d=["alertok",t.ok,"gamesFound",t.gamesFound,"strSearch",t.strSearch.split("| ")[1],"strCreate",t.strCreate.split("| ")[1],
"strRandomMap",t.randomMap,"strcusMap",t.strcusMap,"strMapEditor",t.mapMaking,"h2rndMap",t.randomMap,"strSettings",t.strSettings,"about",t.about];b=0;for(f=d.length;b<f;b+=2)q(d[b]).innerHTML=d[b+1]};0<x.lang?(gk(x.lang),gk.translated=!0):fk();var T=console.log,Jm=q("alerttitle"),Km=q("alerttext"),Lm=q("alert"),Kc=function(d,b,f){Lm.style.display="block";Jm.innerHTML=b||t.warning;Km.innerHTML=d;f?q("alertok").style.display="none":q("alertok").style.display="block";q("basic").style.filter="blur(94px)"},
Mm=[1E3,0,2E3,0],ik=function(d,b,f){var e=new XMLHttpRequest;e.open("GET",d,!0);e.responseType="arraybuffer";e.onload=function(){b.length?hk(e.response,0):hk(e.response,86507520);da.check()};e.onprogress=f;e.send(1)},hk=function(d,b){var f=performance.now();d=new Uint16Array(d);var e=d.length,c=d[e-4]+65536*d[e-3],g=d[e-2]+65536*d[e-1];e-=2;for(var k=-1,n=da.common,u=b;c<e;c++){var l=d[c];if(65533<l){65535==l?(l=d[c+1],c+=1):(l=d[c+1]+65536*d[c+2],c+=2);for(var y=0;y<l&&!(n[u++]=k,u-b>=g);y++);}else{l=
d[2*l]+65536*d[2*l+1];n[u++]=l;if(u-b>=g)break;k=l}}T("nh17:",performance.now()-f)},Lc=function(){var d=["icons.png","images.json","graphics.nh17","terrainDataGrass.json","grass.nh17"];d=d.concat(Mh);var b=d.length;Lc.max=b;for(var f=0;f<b;f++)Nm(x.cdn+d[f]);this.innerHTML="0%";this.disabled=!0;Lc.button=this};Lc.loaded=0;var Nm=function(d){var b=new XMLHttpRequest;b.open("GET",d,!0);b.responseType="arraybuffer";b.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");b.onload=
function(){Lc.loaded++;Lc.button.innerHTML=~~(100*Lc.loaded/Lc.max+.5)+"%"};b.send("")},da={size:512,load:0,xtra:[],common:1,xtraRes:[]},l,Pb=function(d){d.target.loadedSize||(Pb.total+=d.total,d.target.lastLoaded=0,d.target.loadedSize=!0);Pb.progress+=d.loaded-d.target.lastLoaded;d.target.lastLoaded=d.loaded;q("loadingtext").innerHTML=t.loadgraphics+~~(100*Pb.progress/Pb.total)+"%"};da.check=function(){da.load++;if(da.load===da.images){var d=m.createTexture();m.activeTexture(m.TEXTURE0);var b=da.info;
m.bindTexture(m.TEXTURE_2D,d);m.texImage2D(m.TEXTURE_2D,0,m.RGBA32F,512,512,0,m.RGBA,m.FLOAT,b);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT);m.bindTexture(m.TEXTURE_2D,null);m.activeTexture(m.TEXTURE0);m.bindTexture(m.TEXTURE_2D,d);m.uniform1i(m.getUniformLocation(N,"u_image1"),0);m.activeTexture(m.TEXTURE1);d=
m.createTexture();m.bindTexture(m.TEXTURE_2D_ARRAY,d);m.texParameteri(m.TEXTURE_2D_ARRAY,m.TEXTURE_MAG_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D_ARRAY,m.TEXTURE_MIN_FILTER,m.NEAREST);b=performance.now();m.texImage3D(m.TEXTURE_2D_ARRAY,0,m.RGBA,da.size,da.size,da.common.length/(da.size*da.size),0,m.RGBA,m.UNSIGNED_BYTE,new Uint8Array(da.common.buffer));T("3dtex",performance.now()-b);da.common=void 0;m.activeTexture(m.TEXTURE1);m.bindTexture(m.TEXTURE_2D_ARRAY,d);m.uniform1i(m.getUniformLocation(N,
"img_common"),1);m.useProgram(ya);m.activeTexture(m.TEXTURE0);m.bindTexture(m.TEXTURE_2D_ARRAY,d);m.uniform1i(m.getUniformLocation(ya,"img_common"),0);m.activeTexture(m.TEXTURE2);Om();Rb.check()}};var Pm=function(d){da.common=new Uint32Array(86507520+Wf[p.terrainType].size);q("loadingtext").innerHTML=t.waitImages;da.images=Object.keys(d).length;da.load=0;Pb.progress=0;Pb.total=0;Date.now();if(W.icons)da.check();else{var b=new XMLHttpRequest;b.open("GET",d.icons,!0);b.responseType="arraybuffer";b.onreadystatechange=
function(){if(4===b.readyState&&200===b.status){var d=new Uint8Array(b.response);d=new Blob([d],{type:"image/png"});var e=new Image;e.src=URL.createObjectURL(d);W.icons=e;da.check();Date.now()}};b.onprogress=Pb;b.send(1)}if(l)da.check();else{var f=new XMLHttpRequest;f.open("GET",d.imageJSON,!0);f.onreadystatechange=function(){4==this.readyState&&200==this.status&&(da.check(),l=JSON.parse(f.response),g&&Nh())};f.onprogress=Pb;f.send(1)}ik(d.common,"common",Pb);d=x.cdn;da.images+=2;q("terrainSelect")&&
(localStorage.terrain=q("terrainSelect").value);var e=Wf[p.terrainType],c=new XMLHttpRequest,g=!1;c.open("GET",d+e.json,!0);c.onreadystatechange=function(){if(4==this.readyState&&200==this.status){da.xtraRes[0]=JSON.parse(c.response);pc=da.xtraRes[0];var b=pc.specialColor;te=new Float32Array(Ab(b[0]/255,b[1]/255,b[2]/255,.9));da.check();g=!0;b="rgb("+b[0]+","+b[1]+","+b[2]+")";q("msgs1").style.color=b;q("playersinfo").style.color=b;q("topinfo").style.color=b;l&&Nh()}};c.onprogress=Pb;c.send(!0);ik(d+
e.main,0,!1)},Wf={grass:{json:"terrainDataGrass.json",main:"grass.nh17",size:9437184},snow:{json:"terrainDataSnow.json",main:"snow.nh17",size:4980736},last:""},te;(function(){"serviceWorker"in navigator?(console.log("CLIENT: service worker registration in progress."),navigator.serviceWorker.register("/sworker.js").then(function(d){console.log("CLIENT: service worker registration complete.")},function(d){T(d);console.log("CLIENT: service worker registration failure.")}),navigator.serviceWorker.oncontrollerchange=
function(){console.log("page controlled by:",navigator.serviceWorker.controller);location.reload(!0)}):console.log("CLIENT: service worker is not supported.")})();var qc,Jd,Xf,Mc,Yf,Oh,ue,jk,ve,kk,lk,L,Zf,we,Aa,Ph,Ra,pa,Nf={},Mh="ts1.mp3 ts2.mp3 ts3.mp3 ts4.mp3 ts5.mp3 ts6.mp3 ts7.mp3 ts8.mp3 ts9.mp3 ts10.mp3 sr1.mp3 sr2.mp3 sr3.mp3 sr4.mp3 sr5.mp3 sr6.mp3 sr7.mp3 sr8.mp3 sr9.mp3 sr10.mp3 1.mp3 2.mp3 3.mp3 4.mp3 5.mp3 6.mp3 7.mp3 8.mp3 9.mp3 10.mp3 INTRO.mp3 OUTRO.mp3 WIN1.mp3 WIN2.mp3 ATTACK.WAV BALLISTA.WAV BLDGDONE.WAV CHAT%20LOCATION.WAV TECHDONE.WAV UNITDONE.WAV CHAT.WAV E_CASTLE1.WAV E_CATHEDRAL1.WAV E_CATHEDRAL2.WAV E_FARM1.WAV E_CHURCH1.WAV E_FARM2.WAV E_HARBOR1.WAV E_LUMBER1.WAV E_MAGETOWER1.WAV E_MAGETOWER2.WAV E_MAGETOWER3.WAV E_MARKET1.WAV E_SHIPYARD1.WAV E_STABLES1.WAV E_STORAGE1.WAV E_OUTPOST1.WAV E_STORAGE2.WAV E_TAVERN1.WAV E_WARACADEMY1.WAV E_WORKSHOP1.WAV EVILCASTLE.WAV GATE1.WAV GATE2.WAV GATE3.WAV GATE4.WAV GATE5.WAV GATE6.WAV GATEWAY.WAV HOUSE1.WAV HOUSE2.WAV HOUSE3.WAV HOUSE4.WAV HOUSE5.WAV MERCHANT.WAV MINE1.WAV MONASTERY1.WAV MONASTERY2.WAV R_CATHEDRAL1.WAV R_CHURCH1.WAV SHAOLIN2.WAV SHAOLIN.WAV CHOP%201.WAV CHOP%202.WAV CHOP%203.WAV CHOP%204.WAV CHOP%205.WAV CHOP%206.WAV CHOP%207.WAV CHOP%208.WAV CHOP%209.WAV CHOP%2010.WAV CHOP%2011.WAV DIG%201.WAV DIG%202.WAV DIG%203.WAV MINE%201.WAV MINE%202.WAV MINE%203.WAV HIT%201.WAV HIT%202.WAV HIT%203.WAV HIT%204.WAV HIT%205.WAV HIT%206.WAV HIT%207.WAV GHOST1.WAV GHOST2.WAV GOLEM1.WAV GOLEM2.WAV H%20SWORD%201.WAV H%20SWORD%202.WAV H%20SWORD%203.WAV H%20SWORD%204.WAV H%20SWORD%205.WAV H%20SWORD%206.WAV H%20SWORD%207.WAV H%20SWORD%207.WAV H%20SWORD%208.WAV H%20SWORD%209.WAV H%20SWORD%2010.WAV H%20SWORD%2011.WAV H%20SWORD%2012.WAV HAND1.WAV HAND2.WAV HAND3.WAV HAND4.WAV MAGE%20ATTACK.WAV MESSIAH.WAV ORC%20SWORD%201.WAV ORC%20SWORD%202.WAV ORC%20SWORD%203.WAV ORC%20SWORD%204.WAV ORC%20SWORD%205.WAV ORC%20SWORD%206.WAV ORC%20SWORD%20V1.WAV ORC%20SWORD%20V2.WAV ORC%20SWORD%20V3.WAV SHIP%20CANNON%201.WAV SHIP%20CANNON%202.WAV SHIP%20CANNON%203.WAV SHIP%20CANNON%204.WAV SHIP%20CANNON%205.WAV SHIP%20CANNON%206.WAV SHIP%20CANNON%207.WAV SIEGE.WAV SWORD%201.WAV SWORD%202.WAV SWORD%203.WAV SWORD%204.WAV SWORD%205.WAV SWORD%206.WAV SWORD%207.WAV SWORD%208.WAV SWORD%209.WAV SWORD%2010.WAV SWORD%2011.WAV SWORD%2012.WAV SWORD%2013.WAV SWORD%2014.WAV SWORD%2015.WAV SWORD%2016.WAV V%20SWORD%201.WAV V%20SWORD%202.WAV V%20SWORD%203.WAV V%20SWORD%204.WAV V%20SWORD%205.WAV V%20SWORD%206.WAV V%20SWORD%207.WAV ADRAGON2.WAV ADRAGON3.WAV ARROW%201.WAV ARROW%202.WAV ARROW%203.WAV ARROW%204.WAV ARROW%205.WAV ARROW%206.WAV ARROW%20V1.WAV ARROW%20V2.WAV ARROW%20V3.WAV ARROW%20V4.WAV BEAR1.WAV BEAR2.WAV BEAR3.WAV BEAR4.WAV BEAR5.WAV MWORKSHOP.WAV DESTROY%20BUILDING.WAV DESTROY%20MINE.WAV LIGHTING2.WAV LIGHTING.WAV METEOR.WAV SMALL%20EXPLOSION.WAV WATER%20BLOP.WAV SPY%20KILL%201.WAV SPY%20KILL%203.WAV SPY%20KILL%202.WAV PRIEST%20ATTACK.WAV LIGHTNING.WAV INVISIBLE.WAV HEAL.WAV FREEZE.WAV FLAME%20BALL.WAV CURSE.WAV CRUSADE.WAV CONFUSION.WAV BLESS.WAV WHIRLPOOL.WAV TURN%20TO%20STONE.WAV TEACH.WAV SUMMON10.WAV SUMMON9.WAV SUMMON8.WAV SUMMON7.WAV SUMMON6.WAV SUMMON5.WAV SUMMON4.WAV SUMMON3.WAV SUMMON2.WAV SUMMON1.WAV REVEAL.WAV RESSURECT.WAV COWDIE1.WAV COWDIE2.WAV COWDIE1.WAV COWDIE3.WAV COWDIE4.WAV DIE%201.WAV DIE%202.WAV DIE%203.WAV DIE%204.WAV DIE%205.WAV DIE%206.WAV DIE%207.WAV DIE%208.WAV DIE%209.WAV DIE%2010.WAV DRAGON%20DIE%201.WAV DRAGON%20DIE%202.WAV GHOST1.WAV GHOST2.WAV GOLEM.WAV H%20DIE%201.WAV H%20DIE%202.WAV H%20DIE%203.WAV H%20DIE%204.WAV H%20DIE%205.WAV H%20DIE%206.WAV H%20DIE%207.WAV H%20DIE%208.WAV H%20DIE%209.WAV H%20DIE%2010.WAV MAGE.WAV ORC%20DIE%201.WAV ORC%20DIE%202.WAV SHIP%20SINK.WAV SIEGE%20DIE%201.WAV SIEGE%20DIE%202.WAV SIEGE%20DIE%203.WAV SIEGE%20DIE%204.WAV SKELETON%20DIE%201.WAV SKELETON%20DIE%202.WAV SKELETON%20DIE%203.WAV SKELETON%20DIE%204.WAV MESSIAH_ATTACK.WAV C%20DIE%201.WAV C%20DIE%202.WAV C%20DIE%203.WAV C%20DIE%204.WAV C%20DIE%205.WAV CAMELDIE1.WAV CAMELDIE2.WAV CAMELDIE3.WAV BAT%20ATTACK.WAV BAT%20CMD.WAV BAT%20DIE.WAV".split(" "),
mk,me,ne,Qh=function(){if(!qc){K.prototype.loadBuffer=function(b,d){var f=new XMLHttpRequest;f.open("GET",e+b,!0);f.responseType="arraybuffer";f.setRequestHeader("Content-type"," text / plain; charset = dropbox - cors - hack");var c=this;f.onreadystatechange=function(){4===f.readyState&&200===f.status&&c.context.decodeAudioData(f.response).then(function(e){e&&ka(e,b,d)})};f.send()};for(var d=0,b=Mh.length;d<b;d++){var f=Mh[d];Nf[f.split(".")[0].toLowerCase()]=f}Jd="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206 arrow%20v1 arrow%20v2 arrow%20v3 arrow%20v4".split(" ");
Xf="arrow%201 arrow%202 arrow%203 arrow%204 arrow%205 arrow%206".split(" ");Mc="sword%201 sword%202 sword%203 sword%204 sword%205 sword%206 sword%207 sword%208 sword%209 sword%2010 sword%2011 sword%2012 sword%2013 sword%2014 sword%2015 sword%2016 v%20sword%201 v%20sword%202 v%20sword%203 v%20sword%204 v%20sword%205 v%20sword%206 v%20sword%207".split(" ");Yf=["siege"];Oh=["hand1","hand2","hand3","hand4"];ue="h%20sword%201 h%20sword%202 h%20sword%203 h%20sword%204 h%20sword%205 h%20sword%206 h%20sword%207 h%20sword%208 h%20sword%209 h%20sword%2010 h%20sword%2011 h%20sword%2012".split(" ");
jk=["ork%20sword%20v1","ork%20sword%20v2","ork%20sword%20v3"];ve="ship%20cannon%201 ship%20cannon%202 ship%20cannon%203 ship%20cannon%204 ship%20cannon%205 ship%20cannon%206 ship%20cannon%207".split(" ");kk=["ghost%201","ghost%202"];lk=["mage%20attack"];L=["destroy%20building"];Zf=["siege%20die%201","siege%20die%202","siege%20die%203","siege%20die%204"];we="h%20die%201 h%20die%202 h%20die%203 h%20die%204 h%20die%205 h%20die%206 h%20die%207 h%20die%208 h%20die%209 h%20die%2010".split(" ");Aa="die%201 die%202 die%203 die%204 die%205 die%206 die%207 die%208 die%209 die%2010".split(" ");
Ph=["e_barrack1"];var e=x.cdn;"undefined"!==typeof AudioContext&&(window.AudioContext=window.AudioContext||window.webkitAudioContext,qc=new AudioContext,me=qc.createGain(),ne=qc.createGain(),mk=new K(qc,void 0,ka),T("Sound: OK"),me.gain.value=parseInt(localStorage.musicRange)/100,ne.gain.value=parseInt(localStorage.soundRange)/100);Ra=function(){if(!p.editor){Ra.id++;q("musicSelect")&&(localStorage.favMusic=q("musicSelect").mversion.value);var b=Ra.list[localStorage.favMusic];b&&pa(b[~~(b.length*
Math.random())],0,0,void 0,1,0,Ra.id)}};Ra.reset=function(){Ra.stop();Ra()};Ra.stop=function(){Ra.active&&(Ra.active.stop(),clearTimeout(Ra.intv))};Ra.id=0;Ra.list={originalMusic1:[1,2,3,4,5,6,7,8,9,10,"outro"],originalMusic:"ts1 ts2 ts3 ts4 ts5 ts6 ts7 ts8 ts9 ts10".split(" "),sharpRain:"sr1 sr2 sr3 sr4 sr5 sr6 sr7 sr8 sr9 sr10".split(" ")};pa=function(b,d,e,f,c,l,y){var h=b;if((b=Nf[b])&&"loading"!==b&&!p.canceled){var g=-Db+(window.innerWidth-x.mx)/2,k=-Ka+window.innerHeight/2;if(b.duration){if(p.started)if(64<
p.now()-b.lastPlayed||!b.lastPlayed)b.lastPlayed=p.now();else return;if(!(!c&&"attack"!=h&&l&&600<Date.now()-l)){if(d){d=-g+32*d;e=-k+32*e;k=Z;if(d*d+e*e>Math.pow(2E3,2))return!1;d/=80;e/=80;k/=8}else k=e=d=0;void 0!==f&&f!==x.kingdom||p.mute||(f=qc.createBufferSource(),f.buffer=b,c?(f.connect(me),me.connect(qc.destination),Ra.active=f,Ra.intv=setTimeout(Ra,~~(1E3*b.duration)+1E3)):(b=qc.createPanner(),b.panningModel="HRTF",b.setPosition(d,e,k),f.connect(b),b.connect(ne),ne.connect(qc.destination)),
f.start(0))}}else Nf[h]="loading",c={x:d,y:e,k:f,music:c,date:Date.now(),mid:y},mk.loadBuffer(b,c)}}}},xe=function(d,b,f,e){d.img===e.url&&(pa(b+~~(Math.random()*f+1),d.x32,d.y32),setTimeout(xe,nb(e),d,b,f,e))};"use strict";var Qm=function(d){for(var b=[],f=0,e=[d.icons],c=0,g=e.length;c<g;c++)for(var k=e[c],n=0,u=k.length;n<u;n++)if(k[n]){var l=k[n];l.doneBy||(l.doneBy=[]);l.doneBy.put(d);b[f++]=l;l.xtra&&(e.put(l.xtra),g++)}d.habilities=b},Rm=function(d,b){return b.balanceTotal-d.balanceTotal},
Rh=function(d,b){var f=d.slice(0),e={};e[b]=Infinity;for(var c=f.length,g=0;g<c;g++){var k=e;for(var n=0;n<c;n++)if(f[n]&&f[n][b]<k[b]){k=f[n];var u=n}k==e&&(k=void 0);d[g]=k;f[u]=e}return d},$f=function(d,b){if(!d.url.attack||d.attackOnly&&!d.attackOnly[b.type])return 0;var f=25*~~(nb(d.url.attack)/25);d=d.attack*((ye[d.type][b.type]||0)+1);d-=b.defence;1>d&&(d=1);return~~(b.health/d)*f},Oa=function(d){this.kingdom=d.k;this.aggressive=this.perfection=1;this.cantBuild={};this.houseLoading=0;this.mineGroup=
{};d.IAD=Oa.arr.length;Oa.arr.put(this)};Oa.prototype.valorateLost=function(d){this.script&&this.script.put({order:d.nu,obj:d,priority:1})};var Sh=function(d,b,f,e,c){var h=f.obj.cost;e[0]+=h[0];e[1]+=h[1];e[2]+=h[2];e[3]+=h[3];d[d.length]={order:f,priority:b.priority,name:f.obj.name,obj:f.obj,pTime:b.obj.time,required:1,doner:c};d.changed=!0},Th=function(d,b,f,e){var c=[d],g=[],k={},n=e.target;g.put(d);for(var u=0;u<c.length;u++){var l=c[u];l.availables&&(l.availables=void 0);if((d=l.order)&&!k[l.order.id]){k[l.order.id]=
1;var y=d.requireObj;if(y)for(var r=0,m=y.length;r<m;r++)if(d=y[r],d.tech)b[d.nu.id]||Sh(c,l,d.nu,n);else{var p=f[d.type];p.length||Sh(c,l,d.nu,n)}if(y=d.doneBy)for(r=0,m=y.length;r<m;r++)d=y[r],p=f[d.type],p.length||d.race!=e.racestr||Sh(c,l,d.nu,n,1);u&&!l.doner&&g.put(l)}}return g},Uh={food:2,wood:1,gold:0,stone:3},rc=function(d,b){d=d.order;var f=d.obj,e=rc.tech;f.build?e=rc.build:f.tech||(e=rc.unit);return e(d,b)};rc.unit=function(d,b){d=d.doneBy;if(b.pop<b.popMax)for(var f=0,e=d.length;f<e;f++)for(var c=
b[d[f].type],g=0,k=c.length;g<k;g++){var n=c[g];if(n.free)return[n]}return!1};rc.tech=function(d,b){d=d.doneBy;for(var f=0,e=d.length;f<e;f++)for(var c=b[d[f].type],g=0,k=c.length;g<k;g++){var n=c[g];if(n.free)return[n]}return!1};rc.build=function(d,b,f){d=d.doneBy;f=0;for(var e=d.length;f<e;f++)for(var c=b[d[f].type],g=0,k=c.length;g<k;g++){var n=c[g];if(n.free)return[n]}return!1};rc.sPeasant=function(d){for(var b=[10,79,64],f=[],e=0,c=0,g=b.length;c<g;c++)for(var k=d[b[c]],n=0,u=k.length;n<u;n++)k[n].free&&
(f[e++]=k[n]);return f};var Nc=function(d,b,f){if(d){d=d.order;var e=d.obj,c=Nc.unit;e.tech?c=Nc.tech:e.build&&(c=Nc.build);return c(d,b,f)}};Nc.build=function(d,b,f){var e=Oa.arr[b.IAD];if(4<=e.cantBuild[d.obj.type]&&b.stats.buildsLosed==e.buildsLosed)return!1;for(var c=[],g=d.doneBy,k=va[b.k],n=0,u=g.length;n<u;n++)for(var l=k[g[n].type],y=0,r=l.length;y<r;y++){var m=w[l[y]];if(!m.func&&!m.in||f){c.put(m.id);break}}if(!c.length)return!1;f=G;m=d.obj;d=b.origin[0];g=b.origin[1];k=g-1;n=d-1;u=Oa.arr[b.IAD].reserved;
if(l=u.added[m.type]){y=m.space;var p=m.rbase(),q=l%f,t=~~(l/f),v=y[y.length-1];r=(y.length-1)/v*v;for(y=0;y<r&&!p(q+y%v+(~~(y/v)+t)*f);y++);if(y==r)for(u.added[m.type]=!1,y=0;y<r;y++)u[q+y%v+(~~(y/v)+t)*f]=0;else l=-1}else l=-1;0>l&&(l=ag(d,g,80,k,n,b,m,900));if(0>l)return e.cantBuild[m.type]||(e.cantBuild[m.type]=0),e.cantBuild[m.type]++,e.buildsLosed=b.stats.buildsLosed,!1;e.cantBuild[m.type]&&(e.cantBuild[m.type]=0);I(sc,[l,m.type],c);return!0};var ag=function(d,b,f,e,c,g,k,n){var h=Oa.arr[g.IAD].reserved,
l=G,y=k.space;k=k.validator.check;if(!k)return-1;for(var r=-1,m=f/2*(f/2),p=1,q=d,t=b;0>r&&d-q<f/2;){--q;--t;for(var w=2*p+1,v=2*p+1,x=0,A=w*v;x<A;x++){var z=x%w,B=~~(x/w);if(!z||!B||z==w-1||B==v-1){z+=q;B+=t;var E=(z-d)*(z-d)+(B-b)*(B-b);if(E<m&&k(z,B,y,e,c,E<n,g.k,h)){r=z+B*l;break}}}p++}return r};Nc.tech=function(d,b,f){f=d.doneBy;b=va[b.k];for(var e=[],c=0,g=f.length;c<g;c++)for(var k=b[f[c].type],n=0,u=k.length;n<u;n++){var l=w[k[n]];l.working||l.techStart||!l.built||e.put(l.id)}if(!e.length)return!1;
I(bg,[d.obj.id,d.id],e[0]);return!0};Nc.unit=function(d,b,f){f=d.doneBy;b=va[b.k];for(var e=[],c=0,g=f.length;c<g;c++)for(var k=b[f[c].type],n=0,u=k.length;n<u;n++){var l=w[k[n]];l.working||l.techStart||!1===l.built||e.put(l.id)}if(!e.length)return!1;I(ze,[d.obj.type,1,0],e[0]);return!0};Oa.prototype.leaveMeAloneIKnowWhatToDo=function(){performance.now();var d=E[this.kingdom],b=d.resources,f=va[this.kingdom],e=G;if(d.origin){var c=d.origin[0],g=d.origin[1],k=d.race+"-"+b[0]+""+b[1]+""+b[2]+""+b[3];
if(Oa.precooked[k])aa=Oa.precooked[k].slice(0);else{for(var n=g-1,u=c-1,l=c-40,y=g-40,r=0,m=-1,q=6400,t=0;t<q;t++){var v=t%80+l,x=~~(t/80)+y;1600>(c-v)*(c-v)+(g-x)*(g-x)&&(!(v>=u&&v<=u+2)||x>=n&&x<=n+2)&&0===Y[v+x*e]&&ia(v,x)&&r++}var A=[];performance.now();for(var z=0,C=0,H=B.length;C<H;C++){var I=B[C];if(!I.build&&!I.item&&!I.boat&&I.url.attack&&I.race==d.racestr&&8!=I.type&&void 0==I.res){A.put(I);I.balanceSum=0;I.bestBalance=-1;I.balanceDefence={};for(var J=Infinity,M=I.attDist,K=0;K<H;K++){var L=
B[K];if(!L.build&&!L.item&&!L.boat&&L.race==d.racestr&&L.url.attack&&8!=L.type&&void 0==I.res&&(z=$f(L,I))){var Q=$f(I,L);Q&&(z-=Q,z+=2E3*M,z<J&&(J=z,I.bestBalance=L),I.balanceSum+=z)}}I.balanceTotal=I.balanceSum}}A.sort(Rm);I=A[0];for(var S=1E3,O={},P=[],W=0,V=S;!O[I.type];)O[I.type]=1,P[W++]=I,P[W++]=S,L=I.bestBalance,S=~~(S*$f(L,I)/$f(I,L)+.5),V+=S,I=L;P.nu=V-S;T(P);for(var ba=d.target,Z=F,ea=Z.length,ja=[],ma=0;ma<ea;ma++){var da=Z[ma],ca;if(!(ca=!da.type||da.upgrade||da.type==X||void 0!==Uh[da.value]&&
d.resources[da.value]>=ba[da.value])){a:{for(var oa=da.nu.doneBy,la=0,ka=oa.length;la<ka;la++)if(oa[la].race==d.racestr){var ta=!0;break a}ta=!1}ca=!ta}ca||ja.put({order:da.nu,obj:da,original:1,priority:1E-10})}var N=[];t=0;q=P.length;for(var ra=P.nu;t<q;t+=2){var ya=~~(.5+P[t+1]/ra*250)-f[P[t].type].length,U=P[t],na=U.type;U=U.nu;for(var ha=0;ha<ya;ha++)ja.put({order:U,priority:1-ha/ya,obj:U.obj,original:1})}var wa=0,Ea=0,pa=d.target,Ca={};Ea++;pa[0]=0;pa[1]=0;pa[2]=0;pa[3]=0;t=wa=N.length=0;for(q=
ja.length;t<q;t++){var qa=ja[t].priority,ua=Th(ja[t],d.technology.investigated,f,d);ha=0;for(var Ja=ua.length;ha<Ja;ha++){U=ua[ha];U.original||(U.priority=qa);var Da=1;void 0!==U.priority&&(Da=U.priority);var Ta=U.obj;Ta.increase&&void 0!==Uh[Ta.value]&&(Da=Ta.increase*Da/b[Uh[Ta.value]]);Da/=Ta.time;U.priority=Da;if(!(0>=U.priority)){var Pa=U.order.id;!Ca[Pa]||U.original?(Ca[Pa]=wa,N[wa++]=U):N[Ca[Pa]].priority+=U.priority}}}var Na=!1;Rh(N,"priority");var Va={},Ra={},oc={},aa=[],ub=B.length;for(t=
0;t<ub;oc[t++]=0);for(t=0;t<N.length;t++){var gb=N[t];U=gb.order;var Fa=gb.obj;if(gb.original||gb.required)gb.obj.tech||oc[gb.obj.type]++,aa.put(gb);var Ia=U.doneBy,Ya=Fa.time;ha=0;for(q=Ia.length;ha<q;ha++){var sb=Ia[ha],La=sb.time;if(sb.race===d.racestr){if(Fa){for(var Ga=sb,eb=f[sb.type],mb=Oa.process,vb=Ya,xb=eb.length,sa=!1,ab=Infinity,Ma=0;Ma<xb;Ma++){var lb=w[eb[Ma]],xa=0;lb.build&&(lb.working||lb.techStart||!lb.built)&&(lb.built?(xa=(lb.c-p.cycle)*Oc.speed,xa/=1E3):(xa=lb.time*(lb.maxHealth-
lb.health)/lb.maxHealth,lb.workers&&lb.workers.length&&(xa/=lb.workers.length)));lb.build||!lb.func&&!lb.in||(xa=Infinity);lb.nato!=mb?(lb.nato=mb,lb.natoTime=0):xa+=lb.natoTime;xa<ab&&(ab=xa,sa=lb)}sa&&ab<=Ga.time?(sa.natoTime+=vb,Na=sa):Na=!1}if(!Na){Va[sb.type]||(Va[sb.type]=[],Ra[sb.type]=[]);var Wa=Va[sb.type],bb=Ra[sb.type];oc[sb.type]||(oc[sb.type]=0);var cb=!1,ec=0;for(Ja=Wa.length+1;ec<Ja;ec++){if(void 0==Wa[ec]){var fb={order:sb.nu,priority:0,obj:sb};N.put(fb);aa.put(fb);Wa[ec]=0;bb[ec]=
fb;oc[sb.type]++;cb=!0}if(Wa[ec]+Ya<=La||cb){Wa[ec]+=Ya;bb[ec].priority+=gb.priority;break}}}}}}Rh(aa,"priority");var nb=0;t=0;for(q=aa.length;t<q;t++)if(gb=aa[t].obj,gb.build){var Sa=gb.space[gb.space.length-1]+2,tb=(gb.space.length-1)/Sa+2;nb+=Sa*tb}T(nb,r);if(nb>r){var Kb=r/nb*.7;t=0;for(q=B.length;t<q;t++)B[t].build&&(gb=oc[t])&&((gb=~~(gb*Kb))||(gb=1),oc[t]=gb)}t=0;for(q=aa.length;t<q;t++)gb=aa[t].obj,gb.build&&(oc[gb.type]?oc[gb.type]--:aa[t]=0);for(var Za=aa,Ha=new Uint32Array(14),Aa=new Uint32Array(7),
yb=new Uint32Array(7),Ba=new Uint32Array(7),Nb=6.25,zb=d.resources,Db=[Aa,Ba,Ha,yb],za=0,Ka=0,Cb=0;3>Cb;Cb++){var ib=zb[0],Ua=zb[1],Qa=zb[2],Xa=zb[3];Infinity==ib&&Infinity==Ua&&Infinity==Qa&&Infinity==Xa&&(Nb=-1);var Qb=0,Ib=0,Jb=0,Eb=0;za=0;for(Ka=Za.length;za<Ka;za++)if(Za[za]){var qb=Za[za].obj.cost;Qb+=qb[0];Ib+=qb[1];Jb+=qb[2];Eb+=qb[3]}if(Cb){for(za=0;za<Ha.length;Ha[za++]=0);for(za=0;za<Aa.length;Aa[za++]=0);for(za=0;za<yb.length;yb[za++]=0);for(za=0;za<Ba.length;Ba[za++]=0);}var Bb=[],Pb=
{},Lb={},jb={pop:0,popMax:2E3},Gb=[[]];za=0;for(Ka=f.length;za<Ka;za++){hb=f[za];var Mb=[];jb[za]=Mb;for(var db=0,Ob=hb.length;db<Ob;db++)Mb[db]={free:1,type:za}}for(var ob=0;9E3>ob;){var Zb=10*cg(Aa)/7,$b=10*cg(Ba)/7,Tb=10*cg(Ha)/14,ac=10*cg(yb)/7;ib+=10*Aa[ob%Aa.length];Ua+=10*Ba[ob%Ba.length];Qa+=10*Ha[ob%Ha.length];Xa+=10*yb[ob%yb.length];var Fb=Gb[ob];if(Fb)for(za=0,Ka=Fb.length;za<Ka;za++){var rb=Fb[za],$a=rb.list;db=0;for(Ob=$a.length;db<Ob;db++){var hb=$a[db];hb.used||(hb.used=!0,Bb.put(hb.action));
hb.free=1}var cc=rb.action&&(rb.action.original||rb.action.required)?!0:!1;if(rb.obj.tech){Pb[rb.obj.nu.id]=1;var Wb=rb.obj;"popLimit"==Wb.value&&(jb.popMax+=Wb.increase)}else rb.obj.build||jb.pop++,jb[rb.obj.type].put({free:1,type:rb.obj.type,action:rb.action,used:cc})}za=0;for(Ka=Za.length;za<Ka;za++)if(hb=Za[za]){var Xb=hb.obj;if(Xb.peon||!(Tb<Nb)){var kb=Xb.cost;if(!(kb[0]>ib||kb[1]>Ua||kb[2]>Qa||kb[3]>Xa)&&1===Th(hb,Pb,jb,d).length&&($a=rc(hb,jb))){var Hb=hb.obj.time+ob;Gb[Hb]||(Gb[Hb]=[]);if(hb.obj.tech){if(Lb[hb.order.id])continue;
Lb[hb.order.id]=1}Za[za]=void 0;(hb.original||hb.required)&&Bb.put(hb);for(var Yb=0;Yb<$a.length;$a[Yb++].free=0);Gb[Hb].put({list:$a,obj:hb.obj,action:hb});ib-=kb[0];Ua-=kb[1];Qa-=kb[2];Xa-=kb[3]}}}$a=rc.sPeasant(jb);za=0;for(Ka=$a.length;za<Ka;za++){var Rb=nk(Zb,$b,Tb,ac,ib,Ua,Qa,Xa,Qb,Ib,Jb,Eb);if(0>Rb)break;2===Rb&&(Ua-=200);Db[Rb][ob%Db[Rb].length]++;hb=$a[za];hb.free=0;hb.used||(hb.used=!0,Bb.put(hb.action))}ob++}Za=Bb;Rh(Za,"priority")}for(var Ab=aa=Za,pb={},wb=0;wb<Ab.length;wb++)Ab[wb]&&
!Ab[wb].obj.tech&&(pb[Ab[wb].obj.name]||(pb[Ab[wb].obj.name]=0),pb[Ab[wb].obj.name]++,"Blacksmith"==Ab[wb].obj.name&&T(Ab[wb]));T(pb);Oa.precooked[k]=aa}this.script=aa;var Ub={},bc={added:Ub};this.reserved=bc;t=0;for(q=aa.length;t<q;t++)if((U=aa[t])&&(Fa=U.obj)&&Fa.build&&void 0==Ub[Fa.type]&&(m=ag(c,g,80,n,u,d,Fa,900),-1<m)){v=m%e;x=~~(m/e);na=Fa.type;Ub[Fa.type]=m;var Vb=Fa.space;Sa=Vb[Vb.length-1];tb=(Vb.length-1)/Sa;var dc=Sa*tb;for(ha=0;ha<dc;ha++)bc[v+ha%Sa+(~~(ha/Sa)+x)*e]=na}}};var cg=function(d){for(var b=
0,f=d.length,e=0;e<f;b+=d[e++]);return b},nk=function(d,b,f,e,c,g,k,n,u,l,y,r){if(Infinity==c&&Infinity==g&&Infinity==k&&Infinity==n)return-1;if(6.25>f)return 200>g?1:2;c=u+r+y+l;g=d+b+f+e;d/=u/c*g;b/=l/c*g;f/=y/c*g;e/=r/c*g;return d<b&&d<f&&d<e?0:b<f&&b<e?1:f<e?2:3},Vh=function(){for(var d=0,b=Oa.arr,f=b.length;d<f;b[d++].maintenance());Ya({func:Vh},Oa.time,1);Oa.process++},ok=function(d,b,f){for(var e=d.length,c=Infinity,g=0,k=0;k<e;k++){var n=w[d[k]],u=Math.pow(b-n.x32,2)+Math.pow(f-n.y32,2);u<
c&&(c=u,g=n.id)}return g};Oa.prototype.maintenance=function(){var d=this.script;if(d){var b=E[this.kingdom];if(b.origin){p.blocked=!0;var f=b.technology.investigated,e=va[b.k],h=G,g={};if(b.values.pop+b.unitLoading+5>b.values.popMax&&b.values.popMax<=b.values.popLimit){for(var k=tb[b.race].house.nu,n=0,u=0,l=b.building,y=l.length;u<y;u++){var r=w[l[u]];r.population&&(n+=r.population)}b.values.pop+b.unitLoading+5>b.values.popMax+n&&Nc({order:k,priority:1,obj:k.obj},b,!0)}l=b.resources;k=l[0];n=l[1];
var m=l[2],q=l[3],t=[];if(Infinity!=k||Infinity!=n||Infinity!=m||Infinity!=q){r=0==b.race?c.createPeon.obj:1==b.race?c.createPeon2.obj:c.createPeon1.obj;var v=0,x=0,z=0,F=0;u=0;for(y=d.length;u<y;u++)if(d[u]){var C=d[u].obj.cost;v+=C[0];x+=C[1];z+=C[2];F+=C[3]}var H=C=0,J=0,L=0,M=e[r.type];u=0;for(y=M.length;u<y;u++)if(r=w[M[u]],40==r.func)21==w[r.funcObj.u].type?C+=10/7:L+=10/7;else if(43==r.func)J+=10/14;else if(42==r.func)H+=10/7;else{if(19==r.func&&r.stock){var K=r.stock[1];0==K?C+=10/7:1==K?
H+=10/7:2==K?J+=10/14:L+=10/7}(19!=r.func||r.action)&&r.func||t.put(r)}}u=0;for(y=d.length;u<y;u++)!(r=d[u])||!r.order||g[r.order.id]||6.25>J&&!r.obj.peon||(M=Th(r,f,e,b).length,K=r.obj.cost,K[0]>l[0]||K[1]>l[1]||K[2]>l[2]||K[3]>l[3]||1===M&&(Nc(r,b)?d[u]=0:g[r.order.id]=1));if(t.length)for(d=-Infinity,u=0,l=b.building,y=l.length;u<y;u++){r=w[l[u]];if(r.population)break;r=r.time*(1-r.health/r.maxHealth);r>d&&(d=r)}u=0;for(y=t.length;u<y;u++)if(r=t[u],l=nk(C,H,J,L,k,n,m,q,v,x,z,F),0==l)(l=ok(va[0][21],
r.x32,r.y32))&&pk(l,r,this,b);else if(1==l)qk(r);else if(2==l){a:{l=e[20];d=l.length;for(f=0;f<d;f++)if(g=w[l[f]],!g.workers.length&&14E3<25*(p.cycle-g.lastUse)){g.lastUse=p.cycle+100;l=g;break a}l=void 0}if(l)I(tc,l.id,[r.id]);else{M=va[b.k];l=G;K=ob[2];d=[];d.length=K.length;f=0;for(g=K.length;f<g;d[f]=M[K[f++]]);M=Infinity;K=B[20].space;var S=-1;f=0;for(g=d.length;f<g;f++)for(var Q=d[f],T=0,P=Q.length;T<P;T++){var O=w[Q[T]],W=O.x32-10,Y=O.y32-10,U=O.space[O.space.length-1],V=O.x32+.5*U;O=O.y32+
.5*(O.space.length-1)/U;for(U=0;400>U;U++){var X=U%20,Z=~~(U/20);X+=W;Z+=Y;var ba=(X+1-V)*(X+1-V)+(Z+1-O)*(Z+1-O);ba<M&&Wh(X,Z,K)[1]&&(S=X+Z*l,M=ba)}}l=S;-1<l&&(I(sc,[l,20],[r.id]),n-=200)}}else 3==l&&(l=ok(va[0][22],r.x32,r.y32))&&pk(l,r,this,b);e=!1;F=Infinity;J=b.diplomacy;x=b.origin[0];z=b.origin[1];v=va[b.k];u=1;for(y=E.length;u<y;u++)J[u]&&!E[u].death&&E[u].origin&&(r=E[u],C=r.origin[0]-x,H=r.origin[1]-z,b=C*C+H*H,b<F&&(F=b,e=r));if(e){b=[];u=C=0;for(y=v.length;u<y;u++)for(H=v[u],F=0,J=H.length;F<
J;F++)r=w[H[F]],void 0!=r.func||r.standardFunc!=A||r.death||r.build||(b[C++]=r.id);if(60<b.length){r=e.origin[0];v=e.origin[1];l=[40,0,-40,0,0,40,0,-40];F=Infinity;u=0;for(y=l.length;u<y;u+=2)if(C=l[u],H=l[u+1],C+=x+10*Math.sign(C),H+=z+10*Math.sign(H),(C-r)*(C-r)+(v-H)*(v-H)<F&&ia(C,H)){F=(C-r)*(C-r)+(v-H)*(v-H);var da=C+H*h}y=da%h;x=~~(da/h);z=-1;C=Infinity;v=va[e.k];u=0;for(length=v.length;u<length;u++)for(e=v[u],F=0,H=e.length;F<H;F++)r=w[e[F]],J=(r.x32-y)*(r.x32-y)+(r.y32-x)*(r.y32-x),J<C&&(C=
J,z=r.x32+r.y32*h);-1<z&&I(Xh,[da,z],b)}}p.blocked=!1}}};var pk=function(d,b,f,e){var c=tb[b.race].storage,g=w[d],k=w[f.mineGroup[d]];!k&&e.paypalTest(c.cost)?(g=ag(g.x32+2,g.y32+2,20,0,0,e,c,0),-1<g&&I(sc,[g,c.type],[b.id]),f.mineGroup[d]=e.building[e.building.length-1]):k&&!1===k.built?I(uc,k.id,[b.id]):I(tc,d,[b.id])},qk=function(d){for(var b=E[d.kingdom],f=va[b.k],e=ob[1],c=0,g=e.length;c<g;c++)for(var k=f[e[c]],n=0,u=k.length;n<u;n++){var l=w[k[n]];if(!l.castle){if(!1===l.built)return I(uc,l.id,
[d.id]);if(l=rk(l.x32,l.y32,.075))return I(tc,l,[d.id])}}k=b.building;c=0;for(g=k.length;c<g;c++)if(l=w[k[c]],1===l.storage)return I(uc,l.id,[d.id]);f=tb[d.race].lumbermill;e=b.origin[0];k=b.origin[1];c=1;g=b.resources;n=f.cost;if(n[0]<g[0]&&n[1]<g[1]&&n[2]<g[2]&&n[3]<g[3])for(;80>c;){--e;--k;u=2*c+1;l=2*c+1;n=0;for(g=u*l;n<g;n++){var y=n%u,r=~~(n/u);if(!y||!r||y==u-1||r==l-1)if(y+=e,r+=k,-1<rk(y,r,.15,!0)&&(y=ag(y,r,8,0,0,b,f,0),-1<y))return I(sc,[y,f.type],[d.id])}c++}b=va[0][7];c=b.length;g=Infinity;
for(f=n=0;f<c;f++)e=w[b[f]],k=Math.pow(d.x32-e.x32,2)+Math.pow(d.y32-e.y32,2),k<g&&(g=k,n=e.id);(b=n)&&I(tc,b,[d.id])},rk=function(d,b,f,e){var c=G,g=d,k=b;d-=5;b-=5;for(var n=0,u=-1,l=Infinity,y=0;100>y;y++){var r=y%10,m=~~(y/10);r+=d;m+=b;if(ia(r,m)){var p=w[Y[r+m*c]];if(e&&1==p.storage)return-1;7===p.type&&(n++,r=Math.pow(r-g,2)+Math.pow(m-k,2),r<l&&(l=r,u=p.id))}}if(n/100>=f)return u},Xh=function(d,b){var f=G,e=d[0];d=d[1];var c=d%f;f=~~(d/f);for(var g=0,k=b.length;g<k;g++){var n=w[b[g]];6400<
(n.x32-c)*(n.x32-c)+(n.y32-f)*(n.y32-f)?U(-e,n,Ae,n.url.move):U(-d,n,Ae,n.url.move)}dg(!1,b);Ya({func:sk,data:{list:b,xy:-d}},3E4,1)},sk=function(d){var b=d.list;d=d.xy;for(var f=0,e=b.length;f<e;f++){var c=w[b[f]];c.death||U(d,c,Ae,c.url.move)}},Yh=function(d){var b=d.x32+d.y32*G,f=E[d.kingdom].diplomacy;!d.invisible&&kc[b]&&(b=w[kc[b]],!b.freezed&&f[b.kingdom]&&vc(d.id,[b.id],0,Kd))},Cd=function(d){var b=Zh(d.id);return b?(vc(b,[d.id],0,Kd),!0):!1},Zh=function(d,b){d=w[d];return Qb.radar(d.x32,
d.y32,d.sight,d.id)},Sm=function(d){d.setupINTV(tk,d.id,1E3)},tk=function(d){d=w[d];var b=d.free;b||(b=uk);var f=G,e=d.x32,c=d.y32,g=[];g.length=E.length;for(var k=g.length,n=0;n<k;g[n++]=0);n=0;for(var u=b.length;n<u;n+=2){var l=b[n]+e,m=b[n+1]+c;ia(l,m)&&(l=w[Y[l+m*f]],l.nocapture||l.build||g[l.kingdom]++)}f=b=0;for(n=1;n<k;n++)g[n]>b&&(f=n,b=g[n]);b&&d.kingdom!=f&&d.changeKingdom(f);Zb(d,1E3)},Of,Tm=[1,1],vk=function(){return 25*(Date.now()-p.loadDate+p.pausedTime+p.deltaTime)/Oc.speed},$b=function(d){if(!(d&&
p.online||$b.bySystem&&d))if(0===p.paused){p.paused=1;void 0!=Of&&clearInterval(Of);var b=p.now();p.pausedTime+=Date.now();d||($b.bySystem=1);p.now=function(){return b}}else p.pausedTime-=Date.now(),p.paused=0,$b.bySystem=0,d&&(q("alert").style.display="none"),Of=setInterval(Oc,Oc.speed),p.now=vk};$b.bySystem=0;$b.fast=!0;var Tb=function(d,b){var f=!1;if(1>d){d*=-1;var e=~~(d/ha),c=d%ha}else f=d;d=0;for(var g=b.length;d<g;d++){var k=w[b[d]];k.build||k.cow&&k.workers.length||f===k.id||k.freezed||k.in||
k.stoned||(k.action=null,k.distance=0,k.mv&&null!=k.xf?(f?(k.xf=f,k.yf=!0):(k.xf=c,k.yf=e),k.nodes=void 0):k.x32==c&&k.y32==e?k.stay():(k.dix=(c-k.x32)/Math.abs(c-k.x32),k.diy=(e-k.y32)/Math.abs(e-k.y32),f?(k.xf=f,k.yf=!0):(k.xf=c,k.yf=e),k.mv=!0,Qb.unitMovement(k.id,!0),k.setupINTV(Be,k.id,0),$h(k),k.action=null))}},$h=function(d){d.stock&&0!==d.stock[0]?(d.mimg=d.url[d.stock[4].url],d.stock[3]===Pc&&(d.mimg=d.url.milk)):d.mimg=d.url.move};Tb.cursor=7;Tb.allowPos=1;var Zb=function(d,b,f){b=~~(b/
25)+p.cycle;f=fd[b];f||(f=[],fd[b]=f);var e=f.length;d.c=b;f[e]=d.id;d.timestamp=p.now()},fd={},eg=function(d){var b=w[d[0]];if(!b.death){var f=d[1],e=d[2],c=d[3];b.cow&&"milk"==f&&b.workers&&b.workers.length||(b[f]+=E[b.kingdom].values[e],e=b[f+"Max"],b[f]>e&&2!==b.blocked&&(b[f]=e));"mana"==f&&(e=b.manaTask)&&e[2]<=b[f]&&(b.blockedAction(1),U(e[1],b,ac[e[0]],b.url.move),b.manaTask=void 0);O(b.id,1);Ya({func:eg,data:d},c,1)}},Ya=function(d,b,f){d.func.url||T(d.func);d.func=d.func.url;f&&(b=~~(b/
25)+p.cycle);f=ed[b];f||(f=[],ed[b]=f);f.put(d)},ed={},Be=function(d){d=w[d];var b=G,f=!1;d.waiting&&$h(d);var e=d.y32,c=d.x32;ai(1,d,"zone");var g=ac[d.action];Cb(d,32*e);var k=d.rbase(),n=k.write,u=c+e*b;Yh(d);if(d.id===k(u)){var l=d.size;if(2>l)n(u,d.radix);else for(var m=l*l,r=-b,p=0;p<m;p++){var q=p%l;0===q&&(r+=b);n(u+q+r,0)}}if(d.stop)return n(u,d.id),d.stay(),d.stop=void 0,0;if(d.kx||d.ky){var t=d.kx||0,v=d.ky||0;m=!1;if(0!==k(t+c+(v+e)*b))return d.aspettare()}else{g&&g.rev&&(m=g.rev(d))&&
(d.action=m[0],g=ac[d.action],d.xf=m[1],d.yf=!0);if(!0===d.yf){m=d.xf;var x=w[m];if(!x||x.death&&(!g||!g.available))return n(u,d.id),d.stay();p=!0;r=!1;if(g&&g.available){r=g.available(d,x);if(!1===r)return d.aspettare();if("kill"===r)return n(u,d.id),d.stay();if(55===r)return n(u,d.id);p=r[2]}else x.death||(r=Qc(x,d,50,d.radix));d.xf!==m&&(x=w[d.xf]);if(!x||x.death||x.in)return n(u,d.id),d.stay();if(!p&&(z+A*b===u||g))return d.aspettare();var z=r[0],A=r[1];if(g&&g.distance){var B=g.distance;B=0>
B?d.attDist:E[d.kingdom].values[B];r=bi(x,c,e);Ce(c,e,r%G,~~(r/G),B)&&(f=2)}d==x&&(f=2)}else{z=d.xf;A=d.yf;m=k(z+A*b);if(2<m&&(!g||g&&g.rev)){m=w[m];r=Qc(m,d,50,d.radix);if(!1===r)return n(u,d.id),d.stay();z=r[0];A=r[1]}g&&g.distance&&(B=g.distance,B=0>B?d.attDist:E[d.kingdom].values[B],Ce(c,e,z,A,B)&&(f=2))}m=z+A*b;r=z;p=A;if(!f){v=Qb.inspector71017(c,e,r,p,d.radix,d.zLevel);void 0!==v?(t=-c+v%b,v=-e+~~(v/b)):v=t=1;if(1<Math.abs(t)||1<Math.abs(v))return d.aspettare();if(k(c+t+(e+v)*b)!==d.radix||
!ia(c+t,e+v)){t=[c+1,e,c-1,e,c+1,e+1,c+1,e-1,c,e-1,c-1,e+1,c,e+1,c-1,e-1];v=G;q=Infinity;for(var F,C=0;C<t.length;C+=2)0===k(t[C]+t[C+1]*v)&&ia(t[C],t[C+1])&&q>=(t[C]-r)*(t[C]-r)+(t[C+1]-p)*(t[C+1]-p)&&(q=(t[C]-r)*(t[C]-r)+(t[C+1]-p)*(t[C+1]-p),F=C);r=[t[F],t[F+1]];t=r[0]-c;v=r[1]-e;t=0<t?1:0>t?-1:0;v=0<v?1:0>v?-1:0;if(k(c+t+(e+v)*b)!==d.radix||!ia(c+t,e+v))return d.aspettare()}}}if(u==m||f)if(n(c+e*b,d.id),d.x32=c,d.y32=e,g){if(g.distance&&2!==f)return d.aspettare();d.stay(1);x||(x=z+A*b);d.action=
void 0;g(x,d,B)}else d.stay();else{if(0===t&&0===v)return d.aspettare();d.setupDir(t,v);f=d.spd;ta(d,d.mimg,-1,d.spd/d.__proto__.spd);d.dix=t*f;d.diy=v*f;e+=v;c+=t;d.x32=c;d.y32=e;d.distance++;Zb(d,~~(32E3/f));Rc(d,t*f,v*f,0);u=c+e*b;if(2>l)n(u,d.id);else for(m=l*l,r=-b,p=0;p<m;p++)q=p%l,0===q&&(r+=b),n(u+q+r,d.id)}},wk=function(d){d/=1E3;var b=~~(d/60)%60,f=~~(d/3600);d=~~(d%60);1===(d+"").length&&(d="0"+d);0!=f?(f+=":",10>b&&(b="0"+b)):f="";return f+b+":"+d},Oc=function(){if(!p.editor){var d=p.cycle;
p.now();var b=Date.now();if(p.demo){var f=p.record[d];if(f)for(var e=0;e<f.length;e+=3)fg[f[e]](f[e+1],f[e+2])}if(f=ed[d]){for(e=0;e<f.length;e++){var c=f[e];ac[c.func](c.data)}delete ed[d]}if(f=fd[d]){for(e=0;e<f.length;e++)c=w[f[e]],c.c===d&&(c.death?T("anti stall:",ac[c.func].name,c.func,c):(c.c=void 0,ac[c.func](c.funcObj)));delete fd[d]}p.cycle++;0===p.cycle%40&&xk();if(p.online&&0===p.cycle%(Dd.maxPing/25))var g=Dd();p.online&&0===p.cycle%640&&T(Qb.synchroHash());p.online&&0===p.cycle%80&&Ib();
ci+=Date.now()-b;0===p.cycle%40&&(q("topinfo").innerHTML="<span>CPU:"+(ci/10).toFixed(2)+"%</span> <span>"+~~(di/ei+.5)+"FPS</span> <span>"+wk(p.now())+"</span>",di=ei=ci=0);!g&&!p.automatic&&p.now()-(p.cycle-1)*Oc.speed>=Oc.speed&&Oc()}};Oc.speed=25;var ci=0,ei=0,di=0,Ab=function(d,b,f,e){return[d,b,f,e,d,b,f,e,d,b,f,e,d,b,f,e]};new Float32Array(Ab(1,0,0,.75));new Float32Array(Ab(1,1,1,.5));new Float32Array(Ab(0,1,0,.75));var Um=new Float32Array(Ab(0,1,0,.9));new Float32Array(Ab(.3515625,.29296875,
.21875,.9));var Vm=new Float32Array(Ab(0,1,1,.9));new Float32Array(Ab(1,1,1,.5));var Wm=new Float32Array(Ab(.3,.3,.3,.9)),Xm=new Float32Array(Ab(.7,.2,.2,.9));Vm.noAlpha=1;Wm.noAlpha=1;Xm.noAlpha=1;var V=function(d){var b=B[d];if(1===C.length){var f=C[0];I(ze,[d,4*Jb.shift+1,jd],f)}else for(var e=0,c=4*Jb.shift+1;e<c;e++){var g=C,k=Infinity;f=-1;for(var n=0,u=g.length;n<u;n++){var l=w[g[n]];if(!l.techStart&&!1!==l.built){var m=l.icons.indexOf(b.nu);m=(l.work&&l.work[m]||0)+(p.online&&l.usedCycle==
p.cycle&&l.usedTimes||0);m<k&&(!jd||m)&&(k=m,f=l.id)}}0<f&&(g=w[f],g.usedCycle!=p.cycle&&(g.usedTimes=0,g.usedCycle=p.cycle),g.usedTimes++,I(ze,[d,1,jd],f))}},ze=function(d,b){var f=d[0],e=d[1],c=d[2];d=B[f];b=w[b];var g=b.icons.indexOf(d.nu);if(!(0>g||void 0!==b.techID)){performance.now();if(0==c)for(c=0;c<e;c++){var k=E[b.kingdom],n=k.mod[f].cost||d.cost;if(k.paypal(n))break;b.waitlist||(b.waitlist=[]);b.waitlist.push(f,-g-1);b.work||(b.work={});b.work[g]||(b.work[g]=0);b.work[g]++;b.working=1;
k.unitLoading++;2==b.waitlist.length&&(n=1E3*d.time,b.setupINTV(De,b.id,n))}else{if(!b.work||!b.waitlist.length)return;var u=b.waitlist;k=E[b.kingdom];for(c=0;c<e;c++){n=k.mod[f].cost||d.cost;k.setupResources(n,-1);n=u.lastIndexOf(f);if(0>n)break;u.splice(n,2);b.work[g]--;if(0==u.length){b.c=-1;b.working=0;break}k.unitLoading--;0===n&&(n=1E3*B[u[0]].time,b.setupINTV(De,b.id,n))}}O(b.id)}},yk=0,De=function(d){d=w[d];if(d.death||d.waitlist&&!d.waitlist.length)return!1;var b=d.kingdom;b=E[b];var f=b.values.pop>=
b.values.popMax?t.houseLimit:t.popLimit;if(b.values.pop>=b.values.popMax||b.values.pop>=b.values.popLimit)return q("msgs1").getElementsByTagName("li"),3E4<Date.now()-yk&&b.k==x.kingdom&&Sc(f,0,5),yk=Date.now(),b.onFreePop.put(d.id),!0;b.unitLoading--;b=d.waitlist[0];f=B[b];d.work[-d.waitlist[1]-1]--;d.waitlist.splice(0,2);0<d.waitlist.length?d.setupINTV(De,d.id,1E3*f.time):d.working=0;Ee(b,d);O(d.id);return!0},La=function(){if(0==jd){var d=w[C[0]];I(gg,[d.mlistID[pb.nu],!0],d.id)}},Ga=function(){if(0==
jd){var d=w[C[0]];I(gg,[d.hlistID[pb.nu],!1],d.id)}},zk=function(d,b,f){var e=1.6,c=0;1===b&&(f=0,e=3.6,c=620);return[c+~~(e*d[0]*b+.5)+120*f,~~(e*d[1]*b+.5),~~(e*d[2]*b+.5),~~(e*d[3]*b+.5)]},gg=function(d,b){var f=d[0];d=d[1];b=w[b];var e=E[b.kingdom],c=E[b.kingdom];if(c.values.pop>=c.values.popMax&&b.kingdom===x.kingdom)return Sc(t.popLimit,0,5);if(d)var g=c.values.fameTech;c=4;var k=9*d;k||(k=1);if(d)var n=b.mlist,u=b.mlistID;else n=b.hlist,u=b.hlistID;var l=u.indexOf(f);if(!(0>l)){f=n[l].unit;
var m=zk(B[f].cost,k,g);if(e.paypal(m))return 0;n.splice(l,1);u.splice(l,1);W.active==n&&oa(n);for(e=0;e<k;e++)u=Ee(f,b),g?u.level=c:d||(c=16,u.level=c,n=Ak[u.race],u.name=n[u.id%n.length],Bk(u))}},Ee=function(d,b,f,e){var c=G,g=b.kingdom;b.rnd||fi(b);var k=-1,n=-1;if(b.point&&!b.disallowPoint){var u=b.point[0],l=b.point[1];k=Ck(b,u,l,B[d].radix,B[d].rbase())[0]}else k=Ck(b,k,n,B[d].radix,B[d].rbase())[1],k=k[Dk(b,k.length)];n=~~(k/c);d=new kd(d,g,k%c,n,0,!1,e);Fe(g);f||pa("unitdone",0,0,d.kingdom);
if(b.point&&(b=gi(u,l,d,!0),f=b[1],b[0]))b[0](f,[d.id]);return d},Ek=0,Fk=0,Hc,Ha,re,Q=function(d){P=function(){};d=B[d];Hc=!1;var b=ja;ta(b,d.img);b.active=!0;Ha=d;re=!1;T(Hc);document.addEventListener("mousemove",Ih);document.addEventListener("mousedown",se)},se=function(d){var b=Ha.validator,f=Ha.space,e=Ja[Ha.img];0==d.button&&151<d.pageX?(d=wc(d.pageX-x.mx-.5*e[8]/Z,d.pageY-.5*e[9]/Z),e=~~(.03125*d[1]),d=~~(.03125*d[0]),Ha.wall?xc(d,e):(b(d,e,f,x.kingdom)[1]&&(Hc=!0,ja.active=!0,ja.x=-9999,ja.y=
-9999,document.removeEventListener("mousedown",se),I(sc,[d+G*e,Ha.type,re],C),Jb.shift&&(re?ak(re):Q(Ha.type))),P=function(){})):(ja.active=!0,ja.x=-9999,ja.y=-9999,Hc=!0,P=function(){},document.removeEventListener("mousedown",se))},Ih=function(d){var b=Ha.validator,f=Ha.space,e=Ja[Ha.img];if(Hc)document.removeEventListener("mousemove",Ih);else{var c=d.pageX,g=d.pageY;if(c!=Ek||g!=Fk)ja.active=!0,Ek=c,Fk=g,c=wc(d.pageX-x.mx-.5*e[8]/Z,d.pageY-.5*e[9]/Z),g=~~(.03125*c[1]),c=~~(.03125*c[0]),d=32*c,e=
32*g,(b=!b(c,g,f,Nb.k)[1])?b!=hg&&(hg=b,Kb(1,0,0,.75,ja.bufferID)):b!=hg&&(hg=b,Kb(0,1,0,.75,ja.bufferID)),ja.x=d,ja.y=e}},sc=function(d,b){var f=d[0],e=f%ha,c=~~(f/ha),g=p.editor?x.kingdom:w[b[0]].kingdom;f=d[1];var k=B[f],n=k.cost,u=E[g];if(!k.validator(e,c,k.space,g)[1]||!p.editor&&u.paypal(n))return!1;d=new kd(f,g,e,c,0,!p.editor,d[2]);if(!0===d.invalid||p.editor)return!1;d.waitlist=[];if(20===f)d.built=1,e=w[b[0]],U(d.id,e,ld,e.url.move);else for(d.health=1,ta(d,d.bimg),d=d.id,f=0,c=b.length;f<
c;f++)e=w[b[f]],e.buildList?(e.buildList.put(d),e.func!==ig.url&&(g=jg(e.buildList,e.x32,e.y32))&&U(g,e,md,e.url.move)):(e.buildList=[d],e.func!==ig.url&&U(d,e,md,e.url.move))},hg=null,Ym=function(d){P=function(){};d=B[d];Hc=!1;var b=ja;Ha=d;ta(b,d.img);document.addEventListener("mousemove",hi);document.addEventListener("mousedown",pushbuildWall)},xc=function(d,b){xc.x=d;xc.y=b;Hc=!0;ja.active=!0;ja.x=-9999;ja.y=-9999;document.removeEventListener("mousedown",se);xc.click=!1;xc.painted={};Tc.lastFrame=
ub.frameCount-1;Tc(d,b);document.addEventListener("mousemove",hi);document.addEventListener("mouseup",Gk)},Tc=function(d,b){if(xc.click)document.removeEventListener("mousemove",hi);else if(ub.frameCount>Tc.lastFrame){nd=!1;var f=G;Tc.lastFrame=ub.frameCount;var e=xc.x,c=xc.y,g=0,k=Math.abs(e-d)+1,n=Math.abs(c-b)+1;e=d<e?d:e;c=b<c?b:c;var u=Tc.anims;d=0;for(b=u.length;d<b;d++)Lb(u[d].bufferID);for(d=u.length=0;d<k;d++)for(b=0;b<n;b++)if(!d||!b||d===k-1||b===n-1){var m=d&&d<k-1?l.wood_horz:b&&b<n-1?
l.wood_vert:Ha.img;var y=d+e;var r=b+c;m={x32:y,y32:r,img:m,d:0};u[g++]=m;Za(m);0<Y[y+r*f]?Kb(1,0,0,.75,m.bufferID):Kb(0,1,0,.75,m.bufferID)}}};Tc.anims=[];var Gk=function(d){d=Tc.anims;for(var b=0,f=d.length;b<f;b++){var e=d[b];I(sc,[e.x32+e.y32*G,Ha.type],C);Lb(e.bufferID)}d.length=0;xc.click=!0;document.removeEventListener("mouseup",Gk)},hi=function(d){var b=Ja[Ha.img];d=wc(d.pageX-x.mx-.5*b[8]/Z,d.pageY-.5*b[9]/Z);b=~~(.03125*d[1]);d=~~(.03125*d[0]);Tc(d,b)},ii=function(d,b){d=0;for(var f=b.length;d<
f;d++){var e=w[b[d]];e.xf?e.stop=1:e.stay()}},kg=function(d,b){d=w[b[0]];d.techStart=0;d.c=void 0;b=d.techID;d.techID=void 0;if(b){var f=E[d.kingdom].technology.hidden;-1<b&&(f[b]=0);E[d.kingdom].setupResources(F[d.activeTech].cost,-1)}else if(d.lcost)E[d.kingdom].setupResources(d.lcost,-1);else return;O(d.id)},H=function(d){I(bg,[d,pb.lastFunc.id],w[C[0]].id)},bg=function(d,b){var f=d[0];d=d[1];var e=F[f],c=w[b];e.upgrade&&(d=-1);if(void 0!==c.techID||c.waitlist&&c.waitlist.length||E[c.kingdom].paypal(e.cost))return!1;
c.activeTech=f;c.techID=d;c.setupINTV(e.type,[f,d,b],1E3*e.time);c.techStart=c.c-p.cycle;f=E[w[b].kingdom].technology.hidden;-1<d&&(f[d]=1);O(b)},X=function(d){var b=d[1],f=w[d[2]];d=F[d[0]];yc(f,d,b)},lg=function(d){var b=d[1],f=w[d[2]];d=F[d[0]];var e=B[d.obj],c=E[f.kingdom].mod[e.type];ji(f);f.img=e.img;f.attack=c.attack||e.attack;f.health=f.health/f.maxHealth*e.health;f.maxHealth=e.health;f.__proto__=e;Za(f);yc(f,d,b)},mg=function(d){var b=d[1],f=w[d[2]];d=F[d[0]];if(d.actvintv)for(var e=d.actvintv,
c=0,g=e.length;c<g;c++){var k=e[c];E[f.kingdom].technology.disabled[k.id]=0;for(var n=k.builds,u=va[f.kingdom],l=0,m=n.length;l<m;l++)for(var r=u[n[l]],p=0,q=r.length;p<q;p++)k(w[r[p]])}yc(f,d,b)},vb=function(d,b){var f=d[1];b=w[d[2]];d=F[d[0]];E[b.kingdom].values[d.value]+=d.increase;"popMax"==d.value&&Fe(b.kingdom);yc(b,d,f)},Hk=function(d,b){var f=d[1];b=w[d[2]];d=F[d[0]];var e=d.group,c=E[b.kingdom],g=va[c.k];c=c.mod;for(var k=0,n=e.length;k<n;k++)for(var u=c[e[k].type],l=g[e[k].type],m=0,r=d.values,
p=r.length;m<p;m+=2){var q=r[m],t=r[m+1];u[q]||(u[q]=e[k][q]||0);for(var v=0,x=l.length;v<x;v++)w[l[v]][q]+=t;u[q]+=t}yc(b,d,f)},ib=function(d,b){var f=d[1];b=w[d[2]];d=F[d[0]];var e=d.group,c=E[b.kingdom],g=c.mod;c=va[c.k];for(var k=0,n=e.length;k<n;k++){var u=g[e[k].type];u[d.value]||(u[d.value]=e[k][d.value]||0);u[d.value]+=d.increase;u=c[e[k].type];for(var l=0,m=u.length;l<m;l++)w[u[l]][d.value]+=d.increase}yc(b,d,f)},ki=function(d,b){var f=d[1];b=w[d[2]];d=F[d[0]];for(var e=E[b.kingdom].mod,
c=d.mulp,g=0,k=d.group.length;g<k;g++){var n=d.group[g],u=e[n.type].cost||n.cost;e[n.type].cost=c?[~~(u[0]*c),~~(u[1]*c),~~(u[2]*c),~~(u[3]*c)]:[u[0]-d.decrease[0],u[1]-d.decrease[1],u[2]-d.decrease[2],u[3]-d.decrease[3]]}yc(b,d,f)},li=function(d,b){var f=d[1];b=w[d[2]];d=F[d[0]];for(var e=E[b.kingdom].mod,c=0,g=d.decrease,k=g.length;c<k;c+=2){var n=g[c],u=g[c+1],l=e[n.type].cost||n.cost;e[n.type].cost=[l[0]-u[0],l[1]-u[1],l[2]-u[2],l[3]-u[3]]}yc(b,d,f)},yc=function(d,b,f){d.techStart=void 0;d.activeTech=
void 0;d.techID=void 0;d.func=void 0;var e=E[d.kingdom].technology,c=e.disabled;e.investigated[f]=1;pa("techdone",0,0,d.kingdom);if(b=b.next){f=!1;e=0;for(var g=b.length;e<g;e++){var k=b[e].id;c[k]--;oa.actv[k]&&(f=!0)}f&&oa(W.active)}d.standardFunc&&d.standardFunc(d);O(d.id)};"use strict";var ob,Zm={icon:"food",img:"item_meat",url:"meat"},$m={icon:"milk",img:"milk",url:"milk"},an={icon:"gold",img:"item_gold",url:"gold"},bn={icon:"stone",img:"item_stone",url:"stone"},Ik={icon:"wood",img:"item_tree",
url:"tree"},cn={icon:"food",img:"item_food",url:"food"},Ge=function(d,b,f,e){d=va[d];var c=ob[b];b=[];b.length=c.length;for(var g=0,k=c.length;g<k;b[g]=d[c[g++]]);d=Infinity;c=-1;for(g=0;g<b.length;g++){k=b[g];for(var n=k.length,u=0;u<n;u++){var l=w[k[u]];if(!1!==l.built){var m=l.x32,r=l.y32,p=l.space;l=p[p.length-1];p=(p.length-1)/l;l*=.5;p*=.5;m+=l;r+=p;l=.5*(l+p);m=Math.sqrt((m-f)*(m-f)+(r-e)*(r-e))-l;d>=m&&(d=m,c=k[u])}}}return c},Ea,dn=function(d){if("string"==typeof d){for(var b=1,f=0,e=d.length;f<
e;f++)b+=b*(d.charCodeAt(f)/65535)*(f+1);d=b+e}var c=4294967295-d,g=4294967295+d;f=0;Ea=function(){g+=f;c-=f++;g=36969*(g&65535)+(g>>16)&4294967295;c=18E3*(c&65535)+(c>>16)&4294967295;return((g<<16)+c&4294967295)/4294967295+.5}},Dk=function(d,b){d=d.rnd;var f=d[0],e=d[1],c=d[2];f+=c;e-=c;f=36969*(f&65535)+(f>>16)&4294967295;e=18E3*(e&65535)+(e>>16)&4294967295;d[0]=f;d[1]=e;d[2]++;return~~((((f<<16)+e&4294967295)/4294967295+.5)*b)},od=function(d){d!=en&&(document.body.className="ncursor"+d)},en=-1,
Ld=function(d,b){for(var f=0,e=b.length;f<e;f++){var c=w[b[f]];U(d,c,He,c.url.move)}};Ld.spLevel=function(d){var b=0;2<Ta[d]&&(b=Ta[d]);return b};var He=function(d,b){b.stay55();if(b.inventory&&b.invMax===b.inventory.length||!d.item)return 1;Ta[d.x32+d.y32*G]=d.radix;Cb(d,NaN);if(b.peon&&d.contain){var f=d.contain[1],e=d.contain[0];b.stock&&Jk(b);var c=Kk(b.x32,b.y32)||!1,g=d.contain[2];d.die(1);b.stock=[e,f,c,He.url,g];d=Ge(b.kingdom,f,b.x32,b.y32);U(d,b,zc,b.url[g.url]);O(b.id);return 1}b.addItem(d);
O(b.id)},Jk=function(d){var b=Lk(d.x32,d.y32),f=~~(b/G);b%=G;b=new kd(52,d.kingdom,b,f,0);ta(b,l[d.stock[4].img]);b.contain=[d.stock[0],2,d.stock[4]]},mi=function(d,b){d=0;for(var f=b.length;d<f;d++){var e=w[b[d]];e.xf?e.stop=2:(e.stop=2,e.stay(),e.stop=void 0)}},Md=function(d,b){var f=G;d=w[d];for(var e=0,c=b.length;e<c;e++){var g=w[b[e]];if(g.in){var k=g.rbase(),n=g.x32+g.y32*f;if(0!==k(n)||!d.build){n=d.build?ng(g,g.x32,g.y32):ng(g,d.x32,d.y32);if(!1===n)continue;g.x32=n%G;g.y32=~~(n/G)}g.item&&
(d.attack-=g.attack||0,d.defence-=g.defence||0);g.url.idle&&ta(g,g.url.idle,1);k.write(n,g.id);g.in=0;d.inventory.quit(g.id);k=1;g.z32&&(k=g.z32);Cb(g,32*g.y32*k)}}O(d.id,1)},Ie=function(d,b){d=w[d];if(1===d.invType)for(var f=0,e=b.length;f<e;f++){var c=w[b[f]];c==d||c.in||U(d.id,c,ni,c.url.move)}},ni=function(d,b){var f=d.inventory;if(f.length<d.invMax){var e=b.x32,c=b.y32;b.stay55();b.rbase().write(e+c*G,b.radix);f.put(b.id);Cb(b,NaN);b.in=d.id;Je(b.id);O(d.id)}else b.stay55()},uc=function(d,b){for(var f=
b.length,e=0;e<f;e++){var c=w[b[e]];c.buildList=!1;U(d,c,md,c.url.move)}},md=function(d,b){if(d.dummy&&d.dummy.built)return b.stay55();if(d.health<d.maxHealth)b.dix=0,b.diy=0,b.mv=!0,b.setupDirBuild(d),ta(b,b.url.build,1),b.setupINTV(ig,{u:d.id,a:b.id},nb(b.img)),xe(b,"hit%20",7,b.img);else{if(b.buildList&&(d=jg(b.buildList,b.x32,b.y32)))return U(d,b,md,b.url.move),0;b.stay55()}},og=function(d,b){return b[d]&&13==w[b[d]].type||13==w[Y[d]].type?!0:!1},ig=function(d){var b=w[d.u];d=w[d.a];var f=d.x32,
e=d.y32,c=b.x32+b.y32*G;if(b.death)return d.stay();var g=b.maxHealth,k=g/b.__proto__.time*E[d.kingdom].values.buildSpeed;b.health+=k;var n=b.health;if(0==b.built){if(1===b.health-k){for(var u=b.validator(b.x32,b.y32,b.space,b.kingdom)[0],m=b.id,y=b.validator.dimension,r=y.write,p=0,q=u.length;p<q;p++)if(2<y(u[p])){Zb(d,nb(d.img));b.health-=k;return}k=Bb[b.kingdom];p=0;for(q=u.length;p<q;p++)r(u[p],m),k[u[p]]=void 0;va[b.kingdom][b.type].put(b.id);wb(b)}u=~~(4*n/g);u>b.d&&(b.d=u,ta(b,b.img))}if(n>=
g){n=b.health=g;O(b.id);if(!1===b.built){b.d=0;u=b.url;k=Bb[b.kingdom];13===b.type&&(og(c-1,k)&&og(c+1,k)?(u=l.wood_horz,b.child=void 0):og(c+G,k)&&og(c-G,k)&&(u=l.wood_vert,b.child=void 0));b.built=1;b.img=u;Za(b);if(b.valid2)for(u=b.validator(b.x32,b.y32,b.space,b.kingdom)[2],r=b.validator.dimension.write,p=0,q=u.length;p<q;r(u[p++],0));Mk(b);pa("bldgdone",0,0,b.kingdom);E[b.kingdom].building.quit(b.id);O(b.id);b.standardFunc&&b.standardFunc(b)}b.action=void 0;(c=d.buildList)&&c.quit(b.id);if(!c||
d.buildList&&0===d.buildList.length)d.buildList=Nk(d),c=d.buildList;if(f=jg(c,f,e))return U(f,d,md,d.url.move),0;d.buildList.length=0;d.stay();d.stock&&d.stock[0]&&ta(d,d.url[d.stock[4].url])}else O(b.id),Zb(d,nb(d.img));C[0]==b&&(Ac.innerHTML=n+"/"+g,Pa.value=n)},pg=function(d,b){if(2<d)for(var f=0,e=b.length;f<e;f++){var c=w[b[f]];U(d,c,ld,c.url.move)}},tc=function(d,b){var f=d;d=w[d];if(d.field)for(e=0,d=b.length;e<d;e++)c=w[b[e]],U(f,c,ld,c.url.move);else if(0===d.res||3===d.res){var e=0;for(d=
b.length;e<d;e++){var c=w[b[e]];U(f,c,qg,c.url.move)}}else if(1===d.res)for(e=0,d=b.length;e<d;e++)c=w[b[e]],U(f,c,pd,c.url.move);else if(2===d.res)for(e=0,d=b.length;e<d;e++)c=w[b[e]],U(f,c,Pc,c.url.move)},oi=function(d,b){var f=B[d],e=b.length;d=E[w[b[0]].kingdom].mod[d];for(var c=0;c<e;c++){var g=w[b[c]];g.stay();ji(g);g.img=f.img;g.attack=d.attack||f.attack;g.health=g.health/g.maxHealth*f.health;g.maxHealth=f.health;g.defence=d.defence||f.defence;g.__proto__=f;Za(g);O(g.id)}},vc=function(d,b,
f,e){f=e||Nd;if(!(3>d||(d=w[d],void 0!=d.res&&!d.cow||d.magicGateway))){e=0;for(var c=b.length;e<c;e++){var g=w[b[e]];g==d||g.attackOnly&&!g.attackOnly[d.type]||g.bat&&d.build||d.stoned||(g.build?f(d,g):U(d.id,g,f,g.url.move))}}},pd=function(d,b){if(0<d.health){var f=b.x32,e=b.y32;b.mv=!0;b.setupDir(d.x32-f,d.y32-e);ta(b,b.url.cut,1);b.dix=0;b.diy=0;xe(b,"chop%20",11,b.img);b.setupINTV(Ok,{u:d.id,a:b.id},7E3);d.addWorker(b)}else b.stay55()},Ok=function(d){var b=G,f=w[d.u];d=w[d.a];var e=E[d.kingdom].values.wood;
f.workers.quit(d.id);var c=Ge(d.kingdom,1,d.x32,d.y32),g=w[c];f.health-=e;d.mv=!1;O(f.id);if(1>f.health){e+=f.health;Y[f.x32+f.y32*b]=0;b=ra(g.x32,g.y32);g=f.health=0;for(var k=f.workers.slice(0),n=k.length;g<n;g++){var u=w[k[g]];b?U(b,u,pd,d.url.move):u.stay()}d.stock=[e,1,b,pd.url,Ik];d.mv=!1;U(c,d,zc,d.url.tree);O(d.id,1);f.workers.length=0;f.die()}else d.stock=[e,1,f.id,pd.url,Ik],U(c,d,zc,d.url.tree),O(d.id,1);if(0>c)return d.stay()},ld=function(d,b){b.mv=!0;b.setupDir(d.x32-b.x32,d.y32-b.y32);
ta(b,b.url.dig,1);xe(b,"dig%20",3,b.img);b.setupINTV(Pk,{u:d.id,a:b.id},14E3);d.addWorker(b)},Pk=function(d){var b=w[d.u];d=w[d.a];var f=E[d.kingdom].values.food,e=d.x32,c=d.y32;b.lastUse=p.cycle;e=Ge(d.kingdom,2,e,c);d.mv=!1;d.stock=[f,2,b.id,ld.url,cn];U(e,d,zc,d.url.food);O(d.id,1);if(0>e)return d.stay()},Pc=function(d,b){b.mv=!0;b.setupDir(d.x32-b.x32,d.y32-b.y32);ta(b,b.url.milk1,1);b.stock=[0,2,d.id,Pc.url,$m];b.setupINTV(pi,{u:d.id,a:b.id},1E3);d.addWorker(b);d.d=(8-b.d)%8;d.stay()},pi=function(d){var b=
w[d.u];d=w[d.a];b.milk-=3;var f=d.x32,e=d.y32;d.stock[0]+=3;O(d.id,1);if(0>=b.milk||b.death){if(50<d.stock[0]&&(d.stock[0]=50),d.mv=!1,b=Ge(d.kingdom,2,f,e),U(b,d,zc,d.url.milk),0>b)return d.stay()}else Zb(d,1E3)},Ae=function(d,b){b.stay55()},Kd=function(d,b){Nd(d,b)},Nd=function(d,b){if(1!==d.death&&d!=b){if(d.dummy&&!E[b.kingdom].values.experience)return b.stay55();b.invisible&&Od(b.id);if(!0!==b.build){b.mv=1;var f=d.x32-b.x32,e=d.y32-b.y32;d.space&&(e=bi(d,b.x32,b.y32),f=e%G-b.x32,e=~~(e/G)-b.y32);
b.setupDir(f,e,b.d2attack);b.url.attack&&ta(b,b.url.attack,1)}b.setupINTV(rg,{u:d.id,a:b.id},b.attackTime||nb(b.img),d);d.addWorker(b)}else b.stay55()};Nd.distance=-1;Kd.distance=-1;var qi=function(d,b){var f=E[d.kingdom];if(f.values.experience&&(!b||0!=f.diplomacy[b.kingdom]||b.dummy)){if(0==d.level||null==d.level)d.level=0,d.levelProgress=0;d.levelProgress++;d.levelProgress>=~~(d.level/f.values.experience)&&d.level<f.values.maxLevel&&(d.level++,d.health+=f.values.healthJump,d.maxHealth+=f.values.healthJump,
d.levelProgress=0,d.attack+=d.level,d.defence+=d.level%2,O(d.id,1))}},Bk=function(d){var b=d.level;d.attack+=b;d.defence+=~~(.5*b)},Qk=function(d,b){d=.5-Math.atan2(b,d)/(2*Math.PI);1==d&&(d=0);return d},rg=function(d){var b=w[d.u];d=w[d.a];var f=d.attDist,e=b.x32-d.x32,c=b.y32-d.y32,g=b.x32,k=b.y32,n=!d.build;if(d.attackSound){var u=d.attackSound;pa(u[~~(u.length*Math.random())],d.x32,d.y32)}n&&!b.build&&d.setupDir(e,c,d.d2attack);ta(d,d.img,1);if(b.death||d.level&&8<=d.level&&b.dummy||b.dummy&&
d.level&&d.level>=E[d.kingdom].values.maxLevel)return d.stay();if(1<f&&!d.dragon){n=!0;var l=Ja[d.attimg]}else n=!1;if(b.build||Ce(b.x32,b.y32,d.x32,d.y32,f)){b.onattack(d);f=d.attack*((ye[d.type][b.type]||0)+1);if(n){b.space&&(e=bi(b,d.x32,d.y32),g=e%G,k=~~(e/G),e=g-d.x32,c=k-d.y32);n=0;if(d.arrow||d.ball){u=Rk;var m=Qk(-e,-c);var r=e;var q=c;var t=411/Math.sqrt(r*r+q*q);r*=t;q*=t;var v=Math.sqrt(1024*e*e+c*c*1024)/Math.sqrt(r*r+q*q);d.ball&&(l[1]=l[0]/v)}else{var x=2;u=sg;n=r=p.gravity;m=Math.PI/
180*60;t=Math.cos(m);m=d.attackDeg;m*=Math.PI/180;q=Math.sin(m);v=Math.cos(m);m=32*Math.sqrt(e*e+c*c);r=v*Math.sqrt(r*m/(q*v*2));v=m/r;q=-Math.sin(Math.atan2(-e,-c));m=Qk(-e,-c);r*=q;n=Math.abs(n*t*q);q=(32*c-n*v*v*.5)/v}v=Math.round(1E3*v);t={x32:d.x32+.5,y32:d.y32+.5,img:l.url,mv:d.ball,d:0,rotation:2*-m*Math.PI-3*Math.PI/2,xf:g,yf:k,obj:b.id,attack:f,range:x};Za(t);Rc(t,r,q,n);Ya({func:u,data:t},v,1)}t||b.damage(f,d);if(b.dummy){if(50<=d.dummyDamage||!d.dummyDamage)d.dummyDamage=0;d.dummyDamage+=
f;50<=d.dummyDamage&&qi(d,b)}b.death?(d.action=null,b.build||d.build||qi(d,b),Cd(d)||d.stay()):Zb(d,d.attackTime||nb(d.img))}else d.build&&(Cd(d)||d.stay()),d.mv=!1,0!==d.state&&U(b.id,d,Nd,d.url.move)},qg=function(d,b){0<d.health?(b.dix=0,b.diy=0,b.mv=1,b.setupDirBuild(d),ta(b,b.url.kirka,1),xe(b,"mine%20",3,b.img),b.setupINTV(Sk,{u:d.id,a:b.id},7E3),d.addWorker(b)):b.stay()},Sk=function(d){var b=w[d.u];d=w[d.a];var f=b.res,e=E[d.kingdom].values[0==f?"gold":"stone"],c=d.x32,g=d.y32;b.health-=e/E[d.kingdom].values.miningPerf;
O(b.id);1>b.health&&(e=b.health+e,b.health=0,b.d=3,b.die());d.mv=!1;c=Ge(d.kingdom,f,c,g);0==f?(d.stock=[e,f,b.id,qg.url,an],U(c,d,zc,d.url.gold)):(d.stock=[e,f,b.id,qg.url,bn],U(c,d,zc,d.url.stone));O(d.id,1);if(0>c)return d.stay()},U=function(d,b,f,e){b.cow&&b.workers.length||b.freezed||b.in||b.stoned||(b.action=f.url,b.distance=0,b.nodes=void 0,0<d?(b.xf=d,b.yf=!0):(d*=-1,b.xf=d%G,b.yf=~~(d/G)),b.func!=Be.url&&(e==b.url.move?$h(b):b.mimg=e,b.dix=0,b.diy=0,b.mv=!0,b.setupINTV(Be,b.id,0)))},Ke=function(d,
b){if(w[b[0]].boat&&(d=-d,d=-ng(B[76],d%G,~~(d/G)),!d))return!1;tg(b,d,Tk)};Ke.allowPos=1;var Tk=function(d,b){T(d);Md(b.id,b.inventory.slice(0));b.stay55()},bi=function(d,b,f){var e=d.space||Tm,c=e.length-1,g=e[c],k=d.x32;d=d.y32-1;for(var n=Infinity,u=0,l=0;l<c;l++){var m=l%g;m||d++;var r=(k+m-b)*(k+m-b)+(d-f)*(d-f);r<n&&e[l]&&(u=k+m+d*G,n=r)}return u},ng=function(d,b,f){var e=G,c=d.radix,g=d.rbase();for(d=2;60>=d;d+=2){b--;f--;for(var k=0;k<=d;){var n=b+k+e*f;if(g(n)===c)return n;n=b+k+e*(f+d);
if(g(n)===c)return n;k++}for(k=0;k<d-1;){k++;n=b+e*(f+k);if(g(n)===c)return n;n=b+d+e*(f+k);if(g(n)===c)return n}}return!1},Lk=function(d,b){var f=G,e,c=Pd;for(e=2;60>=e;e+=2){d--;b--;for(var g=0;g<=e;){var k=d+g+f*b;if(0===c(k)&&0===Y[k])return k;k=d+g+f*(b+e);if(0===c(k)&&0===Y[k])return k;g++}for(g=0;g<e-1;){g++;k=d+f*(b+g);if(0===c(k)&&0===Y[k])return k;k=d+e+f*(b+g);if(0===c(k)&&0===Y[k])return k}}return!1},Qc=function(d,b,f,e){var c=b.x32,g=b.y32,k=G,n=c+g*k,u=d.x32,l=d.y32,m=d.space;if(m){var r=
m[m.length-1];m=(m.length-1)/r;d=d.free}else m=r=1,d=uk;b=b.rbase();for(var p,q=Infinity,t=-1,v=!1,w=0;w<f&&-1==t;){if(0==w&&d){for(var x=[],z=0,A=d.length;z<A;z+=2){var B=d[z]+u;p=d[z+1]+l;if(ia(B,p)&&(b(B+p*k)===e||B+p*k==n))a:{var C=x;B+=p*k;p=c;for(var E=g,F=G,H=Math.pow(B%F-p,2)+Math.pow(~~(B/F)-E,2),I=0,J=C.length;I<J;I++)if(Math.pow(C[I]%F-p,2)+Math.pow(~~(C[I]/F)-E,2)>H){C.splice(I,0,B);break a}C.put(B)}}x[0]&&(t=x[0]);if(-1<t){v=!0;break}if(1==f)break}w++;--u;--l;x=r+2*w;C=m+2*w;z=0;for(A=
x*C;z<A;z++)p=z%x,E=~~(z/x),p&&E&&p!=x-1&&E!=C-1||(p+=u,E+=l,B=p+E*k,b(B)==e&&ia(p,E)&&(p=(p-c)*(p-c)+(E-g)*(E-g),q>p&&(q=p,t=B)))}return-1<t?[t%k,~~(t/k),v]:!1},Ck=function(d,b,f,e,c){performance.now();var h=G,k=d.x32,n=d.y32,u=d.space,l=[],m=0;if(u){var r=u[u.length-1];u=(u.length-1)/r;var p=d.free}else u=r=1;d=-1==b?-Infinity:Infinity;for(var q=-1,t=0,v=0;0==l.length;){if(p&&0==v){for(var w=0,x=p.length;w<x;w+=2){var z=p[w]+k,A=p[w+1]+n;ia(z,A)&&c(z+A*h)===e&&(l[m++]=z+A*h,t=(z-b)*(z-b)+(A-f)*
(A-f),d>t&&(d=t,q=z+A*h))}if(l.length)break}v++;--k;--n;for(w=0;w<r+2*v;w++)c(k+n*h+w)==e&&ia(k+w,n)&&(l[m++]=k+w+n*h,t=(k+w-b)*(k+w-b)+(n-f)*(n-f),d>t&&(d=t,q=k+w+n*h)),c(k+(n+u+2*v-1)*h+w)==e&&ia(k+w,n+u+2*v-1)&&(l[m++]=k+(n+u+2*v-1)*h+w,t=(k+w-b)*(k+w-b)+(n+u+2*v-1-f)*(n+u+2*v-1-f),d>t&&(d=t,q=k+(n+u+2*v-1)*h+w));for(w=1;w<u+2*v-1;w++)c(k+(n+w)*h)==e&&ia(k,n+w)&&(l[m++]=k+(n+w)*h,t=(k-b)*(k-b)+(n+w-f)*(n+w-f),d>t&&(d=t,q=k+(n+w)*h)),c(k+r+2*v-1+(n+w)*h)==e&&ia(k+r+2*v-1,n+w)&&(l[m++]=k+r+2*v-1+
(n+w)*h,d>t&&(d=t,q=k+r+2*v-1+(n+w)*h))}return[q,l]},uk=[-1,0,-1,-1,0,-1,1,-1,1,0,1,1,0,1,-1,1],jg=function(d,b,f){for(var e=Infinity,c=!1,g=0,k=d.length;g<k;g++){var n=d[g],u=w[d[g]];if(0!=u.built||u.death)g--,k--,d.quit(n);else{var l=u.x32;u=u.y32;u=(l-b)*(l-b)+(u-f)*(u-f);e>=u&&(e=u,c=n)}}return c},ri=function(d,b){d=0;for(var f=b.length;d<f;d++){var e=w[b[d]];e.spd=e.__proto__.spd}},dg=function(d,b){d=Infinity;for(var f=0,e=b.length;f<e;f++){var c=w[b[f]];c.spd<d&&(d=c.spd)}ug(d,b)},Kk=function(d,
b){for(var f=G,e,c=Infinity,g=0,k=0;121>k;k++){var n=k%11-5,u=~~(k/11)-5,l=n*n+u*u;n+=d;u+=b;l<c&&(e=Ta[n+f*u],0<e&&0==Y[n+f*u]&&(e=w[e],e.contain&&(c=l,g=e.id)))}return g},vg=function(d,b){tg(b,d,zc)},zc=function(d,b){d=E[b.kingdom];var f=b.stock;d.resources[f[1]]+=f[0];d.stats.resources[f[1]]+=f[0];wg(b.kingdom);b.func=1;var e=ac[f[3]],c=w[f[2]];if(e==Pc){var g=b.x32;for(var k=b.y32,n=G,u,l=Infinity,m=!1,r=0;961>r;r++){var q=r%31-15,t=~~(r/31)-15,v=q*q+t*t;q+=g;t+=k;v<l&&(u=Ta[q+n*t],0<u&&0===Y[q+
n*t]&&(u=w[u],u.contain&&"meat"==u.contain[2].url&&(l=v,m=u)))}if(g=m)e=He,c=g}else"meat"==f[4].url&&!1===f[2]&&(g=si(b.x32,b.y32,!0))&&(e=Pc,c=g,f[2]=1);b.stock=void 0;if(!1===f[2])return b.stay();if(g=100<Math.pow(c.x32-b.x32,2)+Math.pow(c.y32-b.y32,2))a:{g=ob[1];k=va[b.kingdom];n=0;for(l=g.length;n<l;n++)if(m=g[n],1==B[m].storage&&k[m].length){g=!0;break a}g=!1}g&&void 0!==d.IAD&&1==f[1]?(p.blocked=!0,qk(b),p.blocked=!1):(U(c.id,b,e,b.url.move),O(b.id,1))};tc.cursor=6;vc.cursor=1;uc.cursor=9;Ld.cursor=
5;Ie.cursor=7;Ke.cursor=7;pg.cursor=6;vg.cursor=6;var Nk=function(d){var b=G,f=d.kingdom,e=d.x32,c=d.y32;e-=16;c-=16;for(var g={},k=[],n=0,u=Bb[f],l=0;1024>l;l++){d=l%32+e;var m=~~(l/32)+c;ia(d,m)&&(d=u[d+m*b],void 0!==d&&(d=w[d],d.kingdom!=f||!1!==d.built||g[d.id]||(k[n++]=d.id,g[d.id]=1)))}return k};pd.available=function(d,b){var f=E[d.kingdom].values.wood;if(b.death||1>b.health-f&&b.workers.length)b=ra(b.x32,b.y32),d.xf=b,b=w[b];return Qc(b,d,1,d.radix)};ld.available=function(d,b){if(b.death)return"kill";
d=b.x32+1;b=b.y32+1;return 0===Y[d+b*G]?[d,b,1]:!1};md.available=function(d,b){var f=d.x32,e=d.y32;if(!b.death&&b.health<b.maxHealth){var c=Qc(b,d,1,d.radix);if(c[2])return c}d.buildList?(c=d.buildList,c.quit(b.id)):(d.buildList=Nk(d),c=d.buildList);b=jg(c,f,e);if(!b)return"kill";d.xf=b;b=w[b];return Qc(b,d,1,d.radix)};Ae.rev=function(d){return 0===d.distance%3&&(d=Zh(d.id,1))?[Kd.url,d]:!1};Kd.available=function(d,b){if(0===d.distance%3){var f=Zh(d.id);f&&(d.xf=f,b=w[f])}return Qc(b,d,5,d.radix)};
He.available=function(d,b){if(b.death||b.in)if(b.contain)if(b=Kk(b.x32,b.y32))d.xf=b,b=w[b];else return(b=si(d.x32,d.y32,!0))?(d.stay(),U(b.id,d,Pc,d.url.move),55):"kill";else return"kill";d=b.x32;b=b.y32;return 0===Y[d+b*G]?[d,b,1]:!1};Pc.available=function(d,b){if(b.workers.length||10>b.milk||b.death){b=si(d.x32,d.y32);if(!b)return!1;d.xf=b.id}return b.xf?!1:Qc(b,d,5,d.radix)};ni.available=function(d,b){if(b.death)return"kill";var f=1;b.boat&&(f=2);return(d=Qc(b,d,f,d.radix))?(d[2]=1,d):!1};var si=
function(d,b,f){for(var e=G,c,g=Infinity,k=!1,n=0;441>n;n++){c=n%21-10;var u=~~(n/21)-10,l=c*c+u*u;c+=d;u+=b;l<g&&(c=Y[c+e*u],0<c&&(c=w[c],c.cow&&(!c.workers.length&&c.milk>=50/1.5||f)&&(g=l,k=c)))}return k},tg=function(d,b,f){for(var e=0,c=d.length;e<c;e++){var g=w[d[e]];U(b,g,f,g.url.move)}},Le=function(d,b){xb(b,d,xg)};Le.noObj=1;var xg=function(d,b){Me(b,-d,77,xg)},Ne=function(d,b){xb(b,d,yg)};Ne.noObj=1;var yg=function(d,b){Me(b,-d,130,yg)},Oe=function(d,b){xb(b,d,zg)};Oe.noObj=1;var zg=function(d,
b){Me(b,-d,78,zg)},Pe=function(d,b){xb(b,d,Ag)};Pe.noObj=1;Pe.cursor=10;var Ag=function(d,b){Me(b,-d,132,Ag)},Qe=function(d,b){xb(b,d,Bg)};Qe.cursor=10;Qe.noObj=1;var Bg=function(d,b){Me(b,-d,131,Bg)},Me=function(d,b,f,e){var c=G,g=E[d.kingdom],k=B[f],n=B[f].cost,u=d.mana>d.manaMax;if(Eb(d)||d.checkMana(n[4],b,e,n)){u||g.paypal(n);e=f;b*=-1;u=b%c;var l=~~(b/c),m=u,r=l,p=k.rbase(),q=~~(d.mana/n[4])+1;1<q&&(g.resources[0]-=n[0]*(q-1),d.mana-=n[4]*(q-1));for(g=0;g<q;g++)0!==p(b)&&(f=ng(k,u,l),m=f%c,
r=~~(f/c)),pa("summon"+~~(10*Math.random()+1),m,r),f=new kd(e,d.kingdom,m,r,0),f.setupChild(jb.spawn);d.setupDir(-d.x32+f.x32,-d.y32+f.y32);d.setupSpellIMG()}else g.paypal(n);O(d.id)},Ce=function(d,b,f,e,c){return~~Math.sqrt((d-f)*(d-f)+(b-e)*(b-e))<=c},Dg=function(d,b){xb(b,d,Cg)};Dg.cursor=0;var Cg=function(d,b){d.build||d.terrain||d.nofreeze||!Eb(b)&&!b.checkMana(50,d.id,Cg)||(d.freezed=1,d.stoned=1,Cb(d,32*d.y32),d.stay(),ta(d,d.img,0),d.setupChild(jb.turnStone),Kb(.3,.3,.3,.9,d.bufferID),Je(d.id),
b.setupDir(-b.x32+d.x32,-b.y32+d.y32),b.setupSpellIMG(),pa("turn%20to%20stone",b.x32,b.y32),Ya({func:Uk,data:d.id},24E4,1))},Uk=function(d){d=w[d];d.freezed=0;wb(d);d.stoned=0},Eg=function(d,b){xb(b,d,Re)},Re=function(d,b){d.health<d.maxHealth&&!d.build?(b.setupDir(d.x32-b.x32,d.y32-b.y32),T("heal",nb(b.img)),b.setupSpellIMG(!0),b.setupINTV(Vk,{u:d.id,a:b.id},0),d.addWorker(b)):b.stay()},ti=function(){xb(list,obj,Wk)},Wk=function(){},Vk=function(d){var b=w[d.a];d=w[d.u];var f=E[b.kingdom].values.healingRange;
pa("heal",b.x32,b.y32);if(!Ce(d.x32,d.y32,b.x32,b.y32,f))return U(d.id,b,Re,b.url.move);if(Eb(b)||b.checkMana(4,d.id,Re)){b.setupDir(d.x32-b.x32,d.y32-b.y32);d.health+=6;d.setupChild(jb.heal);if(d.health>=d.maxHealth)return d.health=d.maxHealth,O(d.id,1),O(b.id,1),b.stay();O(d.id,1);O(b.id,1);Zb(b,nb(b.url.spell))}},Se=function(d,b){xb(b,d,Fg)};Se.cursor=10;var ui=function(d,b){d=w[d];b=w[b];if(d.inventory.quit(b.id)){b=c[b.spell];d.icons==d.__proto__.icons&&(d.icons=d.icons.slice(0));d.icons.put(b);
var f=d.icons;f.olegal||(f.olegal={});f.olegal[b.id]=1;O(d.id)}},Qd=function(d,b){var f=b[1];b=w[b[0]];w[d].nopotion||w[d].build||(U(d,b,Xk,b.url.move),b.actionItem=f)};Qd.item=1;var Xk=function(d,b){var f=w[b.actionItem];b.actionItem=void 0;f.attack&&(d.attack+=f.attack);f.defence&&(d.defence+=f.defence);f.mana&&(d.mana||(d.mana=0,d.manaMax=0,d.update?d.update.push("mana","manaSpeed",1E3):d.update=["mana","manaSpeed",1E3],Ya({func:eg,data:[d.id,"mana","manaSpeed",1E3]},1E3,1)),d.manaMax+=f.mana,
d.mana+=f.mana);f.level&&(d.level||(d.level=0),d.level+=f.level);pa("bless",d.x32,d.y32);b.inventory.quit(f.id);b.stay55();O(b.id);O(d.id)};Qd.cursor=10;Eg.cursor=10;Le.cursor=10;Ne.cursor=10;Oe.cursor=10;var Gg=function(d,b){xb(b,d,vi)};Gg.cursor=1;var vi=function(d,b){if(d.isSpy&&d==b)b.stay55();else if(Eb(b)||b.checkMana(90,d.id,vi))b.setupDir(-b.x32+d.x32,-b.y32+d.y32),ta(b,b.url.attack,1),Ya({func:Yk,data:[d,b]},nb(b.img)-25,1)},Yk=function(d){var b=d[1];d=d[0];d.die(1);var f=d.rbase().write;
f(b.x32+b.y32*G,b.radix);b.x32=d.x32;b.y32=d.y32;b.d=d.d;b.name=b.name;b.attack=d.attack;b.defence=d.defence;b.update=b.update;b.mana=0;b.manaMax=b.manaMax;f(b.x32+b.y32*G,b.id);Cb(b,32*b.y32);b.__proto__=d.__proto__;ta(b,b.url.idle);f=d.icons.slice(0);f.quit(c.menuBuilds);f.quit(c.menuBuilds1);f.quit(c.menuBuilds2);f.put(c.impersonate);f.put(c.revealSelf);b.icons=f;b.spy||(b.spy=b.kingdom);b.kingdom!==d.kingdom&&b.changeKingdom(d.kingdom);b.setupChild(jb.impersonate);O(b.id)},wi=function(d){d=w[d];
if(d.spy){var b=B[2];d.attack=b.attack;d.defence=b.defence;d.__proto__=b;d.icons=b.icons;d.kingdom!==d.spy?d.changeKingdom(d.spy):d.stay();ta(d,d.url.idle);O(d.id);d.spy=void 0}};Se.allowPos=1;var Fg=function(d,b){if(d.id){var f=d.id,e=d.x32;d=d.y32}else f=-d,e=d%G,d=~~(d/G);if(Eb(b)||b.checkMana(60,f,Fg)){b.setupDir(-b.x32+e,-b.y32+d);b.setupSpellIMG();f=8;e-=.5*f;d-=.5*f;var c=[];f+=1;var g=f*f;pa("bless",b.x32,b.y32);for(b=0;b<g;b++)for(var k=1;3>k;k++){var n=w[(0,qd[k])(b%f+e+(~~(b/f)+d)*G)];
n.build||n.terrain||(n.setupChild(jb.bless),n.blessed||(n.blessed=1,n.attack+=5,O(n.id,1),c.put(n)))}Ya({func:Zk,data:c},3E4,1)}},xb=function(d,b,f){if(d[1]&&w[d[1]].item){var e=d[1];d.length--;tg(d,b,f);w[d[0]].actionItem=e}else tg(d,b,f)},Eb=function(d){var b=d.actionItem;if(!b)return!1;b=w[b];b.attack&&(b.attack--,0===b.attack&&(d.inventory.quit(b.id),O(d.id)));return!0},Zk=function(d){for(var b=0,f=d.length;b<f;b++){var e=d[b];e.blessed=void 0;e.attack-=5;O(e.id,1)}},Te=function(d,b){xb(b,d,Hg)};
Te.cursor=10;var Hg=function(d,b){d.freezed||!Eb(b)&&!b.checkMana(50,d.id,Hg)?b.stay55():(b.setupDir(-b.x32+d.x32,-b.y32+d.y32),d!==b&&b.setupSpellIMG(),pa("invisible",d.x32,d.y32),d.invisible||(Kb(1,1,1,.5,d.bufferID),d.invisible=1,d.stay()),O(d.id),Ya({func:Od,data:d.id},5E4,1))},Od=function(d){d=w[d];d.death||(d.invisible=void 0,wb(d),Yh(d))},Jg=function(d,b){xb(b,d,Ig)};Jg.cursor=0;var Ig=function(d,b){if(Eb(b)||b.checkMana(50,d.id,Ig))b.setupDir(-b.x32+d.x32,-b.y32+d.y32),b.setupSpellIMG(),pa("lightning",
b.x32,b.y32),d.damage(50,b)},Ue=function(d,b){xb(b,d,Kg)};Ue.cursor=0;Ue.noObj=1;var Kg=function(d,b){var f=G;if(d.id){var e=d.id,c=d.x32;d=d.y32}else e=-d,c=d%f,d=~~(d/f);if(Eb(b)||b.checkMana(50,e,Kg)){b.setupDir(-b.x32+c,-b.y32+d);b.setupSpellIMG();pa("flame%20ball",c,d);var g=c-b.x32,k=d-b.y32,n=Math.sqrt(g*g+k*k);g/=n;k/=n;var u=b.x32+.5,l=b.y32+.5;e=[];c=[];var m=0;for(d=0;d<n;d++){var r=u+g*d;var p=l+k*d;c.put(r);c.put(p);r=~~r;p=~~p;e[m++]=r+p*f;e[m++]=~~(r+k)+~~(p+g)*f;e[m++]=~~(r-k)+~~(p-
g)*f}for(d=0;d<0*e.length;d++)g=e[d]%f,k=~~(e[d]/f),n=Object.assign({},Ub.food),n.x32=g,n.y32=k,n.z32=2,Za(n),bc.new(n,5E3);Ya({func:xi,data:{list:e,anim:c,i:2,a:b}},1E3,1)}},Lg=function(d,b){xb(b,d,Ve)};Lg.cursor=10;var Ve=function(d,b){b.setupDir(-b.x32+d.x32,-b.y32+d.y32);b.setupSpellIMG(!0);b.setupINTV(fn,{u:d.id,a:b.id},0);d.addWorker(b)},fn=function(d){var b=w[d.a];d=w[d.u];if(!Ce(d.x32,d.y32,b.x32,b.y32,E[b.kingdom].values.teachDistance))return U(d.id,b,Ve,b.url.move);if(d.level>=b.level)return b.stay();
if(Eb(b)||b.checkMana(10,d.id,Ve))pa("teach",b.x32,b.y32),b.setupDir(d.x32-b.x32,d.y32-b.y32),d.setupChild(jb.curse,!1,Um),qi(d,!1),O(d.id,1),O(b.id,1),Zb(b,nb(b.url.spell))},We=function(d,b){xb(b,d,Mg)};We.cursor=0;We.noObj=1;var Mg=function(d,b){var f=G;if(d.id){var e=d.id,c=d.x32;d=d.y32}else e=-d,c=d%f,d=~~(d/f);if(Eb(b)||b.checkMana(70,e,Mg)){b.setupDir(-b.x32+c,-b.y32+d);b.setupSpellIMG();e=c;var g=d;c-=8;d-=8;for(var k=0;256>k;k++){var n=c+k%16,l=~~(k/16)+d,m=n+l*f;ia(n,l)&&64>=Math.pow(n-
e,2)+Math.pow(l-g,2)&&Ng[m]&&0===Y[xy]&&(T(n,l),new kd(60,b.kingdom,n,l,0))}}},xi=function(d){var b=d.list,f=d.anim,e=d.i,c=d.a,g={x32:f[2*e],y32:f[2*e+1],d:0,img:l.flame_trail,mv:1,z32:2,alpha:!0};Za(g);bc.new(g,nb(g.img));for(g=0;3>g;g++){var k=w[Y[b[g+3*e]]];k.health&&k.damage(96,c)}d.i++;d.i<.5*f.length&&Ya({func:xi,data:d},50,1)},Xe=function(d,b){xb(b,d,Og)};Xe.cursor=0;Xe.noObj=1;var Og=function(d,b){if(d.id){var f=d.id,e=d.x32;d=d.y32}else f=-d,e=d%G,d=~~(d/G);if(Eb(b)||b.checkMana(60,f,Og))b.setupDir(-b.x32+
e,-b.y32+d),b.setupSpellIMG(),pa("freeze",e,d),Ya({func:$k,data:[e,d]},1E3,1)},Ye=function(d,b){xb(b,d,Pg)};Ye.cursor=0;Ye.noObj=1;var Pg=function(d,b){if(d.id){var f=d.id,e=d.x32;d=d.y32}else f=-d,e=d%G,d=~~(d/G);if(Eb(b)||b.checkMana(70,f,Pg)){b.setupDir(-b.x32+e,-b.y32+d);b.setupSpellIMG();pa("confusion",e,d);b=4;e-=.5*b;d-=.5*b;f=G;var c=[];b+=1;for(var g=b*b,k=0;k<g;k++)for(var n=1;3>n;n++){var l=w[(0,qd[n])(k%b+e+(~~(k/b)+d)*f)];l.build||l.terrain||l.stoned||(l.confused=1,l.invisible&&Od(l),
Kb(.7,.2,.2,.9,l.bufferID),l.stay(),c.put(l),Je(l.id))}g&&1===C.length&&O(C[0]);c.length&&Ya({func:al,data:c},2E4,1)}},al=function(d){for(var b=0,f=d.length;b<f;b++){var e=d[b];e.confused=void 0;e.death||(ta(e,e.img,1),wb(e),e.stay(),Wa==e&&(Wa=void 0,C[0]=e.id,O(e.id)))}},$k=function(d){var b=6,f=d[0]-.5*b,e=d[1]-.5*b,c=G,g=[];b+=1;var k=b*b;d={img:l.freeze_expl,d:0,mv:1,x32:d[0],y32:d[1]};Za(d);bc.new(d,nb(d.img));for(var n=0;n<k;n++)for(var u=1;3>u;u++)d=w[(0,qd[u])(n%b+f+(~~(n/b)+e)*c)],d.build||
d.terrain||d.nofreeze||d.stoned||(d.freezed=1,Cb(d,32*d.y32),d.stay(),ta(d,d.img,0),d.invisible&&Od(d),Kb(0,1,1,.9,d.bufferID),d.health-=40,1>d.health&&(d.health=1),g.put(d),Je(d.id));k&&1===C.length&&O(C[0]);Ya({func:bl,data:g},2E4,1)},bl=function(d){for(var b=0,f=d.length;b<f;b++){var e=d[b];e.freezed=void 0;e.death||(ta(e,e.img,1),wb(e),Wa==e&&(Wa=void 0,C[0]=e.id,O(e.id)))}},Ze=function(d,b){xb(b,d,Qg)};Ze.cursor=0;Ze.noObj=1;var Qg=function(d,b){if(d.id){var f=d.id,e=d.x32;d=d.y32}else f=-d,
e=d%G,d=~~(d/G);if(Eb(b)||b.checkMana(100,f,Qg))b.setupDir(-b.x32+e,-b.y32+d),b.setupSpellIMG(),yi(e,d,3,20,4500,b.id)},yi=function(d,b,f,e,c,g){for(var h=l.fire_rain,n=p.gravity,u=Date.now(),m=yi.rnd,y=Math.PI,r=performance.now(),q=0;q<e;q++){var t=2*m()*y,v=f*m(),w=d+v*Math.cos(t);t=b+v*Math.sin(t);v=~~(q/e*c);ia(w,t)&&Ya({func:cl,data:{x32:w,y32:t-6,dix:0,diy:140,img:h,mv:1,d:0,timestamp:u,finnish:Infinity,aceleration:n,attack:40,xf:w,yf:t,range:2,kingdom:0,obj:g,crashTime:(Math.sqrt(19600+384*
n)-140)/n*1E3}},v,1)}T(performance.now()-r)},cl=function(d){Ya({func:sg,data:d},d.crashTime,1);Za(d,0,d.diy,p.gravity)};yi.rnd=function(){var d=4096,b=2048;return function(){b=36969*(b&65535)+(b>>16)&4294967295;d=18E3*(d&65535)+(d>>16)&4294967295;return((b<<16)+d&4294967295)/4294967296+.5}}();var Lb=function(d){Bc(-1E4,0,0,d);Ed.put(d)},ji=function(d){if(d=d.childLoc)for(var b=0,f=d.length;b<f;b++)Lb(d[b])},Rk=function(d){w[d.obj].damage(d.attack,w[d.obj]);Lb(d.bufferID)},dl=function(d){d=w[d];void 0!=
d.bufferID&&Lb(d.bufferID);Ng[d.x32+d.y32*G]=void 0},sg=function(d){var b=G,f=d.xf,e=d.yf,c=d.attack;d.mv=1;d.func=void 0;d.x32=f;d.y32=e;Rc(d,0,0,0);Cb(d,2);f=~~f;e=~~e;var g=f+e*b,k=Y[g];Xa[g]?(d.img=l.expl_small_water,pa("water%blop",d.x32,d.y32)):(d.img=l.expl_small_hole,pa("small%20explosion",d.x32,d.y32));ta(d,d.img,1);bc.new(d,el(Ja[d.img]));if(Xa[g]){if(k=Ta[g],2<k){var n=w[k];n.damage(c,w[d.obj])}}else{2<k&&(n=w[k],n.damage(c,w[d.obj]));g=d.range;k=2*g+1;for(var u=0,m=k*k;u<m;u++){n=u%k-
g;var p=~~(u/k)-g,r=~~Math.sqrt(n*n+p*p);r<g&&(n+=f,p+=e,n=Y[n+p*b],2<n&&(n=w[n],n.damage(c*(1-r/g),w[d.obj])))}}},gn=function(d){if(0<C.length){var b=w[C[0]],f=0,e=0,c=0,g=0;void 0!==b.dix&&(d=.001*(d-b.timestamp),g=b.dix,c=b.diy,f=g*d,e=c*d);if(b.space){var k=b.space;d=k[k.length-1];k=(k.length-1)/d}else k=d=1;f+=32*(b.x32+.5*d-Math.sign(g))+.5*-tzar.width+.5;e+=32*(b.y32+.5*k-Math.sign(c))+.5*-tzar.height+.5;Db=~~-f;Ka=~~-e;Rd(-Db,-Ka)}},fl=function(){};Re.distance="healingRange";xg.distance="createGolemRange";
Fg.distance="blessDistance";Og.distance="freezeDistance";Pg.distance="confusionDistance";Hg.distance="invisibilityDistance";Ig.distance="lightningDistance";zg.distance="createBatDistance";yg.distance="createDragonDistance";Bg.distance="createCarpetDistance";Ag.distance="createJinnDistance";Cg.distance="turnToStoneDistance";Kg.distance="flameBoltDistance";Qg.distance="fireRainDistance";Mg.distance="freezeDistance";Ve.distance="teachDistance";var E=[];var Vb=function(d,b,f,e,c,g,k){this.name=d;this.k=
E.length;this.color=b;this.status="";this.stats={dmgInflicted:0,dmgTaken:0,resources:[0,0,0,0],score:0,unitsKilled:0,unitsLosed:0,buildsLosed:0,buildsDestroyed:0,unitCount:new Uint32Array(B.length),unitCountMax:new Uint32Array(B.length),unitCountDeath:new Uint32Array(B.length),goldTraded:0,goldConverted:0,stoneTraded:0};this.team=k;this.resources=g||[5E4,5E4,5E4,5E4];this.values={gold:10,wood:10,food:10,stone:10,buildSpeed:1,experience:0,healthJump:0,maxLevel:4,pop:0,popMax:p.freePop||1,popLimit:200,
healingRange:1,blessDistance:9,createGolemRange:5,freezeDistance:13,invisibilityDistance:9,createBatDistance:16,lightningDistance:12,createDragonDistance:4,turnToStoneDistance:21,flameBoltDistance:19,fameTech:0,confusionDistance:13,manaSpeed:2,milkSpeed:2,cowSpeed:2,stealCow:0,miningPerf:1,fireRainDistance:15,createCarpetDistance:3,createJinnDistance:3,teachDistance:2};this.race=e;this.racestr=Rg[e];this.IA=c||0;this.building=[];this.diplomacy=f;this.control={};this.control[this.k]=1;this.onFreePop=
[];d=[];d.length0function=hn;this.unitLoading=0;this.target=[0,0,0,0];this.crusade={number:0,list:d};this.technology={hidden:{},disabled:{},actived:{},investigated:{}};this.mod=b=[];Kj[this.racestr]++;d=0;for(f=B.length;d<f;b[d++]={});E[E.length]=this;d=this.k;b=[];Bb[d]={};va[d]=b;for(f=0;f<B.length;f++)b[f]=[];b=this.color;cb[3*d]=b[0]/255;cb[3*d+1]=b[1]/255;cb[3*d+2]=b[2]/255};Vb.prototype.setupResources=function(d,b){var f=this.resources;b||(b=1);f[0]-=d[0]*b;f[1]-=d[1]*b;f[2]-=d[2]*b;f[3]-=d[3]*
b;wg(this.k)};var va=[];var Bb=[];var cb=[];Vb.prototype.check=function(){if(this.values.pop)return!0;for(var d=jn,b=va[this.k],f=0,e=B.length;f<e;f++)if(!d[f]&&0<b[f].length)return!0;this.die()};Vb.prototype.checkPopArray=function(){if(this.onFreePop.length)for(;!De(this.onFreePop.shift())&&this.onFreePop.length;);};Vb.prototype.die=function(){this.death||(this.death=1,this.status="defeated",zi(),Sc(Ai(t.playerDefeated,this.name),0,5))};Vb.prototype.paypal=function(d){var b=this.resources,f=!1,e=
this.k;b[0]<d[0]&&(Sg(e,t.gold),f=!0);b[1]<d[1]&&(Sg(e,t.wood),f=!0);b[2]<d[2]&&(Sg(e,t.food),f=!0);b[3]<d[3]&&(Sg(e,t.stone),f=!0);if(f)return f;b[0]-=d[0];b[1]-=d[1];b[2]-=d[2];b[3]-=d[3];wg(this.k)};Vb.prototype.paypalTest=function(d){var b=this.resources;return d[0]>b[0]||d[1]>b[1]||d[2]>b[2]||d[3]>b[3]?!1:!0};var Sg=function(d,b){d==x.kingdom&&Sc(Ai(t.notEnough,b),0,5)},wg=function(d){if(d==x.kingdom){var b=E[d].resources;d=b[0];var f=b[1],e=b[2];b=b[3];Infinity==d&&(d="***");Infinity==f&&(f=
"***");Infinity==e&&(e="***");Infinity==b&&(b="***");gl.innerHTML=d;hl.innerHTML=f;il.innerHTML=e;jl.innerHTML=b}},jn={13:1,20:1,21:1,22:1,27:1,32:1,35:1,36:1,43:1,44:1,55:1,56:1,57:1},Nb;var kl=[];(function(){var d="",b=new Image;b.src="data:image/gif;base64,R0lGODlhIQB2AfcAAAAAABAIAAgAABEhACE6ABkbChAQAAgIABAQCO/vlN7epf/6hZSQUv76n721a//rY/XmhnNjECklEP7oecW1Y+7ZeP/rhvvrljEpCCgiB+/Wa97OjP/WSu3YhyEZAIhzLf/WWOnHWv7baL2lVt3Db/vsvUo3BGtSCGhVIdq1SnhjKdy4V62USuvIaPzad/felO/XlzopAGtaMe3Kd/zbiOjMhv/9+JxzGWNKECEZCP/JSuu5Sc6lSMynV4tzPdSyaK2UWjEhADopCNacKWNKGVdCGf/IVuu4VruUSPzJZ7qYU0IqABkQAGdFB2tKEFI6D5tzKMqVN9unSNyrVlRDI/nLd7JwACkZAOaUEDEhCMSMMZRrKYlkJ/u3SJt0M8yYRquDQO66Zu3MlrWcc5haAItSAf+lGUIqCGNCEJdjGXpTGJxrIfisOGtKGcSNOtacQruHOfu6VsiYVOm6dPvLh/rZqTohAHdHB3NKEFo6D0kxEJRjIc6MMalzKYRaIZxrKXlTIuCcP6x5M+umR1I6GX5aKdacSuqqVdedUollNK2HVUopAFQxBXtKEGtCEMmBJ7h2J3NKGdeNNMOCMWNBGZRjKf2rR86MOtaUQpdpMt6cSrqFQkk0GnVWL9OjZolVGeeQLJ5jIKdqJ4xaIeCTObd6NembRt6UQsWEPGlHIf+tUsuMQ9aUSppyRzEZAGU1BkopCHNCEDohCFIxECkZCPeXM3tKGdKDMIRSIZxjKlo6Gc6EOoxaKahwNt6USjUkE/zLmUIgACEQAIZLEtZ2H5ZUF2Y6ELlpIN9/KGtBGUUpEHVKIRkQCNaMRntCEHNCGZdZI86MUjoZAFQoBs5qIF0xECUZEE8hAHQ0CIQ9C5RHD65TFb5cGXY6EDEZCHtCGYRKIVIxGSkQAEohCEIfCVIpEKJEEUUpGWgnBzoZCEIzKzEQABkIAHMpCIw0CyEQCFsZAlEZBikQCDQZECEHAD4PATEQCGshEDEIAPNGKRkAABAAABkICBAICAgICP///yH5BAEAAP8ALAAAAAAhAHYBAAj/AP8JHEiwIEEBBhMqXPiP3QGEAwVAZKgQYoBwLAIMpIUCwESKE5lI/CeA0woU+wTSIvHk40IBD/9x+vHrnYB9+358EbdPwDsavfi5NMiEChcA/5i0QIKrzTsANeQoC+DzAhJvKYcK3AeoAheqAlbo0XNGlpIKR5axEyChwwo/U7UK+EWiAxRdgH5RGnWpD6ArwpCUWlaES40WX0pRompQwIcXLbR8ObKi1BdUcXatMsZuFCUuUtxKidLr11ABT5Ag+tIHjK5MYb5UilPqlK0rVwKkmiJFyyVBpgsyCRCAEpIvyubJC4CkCq9Rh3JhqiRSAJQvcPgIUgaTIIofMvL8/5hCKwfEHmEiDcq0CtosdklHjeoDaSpSgQKoWGjRowMYWh4JlEgYm4wyhR+buaKLAEwoQ4gfs9CikUBM/OBWCytEAuBESIThhyZbVGILOU+QJEAOhFBCyy/44QDDDFKsgJwwqRA0oBejiBJJMmecYSIAOSxjjzf4jeLCFNi9ocxugAyk3hSVhIILGmd4U6KJ77yTAzu/cMIOZXBQ4gcsRXyRhB4CPXEJHT2U4kUyeggzS0QCABAAHD0koUIP/HkjzwH/+ODCFz7qUQoNM3zBVB5X+GjQLGBQtkIHSTxDXAB5wGFBGEUUcUsVF8SWSzJZyJLQTZUc0cIMK7ghhAAZ/P9DySAWuBCHKYdcMMMUgkQSZxGnyiPFF27wIAUX9hgQQBu4DOKCrVLQUMURboySBxNonurFCmn4UYoWfsiT0l6TDBLHIWGEgeQfaAQhREXhrADHLLrgIsgswgiURySiuCEFK4dg4oYoz5yhlUDiRCEFJfZk0UYeNgkkizGfiCJKKajAkYstswTQpEKzVsIOO+Rk4Y1IAglzRh7OQFOKIKF8wmgWClHVhyRFBOARLbRMxI4wsDgSSh99jJKMLKfNxY4abgiii851fiQAO64Yc4woebiCckE5qFCFEnB8IcUWv2zdmDDDSCMRg40RIkgILVAmxRPvTJjQPuwA4FG+pzL/w8UkYGCXzC8BJkSVnSBloYssnMxSsgEHU2RQFjoH4I0wkUuuEAB4Z655RZ8rVAIgzIQeehx0RMKE6Z9XkcQspbNOESZ0xAG77BQFAoztseOukO6WlNO77waZUocls+RAvEKHHJ/88gk1X4sxtEBvUBh1sGGM8tYTNIgNtXzC/T9kVA99IOA/f0cJtYxPPB82gHLHP03QYAU93fOBzDE5bGLKK90byB1I4Q3zdS8PjGhCCaxgQOjdwQZWMAMtzIAFmlmPBmzIAiX+8YohlKEM81teGXg2kDLYgAZkCOBAmlCLWtxHhf/4IAxnSMMa2vCGOMyhDnfIwx768B82QEMN/2dgg3fN0BNhsAERZtgKRMDABsaYISvCAIMSPINIAczEEeRQhxK8woLWe8UOLrGCElzAFukIIB+O8IgpXGAOr0hHH6yXiyQkRgwwSMIdvGGx5anBCFNYhSjmMIcj3MAbgIDE8jQRBkQIYg3j2YEUZBELLRAPCUk4hBy4kAs5wEFh8nDEG6KAuyZkcgpwaEQvFCGIK3jjDIx4xA5wd4QjBPITjviDMITBjiysCAMvDF0f4iCFUkBDDx6QhTVmIY/CyY4eSZACKi5BjgA0QgtbkEUDZReFHexAHOKoRAPC0IZXLm8ZIBCHzvTgiVKlwhrLO4cx9oEUAGSAFnKYAhf6of9CABxAEDtIhCxMAMMA7OEMPSiGGmDIiDF0AAnQgOEBQFEDRgSzeyYoBqZ+yNGOevSjIA2pSAVygic0gXVLkFwT3BGPeIQOHYx4wkUL0gRzcCMe2KiH5tCBDnfo7R/kUIg79hcPdLhUcuiwqUvrwQiDtJQatQiEOdxBAKQO9RgR6GlCpsENZOgAGdxoRzAo8tSoTpUA7RhIPYo6VB3ooAuSaCpFuOpVsLZDrsFohzt4So0u6MAIICjGWBligra+Na7uYEQw3OGOf5iAG2z46wOksA10UAQdff1rYBlbD3MU4x/40EYtACuCB1SWIo+NrBEmy9MMcIMa7sAHPh6hAxD/GIEDoOAGNggrWtKaFh3C2AYoGCvbY7CBDaAgRjF2S9ha1Pa2oMgGPhhRC9hqY6/aSC4xZMHchZgAG9g4bnKLEQ/hgsIc1KCGOeqhjW6wFJwUwYY7skuM7b5iG1A9BlSJgQ5yoMMY2CiA5kyAjm24Nx5LcAc12BAIZBx3G8HARgbEEVTJYWMc4/gvNmiBDmKAQge1YEMXkGEOciDucxgex4QZUY/6dsEIx60FMnA3DmwwIwCMYIQ5zEGMOOiADSGuMOsC8F1s5HjHo+1CLUABCuIFYLc7tikpunAL4Q4Deozdhja2wQ1zwOMRw7gy8eABj20Uoxxchgc5lKGM5cGj/7NnCEA3wgqAJaQUeu2gypPRUY9pbMN6AchCBhAQjAybo3tkzkA83lEAIXcvB9gQRwGkMdJKW/rSBlHGDFhHAxZRJAdV2PTnfhCGbSbkHZqgQRg0hwgXaMLTDBEGL1ywK4qsIgxJyISpDSKMZEBCD0VIxEIooQxvbCMZuy6IN6YSgGQPJAuY24ezB+IndsDCCFFUSB6mAIt3sAOLmnsGJXRBhSIAQhB9EIUXEkGIZETI0Zr7hS5IMYELXKABF6hAC5JwhC+0wZes08UXBpEEC1igAQ2oVRICAYdKKAPeklvGwI0wgYM3YAJJiMMb4MALPUw7Ictwg7lEgHFTTCEJYf9wQy9SUZOA/yEQcQDBD/KRD3f4AA598MMTaPEO1inDW4OwRCvu4Y56qAMQe2iDMnIgD9Z5IxJ9MIUlOsGJeajj6J/QxS+Y8XGD0IISezhFF7rwB3VQAQqTiESEEADuz3ljFkDvgghEYIRBKGbpzADj52ThsJfL3QVGOAIXnpAFZuRddjl4Ai5IYQkjiICYfvA4M3ouO1n8IhKCGIQRkmCJLwBi6c32nTcI0Qdz1V0QRaBc1xkiC13AwQinJwQz2o67TCjDGKUwRR+MUQ0JWO8Qn3+HhNjxiVNA7xBfqIaQx5EHTKyCeGCYAiXSSJB08IIUgsBdKwyBC9oLRBm5sLv/7MCQiDYrJBWtyASm189+9tvBDq4QBwyfMApW9CEZ7EhJ98Cwik3EYRKrYFHdkwhV8AW4kASiYAqRMDLWIwc0gAu2cAi4oAm84DmjVgV5IIHNMApnMFOy4zWbAAiH8AyowAj0MCfQowRzEAmHUAi84AhXQFCycyUCUgWZgAu5gAbGcAWuIDtEcAjAIhDJcAg/wAuVoAbV4ArsIIOh8wRy4AJBIBBnsAoX8AOb4AXGEAz7YCqs4wMQgAhX8A9nUAoXQANToARqwAhUIzsmsAoJEAZjsQs00AAFWAnGsEu4kwdxkAATcASkEAYNoGqCEAvBIADZYjqUoAaHAAEYlyuq/2aAsCAAjsI6eTAKbnAIKFcFVRAGhvAHeSAMYYg7JuAIorAKU4AIYcAKXyAKO+iBnyMOjKAGfyAKvVAKm5ALjhAMAPAxuLMP0jANxjAMgiAI0OAIsPAzy+MRrjANwwAN0MB74uCKoaM3+jANxVAMdrAW0mg6nPMK9KA3zgQ9HgGOdmM94LiN7ZeO6riO7HhpvdALgJAKNdI9QFAKq7AKqggGhQBrvvMDM2AKvsAK94gKm5AJ50A8PwADdBAGAMkKqECQmyAInOA7JFACM3AIhzAIlXBurLAJBTmRsvMDJVADh7ADEPACiZAKuXePnYA7P2ADdRAGgzAHNqAA35AKnP+QCJ1ABbjDRSUQBhipATZwBLkAADc2ALgDBh1AA3FzBKkQAhuwCalQjrKDCPl2BILgD9TQC60QDa0gYL6TCj/QAodwDgDACZsADK3ADAiwPKmQCVQQO5nQCe/Qb9XglsFEBb9QBz8gCLYAQ79ABXy5ChukQr/QCTDgCaUQDoBJBWLgCZkAkgH0C4nwmJnAmIbZCmIgB51AldDzC62gCOqQAZ65PL/wCwdAHDN0Ke3Ymq75mrAZm7ApmbhDmwSRCqdQmOFgfp9DCKigC5kGCKUADsogAnCFmQwRB3GgBxeDC6aWBctwBtzwAA1gCZFAEV0wAQ1wDNWQDJRnEAeQBZD/YAkuUJ28aRCWUHGWgAzCoHeZJgi7kJ4NcAsKUQsNIAKmIAmiAJwMkQOUwC+3cAQQkAwGkQsL0AWQMArQoCGSkwM8MwvVMAu+QhCzoAbdMA16oE3uwzq4EAeqcJ7W06ElIALQAKLLE4E0cAvpUJq+MwtWMw4BsDoq9A4ZyqIU8XV/UAqScJ9GwIsDMQopQAKBMAkv0waHyDX+VApJUAITEAi8gJwDoQzHcAQlQAeDwAVTYaL/ACBMcABwMAinIApQShCyAAldkACJEAAHACQJoQx/gAzKcABuUApaOhDGIAnHAADdoA0kVBCzIAmWwAbcAADLkAx1+n1/wAS/wAeg/0ANBaEMcKAKpoAJnZAFAKAHhzoQyaAzlPAFpkAKkGBBunEJojALT2GUR6oQlKM3utALl0CnysMMB7AM5sMzY7oQv2A+DqML72B+zMCPxMMJB7B6slmsxnqsyNqO+0AfvoMOxcANxIAMknALx9AHoHgEgzAIxxA6jNAIj0AKRxCI0hIGkjAM7JAG5UmHpvA5mNMIXeAGaeAIS3AF4tAEWfMIoGAEFjcDbyA5IoEbxMEOTMAEAssEwuAEofAIjyAJSfAsUyA5+ReF//AJgjAJdwaKrrAIefAKd3AHogAH/fo5dyAGJWAJ1BAD/yAM4mAHMWAHgLFLBksRFisQV0ADSf8wCKGwCLgzCW/AB4GABsPxD3aQbq/wCnbwOVwABsYyAzRgK4MQBIUDGOIgo/8AB1uABqJAgwQhDksjBWFQBS5QBVGAOaIACYvwBGcQA4wgCF57CHFACqJwZwkBAMGwDccACX2xD0EgCpJgBC5gAWVYBdIyGsVAD/LHEPtwDdjwCX2wFsWQBpCgsNN6CZOQBp8QC9JwBVTLEAHADoygM0zgCuswDdfAU9LQE5wTDD34OewQAK6gfzPEN8k6u7Rbu7Z7u7ibu5rTB+LAhSr0LNPAN4VgqbuoBJ+FOyKwAq9gCAYXBqUwAxVAAz8wDdhwvKxTDCFgAUlwb67TAmEwA47/kA2LKzsNsABJAHtx0AWB0AMkQAl5EwvOwDoJB3tG0AWDQApTAAaYQxw/FTrl6wIZ1wWgQAqIsARrozcWWBAAbARxMAiSgAibsL/nKDthgK2kgAmIYAwSoY11gjtTsAluoAmlQBX0cAYqEBO+AwdKoASMIBH0Cgap4AqhiDtKoAiuQBUHgAcqsAAO0AEMQDxMIA514hEBIAwU8ASfcAUJ/DlXUAFPYLfXsBYBdAbbUAWmEAoC2D2u8AoAPAmfIMXdIwClUAWaAA0trEKycAhVAAmOgDkBZAe4EAY/8AmRqEJnAAdzIAiOcMMqxAhfMAqzQDl2nMRqaqO4kxtLrLuK/7zIjBxSsLAIROIEgMkCUqAOUDANAbQFH8ACK+ACbfAJAqEGLLBQvpMBbbACK9AFXOAov7ADR+s7A5ACPAACg2ALRiQNtHANy+MNn5AMsMAEJ2UQetAGbcAIsAAFn0MLJsAOdiBXBgEASAAIPdAK5ODMC+EIjjANWSACSDEWZSEQX0ACYcADK2AIMkIR2VAEKwA0D8AEe9EXfyEMAGAMSRACIdArM7wQAXAEI8AFM9AGXnAZmbEZ7JC8UoAEUfAJqWo4gGABSqABI6AHmyAbtGEbuNEHe4AHdWYQd2DCjKAJLoAEIr0CUiAFhFAERQgd0kEd7CAPApBsDDABLSAA5P/gLCtAGVPwB0TgA+mxHu3xHuxwDbsGAJsQAl2gN8swCFMgKVJgDHpAIAaCIMagIAshDVzQBVpwAFywADCCylOQCZSgB53gISAiIiTCEOGgN1CgBUUbBVGgDFygBt7wDlwQBjiiIzwyiQnxCgLACK7gCrvIBYSwCUXwBHP9JFEyJVWitQzRD81w0mYyFkygJmziJnAiJ5rzCrLwDD4hKIQyD4aCKIqCC4yi1wvxCvQkDrSQKZvSKZ8SKl8wKqXCOgbgDbNSK7eSK7vSK7/CED4ABipQEMziLNAiLdRiLdiyEMxwBF1gouRiLuiiLl/ALu6yENOQCG0ACwmxL/3yLwFJMzAFkzmguBATUzEXkzEb0zE+yjoqwzIuAzMycwXuyTo/EzRDUzRHk8gVQTVWgzVao98vgTZqIxGbuzx4g8CyC2h1YsiN/DkBAQA7";
var f=document.createElement("canvas"),e=f.getContext("2d");b.onload=function(){f.width=33;f.height=34;for(var c=0;11>c;c++)e.drawImage(b,0,34*c,33,34,0,0,33,34),kl[c]=f.toDataURL("image/png"),d+=".ncursor"+c+"{cursor:url('"+kl[c]+"'), default}",e.clearRect(0,0,33,34);document.getElementsByTagName("style")[0].innerHTML=d};od(2)})();var Uc,Fb,Vc,Wc,rd,Pa,$e,Ac,aa,Bi,Ci,Di,W,Sd,gl,hl,il,jl,ll,Xc,Tg=function(){if(!Tg.setup){Tg.setup=!0;q("content").innerHTML='\n<ul id="msgs1"></ul>\n<div id="clicks" style="display:none;margin-top:0;margin-left:151px"></div>\n\n<div id="playersinfo"></div>\n<div id="resources" style="display:block">\n<div id="gold"></div>\n<div id="wood"></div>\n<div id="food"></div>\n<div id="stone"></div>\n<div id="pop"></div>\n<div id="temperature"></div>\n</div>\n<div id="enterwindow" class="displaynone">\n<h2 id="sendMessageH2">'+
t.chatMsg+'</h2>\n<input id="msginputGame" />\n</div>\n\n<div id="statButton"></div>\n<div id="topinfo"></div>\n<div id="bottominfo"></div>\n<div id="mapeditorinfo">\n<div id="sButtons"><button id="selectUnits">'+t.units+'</button><button id="selectBuilds">'+t.builds+'</button><button id="selectItems">'+t.items+'</button><button id="selectNature">'+t.nature+'</button></div>\n<div id="mapeditorinfoUnits"></div>\n<div id="mapeditorinfoBuilds" style="display:none"></div>\n<div id="mapeditorinfoItems" style="display:none"></div>\n<div id="mapeditorinfoNature" style="display:none"></div>\n</div>\n<div id="mapeditorinfotop">\n<button id="menueditor">'+
t.menu+'</button>\n<button id="deleteUnit" style="color:#f00;font-weight:bold;font-size:19px">x</button>\n<button id="rotatebutton"></button>\n<button id="mapProps">'+t.options+'</button>\n<button id="mapRules">'+t.rules+'</button>\n<span>Brush size: </span><input type="number" min="1" max="256" value="6" id="brushSize"/>\n<span>Active kingdom</span>\n<select id="selectKingdom">\n</select>\n</div>\n<div id="minimap" style="position:absolute;top:31px;left:4px;z-index:99"></div>\n<div id="menu" style="display:block">\n<button id="gameMenu">'+
t.menu+'</button>\n<div style="width:151px;height:calc(100% - 741px);top:645px;background:url(/nehhon/menurepeat.gif) repeat" id="kingdomcolor"></div>\n<div id="daynighticon"></div>\n<div id="icons20">\n<div id="attackmenu" style="display:none"></div>\n<div id="defencemenu" style="display:none"></div>\n<div id="levelmenu" style="display:none"></div>\n<div id="manamenu" style="display:none"></div>\n<div id="manamenu1" style="display:none"></div>\n</div>\n<div id="progressvalue"></div>\n<div id="kingdom"></div>\n<div id="unitname" contenteditable="true"></div>\n<progress id="progressone" style="display:none"></progress>\n<progress id="progressmana" style="display:none" max="100"></progress>\n<input id="unitSpeed" min="1" max="100" type="range"/>\n<canvas width="48" height="48" id="selectedobject"></canvas>\n<div id="navigation">\n<button id="aleft"></button>\n<button id="stock"></button>\n<button id="aright"></button>\n</div>\n<div id="orders">\n<button id="order1"><progress class="loadingunit" style="display:none"></progress></button>\n<button id="order2"></button>\n<button id="order3"></button>\n<button id="order4"></button>\n<button id="order5"></button>\n<button id="order6"></button>\n<button id="order7"></button>\n<button id="order8"></button>\n</div>\n<div id="magicworkshopmenu" style="display:none">\n<button id="mgbook"></button>\n<button id="mgpotion"></button>\n<button id="mgsword"></button>\n<button id="mgamount"></button>\n<button id="mgitem"></button>\n<button id="mgdecline"></button>\n<button id="mgaccept"></button>\n<div id="mgbak"></div>\n</div>\n</div>\n\n\n        ';
Xc=q("msgs1");W={page:0,length:8,leftButton:q("aleft"),rightButton:q("aright"),stock:q("stock")};W.leftButton.onclick=function(){W.page&&(W.page--,oa(W.active,0,W.stockActive))};Uc=q("minimap");Sd=q("unitSpeed");gl=q("gold");hl=q("wood");il=q("food");jl=q("stone");ll=q("daynighticon");W.rightButton.onclick=function(){W.rightBlocked||(W.page++,oa(W.active,0,W.stockActive))};W.displayed=[];Fb=q("attackmenu");Vc=q("defencemenu");Wc=q("levelmenu");rd=q("kingdom");Pa=q("progressone");$e=q("unitname");
Ac=q("progressvalue");q("selectedobject");q("mgbook").onclick=function(){ea.actual="book";ea.id=0;ea.amount=c[ea.book.ord[ea.id]].obj.spcost[0];ea.func()};q("mgpotion").onclick=function(){ea.actual="potion";ea.id=0;ea.amount=100;ea.func()};q("mgsword").onclick=function(){ea.actual="sword";ea.id=0;ea.amount=100;ea.func()};q("mgdecline").onclick=function(){q("magicworkshopmenu").style.display="none"};q("mgitem").onmousedown=function(b){var d=1;b.button&&(d*=-1);b=ea[ea.actual].max;0>ea.id+d&&(ea.id=
b);ea.id=(ea.id+d)%b;"book"==ea.actual&&(ea.amount=c[ea.book.ord[ea.id]].obj.spcost[0]);ea.func()};q("mgaccept").onclick=function(){I(Ei,[ea.actual,ea.id,parseInt(q("mgamount").innerHTML)],C[0])};q("mgamount").onmousedown=function(b){var d=10;"book"==ea.actual&&(d=c[ea.book.ord[ea.id]].obj.spcost[0]);var f=d;b.button&&(d*=-1);Jb.shift&&(d*=5);ea.amount+=d;0>=ea.amount&&(ea.amount=f);q("mgamount").innerHTML=ea.amount};aa=[q("order1"),q("order2"),q("order3"),q("order4"),q("order5"),q("order6"),q("order7"),
q("order8")];Bi=q("bottominfo");for(var d=0,b=aa.length;d<b;d++)aa[d].addEventListener("mousedown",kn),aa[d].addEventListener("mouseup",ln),aa[d].ordid=d,aa[d].addEventListener("mouseenter",mn),aa[d].addEventListener("mouseout",nn);q("stock").addEventListener("click",function(b){(b=w[C[0]])&&ml(b)});Uc.addEventListener("mousedown",function(b){var d=b.pageX-4,f=b.pageY-31;0==b.button?(document.addEventListener("mouseup",function n(b){document.removeEventListener("mouseup",n);document.removeEventListener("mousemove",
Ug)}),Td=!0,Ug(b),document.addEventListener("mousemove",Ug)):2==b.button&&(d=~~(G*(b.pageX-4)/Cc),f=~~(ha*(b.pageY-31)/dc),I(Tb,d+f*G,C))});Ci=[manamenu,manamenu1];Di={mana:{background:"0px -120px",progress:progressmana},food:{background:"0px -240px"},milk:{background:"0px -280px"},gold:{background:"0px -260px"},stone:{background:"0px -320px"},wood:{background:"0px -340px"}};q("selectUnits").onclick=function(){q("mapeditorinfoUnits").style.display="block";q("mapeditorinfoBuilds").style.display="none";
q("mapeditorinfoItems").style.display="none";q("mapeditorinfoNature").style.display="none"};q("selectBuilds").onclick=function(){q("mapeditorinfoUnits").style.display="none";q("mapeditorinfoBuilds").style.display="block";q("mapeditorinfoItems").style.display="none";q("mapeditorinfoNature").style.display="none"};q("selectItems").onclick=function(){q("mapeditorinfoUnits").style.display="none";q("mapeditorinfoBuilds").style.display="none";q("mapeditorinfoItems").style.display="block";q("mapeditorinfoNature").style.display=
"none"};q("selectNature").onclick=function(){q("mapeditorinfoUnits").style.display="none";q("mapeditorinfoBuilds").style.display="none";q("mapeditorinfoItems").style.display="none";q("mapeditorinfoNature").style.display="block"};q("selectKingdom").onchange=function(){x.kingdom=parseInt(this.value);var b=E[x.kingdom].color;this.style.background="rgba("+b[0]+","+b[1]+","+b[2]+",.8)"};q("mapProps").onclick=function(){q("mapPropsWindow").style.display="block";kb();if(""==q("mapPropsWindow").innerHTML){var b=
document.createElement("div");q("mapPropsWindow").appendChild(b);var d=document.createElement("table");b.appendChild(d);d=document.createElement("div");d.innerHTML=t.mapName;var c=document.createElement("input");c.value=p.name||t.strcusMap;c.id="mapName";c.type="text";b.appendChild(d);b.appendChild(c);d=document.createElement("div");d.innerHTML=t.description;c=document.createElement("textarea");c.type="text";c.value=p.description||"";c.id="mapDescription";b.appendChild(d);b.appendChild(c);d=document.createElement("div");
d.innerHTML=t.author;c=document.createElement("input");c.id="mapAuthor";c.value=p.author||"";c.type="text";b.appendChild(d);b.appendChild(c);b.appendChild(document.createElement("p"));d=document.createElement("button");d.onclick=nl;d.innerHTML=t.close;b.appendChild(d)}Fi()};q("mapRules").onclick=function(){q("mapRulesWindow").style.display="block";kb();if(""==q("mapRulesWindow").innerHTML){var b=document.createElement("div");b.innerHTML='\n<div id="mapEvent">\n<h4>'+t.events+'</h4>\n<select id="eventOptions" style="display:none">\n<option value="objAction">'+
t.objAction+'</option>\n<option value="objZone">'+t.objZone+'</option>\n</select>\n<div id="eventScreen">\n</div>\n<div id="eventLayout">\n</div>\n<button id="addEvent">+</button>\n</div>\n<div id="mapActions">\n<h4>'+t.actions+'</h4>\n<select id="actionOptions" style="display:none">\n<option value="objOrder">'+t.objOrder+'</option>\n</select>\n<div id="actionScreen">\n</div>\n<div id="actionLayout">\n</div>\n<button id="addAction">+</button>\n</div>\n<h4>'+t.rules+"</h4>\n";var d=document.createElement("div");
d.id="rulist";b.appendChild(d);d=document.createElement("button");d.onclick=on;d.innerHTML="+";b.appendChild(d);d.id="addRule";b.appendChild(document.createElement("p"));d=document.createElement("button");d.onclick=nl;d.innerHTML=t.close;b.appendChild(d);q("mapRulesWindow").appendChild(b);q("addEvent").onclick=pn;q("addAction").onclick=qn;q("eventOptions").onchange=function(){var b=ol[this.value];qa.div=b.id;Ca(qa.div);qa.active.name=this.value;b.func&&b.func();b=q("eventScreen").getElementsByTagName("button");
for(var d=!1,e=0,f=b.length;e<f;e++){var c=b[e];if(c.sdiv)if("none"==c.style.display)c.sdiv.style.display="none";else{if(!d)c.onclick();d=!0}}Vg(Gb.active,"eventLayout")};q("actionOptions").onchange=function(){Ua.active.name=this.value;Vg(Gb.active,"actionLayout")};b=document.createElement("div");b.id="edobjAction";var c=document.createElement("select");c.innerHTML='\n<option value="attack">'+t.attack+'</option>\n<option value="destroy">'+t.destroy+'</option>\n<option value="moving">'+t.moving+'</option>\n<option value="capture">'+
t.capture+"</option>\n";c.value="attack";c.id="selectionEvents";c.onchange=rn;var g=document.createElement("section"),k=document.createElement("section"),n=document.createElement("section"),l=document.createElement("section"),m=document.createElement("section");d=document.createElement("button");d.innerHTML=t.add;d.onclick=Ud;var p=document.createElement("div");p.className="unitList";p.id="zoneList";n.appendChild(d);n.appendChild(p);p=document.createElement("div");p.className="unitList";p.id="unitListDiv";
p.spType=qa;d=document.createElement("button");d.innerHTML=t.add;d.onclick=function(){qb(this)};d.button=p;d.style.margin="10px";g.appendChild(d);d=document.createElement("button");d.innerHTML=t.defined;d.onclick=Mb;d.sdiv=g;b.appendChild(d);d.onclick();d=document.createElement("button");d.innerHTML=t.undefined;d.onclick=Mb;d.sdiv=k;b.appendChild(d);g.appendChild(p);b.appendChild(g);b.appendChild(k);b.appendChild(document.createElement("p"));b.appendChild(c);b.appendChild(document.createElement("p"));
p=document.createElement("div");p.className="unitList";p.id="unitListDiv2";p.spType=qa;d=document.createElement("button");d.innerHTML=t.add;d.onclick=function(){qb(this)};d.button=p;d.style.margin="10px";l.appendChild(d);d=document.createElement("button");d.innerHTML=t.defined;d.onclick=Mb;d.sdiv=l;d.id="byButton1";b.appendChild(d);d=document.createElement("button");d.innerHTML=t.undefined;d.onclick=Mb;d.id="byButton2";d.sdiv=m;b.appendChild(d);l.appendChild(p);d=document.createElement("button");
d.innerHTML=t.zone;d.onclick=Mb;d.sdiv=n;d.id="eventZone";d.style.display="none";b.appendChild(d);b.appendChild(n);b.appendChild(l);b.appendChild(m);q("eventScreen").appendChild(b);ma("mapEvent");ma("mapActions");b=document.createElement("div");b.id="edobjOrder";c=document.createElement("select");c.innerHTML='\n<option value="move">'+t.move+'</option>\n<option value="attack">'+t.attack+"</option>\n";c.value="move";c.id="selectionActions";c.onchange=sn;g=document.createElement("section");k=document.createElement("section");
l=document.createElement("section");m=document.createElement("section");p=document.createElement("div");p.className="unitList";p.id="unitListDivAction";p.spType=Ua;d=document.createElement("button");d.innerHTML=t.add;d.onclick=function(){qb(this)};d.button=p;d.style.margin="10px";g.appendChild(d);d=document.createElement("button");d.innerHTML=t.defined;d.onclick=Mb;d.sdiv=g;b.appendChild(d);d=document.createElement("button");d.innerHTML=t.undefined;d.onclick=Mb;d.sdiv=k;b.appendChild(d);g.appendChild(p);
b.appendChild(g);b.appendChild(k);d.onclick();b.appendChild(document.createElement("p"));b.appendChild(c);b.appendChild(document.createElement("p"));p=document.createElement("div");p.className="unitList";p.id="unitListDivAction2";p.spType=Ua;d=document.createElement("button");d.innerHTML=t.add;d.onclick=function(){qb(this)};d.button=p;d.style.margin="10px";l.appendChild(d);d=document.createElement("button");d.innerHTML=t.defined;d.onclick=Mb;d.sdiv=l;d.id="toButton1";b.appendChild(d);d=document.createElement("button");
d.innerHTML=t.undefined;d.onclick=Mb;d.id="toButton2";d.sdiv=m;b.appendChild(d);l.appendChild(p);b.appendChild(l);b.appendChild(m);d.onclick();q("actionScreen").appendChild(b);ma("mapEvent");ma("mapActions")}};Sd.onchange=function(b){I(ug,parseInt(Sd.value)/100,C)};q("deleteUnit").onclick=function(){I(af,1,C.slice(0))};q("rotatebutton").onclick=Bm;q("gameMenu").onclick=Fj;q("menueditor").onclick=Fj;q("statButton").onclick=function(){Gi(E.slice(1),!0,p.now());kb()}}};Tg.setup=!1;var mn=function(){var d=
this.ordid,b=W.displayed[d],f=w[C[0]];if(f&&f.kingdom)var e=E[f.kingdom];if(b&&(void 0!==b.unit?(f=B[b.unit],f={name:f.name,cost:zk(f.cost,b.hero||b.merc,e.values.fameTech)}):f=b.obj,W.stockActive&&Yc(W.active[d].id,1,1),f&&f.name)){var c=f.name;d="<span>";d=2==c.length?d+(c[0]+" - "+c[1]):d+c;if(c=f.cost){!f.tech&&e.mod[f.type]&&e.mod[f.type].cost&&(c=e.mod[f.type].cost);d+=" - (";for(e=0;5>e;e++)c[e]&&(d+=c[e]+"<img class='resource' src='"+tn[e]+"' /> ");d=d.substring(0,d.length-1);d+=")"}d+="</span>";
if(C.length){e=E[w[C[0]].kingdom];if(e.technology.disabled[b.id]){c="<span class='red'>"+t.requires+": ";var g=va[e.k],k=e.technology.investigated,n="",l=b.requireObj;if(l)for(var m=0,p=l.length;m<p;m++)e=l[m],e.tech?k[e.nu.id]||(n+=e.name[0]+", "):g[e.type].length||(n+=e.name+", ");n.length&&(n=n.substr(0,n.length-2));d+=c+n+"</span>"}f.type==ib&&(d+="<span class='increase'>+"+f.increase+"</span>");(f=W.active.cut)&&f[b.objName]&&(d+="<span class='shotcut'>"+f[b.objName].toLocaleUpperCase()+"</span>");
Bi.innerHTML=d}}},nn=function(){W.stockActive&&Yc(C[0],1,1);Bi.innerHTML=""},ln=function(d){jd=d.button;pb(this.ordid)},kn=function(){this.style.transform="translate(2px,2px)"},bf=function(d,b){q(d).style.display="block";bf.actived=d;b.actual="potion";b.id=0;b.amount=100;b.func()};bf.actived="";var ea={potion:{bak:1,max:4,ord:["level","mana","attack","defence"]},sword:{bak:5,max:3,ord:["attack","attackBow","defence"]},book:{bak:8,max:18,ord:"fireRain lightning healing createCarpet createBat bless freeze confusion invisibility createGolem magicVision raiseDead turnToStone whirlpool createDragon flameBolt teach createJinn".split(" ")}},
Ei=function(d,b){b=w[b];var f=d[2],e=[f,0,0,0];Nb.paypal(e)||(f=~~(250*f),"book"==d[0]&&(f*=2),b.setupINTV(pl,[d,b.id],f),b.lcost=e,b.techStart=b.c-p.cycle,O(b.id)&&(q("magicworkshopmenu").style.display="none"))},un={defence:6,mana:0,level:2,health:1,attack:5},vn={attack:"sword",attackBow:"bow",defence:"shield"},wn={attack:.5,mana:1,defence:.5,level:.2},pl=function(d){var b=w[d[1]],f=d[0][0],e=ea[f].ord[d[0][1]];d=d[0][2];b.lcost=void 0;"sword"==f&&(f=vn[e]);"attackBow"==e&&(e="attack");f=Object.assign({},
Ub[f]);if(f.potion)f.d=un[e],f[e]=~~(d*wn[e]);else if(f.book){var h=c[e],g=h.obj;f.spell=e;f.attack=~~(d/g.spcost[0]);f.name=g.name;f.iconID=h.iconIDbook}else f[e]=~~(.25*d),250<f[e]&&(f[e]=250);T(f);Ee(52,b,!0,f);b.techStart=void 0;O(b.id)};ea.func=function(){q("mgitem").style.backgroundPositionY=-48*(ea.id+ea[ea.actual].bak)+"px";q("mgamount").innerHTML=ea.amount};var Wg=[0,0,0,0,0,0,0,0],jd,Td,ml=function(d,b){if(0==W.stockActive||b){if(b=d.inventory,b.length){var f=[];f.length=b.length;for(var e=
0,c=b.length;e<c;f[e]=w[b[e++]]);oa(f,d,1)}}else oa(d.icons,d)},Hi=function(){history.pushState("",document.title,window.location.pathname)},db=function(){p.online=0;location.hash="";q("MatchX").style.display="none";q("index").style.display="block";q("returnmenu").style.display="none";q("game").style.display="none";q("gameFinish").style.display="none";setTimeout(Hi,200)},pb=function(d){var b=Wg[d];pb.lastFunc=b;pb.nu=d;if(W.stockActive){b=w[C[0]];var f=w[b.inventory[d]];f&&(f.potion?Jb.control?I(Qd,
b.id,[b.id,f.id]):(P=Qd,P.item=f.id):f.spell?Jb.control&&b.mana?I(ui,b.id,f.id):(c[f.spell](),P.item=f.id):(I(Md,b.id,[f.id]),O(b.id)))}else b&&b();pb.lastFunc=void 0;pb.nu=void 0;aa[d].style.transform=""},rb=[.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.25,.3,1,.3,.27,.3,1,.5,.5,.5,1,.62,.62,.62,1,.74,.74,.74,1,.88,.88,.88,1,.94,.94,.94,1,1,1,1,1,1.06,1.06,1.06,1,1.12,1.12,1.12,1,1.08,1.08,1.08,1,1.04,1.04,1.04,1,1,1,1,1,.95,.95,.95,1,.88,.8,.7,1,.84,.72,.6,1,.7,.62,.5,1,.6,.55,.45,1,.5,.44,
.42,1,.4,.37,.35,1],xk=function(){var d=(.025*p.cycle/p.daylength*24+p.initialhour)%24,b=~~d;d-=b;ll.style.backgroundPosition="0 -"+36*b+"px";var f=new Float32Array([rb[4*b],rb[4*b+1],rb[4*b+2],rb[4*b+3]]);b=(b+1)%24;f[0]+=(-f[0]+rb[4*b])*d;f[1]+=(-f[1]+rb[4*b+1])*d;f[2]+=(-f[2]+rb[4*b+2])*d;f[3]+=(-f[3]+rb[4*b+3])*d;m.useProgram(ya);m.uniform4fv(ql,f);m.useProgram(N);m.uniform4fv(rl,f)},Db=0,Ka=0,sd=0,td=0,Rd=function(d,b){var f=tzar.width,e=tzar.height,c=x.mx/32;d/=32;b/=32;var g=Z*f*.03125,k=Z*
e*.03125,n=.03125*f,l=.03125*e,m=d+.5*(n-g),p=b+.5*(l-k);0>m?d=.5*-(n-g):m+g-c*Z>G&&(d=G-g-.5*(n-g)+c*Z);0>p?b=.5*-(l-k):p+k>ha&&(b=ha-k-.5*(l-k));g-x.mx>G&&(Z=G/(.03125*f),T(Z));k>ha&&(Z=ha/(.03125*e),T(Z));Db=32*-d;Ka=32*-b},Ug=function(d){var b=d.pageX-parseInt(Uc.style.left);d=d.pageY-parseInt(Uc.style.top);var f=tzar.height*dc/(32*ha);b=~~(.5+(b-tzar.width*Cc/(32*G)*.5)*G/Cc);d=~~(.5+(d-.5*f)*ha/dc);Rd(32*b,32*d);0==Td&&document.removeEventListener("mousemove",Ug)},Jb={control:0,shift:0,esc:0},
ua=function(d,b){d&&!p.editor&&(d=W.active,b=xn[b],d&&d.cut&&(b=c[d.cut[b]]))&&(d=Nb.technology,jd=0,d.disabled[b.id]||d.hidden[b.id]||(pb.lastFunc=b,b(),pb.lastFunc=void 0))},$a={37:function(d){sd=d},40:function(d){td=-d},39:function(d){sd=-d},38:function(d){td=d},32:function(d){fl=d?gn:function(){}},46:function(d){d||I(af,Jb.shift,C.slice(0))},16:function(d){Jb.shift=d},17:function(d){Jb.control=d},27:function(d){Jb.esc=d},13:function(d){d&&!p.editor&&("displaynone"==Ii.className?(Ii.className=
"displayblock",Ji.focus(),$a.blocked=13):(Ki(),Ii.className="displaynone",$a.blocked=null))},19:function(d){d||p.online||$b(1)},48:function(d){d&&Jb.control&&(Z=1,zh({deltaY:0}))},176:function(d){d&&(p.deltaTime+=3E4)},65:ua,66:ua,67:ua,68:ua,69:ua,70:ua,71:ua,72:ua,73:ua,74:ua,75:ua,76:ua,77:ua,78:ua,79:ua,80:ua,81:ua,82:ua,83:ua,84:ua,85:ua,86:ua,87:ua,88:ua,89:ua,90:ua,219:function(d){d&&sl(-1)},221:function(d){d&&sl(1)}},xn={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",
75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z"};$a.blocked=null;(function(){for(var d=[65,37,40,83,39,68,38,87],b=d.length=0,f=d.length;b<f;b+=2)$a[d[b]]=$a[d[b+1]]})();document.oncontextmenu=function(){return!1};var af=function(d,b){if(b.length){d=d||p.editor?b.length:1;for(var f=0;f<d;f++)w[b[f]].die()}},Fa=function(d,b){d.sound&&!b&&(b=d.sound,pa(b[~~(b.length*Math.random())]));Wc.style.display="none";Sd.style.display="none";rd.style.display=
"block";Pa.style.display="block";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";Vc.style.display="none";$e.innerHTML=d.name;cf(d);rd.innerHTML=E[d.kingdom].name;d.attack?(Fb.style.display="block",Fb.innerHTML=d.attack):Fb.style.display="none";b=d.health;var f=d.maxHealth;Infinity==b?(Pa.value=100,Pa.max=100,Ac.innerHTML=b):Pa.value=b;Infinity==f&&Infinity!=b?(Pa.max=100,Pa.value=1):Infinity!==f&&(Pa.max=f);d.inventory&&d.inventory.length&&(manamenu1.style.display=
"block",manamenu1.style.backgroundPosition="0px -80px",manamenu1.innerHTML=d.inventory.length);Ac.innerHTML=~~b+"/"+f;if(!fc(d,x))return oa([]);d.point&&(b=d.point,ab.x32=b[0],ab.y32=b[1],Cb(ab,96*(ha-1)),ab.show=1);if(!1===d.built)oa([c.stopBuilding]),cf(d);else if(d.techStart)oa([c.stopTech]),cf(d),manamenu.style.display="block",manamenu.style.backgroundPosition="0px -200px",manamenu.innerHTML=100-~~(100*(d.c-p.cycle)/d.techStart)+"%",Fa.intv&&clearInterval(Fa.intv),Fa.intv=setInterval(function(){C[0]==
d.id?manamenu.innerHTML=100-~~(100*(d.c-p.cycle)/d.techStart)+"%":clearInterval(Fa.intv)},400);else{Qa();if(d.working){f=d.work;var e=W.page*W.length;b=0;for(var h=W.length;b<h;b++){var g=f[b+e];aa[b].innerHTML=g?g:""}manamenu.style.display="block";manamenu.style.backgroundPosition="0px -200px";var k=1E3*B[d.waitlist[0]].time;b=~~(100*(p.now()-d.timestamp)/k);100<b&&(b=100);manamenu.innerHTML=b+"%";Fa.intv&&clearInterval(Fa.intv);Fa.intv=setInterval(function(){if(C[0]==d.id&&d.working){var b=~~(100*
(p.now()-d.timestamp)/k);100<b&&(b=100);manamenu.innerHTML=b+"%"}else clearInterval(Fa.intv)},400)}else for(b=0,f=W.length;b<f;aa[b++].innerHTML="");oa(d.icons,d)}};Fa.intv=!1;var df=function(){Fb.style.display="none";Vc.style.display="none";Wc.style.display="none";Pa.style.display="none";manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";$e.innerHTML="";Fb.innerHTML="";Vc.innerHTML="";manamenu.innerHTML="";Wc.innerHTML="";rd.innerHTML="";Ac.innerHTML="";
Pa.value="";Ac.maxLength="";Sd.style.display="none";for(var d=0;d<aa.length;aa[d++].innerHTML="");oa([c.origin]);tl()},P,Wa,Dc,cc={},gi=function(d,b,f,e){var c=f||w[C[0]],g=e?E[c.kingdom]:Nb;if("peon"==(f?c.clss:Dc))var k=!0;if(p.editor)return[gc,n];var n=d+b*G;if(!e&&P!=gc)return[P,n];d=Y[n];b=0;if(!c)return[b,n];if(2<d||(d=ud[n])&&2<d){var l=w[d];l.invisible||(k&&l.storage&&c.stock?b=vg:k&&void 0!=l.res?b=tc:k&&l.health<l.maxHealth&&!g.diplomacy[l.kingdom]&&l.build&&!l.dummy||l.dummy&&!l.built?
b=uc:g.diplomacy[l.kingdom]||l.dummy&&g.values.experience||l.confused?b=vc:1===l.invType&&!c.build&&!c.boat&&0<l.invMax&&fc(c,l)&&(b=Ie))}else d=Ta[n],2<d&&!c.build&&!c.boat&&(l=w[d],l.item?b=Ld:l.field&&k?b=pg:1===l.invType&&!c.build&&!c.boat&&0<l.invMax&&fc(c,l)&&(b=Ie));0===b&&(c=Bb[c.kingdom],c[n]&&k?(d=c[n],b=uc):(l||(d=-n),b=Tb,Tb.cursor=2));return[b,d]},C=[];C.change=1;var ul,yb,Li;var nd=!1;var wc=function(d,b){var f=Z,e=tzar.width,c=tzar.height;d=d*f-Db+.5*(e-f*e);b=b*f-Ka+.5*(c-f*c);return[d,
b]},Hb=function(d){if(d){var b=d.pageX;d=d.pageY;Hb.lastX=b;Hb.lastY=d}else b=Hb.lastX,d=Hb.lastY;b=wc(b-x.mx,d);d=b[1];b=b[0];0==nd?(window.removeEventListener("mousemove",Hb),Li=!1):Li=!0;ef=b;ff=d},Mi=function(d,b){for(var f=b.length,e=0;e<f;e++){var c=w[b[e]];c.build&&(Y[d[0]+d[1]*G]==c.id?(c.point=void 0,C[0]==c.id&&(ab.x32=2*G,Cb(ab,128*G),ab.show=0)):(c.point=d,ab.x32=d[0],ab.y32=d[1],C[0]==c.id&&(Cb(ab,96*(ha-1)),ab.show=1)))}};document.onkeydown=function(d){return d.ctrlKey&&d.shiftKey?!1:
{116:1,115:1,123:1}[d.keyCode]?!1:!0};var Lj=function(d){if(null==$a.blocked||$a.blocked==d.keyCode){var b=$a[d.keyCode];b&&b(1,d.keyCode)}},Mj=function(d){if(null==$a.blocked||$a.blocked==d.keyCode){var b=$a[d.keyCode];b&&b(0,d.keyCode)}},Nj=function(d){var b=window.innerWidth,f=window.innerHeight,e=d.pageX,c=d.pageY;if(screen.height-10<=f){if(1.2==Math.abs(sd)||0==sd)sd=1.2*((10>e)-(e>b-10));if(1.2==Math.abs(td)||0==td)td=1.2*((10>c)-(c>f-10))}e=wc(e-x.mx,c);c=~~(.03125*e[1]);e=~~(.03125*e[0]);
d.pageX<x.mx?od(2):(d=gi(e,c)[0],0==d||void 0==d.cursor?od(2):od(d.cursor))},Oj=function(d){if(!gf)if(d.pageX>x.menumx){if(0==d.button){window.addEventListener("mousemove",Hb);d=wc(d.pageX-x.mx,d.pageY);var b=d[1];Xg=d=d[0];Yg=b;ef=d;ff=b;void 0!=ja.wall&&(Hb.forced=!0,ja.wall=void 0);nd=!0;Zg=!1}}else Zg=!0},Zg=!1,Xg,Yg,ef,ff,yn=function(d){if(d.pageX>x.menumx&&d.pageY>x.menumy&&!Td&&0==Zg){nd&&(Bc(NaN,NaN,0,yb.bufferID),nd=!1);var b=wc(d.pageX-x.mx,d.pageY),f=b[1];ef=b=b[0];ff=f;f=~~(f/32);b=~~(b/
32);T(b,f);var e=ha;if(2==d.button&&!p.editor){if(P!=gc){P=gc;return}if(0<C.length)if(e=w[C[0]],1!=e.build||e.arrow){if(0===P){P=gc;return}e=gi(b,f);d=e[1];e=e[0];e==Tb&&(b={x32:b,y32:f,d:0,mv:1,img:l.cursor},Za(b),bc.new(b,nb(b.img)));I(e,d,C)}else I(Mi,[b,f],C);return!1}if(0==d.button){if(P==gc)return gc();d=b+f*e;if(P.spLevel)d=P.spLevel(d);else{var c=0;2<ud[d]?c=ud[d]:2<Y[d]?c=Y[d]:2<Ta[d]&&(c=Ta[d]);d=c}if(d)P.allowPos&&w[d].build&&(d=-(b+f*e));else if(P.allowPos||P.noObj)d=-(b+f*e);else return P=
gc;P.noObj&&3<=d&&(d=-(b+f*e));P.item?(I(P,d,[C[0],P.item]),P.item=void 0):I(P,d,C);Jb.shift||(P=gc)}}Zg=!1},Pj=function(d){gf||(yn(d),Ud.actived&&Ud(),qb.actived&&qb(),Td&&(Td=!1))},Ni=function(d){d=w[d];d.tempChild.quit(d.selectAnim);Lb(d.selectAnim.bufferID);d.selectAnim=void 0},vl=function(d,b){for(var c=~~(d/32),e=~~(b/32),h=b,g=d,k=NaN,n=G,l=0,m;3>l;l++){m=qd[l];var p=c,r=e;d=g;b=h;2<m(p+r*n)?(d=p,b=r,k=w[m(d+b*n)]):(.5<=b/32-r?r++:r--,2<m(p+r*n)?(d=p,b=r,k=w[m(d+b*n)]):(.5<=d/32-p?p++:p--,
2<m(p+r*n)?(d=p,b=r,k=w[m(d+b*n)]):(r=~~(b/32),2<m(p+r*n)&&(d=p,b=r,k=w[m(d+b*n)]))))}return k},gc=function(){var d=G,b=Xg,c=Yg,e=ef,h=ff,g=~~(b/32),k=~~(c/32);if(Jb.shift){var n=vl(b,c);if(n&&fc(n,x)&&!cc[n.id])return C[C.length]=n.id,n.setupChild(jb.select,1,te),cc[n.id]=1,1<C.length?$g(C):Yc(n.id)}var l=0;for(n=C.length;l<n;Ni(C[l++]));bf.actived&&(q(bf.actived).style.display="none");Wa&&(Ni(Wa.id),Wa=void 0);C.length=0;Dc=-1;cc={};Sd.style.display="none";for(l=0;l<aa.length;aa[l++].innerHTML=
"");Fb.className="";W.page=0;ab.show&&(ab.x32=2*G,Cb(ab,128*G),ab.show=0);if(10>=Math.abs(c-h)&&10>=Math.abs(b-e)){if(n=vl(b,c),n.id||(n=Bb[x.kingdom][g+k*d])&&(n=w[n]),n&&2<n.id&&(!n.invisible||fc(n,x)))if(cc[n.id]=1,C.length=0,n.setupChild(jb.select,1,te),fc(n,x)&&!p.demo){C[0]=n.id;Dc=null!=n.defence?n.clss:-2;if(256>Date.now()-ul){if(p.editor){zn(w[C[0]]);return}d=~~(Z*tzar.width*.03125);b=~~(Z*tzar.height*.03125);h=~~(.03125*-Db+.5*(~~(.03125*tzar.width)-d));g=~~(.03125*-Ka+.5*(~~(.03125*tzar.height)-
b));b*=d;h+=g*G;for(l=0;l<b;l++)for(c=h+l%d+~~(l/d)*G,e=0;3>e;e++)g=qd[e](c),2<g&&(k=w[g],k.clss!=n.clss||cc[g]||!fc(k,n)||k.item||(k.setupChild(jb.select,1,te),cc[g]=1,C.put(g)))}ul=Date.now();if(n.build)return Fa(n)}else return Wa=n,Yc(n.id),!1}else if(!p.demo){b=~~(b/32);e=~~(e/32);c=~~(c/32);h=~~(h/32);b>=e&&(l=b,b=e,e=l);c>=h&&(l=c,c=h,h=l);e++;k=[1,1,1];var m=e-b;l=0;for(n=m*(h-c+1);l<n;l++)for(h=l%m+b,g=~~(l/m)+c,e=0;3>e;e++){var t=qd[e](h+g*d),r=w[t];r&&(r.selected=1,k[t]||(k[t]=1,r.build||
!fc(r,x)||r.item||(C[C.length]=t,r.setupChild(jb.select,1,te),cc[t]=1)))}}1<C.length?$g(C):1==C.length?Yc(C[0]):(oa([]),df(),Dc=-1,C.length=0)},tn=["/nehhon/gold.gif","/nehhon/wood.gif","/nehhon/food.gif","/nehhon/stone.gif","/nehhon/mana.gif"],Yc=function(d,b,c){manamenu.style.display="none";manamenu1.style.display="none";progressmana.style.display="none";d=w[d];d.sound&&!c&&(c=d.sound,pa(c[~~(c.length*Math.random())]));Dc=d.clss;d.inventory&&d.inventory.length&&fc(d,x)&&(manamenu1.style.display=
"block",manamenu1.style.backgroundPosition="0px -80px",manamenu1.innerHTML=d.inventory.length);b||(fc(d,x)&&!p.demo?oa(d.icons,d):Oi());rd.style.display="block";$e.innerHTML=d.name;d.attack&&d.item||void 0!==d.attack?(Fb.innerHTML=d.attack,Fb.style.display="block"):Fb.style.display="none";d.defence&&d.item||void 0!==d.defence?(Vc.innerHTML=d.defence,Vc.style.display="block"):Vc.style.display="none";d.mana&&!d.manaTarget&&(manamenu.style.display="block",manamenu.innerHTML=d.mana,manamenu.style.backgroundPosition=
"0px -120px");b=0;var e=d.update;if(e){b=0;for(var f=e.length;b<f;b+=3){var g=e[b],k=Di[g];c=Ci[b/3];c.innerHTML=d[g];c.style.display="block";c.style.backgroundPosition=k.background;"mana"==g&&d.manaTarget&&(c.innerHTML=~~(100*d.mana/d.manaTarget+.5)+"%",c.style.backgroundPosition="0px -200px");k.progress&&(k.progress.style.display="block",k.progress.value=d[g],k.progress.max=d[g+"Max"])}}d.stock&&(e=d.stock,c=Ci[b/3],c.style.display="block",c.style.backgroundPosition=Di[e[4].icon].background,c.innerHTML=
e[0]);b=d.level?d.level:0;Wc.innerHTML=b;Wc.style.display="block";0===b&&(d.item||d.build)&&(Wc.style.display="none");rd.innerHTML=E[d.kingdom].name;Pa.style.display="block";wl(d);cf(d)},wl=function(d){var b=d.health;d=d.maxHealth;Infinity==b?(Pa.value=100,Pa.max=100,Ac.innerHTML=b):(Pa.value=b,Infinity==d?(Pa.max=100,Pa.value=1):Pa.max=d,Ac.innerHTML=~~b+"/"+d)},$g=function(d,b){var c=w[d[0]],e=0,h=0,g=c.clss,k=d.length,n={},l=[];l.cut={};for(var m={},p=0;p<k;p++){c=w[d[p]];e+=c.maxHealth;h+=c.health;
Dc=g!=c.clss?-1:!0;if(c.work)for(var r=c.work,q=Object.keys(r),v=0,x=q.length;v<x;v++){var z=q[v];m[z]||(m[z]=0);m[z]+=r[z]}q=c.icons;r=q.length;if(void 0===c.techID&&!1!==c.built)for(v=0;v<r;v++)x=q[v].id,q[v].obj.tech||(void 0===n[x]?n[x]=1:n[x]++,n[x]===k&&(q.cut&&(x=q.cut,z=q[v].objName,x[z]&&(l.cut[z]=x[z],l.cut[x[z]]=z)),l.put(q[v])))}!0===Dc&&(Dc=c.clss);h=Infinity==h?100:~~(h/e*100);Ac.innerHTML=h+"/100(%)";xl();$e.innerHTML="";Fb.style.display="none";Vc.style.display="none";manamenu.style.display=
"none";manamenu1.style.display="none";progressmana.style.display="none";Wc.style.display="none";rd.innerHTML=k+" "+t.units;Pa.style.display="block";Pa.value=h;Pa.max=100;if(!b)for(oa(l),p=0,d=W.page*W.length,r=W.length;p<r;p++)b=m[p+d],aa[p].innerHTML=b?b:""},yl=function(){};new Float32Array(8);var hf,ah,bh,ch,dh,Z=1,zl={1:2560,101001:2048,101E3:2048,1001:2048,1E3:2048,100:1536,10010100:1280,10100:1280,1001E4:1280,1E4:1280,10010010:256,10010110:256,10110:256,10111:256,10010111:256,110:512,111:512,
11:512,10:512,111E5:2816,11E5:2816,11E6:2816,1E6:2816,1101E4:768,11110100:768,11010100:768,1111E4:768,1E7:3360,1E5:3072,1101E3:1792,1101001:1792,11101E3:1792,11101001:1792,101111:0,1011:0,1111:0,101011:0},An=function(d){Lb(d.bufferID)},bc={table:{},dates:[],new:function(d,b,c){b=Math.floor(b)+p.now();var e=this.table;c||(c=An);e[b]||(e[b]=[]);d.animFunc=c;e[b].put(d);this.dates.add(b);this.needOrder=!0}},nb=function(d){d=Ja[d];return 0>d[1]?l.delay[d[0]-d[1]-1]:~~(d[0]/d[1]*1E3)};new Float32Array(12);
var fi=function(d){var b=d.id+p.arje+d.x32+d.y32;d.rnd=[4294967295+b,4294967295-b,0]},Pi=function(d){d=w[d];d.mlist&&Al(d,!0);d.hlist&&Al(d,!1)},Al=function(d,b){if(b){var c=d.mlist;var e=d.mlistID;var h=Vd.mercenaries}else c=d.hlist,e=d.hlistID,h=Vd.heroes;c.unshift(h[Dk(d,h.length)]);b?e.unshift(d.mercID++):e.unshift(d.heroID++);8<c.length&&(c.length=8,e.length=8);W.active==c&&oa(c);Zb(d,5E4)},Qi=function(d){d=w[d];if(!E[d.kingdom].paypal(Mm)){var b=E[d.kingdom],f=b.technology.disabled;if(!f[c.createCrusaders.id]){var e=
16+4*b.crusade.number;b.crusade.number++;32<e&&(e=32);b=b.crusade.list;b.length=e;for(var h=0;h<e;h++)(b[h]=Ee(8,d,1)).deleteFromList=b;pa("crusade",d.x32,d.y32);f[c.createCrusaders.id]=1;O(d.id)}}},hn=function(d){E[d.kingdom].technology.disabled[c.createCrusaders.id]=0},Wd,kc={},Ta,Y,ud,Pd=function(d){return Ta[d]},vd=function(d){return Y[d]},Ri=function(d){return ud[d]};Pd.write=function(d,b){Ta[d]=b};vd.write=function(d,b){Y[d]=b};Ri.write=function(d,b){ud[d]=b};var qd=[Pd,vd,Ri],Oi=function(){for(var d=
W.displayed.length=0,b=W.length;d<b;d++){var c=aa[d];c.className="blocked";c.style.backgroundPosition="48px 96px";Wg[d]=Jc}W.rightButton.className="blocked";W.leftButton.className="blocked";W.stock.className="blocked";W.rightBlocked=1},oa=function(d,b,c){c=!!c;b||(b=NaN);var e=d.olegal||NaN;if(b.working&&!c)var f=1;W.active=d;W.displayed.length=0;var g=Nb.technology,k=W.page,n=W.length;Oi();!1!==c&&b?W.stockActive=b:!1===c&&(W.stockActive=!1);oa.actv={};d.length<=k*n&&d.length&&(W.page--,k--);for(var l=
0,m=0,p;l<n;l++){p=d[l+k*n];if(!p)break;var r=aa[m];if(!c&&(oa.actv[p.id]=1,g.hidden[p.id]||p.obj.tech&&f)){n++;continue}r.style.backgroundPosition=48*c+"px "+(-c||1)*p.iconID*48+"px";c||!g.disabled[p.id]||e[p.id]?(r.className="",Wg[m]=p):r.className="blocked";W.displayed[m]=p;m++}d[l+k*n]&&(W.rightButton.className="",W.rightBlocked=0);0<k&&(W.leftButton.className="");1===C.length&&(b=w[C[0]]);b.inventory&&0<b.inventory.length&&(W.stock.className="")};oa.actv={};var rl,N,ya,Bl,ql,Cl,eh,Si,Ti,fh,gh,
jf,kf,Xd,Ui,Vi,wd,Dl,xd=function(d,b){var c=lf,e=m.createBuffer();e.size=b;e.len=c;m.bindBuffer(m.ARRAY_BUFFER,e);m.enableVertexAttribArray(d);m.vertexAttribPointer(d,b,m.FLOAT,!1,0,0);m.bufferData(m.ARRAY_BUFFER,c*b,m.STATIC_DRAW);m.vertexAttribDivisor(d,1);return e};xd.jump=4E3;var mf=function(d){var b=m.createBuffer();m.bindBuffer(m.COPY_READ_BUFFER,d);m.bindBuffer(m.ARRAY_BUFFER,b);m.bufferData(m.ARRAY_BUFFER,hc*d.size,m.STATIC_DRAW);m.copyBufferSubData(m.COPY_READ_BUFFER,m.ARRAY_BUFFER,0,0,hc*
d.size);m.bindBuffer(m.COPY_READ_BUFFER,b);m.bindBuffer(m.ARRAY_BUFFER,d);m.bufferData(m.ARRAY_BUFFER,lf*d.size,m.STATIC_DRAW);m.copyBufferSubData(m.COPY_READ_BUFFER,m.ARRAY_BUFFER,0,0,hc*d.size);m.bindBuffer(m.COPY_READ_BUFFER,null);m.deleteBuffer(b)},ub=function(){if(!p.canceled){performance.now();requestAnimationFrame(ub);var d=ub.fp1000,b=ub.delta,c=ub.now,e=ub.realnow,h=ub.delta,g=c;ub.frameCount++;c=p.now();ub.now=c;b=(b+(c-g))/1E3;ub.delta=b;g=e;e=Date.now();ub.realnow=e;h=(h+(e-g))/1E3;ub.realdelta=
h;ei+=b;di++;ub.fp1000=d+b;d=bc.table;b=bc.dates;bc.needOrder&&(b.sort(function(b,d){return b-d}),bc.needOrder=0);for(e=0;b[e]<=c+17;e++){g=d[b[e]];for(var k=0,n=g.length;k<n;k++){var l=g[k];l.animFunc(l)}delete d[b[e]];e--;b.shift()}nd&&(Bc(Xg,Yg,0,yb.bufferID),nf(-Xg+ef+.5,-Yg+ff+.5,0,yb.bufferID));if(0!=sd||0!=td)Db+=sd*h*640*Z,Ka+=td*h*640*Z,Rd(-Db,-Ka),Hb();fl(c);yl();m.uniform1f(Cl,c);m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT);Bn(c);m.bindVertexArray(Vi);Wi(hc/4);Cn();ja.active&&(Bc(ja.x,
ja.y,96*G,ja.bufferID),ja.active=!1);yd.update&&yd(1)}},Wi=function(d){hc&&(m.enable(m.BLEND),m.blendEquation(m.FUNC_ADD),m.blendFunc(m.SRC_ALPHA,m.ONE_MINUS_SRC_ALPHA),m.drawArraysInstanced(m.TRIANGLES,0,6,d),m.disable(m.BLEND))},Cn=function(){var d=tzar.width,b=tzar.height,c=-Db+.5*(d-Z*d),e=-Ka+.5*(b-Z*b),h=Z*(d-x.mx),g=Z*b;m.viewport(x.marx,b-dc-x.mary,Cc,dc);m.uniform2f(eh,32*G,32*ha);m.uniform2fv(jf,[0,0]);m.uniform1i(gh,1);m.uniform1f(Wd,1);Wi(hc/4);Bc(c,e,1E6,yb.bufferID);nf(h,g,0,yb.bufferID);
Kb(1,1,1,.5,yb.bufferID);Wi(1);m.uniform1i(gh,0);m.uniform2f(eh,d,b);m.uniform2fv(jf,[Db,Ka]);m.uniform1f(Wd,1/Z);m.viewport(x.mx,0,d,b);nd?(d=Nb.color,Kb(d[0],d[1],d[2],.25,yb.bufferID)):Bc(NaN,NaN,0,yb.bufferID)},Bn=function(d){var b=window.innerWidth,c=window.innerHeight;m.useProgram(ya);m.bindVertexArray(Ui);m.uniform1f(Si,~~((.01*d+.5)%5));m.drawArrays(m.TRIANGLES,0,6);m.viewport(x.marx,c-dc-x.mary,Cc,dc);m.uniform1i(fh,1);m.uniform2fv(kf,[0,0]);m.uniform1f(Xd,Cc/32/G);m.drawArrays(m.TRIANGLES,
0,6);m.uniform1i(fh,0);m.uniform2f(Ti,b,c);m.uniform2fv(kf,[Db,Ka]);m.uniform1f(Xd,1/Z);m.viewport(x.mx,0,b,c);m.useProgram(N)},of=!1,zh=function(d){if(!gf&&(d.clientX>x.menumx||Td||!d.clientX)){d=.07*Math.sign(d.deltaY)*Z;var b=(Z+d)*tzar.height*.03125;(Z+d)*tzar.width*.03125-(Z+d)*x.mx/32>G||b>ha||(Z+=d,.08>Z&&(Z=.08),Li&&Hb(),Rd(-Db,-Ka),m.useProgram(ya),m.uniform1f(Xd,1/Z),m.useProgram(N),m.uniform1f(Wd,1/Z))}};yl=function(){var d=[Db,Ka];m.useProgram(ya);m.uniform2fv(kf,d);m.useProgram(N);m.uniform2fv(jf,
d)};var Yd,oe=function(){var d=window.innerWidth,b=window.innerHeight;m.canvas.width=d;m.canvas.height=b;m.useProgram(ya);m.uniform2f(Ti,d,b);m.useProgram(N);wd.width=d;wd.height=b;m.activeTexture(m.TEXTURE2);Yd||(Yd=m.createTexture());m.bindTexture(m.TEXTURE_2D,Yd);m.texImage2D(m.TEXTURE_2D,0,m.RGBA,d,b,0,m.RGBA,m.UNSIGNED_BYTE,null);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,
m.CLAMP_TO_EDGE);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE);m.bindFramebuffer(m.FRAMEBUFFER,wd);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,Yd,0);m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT);m.bindFramebuffer(m.FRAMEBUFFER,null);Z=1;m.uniform1f(Wd,1/Z);m.uniform1i(m.getUniformLocation(N,"lightmap"),2);m.useProgram(ya);m.uniform1i(m.getUniformLocation(ya,"lightmap"),2);m.uniform1f(Xd,1/Z);m.useProgram(N);m.uniform2f(eh,d,b);m.viewport(x.mx,0,d,b);oe.changed=
1;Rd(-Db,-Ka)};"use strict";var ia=function(d,b){return d<G&&0<=d&&0<=b&&b<ha?!0:!1};Array.prototype.put=function(d){this[this.length]=d};var jb,pf,Ub,Xi,Zd=function(d,b,c,e){e&&0==Zd.cols[e]&&(Zd.list.push(e,d),Zd.cols[e]=1)};Zd.cols={};Zd.list=[];var S=function(d){for(var b=Object.keys(d),c=0;c<b.length;c++)d[d[b[c]]]=b[c];return d};window.onerror=Zd;var p={},Ja=[],El=function(d,b,c,e){for(var f=da.originalLength||0,g=Object.keys(d),k=0,n=g.length;k<n;k++){var l=g[k],m=d[l];if(Array.isArray(m)){d[l]=
f;m.url=f;l=Ja[f++]=m;var p=m.deltaY||0;l.id=e/4;for(var r=6,q=l.length;r<q;r+=6){var t=l[r-2],v=l[r-1],w=l[r+2],x=l[r+3];b[e++]=l[r]/c;b[e++]=(p+l[r+1])/c;b[e++]=t;b[e++]=v;b[e++]=(l[r]+w)/c;b[e++]=(l[r+1]+p)/c;b[e++]=t+w;b[e++]=v;b[e++]=l[r]/c;b[e++]=(l[r+1]+x+p)/c;b[e++]=t;b[e++]=v+x;b[e++]=(l[r]+w)/c;b[e++]=(l[r+1]+x+p)/c;b[e++]=t+w;b[e++]=v+x}}else for(var z=Object.keys(m),A=0,B=z.length;A<B;A++)for(l=m[z[A]],l.id=e/4,l.url=f,m[z[A]]=f,Ja[f++]=l,p=l.deltaY?l.deltaY:0,r=6,q=l.length;r<q;r+=6)t=
l[r-2],v=l[r-1],w=l[r+2],x=l[r+3],b[e++]=l[r]/c,b[e++]=(p+l[r+1])/c,b[e++]=t,b[e++]=v,b[e++]=(l[r]+w)/c,b[e++]=(l[r+1]+p)/c,b[e++]=t+w,b[e++]=v,b[e++]=l[r]/c,b[e++]=(l[r+1]+x+p)/c,b[e++]=t,b[e++]=v+x,b[e++]=(l[r]+w)/c,b[e++]=(l[r+1]+x+p)/c,b[e++]=t+w,b[e++]=v+x}return e},M=function(d,b,c,e){var f=0,g=c.length-1,k=c[g];e=Bb[e];var n=[],l=0,m=!0;ia(d,b)&&ia(d+k-1,b+g/k-1)||(m=!1);for(var p=G,r=0;r<g;r++){f==k&&(f=0,b++);if(c[r]){var q=d+f+p*b;e[q]&&(m=!1);if(0<Y[q]||Xa[q])m=!1;n[l++]=q}f++}return[n,
m]};M.check=function(d,b,c,e,h,g,k,n){var f=c.length-1;c=c[f];var l=f/c;f=G;k=Bb[k];c+=2;--d;--b;l=c*(l+2);for(var m=0;m<l;m++){var p=d+m%c,q=b+~~(m/c),t=p+q*f;if(0<Y[t]||Xa[t]||g&&(p>=h&&p<=h+2||q>=e&&q<=e+2)||!ia(p,q)||k[t]||w[Ta[t]].field||n[t])return!1}return!0};var Fl=function(d,b,c){var e=0,f=c.length-1,g=c[f],k=[],n=[],l=0,m=!0;ia(d,b)&&ia(d+g-1,b+f/g-1)||(m=!1);for(var p=0,r=0;r<f;r++){e==g&&(e=0,b++);var q=d+e+G*b;c[r]?(2<Y[q]&&(m=!1),k[l++]=q):(n[p++]=q,2<Y[q]&&(m=!1));e++}return[k,m,n]},
Wh=function(d,b,c){var e=0,f=c.length-1,g=c[f],k=[],n=0,l=!0;ia(d,b)&&ia(d+g-1,b+f/g-1)||(l=!1);for(var m=0;m<f;m++){e==g&&(e=0,b++);var p=d+e+b*G;if(c[m]&&2<Y[p]&&1==w[Y[p]].build||0<Ta[p])l=!1;k[n++]=p;e++}return[k,l]},hh=function(d,b,c){var e=!1,f=0,g=[],k=0,n=c.length-1,l=c[n],m=0,p=!0;ia(d,b)&&ia(d+l-1,b+n/l-1)||(p=!1);for(var r=0;r<n;r++){m==l&&(m=0,b++);if(c[r]){var q=d+m+G*b,t=Y[q];2<t&&(p=!1);0<t?f++:e=!0;g[k++]=q}m++}f>.5*(n-1)&&e||(p=!1);return[g,p]},qf=function(d,b,c){c=!0;ia(d,b)||(c=
!1);1!==Ta[d+b*G]&&(c=!1);return[[d+b*G],c]},J=function(d,b,c){c=!0;ia(d,b)||(c=!1);0<Y[d+b*G]&&(c=!1);return[[d+b*G],c]},ih=function(d,b,c){c=!0;ia(d,b)||(c=!1);0<ud[d+b*G]&&(c=!1);return[[d+b*G],c]},Wb=function(d,b,c){c=!0;ia(d,b)||(c=!1);if(0<Ta[d+b*G]||2==Y[d+b*G]||1==Y[d+b*G])c=!1;return[[d+b*G],c]};M.dimension=vd;qf.dimension=Pd;Fl.dimension=vd;Wh.dimension=Pd;J.dimension=vd;ih.dimension=Ri;Wb.dimension=Pd;hh.dimension=vd;var Dn=function(d){for(var b=Object.keys(d),c=0,e=b.length;c<e;c++)d[b[c]].deltaY=
168960},ja,F,Ma,tb,Nh=function(){ja={img:0,x32:-1E3,y32:-1E3,rgb:[0,0,0,.5],d:0,active:!1};var d=8,b=9;if(!of){En();var f=[c.move,c.attack,c.guard,c.patrol,c.pickUp,c.explore,c.stop,c.stand,c.sameSpeed,c.restoreSpeed];pf={magic_creatures:[58,40,59,5,78,77,60,130,131,132,89,129]};for(var e=Object.keys(pf),h=0,g=e.length;h<g;h++){b=pf[e[h]];var k={};b.obj=k;for(var n=0,m=b.length;n<m;k[b[n++]]=1);}Vd.mercenaries=[c.mercArcher,c.mercFootman,c.mercMaceman,c.mercLongbowman,c.mercPikeman,c.mercKnight,c.mercArcherAsian,
c.mercSamurai,c.mercHourseSamurai,c.mercRonin,c.mercHorseArcher,c.mercChariot,c.mercFootmanArab,c.mercArcherArab,c.mercMacemanArab,c.mercPikemanArab,c.mercCavalry,c.mercEnichar,c.mercJihad];Vd.heroes=[c.mercArcher6,c.mercFootman6,c.mercMaceman6,c.mercLongbowman6,c.mercPikeman6,c.mercKnight6,c.mercArcherAsian6,c.mercSamurai6,c.mercHourseSamurai6,c.mercRonin6,c.mercHorseArcher6,c.mercChariot6,c.mercFootmanArab6,c.mercArcherArab6,c.mercMacemanArab6,c.mercPikemanArab6,c.mercCavalry6,c.mercEnichar6,c.mercJihad6];
e=Vd.mercenaries;h=0;for(g=e.length;h<g;e[h++].merc=9);e=Vd.heroes;h=0;for(g=e.length;h<g;e[h++].hero=1);k=l;k.arrow1[4]=-20;k.arrow1[5]=-20;k.build2x2[2]=1;k.build3x3[2]=1;k.build4x4[2]=1;k.build5x5[2]=1;k.build6x6[2]=1;k.items1[2]=1;k.build_harbor[2]=1;k.bridge_horz_build[2]=1;k.bridge_vert_build[2]=1;k.fields[0]=9;k.fields[2]=1;k.sexplosion[0]=13;k.sexplosion[1]=25;k.flame_trail[0]=16;k.flame_trail[1]=25;h=0;for(e=k.asian_charriot.idle.length;h<e;h+=6)k.asian_charriot.idle[4+h]-=17;h=0;for(e=k.asian_charriot.attack.length;h<
e;h+=6)k.asian_charriot.attack[4+h]-=17;h=0;for(e=k.asian_charriot.move.length;h<e;h+=6)k.asian_charriot.move[4+h]-=17;h=0;for(e=k.asian_charriot.die.length;h<e;h+=6)k.asian_charriot.die[4+h]-=17;h=0;for(e=k.flame_trail.length;h<e;h+=6)k.flame_trail[4+h]-=32,k.flame_trail[5+h]-=32;h=0;for(e=k.sexplosion.length;h<e;h+=6)k.sexplosion[4+h]-=48,k.sexplosion[5+h]-=48;k.items1[1]=0;k.books[1]=0;k.potions[1]=0;k.troll.attack[1]=14;k.ork.attack[1]=14;k.dwarf.attack[1]=14;k.asian_mage.move[1]=14;k.arab_priest.attack=
k.arab_priest.spell;k.asian_mage.spell=k.asian_mage.castspell;k.asian_mage.attack=k.asian_mage.castspell;k.asian_mage.spell[1]=13;k.arab_horse_archer.move=k.arab_horse.archer;k.arab_jwarrior.attack[1]=14;k.arab_peasant.attack=k.arab_peasant.attack1;k.arab_peasant.tree=k.arab_peasant.wood;k.asian_peasant.attack=k.asian_peasant.attack1;k.asian_peasant.cut=k.asian_peasant.chop;k.asian_peasant.tree=k.asian_peasant.wood;k.asian_peasant.dig[1]=10;k.asian_peasant.dig[0]=11;k.asian_archer.die[1]=14;k.asian_ronin.attack=
k.asian_ronin.attack1;h=0;for(e=k.asian_peasant.dig.length;h<e;h+=6)k.asian_peasant.dig[4+h]-=16,k.asian_peasant.dig[5+h]-=16;h=0;for(e=k.turn_to_stone.length;h<e;h+=6)k.turn_to_stone[4+h]-=56,k.turn_to_stone[5+h]-=64;k.arab_tcguild_c[4]=31;k.arab_tcguild_c[5]=85;k.dragon.idle=k.dragon.move;k.asian_samurai.attack=k.asian_samurai.attack1;k.asian_horsamurai.idle=k.asian_horsamurai.idle1;k.asian_horsarcher.idle=k.asian_horsarcher.idle2;k.asian_priest.attack=k.asian_priest.attack1;k.asian_priest.spell=
k.asian_priest.pray;k.asian_monk.attack[1]=12;k.euro_mage.attack=k.euro_mage.spell;k.euro_ghost.idle=k.euro_ghost.move;k.euro_priest.attack=k.euro_priest.spell;k.arab_mage.spell=k.arab_mage.attack;k.cursor[1]=15;k.star[1]=15;k.select[4]+=3;k.select[5]+=3;k.arab_houses_c[d]=96;k.asia_houses_c[d]=96;k.asia_houses_c[4]-=9;k.asia_houses_c[5]-=15;k.wood_build[2]=1;k.res_gold[2]=1;k.res_gold_s[2]=1;k.res_stone[2]=1;k.res_stone_s[2]=1;k.bridge_horz1[4]=-9;k.bridge_horz1[5]=132;k.bridge_horz1[4]=-9;k.bridge_horz1[5]=
132;k.euro_stable_c[4]+=18;k.euro_stable_c[5]-=10;k.euro_lumbermill_s[4]-=19;k.euro_lumbermill_s[5]-=17;k.wood_tower_c[4]=0;k.wood_tower_c[5]*=1;k.bat.idle=k.bat.move;k.galleon.idle[1]=7;k.galleon.die[1]=8;k.expl_small_water[1]=11;h=0;for(e=k.curse.length;h<e;h+=6)k.curse[5+h]-=48;h=0;for(e=k.impersonate.length;h<e;h+=6)k.impersonate[5+h]-=48;h=0;for(e=k.bless.length;h<e;h+=6)k.bless[5+h]-=48;h=0;for(e=k.euro_barracks_c.length;h<e;h+=6)k.euro_barracks_c[4+h]+=50;h=0;for(e=k.healing.length;h<e;h+=
6)k.healing[5+h]-=48;h=0;for(e=k.expl_small_hole.length;h<e;h+=6)k.expl_small_hole[4+h]-=4,k.expl_small_hole[5+h]-=34;Date.now();h=[c.createKnight,c.createHorseArcher1,c.createHorseArcher2,c.createHorseSamurai,c.createChariot,c.createEnichar,c.createCavalry];e=da.size;g=new Float32Array(1048576);m=El(l,g,e,0);da.info=g;da.ids=m/16;da.originalLength=Ja.length;Ub={sword:{name:"Sword",iconID:16,img:l.items1,d:0,dMax:7,attack:1,type:52,sword:1},bow:{name:"Bow",iconID:4,img:l.items1,d:15,dMax:4,attack:1,
type:52,sword:1},shield:{name:"Shield",iconID:1,img:l.items1,d:8,dMax:6,defence:1,type:52,shield:1},potion:{name:"Potion",iconID:11,img:l.potions,d:0,dMax:7,type:52,potion:1},book:{name:"Book",iconID:9,img:l.books,d:0,dMax:4,type:52,book:1},gold:{name:"Gold",iconID:20,img:l.item_gold,d:0,dMax:0,type:52},stone:{name:"Stone",iconID:22,img:l.item_stone,d:0,dMax:0,type:52},food:{name:"Food",iconID:14,img:l.item_food,d:0,dMax:0,type:52},wood:{name:"Wood",iconID:15,img:l.item_tree,d:0,dMax:0,type:52},iron:{name:"Iron",
iconID:21,img:l.item_iron,d:0,dMax:0,type:52}};Xi=[Ub.sword,Ub.potion,Ub.book,Ub.bow,Ub.shield];g=[c.move,c.attack,c.stop,c.stand,c.pickUp,c.explore,c.healing,c.bless];e=[c.attack,c.guard,c.patrol,c.explore,c.stop,c.stand,c.attackGround,c.steady,c.move];n=[c.buildAcademy,c.buildWorkshop,c.buildWorkshop1,c.buildAcademy1,c.buildWorkshop2,c.buildAcademy2];d=[c.buildMerchands1,c.buildMerchands2,c.buildMerchands];tb={euro:{},asia:{},arab:{},common:{}};B=[{name:"Footman",attack:6,defence:3,health:65,maxHealth:65,
img:l.euro_footman.idle,attackSound:Mc,invType:0,invMax:8,validator:J,human:12,iconID:36,time:12,sight:5,url:l.euro_footman,icons:f,cost:[0,0,50,0],attDist:1,spd:50,dieSound:Aa,clss:"footman",size:1,standardFunc:A,radix:0,zLevel:1,strID:"e_footman",race:"euro"},{name:"Pikeman",radix:0,attackSound:Mc,attack:8,defence:4,health:75,maxHealth:75,img:l.euro_pikeman.idle,invType:0,dieSound:Aa,invMax:8,validator:J,human:1,iconID:39,time:18,sight:5,url:l.euro_pikeman,icons:f,cost:[40,0,60,0],attDist:1,spd:50,
standardFunc:A,clss:"e_pikeman",zLevel:1,size:1,strID:"e_pikeman",nu:c.createPikeman,race:"euro"},{name:"Spy",radix:0,attack:20,defence:0,mana:100,manaMax:100,health:50,maxHealth:50,img:l.euro_spy.idle,attackSound:["spy%20kill%201","spy%20kill%202","spy%20kill%203"],invType:0,invMax:8,validator:J,human:1,dieSound:Aa,iconID:41,time:30,sight:12,url:l.euro_spy,icons:[c.move,c.attack,c.guard,c.patrol,c.pickUp,c.explore,c.stop,c.stand,c.impersonate,c.revealSelf],zLevel:1,cost:[120,0,0,0],attDist:1,spd:50,
clss:"spy",standardFunc:A,size:1,update:["mana","manaSpeed",1E3],isSpy:1,strID:"spy",nu:c.createSpy,race:"common"},{name:"Maceman",radix:0,attack:8,defence:0,health:120,maxHealth:120,img:l.euro_maceman.idle,attackSound:Mc,invType:0,invMax:8,validator:J,human:1,iconID:37,time:14,dieSound:Aa,sight:5,zLevel:1,url:l.euro_maceman,icons:f,cost:[0,0,120,0],attDist:1,spd:50,clss:"maceman",standardFunc:A,size:1,strID:"e_maceman",nu:c.createMaceman,race:"euro"},{radix:0,name:"Archer",attack:5,defence:0,health:50,
maxHealth:50,img:l.euro_archer1.idle,invType:0,invMax:8,validator:J,human:1,sight:10,dieSound:Aa,arrow:!0,iconID:38,zLevel:1,time:12,url:l.euro_archer1,icons:f,cost:[0,20,40,0],attDist:7,spd:50,clss:"archer",standardFunc:A,attimg:l.arrow1,attackSound:Jd,size:1,strID:"e_archer",nu:c.createArcher,race:"euro"},{radix:0,name:"Wizard",attackSound:lk,dieSound:["mage"],attack:5,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:l.euro_mage.idle,zLevel:1,invType:0,invMax:8,validator:J,human:1,iconID:42,
time:30,sight:15,url:l.euro_mage,icons:[c.stop,c.pickUp,c.explore,c.lightning,c.createBat,c.freeze,c.createGolem,c.invisibility,c.stand,c.attack,c.move],cost:[150,0,0,0],attDist:10,attimg:l.flame_bolt,ball:1,spd:50,clss:"mage",standardFunc:A,size:1,update:["mana","manaSpeed",1E3],strID:"e_mage",nu:c.createMage,race:"euro"},{radix:0,name:"Longbowman",attack:6,defence:2,health:50,maxHealth:50,img:l.euro_longbowman.idle,zLevel:1,invType:0,invMax:8,dieSound:Aa,attackSound:Jd,arrow:!0,validator:J,race:"euro",
human:1,iconID:35,time:18,sight:18,url:l.euro_longbowman,icons:f,cost:[50,0,90,0],attDist:12,spd:50,standardFunc:A,clss:"longbowman",size:1,d2attack:2,strID:"e_longbowman",attimg:l.arrow1,nu:c.createLongbowman},{radix:0,clss:"tree",name:"Tree",health:100,maxHealth:100,img:l.terrain_tree,invType:0,invMax:8,zLevel:1,mMapcolor:[11,131,11],validator:J,child:[{img:l.terrain_tree_s,rgb:[0,0,0,.5],alpha:1,x:0,y:0}],iconID:23,url:l.terrain_tree,dimgInfinity:l.terrain_tree,dimgRND:3,icons:[],res:1,race:"common",
build:!0,size:1,zolotoy:1,strID:"tree"},{radix:0,name:"Crusader",zLevel:1,dieSound:we,attackSound:ue,attack:14,defence:8,health:180,maxHealth:180,img:l.crus.idle,invType:0,invMax:8,validator:J,human:1,race:"euro",iconID:100,time:19,sight:5,url:l.crus,icons:f,cost:[0,0,0,0],attDist:1,spd:85,standardFunc:A,clss:"crusader",size:1,strID:"crusader"},{radix:0,name:"Priest",attack:20,defence:0,mana:100,manaMax:100,health:60,maxHealth:60,img:l.euro_priest.idle,invType:0,zLevel:1,invMax:8,validator:J,human:1,
iconID:40,time:30,ball:1,sight:21,dieSound:Aa,url:l.euro_priest,icons:g,attackOnly:pf.magic_creatures.obj,cost:[150,0,0,0],attDist:18,race:"euro",spd:50,standardFunc:A,clss:"priest",size:1,update:["mana","manaSpeed",1E3],strID:"e_priest",nu:c.createPriest,attimg:l.flame_bolt},{radix:0,name:"Peasant",attackSound:Oh,attack:5,defence:0,health:50,maxHealth:50,img:l.euro_peasant.idle,invType:0,invMax:8,dieSound:Aa,zLevel:1,validator:J,human:1,race:"euro",iconID:33,time:8,sight:5,url:l.euro_peasant,icons:[c.move,
c.menuBuilds,c.repair,c.conquest,c.dcm,c.pickUp,c.explore,c.stop,c.stand,c.attack,c.bribe,c.sameSpeed,c.restoreSpeed],cost:[0,0,50,0],attDist:1,spd:50,clss:"peon",size:1,peon:1,strID:"e_peon",nu:c.createPeon,nocapture:1},{radix:0,clss:"cathedral",name:"Cathedral",dieSound:L,sound:["e_cathedral1","e_cathedral2"],resistance:700,health:5E3,maxHealth:5E3,img:l.euro_cathedral,invType:0,invMax:8,race:"euro",zLevel:1,validator:M,bimg:l.build5x5,dimg:l.des_5x5,iconID:60,icons:[c.createCrusaders,c.techFanaticism,
c.techEspionage,c.techInquisition,c.techHealing,c.techBless,c.techCrusade,c.techMedicine],time:90,sight:8,child:[{img:l.euro_cathedral_c,x:0,y:0},{img:l.euro_cathedral_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,5]),url:l.euro_cathedral,build:!0,cost:[2E3,0,0,2E3],onbuild:[c.buildChurch],size:1,strID:"cathedral"},{radix:0,name:"Castle",clss:"castle",dieSound:L,sound:["e_castle1"],resistance:700,health:8E3,maxHealth:8E3,img:l.euro_castle,
invType:1,invMax:50,race:"euro",zLevel:1,validator:M,bimg:l.build6x6,dimg:l.des_6x6,iconID:59,time:120,sight:12,child:[{img:l.euro_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:l.euro_castle_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[c.createPeon,c.createSpy,c.emergeAllUnits,c.techFeudalism,c.techArchitecture,c.techLearning],space:new Uint8Array([0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,0,1,1,7]),menu:Fa,url:l.euro_castle,build:!0,cost:[0,1500,0,1500],storage:-1,
castle:!0,population:20,size:1,strID:"e_castle"},{radix:0,name:"Wooden Wall",clss:"wall_wood",resistance:700,health:2E3,maxHealth:2E3,img:l.wood_tower,time:6,sight:1,zLevel:1,dieSound:L,validator:M,bimg:l.wood_build,dimgInfinity:l.wood_debris,iconID:49,icons:[],mx:0,race:"common",my:0,hframe:71,menu:Fa,url:l.wood_tower,space:new Uint8Array([1,1]),wall:1,build:!0,cost:[0,20,0,0],size:1,strID:"woodwall",child:[{img:l.wood_tower_c,x:0,y:0}]},{radix:0,name:"Barracks",clss:"barracks",strID:"e_barrack",
sound:Ph,generator:1,resistance:500,health:1400,maxHealth:1400,img:l.euro_barrack,invType:1,invMax:0,dieSound:L,time:60,sight:6,zLevel:1,race:"euro",validator:M,bimg:l.build5x5,dimg:l.des_5x5,child:[{img:l.euro_barracks_c,mv:!0},{img:l.euro_barrack_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:57,icons:[c.createFootman,c.createArcher,c.createMaceman,c.createPikeman,c.createLongbowman,c.createKnight],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:l.euro_barrack,build:!0,
cost:[0,200,0,200],size:1},{radix:0,strID:"e_lumber",name:"Lumber Mill",sound:["e_lumber1"],clss:"lumber_mill",resistance:500,health:800,maxHealth:800,img:l.euro_lumbermill,invType:1,invMax:0,time:30,race:"euro",sight:4,dieSound:L,zLevel:1,validator:M,bimg:l.build2x2,dimg:l.des_2x2,iconID:64,child:[{img:l.euro_lumbermill_c,x:0,y:0},{alpha:!0,img:l.euro_lumbermill_s,x:0,y:0,rgb:[0,0,0,.5]}],icons:[c.techLongbow,c.techWoodCutting,c.techCrossbow],space:new Uint8Array([1,1,1,1,2]),hframe:98,url:l.euro_lumbermill,
build:!0,cost:[0,100,0,0],storage:1,size:1},{radix:0,name:"Mage Tower",strID:"e_magetower",sound:["e_magetower1","e_magetower2","e_magetower3"],clss:"magictower",resistance:700,health:5E3,maxHealth:5E3,img:l.euro_magetower,invType:1,invMax:0,time:90,race:"euro",dieSound:L,sight:8,validator:M,bimg:l.build5x5,dimg:l.des_5x5,zLevel:1,child:[{img:l.euro_magetower_c,x:0,y:0},{img:l.euro_magetower_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:71,icons:[c.createMage,c.techBat,c.techInvisibility,c.techLightning,
c.techFreeze,c.techGolem],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:l.euro_magetower,build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,strID:"e_waracademy",name:"Warriors Guild",sound:["e_waracademy1"],clss:"academy",resistance:700,health:5E3,maxHealth:5E3,img:l.euro_waracademy,invType:1,invMax:0,race:"euro",time:90,sight:8,dieSound:L,zLevel:1,validator:M,bimg:l.build6x6,dimg:l.des_6x6,iconID:56,child:[{img:l.euro_waracademy_c,x:0,y:0,mv:!0},{img:l.euro_waracademy_s,x:0,y:0,rgb:[0,
0,0,.5],alpha:!0}],icons:[c.techHeroism,c.techWarfare,c.techMercenaries,c.techSiegeTactics,c.techBodyBuilding,c.techLeadership,c.techTactics,c.techHeroes,c.techHonor,c.techFame],space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,0,5]),url:l.euro_waracademy,build:!0,cost:[2E3,0,0,2E3],size:1},{radix:0,name:"Storage",strID:"e_storage",sound:["e_storage1","e_storage2"],clss:"storage",resistance:80,health:800,maxHealth:800,img:l.euro_storage,invType:1,invMax:0,time:30,dieSound:L,zLevel:1,
sight:5,validator:M,bimg:l.build4x4,dimg:l.des_4x4,iconID:69,race:"euro",icons:[c.techGoldMining,c.techStoneMining],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,4]),url:l.euro_storage,storage:0,build:!0,cost:[0,200,0,0],size:1,child:[{img:l.euro_storage_c,x:0,y:0},{img:l.euro_storage_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Knight",strID:"e_knight",dieSound:we,clss:"knight",attackSound:ue,attack:12,defence:6,health:120,maxHealth:120,img:l.euro_knight.idle,invType:0,zLevel:1,race:"euro",
invMax:8,validator:J,human:1,iconID:43,d2attack:2,time:22,sight:5,url:l.euro_knight,icons:f,cost:[120,0,70,0],attDist:1,spd:85,nu:c.createKnight,standardFunc:A,size:1},{radix:0,name:"Field",clss:"field",strID:"field",instantBuild:1,resistance:80,health:100,maxHealth:100,img:l.fields,invMax:0,validator:Wh,zLevel:1,iconID:104,race:"common",icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:l.fields,build:!0,field:1,res:2,cost:[0,200,0,0],rndDirection:9,time:0,sight:1,z32:.5,size:1},{radix:0,name:"Golden rocks",
mMapcolor:[148,148,0],strID:"gold",sound:["mine1"],clss:"golden_rocks",resistance:0,health:8E3,maxHealth:8E3,img:l.res_gold,invMax:0,validator:M,iconID:20,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:l.res_gold,build:!0,zLevel:1,race:"common",res:0,cost:[0,0,0,0],time:0,sight:2,dieSound:["destroy%20mine"],size:1,zolotoy:1,child:[{img:l.res_gold_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:l.res_gold},{radix:0,name:"Rocks",strID:"stone",mMapcolor:[132,132,132],sound:["mine1"],
clss:"rocks",dieSound:["destroy%20mine"],resistance:0,health:8E3,maxHealth:8E3,img:l.res_stone,invMax:0,validator:M,zLevel:1,iconID:22,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),url:l.res_stone,build:!0,res:3,cost:[0,0,0,0],race:"common",time:0,sight:2,size:1,zolotoy:1,child:[{img:l.res_stone_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],dimgInfinity:l.res_stone},{radix:0,name:"Farm",strID:"e_farm",sound:["e_farm1","e_farm2"],clss:"farm",resistance:0,health:800,maxHealth:800,img:l.euro_farm,
invType:1,invMax:0,zLevel:1,validator:M,bimg:l.build4x4,dimg:l.des_4x4,iconID:61,dieSound:L,race:"euro",icons:[c.createCow,c.techCropRotation,c.techDomestication],space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),menu:Fa,url:l.euro_farm,build:!0,cost:[0,200,0,0],time:30,sight:5,storage:2,size:1,child:[{img:l.euro_farm_c,x:0,y:0}]},{radix:0,name:"Merchants Guild",strID:"e_merchant",sound:["merchant"],clss:"merchants_guild",resistance:0,health:5E3,maxHealth:5E3,img:l.euro_tcguild,invType:1,
invMax:0,validator:M,bimg:l.build6x6,zLevel:1,dimg:l.des_6x6,race:"euro",iconID:62,dieSound:L,icons:[c.techMapMaking,c.techTradeRoutes,c.techUsury,c.techSupplyStorage,c.techBribery,c.techTradeTaxes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),menu:Fa,url:l.euro_tcguild,build:!0,time:90,sight:8,cost:[2E3,0,0,2E3],onbuild:[c.buildMarket],size:1,child:[{img:l.euro_tcguild_c,x:0,y:0},{img:l.euro_tcguild_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Church",clss:"church",
strID:"e_church",sound:["e_church1"],resistance:0,health:800,maxHealth:800,img:l.euro_church,invType:1,invMax:0,dieSound:L,validator:M,bimg:l.build3x3,race:"euro",zLevel:1,dimg:l.des_3x3,iconID:139,icons:[c.createPriest],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),menu:Fa,url:l.euro_church,build:!0,cost:[0,0,200,200],time:40,sight:6,size:1,child:[{img:l.euro_church_c,x:0,y:0},{img:l.euro_church_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}]},{radix:0,name:"Blacksmith",clss:"blacksmith",strID:"e_blacksmith",
resistance:0,health:800,maxHealth:800,img:l.euro_blacksmith,invType:1,invMax:0,time:40,zLevel:1,sight:5,dieSound:L,validator:M,bimg:l.build4x4,race:"euro",dimg:l.des_4x4,child:[{img:l.euro_blacksmith_c,x:0,y:0}],iconID:58,icons:[c.techPlateArmor,c.techTemperIron,c.techScaleArmor,c.techHalberd,c.techChainMail],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),menu:Fa,url:l.euro_blacksmith,build:!0,cost:[0,0,200,200],onbuild:n,size:1},{radix:0,name:"Cow",clss:"cow",nu:c.createCow,race:"common",
strID:"cow",attack:0,defence:3,health:50,maxHealth:50,img:l.cow.idle,invType:0,invMax:8,zLevel:1,validator:J,iconID:99,time:20,dieSound:["cowdie1","cowdie2","cowdie3","cowdie4"],url:l.cow,icons:[c.move,c.stop],sight:3,cost:[0,0,300,0],attDist:0,spd:32,res:2,food:300,milk:50,milkMax:50,foodMax:600,size:1,cow:1,update:["milk","milkSpeed",1E3,"food","cowSpeed",1E3]},{radix:0,name:"Stable",sound:["e_stables1"],clss:"stable",strID:"e_stable",onlyRequired:1,resistance:0,health:800,maxHealth:800,invType:1,
invMax:0,race:"euro",zLevel:1,validator:M,bimg:l.build4x4,dimg:l.des_4x4,iconID:68,dieSound:L,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,4]),url:l.euro_stables,build:!0,cost:[0,200,0,0],onbuild:h,size:1,time:40,sight:5,img:l.euro_stables,nu:c.createCow,child:[{img:l.euro_stable_c,x:0,y:0}]},{radix:0,name:"Workshop",sound:["e_workshop1"],clss:"workshop",strID:"e_workshop",zLevel:1,resistance:0,health:800,maxHealth:800,img:l.euro_workshop,invType:1,invMax:0,dieSound:L,validator:M,bimg:l.build4x4,
race:"euro",dimg:l.des_4x4,iconID:75,icons:[c.createCatapult,c.createHeavyCatapult,c.createBallist,c.techEngineering,c.techCannonTower],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,4]),url:l.euro_workshop,build:!0,cost:[0,200,200,0],size:1,time:40,sight:5,child:[{img:l.euro_workshop_c,x:0,y:0}]},{radix:0,name:"Tavern",sound:["e_tavern1"],clss:"tavern",strID:"e_tavern",dieSound:L,resistance:0,health:1E3,maxHealth:1E3,img:l.euro_tavern,invType:1,invMax:0,validator:M,race:"euro",bimg:l.build4x4,
dimg:l.des_4x4,zLevel:1,iconID:70,icons:[c.createMercenaries,c.createHeroes],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,4]),url:l.euro_tavern,build:1,cost:[0,200,200,0],onbuild:d,actvintv:[c.iniMercenaries,c.iniHeroes],size:1,time:40,sight:5,child:[{img:l.euro_tavern_c,x:0,y:0}]},{name:"House",sound:["house1","house2","house3","house4","house5"],clss:"house",strID:"e_house",resistance:0,health:500,maxHealth:500,img:l.euro_houses,invType:1,invMax:0,validator:M,bimg:l.build3x3,dimg:l.des_3x3,
race:"euro",iconID:73,zLevel:1,dieSound:L,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),url:l.euro_houses,build:!0,cost:[0,75,0,0],population:10,size:1,time:20,sight:4,child:[{img:l.euro_houses_c,x:0,y:0}]},{name:"Watch Tower",attackSound:Xf,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),clss:"watch_tower",strID:"watch_tower",attack:7,health:400,maxHealth:400,img:l.euro_tower_wood_2,state:0,invType:1,race:"common",invMax:0,zLevel:1,dieSound:L,level:0,validator:M,child:[{img:l.euro_tower_wood_2_c,
x:0,y:0},{alpha:!0,img:l.euro_tower_wood_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attimg:l.arrow1,attDist:8,bimg:l.build2x2,dimg:l.des_2x2,iconID:53,icons:[c.attack,c.stop,c.upgradeGuildTower],space:new Uint8Array([1,1,1,1,2]),url:l.euro_tower_wood_2,build:!0,cost:[0,300,0,0],size:1,arrow:!0,time:10,sight:15,standardFunc:A},{name:"Market",sound:["e_market1"],clss:"market",strID:"e_market",resistance:0,health:1400,maxHealth:1400,img:l.euro_market,invType:1,invMax:0,dieSound:L,zLevel:1,validator:M,bimg:l.build4x4,
dimg:l.des_4x4,iconID:65,race:"euro",icons:[c.createCaravan],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,4]),url:l.euro_market,build:!0,cost:[0,200,200,0],size:1,time:60,sight:8,child:[{img:l.euro_market_c,x:0,y:0}]},{name:"Outpost",sound:["e_outpost1"],clss:"outpost",strID:"e_outpost",zLevel:1,resistance:0,health:2E3,maxHealth:2E3,img:l.euro_outpost,invType:1,dieSound:L,invMax:50,validator:M,race:"euro",bimg:l.build4x4,dimg:l.des_4x4,iconID:66,icons:[c.emergeAllUnits],space:new Uint8Array([0,
1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,4]),url:l.euro_outpost,build:!0,cost:[0,200,0,400],size:1,child:[{img:l.euro_outpost_c,x:0,y:0},{img:l.euro_outpost_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:60,sight:8},{name:"Bridge",clss:"bridge",strID:"bridge",resistance:0,health:1E4,maxHealth:1E4,img:l.bridge_horz,invMax:0,valid2:!0,validator:Fl,bimg:l.bridge_horz_build,race:"common",zLevel:1,dieSound:L,child:[{alpha:!0,img:l.bridge_horz_s,x:0,y:0,rgb:[0,0,0,.5]},{img:l.bridge_horz1,x:0,y:0,z:6}],time:22,sight:1,
dimg:l.bridge_horz_demol,iconID:44,icons:[],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,11]),url:l.bridge_horz,build:!0,cost:[0,200,0,400],size:1},{name:"Dummy",clss:"dummy",strID:"dummy",resistance:0,health:5E3,maxHealth:5E3,img:l.dummy1,invMax:0,validator:J,bimg:l.dummy1_b,iconID:165,icons:[],mx:0,zLevel:1,my:16,hframe:65,race:"common",url:l.dummy1,dimg:l.dummy1_d,
build:!0,cost:[0,300,0,0],dummy:!0,child:[{img:l.dummy1_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:10,sight:1},{name:"Catapult",strID:"catapult",dieSound:Zf,clss:"catapult",attackSound:Yf,defence:0,attack:10,health:110,maxHealth:110,img:l.catapult.idle,invMax:0,radix:0,validator:J,iconID:30,time:30,sight:20,race:"common",url:l.catapult,level:0,zLevel:1,icons:e,cost:[0,600,0,0],nofreeze:1,arrow:!1,attDist:17,spd:40,standardFunc:A,size:1,attimg:l.cat_stone,space:new Uint8Array([1,1,1,1,2]),attackDeg:60,
nu:c.createCatapult},{name:"Ballista",radix:0,strID:"ballista",attackSound:Yf,dieSound:Zf,clss:"ballista",defence:0,attack:60,health:75,maxHealth:75,img:l.ballista.idle,invMax:0,validator:J,iconID:31,time:30,sight:16,nofreeze:1,race:"common",zLevel:1,url:l.ballista,icons:e,cost:[0,800,0,0],attDist:13,spd:40,standardFunc:A,size:1,attimg:l.arrow_ballista1,space:new Uint8Array([1,1,1,1,2]),attackDeg:30,nu:c.createBallist},{name:"Heavy Catapult",strID:"heavy_catapult",attackSound:Yf,defence:0,attack:25,
health:250,maxHealth:250,img:l.h_catapult.idle,invMax:0,radix:0,validator:J,iconID:45,time:60,dieSound:Zf,sight:26,race:"common",url:l.h_catapult,zLevel:1,icons:e,standardFunc:A,cost:[0,1200,0,0],attDist:22,spd:40,nofreeze:1,clss:"heavy_catapult",size:1,attimg:l.cb_metal,space:new Uint8Array([1,1,1,1,2]),attackDeg:60,nu:c.createHeavyCatapult},{radix:0,name:"Ghost",strID:"ghost",defence:0,attack:8,health:60,maxHealth:60,img:l.euro_ghost.idle,invType:0,invMax:8,dieSound:["ghost1","ghost2"],validator:J,
iconID:178,zLevel:1,race:"common",time:15,attackSound:kk,sight:5,standardFunc:A,url:l.euro_ghost,icons:f,w:1,cost:[40,0,0,0],attDist:1,spd:80,clss:"ghost",size:1,nu:c.createGhost},{name:"Harbor",strID:"e_harbor",resistance:80,health:800,maxHealth:800,img:l.euro_harbor,invType:1,invMax:0,validator:hh,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:l.build_harbor,dimg:l.des_harbor,zLevel:1,race:"euro",dieSound:L,iconID:63,icons:[c.createFishingBoat,c.createXebec,c.createHulk,c.createGalleon,
c.techLandingTactics],clss:"harbor",url:l.euro_harbor,storage:4,build:!0,cost:[0,200,200,0],child:[{img:l.euro_harbor_c,x:0,y:0},{img:l.euro_harbor_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],time:60,sight:8},{radix:0,name:"Messiah",strID:"messiah",attack:50,defence:10,mana:1E3,manaMax:1E3,health:1E3,maxHealth:1E3,img:l.messiah.idle,invType:0,invMax:0,race:"common",validator:J,human:1,iconID:169,zLevel:1,attackSound:["messiah_attack"],dieSound:["messiah"],time:300,sight:26,url:l.messiah,standardFunc:A,icons:f,
cost:[2E3,0,0,0],attDist:10,spd:50,clss:"messiah",size:1,update:["mana","manaSpeed",1E3]},{name:"Magic Gateway",sound:["gateway"],strID:"gateway",magicGateway:1,resistance:0,health:Infinity,maxHealth:Infinity,img:l.teleport,invMax:0,validator:M,bimg:l.build4x4,zLevel:1,dieSound:L,race:"common",iconID:180,clss:"magic_gateway",icons:[c.createOrk,c.createDwarf,c.createGhost,c.createSkeleton],space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,5]),url:l.teleport,build:!0,cost:[0,0,
0,0],size:1,time:10,sight:10,zolotoy:1,child:[{img:l.teleport_c,x:0,y:0},{alpha:!0,img:l.teleport_s,x:0,y:0,rgb:[0,0,0,.5]}],standardFunc:Sm},{name:"Guard Tower",strID:"guard_tower",race:"common",clss:"guard_tower",attackSound:Xf,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:12,health:1E3,maxHealth:1E3,img:l.euro_tower_wood,state:0,invType:1,invMax:0,dieSound:L,zLevel:1,validator:M,child:[{img:l.euro_tower_wood_c,x:0,y:0},{alpha:!0,img:l.euro_tower_wood_s,x:0,y:0,rgb:[0,0,0,.5]}],
attDist:12,bimg:l.build2x2,dimg:l.des_2x2,iconID:52,icons:[c.attack,c.stop,c.upgradeStoneTower,c.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:l.euro_tower_wood,build:!0,cost:[0,600,0,0],size:1,arrow:!0,attimg:l.arrow1,time:35,sight:16,standardFunc:A},{name:"Sword",attack:0,defence:0,health:25,maxHealth:25,img:l.items1,state:0,invMax:0,validator:Wb,iconID:16,url:l.items1,icons:[],cost:[0,0,0,0],size:1,zLevel:0,z32:.5,radix:0,race:"common",item:1},{name:"Bow",attack:0,defence:0,health:25,
maxHealth:25,img:l.items1,state:0,invMax:0,validator:Wb,iconID:4,url:l.items1,icons:[],cost:[0,0,0,0],size:1,z32:.5,zLevel:0,radix:0,race:"common",item:1},{name:"Shield",attack:0,defence:0,health:25,maxHealth:25,img:l.items1,state:0,invMax:0,validator:Wb,iconID:1,url:l.items1,icons:[],cost:[0,0,0,0],zLevel:0,race:"common",radix:0,size:1,z32:.5,item:1},{name:"Potion",attack:0,defence:0,health:25,maxHealth:25,img:l.potions,state:0,invMax:0,validator:Wb,iconID:11,url:l.potions,icons:[],radix:0,race:"common",
zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Book",attack:0,defence:0,health:25,maxHealth:25,img:l.book1,state:0,invMax:0,validator:Wb,iconID:9,zLevel:0,race:"common",radix:0,url:l.books,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Gold",health:1,maxHealth:1,img:l.item_gold,invMax:0,validator:Wb,iconID:20,radix:0,race:"common",zLevel:0,url:l.item_gold,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Stone",health:1,maxHealth:1,img:l.item_stone,invMax:0,validator:Wb,iconID:22,race:"common",
radix:0,url:l.item_stone,zLevel:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Food",health:15,maxHealth:15,img:l.item_food,invMax:0,mMapcolor:[0,255,255],validator:Wb,iconID:14,url:l.item_food,radix:0,race:"common",icons:[],zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{ignore:1,name:"Wood",health:1,maxHealth:1,img:l.item_wood,invMax:0,validator:Wb,iconID:15,url:l.item_wood,icons:[],race:"common",radix:0,zLevel:0,cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Iron",health:1,maxHealth:1,img:l.item_iron,
invMax:0,validator:Wb,iconID:21,zLevel:0,race:"common",url:l.item_iron,radix:0,icons:[],cost:[0,0,0,0],size:1,z32:.5,item:1},{name:"Keep Tower",strID:"keep_tower",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:16,health:2E3,maxHealth:2E3,img:l.euro_tower_stone,state:0,invType:1,zLevel:1,attackSound:Xf,invMax:0,dieSound:L,validator:M,clss:"keep_tower",race:"common",child:[{alpha:!0,img:l.euro_tower_stone_s,x:0,y:0,rgb:[0,0,0,.5]},{img:l.euro_tower_stone_c,x:0,y:0}],attDist:14,bimg:l.build2x2,
dimg:l.des_2x2,standardFunc:A,iconID:54,icons:[c.attack,c.stop,c.upgradeCannonTower],space:new Uint8Array([1,1,1,1,2]),url:l.euro_tower_stone,build:!0,cost:[0,600,0,0],size:1,arrow:!0,attimg:l.arrow_big1,time:40,sight:18},{name:"Cannon Tower",clss:"tower_stone2",strID:"tower_stone2",attackSound:ve,sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),attack:40,health:2500,maxHealth:2500,img:l.euro_tower_stone_2,state:0,invType:1,invMax:0,dieSound:L,race:"common",validator:M,zLevel:1,child:[{img:l.euro_tower_stone_2_c,
x:0,y:0},{alpha:!0,img:l.euro_tower_stone_2_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:10,bimg:l.build2x2,dimg:l.des_2x2,iconID:54,icons:[c.attack,c.stop],space:new Uint8Array([1,1,1,1,2]),url:l.euro_tower_stone_2,build:!0,cost:[0,600,0,0],standardFunc:A,size:1,arrow:!1,attimg:l.hot_cannon,time:45,sight:18,attackDeg:30},{name:"Rocket Tower",strID:"tower_rocket",race:"asia",clss:"tower_rocket",sound:"gate1 gate2 gate3 gate4 gate5 gate6".split(" "),zLevel:1,attack:30,health:1400,maxHealth:1400,img:l.rocket_tower,
state:0,invType:1,invMax:0,dieSound:L,validator:M,child:[{img:l.rocket_tower_c},{alpha:!0,img:l.rocket_tower_s,x:0,y:0,rgb:[0,0,0,.5]}],attDist:20,bimg:l.build2x2,dimg:l.des_2x2,iconID:186,icons:[],space:new Uint8Array([1,1,1,1,2]),url:l.rocket_tower,build:!0,cost:[0,600,0,0],standardFunc:A,size:1,arrow:!0,attimg:l.arrow_big1,time:60,sight:26},{radix:0,name:"Ork",race:"common",strID:"ork",dieSound:["orc%20die%201","orc%20die%202"],attackSound:jk,attack:18,defence:2,health:75,maxHealth:75,img:l.ork.idle,
invType:0,invMax:8,validator:J,zLevel:1,iconID:143,time:12,sight:5,url:l.ork,standardFunc:A,icons:f,cost:[60,0,0,0],attDist:1,spd:50,clss:"ork",size:1,nu:c.createOrk},{radix:0,name:"Dwarf",race:"common",attack:7,defence:7,health:120,maxHealth:120,img:l.dwarf.idle,invType:0,strID:"dwarf",invMax:8,zLevel:1,dieSound:Aa,validator:J,iconID:185,time:12,sight:3,url:l.dwarf,standardFunc:A,icons:f,cost:[80,0,0,0],attDist:1,spd:50,clss:"dwarf",size:1,nu:c.createDwarf},{radix:0,name:"Skeleton",strID:"skeleton",
race:"common",dieSound:["skeleton%20die%201","skeleton%20die%202","skeleton%20die%203","skeleton%20die%204"],attack:4,defence:0,health:40,maxHealth:40,img:l.skeleton.idle,invType:0,zLevel:1,attackSound:Mc,invMax:8,nofreeze:1,validator:J,iconID:167,time:12,sight:3,url:l.skeleton,standardFunc:A,icons:f,cost:[0,0,30,0],attDist:1,spd:50,clss:"skeleton",size:1,nu:c.createSkeleton},{radix:0,name:"Caravan",race:"euro",strID:"e_caravan",attack:0,defence:0,health:350,maxHealth:350,img:l.caravan.idle,invType:1,
invMax:8,validator:J,iconID:34,zLevel:1,time:50,sight:7,url:l.caravan,icons:[c.move,c.trade,c.explore,c.stop,c.stand,c.unload],cost:[0,200,400,0],attDist:1,spd:75,clss:"caravan",size:1,nu:c.createCaravan},{name:"Castle",health:8E3,maxHealth:8E3,img:l.asia_castle,invType:1,strID:"a_castle",zLevel:1,race:"asia",invMax:50,validator:M,bimg:l.build6x6,dimg:l.des_6x6,iconID:164,time:120,sight:12,dieSound:L,clss:"castle",child:[{img:l.asia_castle_c,x:0,y:0,mv:!0},{alpha:!0,img:l.asia_castle_s,x:0,y:0,rgb:[0,
0,0,.5]}],icons:[c.createPeon1,c.createNinja,c.emergeAllUnits,c.techFeudalism,c.techArchitecture,c.techLearning,c.techBuddhism,c.techGreatWall],space:new Uint8Array([0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,0,0,8]),menu:Fa,url:l.asia_castle,build:!0,cost:[0,1500,0,1500],storage:-1,castle:!0,population:20,size:1},{name:"Castle",dieSound:L,clss:"castle",strID:"r_castle",race:"arab",health:8E3,maxHealth:8E3,img:l.arab_castle,
invType:1,invMax:50,validator:M,bimg:l.build6x6,dimg:l.des_6x6,zLevel:1,iconID:97,time:120,sight:12,child:[{img:l.arab_castle_c}],icons:[c.createPeon2,c.createSpy,c.emergeAllUnits,c.techFeudalism,c.techArchitecture,c.techLearning,c.techSlavery],space:new Uint8Array([0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,0,0,0,1,0,0,0,,8]),menu:Fa,url:l.arab_castle,build:!0,cost:[0,1500,0,1500],storage:-1,castle:!0,population:20,size:1},{radix:0,
name:"Peasant",attack:5,defence:0,health:50,maxHealth:50,img:l.asian_peasant.idle,invType:0,invMax:8,attackSound:Oh,race:"asia",validator:J,human:1,strID:"a_peon",iconID:132,dieSound:Aa,zLevel:1,time:8,peon:1,sight:5,url:l.asian_peasant,icons:[c.move,c.menuBuilds1,c.repair,c.conquest,c.dcm,c.pickUp,c.explore,c.stop,c.stand,c.attack,c.sameSpeed,c.restoreSpeed],cost:[0,0,40,0],attDist:1,spd:50,clss:"peon",nocapture:1,size:1},{radix:0,name:"Ninja",race:"asia",attack:12,defence:5,mana:100,manaMax:100,
health:90,maxHealth:90,img:l.asian_ninja.idle,invType:0,invMax:8,attackSound:Mc,validator:J,human:1,iconID:133,strID:"ninja",dieSound:Aa,zLevel:1,time:20,standardFunc:A,sight:10,url:l.asian_ninja,icons:[c.guard,c.patrol,c.pickUp,c.explore,c.stop,c.stand,c.invisibility,c.murder,c.move,c.attack,c.sameSpeed,c.restoreSpeed],cost:[120,0,0,0],attDist:1,spd:85,clss:"ninja",size:1,update:["mana","manaSpeed",1E3]},{radix:0,name:"Ronin",attack:7,defence:0,health:45,maxHealth:45,img:l.asian_ronin.idle,invType:0,
invMax:8,race:"asia",validator:J,human:1,standardFunc:A,iconID:141,strID:"ronin",dieSound:Aa,zLevel:1,time:8,sight:5,url:l.asian_ronin,icons:f,cost:[0,0,40,0],attDist:1,spd:50,attackSound:Mc,clss:"a_footman",size:1},{radix:0,name:"Archer",attack:5,defence:0,health:50,maxHealth:50,img:l.asian_archer.idle,invType:0,invMax:8,race:"asia",validator:J,human:1,strID:"a_archer",dieSound:Aa,zLevel:1,attimg:l.arrow1,iconID:136,arrow:1,attackSound:Jd,time:12,sight:10,url:l.asian_archer,icons:f,cost:[0,20,40,
0],standardFunc:A,spd:50,clss:"archer",size:1,attDist:6},{radix:0,name:"Samurai",attack:10,defence:4,health:90,maxHealth:90,img:l.asian_samurai.idle,invType:0,race:"asia",strID:"samurai",invMax:8,attackSound:Mc,validator:J,human:1,iconID:142,time:20,standardFunc:A,zLevel:1,dieSound:Aa,sight:6,url:l.asian_samurai,icons:f,cost:[50,0,150,0],attDist:1,spd:50,clss:"a_maceman",size:1},{radix:0,name:"Horse Archer",attack:7,defence:0,health:75,maxHealth:75,img:l.asian_horsarcher.idle,invType:0,race:"asia",
invMax:8,validator:J,human:1,attackSound:Jd,iconID:183,strID:"a_horse_archer",dieSound:we,time:20,standardFunc:A,sight:12,url:l.asian_horsarcher,zLevel:1,icons:f,arrow:1,attimg:l.arrow1,cost:[40,0,120,0],spd:85,clss:"horse_archer",size:1,attDist:7},{radix:0,name:"Horse Samurai",attack:14,defence:4,health:160,maxHealth:160,img:l.asian_horsamurai.idle,invType:0,invMax:8,validator:J,human:1,iconID:135,race:"asia",standardFunc:A,attackSound:ue,time:22,zLevel:1,strID:"horse_samurai",dieSound:we,sight:5,
url:l.asian_horsamurai,icons:f,cost:[75,0,120,0],attDist:1,spd:85,clss:"horse_samurai",size:1},{name:"Barracks",resistance:500,health:1400,maxHealth:1400,img:l.asia_barracks,invType:1,sound:Ph,invMax:0,time:60,dieSound:L,radix:0,sight:6,race:"asia",strID:"a_barrack",validator:M,zLevel:1,bimg:l.build5x5,dimg:l.des_5x5,child:[{img:l.asia_barracks_c,x:0,y:0,mv:!0},{img:l.asia_barracks_s,x:0,y:0,rgb:[0,0,0,.5],alpha:!0}],iconID:146,icons:[c.createRonin,c.createArcher1,c.createSamurai,c.createHorseArcher1,
c.createHorseSamurai,c.createChariot],space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),url:l.asia_barracks,build:!0,cost:[0,200,0,200],size:1,clss:"barracks"},{name:"Chariot",attack:4,defence:3,health:180,maxHealth:180,img:l.asian_charriot.idle,invType:0,radix:0,race:"asia",invMax:8,strID:"chariot",dieSound:["c%20die%201","c%20die%202","c%20die%203","c%20die%204","c%20die%205"],attackSound:ue,validator:J,human:1,zLevel:1,iconID:175,standardFunc:A,time:8,sight:5,url:l.asian_charriot,
icons:f,cost:[0,200,150,0],attDist:1,spd:85,clss:"chariot",size:1},{radix:1,name:"Galleon",attackSound:ve,attack:35,attDist:12,race:"common",defence:0,health:1200,attackTime:2E3,maxHealth:1200,strID:"galleon",nu:c.createGalleon,img:l.galleon.idle,invType:1,invMax:24,dieSound:["ship%20sink"],zLevel:0,validator:qf,iconID:32,time:50,boat:!0,attimg:l.cb_metal,attackDeg:20,sight:16,url:l.galleon,icons:[c.move,c.explore,c.unload,c.attack,c.attackGround,c.stop,c.stand,c.stop,c.stand,c.attack,c.steady,c.upgradeShip],
cost:[0,1200,800,0],spd:50,nofreeze:1,clss:"galleon",standardFunc:A,size:1,peon:1},{radix:1,name:"Fishing Boat",attackSound:ve,attack:0,attDist:8,race:"common",defence:0,health:50,boat:!0,nu:c.createFishingBoat,maxHealth:50,img:l.boat.idle,invType:1,invMax:0,strID:"fishing_boat",dieSound:["ship%20sink"],zLevel:0,validator:qf,iconID:184,nofreeze:1,time:50,sight:16,url:l.boat,icons:[c.move,c.explore,c.stop,c.stand,c.fishing],cost:[0,200,100,0],spd:65,clss:"fishing_boat",size:1},{radix:1,name:"Hulk",
attackSound:ve,attack:18,attDist:10,race:"common",defence:0,health:700,maxHealth:700,strID:"hulk",img:l.hulk.idle,invType:1,attackTime:2E3,boat:!0,nu:c.createHulk,attackDeg:20,invMax:16,dieSound:["ship%20sink"],zLevel:0,validator:qf,iconID:128,time:30,sight:14,attimg:l.cb_metal,url:l.hulk,icons:[c.move,c.explore,c.unload,c.attack,c.attackGround,c.stop,c.stand,c.stop,c.stand,c.attack,c.steady,c.upgradeShip],cost:[0,500,300,0],spd:65,nofreeze:1,clss:"hulk",standardFunc:A,size:1},{radix:1,name:"Pinque",
attackSound:Jd,attack:10,race:"common",attDist:8,defence:0,health:300,boat:!0,maxHealth:300,img:l.xebec.idle,attimg:l.arrow1,arrow:!0,strID:"pinque",invType:1,invMax:8,dieSound:["ship%20sink"],zLevel:0,validator:qf,iconID:129,time:20,nofreeze:1,sight:12,url:l.xebec,icons:[c.move,c.explore,c.unload,c.attack,c.attackGround,c.stop,c.stand,c.stop,c.stand,c.attack,c.steady,c.upgradeShip],cost:[0,300,200,0],spd:80,clss:"xebec",size:1,standardFunc:A,nu:c.createXebec},{radix:0,name:"Stone Golem",strID:"troll",
defence:3,attack:25,health:400,maxHealth:400,img:l.troll.idle,invType:0,invMax:0,dieSound:["golem"],validator:J,iconID:144,race:"common",zLevel:1,nofreeze:1,attackSound:["golem1","golem2"],sight:10,standardFunc:A,url:l.troll,icons:f,w:1,cost:[120,0,0,0,600],attDist:1,spd:56,clss:"troll",size:1},{radix:0,name:"Bat",strID:"bat",defence:0,attack:3,health:20,maxHealth:20,img:l.bat.move,invType:0,invMax:0,race:"common",bat:1,dieSound:["bat%20die"],validator:ih,iconID:105,zLevel:2,attackSound:["bat%20attack"],
sight:10,standardFunc:A,url:l.bat,icons:f,w:1,cost:[0,0,0,0,25],attDist:1,spd:128,clss:"bat",size:1,z32:1.5},{race:"arab",invType:0,invMax:8,iconID:138,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_peasant,img:l.arab_peasant.idle,spd:50,validator:J,human:1,icons:[c.move,c.menuBuilds2,c.repair,c.conquest,c.dcm,c.pickUp,c.explore,c.stop,c.stand,c.attack,c.convertJihad,c.bribe,c.sameSpeed,c.restoreSpeed],name:"Peasant",clss:"peon",cost:[0,0,50,0],attDist:1,time:8,nocapture:1,peon:1,sight:5,
health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:172,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_footman,img:l.arab_footman.idle,standardFunc:A,spd:50,validator:J,human:1,attDist:1,icons:f,name:"Footman",clss:"footman",cost:[0,0,50,0],time:12,sight:5,health:50,attack:6,defence:1},{race:"arab",invType:0,invMax:8,iconID:170,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_archer,img:l.arab_archer.idle,spd:50,validator:J,standardFunc:A,human:1,attimg:l.arrow1,
arrow:1,icons:f,name:"Archer",clss:"archer",cost:[0,20,40,0],time:12,sight:10,attDist:6,health:50,attack:5,defence:0},{race:"arab",invType:0,invMax:8,iconID:173,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_spearman,img:l.arab_spearman.idle,spd:50,validator:J,standardFunc:A,human:1,icons:f,name:"Spearman",clss:"pikeman",attDist:1,cost:[40,0,60,0],time:14,sight:5,health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:174,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,
standardFunc:A,url:l.arab_satrap,img:l.arab_satrap.idle,spd:50,validator:J,human:1,icons:f,name:"Satrap",attDist:1,clss:"maceman",cost:[0,0,120,0],time:14,sight:5,health:120,attack:8,defence:0},{race:"arab",invType:0,invMax:8,iconID:171,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_cavalry,standardFunc:A,img:l.arab_cavalry.idle,spd:85,validator:J,human:1,attDist:1,icons:f,name:"Cavalry",clss:"heavy_cavalry",cost:[60,0,100,0],time:14,sight:5,health:90,attack:10,defence:4},{race:"arab",
invType:0,invMax:8,iconID:168,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_horse_archer,img:l.arab_horse_archer.idle,spd:85,validator:J,human:1,standardFunc:A,icons:f,name:"Horse Archer",clss:"horse_archer",cost:[50,0,100,0],time:14,attimg:l.arrow1,arrow:1,sight:12,attDist:7,health:75,attack:6,defence:2},{race:"arab",invType:0,invMax:8,iconID:179,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_jwarrior,img:l.arab_jwarrior.idle,spd:50,validator:J,human:1,standardFunc:A,
icons:f,name:"Jihad warrior",attDist:1,clss:"jihad_warrior",cost:[0,0,100,0],time:8,sight:5,health:75,attack:10,defence:2},{race:"arab",invType:0,invMax:8,iconID:176,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_priest,img:l.arab_priest.idle,standardFunc:A,spd:50,mana:100,validator:J,human:1,icons:g,name:"Priest",clss:"priest",cost:[150,0,0,0],time:30,sight:21,attDist:18,health:60,attack:20,update:["mana","manaSpeed",1E3],manaMax:100,defence:0,attimg:l.flame_bolt,ball:1,attackOnly:pf.magic_creatures.obj},
{race:"arab",invType:0,invMax:0,iconID:105,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:0,img:0,testing:1,illegal:1,spd:50,validator:J,human:1,icons:[],name:"Spy",clss:"spy",cost:150,time:30,sight:12,health:50,attack:20,defence:0},{race:"arab",invType:0,invMax:8,iconID:188,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,attimg:l.flame_bolt,url:l.arab_mage,img:l.arab_mage.idle,spd:50,validator:J,human:1,icons:[c.stop,c.pickUp,c.explore,c.createCarpet,c.createJinn,c.fireRain,c.magicVision,
c.raiseDead,c.attack,c.stand,c.move],standardFunc:A,name:"Mage",clss:"mage",ball:1,mana:100,manaMax:100,update:["mana","manaSpeed",1E3],cost:[150,0,0,0],time:30,sight:15,attDist:10,health:60,attack:8,defence:0},{race:"arab",invType:1,invMax:8,iconID:126,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_caravan,img:l.arab_caravan.idle,spd:75,validator:J,human:1,icons:[],name:"Caravan",clss:"trader",cost:[0,0,500,0],time:30,sight:5,health:150},{race:"arab",invType:0,invMax:8,iconID:177,
zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.arab_enichar,img:l.arab_enichar.idle,spd:85,validator:J,human:1,standardFunc:A,icons:f,name:"Enichar",attDist:1,clss:"enichar",cost:[80,0,120,0],time:25,sight:5,health:130,attack:18,defence:4},{race:"arab",invType:1,invMax:0,iconID:82,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,population:10,url:l.arab_houses,validator:M,build:1,icons:[],child:[{img:l.arab_houses_c}],name:"House",clss:"house",
cost:[0,75,0,0],time:20,sight:4,resistance:50,health:500},{race:"arab",invType:1,invMax:0,iconID:85,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.arab_lumbermill,validator:M,build:1,icons:[c.techWoodCutting,c.techCrossbow],child:[{img:l.arab_lumbermill_c}],name:"Lumber Mill",clss:"lumber",cost:[0,100,0,0],storage:1,time:30,sight:4,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:96,zLevel:1,dieSound:L,space:new Uint8Array([1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_storage,validator:M,build:1,storage:0,icons:[c.techGoldMining,c.techStoneMining],child:[{img:l.arab_storage_c},{alpha:!0,img:l.arab_storage_s,rgb:[0,0,0,.5]}],name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:80,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_farm,
validator:M,build:1,icons:[c.createCow,c.techCropRotation,c.techDomestication,c.techCowPoaching,c.ridingHorses,c.techHorseManShip],child:[{img:l.arab_farm_c}],name:"Farm",storage:2,clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:81,zLevel:1,dieSound:L,validator:hh,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,4]),bimg:l.build_harbor,dimg:l.des_harbor,radix:0,url:l.arab_harbour,build:1,icons:[c.createFishingBoat,c.createXebec,c.createHulk,
c.techLandingTactics],child:[{img:l.arab_harbour_c},{alpha:!0,img:l.arab_harbour_s,rgb:[0,0,0,.5]}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,iconID:79,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.arab_blacksmith,validator:M,build:1,icons:[c.techTemperIron,c.techScaleArmor,c.techScimitar,c.techChainMail,c.techHalberd],child:[{img:l.arab_blacksmith_c},{alpha:!0,
img:l.arab_blacksmith_s,rgb:[0,0,0,.5]}],name:"Blacksmith",clss:"blacksmith",cost:[0,150,150,0],onbuild:n,time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:95,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_workshop,validator:M,build:1,icons:[c.createCatapult,c.createBallist,c.techEngineering,c.techCannonTower],child:[{img:l.arab_workshop_c},{alpha:!0,img:l.arab_workshop_s,rgb:[0,0,0,.5]}],
name:"Workshop",clss:"workshop",cost:[0,150,150,0],time:40,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:0,iconID:140,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.arab_church,validator:M,build:1,icons:[c.createPriest2],child:[{img:l.arab_church_c},{alpha:!0,img:l.arab_church_s,rgb:[0,0,0,.5]}],name:"Church",clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"arab",invType:1,invMax:0,iconID:92,
zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_tavern,validator:M,build:1,icons:[c.createMercenaries,c.createHeroes],child:[{img:l.arab_tavern_c}],name:"Tavern",clss:"tavern",cost:[0,200,200,0],onbuild:d,actvintv:[c.iniMercenaries,c.iniHeroes],time:40,sight:5,resistance:150,health:1E3},{race:"arab",invType:1,invMax:0,iconID:87,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,
dimg:l.des_4x4,radix:0,url:l.arab_market,validator:M,build:1,icons:[c.createCaravan2],child:[{img:l.arab_market_c}],name:"Market",clss:"market",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"arab",invType:1,invMax:0,iconID:98,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.arab_barracks,validator:M,build:1,icons:[c.createFootman2,c.createArcher2,c.createSatrap,c.createPikeman2,c.createHorseArcher2,
c.createCavalry,c.createEnichar,c.createJihad],child:[{img:l.arab_barracks_c},{alpha:!0,img:l.arab_barracks_s,rgb:[0,0,0,.5]}],name:"Barracks",clss:"barrack",cost:[0,0,200,200],time:60,sight:6,resistance:500,health:1400},{race:"arab",invType:1,invMax:0,iconID:91,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_stables,validator:M,build:1,icons:[],child:[{img:l.arab_stables_c}],name:"Stable",clss:"stable",cost:[0,200,200,
0],time:40,onbuild:h,sight:5,resistance:80,health:800},{race:"arab",invType:1,invMax:50,iconID:89,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_outpost,validator:M,build:1,icons:[c.emergeAllUnits],child:[{img:l.arab_outpost_c,mv:1},{alpha:!0,img:l.arab_outpost_s,rgb:[0,0,0,.5]}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},{race:"arab",invType:1,invMax:0,iconID:105,zLevel:1,
dieSound:L,space:23213123,bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:0,img:0,validator:M,build:1,icons:[],child:[{img:3213123}],name:"NULL",testing:1,clss:"castle",cost:[0,1500,0,1500],time:120,sight:12,resistance:1E3,health:8E3},{race:"arab",invType:1,invMax:0,iconID:88,zLevel:1,dieSound:L,space:new Uint8Array([0,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,0,6]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.arab_mosque,validator:M,build:1,icons:[c.techFanaticism,c.techEspionage,
c.techHealing,c.techBless,c.techJihad],child:[{img:l.arab_mosque_c},{alpha:!0,img:l.arab_mosque_s,rgb:[0,0,0,.5]}],name:"Mosque",onbuild:[c.buildChurch2],clss:"mosque",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:86,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.arab_magetower,validator:M,build:1,icons:[c.createMage2,c.techCarpet,c.techMagicWorkshop,c.techFireRain,c.techMagicVision,
c.techNecromancy,c.techJinn],child:[{img:l.arab_magetower_c},{alpha:!0,img:l.arab_magetower_s,rgb:[0,0,0,.5]}],name:"Mage Guild",clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:93,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.arab_tc_guild,validator:M,build:1,icons:[c.techUsury,c.techTradeRoutes,c.techSupplyStorage,c.techBribery,c.techOreFloatation],
child:[{img:l.arab_tcguild_c},{alpha:!0,img:l.arab_tc_guild_s,rgb:[0,0,0,.5]}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,0,2E3],time:90,onbuild:[c.buildMarket2],sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:94,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.arab_waracademy,validator:M,build:1,icons:[c.techHeroism,c.techWarfare,c.techMercenaries,c.techRiddingHorses,c.techBodyBuilding,
c.techLeadership,c.techHeroes,c.techJanissary,c.techHonor,c.techFame],child:[{img:l.arab_waracademy_c},{alpha:!0,img:l.arab_waracademy_s,rgb:[0,0,0,.5]}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"arab",invType:1,invMax:0,iconID:158,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.arab_magicworkshop,validator:M,build:1,icons:[c.createObjects],child:[{img:l.arab_magicworkshop_c},
{alpha:!0,img:l.arab_magicworkshop_s,rgb:[0,0,0,.5]}],name:"Magic Workshop",disallowPoint:!0,clss:"magicworkshop",cost:[0,0,0,300],time:20,sight:5,resistance:200,health:1200},{race:"asia",invType:1,invMax:0,iconID:161,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,0,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.asia_houses,validator:M,build:1,icons:[],child:[{img:l.asia_houses_c}],name:"House",clss:"house",cost:[0,75,0,0],population:10,time:20,sight:4,resistance:50,health:500},{race:"asia",
invType:1,invMax:0,iconID:149,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,storage:1,url:l.asia_lumbermill,validator:M,build:1,icons:[c.techWoodCutting,c.techCrossbow],child:[{img:l.asia_lumbermill_c},{img:l.asia_lumbermill_s,rgb:[0,0,0,.5],alpha:!0}],name:"Lumber Mill",clss:"lumber",cost:[0,100,0,0],time:30,sight:4,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:154,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_storage,storage:0,validator:M,build:1,icons:[c.techGoldMining,c.techStoneMining],child:[{img:l.asia_storage_s,rgb:[0,0,0,.5],alpha:!0},{img:l.asia_storage_c}],name:"Storage",clss:"storage",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:147,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,storage:2,url:l.asia_farm,
validator:M,build:1,icons:[c.techCropRotation,c.ridingHorses,c.irrigation],child:[{img:l.asia_farm_c}],name:"Farm",clss:"farm",cost:[0,200,0,0],time:30,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:148,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,1,1,1,1,1,1,3]),validator:hh,bimg:l.build_harbor,dimg:l.des_harbor,radix:0,url:l.asia_harbor,build:1,icons:[c.createFishingBoat,c.createXebec,c.createHulk,c.techLandingTactics],child:[{img:l.asia_harbor_c},{img:l.asia_harbor_s,
rgb:[0,0,0,.5],alpha:!0}],name:"Harbor",clss:"harbor",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:145,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asia_blacksmith,validator:M,build:1,icons:[c.techTemperIron,c.techScaleArmor,c.techArmoredChariot,c.techChainMail],child:[{img:l.asia_blacksmith_c},{img:l.asia_blacksmith_s,rgb:[0,0,0,.5],alpha:!0}],name:"Blacksmith",
clss:"blacksmith",cost:[0,150,150,0],time:40,sight:5,onbuild:n,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:157,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_workshop,validator:M,build:1,icons:[c.createCatapult,c.createBallist,c.techEngineering,c.techCannonTower],child:[{img:l.asia_workshop_c,x:0,y:0},{img:l.asia_workshop_s,rgb:[0,0,0,.5],alpha:!0}],name:"Workshop",clss:"workshop",cost:[0,150,150,
0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:162,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,0,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,1,0,0,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asian_monastery,validator:M,build:1,icons:[c.createMonk,c.createPriest1],child:[{img:l.asian_monastery_c},{img:l.asian_monastery_s,rgb:[0,0,0,.5],alpha:!0}],name:"Monastery",clss:"church",cost:[0,0,200,200],time:40,sight:6,resistance:200,health:1E3},{race:"asia",invType:1,
invMax:0,iconID:155,zLevel:1,dieSound:L,space:new Uint8Array([1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_tavern,validator:M,build:1,icons:[c.createMercenaries,c.createHeroes],child:[{img:l.asia_tavern_c},{img:l.asia_tavern_s,rgb:[0,0,0,.5],alpha:!0}],onbuild:d,name:"Tavern",clss:"tavern",actvintv:[c.iniMercenaries,c.iniHeroes],cost:[0,200,200,0],time:40,sight:5,resistance:150,health:1E3},{race:"asia",invType:1,invMax:0,iconID:150,zLevel:1,dieSound:L,space:new Uint8Array([1,
1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_market,validator:M,build:1,icons:[],child:[{img:l.asia_market_c}],name:"Market",clss:"market",cost:[0,200,200,0],time:60,sight:8,resistance:200,health:1400},{race:"asia",invType:1,invMax:0,iconID:153,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,4]),bimg:l.build4x4,dimg:l.des_4x4,radix:0,url:l.asia_stables,validator:M,build:1,icons:[],child:[{img:l.asia_stables_c,mv:!0},{img:l.asia_stables_s,
rgb:[0,0,0,.5],alpha:!0}],name:"Stable",clss:"stable",onbuild:h,cost:[0,200,200,0],time:40,sight:5,resistance:80,health:800},{race:"asia",invType:1,invMax:0,iconID:151,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,3]),bimg:l.build3x3,dimg:l.des_3x3,radix:0,url:l.asia_outpost,validator:M,build:1,icons:[c.emergeAllUnits],child:[{img:l.asia_outpost_c,mv:1},{img:l.asia_outpost_s,rgb:[0,0,0,.5],alpha:!0}],name:"Outpost",clss:"outpost",cost:[0,200,0,400],time:60,sight:8,resistance:500,health:2E3},
{race:"asia",invType:1,invMax:0,iconID:163,zLevel:1,dieSound:L,space:new Uint8Array([0,0,1,1,0,0,0,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,0,6]),bimg:l.build6x6,dimg:l.des_6x6,radix:0,url:l.asia_shao_lin,validator:M,build:1,icons:[c.techMeditation,c.techKungFu,c.techHealing,c.techPhilosophy,c.techNinjas,c.techMastery,c.techTournaments,c.techMedicine],child:[{img:l.asia_shao_lin_c},{img:l.asia_shao_lin_s,rgb:[0,0,0,.5],alpha:!0}],name:"Shao Linn",onbuild:[c.buildChurch1],clss:"shaolinn",
cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:152,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asia_wizardguild,validator:M,build:1,icons:[c.createMage1,c.techConcentration,c.techWhirlpool,c.techFlameBolt,c.techTurnToStone,c.techConfusion,c.techDragon],child:[{img:l.asia_wizardguild_c},{img:l.asia_wizardguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Mage Guild",
clss:"magetower",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:159,zLevel:1,dieSound:L,space:new Uint8Array([0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asia_tcguild,validator:M,build:1,icons:[c.techTradeRoutes,c.techUsury,c.techJewelry,c.techSupplyStorage,c.techBanking,c.techChemistry,c.techSeaFood,c.techGunPowder,c.techRocketArrow],child:[{img:l.asia_tcguild_c,mv:!0},{img:l.asia_tcguild_s,
rgb:[0,0,0,.5],alpha:!0}],name:"Merchants Guild",clss:"tcguild",cost:[2E3,0,0,2E3],time:90,onbuild:[c.buildMarket1],sight:8,resistance:700,health:5E3},{race:"asia",invType:1,invMax:0,iconID:156,zLevel:1,dieSound:L,space:new Uint8Array([1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,5]),bimg:l.build5x5,dimg:l.des_5x5,radix:0,url:l.asia_warguild,validator:M,build:1,icons:[c.techBushido,c.techHeroism,c.techWarfare,c.techMercenaries,c.techLeadership,c.techTactics,c.techHeroes,c.techHonor,c.techSunTzu],
child:[{img:l.asia_warguild_c,mv:!0},{img:l.asia_warguild_s,rgb:[0,0,0,.5],alpha:!0}],name:"Warriors Guild",clss:"academy",cost:[2E3,0,0,2E3],time:90,sight:8,resistance:700,health:5E3},{race:"asia",invType:0,invMax:0,iconID:166,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.asian_priest,img:l.asian_priest.idle,spd:50,validator:J,human:1,icons:[c.attack,c.stop,c.stand,c.pickUp,c.explore,c.healing,c.teach,c.move],name:"Priest",clss:"priest",cost:[170,0,0,0],time:30,sight:21,health:120,standardFunc:A,
attDist:1,attack:10,defence:10,mana:100,update:["mana","manaSpeed",1E3],manaMax:100},{race:"asia",invType:0,invMax:0,iconID:187,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.asian_monk,img:l.asian_monk.idle,spd:50,validator:J,human:1,icons:f,name:"Monk",standardFunc:A,clss:"monk",cost:[0,0,200,0],time:20,sight:5,health:90,attack:6,defence:6,attDist:1},{race:"asia",invType:0,invMax:0,iconID:134,zLevel:1,dieSound:[],attackSound:[],size:1,radix:0,url:l.asian_mage,img:l.asian_mage.idle,spd:50,
attimg:l.flame_bolt,validator:J,standardFunc:A,human:1,icons:[c.stop,c.pickUp,c.explore,c.confusion,c.turnToStone,c.whirlpool,c.flameBolt,c.createDragon,c.attack,c.stand,c.move],name:"Mage",clss:"mage",cost:[150,0,0,0],ball:1,time:30,sight:15,mana:100,attDist:10,health:60,attack:8,defence:0,update:["mana","manaSpeed",1E3],manaMax:100},{radix:0,name:"Dragon",strID:"dragon",defence:0,attack:25,health:300,maxHealth:300,img:l.dragon.idle,invType:0,invMax:0,dieSound:[],sSizex:2,sSizey:2,dragon:1,iconID:160,
race:"common",zLevel:2,nofreeze:1,attackSound:[],sight:12,standardFunc:A,url:l.dragon,icons:f,cost:[80,0,0,0,800],attDist:2,spd:128,clss:"drg",size:1,z32:1.5,validator:ih},{radix:0,name:"Carpet",strID:"carpet",defence:0,attack:0,health:90,maxHealth:90,img:l.carpet.idle,invType:1,invMax:8,dieSound:[],iconID:131,race:"common",zLevel:2,nofreeze:1,attackSound:[],sight:8,url:l.carpet,icons:[c.move,c.unload,c.explore,c.stop,c.stand],cost:[80,0,0,0,500],attDist:2,spd:120,clss:"carpet",size:1,z32:1.5,validator:ih},
{radix:0,name:"Jinn",strID:"jinn",defence:5,attack:20,health:300,maxHealth:300,img:l.arab_jinn.idle,invType:0,invMax:0,dieSound:[],validator:J,iconID:182,race:"common",zLevel:1,nofreeze:1,attackSound:[],sight:8,standardFunc:A,url:l.arab_jinn,icons:f,w:1,cost:[80,0,0,0,300],attDist:1,spd:85,clss:"jinn",size:1}];ye={};Yi={arr:[]};Ma={euro:[],asia:[],arab:[],common:[]};Gl=[];ob=[[],[],[],[],[],[]];m=0;for(var w=B.length;m<w;m++){b=B[m];B[m].type=m;var y=b.space;b.name.split(" ").join("");b.population&&
Gl.put(b);ye[m]={};void 0!==b.storage&&(-1<b.storage?(0===b.storage&&ob[3].put(m),ob[b.storage].put(m)):(ob[0].put(m),ob[1].put(m),ob[2].put(m),ob[3].put(m)));tb[b.race][b.name.toLowerCase().split(" ").join("")]=b;b.icons.menuName=b.strID;Yi[b.name]=m;Yi.arr.put(m);b.img||(b.img=b.url);b.maxHealth=b.health;b.race&&Ma[b.race].put(b);h=0;e=b.icons;for(g=e.length;h<g;h++)(n=e[h])&&n.obj&&(n.orderOrigin=b);if(y){h=[];b.free=h;d=y[y.length-1];b=(y.length-1)/d;var r=d+2;g=b+2;e=new Uint8Array(r*g);for(n=
0;n<b;n++)for(var z=0;z<d;z++)e[(n+1)*r+z+1]=y[z+n*d];n=0;for(g*=r;n<g;n++)!e[n]&&(e[n+1]||e[n-1]||e[n+1+r]||e[n+1-r]||e[n-1+r]||e[n-1-r]||e[n+r]||e[n-r])&&(h.put(n%r-1),h.put(~~(n/r)-1))}}Ma.euro=Ma.euro.concat(Ma.common);Ma.asia=Ma.asia.concat(Ma.common);Ma.arab=Ma.arab.concat(Ma.common);Ma[0]=Ma.euro;Ma[1]=Ma.arab;Ma[2]=Ma.asian;g=tb.euro;e=tb.asia;n=tb.arab;d=tb.common;tb[0]=tb.euro;tb[1]=tb.arab;tb[2]=tb.asia;of||(f.cut=S({a:"attack",g:"guard",r:"patrol",p:"pickUp",e:"explore",s:"stop",n:"stand"}),
g.tavern.icons.cut=S({t:"trade1",g:"gamble",m:"createMercenaries",h:"createHeroes",l:"loan"}),g.castle.icons.cut=S({p:"createPeon",s:"createSpy",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning"}),e.castle.icons.cut=S({p:"createPeon1",n:"createNina",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning",b:"techBudhism",w:"techGreatwall"}),n.castle.icons.cut=S({p:"createPeon2",s:"createSpy",e:"emergeAllUnits",d:"techFeudalism",a:"techArchitecture",l:"techLearning",
y:"techSlavery"}),g.barracks.icons.cut=S({f:"createFootman",a:"createArcher",m:"createMaceman",p:"createPikeman",l:"createLongbowman",k:"createKnight"}),e.barracks.icons.cut=S({r:"createRonin",a:"createArcher1",s:"createSamurai",h:"createHorseArcher1",o:"createHorseSamurai",c:"createChariot"}),n.barracks.icons.cut=S({f:"createFootman2",a:"createArcher2",s:"createSatrap",p:"createPikeman2",h:"createHorseArcher2",c:"createCavalry",j:"createEnichar",d:"createJihad"}),g.magetower.icons.cut=S({m:"createMage"}),
e.mageguild.icons.cut=S({m:"createMage1"}),n.mageguild.icons.cut=S({m:"createMage2"}),g.peasant.icons.cut=S({b:"menuBuilds",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",i:"bribe"}),n.peasant.icons.cut=S({b:"menuBuilds2",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",j:"become_jihadw",i:"bribe"}),e.peasant.icons.cut=S({b:"menuBuilds1",r:"repair",c:"capture",h:"dcm",p:"pickUp",e:"explore",s:"stop",n:"stand",a:"attack",t:"trade"}),
g.priest.icons.cut=S({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",b:"bless"}),n.priest.icons.cut=S({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",b:"bless"}),e.priest.icons.cut=S({m:"move",a:"attack",e:"explore",s:"stop",n:"stand",h:"healing",r:"raiseexp"}),g.wizard.icons.cut=S({m:"move",a:"attack",s:"stop",n:"stand",l:"lightning",b:"createBat",f:"freeze",t:"createGolem",i:"invisibility"}),n.mage.icons.cut=S({m:"move",a:"attack",s:"stop",n:"stand",c:"spell_spawncarpet",
j:"spell_spawnjin",r:"spell_firerain",v:"spell_magicvision",d:"raisedead"}),e.mage.icons.cut=S({m:"move",a:"attack",s:"stop",n:"stand",h:"spell_hypnotize",t:"spell_turntostone",w:"spell_whirlpool",f:"spell_flamebolt",d:"spell_spawndragon"}),d.spy.icons.cut=S({a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",n:"stand",s:"stop"}),e.monk.icons.cut=S({a:"attack",g:"guard",r:"patrol",p:"pick_item",e:"explore",s:"stop",n:"stand"}),e.ninja.icons.cut=S({a:"attack",g:"guard",r:"patrol",p:"pick_item",
e:"explore",s:"stop",n:"stand",c:"cloak",u:"murder"}),d.catapult.icons.cut=S({a:"attack",g:"guard",p:"patrol",e:"explore",s:"stop",n:"stand",r:"attack_ground",h:"hold_steady"}),g.market.icons.cut=S({c:"createCaravan"}),n.market.icons.cut=S({c:"createCaravan2"}),e.market.icons.cut=S({b:"market_items",s:"market_sell"}),g.workshop.icons.cut=S({c:"createCatapult",h:"createHeavyCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),n.workshop.icons.cut=S({c:"createCatapult",b:"createBallista",
e:"techEngineering",t:"techCannonTower"}),e.workshop.icons.cut=S({c:"createCatapult",b:"createBallista",e:"techEngineering",t:"techCannonTower"}),g.church.icons.cut=S({p:"createPriest"}),n.church.icons.cut=S({p:"createPriest2"}),e.monastery.icons.cut=S({m:"createMonk",p:"createPriest1"}),n.magicworkshop.icons.cut=S({i:"build_item"}),h=S({c:"buildCastle",s:"buildStorage",b:"buildBarrack",k:"buildBlacksmith",f:"buildFarm",l:"buildLumbermill",p:"buildWorkshop",e:"buildCathedral",u:"buildChurch",n:"buildTavern",
m:"buildMageTower",a:"buildStable",r:"buildHarbor",o:"buildOutpost",i:"buildFields",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse",g:"buildGateWood",y:"buildDummy"}),f=S({c:"buildCastle2",k:"buildBlacksmith2",f:"buildFarm2",n:"buildTavern2",b:"buildBarrack2",p:"buildWorkshop2",s:"buildStorage2",a:"buildStable2",l:"buildLumbermill2",r:"buildHarbor2",o:"buildOutpost2",u:"buildChurch2",e:"buildMosque",i:"buildFields",m:"buildMageTower2",w:"buildWoodWall",d:"buildBridge",t:"buildTower",
h:"buildHouse2",g:"buildGateWood"}),m=S({c:"buildCastle1",f:"buildFarm1",e:"buildShaolinn",n:"buildTavern1",b:"buildBarrack1",p:"buildWorkshop1",s:"buildStorage1",k:"buildBlacksmith1",a:"buildStable1",l:"buildLumbermill1",r:"buildHarbor1",o:"buildOutpost1",u:"buildChurch1",i:"buildFields",m:"buildMageTower1",w:"buildWoodWall",d:"buildBridge",t:"buildTower",h:"buildHouse1",g:"buildGateWood"}),rf.cut=m,sf.cut=m,tf.cut=h,uf.cut=h,vf.cut=h,wf.cut=m,xf.cut=h,yf.cut=m,zf.cut=f,Af.cut=f,Bf.cut=f,Cf.cut=
f,g.lumbermill.icons.cut=S({b:"techLongbow",w:"techWoodCutting",c:"techCrossbow"}),n.lumbermill.icons.cut=S({w:"techWoodCutting",c:"techCrossbow"}),e.lumbermill.icons.cut=S({w:"techWoodCutting",c:"techCrossbow"}),g.blacksmith.icons.cut=S({p:"techPlateArmor",t:"techTemperIron",s:"techScaleArmor",h:"techHalberd",c:"techChainMail"}),n.blacksmith.icons.cut=S({t:"techTemperIron",a:"techScaleArmor",s:"techScimitar",c:"techChainMail",h:"techHalberd"}),e.blacksmith.icons.cut=S({t:"techTemperIron",a:"techScaleArmor",
r:"techArmoredChariot",c:"techChainMail"}),g.outpost.icons.cut=S({e:"emergeAllUnits"}),n.outpost.icons.cut=S({e:"emergeAllUnits"}),e.outpost.icons.cut=S({e:"emergeAllUnits"}),d.watchtower.icons.cut=S({a:"attack",s:"stop",g:"upgradeGuildTower"}),d.guardtower.icons.cut=S({a:"attack",s:"stop",g:"upgradeStoneTower",c:"upgradeCannonTower"}),d.keeptower.icons.cut=S({a:"attack",s:"stop",c:"upgradeCannonTower"}),d.cannontower.icons.cut=S({a:"attack",r:"attack_ground",s:"stop",h:"holdfire"}),e.rockettower.icons.cut=
S({a:"attack",r:"attack_ground",s:"stop",f:"fireatwill"}),g.harbor.icons.cut=S({f:"createFishingBoat",x:"createXebec",h:"createHulk",g:"createGalleon",t:"te_landingtactics"}),n.harbor.icons.cut=S({f:"createFishingBoat",h:"createHulk",x:"createXebec",t:"te_landingtactics"}),e.harbor.icons.cut=S({f:"createFishingBoat",h:"createHulk",x:"createXebec"}),g.farm.icons.cut=S({c:"createCow",f:"techCropRotation",d:"techDomestication"}),n.farm.icons.cut=S({c:"createCow",f:"techDomestication",d:"techDomestication",
p:"techCowPoaching",r:"ridingHorses",h:"techHorseManShip"}),e.farm.icons.cut=S({f:"techDomestication",a:"ridingHorses",i:"irrigation"}),g.storage.icons.cut=S({g:"techGoldMining",s:"techStoneMining"}),n.storage.icons.cut=S({g:"techGoldMining",s:"techStoneMining"}),e.storage.icons.cut=S({g:"techGoldMining",s:"techStoneMining"}),g.cathedral.icons.cut=S({c:"createCrusaders"}),d.magicgateway.icons.cut=S({o:"createOrk",d:"createDwarf",g:"createGhost",s:"createSkeleton"}));h=[g.knight,e.horsesamurai,n.cavalry,
n.enichar,g.crusader,e.chariot,e.horsearcher,n.horsearcher];f=[e.horsesamurai,g.crusader,n.enichar];m=[g.knight,n.cavalry,e.chariot,e.horsearcher,n.horsearcher];b=[g.longbowman,n.archer,e.archer,g.archer];w=[d.catapult,d.ballista,d.heavycatapult];y=[d.galleon,d.hulk,d.pinque,d.fishingboat];r=[d.galleon,d.hulk,d.pinque];z=[n.satrap,g.maceman];var C=[g.longbowman,n.archer,e.archer,g.archer,e.horsearcher,n.horsearcher,d.pinque,d.watchtower,d.keeptower,d.guardtower],G=[d.stonegolem,d.ork,d.dwarf,d.skeleton,
d.ghost,d.dragon,d.jinn,d.bat,g.wizard,n.mage,e.mage],H=[g.peasant,e.peasant,n.peasant,g.footman,n.footman,e.ronin,g.pikeman,n.spearman,n.satrap,g.maceman,n.cavalry,n.jihadwarrior,d.spy,n.enichar,e.horsesamurai,e.monk,e.chariot,e.ninja,d.stonegolem,d.ork,d.dwarf,d.jinn,d.skeleton,d.ghost,g.knight,g.crusader],I=[d.watchtower,d.keeptower,d.guardtower,d.cannontower],K=[d.cannontower,e.rockettower],O=[g.cathedral,g.castle,d.woodenwall,g.barracks,g.lumbermill,g.magetower,g.warriorsguild,g.storage,g.farm,
g.merchantsguild,g.church,g.blacksmith,g.stable,g.workshop,g.tavern,g.house,d.watchtower,g.market,g.outpost,d.bridge,g.harbor,d.guardtower,d.keeptower,d.cannontower,e.rockettower,e.castle,n.castle,e.barracks,n.house,n.lumbermill,n.storage,n.farm,n.harbor,n.blacksmith,n.workshop,n.church,n.tavern,n.market,n.barracks,n.stable,n.outpost,n.mosque,n.mageguild,n.merchantsguild,n.warriorsguild,n.magicworkshop,e.house,e.lumbermill,e.storage,e.farm,e.harbor,e.blacksmith,e.workshop,e.monastery,e.tavern,e.market,
e.stable,e.outpost,e.shaolinn,e.mageguild,e.merchantsguild,e.warriorsguild],T=[g.cathedral,g.castle,d.woodenwall,g.barracks,g.lumbermill,g.magetower,g.warriorsguild,g.storage,g.farm,g.merchantsguild,g.church,g.blacksmith,g.stable,g.workshop,g.tavern,g.house,d.watchtower,g.market,g.outpost,d.bridge,g.harbor,e.castle,n.castle,e.barracks,n.house,n.lumbermill,n.storage,n.farm,n.harbor,n.blacksmith,n.workshop,n.church,n.tavern,n.market,n.barracks,n.stable,n.outpost,n.mosque,n.mageguild,n.merchantsguild,
n.warriorsguild,n.magicworkshop,e.house,e.lumbermill,e.storage,e.farm,e.harbor,e.blacksmith,e.workshop,e.monastery,e.tavern,e.market,e.stable,e.outpost,e.shaolinn,e.mageguild,e.merchantsguild,e.warriorsguild],P=[d.catapult,d.heavycatapult],U=[g.pikeman,n.spearman],W=[e.monk,e.priest],Y=[d.woodenwall],V=[g.peasant,e.peasant,n.peasant],Z=[g.wizard,n.mage,e.mage],ha=[g.footman,n.footman,e.ronin],ea=[g.priest,n.priest,e.priest];jb={bless:{img:l.bless,d:0,mv:1},star:{img:l.star,d:0,mv:1},heal:{img:l.healing,
d:0,mv:1},impersonate:{img:l.impersonate,d:0,mv:1},select:{img:l.select,d:0,mv:0,select:1,z32:.8},spawn:{img:l.spawn,d:0,mv:1},curse:{img:l.curse,d:0,mv:1},turnStone:{img:l.turn_to_stone,d:0,mv:1}};var N=function(b,d,e){for(var c=b.length,f=0,g=d.length;f<g;f++)for(var h=0;h<c;h++)ye[b[h].type][d[f].type]=e};N(K,r,4);N(r,r,3);N(r,T,3);N(r,I,3);N(r,Y,5);N(r,w,2);N(P,T,4);N(P,y,4);N(P,I,6);N(P,w,4);N(P,Y,9);N([e.samurai],f,.5);N([e.samurai],m,.3);N([e.ronin],V,1);N(U,h,6);N(ha,U,1.5);N(ha,b,1.5);N(ha,
[n.jihadwarrior],1);N([n.satrap],V,2);N(z,w,1.5);N(C,[d.dragon],.75);N(C,[d.bat],1);N(C,[g.pikeman],-.75);N(C,z,1);N(C,[e.chariot],-.3);N(C,W,.5);N(Z,ea,4);N(ea,Z,3);N(ea,G,3);N(H,[d.bat],-.2);N(H,[d.dragon],-.5);N([d.stonegolem],O,1);N([d.dwarf],O,4);N(G,[e.priest],-.5);b=wa;f=Object.keys(b);for(h=0;h<B.length;h++)for(w=B[h],m=0;m<f.length;m++)w[f[m]]=b[f[m]];h=[g.archer,g.longbowman,e.archer,e.horsearcher,n.archer,n.horsearcher];f=[g.footman,g.maceman,g.knight,g.crusader,g.pikeman,n.jihadwarrior,
n.cavalry,n.footman,n.enichar,g.peasant,n.peasant,n.satrap,n.spearman,d.spy,e.chariot,e.monk,e.samurai,e.ronin,e.horsesamurai,e.ninja,e.peasant,d.skeleton,d.ghost,d.ork,d.dwarf];m=[g.footman,g.maceman,g.knight,g.crusader,g.pikeman,n.jihadwarrior,n.cavalry,n.footman,n.enichar,g.peasant,n.peasant,n.satrap,n.spearman,d.spy,e.chariot,e.monk,e.samurai,e.ronin,e.horsesamurai,e.ninja,e.peasant,g.archer,g.longbowman,e.archer,e.horsearcher,n.archer,n.horsearcher,g.wizard,n.mage,e.mage,g.priest,n.priest,e.priest,
d.skeleton,d.ghost,d.ork,d.dwarf];F=[{name:["Longbow","Allows the production of longbowmen"],next:[c.createLongbowman],cost:[400,0,0,0],time:45,type:X},{name:["Gold Mining","Increases gold production"],increase:2,value:"gold",cost:[400,0,0,0],time:20,type:vb},{name:["Stone Mining","Increases stone production"],increase:2,value:"stone",cost:[400,0,0,0],time:20,type:vb},{name:["Wood Cutting","Increases wood production"],increase:2,value:"wood",cost:[400,0,0,0],time:20,type:vb},{name:["Temper Iron",
"Increases hand-to-hand units' attack power"],increase:2,value:"attack",cost:[400,0,0,0],time:30,group:f,next:[c.techHalberd],type:ib},{name:["Scale Armor","Increases unit's defense"],increase:1,value:"defence",cost:[400,0,0,0],time:30,group:m,next:[c.techChainMail],type:ib},{name:["Halberd","Allows the production of spear units"],next:[c.createPikeman,c.createPikeman2],cost:[400,0,0,0],time:30,type:X},{name:["Domestication","Allows the production of cows"],next:[c.createCow],cost:[300,0,0,0],time:20,
type:X},{name:["Crop Rotation","Increases the production of fields"],increase:2,value:"food",cost:[400,0,0,0],time:20,type:vb,next:[c.irrigation]},{name:["Chain Mail","Increases unit's defense"],increase:2,value:"defence",cost:[400,0,0,0],time:30,group:m,type:ib},{name:["Plate Armor","Allows the production of knights"],next:[c.createKnight],cost:[400,0,0,0],time:60,type:X},{name:["Crossbow","Increases arrow units' attack power"],increase:2,value:"attack",cost:[400,0,0,0],time:30,group:h,type:ib},
{name:["Feudalism","Makes peasants cheaper"],cost:[300,0,0,0],time:30,decrease:[e.peasant,[0,0,8,0],g.peasant,[0,0,10,0],n.peasant,[0,0,10,0]],type:li,next:[c.techSlavery]},{name:["Architecture","Peasants build faster, and allows stone wall, gate and towers"],increase:.5,value:"buildSpeed",cost:[300,0,0,0],time:30,type:vb,next:[c.upgradeStoneTower,c.techGreatWall,c.buildBridge]},{name:["Learning","Allows units to gather experience"],increase:1,value:"experience",cost:[400,0,0,0],time:30,type:vb,next:[c.buildAcademy,
c.buildAcademy1,c.buildAcademy2]},{name:["Convert Resources",""],cost:[400,0,0,0],time:30},{name:["Map Making","Allows the production of galleons"],cost:[800,0,0,0],time:30,type:X,next:[c.createGalleon]},{name:["Trade Routes","Allows trading"],cost:[400,0,0,0],time:30,type:X,next:[c.techTradeTaxes]},{name:["Trade Taxes","Increases trade profit"],cost:[400,0,0,0],time:30},{name:["Usury","Allows the obtaining of loans in taverns"],cost:[300,0,0,0],time:30,type:mg,next:[c.techBanking]},{name:["Supply Storage",
"Increases the population limit"],cost:[500,0,0,0],time:30,increase:50,type:vb,value:"popLimit",next:[c.techSeaFood]},{name:["Bribery","Allows the bribing of enemy units"],cost:[600,0,0,0],time:60,type:X,next:[c.bribe]},{name:["Heroism","Allows unlimited experience"],cost:[500,0,0,0],time:30,increase:Infinity,value:"maxLevel",type:vb,next:[c.techLeadership]},{name:["Warfare","Gain experience faster"],cost:[400,0,0,0],time:30,type:vb,increase:1,value:"experience",next:[c.techTactics]},{name:["Tactics",
"Gain experience faster"],cost:[800,0,0,0],time:30,type:X,next:[c.buildDummy,c.techSunTzu]},{name:["Mercenaries","Allows the recruitment of units in taverns"],cost:[600,0,0,0],time:30,type:mg,next:[c.techHeroes,c.createMercenaries],actvintv:[c.iniMercenaries]},{name:["Heroes' Quest","Allows the recruitment of heroes in taverns"],cost:[800,0,0,0],time:30,type:mg,next:[c.techFame,c.createHeroes],actvintv:[c.iniHeroes]},{name:["Fame","Recruit better units from taverns"],cost:[500,0,0,0],time:30,value:"fameTech",
increase:1,type:vb},{name:["Siege Tactics","Allows the production of heavy catapults"],cost:[1200,0,0,0],time:60,type:X,next:[c.createHeavyCatapult]},{name:["Body Building","Increases unit's hit points at every new level"],cost:[800,0,0,0],time:60,value:"healthJump",increase:5,type:vb},{name:["Espionage","Allows the production of a spy"],cost:[400,0,0,0],time:30,type:X,next:[c.createSpy]},{name:["Fanaticism","Increases the building's resistance"],cost:[400,0,0,0],time:30,type:ib,group:[],increase:5,
value:"resistance",next:[c.techCrusade,c.techJihad]},{name:["Crusade","Allows the preaching of a crusade"],cost:[1200,0,0,0],time:180,type:X,next:[c.createCrusaders]},{name:["Inquisition","Increases priest attack"],cost:[400,0,0,0],time:30,type:ib,group:[g.priest,n.priest,e.priest],increase:5,value:"attack"},{name:["Healing","Allows healing of units"],cost:[400,0,0,0],time:30,next:[c.techMedicine,c.healing],type:X},{name:["Medicine","Allows remote healing of units"],cost:[500,0,0,0],time:30,value:"healingRange",
increase:5,type:vb},{name:["Bless","Temporarily increases unit attack skill"],cost:[400,0,0,0],time:30,type:X,next:[c.bless]},{name:["Invisibility","Invisibility spell"],cost:[500,0,0,0],time:30,type:X,next:[c.invisibility]},{name:["Bat","Researches bat summoning"],cost:[400,0,0,0],time:240,type:X,next:[c.createBat]},{name:["Freeze","Freeze spell"],cost:[800,0,0,0],time:30,type:X,next:[c.freeze]},{name:["Lightning","Lightning spell"],cost:[400,0,0,0],time:30,type:X,next:[c.lightning]},{name:["Stone Golem",
"Researches stone golem summoning"],cost:[800,0,0,0],time:120,type:X,next:[c.createGolem]},{name:"Upgrade to Guard Tower",cost:[0,600,0,0],time:20,type:lg,obj:44,upgrade:1},{name:"Upgrade to Stone Tower",cost:[0,0,0,500],time:30,type:lg,obj:55,upgrade:1},{name:"Upgrade to Cannon Tower",cost:[0,0,0,500],time:30,type:lg,obj:56,upgrade:1},{name:["Buddhism"],cost:[400,0,0,0],time:30,type:X,next:[c.buildCathedral1]},{name:["Cannon Tower","Allows the building of cannon towers"],next:[c.upgradeCannonTower],
cost:[400,0,0,0],time:30,type:X},{name:["Engineering","Increases siege weapon's attack"],increase:5,value:"attack",cost:[400,0,0,0],time:30,group:[d.ballista,d.catapult,d.heavycatapult],type:ib},{name:["Great Wall","Makes stone walls, towers and gates stronger"],cost:[600,0,0,0],time:30,type:X},{name:["Art of Riding","Allows the production of horse archers"],cost:[500,0,0,0],time:30,type:X,next:[c.createHorseArcher1,c.createHorseArcher2,c.techHorseManShip]},{name:["Irrigation","Increases field production"],
increase:4,value:"food",cost:[400,0,0,0],time:30,type:vb},{name:["Armored Chariot","Allows the production of armored chariots"],cost:[500,0,0,0],time:60,type:X,next:[c.createChariot]},{name:["Meditation","Makes monks cheaper"],cost:[300,0,0,0],time:30,decrease:[0,0,50,0],type:ki,next:[c.techPhilosophy],group:[e.monk]},{name:["Kung-Fu","Increases the attack of all kung-fu units"],cost:[400,0,0,0],time:30,type:ib,increase:1,value:"attack",group:[e.peasant,e.ninja,e.monk,e.priest],next:[c.techMastery,
c.techNinjas,c.techTournaments]},{name:["Tournaments","Allows sharing of experience between kung-fu units"],cost:[800,0,0,0],time:30,type:X,next:[]},{name:["Philosophy","Allows the production of more experienced monks"],cost:[400,0,0,0],time:30,type:ib,increase:2,value:"level",group:[e.monk,e.priest],next:[c.createPriest1]},{name:["Ninjas","Allows the production of ninjas"],cost:[500,0,0,0],time:30,type:X,next:[c.createNinja]},{name:["Mastery","Allows priests to teach kung-fu units"],cost:[500,0,
0,0],time:30,type:X,next:[c.teach]},{name:["Concentration","Allows faster manna restoration"],cost:[600,0,0,0],time:80,type:X,next:[c.techConfusion]},{name:["Confusion","Researches the Confusion spell"],cost:[400,0,0,0],time:30,type:X,next:[c.confusion]},{name:["Whirlpool","Researches the Whirlpool spell"],cost:[300,0,0,0],time:30,type:X,next:[c.whirlpool]},{name:["Dragon","Researches Dragon summoning"],cost:[800,0,0,0],time:300,type:X,next:[c.createDragon]},{name:["Turn to Stone","Researches the Turn to Stone spell"],
cost:[300,0,0,0],time:30,type:X,next:[c.turnToStone]},{name:["Flame Bolt","Researches the Flame Bolt spell"],cost:[400,0,0,0],time:30,type:X,next:[c.techDragon,c.flameBolt]},{name:["Jewelry","Allows trading of items"],cost:[400,0,0,0],time:30,type:X,next:[c.sellItems,c.buyItems]},{name:["Banking","Increases trade profit"],cost:[600,0,0,0],time:30,type:X},{name:["Chemistry","Increases arrow units' attack power"],cost:[500,0,0,0],time:30,type:ib,group:h,increase:1,value:"attack",next:[c.techGunPowder]},
{name:["Sea Food","Increases the population limit"],cost:[500,0,0,0],time:30,increase:50,type:vb,value:"popLimit"},{name:["Gun Powder","Increases cannon tower's attack power"],cost:[500,0,0,0],time:30,type:ib,increase:10,value:"attack",group:[d.cannontower],next:[c.techRocketArrow]},{name:["Rocket Arrow","Allows the building of rocket tower"],cost:[800,0,0,0],time:30,type:X,next:[c.buildRocketTower]},{name:["Bushido","Allows the production of horse samurai"],cost:[800,0,0,0],time:120,type:X,next:[c.createHorseSamurai]},
{name:["Leadership","Units around a hero gain experience"],cost:[600,0,0,0],time:30,type:X,next:[c.techHonor]},{name:["Honor","Hero vs. hero attack bonus"],cost:[500,0,0,0],time:30,type:X},{name:["Sun Tzu's Book","Increases the speed of learning"],cost:[800,0,0,0],time:30,type:vb,increase:1,value:"experience"},{name:["Cow Poaching","Allows peasants to steal cows"],cost:[200,0,0,0],time:30,type:vb,increase:1,value:"stealCows"},{name:["Horsemanship","Makes mounted units cheaper"],cost:[500,0,0,0],time:30,
type:ki,mulp:.75,group:[e.horsearcher,n.cavalry,n.horsearcher]},{name:["Scimitar","Increases sword attack power and allows the production of satraps"],cost:[400,0,0,0],time:30,type:ib,increase:1,value:"attack",group:f,next:[c.createSatrap]},{name:["Jihad","Allows the production of Jihad Warriors"],cost:[1200,0,0,0],time:30,type:X,next:[c.createJihad,c.convertJihad]},{name:["Magic Carpet","Researches Magic Carpet summoning"],cost:[300,0,0,0],time:30,type:X,next:[c.createCarpet,c.techJinn]},{name:["Magic Workshop",
"Allows the building of a magic workshop"],cost:[1200,0,0,0],time:180,type:X,next:[c.buildMagicWorkshop]},{name:["Rain of Fire",""],cost:[800,0,0,0],time:60,type:X,next:[c.fireRain]},{name:["Magic Vision","Researches the Magic Vision spell"],cost:[400,0,0,0],time:30,type:X,next:[c.magicVision]},{name:["Necromancy","Researches the Raise the Dead spell"],cost:[400,0,0,0],time:30,type:X,next:[c.raiseDead]},{name:["Jinn","Researches Jinn summoning"],cost:[600,0,0,0],time:300,type:X,next:[c.createJinn]},
{name:["Ore Enrichment","Increases mine production"],cost:[800,0,0,0],time:30,type:vb,increase:1,value:"miningPerf"},{name:["Riding Horses","Increases the mounted units' attack and defense power"],cost:[500,0,0,0],time:30,type:Hk,values:["attack",2,"defence",1],group:[e.horsearcher,n.cavalry,n.horsearcher],next:[c.techJanissary]},{name:["Janissary","Allows the production of Janissaries"],cost:[1200,0,0,0],time:120,type:X,next:[c.createEnichar]},{name:["Slavery","Makes peasants cheaper"],cost:[200,
0,0,0],time:30,decrease:[e.peasant,[0,0,7,0],g.peasant,[0,0,8,0],n.peasant,[0,0,8,0]],type:li}];ek();c.buildMarket.disabled=1;Hl();m=0;for(w=B.length;m<w;m++)if(b=B[m],b.onbuild)for(e=b.onbuild,h=0,g=e.length;h<g;h++)n=e[h],n.obj.race==b.race&&(n.disabled=1,n.requireObj||(n.requireObj=[]),n.requireObj.put(b));h=0;for(g=F.length;h<g;h++)if(d=F[h],d.tech=1,d.id=h,d.next)for(e=d.next,n=0,m=e.length;n<m;n++)b=e[n],b.disabled?(b.disabled++,b.requireObj.put(d)):(b.requireObj=[d],b.disabled=1);h=0;e=B;for(g=
e.length;h<g;Qm(e[h++]));}if(Zi){d=8;b=9;h=0;for(g=da.xtraRes.length;h<g;h++){k=da.xtraRes[h].coords;Dn(k);k.terrain_water[d]=512;k.terrain_water[b]=512;k.terrain_water[6]+=32;k.terrain_water[7]+=32;f=4;for(e=k.terrain_tree.length;f<e;f+=6)k.terrain_tree[f]-=32,k.terrain_tree[f+1]-=96;f=5;for(e=k.terrain_tree_s.length;f<e;f+=6)k.terrain_tree_s[f]-=32;k.terrain_tree[2]=1}El(k,da.info,da.size,16*da.ids);h=B[7];h.img=k.terrain_tree;h.dimgInfinity=k.terrain_tree;h.url=k.terrain_tree;h.child[0].img=k.terrain_tree_s;
Object.assign(l,k)}ab={img:l.gath_point,x32:-10,y32:-10,d:0,mv:!0};yb={img:l.blank,x32:-100,y32:-100,d:0};$i=[yb,ab,ja];new Vb("",[255,255,255],[0],!0);if(p.custom)for(f=0==p.cycle?p.kingdomStart||p.kingdoms:p.kingdoms,h=0,g=f.length;h<g;h++)p.online&&ba[h]&&!ba[h].name&&(f[h].IA=!1),e=new Vb("",f[h].color,[0],!0),Object.assign(e,f[h]),e.values.pop=0,null==e.resources[0]&&(e.resources[0]=Infinity),null==e.resources[1]&&(e.resources[1]=Infinity),null==e.resources[2]&&(e.resources[2]=Infinity),null==
e.resources[3]&&(e.resources[3]=Infinity);else for(h=0,g=na.length;h<g;h++){k=na[h];e=[0];for(n=0;n<g;n++)e[n+1]=na[n].team==k.team?0:1;p.online&&k.id===x.onlineID&&(x.kingdom=h+1);new Vb(k.name,dk(k.color),e,k.race,k.IA,[p.goldRes,p.woodRes,p.foodRes,p.stoneRes],k.team)}if(p.editor){if(ma("statButton"),ma("menu"),ma("resources"),Ca("mapeditorinfotop"),Ca("mapeditorinfo"),d=q("mapeditorinfoUnits"),d.style.display="block",jh(),!$d.preload){$d.preload=!0;k={};m={};e=B;n={euro:Ia[0],arab:Ia[1],asia:Ia[2],
common:t.common};k[Ia[0]]=[];k[Ia[1]]=[];k[Ia[2]]=[];k[t.common]=[];m[Ia[0]]=[];m[Ia[1]]=[];m[Ia[2]]=[];m[t.common]=[];h=0;for(g=e.length;h<g;h++)b=e[h],!b.race||b.illegal||7==b.type||b.item||(b.build?m[n[b.race]].put(h):k[n[b.race]].put(h));for(n=0;2>n;n++){e=Object.keys(k);w={};h=0;for(g=e.length;h<g;w={ul$17:w.ul$17},h++){y=document.createElement("h1");y.innerHTML=e[h];w.ul$17=document.createElement("ul");y.onclick=function(b){return function(){wh(b.ul$17)}}(w);w.ul$17.style.display="none";r=k[e[h]];
z=Object.keys(r);C={};f=0;for(G=z.length;f<G;C={tcreate:C.tcreate},f++)b=document.createElement("li"),b.innerHTML=B[r[z[f]]].name,C.tcreate=r[z[f]],b.onclick=function(b){return function(){var d=b.tcreate;B[d].wall?Ym(d):Q(d)}}(C),w.ul$17.appendChild(b);d.appendChild(y);d.appendChild(w.ul$17)}k=m;d=q("mapeditorinfoBuilds")}e=Object.keys(Ub);d=q("mapeditorinfoItems");var ca=document.createElement("ul");k={};h=0;for(g=e.length;h<g;k={u$18:k.u$18},h++)b=document.createElement("li"),k.u$18=Ub[e[h]],b.onclick=
function(b){return function(){ak(b.u$18)}}(k),b.innerHTML=k.u$18.name,ca.appendChild(b);d.appendChild(ca);d=q("mapeditorinfoNature");y=document.createElement("h1");y.innerHTML=t.trees;ca=document.createElement("ul");y.onclick=function(){wh(ca)};ca.style.display="none";b=document.createElement("li");ca.appendChild(b);d.appendChild(y);d.appendChild(ca);b.onclick=function(){aj(Fn)};b.innerHTML=t.delete;b=document.createElement("li");ca.appendChild(b);b.onclick=function(){aj(Gn)};b.innerHTML=t.create;
y=document.createElement("h1");y.innerHTML=t.terrain;var ia=document.createElement("ul");y.onclick=function(){wh(ia)};ia.style.display="none";d.appendChild(y);d.appendChild(ia);g=pc.texturesRandomMap;k={};h=0;for(g=g.length;h<g;k={l:k.l},h++)b=document.createElement("li"),ia.appendChild(b),b.innerHTML=h,k.l=h,b.onclick=function(b){return function(){aj(bj);bj.active=b.l}}(k)}}else Ca("menu"),Ca("statButton"),Ca("resources"),ma("mapeditorinfo"),ma("mapeditorinfotop");k=v.HEAPU8;g=E.length;d=Qb.createDiplomacy(g);
for(h=0;h<g;h++)for(e=E[h],e=e.diplomacy,n=0;n<g;n++)k[d+h*g+n]=e[n]&&1||0;Il()},B,ye,Yi,ab,$i,Gl,hc,lf,kd=function(d,b,c,e,h,g,k){var f=B[d];if(f.ignore)return f.invalid=!0,!1;if(g=g&&!f.instantBuild)this.built=!1;var l=E[b],m=l.mod[d],q=Object.keys(m);this.__proto__=f;this.kingdom=b;this.d=h;this.x32=c;this.y32=e;this.taskList=[];h=0;for(var r=q.length;h<r;this[q[h]]=m[q[h++]]);if(k)for(m=Object.keys(k),h=0,r=m.length;h<r;this[m[h]]=k[m[h++]]);0<f.invMax&&(this.inventory=[]);20==f.type&&(this.lastUse=
p.cycle);f.build||(this.mv=1);k=l.technology.disabled;m=f.actvintv;this.workers=[];this.id=r=w.length;f.rndDirection&&(this.d=r*c%f.rndDirection);this.build||this.item||this.cow||l.values.pop++;c=f.validator(c,e,f.space,b);if(c[1]||g){e=f.validator.dimension.write;q=c[0];if(g){var t=Bb[b];h=0;for(f=q.length;h<f;h++)t[q[h]]=r;l.building.put(r)}else for(h=0,f=q.length;h<f;e(q[h++],r));if(c[2]&&(q=c[2],!g))for(h=0,f=q.length;h<f;e(q[h++],0));}else return this.invalid=!0,!1;w[r]=this;Qb.newUnit(b);g||
va[b][d].put(r);if(this.update&&!p.custom)for(d=this.update,h=0,r=d.length;h<r;h+=3)Ya({func:eg,data:[this.id,d[h],d[h+1],d[h+2]]},d[h+2],1);if(m)for(d=0,f=m.length;d<f;d++)b=m[d],k[b.id]||b(this);g?(Za(this),x.kingdom==this.kingdom?Kb(1,1,1,.5,this.bufferID):Kb(1,1,1,0,this.bufferID)):(Za(this),Yh(this));this.level&&!this.potion&&Bk(this);!this.standardFunc||this.func||p.editor||g||this.standardFunc(this);g=l.stats;g.unitCount[this.type]++;l=g.unitCount[this.type]-g.unitCountDeath[this.type];l>g.unitCountMax[this.type]&&
(g.unitCountMax[this.type]=l)},Mk=function(d){var b=E[d.kingdom];if(d.population){var c=d.population;b.values.popMax+=c;Fe(d.kingdom);for(var e=0;e<c;e++)b.checkPopArray()}if(d.onbuild)for(d=d.onbuild,c=b.technology,b=c.disabled,c=c.actived,e=0;e<d.length;e++){var h=d[e].id;c[h]||(c[h]=0);c[h]++;c[h]-1||(b[h]--,!b[h]&&oa.actv[h]&&oa(W.active))}},Ed=[],Ba=new Float32Array(4),Zc=new Float32Array(3),Kb=function(d,b,c,e,h){Ba[0]=d;Ba[1]=b;Ba[2]=c;Ba[3]=e;m.bindBuffer(m.ARRAY_BUFFER,hf);m.bufferSubData(m.ARRAY_BUFFER,
4*h,Ba)},Bc=function(d,b,c,e){Zc[0]=d;Zc[1]=b;Zc[2]=c;m.bindBuffer(m.ARRAY_BUFFER,bh);m.bufferSubData(m.ARRAY_BUFFER,3*e,Zc)},cj=function(d,b,c,e,h){Ba[0]=d;Ba[1]=b;Ba[2]=c;Ba[3]=e;m.bindBuffer(m.ARRAY_BUFFER,ch);m.bufferSubData(m.ARRAY_BUFFER,4*h,Ba)},Jl=function(d,b,c,e,h){Ba[0]=d;Ba[1]=b;Ba[2]=c;Ba[3]=e;m.bindBuffer(m.ARRAY_BUFFER,ah);m.bufferSubData(m.ARRAY_BUFFER,4*h,Ba)},nf=function(d,b,c,e){Zc[0]=d;Zc[1]=b;Zc[2]=c;m.bindBuffer(m.ARRAY_BUFFER,dh);m.bufferSubData(m.ARRAY_BUFFER,3*e,Zc)},Za=function(d,
b,c,e,h){void 0==b&&(e=c=b=0);var f=d.bufferID||Kl();d.bufferID=f;ta(d,d.img,d.mv);var k=32*d.x32,l=32*d.y32,m=32*d.y32;d&&d.z32&&(m*=d.z32);m=h||m;h=d.rotation||0;d.wh?nf(d.wh[0],d.wh[1],h,f):nf(0,0,h,f);Bc(k,l,m,f);cj(b,c,e,p.now(),f);if(d.child&&!1!==d.built)for(b=m+.1,c=d.child.length,e=[],d.childLoc=e,h=0;h<c;h++){var q=d.child[h];f=Kl();e[h]=f;m=Ja[q.img];var t=m[0],r=m[1];0<=r&&(r*=.001);Jl(m.id+4*d.d,q.mv&&1||-1,t,r,f);m=q.z?32*q.z+b:b;q.alpha&&(m=0);Bc(k,l,m,f);cj(0,0,0,0,f);nf(0,0,0,f)}wb(d)},
wb=function(d){Ll(d);if(d.child&&(!1!==d.built||!d.build))for(var b=d.child,c=0,e=b.length;c<e;c++)Ll(b[c],d.kingdom,d.childLoc[c])},Ll=function(d,b,c){void 0==b&&(b=d.kingdom);if(d.rgb){var e=d.rgb;var f=e[0];var g=e[1];b=e[2];e=e[3]}else Ja[d.img][3]?(f=cb[3*b],g=cb[3*b+1],b=cb[3*b+2],e=2):(d.mMapcolor?(b=d.mMapcolor,f=b[0]/255,g=b[1]/255,b=b[2]/255):(f=cb[3*b],g=cb[3*b+1],b=cb[3*b+2]),e=1);Kb(f,g,b,e,c||d.bufferID)},Kl=function(){if(Ed.length){var d=Ed[Ed.length-1];Ed.length--}else d=hc,hc+=4;
hc==lf&&(lf+=4*xd.jump,T("resize"),mf(hf),mf(ah),mf(bh),mf(ch),mf(dh));return d},Rc=function(d,b,c,e){cj(b,c,e,p.now(),d.bufferID);if(d.tempChild){var f=0;d=d.tempChild;for(var g=d.length;f<g;Rc(d[f++],b,c,e));}},Cb=function(d,b,c){void 0==c&&(c=32);d.z32&&(b*=d.z32);Bc(d.x32*c,d.y32*c,b,d.bufferID);if(d.tempChild){b=d.tempChild;c=0;for(var e=b.length;c<e;c++){var f=b[c];f.x32=d.x32;f.y32=d.y32;Cb(f,32*d.y32)}}},wa={checkMana:function(d,b,c,e){if(!this.mana)return!1;if(0>this.mana-d)return this.manaTask=
[c.url,b,d],this.stay55(),d>this.manaMax&&e&&(this.blockedCost=e,b=this.setupChild(jb.curse,1),this.blocked=2,this.blockedimg=b,this.manaTarget=d,Kb(1,0,0,.75,this.bufferID),Kb(1,0,0,.75,b.bufferID)),!1;this.mana-=d;return!0}},fc=function(d,b){return p.editor?!0:d.freezed||d.confused?!1:E[d.spy||d.kingdom].control[b.spy||b.kingdom]};wa.changeKingdom=function(d){va[this.kingdom][this.type].quit(this.id);cc[this.id]&&(cc[this.id]=0,C.quit(this.id),0==C.length&&(oa([]),df(),Dc=-1),Ni(this.id));this.kingdom=
d;wb(this);this.childBuild&&(this.childBuild=0);if(!this.build||this.arrow)p.editor||this.stay();va[d][this.type].put(this.id)};wa.aspettare=function(){this.nodes=void 0;this.rbase().write(this.x32+this.y32*G,this.id);this.waiting=!0;ta(this,this.url.idle);Rc(this,0,0,0);Zb(this,~~(32E3/this.spd))};wa.addItem=function(d){var b=this.inventory;b&&(b[b.length]=d.id,d.in=this.id,d.sword||d.shield)&&(d.attack&&(this.attack+=d.attack),d.defence&&(this.defence+=d.defence))};wa.showInventory=function(){Oi();
for(var d=this.inventory,b=0;8>b;b++){var c=d[b];if(!c)break;var e=aa[b];e.style.backgroundPosition="0px "+48*c.iconID+"px";e.className="";Wg[b]=null}};wa.deleteItem=function(d){this.inventory.quit(d.id);this.attack-=d.attack;this.defence-=d.defence};wa.useItem=function(d){48==d.type&&(this.health+=d.lives,this.health>this.maxHealth&&(this.maxHealth=this.health),this.inventory.quit(d.id))};wa.onattack=function(d){!this.attack||this.freezed||this.death||this.item||this.func!=Cd.url&&this.func||vc(d.id,
[this.id],1)};wa.setupINTV=function(d,b,c,e){this.funcObj=b;d.url||T(d,d.url);Va(this);this.changeFunc(d.url,e);this.deleteWorker();Zb(this,c);return c};wa.damage=function(d,b){if(!(this.zolotoy||this.death||this.stoned)){this.defence&&(d-=this.defence);1>d&&(d=1);this.health-=d;b=E[b.kingdom].stats;b.dmgInflicted+=d;var c=E[this.kingdom].stats;c.dmgTaken+=d;1>this.health?(this.build?(c.buildsLosed++,b.buildsKilled++):(c.unitsLosed++,b.unitsKilled++),this.die()):O(this.id,1)}};var O=function(d,b){if(cc[d]||
!1===d)return d=C.length,1===d?(d=w[C[0]],W.stockActive==d&&d.inventory.length?(Yc(d.id,1,1),ml(d,1)):d.build?Fa(d,1):Yc(d.id,b)):1<d?$g(C,b):wl(Wa),!0};wa.setupSpellIMG=function(d){this.invisible&&Od(this.id);this.url.spell?(ta(this,this.url.spell,1),d||Ya({func:Ml,data:this.id},nb(this.img),1)):this.stay()};var Ml=function(d){d=w[d];d.death||d.stay()};wa.setupChild=function(d,b,c){c={x32:this.x32,y32:this.y32,d:d.d,img:d.img,mv:d.mv,parent:this.id,z32:d.z32};if((this.dix||this.diy)&&!this.waiting){var e=
.001*(p.now()-this.timestamp);c.x32+=this.dix*e/32-Math.sign(this.dix);c.y32+=this.diy*e/32-Math.sign(this.diy)}if(d.select){if(this.space)d=this.space[this.space.length-1],f=(this.space.length-1)/d;else{d=this.sSizex||1;var f=this.sSizey||1}this.z32&&(c.z32=this.z32);c.wh=[32*d-3,32*f-3];this.selectAnim=c}Za(c);e&&Rc(c,this.dix,this.diy,0);this.tempChild||(this.tempChild=[]);this.tempChild.put(c);b||bc.new(c,nb(c.img),Nl);return c};var Nl=function(d){w[d.parent].tempChild.quit(d);Lb(d.bufferID)};
wa.distance=0;var ta=function(d,b,c,e){d.img=b;Ja[b]||T(b);(b=Ja[b])||T(d);var f=b[0],g=b[1];0<=g&&(g*=.001);e&&(g*=e);b=b.id+4*d.d*b[2];e=-1;1===c?e=p.now():0>c&&(e=1);Jl(b,e,f,g,d.bufferID)};wa.setupDir=function(d,b,c){d=Math.sign(d);b=Math.sign(b);d=3*(b-1)+(d+1);2==d?this.d=1:-6==d?this.d=5:0==d?this.d=7:-4==d?this.d=3:-1==d?this.d=2:1==d?this.d=0:-5==d?this.d=4:-3==d&&(this.d=6);c&&(this.d=(this.d+c)%8)};wa.setupDirBuild=function(d){var b=G,c=this.x32+this.y32*b;if(1==d.health&&0==d.built)e=
Bb[d.kingdom],d=d.id,e[c+b]==d?this.d=0:e[c-b]==d?this.d=4:e[c+1]==d?this.d=2:e[c-1]==d?this.d=6:e[c+b+1]==d?this.d=1:e[c-b+1]==d?this.d=3:e[c+b-1]==d?this.d=7:e[c-b-1]==d&&(this.d=5);else{d=d.id;var e=vd;e(c+b)==d?this.d=0:e(c-b)==d?this.d=4:e(c+1)==d?this.d=2:e(c-1)==d?this.d=6:e(c+b+1)==d?this.d=1:e(c-b+1)==d?this.d=3:e(c+b-1)==d?this.d=7:e(c-b-1)==d&&(this.d=5)}};wa.spdMod=0;var ug=function(d,b){for(var c=b.length,e=0;e<c;e++){var h=w[b[e]];h.build||(h.spd=d)}};wa.changeFunc=function(d,b){var c=
this.func;this.func=d;if(Df){if(void 0!==this.workingOn)var e=w[this.workingOn];(c=ac[c])&&c.rule&&ai(-1,this,c.rule,e);(d=ac[d])&&d.rule&&ai(1,this,d.rule,b)}};wa.stay=function(d){this.mv=1;this.time=void 0;this.diy=this.dix=0;this.nodes=this.c=void 0;this.xf=null;Rc(this,0,0,0);Qb.unitMovement(this.id,!1);if(!d){d=this.action==Nd.url||this.func==rg.url;this.changeFunc(void 0);this.stock&&0!==this.stock[0]?ta(this,this.img,NaN):ta(this,this.__proto__.img,1);this.buildList&&(this.buildList=void 0);
this.deleteWorker();if(this.standardFunc&&2!==this.stop&&void 0==this.spy)return this.standardFunc(this);d&&Cd(this)}};wa.stay55=function(){this.changeFunc(void 0);this.stock&&0!==this.stock[0]?ta(this,this.img,NaN):ta(this,this.__proto__.img,1);this.deleteWorker();this.standardFunc&&2!==this.stop&&void 0==this.spy&&this.standardFunc(this)};wa.addWorker=function(d){this.workers.put(d.id);d.workingOn=this.id};wa.deleteWorker=function(){this.workingOn&&(w[this.workingOn].workers.quit(this.id),this.workingOn=
0);this.actionItem&&(this.actionItem=void 0);this.blockedAction()};wa.blockedAction=function(d){var b=this.blocked;if(Ol[b])Ol[b](this,d)};var Ol={2:function(d,b){d.blocked=void 0;wb(d);Nl(d.blockedimg);d.blockedimg=void 0;d.manaTarget=void 0;b||(E[d.kingdom].setupResources(d.blockedCost,-1),d.blockedCost=void 0)}},el=function(d){return l.delay[-d[1]+d[0]-1]},Je=function(d){var b=C.length;C.quit(d);if(b!=C.length){var c=w[d];c.selectAnim=void 0;b=0;for(c=c.tempChild;b<c.length;b++){var e=c[b];Lb(e.bufferID);
var h=c.length;c.quit(e);h!=c.length&&b--}cc[d]=void 0;0==C.length?df():1==C.length?w[d].build?Fa(w[d],1):Yc(d):$g(C)}Wa&&Wa.id===d&&(df(),Wa.selectAnim&&(Lb(Wa.selectAnim.bufferID),Wa.selectAnim=void 0),Wa=void 0)};wa.rbase=function(){return qd[this.zLevel]};var Ng;wa.die=function(d){if(!this.death&&!this.magicGateway){var b=G,c=this.id,e=this.kingdom,h=E[e];this.waitlist&&(h.unitLoading-=.5*this.waitlist.length);if(this.dieSound&&!p.editor){var g=this.dieSound;pa(g[~~(g.length*Math.random())],this.x32,
this.y32)}Je(this.id);(this.freezed||this.invisible)&&wb(this);var k=this.x32,n=this.y32;this.death=1;1==this.zLevel&&(Ng[k+n*b]=1);this.c=void 0;var m=this.url.die||this.dimg;!1===this.built&&h.building.quit(this.id);void 0!=h.IAD&&h.k&&!this.item&&Oa.arr[h.IAD].valorateLost(this);if(this.food&&!p.editor){var q=100,t=this.food/q,r=~~t,v=~~((t-r)*q);for(g=0;g<t;g++){g==r&&v&&(q=v);var x=Lk(k,n),z=~~(x/b);x%=b;x=new kd(52,e,x,z,0);ta(x,l.item_meat);x.contain=[q,2,Zm]}}h.stats.unitCountDeath[this.type]++;
g=this.x32;b=this.y32;d||p.editor?Lb(this.bufferID):m?(this.mv=!0,ta(this,m,1),d=Ja[this.img],m=d[1],m=0>m?el(d):1E3*d[0]/m,Ya({func:dl,data:this.id},m-25,1),Rc(this,0,0,0),void 0!==this.dix&&(d=.001*(p.now()-this.timestamp),this.x32+=this.dix*d/32-Math.sign(this.dix),this.y32+=this.diy*d/32-Math.sign(this.diy))):this.dimgInfinity?(this.dimgRND&&(this.d=this.id%this.dimgRND),ta(this,this.dimgInfinity)):Lb(this.bufferID);ji(this);this.techStart&&kg(0,[this.id]);Cb(this,32*this.y32-36);this.x32=g;this.y32=
b;this.build||this.item||this.cow||h.values.pop--;this.population&&this.built&&(h.values.popMax-=this.population);n=this.validator(k,n,this.space,this.kingdom);d=n[0];if(this.onbuild&&!p.editor)for(k=this.onbuild,m=h.technology,g=m.disabled,m=m.actived,b=0;b<k.length;b++)e=k[b].id,m[e]--,0===m[e]&&g[e]++;k=this.validator.dimension;b=k.write;g=0;for(m=d.length;g<m;g++)e=d[g],Xa[e]?b(e,Xa[e]):b(e,0);if(1==this.health&&!this.built)for(e=Bb[this.kingdom],g=0,m=d.length;g<m;e[d[g++]]=void 0);if(n[2])for(d=
n[2],g=0,m=d.length;g<m;g++)e=d[g],Xa[e]?(2<k(e)&&w[k(e)].die(1),b(e,Xa[e])):(2<k(e)&&w[k(e)].die(),b(e,0));va[this.kingdom][this.type].quit(this.id);Va(this);if(this.workers){g=0;k=this.workers.slice(0);for(m=k.length;g<m;g++)n=w[k[g]],n.workingOn===c&&(n.workingOn=0,n.func!==pi.url&&n.stay());this.workers.length=0}this.deleteFromList&&(k=this.deleteFromList,k.quit(this),k.length||k.length0function(this));this.time=void 0;this.changeFunc(void 0);this.diy=this.dix=0;this.inventory&&0<this.inventory.length&&
Md(this.id,this.inventory.slice(0));this.stock&&Jk(this);p.editor||(h.check(),Fe(this.kingdom),h.checkPopArray());this.deleteWorker()}};Array.prototype.quit=function(d){d=this.indexOf(d);return-1<d?(this.splice(d,1),!0):!1};Array.prototype.add=function(d){0>this.indexOf(d)&&(this[this.length]=d)};var Ia=["European","Arab","Asian"],Lh=[t.gold,t.wood,t.food,t.stone,t.mana],Ak={euro:"Lancelot Arthur Guivain Merlin Blackthorn Morin Golstuck Karambol Kelerick Rockmore Bridport Casevil Stirm Tonis Pelegrim Peresohn Pirk Pharn Gork".split(" "),
arab:"Ibn Fadlan;Mohammad;Al Ferissa;Harun Al Rashid;Sindbad;Mellemad;Moarrac;Sakhavan;Bellefars;Mokhac;Norahz;Kerhetin;Maham;Dushesh;Direkh".split(";"),asia:"Ishida Toranaga Ichinzen Haiako Mozuki Hitachi Tosheba Harachiko Marasuma Korodzum Ishinghen Genghis Musa Echibo Ichikahr Yotokan Maraga".split(" "),common:"Fistantilus Skenderbeg Raislin Tenis Morok Sokob Baras Haram Billihz Ynte Orgh Savael Birgos Savator Gandeh Gordor Fessh Gilmi Phergas".split(" ")},Ai=function(d,b,c){c&&(d=d.replace("%d",
c));return d.replace("%s",b)},Vd={},dj,$c,kh,ej,Ef=function(d){p.infinity=void 0;if(""!=q("mapconfiguration").innerHTML){d="mapx mapwidth goldRes goldValue woodRes woodValue foodRes foodValue stoneRes stoneValue infinity infiniteValue water waterValue terrainType terrainSelect items itemsValue peons peonValue gateways gatewaysValue freePop freePopValue".split(" ");for(var b=0,c=d.length;b<c;b+=2){var e=q(d[b+1]).value;"infinity"==d[b]?(e=q(d[b+1]).checked,p[d[b]]=e):parseInt(e)?p[d[b]]=parseInt(e):
p[d[b]]=e;localStorage[d[b]]=e}}else"true"==localStorage.infinity&&(p.infinity=!0),p.goldRes=parseInt(localStorage.goldRes),p.foodRes=parseInt(localStorage.foodRes),p.woodRes=parseInt(localStorage.woodRes),p.stoneRes=parseInt(localStorage.stoneRes),p.mapx=parseInt(localStorage.mapx),p.water=parseInt(localStorage.water),p.terrainType=localStorage.terrainType,p.items=parseInt(localStorage.items),p.peons=parseInt(localStorage.peons),p.gateways=parseInt(localStorage.gateways),p.freePop=parseInt(localStorage.freePop);
p.daylength=2880;p.initialhour=12;p.infinity&&(p.goldRes=Infinity,p.foodRes=Infinity,p.woodRes=Infinity,p.stoneRes=Infinity);p.infinity=void 0;p.goldRes||(p.goldRes=Infinity);p.foodRes||(p.foodRes=Infinity);p.woodRes||(p.woodRes=Infinity);p.stoneRes||(p.stoneRes=Infinity);p.mapy=p.mapx;p.gravity=580.9/9.8*9.8;p.name="";p.arje=555555*Math.random()+1;Pl(p);return p},Il=function(){Xc.innerHTML="";q("notifybottom").style.display="none";q("loadingtext").innerHTML=t.loading;if(p.rules){var d=p.rules,b=
{};Df={events:{defined:b,nodefined:{}}};for(var f={moving:1},e=0,h=0,g=d.length;h<g;h++){var k=d[h];k.activeEvents=0;for(var n=k.events,u=0,w=n.length;u<w;u++){var y=n[u];y.id=e++;var r=y.list,A=y.to,B=y.type,C=y.zone;y.rule=k;for(var F=y.activeEvents=0,H=r.length;F<H;F++){var I=r[F];b[I]||(b[I]={});var J=b[I];if(f[B])J[B]||(J[B]=[]),J[B].put(y);else if("zone"==B){J[B]||(J[B]=[]);for(var K=0;K<C.length;K++)J[B].push(y,C[K][0],C[K][1],C[K][2],C[K][3])}else{J[B]||(J[B]={defined:{}});for(var L=J[B].defined,
M=0,O=A.length;M<O;M++)L[A[F]]||(L[A[F]]=[]),L[A[F]].put(y)}}}}}else Df=void 0;x.kingdom||(x.kingdom=1);p.online&&(Hn(t.initializing),p.editor=0);p.mapx||Ef();p.pausedTime=0;p.canceled=0;for(var P=Object.keys(c),S=E.length,Q=0,U=P.length;Q<U;Q++){var W=c[P[Q]];W.id=Q;if(W.disabled)for(var V=0;V<S;E[V++].technology.disabled[Q]=W.disabled);if(W.hidden)for(V=0;V<S;E[V++].technology.hidden[Q]=1);}kh=performance.now();ej=void 0;lc=q("msgs1");p.online||(location.hash="");ma("playermenu");ma("index");Nb=
E[x.kingdom];wg(x.kingdom);dj||(dj=JSON.parse(JSON.stringify(E.slice(1))));p.cycle?p.deltaTime=25*p.cycle:(p.players=E.length-1,p.date=Date.now(),p.cycle=0,p.kingdoms=E,p.deltaTime=0);p.loadDate=Date.now();p.online||Hi();p.now=vk;p.paused=0;p.pausedTime=0;p.zMax=96*p.mapy;$b();var X=performance.now();p.allow14=!0;G=p.mapx;ha=p.mapy;p.temperature=25;var ba=p.temperature;0==x.temperature&&(ba+="&deg;C");q("temperature").innerHTML=ba;Z=1;Ng={};p.online&&Ca("content");q("loadingtext").innerHTML="Loading terrain";
X=performance.now();if(!1!==p.arje){dn(p.arje);Qb.setupRandom(p.arje);var ca=Qb.randomTerrain(G,p.water);$c=new Int8Array(v.buffer,ca,G*ha)}else $c=p.terrain?new Int8Array(p.terrain):new Int8Array(G*ha);ej=performance.now()-X;T("TXT",ej);X=performance.now();q("loadingtext").innerHTML="Creating map";var ea=G,ja=ha,ia=Qb.createMap(ea),la=ea*ja*4;Ta=new Uint32Array(v.buffer,ia,la/4);Y=new Uint32Array(v.buffer,ia+la,la/4);ud=new Uint32Array(v.buffer,ia+2*la,la/4);kc={};performance.now();q("content").style.display=
"block";X=performance.now();if(!1===p.arje||p.allunits)z=p.allunits;else{var oa=$c,ta=80/65536,ka=p.mapx,ra=p.mapy;performance.now();var aa=0,na=0,wa=0,pa=0,ua=0,qa=ka*ra;na=qa;z=[];ae={};var va=In,Da=Jn,Fa=ae,Oa=Kn,Pa=[12,63,62],xa=[];na=E.length;for(aa=1;aa<na;aa++){for(var Ka=!0,Na=E[aa],Va=Pa[Na.race],Ra=0;Ka&&25>Ra;){Ra++;pa=~~(Ea()*(ka-15)+.5)+4;ua=~~(Ea()*(ra-15)+.5)+4;Ka=!1;wa=xa.length;for(var sa=0;sa<wa;sa+=2)60>Math.sqrt((pa-xa[sa])*(pa-xa[sa])+(ua-xa[sa+1])*(ua-xa[sa+1]))&&(Ka=!0);Ka||
(xa.push(pa+4,ua+3),va(pa+ua*ka,{type:Va,kingdom:aa}))}if(25==Ra){E.length=aa;break}}var Wa=2*(na-1);for(sa=0;sa<Wa;sa+=2){var Ya=2*Math.round(Ea())-1;var Ha=xa[sa]+10*(2*Math.round(Ea())-1)+~~(3*Ea());var Ia=xa[sa+1]+10*Ya+~~(3*Ea());var Aa=xa[sa]+10*(2*Math.round(Ea())-1)+~~(3*Ea());var Ba=xa[sa+1]+10*-Ya+~~(3*Ea());0>Ha?Ha=0:Ha+4>G&&(Ha-=(Ha+4)%qa);0>Ia?Ia=0:Ia+4>ha&&(Ia-=(Ia+4)%qa);0>Aa?Aa=0:Aa+4>G&&(Aa-=(Aa+4)%qa);0>Ba?Ba=0:Ba+4>ha&&(Ba-=(Ba+4)%qa);Infinity!==p.goldRes&&va(Ha+Ia*ka,{type:21});
Infinity!==p.stoneRes&&va(Aa+Ba*ka,{type:22})}if(Infinity!==p.goldRes){aa=0;for(var eb=10*G*ha/65536;aa<eb;aa++)va(~~(Ea()*qa),{type:21})}if(Infinity!==p.stoneRes)for(aa=0,eb=10*G*ha/65536;aa<eb;aa++)va(~~(Ea()*qa),{type:22});na=qa*ta;for(aa=0;aa<na;aa++){var mb=~~(Ea()*ka+.5);var gb=~~(Ea()*ra+.5);var nb=~~(25*Ea())+10;var ob=~~(25*Ea())+10;for(Na=0;55>Na;Na++){pa=~~(Ea()*nb+~~(mb+18*Ea()-9)+.5);ua=~~(Ea()*ob+~~(gb+18*Ea()-9)+.5);var La=pa+ua*ka;Da(La)&&La<=qa&&va(La,{type:7,d:~~(28*Ea()+3)})}}na=
parseInt(p.items);for(aa=0;aa<na;aa++){La=~~(Ea()*qa+.5);var sb=Xi[~~(Ea()*Xi.length)],Ga=Object.assign({},sb);Ga.d+=~~(sb.dMax*Ea());if(sb.sword||sb.potion)Ga.attack=~~(6*Ea())+1;if(sb.shield||sb.potion)Ga.defence=~~(6*Ea())+1;if(sb.book){var jb=~~(Ea()*lh.length);Ga.spell=lh[jb];Ga.iconID=c[lh[jb]].iconIDbook;Ga.name=t[Ga.spell];Ga.attack=~~(6*Ea())+1}va(La,Ga)}na=parseInt(p.gateways);for(aa=0;aa<na;aa++)La=~~(Ea()*qa),Da(La)&&va(La,{type:43});for(sa=0;sa<Wa;sa+=2)for(Ha=xa[sa]-25,Ia=xa[sa+1]-25,
Aa=0;50>Aa;Aa++)for(Ba=0;50>Ba;Ba++)if(625>(Aa-25)*(Aa-25)+(Ba-25)*(Ba-25)){var Ua=Aa+Ha+(Ba+Ia)*ka;7===Oa(Ua).type&&(z.quit(Fa[Ua]),Fa[Ua]=void 0);1===pc.type[oa[Ua]]&&(oa[Ua]=0)}performance.now()}p.movtable&&!p.demo&&(fd=p.movtable,ed=p.movtable2);performance.now();q("loadingtext").innerHTML="Loading textures";m.getError()==m.CONTEXT_LOST_WEBGL&&(m=q("tzar").getContext("webgl2",{antialias:!1,alpha:!1}),T("restored"));if(!of){var $a=m.createShader(m.VERTEX_SHADER);m.shaderSource($a,"#version 300 es\nprecision mediump float;\n\nin vec3 a_position;\nin vec4 a_texCoord;\nin vec4 a_kingdom;\nin vec4 a_physic;\nin vec3 a_margins;\nin uint a_step;\n\nuniform float zoom;\nuniform mediump int miniMap;\nuniform float now;\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform sampler2D u_image1;\nuniform sampler2D delay;\nuniform float zMax;\nout highp vec2 vTextureCoord;\nout vec4 v_kcolor;\nout float height;\n\nvec4 superArray(in highp uint position) {\n     return(texelFetch(u_image1, ivec2(\t\t(position%512u)\t\t,\tposition/512u\t), 0));\n}\n\nvoid main() {\n\n\n\n    highp float  x;\n    float t;\n\thighp uint pos;\n\n\nif(a_texCoord.y>-.5&&miniMap==0){\nt=(now-a_texCoord.y);\nif(a_texCoord.w>=0.0){\npos=uint(floor(t * a_texCoord.w));         \n}else{\n\n\nint index=int(-a_texCoord.w);\nint len=int(a_texCoord.z);\nint i;\n\nfloat spt= mod(t,texelFetch(delay, ivec2(len-1+index, 0), 0).r);\n\n for(i=0;i<len;i++){\n\n\nif(texelFetch(delay, ivec2(i+index, 0), 0).r>spt) {\n\nbreak;\n }\n\n\n }\n\n pos=uint(i);\n\n\t\t\t\t  \n //pos=uint(4);\n}\n\n\npos=uint(a_texCoord.x)+uint(4)*(pos%uint(a_texCoord.z))+a_step;\n\n\n}else{\n\npos=uint(a_texCoord.x)+a_step;\n\n}\n\n\n\n    vec4 coord = superArray(pos);\n\n\tpos=pos-pos%4u;\n\n\theight = (superArray(pos+3u).w-superArray(pos).w)/512.0;\n\n    vec2 mxy=vec2(coord.p,coord.q);\n\n\n\t\tfloat z=a_position.z;\n\n\tif(z<0.0){\n\tz*=-1.0;\n\tmxy*=0.0;\n\n\t}\n\n    \nif(a_margins.x!=0.0&&(a_step==1u||a_step==3u)){\nmxy.x+=a_margins.x-coord.p;\n}\n\n\nif(a_margins.y!=0.0&&(a_step==2u||a_step==3u)){\nmxy.y+=a_margins.y-coord.q;\n}\n\n\nif(a_margins.z!=0.0){\n\tfloat s = sin(a_margins.z);\n\tfloat c = cos(a_margins.z);\n\tmat2 m = mat2(c, -s, s, c);\n\tmxy.xy*=m;\n}\n\n\n\n    t = (now - a_physic.w) * 0.001;\n    mxy.x+=a_physic.x * t;\n\n\tfloat physicY=a_physic.y * t + a_physic.z * .5 * t * t;\n\n    mxy.y+=physicY;\n\n\nif(miniMap==1){\n\tz=0.0;\n}else{\n\tz=(1.0 - (physicY+z)/ zMax)*.9;\n}\n\n\n\n\n\n\n\n   gl_Position = vec4((((a_position.xy+mxy) + u_translation) / u_resolution * 2.0 - 1.0) * vec2(zoom, -zoom), (z), 1.0);\n\n   vTextureCoord=vec2(coord.s,coord.t);\n\n\n    v_kcolor=a_kingdom;\n\n\n}\n");
m.compileShader($a);var ab=m.createShader(m.FRAGMENT_SHADER);m.shaderSource(ab,"#version 300 es\nprecision mediump float;\n\n\n\nuniform sampler2D lightmap;\nuniform vec2 u_resolution;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\nuniform mediump int miniMap;\nin vec4 v_kcolor;\nin highp vec2 vTextureCoord;\nin float height;\nout vec4 COLOR;\n\nvoid main() {\n\n\nif(miniMap==0){\n\n\n\n\nvec2 txtFinal=vTextureCoord;\n\nif(txtFinal.x>=1.0){\ntxtFinal.y+=height*floor(txtFinal.x);\n}\n\n\nvec4 color=texture(img_common, vec3(txtFinal, int(txtFinal.y)));\n \n\nif(color.a<0.5) discard;\n\n\n\n\nif(v_kcolor.a<1.0){\ncolor*=v_kcolor;\n}else if(v_kcolor.a!=1.0){\n\nif(color.r==color.g&&color.r==color.b){\ncolor.rgb*=v_kcolor.rgb;\n}\ncolor.a*=v_kcolor.a-1.0;\n}\nvec4 light=vec4(1.0);\n\n\nlight = texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+vec4(1.0,1.0,1.0,0.0)*u_ambient;\n\nCOLOR=color*light;\n}else{\nCOLOR=v_kcolor;\n}\n\n}");
m.compileShader(ab);N=m.createProgram();m.attachShader(N,$a);m.attachShader(N,ab);m.linkProgram(N);m.useProgram(N);var Ma=m.getShaderInfoLog($a);Ma&&console.log("Shader compiler log: "+Ma);(Ma=m.getShaderInfoLog(ab))&&console.log("Shader compiler log: "+Ma);var bb=m.createShader(m.VERTEX_SHADER);m.shaderSource(bb,"#version 300 es\nprecision mediump float;\n\nin vec3 a_position;\n\n\nuniform vec2 u_resolution;\nuniform vec2 u_translation;\nuniform mediump int miniMap;\nuniform float zoom;\n\n\nvoid main() {\n\nfloat depth;\nif(miniMap==1){\ndepth=.03;\n}else{\ndepth=1.0;\n}\n\n   gl_Position = vec4(a_position.x, a_position.y, depth, 1.0);\n   \n\n}");
m.compileShader(bb);var fb=m.createShader(m.FRAGMENT_SHADER);m.shaderSource(fb,"#version 300 es\nprecision mediump float;\n\nuniform float u_fps;\nuniform mediump int miniMap;\nprecision highp sampler2DArray;\nuniform sampler2DArray img_common;\nuniform vec4 u_ambient;\nuniform vec2 borderCoords;\nuniform vec2 waterBorder;\nuniform vec2 u_translation;\nuniform vec2 u_resolution;\nuniform vec2 minimapMargin;\nuniform mediump isampler2D img_data;\nuniform sampler2D lightmap;\nout vec4 COLOR;\nuniform float zoom;\nuniform float mx;\nuniform float mapSize;\nuniform float terrainInfo[32];\nvec4 sptexture3D(in vec2 coords,in float height1) {\n \n\n \nif(coords.x>=1.0){\ncoords.y+=height1*floor(coords.x);\n}\n\n\n\n    return(\ttexture(img_common, vec3(coords,int(coords.y)))\t);\n}\n\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main() {\nvec4 color;\n\nvec2 xy =  vec2(gl_FragCoord.x,u_resolution.y-gl_FragCoord.y)/zoom;\n\nif(miniMap==1){\nxy+=minimapMargin/zoom;\n}else{\nxy+=-u_translation+vec2(mx,0.0)/zoom+0.5*(u_resolution-u_resolution/zoom);\n}\n\nvec2 xy32=xy/32.0;\n\nvec2 floorxy32=floor(xy32);\n\nvec2 xyr=xy32-floorxy32;\n\n\nvec2 xyb;\n\n\nfloat dx=0.0;\nfloat dy=0.0;\n\nif(xyr.x>0.5){dx=1.0;}\nif(xyr.y>0.5){dy=1.0;}\n\nvec2 oxy32=xy32;\n\n\nif(dx==1.0){\nxyb=vec2(borderCoords.x+floor(rand(floorxy32)*24.0)*64.0/512.0,borderCoords.y)+(xyr)*(32.0/512.0)+vec2(-16.0,8.0)/512.0;\nif(sptexture3D(xyb,64.0/512.0).r>0.5){\nxy32.x+=dx;\n}\n}\n\nif(dy==1.0){\nxyb=vec2(borderCoords.x+floor(rand(1.5*floorxy32-3.0)*24.0)*64.0/512.0,borderCoords.y)+(xyr)*(32.0/512.0)+vec2(8,-16.0)/512.0;\nif(sptexture3D(xyb,64.0/512.0).r>0.5){\nxy32.y+=dy;\n}\n}\n\n\nint type = texture(img_data,xy32/(mapSize)).r;\nint ntype = texture(img_data,oxy32/(mapSize)).r;\n\nif(type<0&&type!=ntype){\n\nif(ntype<0){\ntype=ntype;\n}else if(ntype==3){\ntype=ntype;\n}else{\ntype=1;\n}\n}\n\n\n\nfloat h;\nfloat w;\nvec2 xytxt;\nif(type<0){\n\ntype=-type-2;\nxytxt=waterBorder+vec2(float(type*8*32),0.0)/512.0;\nw=32.0;\nh=32.0;\ntype*=-1;\n}else{\nxytxt=vec2(terrainInfo[type*4],terrainInfo[type*4+1]);\nw=terrainInfo[type*4+2];\nh=terrainInfo[type*4+3];\n\nif(type==3) xytxt+=vec2(u_fps,0.0);\n}\n\n\nvec2 xyt=vec2(xytxt)+vec2(mod(xy.x,w),mod(xy.y,h))/512.0;\n\n\nif(type==3){ h=576.0; }\ncolor=sptexture3D(xyt,h/512.0);\n\nmediump vec4 light=vec4(1.0);\nif(miniMap==0) light = (texture(lightmap, gl_FragCoord.xy/u_resolution)/u_ambient+1.0)*u_ambient;\n\n\n\nCOLOR=color*light;\n\n\n\n}");
m.compileShader(fb);ya=m.createProgram();m.attachShader(ya,bb);m.attachShader(ya,fb);m.linkProgram(ya);(Ma=m.getShaderInfoLog(bb))&&console.log("Shader1 compiler log T: "+Ma);(Ma=m.getShaderInfoLog(fb))&&console.log("Shader compiler log T: "+Ma)}var tb=m.getAttribLocation(N,"a_position"),lb=m.getAttribLocation(N,"a_texCoord"),vb=m.getAttribLocation(N,"a_kingdom"),ib=m.getAttribLocation(N,"a_step"),wb=m.getAttribLocation(N,"a_physic"),xb=m.getAttribLocation(N,"a_margins"),Qa=l,kb=pc.dir,Xa=[];Xa.length=
4*kb.length;for(var Sa=0,cb=kb.length;Sa<cb;Sa++){var db=Ja[Qa[kb[Sa]]],zb=db[7]+db.deltaY,Ab=db[8],Cb=db[9];Xa[4*Sa]=db[6]/512;Xa[4*Sa+1]=zb/512;Xa[4*Sa+2]=Ab;Xa[4*Sa+3]=Cb}var qb=1/512;m.useProgram(ya);var Bb=m.getUniformLocation(ya,"minimapMargin");kf=m.getUniformLocation(ya,"u_translation");Ti=m.getUniformLocation(ya,"u_resolution");Si=m.getUniformLocation(ya,"u_fps");ql=m.getUniformLocation(ya,"u_ambient");Xd=m.getUniformLocation(ya,"zoom");var Db=m.getUniformLocation(ya,"mx"),Gb=m.getUniformLocation(ya,
"mapSize"),Ib=m.getUniformLocation(ya,"borderCoords"),za=m.getUniformLocation(ya,"waterBorder");fh=m.getUniformLocation(ya,"miniMap");var Jb=m.getUniformLocation(ya,"terrainInfo");m.uniform2fv(Ib,[Ja[Qa.terrain_border][6]*qb,qb*(Ja[Qa.terrain_border].deltaY+Ja[Qa.terrain_border][7])]);m.uniform2fv(za,[Ja[Qa.waterborder][6]*qb,qb*(Ja[Qa.waterborder].deltaY+Ja[Qa.waterborder][7])]);m.uniform1i(fh,0);m.uniform2fv(kf,[0,0]);m.uniform1f(Si,-1);m.uniform1f(Xd,1);m.uniform1f(Db,-x.mx);m.uniform1f(Gb,G);
m.uniform1fv(Jb,Xa);p.editor?m.uniform2fv(Bb,[0,-60]):m.uniform2fv(Bb,[-4,-31]);var Eb=m.getAttribLocation(ya,"a_position");Ui=m.createVertexArray();m.bindVertexArray(Ui);var Ob=m.createBuffer();m.bindBuffer(m.ARRAY_BUFFER,Ob);m.bufferData(m.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,-1,1,1,-1,1]),m.STATIC_DRAW);m.enableVertexAttribArray(Eb);m.vertexAttribPointer(Eb,2,m.FLOAT,!1,0,0);m.bindVertexArray(null);m.useProgram(N);m.bindBuffer(m.ARRAY_BUFFER,null);Vi=m.createVertexArray();m.bindVertexArray(Vi);
Dl=m.createBuffer();m.bindBuffer(m.ARRAY_BUFFER,Dl);m.enableVertexAttribArray(ib);m.vertexAttribIPointer(ib,1,m.UNSIGNED_BYTE,0,0);m.bufferData(m.ARRAY_BUFFER,new Uint8Array([0,1,2,1,2,3]),m.STATIC_DRAW);m.vertexAttribDivisor(ib,0);hc=0;lf=Math.floor(G*ha*.5);hf&&(m.deleteBuffer(hf),m.deleteBuffer(ah),m.deleteBuffer(bh),m.deleteBuffer(ch),m.deleteBuffer(dh));hf=xd(vb,4);ah=xd(lb,4);bh=xd(tb,3);ch=xd(wb,4);dh=xd(xb,3);m.bindVertexArray(null);eh=m.getUniformLocation(N,"u_resolution");rl=m.getUniformLocation(N,
"u_ambient");jf=m.getUniformLocation(N,"u_translation");Wd=m.getUniformLocation(N,"zoom");Cl=m.getUniformLocation(N,"now");gh=m.getUniformLocation(N,"miniMap");var Pb=m.getUniformLocation(N,"zMax");m.uniform1f(Pb,p.zMax);m.uniform1i(gh,0);m.useProgram(N);l.delay=[100,250,400,550,650,750,850,1E3,1150,5150,7650,10150,13650,17150,21150,25150,100,200,300,400,500,600,700,800,900,1E3,1100,1200,7200,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,6500,7700,8900,10100,13600,17100,22100,8E3,8080,8160,
8240,8320,8400,8480,100,200,300,400,500,600,700,800,900,1E3,1100,2400,3600,4800,6E3,7200,8400,11900,15400,20400,8E3,8077,8154,8231,8308,8385,8462,8539,8616,8693,8770,8847,8923,5E3,5072,5143,5215,5286,5358,5429,5501,5572,5644,5715,5787,5858,5929,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,3700,4900,7100,9600,12600,17100,8E3,8083,8166,8250,8333,8416,8500,8583,8666,8750,8833,8916,9E3,8E3,8083,8166,8250,8333,8416,8500,8583,8666,8750,8833,8916,9E3,9080,5E3,5100,5200,5300,5400,5500,5600,
5700,5850,6E3,70,140,210,280,350,420,490,560,630,700,770,840,910,980,4980,8980,12980,16980,20980,26980,6E3,6100,6200,6300,6400,6500,6600,100,200,300,400,500,600,700,800,900,1E3,1100,4100,6300,8500,11E3,13500,17E3,20500,5E3,5100,5200,5300,5400,5500,5600,5700,5800,5900,6E3,125,230,335,431,546,606,666,731,857,952,1045,1139,1238,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,3300,5800,8800,12E3,15500,5500,5600,5700,5800,5900,6E3,6100,6200,6300,6400,6500,6600,100,200,300,400,500,600,700,800,900,
1E3,1100,1200,1300,6800,9800,12800,16300,19800,23800,28300,5E3,5100,5200,5300,5400,5500,5600,210,420,654,864,1074,1284,1494,108,244,380,516,652,788,924,1060,1196,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4100,6100,8100,11100,14100,17100,6E3,6100,6200,6300,6400,6500,6600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,5200,9E3,11E3,13800,17600,23400,7E3,7100,7200,7300,7400,8200,8300,8400,8500,8600,9600,9700,9800,9900,1E4,80,160,210,360,610,1010,1510,100,200,300,400,500,3500,
7500,13500,40,80,120,160,200,240,280,320,360,400,440,480,520,2520,3520,4520,5520,6520,8520,11520,107,214,321,428,535,642,749,856,963,1070,1177,1284,1391,1498,7323,13148,18973,24798,30623,36448,7E3,7170,7340,7510,7680,7980,8150,8320,8490,8660,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,4400,6400,8900,11400,14900,18400,7E3,7200,7400,7600,7800,8E3,8200,125,250,375,500,2E3,2125,2250,100,200,300,400,500,4E3,10500,100,200,300,400,500,600,700,800,900,8900,15900,21400,27400,33900,38900,44900,
51900,800,1E3,1200,1400,1600,1800,2E3,2200,2400,2600,NaN,80,160,240,320,400,480,560,640,720,800,880,960,1040,5040,9040,12790,16540,19290,22040,25790,7671,7771,7871,7971,8071,8171,8271,100,200,300,400,500,600,700,800,900,1E3,1100,1200,6200,9700,13200,17200,21200,25200,29200,35200,100,200,300,400,500,600,9600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,5300,11300,17300,27300,37300,49300,64300,8E3,8228,8457,8685,8914,9142,9371,80,160,240,320,400,480,560,640,720,800,880,960,4960,8460,11460,
14460,18460,22460,28460,8E3,8228,8456,8684,8912,9140,9367,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,5400,8900,12900,16900,22900,28900,5E3,5143,5286,5429,5572,5715,5857,121,232,361,508,629,758,879,1018,1165,1425,1445,1465,1536,1692,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,5300,8300,11300,14800,18800,23300,29300,6E3,6171,6343,6514,6685,6857,7028,125,250,375,500,625,750,875,1E3,1125,1250,1375,1500,6500,10500,13500,16500,19500,23E3,27E3,31500,8E3,8185,8370,8555,8740,8925,
9108,14E3,14143,14286,14429,14572,14715,14857,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4300,7800,11300,15300,19300,23800,29800,1E4,10107,10214,10321,10428,10535,10643,10750,10857,10964,11071,11178,11285,11393,190,369,547,726,904,1073,1241,1325,1398,1429,1586,1754,1922,2100,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,4900,8400,12900,17400,22400,27400,8E3,8250,8500,8750,9E3,9250,9500,9750,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4800,7800,10800,14300,17800,
21800,26300,5E3,5086,5171,5257,5342,5428,5513,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4800,8300,11800,15800,19800,24300,29300,5E3,5157,5314,5471,5628,5785,5943,125,250,375,500,625,3125,3250,3375,100,200,300,400,500,600,4600,8600,14600,15600,14E3,14143,14286,14429,14572,14715,14857,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,7400,10900,14400,18400,22400,28400,180,360,540,720,900,1080,10080,100,200,350,500,600,700,800,950,1100,1250,1400,1550,1700,6200,8700,11700,15200,
18700,22700,27700,6E3,6120,6240,6360,6480,6600,6720,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,7400,10900,14900,18900,23400,29400,8E3,8150,8300,8450,8600,8750,8900,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,4400,7400,10900,14900,19900,5E3,5100,5200,5300,5400,5500,5600,116,232,348,464,522,580,638,696,812,928,1044,1160,1276,1392,100,200,300,400,500,600,700,800,900,1E3,1100,1200,5200,8700,11700,14700,18700,22700,28700,8E3,8228,8456,8684,8912,9140,9367,100,200,300,400,
500,600,700,800,900,1E3,1100,1200,1300,1400,6900,10900,14400,18400,22400,27400,7E3,7100,7200,7300,7400,7500,7600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,5300,8600,10800,13E3,15500,19500,24E3,8E3,8100,8200,8300,8400,8500,8600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,5300,8800,12300,16300,20300,24300,29300,6E3,6100,6200,6300,6400,6500,6600,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,1500,1600,1630,1730,1830,1930,2030,2130,2230,2330,5330,8330,11330,7E3,7150,
7300,7450,7600,7750,7900,100,200,300,400,500,600,700,800,900,1E3,1100,1200,5200,8700,12200,15700,20200,24700,29700,34700,8E3,8080,8163,8246,8330,8413,8496,8580,8663,8746,8830,8913,8996,9080,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,4800,7800,10800,14300,17800,21800,26300,5E3,5086,5171,5257,5342,5428,5513,5599,5684,5770,5855,5941,6026,6112,125,250,375,500,625,750,875,1E3,1125,1250,1375,1500,1625,5625,8625,11625,14625,18125,22125,26625,8E3,8185,8370,8555,8740,8925,9108,190,369,547,726,
904,1073,1241,1325,1398,1429,1586,1754,1922,2100,100,200,300,400,500,600,700,800,900,1E3,1100,6100,10600,14600,18100,21600,26100,30600,35600,40600,8E3,8150,8300,8450,8600,8750,8900,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,1500,1600,1700,6700,10700,11300,6E3,6200,6400,6600,6800,7E3,7200,100,200,300,400,500,600,700,800,900,1E3,1100,1200,1300,1400,10400,100,200,300,400,500,600,8600];var pb=l.delay,Lb=pb.length;Ja[l.expl_small_hole][1]=-Lb;for(var Fb=Sa=0;14>Sa;Sa++)Fb+=66,pb[Sa+Lb]=
Fb;pb.put(Fb+3E4);pb=new Float32Array(pb);p.daylength||(p.daylength=2880);p.initialhour||(p.initialhour=12);Sa=0;for(cb=rb.length;Sa<cb;Sa++).55>rb[Sa]&&(rb[Sa]=.55);xk();m.uniform1f(Wd,1);m.uniform2fv(jf,[0,0]);wd=m.createFramebuffer();oe.changed=0;window.addEventListener("resize",oe,!1);oe();m.blendEquation(m.FUNC_ADD);m.blendFunc(m.SRC_ALPHA,m.ONE_MINUS_SRC_ALPHA);m.disable(m.DITHER);m.disable(m.BLEND);performance.now();yd(1);if(!of){m.activeTexture(m.TEXTURE3);var Mb=m.createTexture();m.bindTexture(m.TEXTURE_2D,
Mb);m.texImage2D(m.TEXTURE_2D,0,m.R16F,pb.length,1,0,m.RED,m.FLOAT,pb);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT);m.bindTexture(m.TEXTURE_2D,null);m.bindTexture(m.TEXTURE_2D,Mb);m.uniform1i(m.getUniformLocation(N,"delay"),3);m.activeTexture(m.TEXTURE2);Bl=m.createTexture();m.bindTexture(m.TEXTURE_2D,Bl);m.texImage2D(m.TEXTURE_2D,
0,m.RGBA,1,1,0,m.RGBA,m.UNSIGNED_BYTE,new Uint8Array([255,255,255,255]));m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT);m.clearColor(0,0,0,1)}m.bindFramebuffer(m.FRAMEBUFFER,wd);wd.width=1;wd.height=1;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,Yd,0);m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT);
m.bindFramebuffer(m.FRAMEBUFFER,null);new Float32Array(8);Sa=0;for(cb=$i.length;Sa<cb;Za($i[Sa++]));var Hb=Nb.color;Kb(Hb[0],Hb[1],Hb[2],.25,yb.bufferID);m.enable(m.DEPTH_TEST);m.depthFunc(m.LEQUAL);ub.fp1000=1E3;ub.delta=0;ub.now=0;ub.frameCount=0;m.bindTexture(m.TEXTURE_2D,Yd);of=da.setup=!0;performance.now();performance.now();fj($c);performance.now();Rb.check()},Rb=function(){for(var d=["loading","playermenu","index"],b=d.length,c=0;c<b;q(d[c++]).style.display="none");Fe(x.kingdom);zi();df();Ql();
window.addEventListener("keydown",Lj);window.addEventListener("keyup",Mj);window.addEventListener("mousemove",Nj);window.addEventListener("wheel",zh,!1);window.addEventListener("mousedown",Oj);window.addEventListener("mouseup",Pj);P=gc;kh=performance.now()-kh;T("FULL: ",kh);Zi=!1;p.record||(p.record={});p.online?(Kc(dd(),t.waitingPlayers,1),x.admin?ad():(T("live ready"),I(ad,0,0))):Ff();p.allow14=!1};Rb.check=function(){Rb.load++;Rb.load===Rb.target&&Rb()};Rb.target=2;var dd=function(){for(var d=
Da.length,b=Da,c="",e=0;e<d;e++){var h=b[e];dd.obj[h.id]||h.id==x.onlineID||(c+="<br>"+h.nhinfo.name)}return c};dd.obj={};var Rl=function(){return x.gl?!1:(Kc("You can't run WEBGL 2<br>More info <a href='http://webglreport.com/?v=2'>here</a>","Error"),db(),!0)},Jj=function(){var d=document.documentElement;d.requestFullscreen?d.requestFullscreen():d.msRequestFullscreen?d.msRequestFullscreen():d.mozRequestFullScreen?d.mozRequestFullScreen():d.webkitRequestFullscreen&&d.webkitRequestFullscreen()},Zi=
!1,be=function(){if(!Rl())if(Qb.createMap)if(Tg(),Qh(),Rb.load=0,"true"==localStorage.fullscreen&&Jj(),p.editor?(x.marx=0,x.mary=60,x.menumy=60,dc=Cc=171,x.mx=171,x.menumx=171):(x.mx=151,dc=Cc=128,x.menumx=151,x.menumy=0,x.marx=4,x.mary=31),Uc.style.width=Cc+"px",Uc.style.height=dc+"px",Uc.style.left=x.marx+"px",Uc.style.top=x.mary+"px",Ca("loading"),""==q("loading").innerHTML&&(q("loading").innerHTML='<p id="loadingtext"></p>\n<div>\n<div class="svgtzared"></div>\n<div id=\'logo\' class="svgnehhon"></div>\n<span id="netral">NEHHON NETRAL-H ENGINE</span>\n</div>'),
origin=!1,void 0===p.arje&&Ef(),Wf.last!==p.terrainType){da.started=!0;var d=x.cdn;Pm({icons:d+"icons.png",imageJSON:d+"images.json",common:d+"graphics.nh17"});Wf.last=p.terrainType;Zi=!0}else Rb.check(),Nh();else mh.waiting=!0},Df,zi=function(){var d=q("playersinfo");d.innerHTML="";if(!p.editor)for(var b=1,c=E.length;b<c;b++){var e=E[b],h=e.death?e.name.strike():e.name;d.innerHTML+=h+"<span id='score"+b+"'></span><div class='playercolor' style='background:rgb("+e.color[0]+","+e.color[1]+","+e.color[2]+
")'></div><span class='ping'>"+(void 0!=E[b].ping&&" "+E[b].ping+"ms"||"")+"</span><br>"}},Ql=function(){var d=window.innerWidth-x.mx,b=window.innerHeight,c=E[x.kingdom].origin;c?(d=32*c[0]-.5*d,b=32*c[1]-.5*b):b=d=0;Rd(~~d,~~b)},cf,xl,tl,Om=function(){var d=q("selectedobject").getContext("webgl",{antialias:!1,depth:!1}),b=d.createShader(d.VERTEX_SHADER);d.shaderSource(b,"void main() {\ngl_Position = vec4(0 ,0, 0, 1);\ngl_PointSize=48.0;\n}");d.compileShader(b);var c=d.createShader(d.FRAGMENT_SHADER);
d.shaderSource(c,"precision mediump float;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nuniform float txtCoord;\nvoid main() {\ngl_FragColor = texture2D(u_image, (vec2(\tmod(txtCoord,21.0) ,floor(txtCoord/21.0) ) + gl_PointCoord)*(0.046875));\nif(gl_FragColor.r==gl_FragColor.g&&gl_FragColor.r==gl_FragColor.b) gl_FragColor*=u_color;\n}");d.compileShader(c);var e=d.createProgram();d.attachShader(e,b);d.attachShader(e,c);d.linkProgram(e);d.useProgram(e);b=d.createTexture();d.bindTexture(d.TEXTURE_2D,
b);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST);d.texImage2D(d.TEXTURE_2D,0,d.RGB,d.RGB,d.UNSIGNED_BYTE,W.icons);var h=d.getUniformLocation(e,"u_color"),g=d.getUniformLocation(e,"txtCoord");cf=function(b){if(Ja[b.img][3]){var c=b.kingdom;d.uniform4f(h,cb[3*c],cb[3*c+1],cb[3*c+2],1)}else d.uniform4f(h,1,1,1,1);d.uniform1f(g,
b.iconID);d.drawArrays(d.POINTS,0,1)};xl=function(){d.uniform4f(h,1,1,1,1);d.uniform1f(g,189);d.drawArrays(d.POINTS,0,1)};tl=function(){d.uniform1f(g,0);d.uniform4f(h,0,0,0,0);d.drawArrays(d.POINTS,0,1)}},Cc=128,dc=128,w=[{terrain:1},{terrain:1},{terrain:1}],Xa={},fj=function(d){fj.using=!0;d=p.tr;var b=z;if(!p.custom&&b){for(var c=p,e=b,h="kingdom d type img x32 y32 name iconID attack defence level health maxHealth func funcObj workers workingOn inventory dix diy timestamp working rnd techID techStart activeTech levelProgress c mimg built xf yf action point waitlist mv work death freezed confused sword shield book spy".split(" "),
g={},k=0;k<h.length;k++)g[h[k]]=k;h=[];var l=e.length;for(k=0;k<l;k++){var m=e[k],q=Object.keys(m),t={};h.put(t);for(var r=0,v=q.length;r<v;r++)t[g[q[r]]]=m[q[r]]}c.ini=h}p.demo&&(b=p.ini);if(b)for(c=0,e=b.length;c<e;c++){g=b[c];if(void 0!==g.race){g.type=Ln[g.type+256*g.race];g.kingdom=d[g.kingdom];if(void 0==g.type)continue;k=B[g.type];if(13==g.type||k.build)g.d=0;g.resource&&(g.health=g.resource,g.maxHealth=g.resource);if(!g.health||void 0==g.kingdom)continue}g.death?(w.put(g),Qb.falseunit()):
g.cancell||(k=g.x32,h=g.y32,l=!1===g.built&&1===g.health?!0:!1,m=g.kingdom||0,g=new kd(g.type,m,k,h,0,l,g),g.invalid||(l||p.cycle||Mk(g),g.castle&&(E[m].origin=[k+4,h+3])))}ae=z=null;fj.using=!1},Fe=function(d){d===x.kingdom&&(d=Nb.values.popMax<Nb.values.popLimit?Nb.values.popMax:Nb.values.popLimit,q("pop").innerHTML=Nb.values.pop+"/"+d)};window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(d){window.setTimeout(d,
1E3/60)}}();var ae=z=void 0;var In=function(d,b){ae[d]||(b.x32=d%G,b.y32=~~(d/ha),z.put(b),ae[d]=b)},Jn=function(d){return!z[d]},Kn=function(d){return ae[d]||NaN},Da=[];window.addEventListener("offline",function(d){Id("Offline","#ff0000")});window.addEventListener("online",function(d){Id("Online","#00ff00")});var yh=function(){eb.leaveRoom();Da.length=0},ce={};(function(){for(var d=["returnmenu","index","Account","accountIframe"],b=0,c=d.length;b<c;ce[d[b]]=q(d[b++]));})();var Mn=function(){location.replace("#"+
this.gameID+"Room")},Rj=function(d){Da=[];T("connecting to",d,t.loading);q("game").style.display="block";q("gameName").innerHTML=t.loading;q("returnmenu").style.display="none";q("index").style.display="none";lc.innerHTML="";ba=[];x.p2p?(eb.joinRoom(d,Ah),Qh()):(eb||mc(),mc.func=function(){Rj(d)})},Nn={6400900:".",28462225:"a",29052100:"b",29648025:"c",3025E4:"d",30858025:"e",31472100:"f",32092225:"g",32718400:"h",33350625:"i",33988900:"j",34633225:"k",35283600:"l",35940025:"m",36602500:"n",37271025:"o",
37945600:"p",38626225:"q",39312900:"r",40005625:"s",40704400:"t",41409225:"u",42120100:"v",42837025:"w",4356E4:"x",44289025:"y",45024100:"z"},On=function(d){q("game").style.display="none";na.length=0;p.online=0;la=p.id=void 0;yh();db();d.constructor==String&&Kc(d)},Kj={euro:0,arab:0,asia:0},pe=function(d,b,c){if(!p.started&&c){T("peerInfo",d);d.name=Na(d.name);d.team=parseInt(d.team);0>d.team&&(d.team=0);d.team%=6;d.race=parseInt(d.race);if(0>d.race||2<d.race)d.race=0;b=d.version;c&&c.admin&&b!=x.version&&
(db(),eb.leaveRoom(),Kc(t.versionError+"<p> Admin version: "+parseFloat(b.substr(1))+"<br> Your version: "+parseFloat(x.version.substr(1))));c.nhinfo=d;c.username=d.name;de()}},ba,Ob=function(d,b,c){ba=d;de()},Qf=function(){return{version:x.version,color:x.color,team:x.team,race:x.race,name:x.name}},bb=function(d,b){if(b.resend)if(d.destinatary)(b=ee(d.destinatary))&&b.id!=x.onlineID&&(d.bridge=g.id,b.send(d));else{b=b.resend;for(var c=0,e=b.length;c<e;c++){var h=b[c];d.bridge=g.id;h.send(d)}}else{var g=
b;void 0===d.length?void 0!==d.func&&(b=fg[d.func],Sl(b,d[1],d[2],g)||b(d[1],d[2],g)):(b=d[0],g.orderList[b]=d,bb.done[b]||(bb.done[b]=0),bb.done[b]++,bb.done[b]==Da.length&&bb.func&&(bb.func=!1,Dd(),$b()))}};bb.done=[];var ee=function(d){for(var b=0,c=Da.length;b<c;b++){var e=Da[b];if(e.id==d)return e}},eb,Ul=function(d){if(!q("usernameForm")){kb();var b=localStorage.name||"Guest",c=localStorage.color||"#"+Math.floor(16777215*Math.random()).toString(16),e=document.createElement("div");e.id="usernameForm";
e.innerHTML="\n            <div>\n            <h2>"+t.username+'</h2>\n            <div>\n<input type="color" id=\'usernameColor\' value="'+c+'" /><input id=\'usernameVal\' type="text" value="'+Tl(b)+'" />\n</div>\n<br />\n</div>';b=document.createElement("button");b.innerHTML=t.continue;b.onclick=function(){x.name=Na(q("usernameVal").value);x.color=q("usernameColor").value;localStorage.color=x.color;localStorage.name=x.name;document.body.removeChild(q("usernameForm"));d();sa()};e.children[0].appendChild(b);
document.body.appendChild(e)}},mc=function(){Rl()||(x.name?(Gm(),eb=new SimpleWebRTC({localVideoEl:"",remoteVideosEl:"",autoRequestMedia:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},url:"https://solar.tza.red/"}),eb.on("channelMessage",function(d,b,c){"nehhof"==c.type&&bb(c.payload,d)}),eb.on("error",function(d){"full"==d&&(db(),Id(t.gameFull,"#ff0000"))}),eb.on("connectionReady",function(d){var b=eb.connection.connection;x.p2p=b;b.username=x.name;b.color=x.color;b.on("getRooms",
function(b){var d=b.date,c=Object.keys(b),f=q("gameList");if(1<c.length){f.innerHTML="";for(var k=0,l=c.length;k<l;k++){var m=c[k],p=b[m];if("date"!=m){var v=p.len;if(v){var r=document.createElement("tr"),w="";w=p.playing?w+("<td><div class='redCircle'></div>"+t.playing+"</td>"):w+("<td><div class='redCircle' style=\"background:rgba(0,255,0,.8); box-shadow:0px 0px 20px rgba(0,255,0,.8)\"></div>"+t.waiting+"</td></td>");w+="<td>"+Na(p.description)+"</td><td>"+~~((d-p.date)/6E4)+" min ago</td><td>"+
Na(v)+"/"+Na(p.max)+"</td>";r.innerHTML=w;r.gameID=m;p.playing||(r.onclick=Mn);f.appendChild(r)}}}}else f.innerHTML="<tr><td>No games found</td></tr>"});x.onlineID=d;mc.func&&mc.func()}),eb.on("createdPeer",function(d){p.started||ke(d)})):Ul(mc))},Pn=function(){Qh();sa();q("game").style.display="block";q("gameName").innerHTML=t.loading;q("returnmenu").style.display="none";q("index").style.display="none";lc.innerHTML="";Da=[];Gj();x.admin=1;x.room={description:q("gameFormName").value,max:parseInt(q("gameMax").value),
public:!0};2>x.room.max&&(x.room.max=2);14<x.room.max&&(x.room.max=14);localStorage.gameDescription=x.room.description;eb.createRoom(x.onlineID+"b",Ah);p.online=1;gd(Ef());document.body.removeChild(q("gameForm"));ba=[x.onlineID];de()},Vl=function(){eb||mc();if(x.onlineID){kb();var d=localStorage.gameDescription||x.name+"'s room",b=document.createElement("div");b.id="gameForm";b.innerHTML="\n<div>\n            <h2>"+t.gameOptions+"</h2>\n            "+t.gameName+': <input id=\'gameFormName\' type="text" value="'+
d+'" maxlength="29" /><br />\n'+t.nplayers+': <input id="gameMax" type="number" value="6" max="14" min="2"/><br />\n            </div>';d=document.createElement("button");d.innerHTML=t.continue;d.onclick=Pn;b.children[0].appendChild(d);document.body.appendChild(b)}else setTimeout(function(){location.hash=""},200),mc.func=Vl},Wl=function(d){for(var b="kingdom d type img x32 y32 name iconID attack defence level health maxHealth func funcObj workers workingOn inventory dix diy timestamp working rnd techID techStart activeTech levelProgress c mimg built xf yf action point waitlist mv work death freezed confused sword shield book spy stock".split(" "),
c=[],e=d.length,h=0;h<e;h++){var g=d[h],k=Object.keys(g),l={};c.put(l);for(var m=0,p=k.length;m<p;m++)l[b[k[m]]]=g[k[m]]}return c},ym=function(){Gf.download=!1;Ij();Gf.download=!0},Ij=function(){p.editor&&(p.arje=!1,q("mapDescription")&&(p.description=q("mapDescription").value,p.name=q("mapName").value,p.author=q("mapAuthor").value));delete p.terrain;var d=p,b=w,c=[];c.length=b.length-3;for(var e=3,h=b.length;e<h;e++){var g=b[e],k=B[g.type],l={0:g.kingdom,1:g.d,2:g.type,3:g.img,4:g.x32,5:g.y32};g.name!==
k.name&&(l[6]=g.name);g.iconID!==k.iconID&&(l[7]=g.iconID);g.attack!==k.attack&&(l[8]=g.attack);g.defence!==k.defence&&(l[9]=g.defence);g.level!==k.level&&(l[10]=g.level);g.health!==k.health&&(l[11]=g.health);g.maxHealth!==k.maxHealth&&(l[12]=g.maxHealth);g.func&&(l[13]=g.func);g.funcObj&&(l[14]=g.funcObj);g.workers&&g.workers.length&&(l[15]=g.workers);g.workingOn&&(l[16]=g.workingOn);g.inventory&&g.inventory.length&&(l[17]=g.inventory);g.dix&&(l[18]=g.dix);g.diy&&(l[19]=g.diy);g.timestamp&&(l[20]=
g.timestamp);g.working&&(l[21]=g.working);g.rnd&&(l[22]=g.rnd);g.techID&&(l[23]=g.techID);g.techStart&&(l[24]=g.techStart);g.activeTech&&(l[25]=g.activeTech);g.levelProgress&&(l[26]=g.levelProgress);g.c&&(l[27]=g.c);g.mimg&&(l[28]=g.mimg);void 0!==g.built&&(l[29]=g.built);void 0!==g.xf&&(l[30]=g.xf);void 0!==g.yf&&(l[31]=g.yf);void 0!==g.action&&(l[32]=g.action);g.point&&(l[33]=g.point);g.waitlist&&(l[34]=g.waitlist);g.mv&&(l[35]=g.mv);g.work&&(l[36]=g.work);g.death&&(l[37]=g.death);g.freezed&&(l[38]=
g.freezed);g.confused&&(l[39]=g.confused);g.sword&&(l[40]=g.sword);g.shield&&(l[41]=g.shield);g.book&&(l[42]=g.book);g.spy&&(l[43]=g.spy);g.stock&&(l[44]=g.stock);c[e-3]=l}d.allunits=c;p.movtable=fd;p.movtable2=ed;p.kingdomStart||p.editor||(p.kingdomStart=dj);p.kingdoms=E.slice(1);p.lastEdit=Date.now();Gf(p);p.allunits=void 0},Qn=function(d){for(var b=d.length,c=new Uint8Array(b),e=0,h=-1,g=0,k=0;k<b;k++){var l=d[k];if(h===l)g||(c[e++]=255),g++;else{if(g){if(4>g){e--;for(var m=0;m<g;m++)c[e++]=h}else c[e++]=
g>>8&255,c[e++]=g&255;g=0}c[e++]=l}h=l}if(g)if(4>g)for(e--,m=0;m<g;m++)c[e++]=h;else c[e++]=g>>8&255,c[e++]=g&255;return c.slice(0,e)},Gf=function(d){d=JSON.stringify(d);d=(new TextEncoder("utf-8")).encode(d);d=[new Uint8Array([55]),new Uint8Array((new Uint32Array([d.length])).buffer),d];0==p.arje&&d.put(Qn($c));d=new Blob(d,{type:"application/octet-binary"});if(Gf.download){d=URL.createObjectURL(d);var b=document.createElement("a");document.body.appendChild(b);b.style="display: none";b.href=d;b.download=
"savegame.tzared";b.click()}else Rn({name:p.name,date:Date.now(),played:p.now()},d)};Gf.download=!0;var Hf=[],I=function(d,b,c,e,h){if(void 0===d.location)return d();if(p.started&&!p.editor){var f=p.record;f[p.cycle]||(f[p.cycle]=[]);var k=f[p.cycle];f=k.length;k[f]=d.location;k[f+1]=b;c&&c.length&&(c=c.slice(0));k[f+2]=c}if(!p.blocked&&p.online&&Da.length){if(55===h)var l=!1;h={func:d.location,1:b,2:c,active:l,rnd:4294967296*Math.random()};if(!p.started||d.fast)gj(h),d(b,c);else if(e)for(f=0,b=e.length;f<
b;f++)d=e[f],h.destinatary=d.id,d.bridge?d.bridge.sendDirectly("channelMessage","nehhof",h):d.sendDirectly("channelMessage","nehhof",h);else Hf.put(h)}else d(b,c)},Sn=function(){Da.length&&(Ef(),ad.i=0,x.p2p.emit("gameStarted"),I(hj,la?!1:p,0,0,0))},ad=function(d,b,c){if(c){if(dd.obj[c.id])return;dd.obj[c.id]=1;d=dd();""==d?Kc(d,t.loading,1):Kc(d,t.waitingPlayers,1)}x.admin&&(ad.i++,T(ad.i,na.length,c),ad.i==na.length-p.bots&&setTimeout(function(){I(Ff)},100))};ad.i=0;var gj=function(d){for(var b=
0,c=Da.length;b<c;b++)Da[b].sendDirectly("channelMessage","nehhof",d)},Sl=function(d,b,c,e){if(!e)return!1;(b=d.secureNH&&!d.secureNH(b,c,e))&&T(d,e);return b},zd,ij,Dd=function(){if(!bb.done[zd]||bb.done[zd]<Da.length)return bb.func=!0,$b(),!0;for(var d=ba,b=0,c=d.length;b<c;b++){if(d[b]==x.onlineID)var e=void 0,h=ij;else{e=ee(d[b]);if(!e)continue;h=e.orderList[zd]}for(var g=1,k=h.length;g<k;g++){var l=h[g],m=fg[l.func];Sl(m,l[1],l[2],e)||m(l[1],l[2],e)}}bb.func=!1;gj(Hf);ij=Hf;zd++;Hf=[zd+1];return!1};
Dd.maxPing=200;var Ff=function(){sa();q("alert").style.display="none";p.started=1;p.date=Date.now();$b();Ra();zd=0;if(!p.custom||p.demo)for(var d=1,b=E.length;d<b;d++){var c=tb[Rg[E[d].race]],e=c.peasant.type;if(c=w[va[d][c.castle.type][0]])for(var h=0,g=p.peons;h<g;h++)Ee(e,c,1)}Oa.arr=[];Oa.units=[];Oa.time=500;Oa.steps=0;Oa.process=0;if(!p.editor&&!p.demo){Oa.precooked=[];for(d=0;d<E.length;d++)E[d].IA&&new Oa(E[d]);d=0;b=Oa.arr;for(e=b.length;d<e;b[d++].leaveMeAloneIKnowWhatToDo());Vh()}p.online&&
(gj([0]),Hf=[1],ij=[0]);ub()};Ff.fast=!0;var hj=function(d,b,c){b=[];c=ba;p=!1!==d?d:la;for(d=p.bots=0;d<c.length;d++){var e=c[d];e==x.onlineID?(b[d]=x,x.kingdom=d+1):(T(e),e.name?(p.bots++,b[d]=e,e.IA=1):(e=ee(e),b[d]=e.nhinfo,e.kingdom=d+1));na=b}pa("bless");p.infinity&&(p.goldRes=Infinity,p.foodRes=Infinity,p.woodRes=Infinity,p.stoneRes=Infinity);p.infinity=void 0;p.goldRes||(p.goldRes=Infinity);p.foodRes||(p.foodRes=Infinity);p.woodRes||(p.woodRes=Infinity);p.stoneRes||(p.stoneRes=Infinity);be()},
gf=!1,sa=function(){gf=!1;q("basic").style.filter=""},kb=function(){gf=!0;q("basic").style.filter="blur(94px)"};var Xl=function(){Ca("game");na.length=0;p.id=void 0;p.online=0;la=void 0;p.compressed=void 0;p.arje=void 0;yh();db();x.admin=0};var jj=function(d,b,c){c&&(mb.arr=new Uint8Array(parseInt(d)),mb.i=0,q("showGameInfo").innerHTML="<table><tr><td>Downloading custom map</td><td id='cmappr'></td></tr></table>")},mb=function(d,b,c){c&&(mb.arr.set(d,mb.i),mb.i+=d.length,q("cmappr").innerHTML=~~(100*
mb.i/mb.arr.length+.5)+"%",mb.i==mb.arr.length&&Yl(mb.arr))};mb.step=1E4;var Yl=function(d){var b=kj(d);b.custom=!0;la=b;la.online=!0;la.started=!1;la.editor=!1;x.admin&&(la.compressed=d);T("newmap",b);gd(b);de()},Zl=function(d){d=parseInt(d);if(2>d||!d)d=2;14<d&&(d=14);d!==x.room.max&&(x.p2p.emit("maxPlayers",d-(ba.length-Da.length-1)),I(Rf,d))},Rf=function(d){x.room.max=d;de()},Tn=function(){I(gd,p,!1);q("optionbutton").style.display="inline-table";ma("deleteCusMap")},Ah=function(d){if((x.admin||
d)&&!p.id)if(d=eb.roomName,d+="Room",T("login"),sa(),0!==eb.getPeers().length||x.admin){var b=x.room||NaN;p.id=d;p.online=1;Gj();x.admin&&(q("onlineTopInfo").innerHTML=' <button id="addAI" style="padding: 6px;">'+t.addAI+'</button><span style="float:right">'+t.nplayers+'<input id="nplayersO" min="2" type="number" max="14" value="'+x.room.max+'" /></span>',q("nplayersO").onchange=function(){var b=this.value;b<ba.length&&(b=ba.length);T(ba.length,b);ba.length!=b||Da.length||b++;Zl(b);this.value=x.room.max},
q("addAI").onclick=function(){if(ba.length<x.room.max&&(ba.length+1!==x.room.max||Da.length)){for(var b="#"+(~~(16777216*Math.random())).toString(16);7>b.length;)b+="0";ba.put({name:"AI",race:0,team:5,color:b});x.p2p.emit("maxPlayers",x.room.max-(ba.length-Da.length-1));I(Ob,ba,0)}});q("copyButton")&&(q("copyButton").onclick=function(){q("onlineID").select();document.execCommand("Copy")},q("onlineID").value=location.origin+"/#"+p.id);q("gameName").innerHTML=Na(b.description)||"Online Game";ma("returnmenu");
x.admin?(location.replace("#"+p.id),q("buttons").innerHTML='<button id="startbutton">'+t.play+'</button><button id="optionbutton">'+t.options+'</button><button id="closebutton">'+t.close+'</button><br><input id="maploadOnline" type="file" /> <label for= "maploadOnline">'+t.strcusMap+'</label> <button id="deleteCusMap">'+t.randomMap+"</button>",q("startbutton").onclick=Sn,q("optionbutton").onclick=$l,q("closebutton").onclick=Xl,q("maploadOnline").accept=".tzared",q("maploadOnline").onchange=Un,ma("deleteCusMap"),
q("deleteCusMap").onclick=Tn):(q("buttons").innerHTML='<button id="quitbutton">'+t.disconnect+"</button>",q("quitbutton").onclick=On);eb.connection.on("remove",am)}else location.hash="",db()},am=function(d){if(d=ee(d.id))if(Sc(Ai(t.playerDisconnected,d.nhinfo&&d.nhinfo.name),0,5),p.online){if(p.started)for(var b=0;b<na.length;b++)if(na[b].id==d.id){E[b+1].die();break}Da.quit(d);p.started?bb.done[zd]==Da.length&&bb.func&&(bb.func=!1,Dd(),$b()):(x.admin&&(ba.quit(d.id),I(Ob,ba,0)),d.admin&&(db(),eb.leaveRoom(),
Kc(t.gameClosed)))}},Ib=function(){0===Ib.active&&(I(lj),Ib.date=Date.now(),Ib.received=0,Ib.max=-Infinity,Ib.active=1)};Ib.active=0;var lj=function(d,b,c){c&&I(bm,0,0,[c],0)};lj.fast=!0;var mj={},bm=function(d,b,c){c&&(c.ping=~~(.5*(Date.now()-Ib.date)+.5),mj[c.id]?mj[c.id].put(c.ping):mj[c.id]=[c.ping],c.ping>Ib.max&&(Ib.max=c.ping),Ib.received++,Ib.received==Da.length&&(Ib.active=0,p.started&&(E[c.kingdom].ping=c.ping,zi())))},nj=function(d){var b=d.id;if(x.onlineID==b)return Kc(d.sp&&t.nospace||
t.kicked),Xl();if(d=ee(b))d.end(),am(b)},oj=document.getElementsByClassName("ucolor"),pj=document.getElementsByClassName("username"),cm=document.getElementsByClassName("race"),nh=document.getElementsByClassName("team"),Xb=function(d){if(x.admin){Xb.div&&(document.body.removeChild(Xb.div),Xb.div=void 0);var b=d.pageX;d=d.pageY;var c=this.i2,e=document.createElement("div");e.style.top=d+"px";e.style.left=b+"px";e.className="onlPlayer";Xb.div=e;if(this.peer.name)b=document.createElement("button"),b.onclick=
function(){ba.splice(c,1);x.p2p.emit("maxPlayers",x.room.max-(ba.length-Da.length-1));I(Ob,ba,0);document.body.removeChild(e);Xb.div=void 0},b.innerHTML=t.kick,e.appendChild(b);else{var h=this.peer&&this.peer.id;b=document.createElement("button");b.onclick=function(){var b=ba.indexOf(h);ba[b-1]&&(ba[b]=ba[b-1],ba[b-1]=h,I(Ob,ba,0),document.body.removeChild(e),Xb.div=void 0)};b.innerHTML=t.up;e.appendChild(b);b=document.createElement("button");b.onclick=function(){var b=ba.indexOf(h);ba[b+1]&&(ba[b]=
ba[b+1],ba[b+1]=h,I(Ob,ba,0),document.body.removeChild(e),Xb.div=void 0)};b.innerHTML=t.down;e.appendChild(b);x.onlineID!=h&&(b=document.createElement("button"),b.onclick=function(){I(nj,{id:h});document.body.removeChild(e);Xb.div=void 0},b.innerHTML=t.kick,e.appendChild(b))}b=document.createElement("button");b.onclick=function(){document.body.removeChild(e);Xb.div=void 0};b.innerHTML=t.close;e.appendChild(b);document.body.appendChild(e)}},de=function(){var d=q("multiplayertable"),b='<tr style="text-transform:uppercase"><td></td><td>'+
t.username+"</td><td>"+t.race+"</td><td>"+t.team+"</td></tr>",c=ba,e=x.room&&x.room.max||14;c&&e<c.length&&(e=c.length);for(var h=0;h<e;h++)b+='<tr><td class="ucolor"></td><td class="username">'+t.open+'</td><td class="race"></td><td class="team"></td></tr>';6>e&&(b+='<tr style="height: '+(260-46*e)+'px"></tr>');d.innerHTML=b;b=d.getElementsByTagName("tr");h=la&&la.kingdoms;var g=0;for(e=c.length;g<e;g++){if(c[g].name){m=c[g];p=x.admin;l=!0;var k=b[g+1];k.onclick=Xb;k.peer=m;k.i2=g;k.style.color=
"#fff900"}else{var l=!1;if(c[g]==x.onlineID)var m=x,p=!0;else{var v=ee(c[g])||NaN;m=v.nhinfo;if(!m)return pj[g].innerHTML="...";p=!1}}h&&h[g]?(l=h[g],k=l.color,oj[g].style.background="rgb("+k[0]+","+k[1]+","+k[2]+")",pj[g].innerHTML=m.name,l.team&&(nh[g].innerHTML=l.team)):(k=dk(m.color),oj[g].style.background="rgb("+k[0]+","+k[1]+","+k[2]+")",pj[g].innerHTML=m.name,p?(nh[g].innerHTML="",k=document.createElement("button"),k.onmousedown=dm,k.iteam=m,k.innerHTML=m.team,nh[g].appendChild(k),l&&(k.style.color=
"#fff900"),k=document.createElement("button"),k.onmousedown=em,k.iteam=m,k.innerHTML=Ia[m.race],cm[g].appendChild(k),l&&(k.style.color="#fff900"),l=document.createElement("input"),l.type="color",k=m.color,l.iteam=m,l.value="#"+(16777216+(k[0]<<16)+(k[1]<<8)+k[2]).toString(16).slice(1),oj[g].appendChild(l),l.onchange=fm):(x.admin&&(b[g+1].onclick=Xb,b[g+1].peer=v),nh[g].innerHTML=m.team,cm[g].innerHTML=Ia[m.race]))}q("msgs").style.height=d.clientHeight-87+"px"},Pl=function(d){d.goldRes=parseInt(d.goldRes);
d.foodRes=parseInt(d.foodRes);d.woodRes=parseInt(d.woodRes);d.stoneRes=parseInt(d.stoneRes);d.goldRes||(d.goldRes=Infinity);d.foodRes||(d.foodRes=Infinity);d.woodRes||(d.woodRes=Infinity);d.stoneRes||(d.stoneRes=Infinity);d.mapx=parseInt(d.mapx);(!d.mapx||32>d.mapx)&&(d.mapx=32);d.items=parseInt(d.items)||0;0>d.items&&(d.items=0);d.peons=parseInt(d.peons)||0;0>d.peons&&(d.peons=0);d.gateways=parseInt(d.gateways)||0;0>d.gateways&&(d.gateways=0);d.water=parseInt(d.water)||0;0>d.water&&(d.water=0);d.freePop=
parseInt(d.freePop)||0;d.terrainType=Na(d.terrainType);d.description=Na(d.description);d.author=Na(d.author);d.name=Na(d.name)},gd=function(d,b,c){Pl(d);d.goldRes||(d.goldRes=Infinity);d.foodRes||(d.foodRes=Infinity);d.woodRes||(d.woodRes=Infinity);d.stoneRes||(d.stoneRes=Infinity);b="<table><tbody>";d.custom?(c=new Date(d.date),c=c.getUTCDate()+"/"+(c.getMonth()+1)+"/"+c.getFullYear(),d=[t.mapName,d.name,t.mapSize,d.mapx,t.description,d.description,t.terrainOption,d.terrainType,t.author,d.author,
t.date,c],c=4):(la&&(la=void 0,de()),d=[t.gold,d.goldRes,t.mapSize,d.mapx,t.items,d.items,t.wood,d.woodRes,t.terrainOption,d.terrainType,t.peons,d.peons,t.food,d.foodRes,t.water,d.water,t.gateways,d.gateways,t.stone,d.stoneRes,t.freePop,d.freePop],c=6);for(var e=d.length,f=0;f<e;f+=2)f%c||(f&&(b+="</tr>"),b+="<tr>"),b+="<td>"+d[f]+":</td><td>"+d[f+1]+"</td>";b+="</tbody></table>";return q("showGameInfo").innerHTML=b},na=[];window.onhashchange=Hj;var lc=q("msgs"),Pf=q("msginput"),Ji=q("msginputGame"),
Ii=q("enterwindow");Pf.addEventListener("keyup",function(d){13==d.keyCode&&Ki()});var Sc=function(d,b,c){pa("chat");c&&(b=p.started?Xc:lc,b.innerHTML=5!==c?b.innerHTML+("<li><span>"+c.username+" \u2014</span> "+Na(d)+"</li>"):b.innerHTML+("<li>"+d+"</li>"),b.scrollTop=b.scrollHeight,p.started&&Fd())};Sc.fast=!0;var Fd=function(){11==lc.children.length&&Xc.removeChild(Xc.children[0]);1==lc.children.length&&(Fd.intv=setInterval(Vn,16E3))},Vn=function(){Xc.removeChild(Xc.children[0]);0==lc.children.length&&
clearInterval(Fd.intv)},Na=function(d){return String(d).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},Tl=function(d){return String(d).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},Ki=function(){if(p.started){var d=Xc,b=Ji.value;Ji.value=""}else d=lc,b=Pf.value,Pf.value="";""!=b&&(b=Na(b),d.innerHTML+="<li><span>"+x.name+" \u2014</span> "+b+"</li>",I(Sc,b,0,0,0),d.scrollTop=d.scrollHeight,p.started&&Fd())},fg=[hj,Tb,tc,vc,pg,uc,sc,Sc,ze,Ie,Ld,Qi,Md,af,ii,kg,
gg,ad,lj,bm,Mi,Ff,bg,Eg,Se,Gg,wi,vg,Ke,Le,Xe,Te,Jg,Oe,mi,Qd,ug,ri,dg,Ne,Dg,Ye,Ue,ti,Ze,Qe,Pe,We,Lg,Ei,ui,oi,gd,pe,Ob,mb,nj,Rf,Xh,jj],gm=function(d,b,c){return c&&c.admin},If=function(d,b,c){return(c&&c.admin||!c)&&!p.started},ca=function(d,b,c){d=b.length;c=E[c.kingdom].control;for(var e=0;e<d;e++)if(!c[w[b[e]].kingdom])return!1;return!0},oh=function(d,b,c){d=E[c.kingdom].control;b=w[b];return d[b.kingdom]?!0:!1},qj=function(d,b,c){b=E[c.kingdom].control;d=w[d];return b[d.kingdom]?!0:!1};hj.secureNH=
If;Tb.secureNH=ca;tc.secureNH=ca;vc.secureNH=ca;pg.secureNH=ca;uc.secureNH=ca;sc.secureNH=ca;ze.secureNH=ca;Ie.secureNH=ca;Ld.secureNH=ca;Qi.secureNH=qj;Md.secureNH=ca;af.secureNH=ca;ii.secureNH=ca;kg.secureNH=ca;gg.secureNH=oh;Mi.secureNH=ca;Ff.secureNH=function(d,b,c){return c&&c.admin||!c};bg.secureNH=oh;Eg.secureNH=ca;Se.secureNH=ca;Gg.secureNH=ca;wi.secureNH=qj;vg.secureNH=ca;Ke.secureNH=ca;Le.secureNH=ca;Xe.secureNH=ca;Te.secureNH=ca;Jg.secureNH=ca;Oe.secureNH=ca;mi.secureNH=ca;Qd.secureNH=
qj;ug.secureNH=ca;ri.secureNH=ca;dg.secureNH=ca;Ne.secureNH=ca;Dg.secureNH=ca;Ye.secureNH=ca;Ue.secureNH=ca;ti.secureNH=ca;Ze.secureNH=ca;Qe.secureNH=ca;Pe.secureNH=ca;We.secureNH=ca;Lg.secureNH=ca;Ei.secureNH=oh;ui.secureNH=oh;oi.secureNH=ca;gd.secureNH=If;Ob.secureNH=If;nj.secureNH=If;Rf.secureNH=If;jj.secureNH=gm;mb.secureNH=gm;Xh.secureNH=function(d,b,c){return!c};(function(){for(var d=fg,b=0,c=d.length;b<c;b++)d[b].location=b})();var hm=document.getElementsByClassName("ucolor1"),Wn=document.getElementsByClassName("username1"),
Xn=document.getElementsByClassName("race1"),Yn=document.getElementsByClassName("team1"),dm=function(d){var b=1;2==d.button&&(b=-1);if(p.online){d=this.iteam;d.team+=b;0>d.team&&(d.team=0);d.team%=6;this.innerHTML=d.team;if(d==x){I(pe,Qf());return}return I(Ob,ba,0)}d=this.iteam;na[d].team+=b;0>na[d].team&&(na[d].team=0);this.innerHTML=na[d].team},em=function(d){if(p.online){d=this.iteam;d.race=(d.race+1)%3;this.innerHTML=Ia[d.race];if(d==x){I(pe,Qf());return}return I(Ob,ba,0)}d=na[this.iteam];d.race=
(d.race+1)%3;this.innerHTML=Ia[d.race]},fm=function(){T(this.value);this.parentElement.style.background=this.value;if(p.online){var d=this.iteam;d.color=this.value;if(d==x){I(pe,Qf());return}return I(Ob,ba,0)}x.color=this.value;na[this.iteam].color=this.value},Zn=function(){ic.nu++;ic()},$n=function(){ic.nu--;0>=ic.nu?ic.nu=1:na.length--;ic()},Rg={0:"euro",1:"arab",2:"asia"},im=[["a","e","i","o","u"],"bcdfghjklmnpqrstvwxyz".split("")],ic=function(){if(x.name){q("returnmenu").style.display="block";
q("oneplayertbody").innerHTML="";q("oneplayertbody").innerHTML+='<tr><td></td><td id="addremove"><button id="addPlayer">+</button><button id="removePlayer">-</button></td><td></td><td></td></tr>';for(var d=ic.nu,b=0;b<d;b++)if(q("oneplayertbody").innerHTML+='<tr><td class="ucolor1"></td><td class="username1"></td><td class="race1"><button></button></td><td class="team1"><button></button></td></tr>',!na[b]){for(var c="#"+(~~(16777216*Math.random())).toString(16);7>c.length;)c+="0";na[b]={color:c,IA:1,
race:~~(3*Math.random()),team:b}}q("addPlayer").onclick=Zn;q("removePlayer").onclick=$n;na[0].color=x.color;na[0].name=x.name;na[0].IA=0;for(b=c=na[0].race=0;b<d;b++){var e=na[b],h=Ak[Rg[e.race]];if(e.IA)if(c<h.length)e.name=h[c++];else{h=e;var g=~~(9*Math.random())+2,k=im[1],l=k[~~(Math.random()*k.length)].toUpperCase();.85<Math.random()&&(l+=k[~~(Math.random()*k.length)]);for(k=0;k<g;k++){var m=im[k%2];l+=m[~~(Math.random()*m.length)];.8<Math.random()&&(l+=m[~~(Math.random()*m.length)])}h.name=
l}hm[b].style.background=e.color;Wn[b].innerHTML=e.name;h=Yn[b].getElementsByTagName("button")[0];h.iteam=b;h.onmousedown=dm;h.innerHTML=b;h=Xn[b].getElementsByTagName("button")[0];h.iteam=b;h.onmousedown=em;h.innerHTML=Ia[e.race];h=document.createElement("input");h.type="color";h.iteam=b;h.value=e.color;hm[b].appendChild(h);h.onchange=fm}}else Ul(ic)};ic.nu=4;var Hn=function(d,b,c){"granted"!=Notification.permission&&Notification.requestPermission(function(b){});var e=new Notification(d,{icon:"/nehhon/807.png",
body:b,requireInteraction:!1});c||(c=5550);setTimeout(function(){e.close()},c)},pc,bd=function(d){if(ia(d%G,~~(d/G))&&(d=$c[d],0<=d&&!pc.type[d]))return!0},jm=function(d){for(var b="",c=0,e=d.length;c<e;c++)b+=Nn[d[c]];return b};Im[jm([32718400,37271025,40005625,40704400,36602500,28462225,35940025,30858025])]!==jm([40704400,45024100,28462225,6400900,39312900,30858025,3025E4])&&(T("edge chrome firefox - compt"),Il=Jc);var yd=function(d){if(d){yd.update=!1;d=$c;for(var b=1*G,c=[],e={},h=0,g=G*ha;h<
g;h++){var k=d[h];if(pc.type[k]||0>k){var l=0;bd(h-1-b)&&(l+=1E7);bd(h-b)&&(l+=1E6);bd(h-b+1)&&(l+=1E5);bd(h-1)&&(l+=1E4);bd(h+1)&&(l+=1E3);bd(h-1+b)&&(l+=100);bd(h+b)&&(l+=10);bd(h+1+b)&&(l+=1);pc.type[k]&&(Xa[h]=1,Ta[h]=1,Y[h]=1);l?void 0!==zl[l]&&(c.put(h),e[c.length-1]=-zl[l]/256-2):0>k&&(d[h]=3)}else Xa[h]&&(Xa[h]=0,Ta[h]=0,Y[h]=0)}h=0;for(b=c.length;h<b;h++)g=c[h],d[g]=e[h],Xa[g]=2,Ta[g]=2,Y[g]=2;m.useProgram(ya);m.activeTexture(m.TEXTURE1);c=m.createTexture();m.bindTexture(m.TEXTURE_2D,c);
m.pixelStorei(m.UNPACK_ALIGNMENT,1);m.texImage2D(m.TEXTURE_2D,0,m.R8I,G,ha,0,m.RED_INTEGER,m.BYTE,d);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT);m.bindTexture(m.TEXTURE_2D,null);m.bindTexture(m.TEXTURE_2D,c);m.uniform1i(m.getUniformLocation(ya,"img_data"),1);m.useProgram(N);m.activeTexture(m.TEXTURE2)}else yd.update=
!0};yd.update=!1;var c,Hl,lh,rf,sf,tf,uf,vf,wf,xf,yf,zf,Af,Bf,Cf,En=function(){var d={};c={move:function(){P=Tb;Tb.cursor=7}};c.move.iconID=262;c.move.obj={name:t.move};c.attack=function(){P=vc};c.attack.iconID=250;c.attack.obj={name:t.attack};c.guard=function(){od(4)};c.guard.iconID=237;c.guard.obj={name:t.guard};c.patrol=function(){od(8)};c.patrol.iconID=238;c.patrol.obj={name:t.patrol};c.pickUp=function(){P=Ld};c.pickUp.iconID=240;c.pickUp.obj={name:t.pickItems};c.explore=function(){od(7)};c.explore.iconID=
40;c.explore.obj={name:t.explore};c.stop=function(){I(ii,0,C)};c.stop.iconID=160;c.stop.obj={name:t.stop};c.stand=function(){I(mi,0,C)};c.stand.iconID=27;c.stand.obj={name:t.stand};c.attackGround=function(){};c.attackGround.iconID=100;c.steady=function(){};c.steady.iconID=21;c.createOrk=function(){V(58)};c.createOrk.iconID=120;c.createDwarf=function(){V(59)};c.createDwarf.iconID=117;c.createSkeleton=function(){V(60)};c.createSkeleton.iconID=87;c.createGhost=function(){V(40)};c.createGhost.iconID=
222;c.createFootman=function(){V(0)};c.createFootman.iconID=182;c.createArcher=function(){V(4)};c.createArcher.iconID=185;c.createMaceman=function(){V(3)};c.createMaceman.iconID=186;c.createPikeman=function(){V(1)};c.createPikeman.iconID=183;c.createLongbowman=function(){V(6)};c.createLongbowman.iconID=184;c.createKnight=function(){V(19)};c.createKnight.iconID=180;c.iniMercenaries=function(b){b.mlist=[];b.mlistID=[];b.mercID=0;fi(b);b.setupINTV(Pi,b.id,2E3)};c.iniMercenaries.builds=[30];c.iniHeroes=
function(b){b.hlist=[];b.hlistID=[];b.heroID=0;fi(b);b.setupINTV(Pi,b.id,2E3)};c.iniHeroes.builds=[30];c.mercFootmanArab=function(){La()};c.mercFootmanArab.iconID=49;c.mercFootmanArab.unit=80;c.mercFootmanArab.obj={};c.mercArcherArab=function(){La()};c.mercArcherArab.iconID=52;c.mercArcherArab.unit=85;c.mercArcherArab.obj={};c.mercMacemanArab=function(){La()};c.mercMacemanArab.iconID=116;c.mercMacemanArab.obj={};c.mercMacemanArab.unit=83;c.mercPikemanArab=function(){La()};c.mercPikemanArab.iconID=
52;c.mercPikemanArab.unit=82;c.mercPikemanArab.obj={};c.mercCavalry=function(){La()};c.mercCavalry.iconID=133;c.mercCavalry.unit=84;c.mercCavalry.obj={};c.mercEnichar=function(){La()};c.mercEnichar.iconID=123;c.mercEnichar.unit=91;c.mercEnichar.obj={};c.mercJihad=function(){La()};c.mercJihad.iconID=236;c.mercJihad.unit=86;c.mercJihad.obj={};c.mercFootmanArab6=function(){Ga()};c.mercFootmanArab6.iconID=49;c.mercFootmanArab6.unit=80;c.mercFootmanArab6.obj={};c.mercArcherArab6=function(){Ga()};c.mercArcherArab6.iconID=
52;c.mercArcherArab6.unit=85;c.mercArcherArab6.obj={};c.mercMacemanArab6=function(){Ga()};c.mercMacemanArab6.iconID=116;c.mercMacemanArab6.unit=83;c.mercMacemanArab6.obj={};c.mercPikemanArab6=function(){Ga()};c.mercPikemanArab6.iconID=52;c.mercPikemanArab6.unit=82;c.mercPikemanArab6.obj={};c.mercCavalry6=function(){Ga()};c.mercCavalry6.iconID=133;c.mercCavalry6.unit=84;c.mercCavalry6.obj={};c.mercEnichar6=function(){Ga()};c.mercEnichar6.iconID=123;c.mercEnichar6.unit=91;c.mercEnichar6.obj={};c.mercJihad6=
function(){Ga()};c.mercJihad6.iconID=236;c.mercJihad6.unit=86;c.mercJihad6.obj={};c.mercFootman=function(){La()};c.mercFootman.iconID=182;c.mercFootman.unit=0;c.mercArcher=function(){La()};c.mercArcher.iconID=185;c.mercArcher.unit=4;c.mercMaceman=function(){La()};c.mercMaceman.iconID=186;c.mercMaceman.unit=3;c.mercPikeman=function(){La()};c.mercPikeman.iconID=183;c.mercPikeman.unit=1;c.mercLongbowman=function(){La()};c.mercLongbowman.iconID=184;c.mercLongbowman.unit=6;c.mercKnight=function(){La()};
c.mercKnight.iconID=180;c.mercKnight.unit=19;c.mercFootman6=function(){Ga()};c.mercFootman6.iconID=182;c.mercFootman6.unit=0;c.mercFootman6.obj={};c.mercArcher6=function(){Ga()};c.mercArcher6.iconID=185;c.mercArcher6.unit=4;c.mercArcher6.obj={};c.mercMaceman6=function(){Ga()};c.mercMaceman6.iconID=186;c.mercMaceman6.unit=3;c.mercMaceman6.obj={};c.mercPikeman6=function(){Ga()};c.mercPikeman6.iconID=183;c.mercPikeman6.unit=1;c.mercPikeman6.obj={};c.mercLongbowman6=function(){Ga()};c.mercLongbowman6.iconID=
184;c.mercLongbowman6.unit=6;c.mercLongbowman6.obj={};c.mercKnight6=function(){Ga()};c.mercKnight6.iconID=180;c.mercKnight6.unit=19;c.mercKnight6.obj={};c.mercArcherAsian6=function(){Ga()};c.mercArcherAsian6.iconID=53;c.mercArcherAsian6.unit=67;c.mercArcherAsian6.obj={};c.mercSamurai6=function(){Ga()};c.mercSamurai6.iconID=122;c.mercSamurai6.unit=68;c.mercSamurai6.obj={};c.mercHourseSamurai6=function(){Ga()};c.mercHourseSamurai6.iconID=121;c.mercHourseSamurai6.unit=70;c.mercHourseSamurai6.obj={};
c.mercRonin6=function(){Ga()};c.mercRonin6.iconID=54;c.mercRonin6.unit=66;c.mercRonin6.obj={};c.mercHorseArcher6=function(){Ga()};c.mercHorseArcher6.iconID=52;c.mercHorseArcher6.unit=69;c.mercHorseArcher6.obj={};c.mercChariot6=function(){Ga()};c.mercChariot6.iconID=79;c.mercChariot6.unit=72;c.mercChariot6.obj={};c.mercArcherAsian=function(){La()};c.mercArcherAsian.iconID=53;c.mercArcherAsian.unit=67;c.mercArcherAsian.obj={};c.mercSamurai=function(){La()};c.mercSamurai.iconID=122;c.mercSamurai.unit=
68;c.mercSamurai.obj={};c.mercHourseSamurai=function(){La()};c.mercHourseSamurai.iconID=121;c.mercHourseSamurai.unit=70;c.mercHourseSamurai.obj={};c.mercRonin=function(){La()};c.mercRonin.iconID=54;c.mercRonin.unit=66;c.mercRonin.obj={};c.mercHorseArcher=function(){La()};c.mercHorseArcher.iconID=52;c.mercHorseArcher.unit=69;c.mercHorseArcher.obj={};c.mercChariot=function(){La()};c.mercChariot.iconID=79;c.mercChariot.unit=72;c.mercChariot.obj={};c.createPeon=function(){V(10)};c.createPeon.iconID=187;
c.sameSpeed=function(){I(dg,0,C)};c.sameSpeed.iconID=82;c.restoreSpeed=function(){I(ri,0,C)};c.restoreSpeed.iconID=88;c.createSpy=function(){V(2)};c.createSpy.iconID=162;c.emergeAllUnits=function(){var b=C[0];I(Md,b,w[b].inventory.slice(0))};c.emergeAllUnits.iconID=261;c.techFeudalism=function(){H(12)};c.techFeudalism.iconID=233;c.techArchitecture=function(){H(13)};c.techArchitecture.iconID=226;c.techLearning=function(){H(14)};c.techLearning.iconID=129;c.createPeon1=function(){V(64)};c.createPeon1.iconID=
55;c.createPeon2=function(){V(79)};c.createPeon2.iconID=132;c.createNinja=function(){V(65)};c.createNinja.iconID=51;c.techArmoredChariot=function(){H(51)};c.techArmoredChariot.iconID=79;c.techBuddhism=function(){H(45)};c.techBuddhism.iconID=127;c.techGreatWall=function(){H(48)};c.techGreatWall.iconID=80;c.ridingHorses=function(){H(49)};c.ridingHorses.iconID=64;c.irrigation=function(){H(50)};c.irrigation.iconID=72;c.createHorseArcher2=function(){V(85)};c.createHorseArcher2.iconID=52;c.techMeditation=
function(){H(52)};c.techMeditation.iconID=71;c.techKungFu=function(){H(53)};c.techKungFu.iconID=228;c.techTournaments=function(){H(54)};c.techTournaments.iconID=73;c.techPhilosophy=function(){H(55)};c.techPhilosophy.iconID=68;c.techNinjas=function(){H(56)};c.techNinjas.iconID=56;c.techMastery=function(){H(57)};c.techMastery.iconID=69;c.techGoldMining=function(){H(1)};c.techGoldMining.iconID=58;c.techStoneMining=function(){H(2)};c.techStoneMining.iconID=57;c.createCrusaders=function(){I(Qi,C[0],0)};
c.createCrusaders.iconID=221;c.techFanaticism=function(){H(31)};c.techFanaticism.iconID=235;c.techCrusade=function(){H(32)};c.techCrusade.iconID=93;c.techEspionage=function(){H(30)};c.techEspionage.iconID=215;c.techInquisition=function(){H(33)};c.techInquisition.iconID=97;c.techHealing=function(){H(34)};c.techHealing.iconID=219;c.healing=function(){P=Eg};c.healing.iconID=219;c.healing.iconIDbook=201;c.teach=function(){P=Lg};c.teach.iconID=23;c.teach.iconIDbook=217;c.techBless=function(){H(36)};c.techBless.iconID=
159;c.bless=function(){P=Se};c.bless.iconID=159;c.bless.iconIDbook=204;c.techMedicine=function(){H(35)};c.techMedicine.iconID=220;c.createMage=function(){V(5)};c.createMage.iconID=156;c.techBat=function(){H(38)};c.techBat.iconID=168;c.techGolem=function(){H(41)};c.techGolem.iconID=119;c.techInvisibility=function(){H(37)};c.techInvisibility.iconID=217;c.techLightning=function(){H(40)};c.techLightning.iconID=143;c.techFreeze=function(){H(39)};c.techFreeze.iconID=130;c.techHeroism=function(){H(22)};
c.techHeroism.iconID=136;c.techWarfare=function(){H(23)};c.techWarfare.iconID=108;c.techTactics=function(){H(24)};c.techTactics.iconID=257;c.techMercenaries=function(){H(25)};c.techMercenaries.iconID=95;c.techHeroes=function(){H(26)};c.techHeroes.iconID=96;c.techFame=function(){H(27)};c.techFame.iconID=111;c.techSiegeTactics=function(){H(28)};c.techSiegeTactics.iconID=258;c.techBodyBuilding=function(){H(29)};c.techBodyBuilding.iconID=101;c.createPriest=function(){V(9)};c.createPriest.iconID=155;c.createCow=
function(){V(27)};c.createCow.iconID=163;c.techCropRotation=function(){H(8)};c.techCropRotation.iconID=227;c.techDomestication=function(){H(7)};c.techDomestication.iconID=157;c.techMapMaking=function(){H(16)};c.techMapMaking.iconID=89;c.techTradeRoutes=function(){H(17)};c.techTradeRoutes.iconID=102;c.techTradeTaxes=function(){H(18)};c.techTradeTaxes.iconID=110;c.techUsury=function(){H(19)};c.techUsury.iconID=105;c.techSupplyStorage=function(){H(20)};c.techSupplyStorage.iconID=62;c.techBribery=function(){H(21)};
c.techBribery.iconID=109;c.bribe=function(){};c.bribe.iconID=128;c.createCaravan=function(){V(61)};c.createCaravan.iconID=169;c.createCaravan2=function(){V(90)};c.createCaravan2.iconID=134;c.createFootman2=function(){V(80)};c.createFootman2.iconID=49;c.createArcher2=function(){V(81)};c.createArcher2.iconID=43;c.createSatrap=function(){V(83)};c.createSatrap.iconID=116;c.createPikeman2=function(){V(82)};c.createPikeman2.iconID=42;c.createHorseArcher2=function(){V(85)};c.createHorseArcher2.iconID=124;
c.createCavalry=function(){V(84)};c.createCavalry.iconID=133;c.createEnichar=function(){V(91)};c.createEnichar.iconID=123;c.createJihad=function(){V(86)};c.createJihad.iconID=236;c.trade=function(){};c.trade.iconID=161;c.unload=function(){P=Ke};c.unload.iconID=148;c.createMercenaries=function(){oa(w[C[0]].mlist)};c.createMercenaries.iconID=95;c.createHeroes=function(){oa(w[C[0]].hlist)};c.createHeroes.iconID=96;c.upgradeGuildTower=function(){H(42)};c.upgradeGuildTower.iconID=171;c.upgradeStoneTower=
function(){H(43)};c.upgradeStoneTower.iconID=178;c.upgradeCannonTower=function(){H(44)};c.upgradeCannonTower.iconID=178;c.createCatapult=function(){V(37)};c.createCatapult.iconID=152;c.createHeavyCatapult=function(){V(39)};c.createHeavyCatapult.iconID=153;c.createBallist=function(){V(38)};c.createBallist.iconID=154;c.techEngineering=function(){H(47)};c.techEngineering.iconID=92;c.techCannonTower=function(){H(46)};c.techCannonTower.iconID=178;c.techPlateArmor=function(){H(10)};c.techPlateArmor.iconID=
131;c.techTemperIron=function(){H(4)};c.techTemperIron.iconID=266;c.techHalberd=function(){H(6)};c.techHalberd.iconID=113;c.techScaleArmor=function(){H(5)};c.techScaleArmor.iconID=251;c.techChainMail=function(){H(9)};c.techChainMail.iconID=252;c.techLongbow=function(){H(0)};c.techLongbow.iconID=259;c.techWoodCutting=function(){H(3)};c.techWoodCutting.iconID=107;c.techCrossbow=function(){H(11)};c.techCrossbow.iconID=112;c.createFishingBoat=function(){V(74)};c.createFishingBoat.iconID=48;c.createXebec=
function(){V(76)};c.createXebec.iconID=166;c.upgradeShip=function(){};c.upgradeShip.iconID=268;c.fishing=function(){};c.fishing.iconID=41;c.createHulk=function(){V(75)};c.createHulk.iconID=165;c.createGalleon=function(){V(73)};c.createGalleon.iconID=164;c.techLandingTactics=function(){};c.techLandingTactics.iconID=98;c.techConcentration=function(){H(58)};c.techConcentration.iconID=75;c.techConfusion=function(){H(59)};c.techConfusion.iconID=76;c.techWhirlpool=function(){H(60)};c.techWhirlpool.iconID=
78;c.techDragon=function(){H(61)};c.techDragon.iconID=115;c.techTurnToStone=function(){H(62)};c.techTurnToStone.iconID=77;c.techFlameBolt=function(){H(63)};c.techFlameBolt.iconID=25;c.techJewelry=function(){H(64)};c.techJewelry.iconID=230;c.techBanking=function(){H(65)};c.techBanking.iconID=74;c.techChemistry=function(){H(66)};c.techChemistry.iconID=225;c.techSeaFood=function(){H(67)};c.techSeaFood.iconID=67;c.techGunPowder=function(){H(68)};c.techGunPowder.iconID=212;c.techRocketArrow=function(){H(69)};
c.techRocketArrow.iconID=47;c.techBushido=function(){H(70)};c.techBushido.iconID=60;c.techLeadership=function(){H(71)};c.techLeadership.iconID=114;c.techHonor=function(){H(72)};c.techHonor.iconID=94;c.techSunTzu=function(){H(73)};c.techSunTzu.iconID=66;c.createRonin=function(){V(66)};c.createRonin.iconID=54;c.createArcher1=function(){V(67)};c.createArcher1.iconID=53;c.createSamurai=function(){V(68)};c.createSamurai.iconID=122;c.createHorseArcher1=function(){V(69)};c.createHorseArcher1.iconID=52;c.createMonk=
function(){V(128)};c.createMonk.iconID=45;c.createMage1=function(){V(129)};c.createMage1.iconID=50;c.createPriest1=function(){V(127)};c.createPriest1.iconID=44;c.createPriest2=function(){V(87)};c.createPriest2.iconID=125;c.buyItems=function(){};c.buyItems.iconID=31;c.sellItems=function(){};c.sellItems.iconID=30;c.createHorseSamurai=function(){V(70)};c.createHorseSamurai.iconID=121;c.createChariot=function(){V(72)};c.createChariot.iconID=79;c.stopTech=function(){I(kg,0,C)};c.stopTech.iconID=160;c.repair=
function(){P=uc};c.repair.iconID=145;c.conquest=function(){};c.conquest.iconID=249;c.dcm=function(){P=tc};c.dcm.iconID=260;c.buildBarrack=function(){Q(14)};c.buildBarrack.iconID=205;c.buildBarrack1=function(){Q(71)};c.buildBarrack1.iconID=205;c.buildBarrack2=function(){Q(102)};c.buildBarrack2.iconID=205;c.buildTower=function(){Q(32)};c.buildTower.iconID=170;c.buildStorage=function(){Q(18)};c.buildStorage.iconID=200;c.buildLumbermill=function(){Q(15)};c.buildLumbermill.iconID=199;c.buildLumbermill2=
function(){Q(93)};c.buildLumbermill2.iconID=199;c.buildFields=function(){Q(20)};c.buildFields.iconID=265;c.buildCastle=function(){Q(12)};c.buildCastle.iconID=206;c.buildCastle1=function(){Q(62)};c.buildCastle1.iconID=206;c.buildCastle2=function(){Q(63)};c.buildCastle2.iconID=206;c.buildAcademy=function(){Q(17)};c.buildAcademy.iconID=204;c.buildCathedral=function(){Q(11)};c.buildCathedral.iconID=191;c.buildCathedral2=function(){Q(106)};c.buildCathedral2.iconID=189;c.buildMerchands=function(){Q(24)};
c.buildMerchands.iconID=198;c.buildMerchands2=function(){Q(108)};c.buildMerchands2.iconID=198;c.buildChurch=function(){Q(25)};c.buildChurch.iconID=197;c.buildMarket=function(){Q(33)};c.buildMarket.iconID=194;c.buildMageTower=function(){Q(16)};c.buildMageTower.iconID=192;c.buildMageTower2=function(){Q(107)};c.buildMageTower2.iconID=192;c.buildDummy=function(){Q(36)};c.buildDummy.iconID=65;c.buildFarm=function(){Q(23)};c.buildFarm.iconID=193;c.buildBlacksmith=function(){Q(26)};c.buildBlacksmith.iconID=
202;c.buildWorkshop=function(){Q(29)};c.buildWorkshop.iconID=201;c.buildWorkshop2=function(){Q(98)};c.buildWorkshop2.iconID=201;c.buildStable=function(){Q(28)};c.buildStable.iconID=196;c.buildStable2=function(){Q(103)};c.buildStable2.iconID=196;c.buildTavern=function(){Q(30)};c.buildTavern.iconID=208;c.buildHouse=function(){Q(31)};c.buildHouse.iconID=195;c.buildHarbor=function(){Q(41)};c.buildHarbor.iconID=188;c.buildOutpost=function(){Q(34)};c.buildOutpost.iconID=158;c.buildWoodWall=function(){Q(13)};
c.buildWoodWall.iconID=210;c.buildWoodGate=function(){};c.buildWoodGate.iconID=209;c.buildWoodGate.disabled=2;c.buildBridge=function(){Q(35)};c.buildBridge.iconID=176;lh="freeze invisibility lightning turnToStone bless healing".split(" ");c.freeze=function(){P=Xe};c.freeze.iconID=99;c.freeze.obj={name:t.freeze};c.freeze.iconIDbook=205;c.confusion=function(){P=Ye};c.confusion.iconID=76;c.confusion.obj={name:"Confusion",spcost:[120,0,0,0]};c.confusion.iconIDbook=206;c.turnToStone=function(){P=Dg};c.turnToStone.iconID=
77;c.turnToStone.iconIDbook=213;c.turnToStone.obj={name:"Turn to Stone",spcost:[40,0,0,0]};c.whirlpool=function(){P=ti};c.whirlpool.iconID=78;c.whirlpool.iconIDbook=214;c.whirlpool.obj={name:"Whirlpool",spcost:[80,0,0,0]};c.flameBolt=function(){P=Ue};c.flameBolt.iconID=25;c.flameBolt.obj={name:"Flame Bolt",spcost:[120,0,0,0]};c.flameBolt.iconIDbook=216;c.createDragon=function(){P=Ne};c.createDragon.iconID=115;c.createDragon.obj={name:"Spawn Dragon",spcost:[320,0,0,0]};c.createDragon.iconIDbook=215;
c.lightning=function(){P=Jg};c.lightning.iconID=263;c.lightning.obj={name:t.lightning,spcost:[80,0,0,0]};c.lightning.iconIDbook=200;c.createBat=function(){P=Oe};c.createBat.iconID=168;c.createBat.iconIDbook=203;c.createGolem=function(){P=Le};c.createGolem.iconID=119;c.createGolem.iconIDbook=209;c.autoInvisibility=function(){P=Te};c.autoInvisibility.iconID=217;c.autoInvisibility.obj={name:t.invisibility};c.invisibility=function(){P=Te};c.invisibility.iconID=217;c.invisibility.iconIDbook=208;c.impersonate=
function(){P=Gg};c.impersonate.iconID=32;c.impersonate.obj={name:"Impersonate"};c.revealSelf=function(){I(wi,C[0],0)};c.revealSelf.iconID=33;c.revealSelf.obj={name:"Reveal your true self"};c.buildHouse1=function(){Q(111)};c.buildHouse1.iconID=195;c.buildHouse2=function(){Q(92)};c.buildHouse2.iconID=195;c.buildLumbermill1=function(){Q(112)};c.buildLumbermill1.iconID=199;c.buildStorage1=function(){Q(113)};c.buildStorage1.iconID=200;c.buildStorage2=function(){Q(94)};c.buildStorage2.iconID=200;c.buildFarm1=
function(){Q(114)};c.buildFarm1.iconID=193;c.buildFarm2=function(){Q(95)};c.buildFarm2.iconID=193;c.buildHarbor1=function(){Q(115)};c.buildHarbor1.iconID=188;c.buildHarbor2=function(){Q(96)};c.buildHarbor2.iconID=188;c.buildBlacksmith1=function(){Q(116)};c.buildBlacksmith1.iconID=202;c.buildBlacksmith2=function(){Q(97)};c.buildBlacksmith2.iconID=202;c.buildWorkshop1=function(){Q(117)};c.buildWorkshop1.iconID=201;c.buildChurch1=function(){Q(118)};c.buildChurch1.iconID=197;c.buildChurch2=function(){Q(99)};
c.buildChurch2.iconID=197;c.buildTavern1=function(){Q(119)};c.buildTavern1.iconID=208;c.buildTavern2=function(){Q(100)};c.buildTavern2.iconID=208;c.buildMarket1=function(){Q(120)};c.buildMarket1.iconID=194;c.buildMarket2=function(){Q(101)};c.buildMarket2.iconID=194;c.buildStable1=function(){Q(121)};c.buildStable1.iconID=196;c.buildOutpost1=function(){Q(122)};c.buildOutpost1.iconID=158;c.buildOutpost2=function(){Q(104)};c.buildOutpost2.iconID=158;c.buildCathedral1=function(){Q(123)};c.buildCathedral1.iconID=
190;c.buildMageTower1=function(){Q(124)};c.buildMageTower1.iconID=192;c.createObjects=function(){bf("magicworkshopmenu",ea)};c.createObjects.iconID=20;c.createObjects.obj={};c.buildMagicWorkshop=function(){Q(110)};c.buildMagicWorkshop.iconID=46;c.buildMerchands1=function(){Q(125)};c.buildMerchands1.iconID=198;c.buildAcademy1=function(){Q(126)};c.buildAcademy1.iconID=204;c.buildAcademy2=function(){Q(109)};c.buildAcademy2.iconID=204;c.buildRocketTower=function(){Q(57)};c.buildRocketTower.iconID=47;
c.murder=function(){};c.murder.iconID=28;c.convertJihad=function(){I(oi,86,C)};c.convertJihad.iconID=236;c.convertJihad.obj={};c.menuCommonBuild2=function(){oa(zf)};c.menuCommonBuild2.iconID=17;zf=[c.buildFarm2,c.buildBlacksmith2,c.buildWorkshop2,c.buildStable2,c.buildTavern2,c.buildHouse2];zf.menuName="a_build";c.menuCommonBuild2.xtra=zf;c.menuSpecialBuild2=function(){oa(Af)};c.menuSpecialBuild2.iconID=15;Af=[c.buildCastle2,c.buildAcademy2,c.buildCathedral2,c.buildMerchands2,c.buildChurch2,c.buildMarket2,
c.buildMageTower2,c.buildMagicWorkshop];Af.menuName="a_build";c.menuSpecialBuild2.xtra=Af;c.menuOtherBuild2=function(){oa(Bf)};c.menuOtherBuild2.iconID=16;Bf=[c.buildHarbor2,c.buildOutpost2,c.buildWoodWall,c.buildWoodGate,c.buildBridge];Bf.menuName="e_build";c.menuOtherBuild2.xtra=Bf;c.menuBuilds2=function(){oa(Cf)};c.menuBuilds2.iconID=245;Cf=[c.menuSpecialBuild2,c.menuCommonBuild2,c.menuOtherBuild2,c.buildBarrack2,c.buildTower,c.buildStorage2,c.buildLumbermill2,c.buildFields];Cf.menuName="a_build";
c.menuBuilds2.xtra=Cf;c.origin=Ql;c.origin.iconID=255;c.createCarpet=function(){P=Qe};c.createCarpet.iconID=146;c.createCarpet.iconIDbook=202;c.createJinn=function(){P=Pe};c.createJinn.iconID=118;c.createJinn.iconIDbook=218;c.magicVision=function(){};c.magicVision.iconID=223;c.magicVision.iconIDbook=210;c.fireRain=function(){P=Ze};c.fireRain.iconID=264;c.fireRain.iconIDbook=199;c.raiseDead=function(){P=We};c.raiseDead.iconID=87;c.raiseDead.iconIDbook=211;c.createMage2=function(){V(89)};c.createMage2.iconID=
126;c.techCowPoaching=function(){H(74)};c.techCowPoaching.iconID=85;c.techHorseManShip=function(){H(75)};c.techHorseManShip.iconID=231;c.techScimitar=function(){H(76)};c.techScimitar.iconID=84;c.techJihad=function(){H(77)};c.techJihad.iconID=236;c.techCarpet=function(){H(78)};c.techCarpet.iconID=146;c.techMagicWorkshop=function(){H(79)};c.techMagicWorkshop.iconID=86;c.techFireRain=function(){H(80)};c.techFireRain.iconID=264;c.techMagicVision=function(){H(81)};c.techMagicVision.iconID=224;c.techNecromancy=
function(){H(82)};c.techNecromancy.iconID=87;c.techJinn=function(){H(83)};c.techJinn.iconID=118;c.techOreFloatation=function(){H(84)};c.techOreFloatation.iconID=106;c.techRiddingHorses=function(){H(85)};c.techRiddingHorses.iconID=232;c.techJanissary=function(){H(86)};c.techJanissary.iconID=81;c.buildMagicItems=function(){};c.buildMagicItems.iconID=20;c.techSlavery=function(){H(87)};c.techSlavery.iconID=135;c.stopBuilding=function(){I(af,0,C)};c.stopBuilding.iconID=160;c.menuSpecialBuild1=function(){oa(rf)};
c.menuSpecialBuild1.iconID=15;rf=[c.buildCastle1,c.buildAcademy1,c.buildCathedral1,c.buildMerchands1,c.buildChurch1,c.buildMarket1,c.buildMageTower1,c.buildRocketTower,c.buildDummy];rf.menuName="a_build";c.menuSpecialBuild1.xtra=rf;c.menuCommonBuild1=function(){oa(sf)};c.menuCommonBuild1.iconID=17;sf=[c.buildFarm1,c.buildBlacksmith1,c.buildWorkshop1,c.buildStable1,c.buildTavern1,c.buildHouse1];sf.menuName="a_build";c.menuCommonBuild1.xtra=sf;c.menuSpecialBuild=function(){oa(tf)};c.menuSpecialBuild.iconID=
15;tf=[c.buildCastle,c.buildAcademy,c.buildCathedral,c.buildMerchands,c.buildChurch,c.buildMarket,c.buildMageTower,c.buildDummy];tf.menuName="e_build";c.menuSpecialBuild.xtra=tf;c.menuCommonBuild=function(){oa(uf)};c.menuCommonBuild.iconID=17;uf=[c.buildFarm,c.buildBlacksmith,c.buildWorkshop,c.buildStable,c.buildTavern,c.buildHouse];uf.menuName="e_build";c.menuCommonBuild.xtra=uf;c.menuOtherBuild=function(){oa(vf)};c.menuOtherBuild.iconID=16;vf=[c.buildHarbor,c.buildOutpost,c.buildWoodWall,c.buildWoodGate,
c.buildBridge];vf.menuName="e_build";c.menuOtherBuild.xtra=vf;c.menuOtherBuild1=function(){oa(wf)};c.menuOtherBuild1.iconID=16;wf=[c.buildHarbor1,c.buildOutpost1,c.buildWoodWall,c.buildWoodGate,c.buildBridge];wf.menuName="e_build";c.menuOtherBuild1.xtra=wf;c.menuBuilds=function(){oa(xf)};xf=[c.menuSpecialBuild,c.menuCommonBuild,c.menuOtherBuild,c.buildBarrack,c.buildTower,c.buildStorage,c.buildLumbermill,c.buildFields];xf.menuName="e_build";c.menuBuilds.iconID=245;c.menuBuilds.xtra=xf;c.menuBuilds1=
function(){oa(yf)};c.menuBuilds1.iconID=245;yf=[c.menuSpecialBuild1,c.menuCommonBuild1,c.menuOtherBuild1,c.buildBarrack1,c.buildTower,c.buildStorage1,c.buildLumbermill1,c.buildFields];yf.menuName="a_build";c.menuBuilds1.xtra=yf;Hl=function(){c.fishing.obj={};c.impersonate.obj={};c.techGreatWall.obj=F[48];c.revealSelf.obj={};c.trade.obj={};c.unload.obj={};c.mercFootman6.obj={};c.murder.obj={};c.mercArcher6.obj={};c.mercMaceman6.obj={};c.mercPikeman6.obj={};c.mercLongbowman6.obj={};c.sameSpeed.obj=
{name:"Same speed"};c.restoreSpeed.obj={name:"Restore speed"};c.mercKnight6.obj={};c.attackGround.obj={};c.steady.obj={};c.bribe.obj={};c.createPriest1.obj=B[127];c.createPriest2.obj=B[87];c.createFootman2.obj=B[80];c.createArcher2.obj=B[81];c.createSatrap.obj=B[83];c.createPikeman2.obj=B[82];c.createHorseArcher2.obj=B[85];c.createCavalry.obj=B[84];c.createEnichar.obj=B[91];c.createJihad.obj=B[86];c.createMonk.obj=B[128];c.healing.obj={name:t.heal,spcost:[20,0,0,0]};c.bless.obj={name:t.bless,spcost:[20,
0,0,0]};c.stopTech.obj={};c.conquest.obj={};c.dcm.obj={name:t.dcm};c.repair.obj={name:t.repair};c.menuOtherBuild.obj={};c.menuOtherBuild1.obj={};c.menuOtherBuild2.obj={};c.sellItems.obj={};c.buyItems.obj={};c.menuBuilds.obj={name:t.menuBuild};c.menuCommonBuild.obj={};c.menuSpecialBuild.obj={};c.techMastery.obj=F[57];c.techNinjas.obj=F[56];c.teach.obj={name:"Teach",spcost:[20,0,0,0]};c.techPhilosophy.obj=F[55];c.techKungFu.obj=F[53];c.techTournaments.obj=F[54];c.techMeditation.obj=F[52];c.menuCommonBuild1.obj=
{};c.menuCommonBuild2.obj={};c.createMage1.obj=B[129];c.menuSpecialBuild1.obj={};c.menuSpecialBuild2.obj={};c.menuBuilds1.obj={name:t.menuBuild};c.menuBuilds2.obj={name:t.menuBuild};c.stopBuilding.obj={};c.freeze.obj={name:t.freeze,spcost:[200,0,0,0]};c.invisibility.obj={name:t.invisibility,spcost:[40,0,0,0]};c.autoInvisibility.obj={name:t.invisibility};c.createHeroes.obj={};c.createMercenaries.obj={};c.upgradeShip.obj={};c.techMedicine.obj=F[35];c.techBless.obj=F[36];c.buildHouse1.obj=B[111];c.techHealing.obj=
F[34];c.techInquisition.obj=F[33];c.techArmoredChariot.obj=F[51];c.techRocketArrow.obj=F[69];c.techJewelry.obj=F[64];c.techGunPowder.obj=F[68];c.techSeaFood.obj=F[67];c.techChemistry.obj=F[66];c.techBanking.obj=F[65];c.createMage.obj=B[5];c.techBat.obj=F[38];c.techGolem.obj=F[41];c.techInvisibility.obj=F[37];c.techLightning.obj=F[40];c.techFreeze.obj=F[39];c.techHeroism.obj=F[22];c.createHorseSamurai.obj=B[70];c.createChariot.obj=B[72];c.createHorseArcher1.obj=B[69];c.createHorseArcher2.obj=B[85];
c.createSamurai.obj=B[68];c.createArcher1.obj=B[67];c.techConfusion.obj=F[59];c.techConcentration.obj=F[58];c.techWhirlpool.obj=F[60];c.techDragon.obj=F[61];c.techTurnToStone.obj=F[62];c.techFlameBolt.obj=F[63];c.createRonin.obj=B[66];c.buildStorage.obj=B[18];c.buildStorage1.obj=B[113];c.buildStorage2.obj=B[94];c.buildFields.obj=B[20];c.buildLumbermill.obj=B[15];c.buildLumbermill1.obj=B[112];c.buildLumbermill2.obj=B[93];c.buildTower.obj=B[32];c.buildBarrack1.obj=B[71];c.buildBarrack.obj=B[14];c.buildBarrack2.obj=
B[102];c.buildDummy.obj=B[36];c.buildRocketTower.obj=B[57];c.buildMageTower.obj=B[16];c.buildMageTower1.obj=B[124];c.buildMageTower2.obj=B[107];c.buildMarket.obj=B[33];c.buildMarket1.obj=B[120];c.buildMarket2.obj=B[101];c.buildChurch.obj=B[25];c.buildChurch1.obj=B[118];c.buildChurch2.obj=B[99];c.buildMerchands.obj=B[24];c.irrigation.obj=F[50];c.ridingHorses.obj=F[49];c.buildMerchands1.obj=B[125];c.buildMerchands2.obj=B[108];c.buildCathedral.obj=B[11];c.buildCathedral1.obj=B[123];c.buildCathedral2.obj=
B[106];c.buildAcademy.obj=B[17];c.buildAcademy1.obj=B[126];c.buildAcademy2.obj=B[109];c.buildCastle.obj=B[12];c.magicVision.obj={name:"Magic Vision",spcost:[20,0,0,0]};c.fireRain.obj={name:"Fire Rain",spcost:[200,0,0,0]};c.raiseDead.obj={name:"Raise the Dead",spcost:[40,0,0,0]};c.createJinn.obj={name:"Spawn Jinn",spcost:[320,0,0,0]};c.createCarpet.obj={name:"Spawn Magic Carpet",spcost:[320,0,0,0]};c.buildCastle1.obj=B[62];c.buildCastle2.obj=B[63];c.buildHouse.obj=B[31];c.buildHouse2.obj=B[92];c.buildTavern.obj=
B[30];c.buildTavern1.obj=B[119];c.buildTavern2.obj=B[100];c.buildStable.obj=B[28];c.buildStable1.obj=B[121];c.buildStable2.obj=B[103];c.buildFarm.obj=B[23];c.buildFarm1.obj=B[114];c.buildFarm2.obj=B[95];c.buildWorkshop.obj=B[29];c.buildWorkshop1.obj=B[117];c.buildWorkshop2.obj=B[98];c.buildBlacksmith.obj=B[26];c.buildBlacksmith1.obj=B[116];c.buildBlacksmith2.obj=B[97];c.buildBridge.obj=B[35];c.buildHarbor.obj=B[41];c.buildHarbor1.obj=B[115];c.buildHarbor2.obj=B[96];c.createMage2.obj=B[89];c.buildMagicItems.obj=
{};c.techJanissary.obj=F[86];c.techRiddingHorses.obj=F[85];c.techOreFloatation.obj=F[84];c.techJinn.obj=F[83];c.techNecromancy.obj=F[82];c.techMagicVision.obj=F[81];c.techFireRain.obj=F[80];c.techMagicWorkshop.obj=F[79];c.techCarpet.obj=F[78];c.techJihad.obj=F[77];c.techScimitar.obj=F[76];c.techHorseManShip.obj=F[75];c.techCowPoaching.obj=F[74];c.buildWoodGate.obj={};c.buildWoodWall.obj=B[13];c.buildOutpost.obj=B[34];c.buildOutpost1.obj=B[122];c.buildOutpost2.obj=B[104];c.createGolem.obj={name:"Spawn Stone Golem",
spcost:[480,0,0,0]};c.techSunTzu.obj=F[73];c.techBushido.obj=F[70];c.techLeadership.obj=F[71];c.techHonor.obj=F[72];c.createBat.obj={name:"Spawn Bat",spcost:[40,0,0,0]};c.techGoldMining.obj=F[1];c.techStoneMining.obj=F[2];c.emergeAllUnits.obj={};c.origin.obj={name:"Origin"};c.createOrk.obj=B[58];c.createDwarf.obj=B[59];c.createSkeleton.obj=B[60];c.createGhost.obj=B[40];c.createFootman.obj=B[0];c.createArcher.obj=B[4];c.techSlavery.obj=F[87];c.createMaceman.obj=B[3];c.createPikeman.obj=B[1];c.createLongbowman.obj=
B[6];c.createKnight.obj=B[19];c.mercFootman.obj=d;c.mercArcher.obj=d;c.mercMaceman.obj=d;c.mercPikeman.obj=d;c.mercLongbowman.obj=d;c.mercKnight.obj=d;c.createPeon.obj=B[10];c.createSpy.obj=B[2];c.techFeudalism.obj=F[12];c.techArchitecture.obj=F[13];c.techLearning.obj=F[14];c.createPeon1.obj=B[64];c.createPeon2.obj=B[79];c.createNinja.obj=B[65];c.techBuddhism.obj=F[45];c.createCrusaders.obj={name:"Preach a crusade",cost:[1E3,0,2E3,0]};c.buildMagicWorkshop.obj=B[110];c.techFanaticism.obj=F[31];c.techCrusade.obj=
F[32];c.techEspionage.obj=F[30];c.techChainMail.obj=F[9];c.techHalberd.obj=F[6];c.techLongbow.obj=F[0];c.techScaleArmor.obj=F[5];c.techTemperIron.obj=F[4];c.techPlateArmor.obj=F[10];c.techLandingTactics.obj={};c.createGalleon.obj=B[73];c.createHulk.obj=B[75];c.createXebec.obj=B[76];c.createFishingBoat.obj=B[74];c.techCrossbow.obj=F[11];c.techWoodCutting.obj=F[3];c.techCannonTower.obj=F[46];c.techEngineering.obj=F[47];c.createBallist.obj=B[38];c.createHeavyCatapult.obj=B[39];c.createCatapult.obj=B[37];
c.upgradeCannonTower.obj=F[44];c.upgradeStoneTower.obj=F[43];c.upgradeGuildTower.obj=F[42];c.createCaravan.obj=B[61];c.createCaravan2.obj=B[90];c.techBribery.obj=F[21];c.techSupplyStorage.obj=F[20];c.techUsury.obj=F[19];c.techCropRotation.obj=F[8];c.createCow.obj=B[27];c.techDomestication.obj=F[7];c.techTradeTaxes.obj=F[18];c.techTradeRoutes.obj=F[17];c.techMapMaking.obj=F[16];c.createPriest.obj=B[9];c.techBodyBuilding.obj=F[29];c.techSiegeTactics.obj=F[28];c.techFame.obj=F[27];c.techHeroes.obj=F[26];
c.techMercenaries.obj=F[25];c.techTactics.obj=F[24];c.techWarfare.obj=F[23];for(var b=Object.keys(c),f=0,e=b.length;f<e;f++){var h=c[b[f]];h.objName=b[f];h.obj&&(h.obj.nu=h)}}},ph=function(d,b){var c=b.length,e=d.length,h=0;a:for(;h<c;h++){for(var g=0;g<e;g++)if(b[h+g]!==d[g])continue a;return h}return!1},km=function(d){for(var b=d.length,c=new Uint16Array(d.length),e=0;e<b;e++)c[e]=d.charCodeAt(e);return c},Ec=function(d,b){return ph(km(d),b)+d.length},qh=function(d,b){d+=String.fromCharCode(0);
return ph(km(d),b)},rj=function(d,b,c){var e="";for(b+=d;d<b&&c[d];d++)e+=String.fromCharCode(c[d]);return e},Jf=function(d){d=new Uint8Array(d);var b=ph([50,109,122,116],d)+6,c=d[b]+256*d[b+1],e=d[b+2]+(d[b+3]<<8)+(d[b+4]<<16);T("mapx:",c,"units",e);T("header",d[Ec(".header",d)],"description",d[Ec(".description",d)],"kingdominfo",d[Ec(".kingdominfo",d)],"diplomacy",d[Ec(".diplomacy",d)],"forbidden.upgrades",d[Ec(".forbidden.upgrades",d)],"tiles",d[Ec(".tiles",d)]);T(d);b=2*c;c={mapx:c,mapy:c,arje:!1};
var h="utype xx56 xx2 xx562 type xx3 xxtra x32 y32 kingdom race id d health maxHealth attack defence xx8 level xx9 resistance xx11 mana xx12".split(" "),g="utype xx56 xx2 xx562 type xx3 xxtra x32 y32 kingdom race id d health maxHealth attack defence xx8 level xx9 resistance xx11 mana xx12 xx13 xx14 xx15 xx16 xx17 xx18 xx19 xx20 xx21 resource".split(" "),k=b/2,l=20480+2*k*k,m={};k=0;for(var p=d.length;k<p;k++){var q=d[k];m[q]||(m[q]=[]);m[q].push(k)}m=[];var r={56:!0,58:!0,88:!0,72:!0};k=l+1;for(p=
d.length;k<p;k++)if(q=d[k],r[q]&&r[d[k+4]]){l={};q=72!==q?h:g;for(var t=k-2,v=0,w=q.length;v<w;v++){var x=q[v];"kingdom"==x||"race"==x?(l[x]=d[t],t++):(l[x]=d[t]+256*d[t+1],t+=2)}k+=2*w-3;m.push(l)}c.allunits=m;c.allunits.length>e&&(c.allunits.length=e);e=c.allunits;b/=2;m=[];h=0;r=[];q=l=d[Ec(".forbidden.upgrades",d)]+1;k=l*=512;for(g=d.length;k<g;k+=2){v=d[k];t=~~(k/512);for(p=8;p<b&&d[p+k]===(v+p/4)%256;p+=4);20<p&&(k=512*t,1==m.length&&(k=512*(t-(2-(t-q)%2))),p=d.slice(l,k),l-k&&(m[h++]=[l,k],
r.push(p)),k+=512,2==m.length&&(k-=512),l=k)}m[h++]=[l,d.length];r={64:[m[0]],96:[m[0]],128:[m[0]],192:[m[1],m[0],m[2],m[3]],256:[m[1],m[0],m[2],m[3]],384:[m[1],m[0],m[2],m[3],m[4],m[5],m[6]],512:[m[1],m[0],m[2],m[3],m[4],m[5],m[6],m[7],m[8],m[9]]}[b];T(m);m=new Uint8Array(b*b);l=new Uint8Array(b*b);p=h=0;for(q=r.length;p<q;p++)if(g=r[p],h<b*b)for(k=g[0],g=g[1];k<g;k+=2)m[h]=ao[d[k]]||0,l[h]=d[k+1],10<l[h]&&e.push({type:7,d:l[h]%31,x32:h%b,y32:~~(h/b)}),h++;c.terrain=m;e=(b="grass",qh("grass",d))||
(b="summer",qh("summer",d))||(b="desert",qh("desert",d))||(b="snow",qh("snow",d));if("summer"==b||b)if("summer"==b||"desert"==b)b="grass";h=rj(512*(d[Ec(".description",d)]-1),512,d);c.description=h;c.author=rj(e-64,64,d);c.name=rj(e-128,64,d);c.terrainType=b;c.kingdoms=Jf.getKingdoms(d,c);Jf.getDiplomacy(d,c.kingdoms);T(c);return c};Jf.getKingdoms=function(d,b){for(var c=ph([192,4],d)+50;!d[c];)c++;var e="name tzar active resGold resStone resFood resWood x6 race x8 x9 x10 x11 x12 x13 x14 AI x16 x17 x18 x19 x20".split(" "),
h=e.length,g=[],k,l=[[0,0,189],[206,25,25],[49,181,0],[173,0,197],[255,222,0],[0,181,181],[255,156,33],[90,90,90]];T("kingdoms:",c);b.tr={0:0,9:0,10:0};for(var m=0;8>m;m++){for(var p={color:l[m]},q=!0,r=0;r<h;r++){var t=e[r];if("name"==t||"tzar"==t){for(p[t]="";!d[c];)c++;for(k=c+32;d[c];)p[t]+=String.fromCharCode(d[c]),c++;c=k}else p[t]=d[c]+(d[c+1]<<8)+(d[c+2]<<16)+(d[c+3]<<24),"race"==t&&(p[t]=d[c],p.racestr=Rg[d[c]-1]),2!=r||d[c]||(q=!1),c+=4}q&&(g.push(p),b.tr[m+1]=g.length);1<g.length&&(p.IA=
1);p.resources=[p.resGold,p.resWood,p.resFood,p.resStone];p.race--}T(g);return g};Jf.getDiplomacy=function(d,b){for(var c=512*(d[Ec(".diplomacy",d)]-1),e=b.length,h=0;h<e;h++){var g=[0];if(b[h]){b[h].diplomacy=g;for(var k=1;9>k;k++){if(b[k-1]){var l=d[c];l=60>l&&k-1!=h?1:0;g.push(l)}c+=4}}else c+=32}};var ao={0:3,32:0,144:1,240:2,64:2},Ln={15:78,16:77,19:37,20:39,21:38,22:131,23:73,24:75,25:76,27:59,28:58,30:132,31:40,32:130,36:60,38:42,39:55,40:32,41:44,42:56,43:57,61:13,62:13,63:20,64:35,72:43,
110:27,133:36,136:74,257:10,258:61,259:0,260:4,261:3,262:6,263:1,264:19,267:8,270:2,273:5,274:9,300:12,301:14,302:15,303:23,304:30,305:25,306:28,307:18,308:34,309:33,310:41,311:11,312:17,314:26,315:29,316:16,321:24,322:31,513:79,514:90,515:80,516:81,517:83,519:82,522:85,529:89,530:87,541:91,545:86,547:84,556:63,557:102,558:93,559:95,560:100,561:99,562:103,563:94,564:104,565:101,566:96,568:109,570:97,571:98,572:107,577:108,578:92,581:110,583:106,769:64,771:66,772:67,773:68,778:69,780:128,781:65,785:129,
786:127,802:70,805:72,812:62,813:71,814:112,815:114,816:119,817:118,818:121,819:113,820:122,821:120,822:115,824:126,826:116,827:117,828:124,833:125,834:111,838:123,76:21,78:22},v="undefined"!==typeof v?v:{},Kf={},cd;for(cd in v)v.hasOwnProperty(cd)&&(Kf[cd]=v[cd]);v.arguments=[];v.thisProgram="./this.program";v.quit=function(d,b){throw b;};v.preRun=[];v.postRun=[];var fe=!1,ge=!1,sj=!1,lm=!1;fe="object"===typeof window;ge="function"===typeof importScripts;sj="object"===typeof process&&"function"===
typeof require&&!fe&&!ge;lm=!fe&&!sj&&!ge;var nc="";if(sj){nc=__dirname+"/";var tj,uj;v.read=function(d,b){tj||(tj=require("fs"));uj||(uj=require("path"));d=uj.normalize(d);d=tj.readFileSync(d);return b?d:d.toString()};v.readBinary=function(d){d=v.read(d,!0);d.buffer||(d=new Uint8Array(d));Bh(d.buffer);return d};1<process.argv.length&&(v.thisProgram=process.argv[1].replace(/\\/g,"/"));v.arguments=process.argv.slice(2);"undefined"!==typeof module&&(module.exports=v);process.on("uncaughtException",
function(d){if(!(d instanceof Hd))throw d;});process.on("unhandledRejection",function(d,b){process.exit(1)});v.quit=function(d){process.exit(d)};v.inspect=function(){return"[Emscripten Module object]"}}else if(lm)"undefined"!=typeof read&&(v.read=function(d){return read(d)}),v.readBinary=function(d){if("function"===typeof readbuffer)return new Uint8Array(readbuffer(d));d=read(d,"binary");Bh("object"===typeof d);return d},"undefined"!=typeof scriptArgs?v.arguments=scriptArgs:"undefined"!=typeof arguments&&
(v.arguments=arguments),"function"===typeof quit&&(v.quit=function(d){quit(d)});else if(fe||ge)fe?document.currentScript&&(nc=document.currentScript.src):nc=self.location.href,nc=0!==nc.indexOf("blob:")?nc.substr(0,nc.lastIndexOf("/")+1):"",v.read=function(d){var b=new XMLHttpRequest;b.open("GET",d,!1);b.send(null);return b.responseText},ge&&(v.readBinary=function(d){var b=new XMLHttpRequest;b.open("GET",d,!1);b.responseType="arraybuffer";b.send(null);return new Uint8Array(b.response)}),v.readAsync=
function(d,b,c){var e=new XMLHttpRequest;e.open("GET",d,!0);e.responseType="arraybuffer";e.onload=function(){200==e.status||0==e.status&&e.response?b(e.response):c()};e.onerror=c;e.send(null)},v.setWindowTitle=function(d){document.title=d};var Zj=v.print||("undefined"!==typeof console?console.log.bind(console):"undefined"!==typeof print?print:null),Yb=v.printErr||("undefined"!==typeof printErr?printErr:"undefined"!==typeof console&&console.warn.bind(console)||Zj);for(cd in Kf)Kf.hasOwnProperty(cd)&&
(v[cd]=Kf[cd]);Kf=void 0;var bo={"f64-rem":function(d,b){return d%b},"debugger":function(){debugger}},Gh=!1;"undefined"!==typeof TextDecoder&&new TextDecoder("utf8");"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");var Ch,Gc,Ad,vj,rh,wj,xj,he;var yj=Ad=vj=rh=wj=xj=he=0;v.reallocBuffer||(v.reallocBuffer=function(d){try{var b=Ch;var c=new ArrayBuffer(d);(new Int8Array(c)).set(b)}catch(e){return!1}return co(c)?c:!1});try{var mm=Function.prototype.call.bind(Object.getOwnPropertyDescriptor(ArrayBuffer.prototype,
"byteLength").get);mm(new ArrayBuffer(4))}catch(d){mm=function(b){return b.byteLength}}var zj=v.TOTAL_STACK||5242880,xa=v.TOTAL_MEMORY||41943040;xa<zj&&Yb("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+xa+"! (TOTAL_STACK="+zj+")");if(v.buffer)var zb=v.buffer;else"object"===typeof WebAssembly&&"function"===typeof WebAssembly.Memory?(v.wasmMemory=new WebAssembly.Memory({initial:xa/65536}),zb=v.wasmMemory.buffer):zb=new ArrayBuffer(xa),v.buffer=zb;Eh();var Yj=[],Hh=[],Am=[],eo=[],Xj=[],Tf=!1,
hd=0,Aj=null,Lf=null;v.preloadedImages={};v.preloadedAudios={};(function(){function d(){try{if(v.wasmBinary)return new Uint8Array(v.wasmBinary);if(v.readBinary)return v.readBinary(h);throw"both async and sync fetching of the wasm failed";}catch(y){qe(y)}}function b(){return v.wasmBinary||!fe&&!ge||"function"!==typeof fetch?new Promise(function(b,c){b(d())}):fetch(h,{credentials:"same-origin"}).then(function(b){if(!b.ok)throw"failed to load wasm binary file at '"+h+"'";return b.arrayBuffer()}).catch(function(){return d()})}
function c(d,c,e){function f(b,d){l=b.exports;l.memory&&(b=l.memory,d=v.buffer,b.byteLength<d.byteLength&&Yb("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here"),d=new Int8Array(d),(new Int8Array(b)).set(d),v.buffer=zb=b,Eh());v.asm=l;v.usingWasm=!0;hd--;v.monitorRunDependencies&&v.monitorRunDependencies(hd);0==hd&&(null!==Aj&&(clearInterval(Aj),Aj=null),Lf&&(b=Lf,Lf=null,b()))}function g(b){f(b.instance,b.module)}function m(d){b().then(function(b){return WebAssembly.instantiate(b,
k)}).then(d).catch(function(b){Yb("failed to asynchronously prepare wasm: "+b);qe(b)})}if("object"!==typeof WebAssembly)return Yb("no native wasm support detected"),!1;if(!(v.wasmMemory instanceof WebAssembly.Memory))return Yb("no native wasm Memory in use"),!1;c.memory=v.wasmMemory;k.global={NaN:NaN,Infinity:Infinity};k["global.Math"]=Math;k.env=c;hd++;v.monitorRunDependencies&&v.monitorRunDependencies(hd);if(v.instantiateWasm)try{return v.instantiateWasm(k,f)}catch(Sb){return Yb("Module.instantiateWasm callback failed with error: "+
Sb),!1}v.wasmBinary||"function"!==typeof WebAssembly.instantiateStreaming||Sf(h)||"function"!==typeof fetch?m(g):WebAssembly.instantiateStreaming(fetch(h,{credentials:"same-origin"}),k).then(g).catch(function(b){Yb("wasm streaming compile failed: "+b);Yb("falling back to ArrayBuffer instantiation");m(g)});return{}}var e="a.out.wast",h="a.out.wasm",g="a.out.temp.asm.js";Sf(e)||(e=le(e));Sf(h)||(h=le(h));Sf(g)||(g=le(g));var k={global:null,env:null,asm2wasm:bo,parent:v},l=null;v.asmPreload=v.asm;var m=
v.reallocBuffer;v.reallocBuffer=function(b){if("asmjs"===p)var d=m(b);else a:{b=Dh(b,v.usingWasm?65536:16777216);var c=v.buffer.byteLength;if(v.usingWasm)try{d=-1!==v.wasmMemory.grow((b-c)/65536)?v.buffer=v.wasmMemory.buffer:null;break a}catch(R){d=null;break a}d=void 0}return d};var p="";v.asm=function(b,d,e){if(!d.table){var f=v.wasmTableSize;void 0===f&&(f=1024);var g=v.wasmMaxTableSize;d.table="object"===typeof WebAssembly&&"function"===typeof WebAssembly.Table?void 0!==g?new WebAssembly.Table({initial:f,
maximum:g,element:"anyfunc"}):new WebAssembly.Table({initial:f,element:"anyfunc"}):Array(f);v.wasmTable=d.table}d.memoryBase||(d.memoryBase=v.STATIC_BASE);d.tableBase||(d.tableBase=0);b=c(b,d,e);Bh(b,"no binaryen method succeeded.");return b}})();yj=1024;Ad=yj+1605792;Hh.push();v.STATIC_BASE=yj;v.STATIC_BUMP=1605792;Ad+=16;he=function(d){var b=Ad;Ad=Ad+d+15&-16;return b}(4);vj=rh=Tj(Ad);wj=vj+zj;xj=Tj(wj);Gc[he>>2]=xj;v.wasmTableSize=0;v.wasmMaxTableSize=0;v.asmGlobalArg={};v.asmLibraryArg={enlargeMemory:function(){var d=
v.usingWasm?65536:16777216,b=2147483648-d;if(Gc[he>>2]>b)return!1;var c=xa;for(xa=Math.max(xa,16777216);xa<Gc[he>>2];)xa=536870912>=xa?Dh(2*xa,d):Math.min(Dh((3*xa+2147483648)/4,d),b);d=v.reallocBuffer(xa);if(!d||d.byteLength!=xa)return xa=c,!1;v.buffer=zb=d;Eh();return!0},getTotalMemory:function(){return xa},abortOnCannotGrowMemory:function(){qe("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+xa+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")},
___setErrNo:function(d){v.___errno_location&&(Gc[v.___errno_location()>>2]=d);return d},DYNAMICTOP_PTR:he,STACKTOP:rh};var nm=v.asm(v.asmGlobalArg,v.asmLibraryArg,zb);v.asm=nm;v.__Z10writeValuemm=function(){return v.asm.__Z10writeValuemm.apply(null,arguments)};v.__Z11setupRandomx=function(){return v.asm.__Z11setupRandomx.apply(null,arguments)};v.__Z11synchroHashv=function(){return v.asm.__Z11synchroHashv.apply(null,arguments)};v.__Z12unitMovementmb=function(){return v.asm.__Z12unitMovementmb.apply(null,
arguments)};v.__Z13randomTerrainll=function(){return v.asm.__Z13randomTerrainll.apply(null,arguments)};v.__Z14inspector71017llllml=function(){return v.asm.__Z14inspector71017llllml.apply(null,arguments)};v.__Z15createDiplomacyt=function(){return v.asm.__Z15createDiplomacyt.apply(null,arguments)};v.__Z3rndl=function(){return v.asm.__Z3rndl.apply(null,arguments)};v.__Z4testm=function(){return v.asm.__Z4testm.apply(null,arguments)};v.__Z5radarllll=function(){return v.asm.__Z5radarllll.apply(null,arguments)};
v.__Z6mapLocv=function(){return v.asm.__Z6mapLocv.apply(null,arguments)};v.__Z7newUnitt=function(){return v.asm.__Z7newUnitt.apply(null,arguments)};v.__Z8shapointv=function(){return v.asm.__Z8shapointv.apply(null,arguments)};v.__Z9createMapl=function(){return v.asm.__Z9createMapl.apply(null,arguments)};v.__Z9falseunitv=function(){return v.asm.__Z9falseunitv.apply(null,arguments)};v.__Z9readValuem=function(){return v.asm.__Z9readValuem.apply(null,arguments)};v.___errno_location=function(){return v.asm.___errno_location.apply(null,
arguments)};var co=v._emscripten_replace_memory=function(){return v.asm._emscripten_replace_memory.apply(null,arguments)};v._main=function(){return v.asm._main.apply(null,arguments)};var Vj=v.stackAlloc=function(){return v.asm.stackAlloc.apply(null,arguments)};v.asm=nm;Hd.prototype=Error();Hd.prototype.constructor=Hd;Lf=function b(){v.calledRun||Fh();v.calledRun||(Lf=b)};v.callMain=function(b){b=b||[];Tf||(Tf=!0,Gd(Hh));var c=b.length+1,e=Vj(4*(c+1));Gc[e>>2]=Uj(v.thisProgram);for(var h=1;h<c;h++)Gc[(e>>
2)+h]=Uj(b[h-1]);Gc[(e>>2)+c]=0;try{var g=v._main(c,e,0);if(!v.noExitRuntime||0!==g){if(!v.noExitRuntime&&(Gh=!0,rh=void 0,Gd(eo),v.onExit))v.onExit(g);v.quit(g,new Hd(g))}}catch(k){k instanceof Hd||("SimulateInfiniteLoop"==k?v.noExitRuntime=!0:((b=k)&&"object"===typeof k&&k.stack&&(b=[k,k.stack]),Yb("exception thrown: "+b),v.quit(1,k)))}finally{}};v.run=Fh;v.abort=qe;if(v.preInit)for("function"==typeof v.preInit&&(v.preInit=[v.preInit]);0<v.preInit.length;)v.preInit.pop()();var Wj=!0;v.noInitialRun&&
(Wj=!1);v.noExitRuntime=!0;Fh();var Qb={},mh=function(){for(var b=v.asm,c=Object.keys(b),e=c.length,h="createDiplomacy inspector71017 newUnit radar createMap falseunit synchroHash rnd setupRandom randomTerrain unitMovement test".split(" "),g=0,k=h.length;g<k;g++)for(var l=h[g],m=0;m<e;m++){var p=c[m];if(-1<p.indexOf(l)){Qb[h[g]]=b[p];break}}mh.waiting&&be()};mh.waiting=!1;v.postRun[0]=mh;var m=q("tzar").getContext("webgl2",{antialias:!0,alpha:!1});x.gl=!!m;var sh=window.indexedDB.open("nehhon"),Fc,
Bj;sh.onsuccess=function(b){Fc=sh.result;Bj&&Bj()};sh.onupgradeneeded=function(b){Fc=sh.result;Fc.createObjectStore("maps",{keyPath:"id",autoIncrement:!0});Fc.createObjectStore("mapsBlobs",{keyPath:"id2",autoIncrement:!0})};var Rn=function(b,c){var e=Fc.transaction(["maps"],"readwrite");b=e.objectStore("maps").add(b);b.onsuccess=function(){T("done")};e=Fc.transaction(["mapsBlobs"],"readwrite");b=e.objectStore("mapsBlobs").add(c);b.onsuccess=function(){T("done")}},om=function(){Fc?Fc.transaction(["maps"],
"readwrite").objectStore("maps").getAll().onsuccess=fo:Bj=om},fo=function(b){b=b.target.result;var c=b.length;if(c){var e=q("mapcache");e.innerHTML='<tr style="font-size:23px"><td>'+t.mapName+"</td><td>"+t.date+"</td><td>"+t.timePlayed+"</td></tr>";for(--c;-1<c;c--){var h=b[c],g=document.createElement("tr");g.cid=h.id;var k=new Date(h.date),l=k.getHours(),m="0"+k.getMinutes();k.getSeconds();var p=k.getDate(),v=k.getMonth()+1;k=k.getFullYear();l=l+":"+m.substr(-2)+" &nbsp; &nbsp;"+p+"/"+v+"/"+k;g.onclick=
Cj;g.innerHTML="<td>"+(h.name||"savegame")+"</td><td>"+l+"</td><td>"+wk(h.played)+"</td>";e.appendChild(g)}T(b)}},Cj=function(){var b=this.cid;Fc.transaction(["mapsBlobs"],"readwrite").objectStore("mapsBlobs").get(b).onsuccess=Cj.step2};Cj.step2=function(b){b=b.target.result;var c=new FileReader;c.onload=function(b){b=new Uint8Array(b.target.result);b=kj(b,".tzared");pm(b)};c.readAsArrayBuffer(b)};var ai=function(b,c,e,h){if(Df&&!p.editor){var f=Df.events.defined[c.id];if(f&&f[e])if(f=f[e],"zone"==
e)for(b=0,h=f.length;b<h;b+=5){e=f[b];var k=f[b+2],l=f[b+3],m=f[b+4];c.x32>=f[b+1]&&c.x32<=l&&c.y32>=k&&c.y32<=m?(c.inZone||(c.inZone={}),c.inZone[e.id]||th([f[b]],1),c.inZone[e.id]=1):c.inZone&&c.inZone[e.id]&&(c.inZone[e.id]=0,th([f[b]],-1))}else{if(!h)return th(f,b);T(h.name);c=f.defined;c[h.id]&&th(c[h.id],b)}}},th=function(b,c){for(var e=b.length,f=0;f<e;f++){var g=b[f],k=g.rule,l=g.activeEvents;g.activeEvents+=c;0===l?k.activeEvents++:0===g.activeEvents&&k.activeEvents--;if(1==c&&k.activeEvents==
k.events.length)for(g=0,k=k.actions,l=k.length;g<l;g++){var m=k[g];T("action:",m.type);if(qm[m.type])qm[m.type](m.to[0],m.list)}}},qm={attack:vc,move:Tb},$d={start:function(){kb();var b=document.createElement("div");b.id="mapForm";b.innerHTML="\n            <div>\n            <h2>"+t.gameOptions+"</h2>\n            <table>\n<tr><td>"+t.mapSize+': </td><td><input type="number" id=\'editorSize\' min="10" value="256" /></td></tr>\n<tr><td>'+t.random+' </td><td>\n<label class="container">\n  <input type="checkbox" id="editorRandom">\n  <span class="checkmark"></span>\n</label>\n</td></tr>\n<tr><td>'+
t.nplayers+': </td><td><input id="editorPlayers" type="number" min="1" value="3"></td></tr>\n</table>\n</div>';var c=document.createElement("button");c.innerHTML=t.continue;c.onclick=$d.func;b.children[0].appendChild(c);c=document.createElement("button");c.innerHTML=t.cancel;c.onclick=go;b.children[0].appendChild(c);document.body.appendChild(b)}},go=function(){location.hash="";setTimeout(Hi,200);document.body.removeChild(this.parentElement.parentElement);sa()};$d.func=function(){T(p.arje);if(void 0==
p.arje){sa();q("editorRandom").checked?p.arje=555555*Math.random()+1:p.arje=!1;p.mapx=parseInt(q("editorSize").value);p.mapy=p.mapx;p.goldRes=Infinity;p.foodRes=Infinity;p.woodRes=Infinity;p.stoneRes=Infinity;p.gravity=580.9/9.8*9.8;p.terrainType="grass";na=[];for(var b=0,c=parseInt(q("editorPlayers").value);b<c;b++){for(var e="#"+(~~(16777216*Math.random())).toString(16);7>e.length;)e+="0";na[b]={color:e,IA:!1,name:"Tzar "+(b+1),race:0,team:0}}document.body.removeChild(q("mapForm"))}p.editor=1;be()};
var jh=function(){var b=q("selectKingdom");b.innerHTML="";for(var c=1,e=E.length;c<e;c++){var h=E[c];1===c&&(b.style.background="rgba("+h.color[0]+","+h.color[1]+","+h.color[2]+",1)");b.innerHTML+='<option value="'+c+'" style="background:rgba('+h.color[0]+","+h.color[1]+","+h.color[2]+',1)">'+h.name+"</option>"}},zn=function(b){kb();var c=document.createElement("div"),e=document.createElement("div");c.id="unitProps";var h="<table>"+('\n<tr><td>Name </td><td><input data-prop="name" type="text" value="'+
b.name+'" /></td></tr>\n<tr><td>'+t.health+' </td><td><input data-prop="health" type="number" value="'+b.health+'" /></td></tr>\n<tr><td>'+t.maxHealth+'</td> <td><input data-prop="maxHealth" type="number" value="'+b.maxHealth+'" /></td></tr>\n');if(b.build||b.item)if(b.item){if(b.sword||b.shield)h+="\n<tr><td>"+t.attack+'</td><td><input data-prop="attack" type="number" value="'+(b.attack||0)+'" /></td></tr>\n<tr><td>'+t.defence+'</td> <td><input data-prop="defence" type="number" value="'+(b.defence||
0)+'" /></td></tr>\n'}else b.kingdom&&(h+="<tr><td>"+t.kingdom+' </td><td><select id="selectKingdom2">'+q("selectKingdom").innerHTML+"</select></td></tr>");else h+="\n<tr><td>"+t.attack+'</td><td><input data-prop="attack" type="number" value="'+(b.attack||0)+'" /></td></tr>\n<tr><td>'+t.defence+'</td> <td><input data-prop="defence" type="number" value="'+(b.defence||0)+'" /></td></tr>\n<tr><td>'+t.mana+' <td><input data-prop="mana" type="number" value="'+(b.mana||0)+'" /></td></tr>\n<tr><td>'+t.kingdom+
' </td><td><select id="selectKingdom2">'+q("selectKingdom").innerHTML+"</select></td></tr>\n";e.innerHTML=h+"</table>";h=document.createElement("button");h.innerHTML=t.ok;h.onclick=function(){for(var c=q("unitProps").getElementsByTagName("input"),e=0,f=c.length;e<f;e++)if(c[e]){var h=c[e].value;"number"==c[e].type&&(h=parseInt(h));var l=c[e].dataset.prop;b.__proto__[l]!=h&&(b[l]=h)}b.kingdom&&q("selectKingdom2")&&(c=parseInt(q("selectKingdom2").value),c!=b.kingdom&&b.changeKingdom(c));document.body.removeChild(q("unitProps"));
sa()};e.appendChild(h);c.appendChild(e);document.body.appendChild(c);T(b.kingdom);q("selectKingdom2")&&(q("selectKingdom2").value=b.kingdom)},ma=function(b){q(b).style.display="none"},Ca=function(b){q(b).style.display="block"},aj=function(b){P=function(){};var c=ja;c.img=l.blank;var e=32*ie();c.wh=[e,e];Za(c);c.active=!0;document.addEventListener("mousemove",jc);document.addEventListener("mousedown",rm);jc.active=b},rm=function(b){if(2==b.buttons||b.pageX<x.menumx||b.pageY<x.menumy)return sm();jc(b)},
sl=function(b){if(p.editor){var c=parseInt(q("brushSize").value)+b;c>q("brushSize").max?q("brushSize").value=q("brushSize").max:1>c?q("brushSize").value=1:(q("brushSize").value=c,ja.wh&&(ja.wh[0]+=32*b,ja.wh[1]+=32*b,ja.active=!0,Za(ja)))}},ie=function(){return parseInt(q("brushSize").value)},bj=function(b,c,e){b=ie();for(var f=b*b,g=G,k=$c,l=bj.active,m=pc.type,p=0;p<f;p++){var q=c+p%b,r=e+~~(p/b);ia(q,r)&&(q+=r*g,k[q]=l,m[l]&&(2<Y[q]&&w[Y[q]].die(),2<Ta[q]&&w[Ta[q]].die()))}yd()},Gn=function(b,
c,e){b=ie();for(var f=b*b,g=G,k=0;k<f;k++){var l=c+k%b,m=e+~~(k/b);ia(l,m)&&(0===Y[l+m*g]?.2>Math.random()&&sc([l+m*g,7,{d:3+~~(28*Math.random())}]):(l=w[Y[l+m*g]],7==l.type&&l.die()))}},Fn=function(b,c,e){b=ie();for(var f=b*b,g=G,k=0;k<f;k++){var l=c+k%b,m=e+~~(k/b);ia(l,m)&&(l=w[Y[l+m*g]],7==l.type&&l.die())}},jc=function(b){var c=32*ie();c=wc(b.pageX-x.mx-.5*c/Z,b.pageY-.5*c/Z);var e=~~(.03125*c[1]);c=~~(.03125*c[0]);ja.x=32*c;ja.y=32*e;ja.active=!0;if(0!==b.buttons){if(2==b.buttons)return sm();
jc.last!==c+e*G&&jc.active&&jc.active(b,c,e);jc.last=c+e*G}},sm=function(){ja.active=!0;ja.x=-9999;ja.y=-9999;if(jc.active){var b=32*ie();wc(event.pageX-x.mx-.5*b/Z,event.pageY-.5*b/Z);jc.active=!1}ja.wh=void 0;document.removeEventListener("mousedown",rm);document.removeEventListener("mousemove",jc)},nl=function(){T(this);this.parentElement.parentElement.style.display="none";sa()},ol={objAction:{id:"edobjAction",msg:t.objAction,func:function(){qa.active.type="attack";Ca("selectionEvents");ma("eventZone");
Ca("unitListDiv2");q("byButton2").style.display="inline-block";q("byButton1").style.display="inline-block";qa.active.zone=void 0}},objZone:{id:"edobjAction",msg:t.objZone,func:function(){qa.active.type="zone";qa.active.to.length=0;ma("selectionEvents");q("eventZone").style.display="inline-block";ma("byButton2");ma("byButton1");ma("unitListDiv2");tm()}}},Ud=function(b){if(b)ma("mapRulesWindow"),sa(),Ud.actived=!0;else if(Ud.actived){Ca("mapRulesWindow");kb();b=~~(yb[0]/32);var c=~~(yb[1]/32),e=~~(yb[9]/
32),h=~~(yb[10]/32);if(b<e)var g=b,k=e;else g=e,k=b;if(c<h)var l=c,m=h;else l=h,m=c;qa.active.zone||(qa.active.zone=[]);qa.active.zone.put([g,l,k,m]);T(b,c,e,h);tm();Ud.actived=!1}},tm=function(){var b=q("zoneList");b.innerHTML="";var c=qa.active.zone;if(c)for(var e=c.length,h=0;h<e;h++){var g=c[h],k=document.createElement("div"),l=document.createElement("button");l.innerHTML="x";l.obj=g;l.pObj=c;l.spObj=!0;l.onclick=Dj;k.innerHTML=g[0]+"x "+g[1]+"y -> "+g[2]+"x "+g[3]+"y";k.appendChild(l);b.appendChild(k)}},
um={moving:1},rn=function(){um[this.value]?(ma("byButton2"),ma("byButton1"),ma("unitListDiv2")):(Ca("unitListDiv2"),q("byButton2").style.display="inline-block",q("byButton1").style.display="inline-block");qa.active.type=this.value},sn=function(){um[this.value]?(ma("toButton2"),ma("toButton1"),ma("unitListDivAction2")):(Ca("unitListDivAction2"),q("toButton2").style.display="inline-block",q("toButton1").style.display="inline-block");Ua.active.type=this.value},qb=function(b){if(b)ma("mapRulesWindow"),
sa(),qb.actived=b.button;else if(qb.actived){Ca("mapRulesWindow");kb();b=qb.actived.spType.active;b="unitListDiv2"==qb.actived.id||"unitListDivAction2"==qb.actived.id?b.to:b.list;for(var c={},e=0,h=b.length;e<h;e++)c[b[e]]=1;e=0;for(h=C.length;e<h;e++)c[C[e]]||b.put(C[e]);Mf(qb.actived,b);qb.actived=!1}},Mf=function(b,c){b.innerHTML="";for(var e=0,f=c.length;e<f;e++){var g=document.createElement("div");g.innerHTML=w[c[e]].name;var k=document.createElement("button");k.onclick=Dj;k.innerHTML="x";k.pObj=
c;k.spObj=!0;k.obj=c[e];g.appendChild(k);b.appendChild(g)}},Mb=function(){Mb.active&&(Mb.active.className="");Mb.active=this;this.className="spSelect";for(var b=this.parentElement.getElementsByTagName("section"),c=0,e=b.length;c<e;c++)b[c].style.display="none";this.sdiv.style.display="block"},Gb=function(){var b=this.editorRule;b.deleted||(Ca("mapEvent"),Ca("mapActions"),ma("eventOptions"),Gb.active&&(Gb.div.className=""),this.className="spSelect",Gb.active=b,Gb.div=this,Vg(b,"eventLayout"),Vg(b,
"actionLayout"),qa.div&&ma(qa.div),qa.div1=void 0)},qa=function(){var b=this.editorRule;b.deleted||(Ca("eventOptions"),qa.div1&&(qa.div1.className=""),this.className="spSelect",qa.active=b,q("selectionEvents").value=b.type,qa.div1=this,q("eventOptions").value=b.name,qa.div=ol[b.name].id,Ca(qa.div),Mf(q("unitListDiv"),b.list),Mf(q("unitListDiv2"),b.to))},Ua=function(){var b=this.editorRule;b.deleted||(Ca("actionOptions"),Ua.div1&&(Ua.div1.className=""),this.className="spSelect",Ua.active=b,q("selectionActions").value=
b.type,Ua.div1=this,q("actionOptions").value=b.name,Ua.div="ed"+b.name,Ca(Ua.div),Mf(q("unitListDivAction"),b.list),Mf(q("unitListDivAction2"),b.to))},Vg=function(b,c){q(c).innerHTML="";if("eventLayout"==c){b=b.events;var e=qa,f=Gb.active.events}else b=b.actions,e=Ua,f=Gb.active.actions;for(var g=0,k=b.length;g<k;g++){var l=document.createElement("div");uh(l,b[g],e,f);q(c).appendChild(l)}},pn=function(){var b=Gb.active,c={name:"objAction",list:[],to:[],type:"attack"};b.events.put(c);var e=document.createElement("div");
uh(e,c,qa,b.events);q("eventLayout").appendChild(e);if(qa.div1)qa.div1.onclick()},qn=function(){var b=Gb.active,c={name:"objOrder",list:[],to:[],type:"move"};b.actions.put(c);var e=document.createElement("div");uh(e,c,Ua,b.actions);q("actionLayout").appendChild(e);if(Ua.div1)Ua.div1.onclick()},uh=function(b,c,e,h){b.innerHTML=c.events?c.name:t[c.name];b.onclick=e;b.editorRule=c;e=document.createElement("button");e.innerHTML="x";e.obj=c;e.pObj=h;e.onclick=Dj;b.appendChild(e)},on=function(){p.rules||
(p.rules=[]);var b={name:"Rule"+p.rules.length,events:[],actions:[]};p.rules.put(b);var c=document.createElement("div");uh(c,b,Gb,p.rules);q("rulist").appendChild(c)},Dj=function(){this.pObj.quit(this.obj);this.obj.deleted=!0;this.parentElement.parentElement.removeChild(this.parentElement);if(!this.spObj)if(this.pObj!==p.rules)Gb.div.onclick();else ma("mapEvent"),ma("mapActions")},Fi=function(){var b=q("mapPropsWindow").getElementsByTagName("table")[0];b.innerHTML="";b.innerHTML+="<tr><td>"+t.color+
"</td><td>"+t.username+"</td><td>"+t.gold+"</td><td>"+t.wood+"</td><td>"+t.food+"</td><td>"+t.stone+"</td><td>"+t.AI+"</td><td>"+t.team+"</td></tr>";for(var c=1,e=E.length;c<e;c++){var h=E[c],g=h.color,k=h.resources;g="#"+(16777216+(g[0]<<16)+(g[1]<<8)+g[2]).toString(16).slice(1);b.innerHTML+='<tr><td><input style="background:'+g+'" type="color" value="'+g+'" /></td><td><input type="text" value="'+h.name+'"></td>\n\n<td><input type="text" class="res" value="'+(parseInt(k[0])||"\u221e")+'"></td>\n<td><input type="text" class="res" value="'+
(parseInt(k[1])||"\u221e")+'"></td>\n<td><input type="text" class="res" value="'+(parseInt(k[2])||"\u221e")+'"></td>\n<td><input type="text" class="res" value="'+(parseInt(k[3])||"\u221e")+'"></td>\n<td><label class="container">\n  <input type="checkbox">\n  <span class="checkmark"></span>\n</label></td><td><input type="number" min="0" value="'+h.team+'"></td></tr>'}b.innerHTML+="<tr><td><button id='editorAdd'>+</button><button id='editorDelete'>-</button></td></tr>";q("editorAdd").onclick=ho;q("editorDelete").onclick=
io;b=b.getElementsByTagName("input");c=0;for(e=E.length-1;c<e;c++)k=8*c,h=E[c+1],b[k].onchange=jo,b[k+1].onchange=ko,b[k+2].onchange=vh,b[k+3].onchange=vh,b[k+4].onchange=vh,b[k+5].onchange=vh,b[k+2].res=0,b[k+3].res=1,b[k+4].res=2,b[k+5].res=3,b[k+6].onchange=lo,b[k+6].checked=h.IA,b[k+7].onchange=mo,b[k].team=c+1,b[k+1].team=c+1,b[k+2].team=c+1,b[k+3].team=c+1,b[k+4].team=c+1,b[k+5].team=c+1,b[k+6].team=c+1,b[k+7].team=c+1},vh=function(){var b=parseInt(this.value);b||(b=Infinity,this.value="\u221e");
E[this.team].resources[this.res]=b},ho=function(){new Vb("Tzar "+E.length,[~~(256*Math.random()),~~(256*Math.random()),~~(256*Math.random())],[0],0,!0,[p.goldRes,p.woodRes,p.foodRes,p.stoneRes],2);jh();Fi()},io=function(){if(2<E.length){for(var b=E.length-1,c=3,e=w.length;c<e;c++){var h=w[c];h.kingdom==b&&h.die()}E.length--;jh();Fi()}},jo=function(){var b=E[this.team],c=parseInt(this.value.substr(1),16),e=c>>16&255,h=c>>8&255;c&=255;b.color=[e,h,c];var g=this.team;b=va[g];E[g].color=[e,h,c];g*=3;
cb[g]=e/255;cb[g+1]=h/255;cb[g+2]=c/255;e=0;for(h=b.length;e<h;e++){c=b[e];g=0;for(var k=c.length;g<k;g++)wb(w[c[g]])}jh()},ko=function(){E[this.team].name=this.value},lo=function(){E[this.team].IA=this.checked?!0:!1},mo=function(){var b=E[this.team];b.team=parseInt(this.value);for(var c=E.length,e=1;e<c;e++){var h=E[e];h.team!==b.team&&(h.diplomacy[b.k]=1,b.diplomacy[h.k]=1)}},Qj=function(b){var c=b.length;I(jj,c);for(var e=mb.step,h=0;h<c;h+=e)I(mb,b.slice(h,h+e))},Un=function(b){if(b=q("maploadOnline").files[0]){b.name.split(".");
var c=new FileReader;c.onload=function(){var b=new Uint8Array(this.result);x.admin&&(ma("optionbutton"),Qj(b),Yl(b),T(la),Zl(la.kingdoms.length),q("nplayersO").value=x.room.max,q("deleteCusMap").style.display="inline-table")};c.readAsArrayBuffer(b)}},kj=function(b,c){if(c&&"wmp"==c)return Jf(b);T(b[0]);var e=b[1]+(b[2]<<8)+(b[3]<<16)+(b[4]<<24);c=new TextDecoder("utf-8");c=JSON.parse(c.decode(b.slice(5,e+5)));if(!1===c.arje){b=b.slice(e+5,e+5+Math.pow(c.mapx,2));var f=Math.pow(c.mapx,2);e=b.length;
f=f?new Uint8Array(f):[];for(var g=0,k=0;k<e;k++){var l=b[k];if(255!==l)f[g++]=l;else{l=b[k-1];for(var m=(b[k+1]<<8)+b[k+2],p=0;p<m;p++)f[g++]=l;k+=2}}c.terrain=f}c.allunits&&(c.allunits=Wl(c.allunits));c.ini&&(c.ini=Wl(c.ini));return c},la,pm=function(b){Ca("customMapcont");q("editCustom").style.display="inline-table";q("closeCustom").style.display="inline-table";la=b;la.kingdomStart?(q("seeStats").style.display="inline-table",q("playrecord").style.display="inline-table"):(q("seeStats").style.display=
"none",q("playrecord").style.display="none");null===la.goldRes&&(la.goldRes=Infinity);null===la.stoneRes&&(la.stoneRes=Infinity);null===la.foodRes&&(la.foodRes=Infinity);null===la.woodRes&&(la.woodRes=Infinity);b=q("custombody");b.innerHTML="";for(var c=la.kingdoms,e=0,h=c.length;e<h;e++){var g=c[e],k=g.color,l=g.team;void 0==l&&(l="");b.innerHTML+="<tr><td style='background:rgb("+k[0]+","+k[1]+","+k[2]+')\' class="ucolor1"></td><td class="username1">'+g.name+'</td><td style="display:none" class="race1">'+
g.race+'</td><td class="team1">'+l+"</td></tr>"}ma("maploadlabel");ma("mapcache")},no=function(b){var c={Blue:189,Red:13506841,Green:3257600,Purple:11337925,Yellow:16768512,Cyan:46517,Orange:16751649,Gray:5921370},e=b.split(["[Player"]),h=b.split("GameDuration =")[1].split("[")[0].split(" min")[0].split(" ")[1],g=[];b=[];for(var k=1,l=e.length;k<l;k++){var m=e[k].split("\n"),p={};g[k-1]=p;for(var q=0,r=m.length;q<r;q++){var t=m[q];t=t.split(" = ");if(t[1]&&q){t[1]=t[1].trim();"Color"==t[0]&&(t[1]=
c[t[1]]);"Type"==v&&"Status"!==t[0]&&b.put("N");t[1]=encodeURIComponent(t[1]);b.put(t[1]);p[t[0]]=t[1];var v=t[0]}}}c=g[0].Name+"'s Game";var w=new XMLHttpRequest;w.open("POST",baseUrl+"php/stats.php",!0);w.setRequestHeader("Content-type","application/x-www-form-urlencoded");w.onreadystatechange=function(){200===w.status&&4===w.readyState&&(location.hash="MatchX"+w.responseText)};b=b.join("<");w.send("arr="+b+"&time="+6E4*h+"&name="+c+"&players="+g.length)},Ej=function(b,c){for(var e=0,f=0,g=b.length;f<
g;f++)e+=c[b[f]];return e},Gi=function(b,c,e){var f=["",e];performance.now();for(var g=0,k=b.length;g<k;g++){var l=b[g],m=l.stats,p=m.resources,t=m.unitCountMax,r=24*g+2,v=l.color,w=l.IA;w=w?"IA":"Human";f[r]=(v[0]<<16)+(v[1]<<8)+v[2];f[r+1]=l.name;f[r+1]=l.name;f[r+2]=w;f[r+3]=l.status;f[r+4]=l.team;f[r+5]=Ia[l.race];f[r+6]=m.score;f[r+7]=p[0];f[r+8]=p[1];f[r+9]=p[2];f[r+10]=p[3];f[r+11]=m.dmgInflicted;f[r+12]=m.dmgTaken;f[r+13]=m.unitsKilled;f[r+14]=m.unitsLosed;f[r+15]=m.buildsDestroyed;f[r+16]=
m.buildsLosed;f[r+17]=Ej([10,79,64],t);f[r+18]=Ej([32,44],t);f[r+19]=Ej([55,56],t);f[r+20]=0;f[r+21]=0;f[r+22]=0;f[r+23]=0}vm(f,c);c&&setTimeout(function(){"block"==q("ingameStats").style.display&&Gi(b,c,e)},500)},vm=function(b,c){for(var e="<tr style='background:#000;'><td style='    padding-right: 150px;'>Name</td><td>Type</td><td>Status</td><td>Team</td><td>Race</td><td>Score</td><td>Gold</td><td>Wood</td><td>Food</td><td>Stone</td><td title='Damage Inflicted'>D.I</td><td title='Damage Taken'>D.T</td><td title='Units Killed'>U.K</td><td title='Units Losed'>U.L</td><td title='Buildings Destroyed'>B.D</td><td title='Buildings Losed'>B.L</td><td title='Maximum Peasants'>M.P</td><td title='Maximum Towers'>M.T</td><td title='Maximum Stone Towers'>M.S.T</td><td title='Gold Traded'>G.T</td><td title='Stone Traded'>S.T</td><td title='Gold Converted'>G.C</td><td title='Stone Converted'>S.C</td></tr>",
f=2,g=b.length;f<g;f++)if((f-2)%24)0!==(f-3)%24&&(k=~~((f-2)/24)%2?"style = 'background:rgba(0,0,0,0.45)'":"style = 'background:rgba(0,0,0,0.65)'"),e+="<td "+k+">"+Na(decodeURIComponent(b[f]))+"</td>";else{f-2&&(e+="</tr>");k=parseInt(Na(decodeURIComponent(b[f])));var k="style = 'background:rgba("+Math.floor(k/65536)+","+Math.floor(k/256)%256+","+k%256+",0.45)'";e+="<tr>"}e+="</tr>";c?(Ca("ingameStats"),""==q("ingameStats").innerHTML&&(q("ingameStats").innerHTML='<div>\n<table id="statsGame"></table>\n</div>\n<button id="backToGameS" class="stanButton">'+
t.backToGame+"</button>",q("backToGameS").onclick=function(){Bd("ingameStats");sa()}),q("statsGame").innerHTML="<tbody>"+e+"</tbody>",c=q("statsGame").getElementsByTagName("td")):(q("MatchX").style.display="block",q("returnmenu").style.display="block",q("statsTable").innerHTML="<tbody>"+e+"</tbody>",c=q("statsTable").getElementsByTagName("td"));b=[];f=0;for(g=c.length;f<g;f++)e=f%23,4<e&&23<f&&(b[e-5]||(b[e-5]=[]),b[e-5].put(c[f]));f=0;for(g=b.length;f<g;f++){c=b[f];c.sort(Cm);e=c.length;if(!c[1])break;
c[0].innerHTML!=c[1].innerHTML&&(c[0].style.background="rgba(127,0,0,0.45)");c[e-1].innerHTML!=c[e-2].innerHTML&&(c[e-1].style.background="rgba(0,127,0,0.45)")}};q("statsLoad").onchange=function(){var b=q("statsLoad").files[0],c=new FileReader;c.onloadend=function(b){no(b.target.result)};b&&c.readAsText(b,"ascii")};var zm=function(b){var c=new XMLHttpRequest;c.open("POST",baseUrl+"php/loadstat.php",!0);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");wm(c,function(b){vm(b.responseText.split("<"))});
T(b);c.send("id="+b)},wm=function(b,c){b.onreadystatechange=function(){4===b.readyState&&(200===b.status?c(b):alert("Error: "+b.status))}},$l=function(){q("mapconfiguration").style.display="block";q("basic").style.filter="blur(94px)";if(""==q("mapconfiguration").innerHTML){for(var b="",c=["grass","snow"],e=0,h=c.length;e<h;e++)b+='<option value="'+c[e]+'" '+(c[e]==localStorage.terrain?"selected":"")+">"+t[c[e]]+"</option>";c="";"true"==localStorage.infinity&&(c="checked");q("mapconfiguration").innerHTML=
"<table>\n<tbody>\n<tr><td>"+t.mapSize+'</td><td><input id="mapwidth" type="number" value="'+localStorage.mapx+'" step="32" min="32" /></td></tr>\n<tr><td><hr></td></tr>\n<tr><td>'+t.startingResources+"</td></tr>\n<tr><td><hr></td></tr>\n<tr><td>"+t.infinite+'</td><td><label class="container">\n  <input id="infiniteValue" type="checkbox" '+c+'>\n  <span class="checkmark"></span>\n</label></td></tr>\n<tr><td>'+t.gold+'</td><td><input id="goldValue" type="number" value="'+localStorage.goldRes+'" step="250" /></td></tr>\n<tr><td>'+
t.wood+'</td><td><input id="woodValue" type="number" value="'+localStorage.woodRes+'" step="250" /></td></tr>\n<tr><td>'+t.food+'</td><td><input id="foodValue" type="number" value="'+localStorage.foodRes+'" step="250" /></td></tr>\n<tr><td>'+t.stone+'</td><td><input id="stoneValue" type="number" value="'+localStorage.stoneRes+'" step="250" /></td></tr>\n<tr><td><hr></td></tr>\n<tr><td>'+t.terrainOption+'</td></tr>\n<tr><td><select name="terrain" id="terrainSelect">\n'+b+"\n<tr><td>"+t.water+'</td><td><input type="number" value="'+
localStorage.water+'" id="waterValue" min="0"/></td></tr>\n<tr><td>'+t.items+'</td><td><input type="number" value="'+localStorage.items+'" id="itemsValue" min="0"/></td></tr>\n<tr><td>'+t.peons+'</td><td><input type="number" value="'+localStorage.peons+'" id="peonValue" min="0"/></td></tr>\n<tr><td>'+t.gateways+'</td><td><input type="number" value="'+localStorage.gateways+'" id="gatewaysValue" min="0" /></td></tr>\n<tr><td>'+t.freePop+'</td><td><input type="number" value="'+localStorage.freePop+'" id="freePopValue" /></td></tr>\n</select>\n</td>\n</tr>\n<tr><td></td></tr>\n<tr><td><button id="closeButton1" class="start">'+
t.close+"</button></td></tr>\n</tbody>\n</table>";q("infiniteValue").onchange=function(){var b=this.checked;q("goldValue").disabled=b;q("stoneValue").disabled=b;q("woodValue").disabled=b;q("foodValue").disabled=b};q("infiniteValue").onchange();q("closeButton1").onclick=function(){p.online&&I(gd,Ef());q("mapconfiguration").style.display="none";sa()}}};q("returnmenu1").onclick=db;q("returnmenu").onclick=db;q("refreshButton1").onclick=xh;q("sendmsg").onclick=Ki;q("start1").onclick=$l;q("start2").onclick=
be;q("alertok").onclick=function(){q("alert").style.display="none";sa()};q("createGame1").onclick=Vl;var oo=function(){T(this,this.checked);localStorage[this.localProp]=this.checked},xm=function(){var b=this.value;"color"==this.type?this.style.backgroundColor=b:"name"==this.localProp&&(b=Na(b));x[this.localProp]=b;localStorage[this.localProp]=b},Sj={MatchHistory:function(){q("returnmenu").style.display="block";var b=new XMLHttpRequest;b.open("GET",baseUrl+"php/latest.php",!0);wm(b,function(b){b=b.responseText.split("|");
for(var c=b.length-1,f="",g=0;g<c;g+=5)f+="<tr id='statList"+Na(decodeURIComponent(b[g]))+"'><td>"+Na(decodeURIComponent(b[g+1]))+"</td><td>"+Na(decodeURIComponent(b[g+2]))+"</td><td>"+Na(decodeURIComponent(b[g+3]))+"</td><td>"+parseInt(Na(decodeURIComponent(b[g+4])))/6E4+" min</td></tr>";q("matchtable").innerHTML="<tbody>"+f+"</tbody>";f={};for(g=0;g<c;f={l:f.l},g+=5)f.l=Na(decodeURIComponent(b[g])),q("statList"+f.l).onclick=function(b){return function(){location.hash="MatchX"+b.l}}(f)});b.send(null)},
GameList:xh,RandomMap:ic,Twitter:function(){q("returnmenu").style.display="block"},Account:function(){ce.returnmenu.style.display="block";""==ce.Account.innerHTML&&(ce.Account.innerHTML='<iframe id="accountIframe"></iframe>',ce.accountIframe=q("accountIframe"));ce.accountIframe.src=baseUrl+x.langCodeUrl+"account/?iframe=1"},MapEditor:$d.start,CustomMap:function(){""==q("CustomMap").innerHTML&&(q("CustomMap").innerHTML="<h2>"+t.strcusMap+'</h2>\n<input id="mapload" type="file" />\n<label for="mapload" id="maploadlabel">Choose a file</label>\n<table id="mapcache"></table>\n<div id="customMapcont" style="display:none">\n<table class="players" id="customaptable">\n<tbody id="custombody">\n</tbody>\n</table>\n<button style="margin-left:40px" id="startCustom" class="start startButton">'+
t.play+'</button>\n<button style="margin-left:40px" id="playrecord" class="start">'+t.loadRecord+'</button>\n<button style="margin-left:40px" id="editCustom" class="start">'+t.editMap+'</button>\n<button style="margin-left:40px" id="seeStats" class="start">'+t.stats+'</button>\n<button style="margin-left:40px" id="closeCustom" class="start">'+t.close+"</button>\n</div>",q("closeCustom").onclick=function(){ma("customMapcont");q("maploadlabel").style.display="inline-block";q("mapcache").style.display=
"table"},q("startCustom").onclick=function(){p=Object.assign({},la);p.editor=!1;p.custom=!0;p.online=!1;la=void 0;ma("customMapcont");q("closeCustom").onclick();be(!1,!1)},q("editCustom").onclick=function(){p=Object.assign({},la);p.custom=!0;p.online=!1;p.editor=!0;$d.func();la=void 0;ma("customMapcont");q("closeCustom").onclick()},q("playrecord").onclick=function(){p=Object.assign({},la);p.online=!1;p.custom=!0;p.demo=!0;p.cycle=0;p.editor=!1;la=void 0;ma("customMapcont");be(!1,!1);q("closeCustom").onclick()},
q("seeStats").onclick=function(){Gi(la.kingdoms,!1,25*la.cycle);location.hash="MatchX"},q("mapload").accept=".tzared,.wmp",q("mapload").onchange=function(b){b=q("mapload").files[0];T(b);var c=b.name.split(".");c=c[c.length-1];var e=new FileReader;e.onload=function(){var b=new Uint8Array(this.result);b=kj(b,c);pm(b)};e.readAsArrayBuffer(b)});Ca("returnmenu");om()},Settings:function(){var b=q("Settings");if(""==b.innerHTML){var c=document.createElement("h2");c.innerHTML=t.strSettings;b.appendChild(c);
c=document.createElement("div");var e=document.createElement("span");e.innerHTML=t.color;c.appendChild(e);var h=document.createElement("input");h.type="color";h.value=localStorage.color;h.onchange=xm;h.localProp="color";h.style.backgroundColor=localStorage.color;c.appendChild(h);e=document.createElement("span");e.innerHTML=t.username;c.appendChild(e);h=document.createElement("input");h.type="text";h.value=Tl(localStorage.name);h.onchange=xm;h.localProp="name";c.appendChild(h);e=document.createElement("span");
e.innerHTML=t.language;c.appendChild(e);e=document.createElement("select");e.innerHTML='<option value="en">'+t.english+'</option>\n<option value="es">'+t.spanish+'</option>\n<option value="it">'+t.italian+'</option>\n<option value="pt">'+t.portuguese+'</option>\n<option value="ru">'+t.russian+'</option>\n<option value="pl">'+t.polish+'</option>\n<option value="bg">'+t.bulgarian+'</option>\n<option value="de">'+t.german+"</option>\n";e.value=x.langstr;e.onchange=function(){localStorage.language=this.value;
location.href=""};c.appendChild(e);e=document.createElement("span");e.innerHTML=t.offlinePlay;c.appendChild(e);e=document.createElement("button");e.innerHTML=t.downloadAll;e.onclick=Lc;c.appendChild(e);e=document.createElement("span");e.innerHTML=t.fullscreen;c.appendChild(e);var g=document.createElement("label");g.className="container";e=document.createElement("span");e.className="checkmark";h=document.createElement("input");h.type="checkbox";h.checked="true"==localStorage.fullscreen?!0:!1;h.onchange=
oo;h.localProp="fullscreen";g.appendChild(h);g.appendChild(e);c.appendChild(g);b.appendChild(c)}Ca("returnmenu")},About:function(){var b=q("About");""==b.innerHTML&&(b.innerHTML='<div style="text-align:center;    user-select: text;"><div class="svgnehhon" style="background-repeat: no-repeat;height:342px;background-position: center;"></div>\nFully programmed by Donov from <a href="https://nehhon.com" target="_blank">nehhon</a><p>\nContact:</p>\n<a href=\'mailto:webmaster@nehhon.com\' target="_blank">webmaster@nehhon.com</a> <br> <a href="https://twitter.com/TzaredGame" target="_blank">@TzaredGame</a>\n<p>Graphics, sound and game concept (Tzar) by Haemimont</p>\n<hr>\n<p>Special thanks to:</p>\n<img style="max-width:422px" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgODc0LjMgMzkzLjciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDg3NC4zIDM5My43OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHN0eWxlIHR5cGU9InRleHQvY3NzIj4uc3Qwe2ZpbGw6I0ZGRkZGRjt9LnN0MXtmaWxsOiNGMzgwMjA7fS5zdDJ7ZmlsbDojRkFBRTQwO308L3N0eWxlPjxnPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik03OTAuNiwyNzEuOWMtMy40LDAtNi4xLTIuNy02LjEtNi4xYzAtMy4zLDIuNy02LjEsNi4xLTYuMWMzLjMsMCw2LjEsMi43LDYuMSw2LjFDNzk2LjcsMjY5LjEsNzkzLjksMjcxLjksNzkwLjYsMjcxLjkgTTc5MC42LDI2MC45Yy0yLjcsMC00LjksMi4yLTQuOSw0LjljMCwyLjcsMi4yLDQuOSw0LjksNC45YzIuNywwLDQuOS0yLjIsNC45LTQuOUM3OTUuNSwyNjMuMSw3OTMuMywyNjAuOSw3OTAuNiwyNjAuOSBNNzkzLjcsMjY5aC0xLjRsLTEuMi0yLjNoLTEuNnYyLjNoLTEuM3YtNi43aDMuMmMxLjQsMCwyLjMsMC45LDIuMywyLjJjMCwxLTAuNiwxLjctMS40LDJMNzkzLjcsMjY5eiBNNzkxLjMsMjY1LjVjMC41LDAsMS0wLjMsMS0xYzAtMC44LTAuNC0xLTEtMWgtMnYyTDc5MS4zLDI2NS41TDc5MS4zLDI2NS41eiIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iMTU1LjEsMjU5LjEgMTcwLjcsMjU5LjEgMTcwLjcsMzAxLjYgMTk3LjgsMzAxLjYgMTk3LjgsMzE1LjIgMTU1LjEsMzE1LjIgIi8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTIxMy45LDI4Ny4zdi0wLjJjMC0xNi4xLDEzLTI5LjIsMzAuMy0yOS4yczMwLjEsMTIuOSwzMC4xLDI5djAuMmMwLDE2LjEtMTMsMjkuMi0zMC4zLDI5LjJDMjI2LjcsMzE2LjMsMjEzLjksMzAzLjQsMjEzLjksMjg3LjMgTTI1OC41LDI4Ny4zdi0wLjJjMC04LjEtNS44LTE1LjEtMTQuNC0xNS4xYy04LjUsMC0xNC4yLDYuOS0xNC4yLDE1djAuMmMwLDguMSw1LjgsMTUuMSwxNC4zLDE1LjFDMjUyLjgsMzAyLjMsMjU4LjUsMjk1LjQsMjU4LjUsMjg3LjMiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjkzLjQsMjkwLjZ2LTMxLjVoMTUuOHYzMS4yYzAsOC4xLDQuMSwxMS45LDEwLjMsMTEuOXMxMC4zLTMuNywxMC4zLTExLjV2LTMxLjZoMTUuOHYzMS4xYzAsMTguMS0xMC4zLDI2LTI2LjMsMjZDMzAzLjQsMzE2LjIsMjkzLjQsMzA4LjIsMjkzLjQsMjkwLjYiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzY5LjQsMjU5LjFIMzkxYzIwLDAsMzEuNywxMS41LDMxLjcsMjcuN3YwLjJjMCwxNi4yLTExLjgsMjguMi0zMiwyOC4yaC0yMS4zTDM2OS40LDI1OS4xTDM2OS40LDI1OS4xeiBNMzkxLjMsMzAxLjRjOS4zLDAsMTUuNS01LjEsMTUuNS0xNC4ydi0wLjJjMC05LTYuMi0xNC4yLTE1LjUtMTQuMkgzODV2MjguNUgzOTEuM3oiLz48cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjQ0NS4zLDI1OS4xIDQ5MC4yLDI1OS4xIDQ5MC4yLDI3Mi43IDQ2MC44LDI3Mi43IDQ2MC44LDI4Mi4zIDQ4Ny40LDI4Mi4zIDQ4Ny40LDI5NS4yIDQ2MC44LDI5NS4yIDQ2MC44LDMxNS4yIDQ0NS4zLDMxNS4yICIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNTExLjgsMjU5LjEgNTI3LjMsMjU5LjEgNTI3LjMsMzAxLjYgNTU0LjUsMzAxLjYgNTU0LjUsMzE1LjIgNTExLjgsMzE1LjIgIi8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTU5NS4xLDI1OC43aDE1bDIzLjksNTYuNWgtMTYuN2wtNC4xLTEwaC0yMS42bC00LDEwaC0xNi4zTDU5NS4xLDI1OC43eiBNNjA4LjgsMjkzLjFsLTYuMi0xNS45bC02LjMsMTUuOUg2MDguOHoiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNNjU0LDI1OS4xaDI2LjVjOC42LDAsMTQuNSwyLjIsMTguMyw2LjFjMy4zLDMuMiw1LDcuNSw1LDEzLjF2MC4yYzAsOC42LTQuNiwxNC4zLTExLjUsMTcuMmwxMy40LDE5LjZoLTE4bC0xMS4zLTE3aC02Ljh2MTdINjU0TDY1NCwyNTkuMUw2NTQsMjU5LjF6IE02NzkuOCwyODZjNS4zLDAsOC4zLTIuNiw4LjMtNi42di0wLjJjMC00LjQtMy4yLTYuNi04LjQtNi42aC0xMC4yVjI4Nkw2NzkuOCwyODZMNjc5LjgsMjg2eiIvPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNzI2LjIsMjU5LjEgNzcxLjMsMjU5LjEgNzcxLjMsMjcyLjMgNzQxLjYsMjcyLjMgNzQxLjYsMjgwLjggNzY4LjUsMjgwLjggNzY4LjUsMjkzLjEgNzQxLjYsMjkzLjEgNzQxLjYsMzAyIDc3MS43LDMwMiA3NzEuNywzMTUuMiA3MjYuMiwzMTUuMiAiLz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTIxLjEsMjkzLjljLTIuMiw0LjktNi44LDguNC0xMi44LDguNGMtOC41LDAtMTQuMy03LjEtMTQuMy0xNS4xVjI4N2MwLTguMSw1LjctMTUsMTQuMi0xNWM2LjQsMCwxMS4zLDMuOSwxMy4zLDkuM2gxNi40Yy0yLjYtMTMuNC0xNC40LTIzLjMtMjkuNi0yMy4zYy0xNy4zLDAtMzAuMywxMy4xLTMwLjMsMjkuMnYwLjJjMCwxNi4xLDEyLjgsMjksMzAuMSwyOWMxNC44LDAsMjYuNC05LjYsMjkuNC0yMi40TDEyMS4xLDI5My45TDEyMS4xLDI5My45eiIvPjxnPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNzUyLjksMTY5LjYgNzEwLDE0NSA3MDIuNiwxNDEuOCA1MjcuMSwxNDMgNTI3LjEsMjMyLjEgNzUyLjksMjMyLjEgIi8+PHBhdGggY2xhc3M9InN0MSIgZD0iTTY3NC44LDIyMy45YzIuMS03LjIsMS4zLTEzLjgtMi4yLTE4LjdjLTMuMi00LjUtOC42LTcuMS0xNS4xLTcuNGwtMTIzLjEtMS42Yy0wLjgsMC0xLjUtMC40LTEuOS0xYy0wLjQtMC42LTAuNS0xLjQtMC4zLTIuMmMwLjQtMS4yLDEuNi0yLjEsMi45LTIuMmwxMjQuMi0xLjZjMTQuNy0wLjcsMzAuNy0xMi42LDM2LjMtMjcuMmw3LjEtMTguNWMwLjMtMC44LDAuNC0xLjYsMC4yLTIuNGMtOC0zNi4yLTQwLjMtNjMuMi03OC45LTYzLjJjLTM1LjYsMC02NS44LDIzLTc2LjYsNTQuOWMtNy01LjItMTUuOS04LTI1LjUtNy4xYy0xNy4xLDEuNy0zMC44LDE1LjQtMzIuNSwzMi41Yy0wLjQsNC40LTAuMSw4LjcsMC45LDEyLjdjLTI3LjksMC44LTUwLjIsMjMuNi01MC4yLDUxLjdjMCwyLjUsMC4yLDUsMC41LDcuNWMwLjIsMS4yLDEuMiwyLjEsMi40LDIuMWwyMjcuMiwwYzEuMywwLDIuNS0wLjksMi45LTIuMkw2NzQuOCwyMjMuOXoiLz48cGF0aCBjbGFzcz0ic3QyIiBkPSJNNzE0LDE0NC44Yy0xLjEsMC0yLjMsMC0zLjQsMC4xYy0wLjgsMC0xLjUsMC42LTEuOCwxLjRsLTQuOCwxNi43Yy0yLjEsNy4yLTEuMywxMy44LDIuMiwxOC43YzMuMiw0LjUsOC42LDcuMSwxNS4xLDcuNGwyNi4yLDEuNmMwLjgsMCwxLjUsMC40LDEuOSwxYzAuNCwwLjYsMC41LDEuNSwwLjMsMi4yYy0wLjQsMS4yLTEuNiwyLjEtMi45LDIuMmwtMjcuMywxLjZjLTE0LjgsMC43LTMwLjcsMTIuNi0zNi4zLDI3LjJsLTIsNS4xYy0wLjQsMSwwLjMsMiwxLjQsMmg5My44YzEuMSwwLDIuMS0wLjcsMi40LTEuOGMxLjYtNS44LDIuNS0xMS45LDIuNS0xOC4yQzc4MS4zLDE3NSw3NTEuMSwxNDQuOCw3MTQsMTQ0LjgiLz48L2c+PC9nPjwvc3ZnPg==" alt="cloudflare">\n</div>');
Ca("returnmenu")}};q("about").onclick=function(){location.hash="About"};q("discord").onclick=function(){window.open("https://discord.gg/ndxJHxT","_blank")};Hj();var ac=[Jc,Fg,pd,ld,Re,xg,Og,Hg,zg,yg,Cg,Pg,Kg,Wk,Qg,Ag,Bg,Mg,Ve,Be,Cd,tk,eg,Vh,sk,Uk,sg,Yk,Zk,Od,xi,$k,al,bl,cl,sg,Ml,Rk,dl,De,Sk,ig,Ok,Pk,pi,rg,He,zc,ni,md,ld,qg,pd,Pc,Kd,Nd,X,function(b){var c=b[1],e=w[b[2]];b=F[b[0]];E[e.kingdom].technology.hidden[b.id.id]=0;yc(e,b,c);oa.actv[b.id.id]&&O(!1)},lg,mg,vb,Hk,ib,ki,li,Ae,Pi,pl,Xk,vi,Ig,Vk,
Tk];(function(){for(var b=0,c=ac.length;b<c;b++)ac[b].url=b})();Be.rule="moving";rg.rule="attack"})();
